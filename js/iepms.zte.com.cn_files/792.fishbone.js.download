/*! For license information please see 792.fishbone.js.LICENSE.txt */
(self.webpackChunkfishbone=self.webpackChunkfishbone||[]).push([[792],{"0322dadfea5e4c6eb795":(e,t,a)=>{"use strict";a.d(t,{u:()=>s,w:()=>r});var n=a("8deafab7866a125bb9ca");function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){var a,n,i,r=Raphael.animation((a={width:0},i=t,(n=function(e){var t=function(e){if("object"!=o(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==o(t)?t:t+""}(n="width"))in a?Object.defineProperty(a,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[n]=i,a),300);e.animate(r.delay(100))}a("a45670b3d8fb79ec0258");var r=function(e){e.userData.view||(e.userData.view={colors:{data_color:"#6f6f6f",labels_color:"#6f6f6f",add_label_color:"#5d62c4",monochromatic:!1,mono_base_color:"#ffffff"}});var t=e.userData.view,a=e.userData.size.width,o=(e.userData.size.height,t.colors.monochromatic?t.colors.mono_base_color:t.colors.label_color||"#6f6f6f"),r=t.colors.monochromatic?t.colors.mono_base_color:t.colors.add_label_color||"#5d62c4",s=t.colors.monochromatic?t.colors.mono_base_color:t.colors.data_color||"#7e7e7e",l=e.canvas.paper,c=e.userData.barHeight,u=e.userData.labelFontSize,d=e.userData.valueFontSize,p=u.toString()+"px Open Sans",h=d.toString()+"px Open Sans",f=Math.round(.9*d).toString()+"px Open Sans",m={font:p,fill:o,"text-anchor":"start"},g={font:h,fill:s,"text-anchor":"end"},y={font:f,fill:r,"text-anchor":"end"};e.canvas.paper.setStart();var _=l.set();e.userData.tasks.forEach((function(o,r){if(o.actual.show){var s,u=l.set(),d=l.set();s="Add_RaDataNodeGroup"!==e.NAME?Math.round(o.actual.value/o.actual.total*1e3)/10:Math.round(o.actual.value/e.sites_list_in.length*1e3)/10;var p,h,f=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;p=f?t.colors.monochromatic?t.colors.mono_base_color:n.getColorDarker(s/100):t.colors.monochromatic?t.colors.mono_base_color:"0-"+n.getColorLighter(s/100)+"-"+n.getColorDarker(s/100),h=f?.4:t.colors.monochromatic?.5:.4,e.userData.showProgress&&(_.push(l.rect(0,0+(r+1)*c-c,0,c).attr({stroke:"none",opacity:h,fill:p})),i(_[_.length-1],a*(s/100))),u.push(l.text(10,0+(r+1)*c-c/2,o.actual.label).attr(m)),"Add_RaDataNodeGroup"!==e.NAME?d.push(l.text(a-10,0+(r+1)*c-c/2,o.actual.value+"/"+o.actual.total).attr(g)):d.push(l.text(a-10,0+(r+1)*c-c/2,o.actual.value).attr(g));var b=d.getBBox();d.push(l.text(-15+b.x,0+(r+1)*c-c/2,"("+s+"%)").attr(y))}}));var b=e.canvas.paper.setFinish();e.setNewData(b)},s=function(e){var t=e.userData.view,a=e.userData.totals,o=e.userData.values,r=e.userData.percents,s=e.userData.labels,l=e.userData.size.width,c=(e.userData.size.height,t.colors.monochromatic?t.colors.mono_base_color:s.color||"#6f6f6f"),u=t.colors.monochromatic?t.colors.mono_base_color:r.color||"#5d62c4",d=t.colors.monochromatic?t.colors.mono_base_color:o.color||"#7e7e7e",p=t.colors.monochromatic?t.colors.mono_base_color:a.color||"#7e7e7e",h=e.canvas.paper,f=e.userData.barHeight,m=s.font_size.toString()+"px Open Sans",g=o.font_size.toString()+"px Open Sans",y=r.font_size.toString()+"px Open Sans",_=(a.font_size.toString(),{font:m,"font-weight":s.font_weight,"font-style":s.font_style,fill:c,"text-anchor":"start"}),b={font:g,"font-weight":o.font_weight,"font-style":o.font_style,fill:d,"text-anchor":"end"},v={font:y,"font-weight":r.font_weight,"font-style":r.font_style,fill:u,"text-anchor":"end"},w={font:y,"font-weight":a.font_weight,"font-style":a.font_style,fill:p,"text-anchor":"end"};e.canvas.paper.setStart();var x=h.set();e.userData.tasks.forEach((function(c,u){if(c.actual.show){var d,p,m=h.set(),g=h.set(),y=Math.round(c.actual.value/c.actual.total*1e3)/10,k=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;d=k?t.colors.monochromatic?t.colors.mono_base_color:n.getColorDarker(y/100):t.colors.monochromatic?t.colors.mono_base_color:"0-"+n.getColorLighter(y/100)+"-"+n.getColorDarker(y/100),p=k?.4:t.colors.monochromatic?.5:.4,e.userData.showProgress&&(x.push(h.rect(0,0+(u+1)*f-f,0,f).attr({stroke:"none",opacity:p,fill:d})),i(x[x.length-1],l*(y/100)));var D={x:0};s.show&&m.push(h.text(10,0+(u+1)*f-f/2,c.actual.label).attr(_)),a.show&&g.push(h.text(l-10,0+(u+1)*f-f/2,c.actual.total).attr(w)),a.show&&o.show&&(D=g.length?g.getBBox():D,g.push(h.text(-3+D.x,0+(u+1)*f-f/2,"/").attr(w))),o.show&&(D=g.length?g.getBBox():D,g.push(h.text(-3+D.x,0+(u+1)*f-f/2,c.actual.value).attr(b))),r.show&&(D=g.length?g.getBBox():D,g.push(h.text(-15+D.x,0+(u+1)*f-f/2,"("+y+"%)").attr(v)))}}));var k=e.canvas.paper.setFinish();e.setNewData(k)}},"077a95d378bbdfa3bf1f":(e,t,a)=>{a("182b12616a2926778c69")(a("5530efb4f964fae4f0ae"))},"09cc58666efaa723a803":()=>{},"09f595d6f923b7e5d9a4":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca");n.shape.fishbone.cell.IFRouternode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.IFRouternode",INFO:"{Class: <strong>IFRouternode</strong>}<br/><br/> <strong>Code </strong><cite>Node </cite>Provide logical IF functionality based on condition port state. If there is no data on condition port return False and oposite.<br/><br/><strong>Configuration: </strong>",init:function(e,t,a,r){this._super(o.extend({color:"#2d9068",items:{}},e),t,a,r);var s=this;this.sites_list_in=[],o.extend(this.userData,{label:"IF Router",type_name:"ifr"}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{label:{type:"string",format:"hidden",default:""},type_name:{type:"string",title:"Type Name",default:"gap"}}}),this.getRealCount=function(){return 1},this.GetHTTPData=function(){s.startTimer(),s.userData.sites_list_out=this.sites_list_in,s.userData.value=s.userData.sites_list_out.length;var e=s.getPort("output_yes"),t=s.getPort("output_no");this.condition&&this.sites_list_in&&this.sites_list_in.length?(e.setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label,task_type:s.userData.type_name||"yesno",sites_list_out:s.userData.sites_list_out}),e.getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.setValue(s.getId()),i.getMessage(s,a,"data send to"),t.setColor(s.frame.attr("stroke"))}),this))):(t.setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label,task_type:s.userData.type_name||"yesno",sites_list_out:s.userData.sites_list_out}),t.getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.setValue(s.getId()),i.getMessage(s,a,"data send to"),t.setColor(s.frame.attr("stroke"))}),this))),s.stopTimer(),s.updateUI()};var l=null;(l=new n.OutputPort).setBackgroundColor("#009adc"),l.setName("output_yes"),this.addPort(l);var c=null;(c=new n.OutputPort).setBackgroundColor("#d73a00"),c.setName("output_no"),this.addPort(c);var u=null;(u=new n.DataInputPort).setConnectionDirection(3),u.setBackgroundColor("#26cc00"),u.setName("dataInput"),this.addPort(u);var d=null;(d=new n.DataInputPort).setConnectionDirection(3),d.setBackgroundColor("#ff8000"),d.setName("condition"),this.addPort(d),this.setDimension(this.width,this.height),this.layoutPorts()},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):(this.top_label.setText("IF Router"),this.userData.label="IF Router"),this.filter_label.setText("IFR"),this._super(this)},onPortValueChanged:function(e){var t=this,a=e.getConnections().data[0].getSource();e.getValue().indexOf("ticket")>-1?(i.getMessage(t,e,"ticket received from"),"dataInput"===e.name&&(t.project=a.getUserData().project,t.scope=a.getUserData().scope,t.getOutputPorts().data.forEach((function(a,n){a.getConnections().each(o.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),i.getMessage(t,o,"ticket send to"),o.superUpdate=!!e.superUpdate,o.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||n.setColor("#dfdfdf")}),this))})))):"dataInput"===e.name?(t.project=a.getUserData().project,t.scope=a.getUserData().scope,this.sites_list_in=a.getUserData().sites_list_out,this.conditionUpdated&&this.GetHTTPData()):"condition"===e.name&&(a=e.getConnections().data[0].getSource(),t.project=a.getUserData().project,t.scope=a.getUserData().scope,a.getUserData().sites_list_out&&a.getUserData().sites_list_out.length?this.condition=!0:this.condition=!1,this.conditionUpdated=!0,this.sites_list_in.length&&this.GetHTTPData())}})},"0b3eaaaf500f06006898":function(e,t,a){(function(){var e,t,n,o,i,r,s,l,c={}.hasOwnProperty,u=[].slice;e=a("a45670b3d8fb79ec0258"),t=function(e){var t;function a(e,t){a.__super__.constructor.call(this,e,t)}return function(e,t){for(var a in t)c.call(t,a)&&(e[a]=t[a]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(a,e),t=function(e,t,a,n,o){var i,r,s,l,c,u,d;for(c=[],i=!1,l=0,u=n.length;l<u;l++)r=n[l],c.push(null!=(d=e[r])?d:"null"),t[s=c.join(String.fromCharCode(0))]||(t[s]=o(c.slice()),i=!0),t[s].push(e);return i&&a.push(c),c},a.prototype.processRecord=function(e){var a,n,o,i,r,s,l,c,u,d,p,h,f,m;if(f=[],a=[],this.allTotal.push(e),f=t(e,this.rowTotals,this.rowKeys,this.rowAttrs,(m=this,function(e){return m.aggregator(m,e,[])})),a=t(e,this.colTotals,this.colKeys,this.colAttrs,function(e){return function(t){return e.aggregator(e,[],t)}}(this)),u=f.length-1,d=a.length-1,!(u<0||d<0)){for(h=[],s=c=0,p=u;0<=p?c<=p:c>=p;s=0<=p?++c:--c)o=f.slice(0,s+1),r=o.join(String.fromCharCode(0)),this.tree[r]||(this.tree[r]={}),h.push(function(){var t,s,c;for(c=[],l=t=0,s=d;0<=s?t<=s:t>=s;l=0<=s?++t:--t)n=a.slice(0,l+1),i=n.join(String.fromCharCode(0)),this.tree[r][i]||(this.tree[r][i]=this.aggregator(this,o,n)),c.push(this.tree[r][i].push(e));return c}.call(this));return h}},a}(e.pivotUtilities.PivotData),e.pivotUtilities.SubtotalPivotData=t,n=function(t,a){var n,o,i,r,s,l,u,d,p,h,f,m,g,y,_,b,v,w,x,k,D,S,C,T,A,P,E,I,N,M,O,j,R,L,F,U,B,z,H,q,V,W,G,J,Q,Y,X,K,Z,$,ee,te,ae,ne,oe,ie,re,se,le,ce,ue,de,pe,he,fe;return V={table:{clickCallback:null},localeStrings:{totals:"Totals",subtotalOf:"Subtotal of"},arrowCollapsed:"▶",arrowExpanded:"◢",rowSubtotalDisplay:{displayOnTop:!0,disableFrom:99999,collapseAt:99999,hideOnExpand:!1,disableExpandCollapse:!1},colSubtotalDisplay:{displayOnTop:!0,disableFrom:99999,collapseAt:99999,hideOnExpand:!1,disableExpandCollapse:!1}},(a=e.extend(!0,{},V,a)).rowSubtotalDisplay.disableSubtotal&&(a.rowSubtotalDisplay.disableFrom=0),void 0!==a.rowSubtotalDisplay.disableAfter&&null!==a.rowSubtotalDisplay.disableAfter&&(a.rowSubtotalDisplay.disableFrom=a.rowSubtotalDisplay.disableAfter+1),void 0!==a.rowSubtotalDisplay.collapseAt&&null!==a.collapseRowsAt&&(a.rowSubtotalDisplay.collapseAt=a.collapseRowsAt),a.colSubtotalDisplay.disableSubtotal&&(a.colSubtotalDisplay.disableFrom=0),void 0!==a.colSubtotalDisplay.disableAfter&&null!==a.colSubtotalDisplay.disableAfter&&(a.colSubtotalDisplay.disableFrom=a.colSubtotalDisplay.disableAfter+1),void 0!==a.colSubtotalDisplay.collapseAt&&null!==a.collapseColsAt&&(a.colSubtotalDisplay.collapseAt=a.collapseColsAt),I=t.colAttrs,ce=t.rowAttrs,ue=t.getRowKeys(),N=t.getColKeys(),fe=t.tree,de=t.rowTotals,M=t.colTotals,i=t.allTotal,T="rowhide",A="rowshow",w="colhide",x="colshow",E="expanded",P="collapsed",D="expanded",k="collapsed",C="rowexpanded",S="rowcollapsed",v="colexpanded",b="colcollapsed",s=a.arrowExpanded,r=a.arrowCollapsed,ae=function(e,t){var a;return a=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g"),null!==e.className.match(a)},se=function(e,t){var a,n,o,i,r,s;for(s=[],a=0,n=(i=t.split(" ")).length;a<n;a++)o=i[a],r=new RegExp("(?:^|\\s)"+o+"(?!\\S)","g"),s.push(e.className=e.className.replace(r,""));return s},n=function(e,t){var a,n,o,i,r;for(r=[],a=0,n=(i=t.split(" ")).length;a<n;a++)o=i[a],ae(e,o)?r.push(void 0):r.push(e.className+=" "+o);return r},le=function(e,t,a){return se(e,t),n(e,a)},q=function(e,t,a,n,o){var i,r,s,l,u;if(r=document.createElement(e),null!=t&&(r.className=t),null!=a&&(r.textContent=a),null!=n)for(i in n)c.call(n,i)&&(u=n[i],r.setAttribute(i,u));if(null!=o)for(s in o)c.call(o,s)&&(l=o[s],r.addEventListener(s,l));return r},re=function(e,t,a){var n,o,i;return o=e[0].length-1,n={children:[]},i=0,e.reduce((function(e,a){var r;return r=0,a.reduce((function(e,s,l,c){var u,d,p,h,f;if(e[s]||(p=a.slice(0,r+1),e[s]={row:i,col:r,descendants:0,children:[],text:s,key:p,flatKey:p.join(String.fromCharCode(0)),firstLeaf:null,leaves:0,parent:0!==r?e:null,th:q("th",t,s),childrenSpan:0},e.children.push(s)),r>0&&e.descendants++,r++,l===o){for(h=n,u=d=0,f=o-1;0<=f?d<=f:d>=f;u=0<=f?++d:--d)o>0&&(h[a[u]].leaves++,h[a[u]].firstLeaf||(h[a[u]].firstLeaf=e[s]),h=h[a[u]]);return n}return e[s]}),n),i++,n}),n),n},l=function(e,t,a,n){var o,i,l;return o={text:a[t],expandedCount:0,expandables:0,attrHeaders:[],clickStatus:E,onClick:O},i=s+" ",l=D,t>=n.collapseAt&&(i=r+" ",l=k,o.clickStatus=P,o.onClick=W),(t===a.length-1||t>=n.disableFrom||n.disableExpandCollapse)&&(i=""),o.th=q("th","pvtAxisLabel "+l,""+i+o.text),t<a.length-1&&t<n.disableFrom&&!n.disableExpandCollapse&&(o.th.onclick=function(i){return i=i||window.event,o.onClick(e,t,a,n)}),e.ah.push(o),o},u=function(e,t,a,n){var o,i,r,s,c;for(i={collapseAttrHeader:F,expandAttrHeader:Q,ah:[]},r=s=0,c=a.length;s<c;r=++s)a[r],(o=l(i,r,a,n.colSubtotalDisplay)).tr=q("tr"),0===r&&0!==t.length&&o.tr.appendChild(q("th",null,null,{colspan:t.length,rowspan:a.length})),o.tr.appendChild(o.th),e.appendChild(o.tr);return i},m=function(e,t,a,n){var o,i,r,s,c,u;for(i={collapseAttrHeader:B,expandAttrHeader:K,ah:[],tr:q("tr")},r=s=0,c=t.length-1;0<=c?s<=c:s>=c;r=0<=c?++s:--s)o=l(i,r,t,n.rowSubtotalDisplay),i.tr.appendChild(o.th);return 0!==a.length&&(u=q("th"),i.tr.appendChild(u)),e.appendChild(i.tr),i},ee=function(e,t,a){var n;return n=" "+s+" ",(e.col===t.length-1||e.col>=a.disableFrom||a.disableExpandCollapse||0===e.children.length)&&(n=""),""+n+e.text},d=function(e,t,a,o,i,r,s){var l,c,u,p,h,f;for(u=0,p=(h=a.children).length;u<p;u++)c=h[u],d(e,t,a[c],o,i,r,s);return(l=e.ah[a.col]).attrHeaders.push(a),a.node=r.counter,a.onClick=F,n(a.th,x+" col"+a.row+" colcol"+a.col+" "+v),a.th.setAttribute("data-colnode",a.node),0!==a.children.length&&(a.th.colSpan=a.childrenSpan),0===a.children.length&&0!==o.length&&(a.th.rowSpan=2),a.th.textContent=ee(a,i,s.colSubtotalDisplay),0!==a.children.length&&a.col<s.colSubtotalDisplay.disableFrom&&(l.expandables++,l.expandedCount+=1,s.colSubtotalDisplay.hideOnExpand||a.th.colSpan++,s.colSubtotalDisplay.disableExpandCollapse||(a.th.onclick=function(t){return t=t||window.event,a.onClick(e,a,s.colSubtotalDisplay)}),a.sTh=q("th","pvtColLabelFiller "+x+" col"+a.row+" colcol"+a.col+" "+v),a.sTh.setAttribute("data-colnode",a.node),a.sTh.rowSpan=i.length-a.col,s.colSubtotalDisplay.hideOnExpand&&le(a.sTh,x,w),a[a.children[0]].tr.appendChild(a.sTh)),null!=(f=a.parent)&&(f.childrenSpan+=a.th.colSpan),a.clickStatus=E,l.tr.appendChild(a.th),a.tr=l.tr,t.push(a),r.counter++},y=function(e,t,n){var o;return o=q("th","pvtTotalLabel rowTotal",a.localeStrings.totals,{rowspan:0===n.length?1:n.length+(0===t.length?0:1)}),e.appendChild(o)},g=function(e,t,a,o,i,r,s,l){var c,u,d,p,h,f,m;for(p=0,h=(f=o.children).length;p<h;p++)u=f[p],g(e,t,a,o[u],i,r,s,l);return(c=t.ah[o.col]).attrHeaders.push(o),o.node=s.counter,o.onClick=B,0!==o.children.length&&(d=o[o.children[0]]),n(o.th,A+" row"+o.row+" rowcol"+o.col+" "+C),o.th.setAttribute("data-rownode",o.node),o.col===i.length-1&&0!==r.length&&(o.th.colSpan=2),0!==o.children.length&&(o.th.rowSpan=o.childrenSpan),o.th.textContent=ee(o,i,l.rowSubtotalDisplay),o.tr=q("tr","row"+o.row),o.tr.appendChild(o.th),0===o.children.length?e.appendChild(o.tr):e.insertBefore(o.tr,d.tr),0!==o.children.length&&o.col<l.rowSubtotalDisplay.disableFrom&&(++c.expandedCount,++c.expandables,l.rowSubtotalDisplay.disableExpandCollapse||(o.th.onclick=function(e){return e=e||window.event,o.onClick(t,o,l.rowSubtotalDisplay)}),o.sTh=q("th","pvtRowLabelFiller row"+o.row+" rowcol"+o.col+" "+C+" "+A),l.rowSubtotalDisplay.hideOnExpand&&le(o.sTh,A,T),o.sTh.setAttribute("data-rownode",o.node),o.sTh.colSpan=i.length-(o.col+1)+(0!==r.length?1:0),l.rowSubtotalDisplay.displayOnTop?o.tr.appendChild(o.sTh):(o.th.rowSpan+=1,o.sTr=q("tr","row"+o.row),o.sTr.appendChild(o.sTh),e.appendChild(o.sTr))),0!==o.children.length&&o.th.rowSpan++,null!=(m=o.parent)&&(m.childrenSpan+=o.th.rowSpan),o.clickStatus=E,a.push(o),s.counter++},te=function(e,a,n,o,i,r){var s,l,u,d,p,h,f,m;if(null!=(f=r.table)?f.eventHandlers:void 0){for(l in u={},m=r.table.eventHandlers)if(c.call(m,l)){for(h in p=m[l],d={},i)c.call(i,h)&&(s=i[h],null!=n[h]&&(d[s]=n[h]));for(h in o)c.call(o,h)&&(s=o[h],null!=a[h]&&(d[s]=a[h]));u[l]=function(a){return p(a,e,d,t)}}return u}},_=function(e,t,a,n,o,i){var r,s,l,c,u,d,p,h,f,m,g,y,_,b,k;for(m=[],c=0,d=a.length;c<d;c++)if((g=a[c]).col===n.length-1||0!==g.children.length&&g.col<i.rowSubtotalDisplay.disableFrom){for(h="pvtVal row"+g.row+" rowcol"+g.col+" "+C,g.children.length>0?(h+=" pvtRowSubtotal",h+=i.rowSubtotalDisplay.hideOnExpand?" "+T:"  "+A):h+=" "+A,b=g.sTr?g.sTr:g.tr,u=0,p=t.length;u<p;u++)((s=t[u]).col===o.length-1||0!==s.children.length&&s.col<i.colSubtotalDisplay.disableFrom)&&(k=(r=null!=(f=fe[g.flatKey][s.flatKey])?f:{value:function(){return null},format:function(){return""}}).value(),l=" "+h+" col"+s.row+" colcol"+s.col+" "+v,s.children.length>0?(l+=" pvtColSubtotal",l+=i.colSubtotalDisplay.hideOnExpand?" "+w:" "+x):l+=" "+x,y=q("td",l,r.format(k),{"data-value":k,"data-rownode":g.node,"data-colnode":s.node},te(k,g.key,s.key,n,o,i)),b.appendChild(y));k=(_=de[g.flatKey]).value(),y=q("td","pvtTotal rowTotal "+h,_.format(k),{"data-value":k,"data-row":"row"+g.row,"data-rowcol":"col"+g.col,"data-rownode":g.node},te(k,g.key,[],n,o,i)),m.push(b.appendChild(y))}return m},h=function(e,t){var n,o,i;return i=q("tr"),n=e.length+(0===t.length?0:1),o=q("th","pvtTotalLabel colTotal",a.localeStrings.totals,{colspan:n}),i.appendChild(o),i},p=function(e,t,a,n,o){var i,r,s,l,c,u,d,p;for(c=[],s=0,l=t.length;s<l;s++)((r=t[s]).col===n.length-1||0!==r.children.length&&r.col<o.colSubtotalDisplay.disableFrom)&&(i="pvtVal pvtTotal colTotal "+v+" col"+r.row+" colcol"+r.col,0!==r.children.length?(i+=" pvtColSubtotal",i+=o.colSubtotalDisplay.hideOnExpand?" "+w:" "+x):i+=" "+x,p=(d=M[r.flatKey]).value(),u=q("td",i,d.format(p),{"data-value":p,"data-for":"col"+r.col,"data-colnode":""+r.node},te(p,[],r.key,a,n,o)),c.push(e.appendChild(u)));return c},f=function(e,t,a,n,o){var r,s,l;return l=(s=i).value(),r=q("td","pvtGrandTotal",s.format(l),{"data-value":l},te(l,[],[],a,n,o)),t.appendChild(r),e.appendChild(t)},j=function(e,t,a){var n,o,i,s,l,c,u;if(!(t>(o=Math.min(e.ah.length-2,a.disableFrom-1)))){for(u=[],i=s=l=t,c=o;l<=c?s<=c:s>=c;i=l<=c?++s:--s)n=e.ah[i],le(n.th,D,k),n.th.textContent=" "+r+" "+n.text,n.clickStatus=P,u.push(n.onClick=W);return u}},o=function(e,t,a){var n;return 0===(n=e.ah[t]).expandedCount?j(e,t,a):n.expandedCount===n.expandables?(le(n.th,k,D),n.th.textContent=" "+s+" "+n.text,n.clickStatus=E,n.onClick=O):void 0},ne=function(t){return e(t.th).closest("table.pvtTable").find('tbody tr td[data-colnode="'+t.node+'"], th[data-colnode="'+t.node+'"]').removeClass(x).addClass(w)},U=function(t,a){return e(t.th).closest("table.pvtTable").find('tbody tr td[data-colnode="'+t.node+'"], th[data-colnode="'+t.node+'"]').removeClass(v).addClass(b),0!==t.children.length&&(t.th.textContent=" "+r+" "+t.text),t.th.colSpan=1},z=function(t,a){return e(t.th).closest("table.pvtTable").find('tbody tr td[data-colnode="'+t.node+'"], th[data-colnode="'+t.node+'"]').removeClass(v).addClass(b).removeClass(w).addClass(x),0!==t.children.length&&(t.th.textContent=" "+r+" "+t.text),t.th.colSpan=1},R=function(e,t){var a,n,o,i;for(n=0,o=(i=e.children).length;n<o;n++)a=i[n],ae(e[a].th,x)&&R(e[a],t);return ne(e)},F=function(e,t,a){var n,i,r,s,l,c;for(i=t.th.colSpan-1,r=0,s=(c=t.children).length;r<s;r++)n=c[r],ae(t[n].th,x)&&R(t[n],t);for(t.col<a.disableFrom&&(ae(t.th,w)?U(t):z(t)),l=t.parent;l;)l.th.colSpan-=i,l=l.parent;return t.clickStatus=P,t.onClick=Q,e.ah[t.col].expandedCount--,o(e,t.col,a)},pe=function(t){return e(t.th).closest("table.pvtTable").find('tbody tr td[data-colnode="'+t.node+'"], th[data-colnode="'+t.node+'"]').removeClass(w).addClass(x)},Y=function(t){return e(t.th).closest("table.pvtTable").find('tbody tr td[data-colnode="'+t.node+'"], th[data-colnode="'+t.node+'"]').removeClass(b+" "+x).addClass(v+" "+w),le(t.th,w,x),t.th.textContent=" "+s+" "+t.text},Z=function(t){return e(t.th).closest("table.pvtTable").find('tbody tr td[data-colnode="'+t.node+'"], th[data-colnode="'+t.node+'"]').removeClass(b+" "+w).addClass(v+" "+x),t.th.colSpan++,t.th.textContent=" "+s+" "+t.text},G=function(e,t){var a,n,o,i,r;if(0!==e.children.length&&t.hideOnExpand&&e.clickStatus===E?le(e.th,w,x):pe(e),e.sTh&&e.clickStatus===E&&t.hideOnExpand&&le(e.sTh,x,w),e.clickStatus===E||e.col>=t.disableFrom){for(r=[],n=0,o=(i=e.children).length;n<o;n++)a=i[n],r.push(G(e[a],t));return r}},Q=function(e,t,a){var n,i,r,s,l,c;if(t.clickStatus!==E){for(i=0,r=0,s=(c=t.children).length;r<s;r++)n=t[c[r]],G(n,a),i+=n.th.colSpan;for(t.th.colSpan=i,t.col<a.disableFrom&&(a.hideOnExpand?(Y(t),--i):Z(t)),l=t.parent;l;)l.th.colSpan+=i,l=l.parent;return t.clickStatus=E,t.onClick=F,e.ah[t.col].expandedCount++,o(e,t.col,a)}o(e,t.col,a)},oe=function(e,t){var a,n,o,i,r,s,l,c;for(n=0,i=(s=e.tr.querySelectorAll("th, td")).length;n<i;n++)a=s[n],le(a,A,T);if(e.sTr){for(c=[],o=0,r=(l=e.sTr.querySelectorAll("th, td")).length;o<r;o++)a=l[o],c.push(le(a,A,T));return c}},H=function(e,t){var a,o,i,s,l,c,u,d;for(e.th.textContent=" "+r+" "+e.text,o=0,s=(c=e.tr.querySelectorAll("th, td")).length;o<s;o++)a=c[o],se(a,C+" "+T),n(a,S+" "+A);if(e.sTr){for(d=[],i=0,l=(u=e.sTr.querySelectorAll("th, td")).length;i<l;i++)a=u[i],se(a,C+" "+T),d.push(n(a,S+" "+A));return d}},L=function(e,t,a){var n,o,i,r;for(o=0,i=(r=e.children).length;o<i;o++)n=r[o],L(e[n],t,a);return oe(e)},B=function(e,t,a){var n,i,r,s;for(i=0,r=(s=t.children).length;i<r;i++)n=s[i],L(t[n],t,a);return H(t),t.clickStatus=P,t.onClick=K,e.ah[t.col].expandedCount--,o(e,t.col,a)},he=function(e,t){var a,n,o,i,r,s,l,c;for(n=0,i=(s=e.tr.querySelectorAll("th, td")).length;n<i;n++)a=s[n],le(a,T,A);if(e.sTr){for(c=[],o=0,r=(l=e.sTr.querySelectorAll("th, td")).length;o<r;o++)a=l[o],c.push(le(a,T,A));return c}},$=function(e,t){var a,o,i,r,l,c,u,d;for(e.th.textContent=" "+s+" "+e.text,o=0,r=(c=e.tr.querySelectorAll("th, td")).length;o<r;o++)a=c[o],se(a,S+" "+T),n(a,C+" "+A);if(e.sTr){for(d=[],i=0,l=(u=e.sTr.querySelectorAll("th, td")).length;i<l;i++)a=u[i],se(a,S+" "+T),d.push(n(a,C+" "+A));return d}},X=function(e,t){var a,o,i,r,l,c,u,d;for(e.th.textContent=" "+s+" "+e.text,o=0,r=(c=e.tr.querySelectorAll("th, td")).length;o<r;o++)a=c[o],se(a,S+" "+A),n(a,C+" "+T);if(se(e.th,S+" "+T),n(a,C+" "+A),e.sTr){for(d=[],i=0,l=(u=e.sTr.querySelectorAll("th, td")).length;i<l;i++)a=u[i],se(a,S+" "+A),d.push(n(a,C+" "+T));return d}},J=function(e,t){var a,n,o,i,r;if(0!==e.children.length&&t.hideOnExpand&&e.clickStatus===E?le(e.th,T,A):he(e),e.sTh&&e.clickStatus===E&&t.hideOnExpand&&le(e.sTh,A,T),e.clickStatus===E||e.col>=t.disableFrom){for(r=[],n=0,o=(i=e.children).length;n<o;n++)a=i[n],r.push(J(e[a],t));return r}},K=function(e,t,a){var n,i,r,s;if(t.clickStatus!==E){for(i=0,r=(s=t.children).length;i<r;i++)n=t[s[i]],J(n,a);return 0!==t.children.length&&(a.hideOnExpand?X(t):$(t)),t.clickStatus=E,t.onClick=B,e.ah[t.col].expandedCount++,o(e,t.col,a)}o(e,t.col,a)},O=function(e,t,a,n){var o,i,r,s,l,c;if(!(t>(o=Math.min(a.length-2,n.disableFrom-1)))){for(c=[],r=s=o,l=t;s>=l;r=s+=-1)c.push(function(){var t,a,o,s;for(s=[],t=0,a=(o=e.ah[r].attrHeaders).length;t<a;t++)(i=o[t]).clickStatus===E&&0!==i.children.length&&s.push(e.collapseAttrHeader(e,i,n));return s}());return c}},W=function(e,t,a,n){var o,i,r,s,l;for(e.ah[t],l=[],i=r=0,s=t;0<=s?r<=s:r>=s;i=0<=s?++r:--r)l.push(function(){var t,a,r,s;for(s=[],t=0,a=(r=e.ah[i].attrHeaders).length;t<a;t++)o=r[t],s.push(e.expandAttrHeader(e,o,n));return s}());return l},ie=function(e,t,n,o){var i,r,s,l,c,b,v,w,x,k,D,S,C,T,A,P,E,I;if(C=[],r=[],0!==n.length&&0!==o.length&&(l=re(o,"pvtColLabel")),0!==e.length&&0!==t.length&&(A=re(t,"pvtRowLabel")),S=q("table","pvtTable",null,{style:"display: none;"}),E=q("thead"),S.appendChild(E),0!==n.length){for(s=u(E,e,n,a),x={counter:0},c=0,v=(k=l.children).length;c<v;c++)i=k[c],d(s,r,l[i],e,n,x,a);y(s.ah[0].tr,e,n)}if(P=q("tbody"),S.appendChild(P),0!==e.length)for(T=m(E,e,n,a),0===n.length&&y(T.tr,e,n),x={counter:0},b=0,w=(D=A.children).length;b<w;b++)i=D[b],g(P,T,C,A[i],e,n,x,a);return _(0,r,C,e,n,a),I=h(e,n),n.length>0&&p(I,r,e,n,a),f(P,I,e,n,a),O(s,a.colSubtotalDisplay.collapseAt,n,a.colSubtotalDisplay),O(T,a.rowSubtotalDisplay.collapseAt,e,a.rowSubtotalDisplay),S.setAttribute("data-numrows",t.length),S.setAttribute("data-numcols",o.length),S.style.display="",S},ie(ce,ue,I,N)},e.pivotUtilities.subtotal_renderers={"Table With Subtotal":function(e,t){return n(e,t)},"Table With Subtotal Bar Chart":function(t,a){return e(n(t,a)).barchart()},"Table With Subtotal Heatmap":function(t,a){return e(n(t,a)).heatmap("heatmap",a)},"Table With Subtotal Row Heatmap":function(t,a){return e(n(t,a)).heatmap("rowheatmap",a)},"Table With Subtotal Col Heatmap":function(t,a){return e(n(t,a)).heatmap("colheatmap",a)}},r=e.pivotUtilities.numberFormat({digitsAfterDecimal:1,scaler:100,suffix:"%"}),o=e.pivotUtilities.aggregatorTemplates,i={fractionOf:function(e,t,a){return null==t&&(t="row"),null==a&&(a=r),function(){var n;return n=1<=arguments.length?u.call(arguments,0):[],function(o,i,r){return void 0===i&&(i=[]),void 0===r&&(r=[]),{selector:{row:[i.slice(0,-1),[]],col:[[],r.slice(0,-1)]}[t],inner:e.apply(null,n)(o,i,r),push:function(e){return this.inner.push(e)},format:a,value:function(){return this.inner.value()/o.getAggregator.apply(o,this.selector).inner.value()},numInputs:e.apply(null,n)().numInputs}}}}},e.pivotUtilities.subtotalAggregatorTemplates=i,e.pivotUtilities.subtotal_aggregators={"Sum As Fraction Of Parent Row":(l=i).fractionOf((s=o).sum(),"row",r),"Sum As Fraction Of Parent Column":l.fractionOf(s.sum(),"col",r),"Count As Fraction Of Parent Row":l.fractionOf(s.count(),"row",r),"Count As Fraction Of Parent Column":l.fractionOf(s.count(),"col",r)}}).call(this)},"0e8d7d7a4544b88ffebe":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.label.Memo=n.shape.basic.Label.extend({NAME:"draw2d.shape.fishbone.label.Memo",INFO:"{Class: <strong>draw2d.shape.fishbone.label.Memo</strong>}<br/><br/>",init:function(e,t,a){this._super(o.extend({text:"Simple Memo \n",color:"rgba(255, 255, 255, 0)",radius:10,padding:10,stroke:1},e),t,a);var n=this.getUserData(),i=this;null===n&&this.attr({userData:{hidden:!1,index:0,font:{font_size:18,font_color:"#000",font_family:"Tahoma, Geneva",font_bold:!0},back_color:"",frame_size:0,frame_color:"#989799",padding:10,text:"Simple Memo\n"}}),this.setParams=function(){i.setFontSize(this.userData.font.font_size),i.setFontColor(this.userData.font.font_color),i.setFontFamily(this.userData.font.font_family),i.setBackgroundColor(""===this.userData.back_color?null:this.userData.back_color),i.setStroke(this.userData.frame_size),i.setColor(this.userData.frame_color),i.setPadding(this.userData.padding),i.setBold(this.userData.font.font_bold),i.setText(this.userData.text)},this.setParams(),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0},font:{type:"object",additionalProperties:!1,properties:{font_size:{type:"integer",title:"Font Size",default:24},font_color:{type:"string",format:"colorpicker",title:"Font Color",default:"#000"},font_family:{type:"string",title:"Font Family",default:"Tahoma, Geneva"},font_bold:{type:"boolean",title:"Font Bold",default:!1}}},back_color:{type:"string",format:"colorpicker",title:"Back Color"},frame_size:{type:"integer",title:"Frame Size",default:1},frame_color:{type:"string",format:"colorpicker",title:"Frame Color",default:"#989799"},padding:{type:"integer",title:"Padding",default:10},text:{type:"string",format:"ace",aceMode:"ace/mode/text",disableWorker:!1,title:"Text",default:"Simple Label\n"}}},this.GetHTTPData=function(){this.setParams()}}})},"0f5f6c58c44433ecd53f":e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function a(){var e,t,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",r=o.toStringTag||"@@toStringTag";function s(a,o,i,r){var s=o&&o.prototype instanceof c?o:c,u=Object.create(s.prototype);return n(u,"_invoke",function(a,n,o){var i,r,s,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,r=0,s=e,p.n=a,l}};function h(a,n){for(r=a,s=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(s=i[(r=i[4])?5:(r=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(r=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,r=0))}if(o||a>1)return l;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),r=u,s=f;(t=r<2?e:s)||!d;){i||(r?r<3?(r>1&&(p.n=-1),h(r,s)):p.n=s:p.v=s);try{if(c=2,i){if(r||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,r<2&&(r=0)}else 1===r&&(t=i.return)&&t.call(i),r<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),r=1);i=e}else if((t=(d=p.n<0)?s:a.call(n,p))!==l)break}catch(t){i=e,r=1,s=t}finally{c=1}}return{value:t,done:d}}}(a,i,r),!0),u}var l={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var p=[][i]?t(t([][i]())):(n(t={},i,(function(){return this})),t),h=d.prototype=c.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,n(e,r,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,n(h,"constructor",d),n(d,"constructor",u),u.displayName="GeneratorFunction",n(d,r,"GeneratorFunction"),n(h),n(h,r,"Generator"),n(h,i,(function(){return this})),n(h,"toString",(function(){return"[object Generator]"})),(a=function(){return{w:s,m:f}})()}function n(e,t,a,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}n=function(e,t,a,o){function r(t,a){n(e,t,(function(e){return this._invoke(t,a,e)}))}t?i?i(e,t,{value:a,enumerable:!o,configurable:!o,writable:!o}):e[t]=a:(r("next",0),r("throw",1),r("return",2))},n(e,t,a,o)}function o(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function i(e){return function(){var t=this,a=arguments;return new Promise((function(n,i){var r=e.apply(t,a);function s(e){o(r,n,i,s,l,"next",e)}function l(e){o(r,n,i,s,l,"throw",e)}s(void 0)}))}}function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var a=function(e){if("object"!=t(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,"string");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(a)?a:a+""}var l=function(){return e=function e(t,a,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.settings=a,this.embeddingService=n},t=[{key:"storeBranch",value:(o=i(a().m((function e(t){var n,o,i,r;return a().w((function(e){for(;;)switch(e.p=e.n){case 0:if(n="".concat(this.settings.context||"","/qdrant/functional-branch/store"),e.p=1,console.log("Calling backend to store branch ID: ".concat(t.id)),t.id){e.n=2;break}throw new Error("Branch is missing required id property");case 2:return t.nodes&&Array.isArray(t.nodes)||(console.warn("Branch ".concat(t.id," has missing or invalid nodes array")),t.nodes=t.nodes||[]),t.connections&&Array.isArray(t.connections)||(console.warn("Branch ".concat(t.id," has missing or invalid connections array")),t.connections=t.connections||[]),e.n=3,this.$http.post(n,{branch:t});case 3:if(!(o=e.v).data||!o.data.success){e.n=4;break}return console.log("Backend successfully stored branch ID: ".concat(o.data.id)),e.a(2,o.data.id);case 4:throw console.error("Backend failed to store branch:",o.data),new Error((null===(i=o.data)||void 0===i?void 0:i.error)||"Unknown error storing branch via backend");case 5:e.n=7;break;case 6:throw e.p=6,r=e.v,console.error("Error calling backend to store branch ID ".concat(t.id,":"),r),new Error("Failed to store branch ".concat(t.id,": ").concat(r.message));case 7:return e.a(2)}}),e,this,[[1,6]])}))),function(e){return o.apply(this,arguments)})},{key:"findSimilarBranches",value:(n=i(a().m((function e(t){var n,o,i,r,s,l,c=arguments;return a().w((function(e){for(;;)switch(e.p=e.n){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:{},o="".concat(this.settings.context||"","/qdrant/functional-branch/search"),i={query:t,limit:n.limit||5,score_threshold:n.score_threshold||.7,filters:n.filters||{}},e.p=1,console.log('Calling backend to search branches with query: "'.concat(t,'"')),e.n=2,this.$http.post(o,i);case 2:return s=e.v,console.log("Backend search returned ".concat((null===(r=s.data)||void 0===r?void 0:r.length)||0," results.")),e.a(2,s.data);case 3:return e.p=3,l=e.v,console.error('Error calling backend to search branches for query "'.concat(t,'":'),l),e.a(2,[])}}),e,this,[[1,3]])}))),function(e){return n.apply(this,arguments)})}],t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,o}();e.exports=l},"110432cd068f6fa15fe7":(e,t,a)=>{"use strict";a("8deafab7866a125bb9ca"),a("a45670b3d8fb79ec0258"),Raphael.fn.drawRaGrid=function(e,t,a,n,o,i,r,s,l,c){c=c||"#777",s=s||"#777",l=l||"#777";var u=[],d=["M",Math.round(t)+.5-5,Math.round(a)+.5,"L",Math.round(t+n)+.5+5,Math.round(a)+.5,"M",Math.round(t)+.5-5,Math.round(a+o)+.5,"L",Math.round(t+n)+.5+5,Math.round(a+o)+.5,"M",Math.round(t)+.5,Math.round(a)+.5-5,"L",Math.round(t)+.5,Math.round(a+o)+.5+5,"M",Math.round(t+n)+.5,Math.round(a)+.5-5,"L",Math.round(t+n)+.5,Math.round(a+o)+.5+5],p=o/r,h=n/i;if(u.push(this.path(d.join(",")).attr({stroke:c})),e.pivot.hor_lines){for(var f=[],m=1;m<r;m++)f=f.concat(["M",Math.round(t)+.5,Math.round(a+m*p)+.5,"H",Math.round(t+n)+.5]);u.push(this.path(f.join(",")).attr({stroke:s}))}var g=[];for(m=1;m<r;m++)g=g.concat(["M",Math.round(t-5)+.5,Math.round(a+m*p)+.5,"H",Math.round(t)+.5]);if(u.push(this.path(g.join(",")).attr({stroke:c})),e.pivot.vert_lines){var y=[];for(m=1;m<i;m++)y=y.concat(["M",Math.round(t+m*h)+.5,Math.round(a)+.5,"V",Math.round(a+o)+.5]);u.push(this.path(y.join(",")).attr({stroke:l}))}var _=[];for(m=1;m<i;m++)_=_.concat(["M",Math.round(t+m*h)+.5,Math.round(a+o)+.5,"V",Math.round(a+o+5)+.5]);return u.push(this.path(_.join(",")).attr({stroke:c})),u}},"110548ced7d31fb0d987":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("6fe5e339b0f8a936ba8c"),r=a("8deafab7866a125bb9ca");n.shape.fishbone.cell.Tasknode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Tasknode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Tasknode</strong>}<br/><br/> <strong>Task API Node</strong><cite> - Simplified task data retrieval for AI report generation</cite><br/><br/><strong>Configuration: </strong><br/><br/><strong>Task Name*: </strong> <cite>Comma-separated task names (e.g., 'Site Survey,Integration')</cite>",init:function(e,t,a,r){this._super(o.extend({color:"#4da6ff"},e),t,a,r);var s=this;this.setDimension(160,35),this.sites_list_in=[],this.sites_list_out=[],o.extend(this.userData,{task_name:"",task_code:"",status:"",range_start_date:"",range_end_date:"",date_field:"actual_end_date",label:"",sites_list_out:[],isEditedLabel:!1}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{task_name:{type:"string",title:"Task Name(s)",default:"",description:"Comma-separated task names (e.g., 'Site Survey,Integration')"},task_code:{type:"string",title:"Task Code",default:"",description:"Optional task code filter"},status:{type:"string",title:"Task Status",default:"",enum:["","Completed","NotStart","OnGoing","Abandoned"]},range_start_date:{type:"string",title:"Start Date",default:"",description:"Filter start date (YYYY-MM-DD format)"},range_end_date:{type:"string",title:"End Date",default:"",description:"Filter end date (YYYY-MM-DD format)"},date_field:{type:"string",title:"Date Field",default:"actual_end_date",enum:["actual_end_date","actual_start_date","plan_end_date","plan_start_date"],description:"Which date field to filter on"},label:{type:"string",title:"Custom Label",default:"",description:"Custom display label (optional)"},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site"}},index:{type:"integer",title:"Mobile Index",default:0}}}),this.GetHTTPData=function(){DEBUG&&console.log("Tasknode: "+this.id+" init GetHTTPData.");var e=this.getUserData(),t=s.getPort("output0");s.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500));var a;a=""!==e.label?e.label:""!==e.task_name?e.task_name:""!==e.task_code?e.task_code:"Task Data";var n={project:this.project,scope:this.scope,sop:this.sop,col_name:a,id:this.getId(),figure_id:this.getId(),color:this.getColor()},r={proj_id:n.project.proj_id,user_id:window.user_id};if(e.task_name&&""!==e.task_name.trim()&&(r.task_name=e.task_name.trim()),e.task_code&&""!==e.task_code.trim()&&(r.task_code=e.task_code.trim()),n.sop&&n.sop.scope_id?r.du_model_id=n.sop.scope_id:n.scope&&n.scope.scope_id&&(r.du_model_id=n.scope.scope_id),e.status&&""!==e.status.trim()&&(r.status=e.status.trim()),this.sites_list_in&&this.sites_list_in.length>0){var l="empty,";this.sites_list_in.forEach((function(e,t){e.du_id&&(l=l+e.du_id+",")})),l=l.substr(0,l.length-1),r.du_id=l}e.range_start_date&&""!==e.range_start_date.trim()&&(r.range_start_date=e.range_start_date.trim()),e.range_end_date&&""!==e.range_end_date.trim()&&(r.range_end_date=e.range_end_date.trim()),(r.range_start_date||r.range_end_date)&&(r.date_field=e.date_field||"actual_end_date");var c=i.context+"/apidata/getAPIData?apiid=560278636079988736&user_id="+window.user_id;DEBUG&&console.log("Tasknode API call:",c,r),o.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:c,data:JSON.stringify(r),dataType:"json",success:function(e){DEBUG&&console.log("Tasknode data received:",e);var a=[];e&&e.data&&Array.isArray(e.data)?a=e.data:e&&Array.isArray(e)&&(a=e);var i={sites_list_out:a,item_name:n.col_name,project:n.project,scope:n.scope,sop:n.sop};t.userData=i,t.getConnections().each(o.proxy((function(e,a){var o=a.getTarget();o.setValue(n.figure_id),a.setColor(n.color),DEBUG&&console.log("Data sent from: "+t.getName()+" to: "+o.getParent().NAME)}),this)),function(e){s.userData.value=e.length,s.userData.sites_list_out=e,s.stopTimer(),s.updateUI()}(a)},error:function(e){console.error("Tasknode API error:",e),s.stopTimer(),s.val_label.setText("Err")}})},this.getRealCount=function(){return 1},this.createPort("output");var l=new n.DataInputPort;l.setConnectionDirection(3),l.setName("dataInput"),this.addPort(l),this.setDimension(this.width,this.height),this.layoutPorts(),this.repaint()},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value||0),this.userData.isEditedLabel&&this.userData.label?this.top_label.setText(this.userData.label):e.task_name?this.top_label.setText(e.task_name):e.task_code?this.top_label.setText(e.task_code):this.top_label.setText("Task Data"),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(a,n){a.getConnections().each(o.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),r.getMessage(t,o,"ticket send to"),o.superUpdate=!!e.superUpdate,o.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||n.setColor("#dfdfdf")}),this))}));else if("dataInput"===e.name){var a=this.getInputPort(0).getConnections();if(a&&a.data&&a.data.length>0){var n=a.data[0].getSource();this.sites_list_in=n.getUserData().sites_list_out||[],n.getUserData().project&&(this.project=n.getUserData().project),n.getUserData().scope&&(this.scope=n.getUserData().scope),n.getUserData().sop&&(this.sop=n.getUserData().sop),t.getCanvas().silentMode||this.val_label.setText("."),this.GetHTTPData()}}},getPersistentAttributes:function(){return this._super()},setPersistentAttributes:function(e){this._super(e)}})},"112dc8f6a3a8289e0553":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("chalk",{color:["#fc97af","#87f7cf","#f7f494","#72ccff","#f7c5a0","#d4a4eb","#d2f5a6","#76f2f2"],backgroundColor:"rgba(41,52,65,1)",textStyle:{},title:{textStyle:{color:"#ffffff"},subtextStyle:{color:"#dddddd"}},line:{itemStyle:{borderWidth:"4"},lineStyle:{width:"3"},symbolSize:"0",symbol:"circle",smooth:!0},radar:{itemStyle:{borderWidth:"4"},lineStyle:{width:"3"},symbolSize:"0",symbol:"circle",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#fc97af",color0:"transparent",borderColor:"#fc97af",borderColor0:"#87f7cf",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:"1",color:"#ffffff"},symbolSize:"0",symbol:"circle",smooth:!0,color:["#fc97af","#87f7cf","#f7f494","#72ccff","#f7c5a0","#d4a4eb","#d2f5a6","#76f2f2"],label:{color:"#293441"}},map:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#999999",borderWidth:.5},label:{color:"#893448"},emphasis:{itemStyle:{areaColor:"rgba(255,178,72,1)",borderColor:"#eb8146",borderWidth:1},label:{color:"rgb(137,52,72)"}}},geo:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#999999",borderWidth:.5},label:{color:"#893448"},emphasis:{itemStyle:{areaColor:"rgba(255,178,72,1)",borderColor:"#eb8146",borderWidth:1},label:{color:"rgb(137,52,72)"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#666666"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#aaaaaa"},splitLine:{show:!1,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#666666"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#aaaaaa"},splitLine:{show:!1,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#666666"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#aaaaaa"},splitLine:{show:!1,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#666666"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#aaaaaa"},splitLine:{show:!1,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#87f7cf",width:1},itemStyle:{color:"#87f7cf",borderWidth:1},controlStyle:{color:"#87f7cf",borderColor:"#87f7cf",borderWidth:.5},checkpointStyle:{color:"#fc97af",borderColor:"#fc97af"},label:{color:"#87f7cf"},emphasis:{itemStyle:{color:"#f7f494"},controlStyle:{color:"#87f7cf",borderColor:"#87f7cf",borderWidth:.5},label:{color:"#87f7cf"}}},visualMap:{color:["#fc97af","#87f7cf"]},dataZoom:{backgroundColor:"rgba(255,255,255,0)",dataBackgroundColor:"rgba(114,204,255,1)",fillerColor:"rgba(114,204,255,0.2)",handleColor:"#72ccff",handleSize:"100%",textStyle:{color:"#333333"}},markPoint:{label:{color:"#293441"},emphasis:{label:{color:"#293441"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"14c12638e32a3ac802f4":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.io.json.LReader=n.io.Reader.extend({NAME:"draw2d.io.json.LReader",init:function(){this._super()},fixit:function(){var e=Raphael.prototype.text;Raphael.prototype.text=function(){var t=e.apply(this,arguments);return setTimeout((function(){var e=t.node.getElementsByTagName("tspan")[0];e&&e.setAttribute("dy",0)}),1),t}},getMappedName:function(e){var t=e;switch(e){case"Projectnode":t="draw2d.shape.fishbone.cell.Projectnode";break;case"Scopenode":t="draw2d.shape.fishbone.cell.Scopenode";break;case"Buildingnode":t="draw2d.shape.fishbone.cell.Buildingnode";break;case"ScopeFilternode":t="draw2d.shape.fishbone.cell.ScopeFilternode";break;case"Datanode":t="draw2d.shape.fishbone.cell.Datanode";break;case"Codenode":t="draw2d.shape.fishbone.cell.Codenode";break;case"UDFnode":t="draw2d.shape.fishbone.cell.UDFnode";break;case"RaDataNode":t="draw2d.shape.fishbone.ra.RaDataNode";break;case"RaTaskGroup":t="draw2d.shape.fishbone.ra.RaTaskGroup";break;case"RaDataNodeGroupP":t="draw2d.shape.fishbone.ra.RaDataNodeGroupP";break;case"SQLnode":t="draw2d.shape.fishbone.cell.SQLnode";break;case"RaphaelChart":t="draw2d.shape.fishbone.ra.RaphaelChart";break;case"RaphaelPieChart":t="draw2d.shape.fishbone.ra.RaphaelPieChart";break;case"RaTopology":t="draw2d.shape.fishbone.ra.RaTopology";break;case"Tablenode":t="draw2d.shape.fishbone.cell.Tablenode";break;case"RaPivotnode":t="draw2d.shape.fishbone.ra.RaPivotnode";break;case"RaPivotnode_new":t="draw2d.shape.fishbone.ra.RaPivotnode_new";break;case"RaTablenode":t="draw2d.shape.fishbone.ra.RaTablenode";break;case"Label":t="draw2d.shape.fishbone.label.Label";break;case"RaLabel":t="draw2d.shape.fishbone.ra.RaLabel";break;case"TimerUpdate":t="draw2d.shape.fishbone.basic.TimerUpdate";break;case"Countdown":t="draw2d.shape.fishbone.label.Countdown";break;case"Today":t="draw2d.shape.fishbone.label.Today";break;case"Addnode":t="draw2d.shape.fishbone.cell.Addnode";break;case"Add_RaDataNodeGroup":t="draw2d.shape.fishbone.ra.Add_RaDataNodeGroup";break;case"Andnode":t="draw2d.shape.fishbone.cell.Andnode";break;case"Ornode":t="draw2d.shape.fishbone.cell.Ornode";break;case"Diffnode":t="draw2d.shape.fishbone.cell.Diffnode";break;case"Signnode":t="draw2d.shape.fishbone.cell.Signnode";break;case"Mathnode":t="draw2d.shape.fishbone.cell.Mathnode";break;case"Filternode":t="draw2d.shape.fishbone.cell.Filternode";break;case"Slanode":t="draw2d.shape.fishbone.cell.Slanode";break;case"Periodnode":t="draw2d.shape.fishbone.cell.Periodnode";break;case"RaManyToOne":t="draw2d.shape.fishbone.ra.RaManyToOne";break;case"End":t="draw2d.shape.fishbone.basic.End";break;case"Progress":t="draw2d.shape.fishbone.ra.Progress";break;case"Image":t="draw2d.shape.fishbone.basic.Image";break;case"draw2d.shape.basic.Line":t="draw2d.shape.basic.Line";break;case"Rect":t="draw2d.shape.fishbone.basic.Rect";break;case"Oval":t="draw2d.shape.fishbone.basic.Oval";break;case"Header1":t="draw2d.shape.fishbone.label.Header1";break;case"RaDataNodeGroup":t="draw2d.shape.fishbone.ra.RaDataNodeGroup"}return t},unmarshal:function(e,t,a,i,r,s,l,c){var u=new n.util.ArrayList,d="marker-a",p="marker-b";performance.mark(d),"string"==typeof t&&(t=JSON.parse(t)),s.load_progress=500;var h=null;return o.each(t,o.proxy((function(t,a){try{performance.mark(p),a.userData.hidden;var o=new Function("draw2d","scope","compile","sanitize","return new "+this.getMappedName(a.type)+"(undefined, undefined, undefined, scope, compile, sanitize);")(n,s,l,c),i=null,r=null;for(t in a){var d=a[t];if("source"===t){if(null===(h=e.getFigure(d.node)))throw"Source figure with id '"+d.node+"' not found";if(null===(i=h.getPort(d.port)))throw"Unable to find source port '"+d.port+"' at figure '"+d.node+"' to unmarschal '"+this.getMappedName(a.type)+"'"}else if("target"===t){if(null===(h=e.getFigure(d.node)))throw"Target figure with id '"+d.node+"' not found";if(null===(r=h.getPort(d.port)))throw"Unable to find target port '"+d.port+"' at figure '"+d.node+"' to unmarschal '"+this.getMappedName(a.type)+"'"}}null!==i&&null!==r&&(o.repaintBlocked=!0,o.setSource(i),"draw2d.PivotColInputPort"!==r.NAME&&"draw2d.PivotRowInputPort"!==r.NAME&&"draw2d.SLAInputPortTo"!==r.NAME&&"draw2d.SLAInputPortFrom"!==r.NAME&&"draw2d.DataInputPort"!==r.NAME&&"draw2d.FuncInputPort"!==r.NAME||(r.blockUpdate=!0),o.setTarget(r)),o.setPersistentAttributes(a),e.add(o),u.add(o),performance.measure("item_created",p),DEBUG&&console.log("Item created: "+this.getMappedName(a.type)+" "+this.getMappedName(a.id)+" "+performance.getEntriesByName("item_created")[0].duration),performance.clearMarks(p),performance.clearMeasures("item_created")}catch(e){debug.error(a,"Unable to instantiate figure type '"+this.getMappedName(a.type)+"' with id '"+a.id+"' during unmarshal by "+this.NAME+". Skipping figure.."),debug.error(e),debug.warn(a)}}),this)),o.each(t,o.proxy((function(t,a){if(void 0!==a.composite){var n=e.getFigure(a.id);null===n&&(n=e.getLine(a.id)),e.getFigure(a.composite).assignFigure(n)}}),this)),e.getLines().each((function(e,t){try{t.svgPathString=null,t.repaintBlocked=!1,t.repaint()}catch(e){debug.error(e)}})),e.linesToRepaintAfterDragDrop=e.getLines().clone(),e.showDecoration(),performance.measure("measure",d),DEBUG&&console.log("report load time: "+performance.getEntriesByName("measure")[0].duration),performance.clearMarks(),performance.clearMeasures(),u}})},"15af024cc936f2e4c46e":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.label.Header1=n.shape.basic.Label.extend({NAME:"draw2d.shape.fishbone.label.Header1",INFO:"{Class: <strong>draw2d.shape.fishbone.label.Header1</strong>}<br/><br/>",init:function(e,t,a){this._super(o.extend({text:"This is a simple sticky note",color:"rgba(255, 255, 255, 0)",radius:10,stroke:1},e),t,a),this.setFontSize(20),this.setFontColor("#2b2b2b"),this.setBold(!0),this.installEditor(new n.ui.LabelInplaceEditor),null===this.getUserData()&&this.attr({userData:{hidden:!1,index:0}}),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0}}}},getPersistentAttributes:function(){var e=this._super();return e.isBold=this.attr("bold"),e},setPersistentAttributes:function(e){this._super(e),this.setBold(e.isBold)}})},"1815c9263236de379ac6":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("dark",{color:["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],backgroundColor:"rgba(51,51,51,1)",textStyle:{},title:{textStyle:{color:"#eeeeee"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:4,symbol:"circle",smooth:!1},radar:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:4,symbol:"circle",smooth:!1},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#fd1050",color0:"#0cf49b",borderColor:"#fd1050",borderColor0:"#0cf49b",borderWidth:1}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:4,symbol:"circle",smooth:!1,color:["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78","#73a373","#73b9bc","#7289ab","#91ca8c","#f49f42"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#eee",borderColor:"#444",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"rgba(255,215,0,0.8)",borderColor:"#444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},geo:{itemStyle:{areaColor:"#eee",borderColor:"#444",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"rgba(255,215,0,0.8)",borderColor:"#444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,color:"#eeeeee"},splitLine:{show:!0,lineStyle:{color:["#aaaaaa"]}},splitArea:{show:!1,areaStyle:{color:["#eeeeee"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,color:"#eeeeee"},splitLine:{show:!0,lineStyle:{color:["#aaaaaa"]}},splitArea:{show:!1,areaStyle:{color:["#eeeeee"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,color:"#eeeeee"},splitLine:{show:!0,lineStyle:{color:["#aaaaaa"]}},splitArea:{show:!1,areaStyle:{color:["#eeeeee"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#eeeeee"}},axisTick:{show:!0,lineStyle:{color:"#eeeeee"}},axisLabel:{show:!0,color:"#eeeeee"},splitLine:{show:!0,lineStyle:{color:["#aaaaaa"]}},splitArea:{show:!1,areaStyle:{color:["#eeeeee"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#eeeeee"}},tooltip:{axisPointer:{lineStyle:{color:"#eeeeee",width:"1"},crossStyle:{color:"#eeeeee",width:"1"}}},timeline:{lineStyle:{color:"#eeeeee",width:1},itemStyle:{color:"#dd6b66",borderWidth:1},controlStyle:{color:"#eeeeee",borderColor:"#eeeeee",borderWidth:.5},checkpointStyle:{color:"#e43c59",borderColor:"#c23531"},label:{color:"#eeeeee"},emphasis:{itemStyle:{color:"#a9334c"},controlStyle:{color:"#eeeeee",borderColor:"#eeeeee",borderWidth:.5},label:{color:"#eeeeee"}}},visualMap:{color:["#bf444c","#d88273","#f6efa6"]},dataZoom:{backgroundColor:"rgba(47,69,84,0)",dataBackgroundColor:"rgba(255,255,255,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#eeeeee"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"1a03669a43e555fbf98f":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca"),r=a("aeb57e88bcb04c329061"),s=a("6fe5e339b0f8a936ba8c"),l=a("1bf2fbdb051fe0c57024");n.shape.fishbone.cell.ScopeFilternode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.ScopeFilternode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.ScopeFilternode</strong>}<br/><br/>",init:function(e,t,a,c){this._super(o.extend({color:"#ea885e",items:{filter:{name:"Filter",icon:"fas fa-filter",callback:function(){c.editor.selectValues(u)}},reset_filter:{name:"Reset Filter",icon:"fas fa-redo",callback:function(){u.userData.filter.value="All",u.userData.filter.isMulti=!1,i.initFallDown(u),u.GetHTTPData(),u.updateUI()}},sep:"---------"}},e),t,a,c);var u=this;o.extend(this.userData,{filter_name:"region",filter:{value:"All",isMulti:!1,filter_list:[{value:"",sites:0}]},sites_list_out:[],isEditedLabel:!1,label:""}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{filter_name:{type:"string",title:"Filter Column",default:"",enum:r.site_table_columns},filter:{type:"object",title:"Filter",properties:{value:{type:"string",default:""},isMulti:{type:"boolean",default:!1},filter_list:{type:"array",items:{type:"object",title:"Selection",properties:{value:{type:"string",title:"Value"},sites:{type:"integer",title:"Sites"}}}},required:["value","isMulti","filter_list"]}},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}}}}),this.getRealCount=function(){return 1},this.GetHTTPData=function(){var e=this.getUserData();if(this.sites_list_in)if(e.filter.isMulti){if(e.filter.filter_list.length>0){this.val_label.setText("."),this.startTimer(500);var t,a=s.context+"/data/getScopeMultiFilter?&proj_id="+this.project.proj_id+"&scope_id="+this.scope.scope_id+"&filter_name="+e.filter_name;t=""!==e.label?e.label:e.filter_name;var n=JSON.stringify({sites_list:this.sites_list_in,filter_list:e.filter.filter_list});this.xhr&&4!=this.xhr.readyState&&this.xhr.abort(),this.xhr=o.ajax({url:a,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:n,success:function(e){e&&(u.val_label.setText(e.length.toString()),u.userData.value=e.length,u.sites_list_out=e,u.getPort("output0").setUserData({project:u.project,scope:u.scope,item_name:t,sites_list_out:e}),u.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(u.getId()),t.setColor(u.frame.attr("stroke"))}),this))),u.stopTimer(),u.updateUI()}})}}else void 0!==e.filter.value&&""!==e.filter.value&&(this.val_label.setText("."),this.startTimer(500),a=s.context+"/data/getScopeFilter?&proj_id="+this.project.proj_id+"&scope_id="+this.scope.scope_id+"&filter_name="+e.filter_name+"&filter_value="+e.filter.value,n=JSON.stringify(this.sites_list_in),this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=o.ajax({url:a,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:n,success:function(t){t&&(u.val_label.setText(t.length.toString()),u.userData.value=t.length,u.sites_list_out=t,u.getPort("output0").setUserData({project:u.project,scope:u.scope,item_name:e.filter_name,sites_list_out:t}),u.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(u.getId()),t.setColor(u.frame.attr("stroke"))}),this))),u.stopTimer(),u.updateUI()}}));else u.userData.value="0",u.sites_list_out=[]},this.createPort("input").setMaxFanOut(1),this.createPort("output"),this.getPort("input0").on("connect",(function(e,t){t.connection.setTargetDecorator(new n.decoration.connection.DataArrowDecorator),u.sites_list_in=t.connection.sourcePort.userData.sites_list_out,u.updateScopeFilterSearchCol(t.connection.sourcePort.getUserData().project,t.connection.sourcePort.getUserData().scope,u),i.initFallDown(u),u.GetHTTPData()})),this.updateScopeFilterSearchCol=function(e,t,a){var n,r,c=(n=s.context+"/data/getAllFilterValues?scope_id="+t.scope_id+"&proj_id="+e.proj_id+"&filter_name="+a.userData.filter_name,r=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.extend(r),r.prototype.url=n,r.prototype.formatDocument=function(e){return e.value},r.prototype.buildValueForDisplay=function(e,t){var a;return a=t?this.formatDocument(t):"None",this.buildValueForDisplaySimply(e,a)},r.prototype.search=function(){var e;if((e=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!e&&this.getSearchResultsEl().empty(),e)){this.lastTerm=e,this.getSearchResultsEl().empty().append("Searching");var t=this.searchCallback;o.ajax({url:this.url,datatype:"json",type:"GET",success:function(a){if(a.splice(0,0,{value:"All"}),a.length>0){var n=(new l).from(a).where((function(t,a){return-1!==t.value.indexOf(e)})).select();t(n)}}})}},r.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data.value=e.data("value").value,a.userData.filter.isMulti=!1,i.initFallDown(a),a.GetHTTPData())},r.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.value.toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},r);TreemaNode.setNodeSubclass("scopefilter",c),this.project=e,this.scope=t}},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText(e.filter_name),e.filter.isMulti?this.filter_label.setText("Multiple filters"):this.filter_label.setText(e.filter.value),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(o.proxy((function(e,a){var n=a.getTarget();n.userData||(n.userData={}),n.userData.realCount=t.getRealCount(),n.setValue("ticket"),a.setColor("#dfdfdf")}),this))}));else if("input0"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=a.getUserData().sites_list_out,this.val_label.setText("."),this.updateScopeFilterSearchCol(a.getUserData().project,a.getUserData().scope,this),this.GetHTTPData()}},onTimer:function(){"."!==this.val_label.getText()&&".."!==this.val_label.getText()&&"..."!==this.val_label.getText()&&this.val_label.setText("."),"."===this.val_label.getText()?this.val_label.setText(".."):".."===this.val_label.getText()?this.val_label.setText("..."):"..."===this.val_label.getText()&&this.val_label.setText(".")}})},"1ad7c125deda13f7acbe":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca");n.shape.fishbone.cell.Funcnode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Funcnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Funcnode</strong>}<br/><br/>",init:function(e,t,a,i){var r,s;this._super(o.extend({},e),t,a,i),this.sscope=i,o.extend(this.userData,{row:[]}),o.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{row:{additionalProperties:!1,type:"array",title:"Inputs",items:{type:"object",title:"Row",properties:{sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},item_name:{title:"Row Name",type:"string"},project:{format:"hidden",optional:!0},scope:{format:"hidden",optional:!0},sop:{format:"hidden",optional:!0},task:{format:"hidden",optional:!0},color:{format:"hidden",optional:!0},id:{format:"hidden",optional:!0},task_type:{format:"hidden",optional:!0},col_name:{format:"hidden",optional:!0},group_name:{format:"hidden",optional:!0},figure_id:{type:"string",title:"Fugure ID",optional:!0},owner_id:{type:"string",title:"Owner ID",optional:!0}}}}}}),this.updateTickets=[],this.usageTickets=[],this.sites_list_in=[],this.sites_list_out=[],this.GetHTTPData=function(){this.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500)),this.updateTable(),this.stopTimer()},(r=new n.FuncInputPort).setConnectionDirection(1),r.setName("input0");var l=new n.layout.locator.OutputPortLocator;this.addPort(r,l),(s=new n.FuncInputPort).setConnectionDirection(3),s.setName("input1"),this.addPort(s),this.createPort("output"),this.layoutPorts()},getRealCount:function(){return 1},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText("New Label"),this._super(this)},sentData:function(e){e.each(o.proxy((function(e,t){var a=t.getTarget();a.setValue(this.getId()),t.setColor(this.frame.attr("stroke")),i.getMessage(this,a,"data send to")}),this))},onPortValueChanged:function(e){var t,a=this,n=0;if(t=a.userData.row,e.getValue().indexOf("ticket")>-1){var r=e.getValue().split(",")[1];this.updateTickets.indexOf(r)<0&&this.updateTickets.push(r),i.getMessage(a,e,"ticket received from"),this.userData.conn_count?n=this.userData.conn_count:this.getInputPorts().data.forEach((function(e,t){n+=e.getConnections().data.length})),(this.updateTickets.length>=n||e.superUpdate)&&this.getOutputPorts().data.forEach((function(t,n){t.getConnections().each(o.proxy((function(t,n){var o=n.getTarget();i.getMessage(a,o,"ticket send to"),o.userData||(o.userData={}),o.superUpdate=!!e.superUpdate,o.userData.realCount=a.getRealCount(),o.setValue("ticket,"+a.id+","+a.userData.label),n.setColor("#dfdfdf")}),this))}))}else{if("input"===e.name||"input0"===e.name||"input1"===e.name){if(this.updateTickets.length){var s=e.getValue(),l=this.updateTickets.indexOf(s);l>-1&&this.updateTickets.splice(l,1)}this.getInputPort(e.name).getConnections().data.forEach((function(n,o){if(e.getValue()===n.getSource().getParent().getId()){var r=n.getSource();i.getMessage(a,r,"update data received from"),a.usageTickets.push(r.getId());var s=r.userData,l=r.getId();s.owner_id=l;var c=-1;t.forEach((function(e,n){e.owner_id===l&&(c=n)>-1&&(t[c]=s,a.project=r.getUserData().project,a.scope=r.getUserData().scope,a.sop=r.getUserData().sop)}))}}))}if(!this.updateTickets.length||this.userData.conn_count&&this.userData.conn_count===this.updateTickets.length){e.superUpdate=!1;try{a.updateTable(),DEBUG&&console.log(a.NAME+" id:"+a.id+" "+a.userData.label+"- Update Table completed successfully")}catch(e){var c,u;console.error("Error during updateTable for node: ".concat(a.id," (").concat(a.NAME," - ").concat((null===(c=a.userData)||void 0===c?void 0:c.label)||"Unknown Label",")"),e),a.sscope.aiReportNodeErrors||(a.sscope.aiReportNodeErrors=[]);var d={nodeId:a.id,nodeName:a.NAME,nodeLabel:(null===(u=a.userData)||void 0===u?void 0:u.label)||"Unknown Label",errorMessage:e.message};a.sscope.aiReportNodeErrors.push(d),console.log("Captured error for node ".concat(a.id," and stored in this.sscope.aiReportNodeErrors"))}finally{a.usageTickets=[]}}}},onTimer:function(){"."!==this.val_label.getText()&&".."!==this.val_label.getText()&&"..."!==this.val_label.getText()&&this.val_label.setText("."),"."===this.val_label.getText()?this.val_label.setText(".."):".."===this.val_label.getText()?this.val_label.setText("..."):"..."===this.val_label.getText()&&this.val_label.setText(".")},getPersistentAttributes:function(){return this._super()},setPersistentAttributes:function(e){e.ports.forEach((function(e){"draw2d.PivotColInputPort"!==e.type&&"draw2d.PivotRowInputPort"!==e.type||(e.port="draw2d.FuncInputPort",e.cssClass="draw2d_FuncInputPort")})),e.userData.col&&e.userData.col.length&&(e.userData.row=[],e.userData.col.forEach((function(t){e.userData.row.push(t)})),delete e.userData.col),this._super(e)}})},"1ae1679c08b57e46bac7":(e,t,a)=>{"use strict";a.d(t,{A:()=>h});var n=a("ff40a63289dea11bfb3e"),o=a.n(n),i=a("a45670b3d8fb79ec0258"),r=a("8deafab7866a125bb9ca");function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){u(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function u(e,t,a){return(t=p(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function d(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=s(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,a=[{key:"extractJsonFromResponse",value:function(e){var t="",a="unknown";if(e.data&&e.data.bo&&e.data.bo.result)t=e.data.bo.result,a="response.data.bo.result";else if(e.result)t=e.result,a="response.result";else if("string"==typeof e.data)t=e.data,a="response.data (string)";else{if("string"!=typeof e)throw console.error("Unexpected API response format. Cannot find result string in known locations."),new Error("Unexpected API response format. Cannot find result string.");t=e,a="response (string)"}return console.log("Extracted raw string from source: ".concat(a)),this.parseWithProgressiveCleaning(t)}},{key:"parseWithProgressiveCleaning",value:function(e){try{return console.log("Attempting direct JSON5.parse on raw text"),o().parse(e)}catch(e){console.log("Direct parsing failed, applying minimal cleaning")}var t=this.minimalClean(e);if(!t)throw console.error("Processed result string is empty after minimal cleaning."),new Error("Could not extract valid JSON, result is empty after cleaning.");try{return console.log("Attempting JSON5.parse on minimally cleaned string"),o().parse(t)}catch(e){console.log("Minimal cleaning failed, applying standard cleaning")}t=this.standardClean(t);try{return console.log("Attempting JSON5.parse on standard cleaned string"),o().parse(t)}catch(e){console.warn("JSON5.parse failed on cleaned string:",e.message);try{return console.log("Attempting JSON.parse on cleaned string"),JSON.parse(t)}catch(e){console.log("Standard cleaning failed, applying aggressive cleaning")}}t=this.aggressiveClean(t);try{return console.log("Attempting JSON5.parse on aggressively cleaned string"),o().parse(t)}catch(e){try{return console.log("Attempting JSON.parse on aggressively cleaned string"),JSON.parse(t)}catch(e){console.log("Aggressive cleaning failed, trying regex extraction")}}try{var a=this.extractJsonFromMalformedText(t);return console.log("Successfully extracted JSON using regex fallback"),a}catch(e){throw console.error("All parsing attempts failed:",e.message),new Error("Could not extract valid JSON from response after all cleaning attempts. Final error: ".concat(e.message))}}},{key:"minimalClean",value:function(e){var t=e.trim(),a=t.lastIndexOf("</think>");return-1!==a&&(console.log("Found '</think>', removing preceding content."),t=t.substring(a+8)),t.startsWith('"')&&t.endsWith('"')&&t.length>=2&&(t=t.substring(1,t.length-1)),t.trim()}},{key:"standardClean",value:function(e){var t=e;return(t.indexOf("'''json")>-1||t.indexOf("```json")>-1)&&(console.log("Found code block markers, attempting to remove code blocks."),t=this.removeCodeBlocks(t)),(t=this.sanitizeControlCharacters(t)).trim()}},{key:"aggressiveClean",value:function(e){var t=e;return(t=(t=this.smartBacktickReplace(t)).replace(/[\x00-\x1F\x7F]/g,"")).trim()}},{key:"sanitizeControlCharacters",value:function(e){return e.replace(/\r\n/g,"\\n").replace(/\r/g,"\\n").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"")}},{key:"smartBacktickReplace",value:function(e){for(var t="",a=!1,n=!1,o=0;o<e.length;o++){var i=e[o];n?(t+=i,n=!1):"\\"!==i?'"'!==i?t+="`"!==i||a?i:"'":(a=!a,t+=i):(n=!0,t+=i)}return t}},{key:"extractJsonFromMalformedText",value:function(e){var t=e.match(/\{[\s\S]*\}/);if(t||(t=e.match(/\[[\s\S]*\]/)),t)try{return o().parse(t[0])}catch(e){try{return JSON.parse(t[0])}catch(e){throw new Error("Regex extraction found potential JSON but parsing failed: ".concat(e.message))}}throw new Error("No valid JSON structure found in text")}},{key:"removeCodeBlocks",value:function(e){if(e.startsWith("```json"))return e.substring(7,e.endsWith("```")?e.length-3:void 0).trim();if(e.startsWith("'''json"))return e.substring(7,e.endsWith("'''")?e.length-3:void 0).trim();for(var t=[{start:"```json",end:"```"},{start:"```",end:"```"},{start:"'''json",end:"'''"},{start:"'''",end:"'''"}],a=0,n=t;a<n.length;a++){var o=n[a],i=e.indexOf(o.start);if(i>=0){var r=i+o.start.length,s=e.indexOf(o.end,r);if(s>=0)return e.substring(r,s).trim()}}for(var l=0,c=t;l<c.length;l++){var u=c[l],d=e.indexOf(u.start);if(d>=0)return e.substring(d+u.start.length).trim()}return e}},{key:"createLoadingIndicator",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=t?'<div class="loading-details" style="font-size: 0.8em; color: #555; margin-top: 10px;">'.concat(t,"</div>"):"";return i('\n                <div id="ai-loading-indicator" class="report-loading">\n                    <div class="loading-main-message">'.concat(e,"</div>\n                    ").concat(a,"\n                    ").concat('<div class="loading-timer-info" style="font-size: 0.8em; color: #555; margin-top: 5px;">Time: 0s</div>',"\n                </div>\n            ")).css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"20px",background:"rgba(255, 255, 255, 0.9)",boxShadow:"0 0 10px rgba(0, 0, 0, 0.2)",borderRadius:"5px",zIndex:1060,textAlign:"center"}).appendTo("body")}},{key:"showErrorToast",value:function(e){void 0!==r.bsToast&&"function"==typeof r.bsToast.error?r.bsToast.error({id:e.id||"error-toast-".concat(Date.now()),title:e.title||"Error",message:e.message,timeout:void 0!==e.timeout&&e.timeout,position:e.position||"topCenter"}):console.error("Toast library not available",e)}},{key:"showWarningToast",value:function(e){void 0!==r.bsToast&&"function"==typeof r.bsToast.warning?r.bsToast.warning({id:"warning-toast-".concat(Date.now()),title:"Warning",message:e,timeout:5e3,position:"topCenter"}):console.warn("Toast library not available:",e)}},{key:"showSuccessToast",value:function(e){void 0!==r.bsToast&&"function"==typeof r.bsToast.success?r.bsToast.success({id:"success-toast-".concat(Date.now()),title:e.title||"Success",message:e.message,timeout:5e3,position:"topCenter"}):console.log("Toast library not available:",e.title,e.message)}},{key:"getEndpointForProvider",value:function(e){switch(e){case"zte_v1":return"getZTEV1API";case"zte_v2":return"getZTEV2API";case"openrouter":return"getOpenRouterAPI";case"anthropic":return"getAnthropicAPI";case"openai":return"getOpenAIAPI";case"ollama":return"getOllamaAPI";case"deepseek":return"getDeepSeekAPI";case"google":return"getGoogleAPI";default:return"getAiAPI"}}},{key:"extractUCSSSOToken",value:function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var a=e[t].trim();if(0===a.indexOf("UCSSSOToken="))return a.substring(12,a.length)}return console.warn("UCSSSOToken cookie not found in document context"),null}},{key:"encodeToBase64",value:function(e){if("string"!=typeof e)return e;try{return window.btoa(unescape(encodeURIComponent(e)))}catch(t){return console.error("Base64 encoding failed:",t),e}}},{key:"prepareMessagesForZTEV2",value:function(t){return Array.isArray(t)?t.map((function(t){return t&&"string"==typeof t.content?c(c({},t),{},{content:e.encodeToBase64(t.content)}):t})):t}}],null&&d(t.prototype,null),a&&d(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,a}()},"1f44d888ec90c0bf8262":function(module,exports,__webpack_require__){var jQuery=__webpack_require__("a45670b3d8fb79ec0258"),__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function($,_){var requirejs,require,define;return function(e){var t,a,n={},o={},i={},r={},s=[].slice;function l(e,t){var a,n,o,r,s,l,c,u,d,p,h=t&&t.split("/"),f=i.map,m=f&&f["*"]||{};if(e&&"."===e.charAt(0)&&t){for(e=(h=h.slice(0,h.length-1)).concat(e.split("/")),u=0;p=e[u];u++)if("."===p)e.splice(u,1),u-=1;else if(".."===p){if(1===u&&(".."===e[2]||".."===e[0]))return!0;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}if((h||m)&&f){for(u=(a=e.split("/")).length;u>0;u-=1){if(n=a.slice(0,u).join("/"),h)for(d=h.length;d>0;d-=1)if((o=f[h.slice(0,d).join("/")])&&(o=o[n])){r=o,s=u;break}if(r)break;!l&&m&&m[n]&&(l=m[n],c=u)}!r&&l&&(r=l,s=c),r&&(a.splice(0,s,r),e=a.join("/"))}return e}function c(t,n){return function(){return a.apply(e,s.call(arguments,0).concat([t,n]))}}function u(e){return function(t){n[e]=t}}function d(a){if(o.hasOwnProperty(a)){var i=o[a];delete o[a],r[a]=!0,t.apply(e,i)}if(!n.hasOwnProperty(a))throw new Error("No "+a);return n[a]}function p(e,t){var a,n,o=e.indexOf("!");return-1!==o?(a=l(e.slice(0,o),t),e=e.slice(o+1),e=(n=d(a))&&n.normalize?n.normalize(e,function(e){return function(t){return l(t,e)}}(t)):l(e,t)):e=l(e,t),{f:a?a+"!"+e:e,n:e,p:n}}function h(e){return function(){return i&&i.config&&i.config[e]||{}}}t=function(t,a,i,s){var l,f,m,g,y,_,b=[];if(s=s||t,"function"==typeof i){for(a=!a.length&&i.length?["require","exports","module"]:a,_=0;_<a.length;_++)if("require"===(m=(y=p(a[_],s)).f))b[_]=c(t);else if("exports"===m)b[_]=n[t]={},l=!0;else if("module"===m)f=b[_]={id:t,uri:"",exports:n[t],config:h(t)};else if(n.hasOwnProperty(m)||o.hasOwnProperty(m))b[_]=d(m);else if(y.p)y.p.load(y.n,c(s,!0),u(m),{}),b[_]=n[m];else if(!r[m])throw new Error(t+" missing "+m);g=i.apply(n[t],b),t&&(f&&f.exports!==e&&f.exports!==n[t]?n[t]=f.exports:g===e&&l||(n[t]=g))}else t&&(n[t]=i)},requirejs=require=a=function(n,o,r,s){return"string"==typeof n?d(p(n,o).f):(n.splice||(i=n,o.splice?(n=o,o=r,r=null):n=e),o=o||function(){},s?t(e,n,o,r):setTimeout((function(){t(e,n,o,r)}),15),a)},a.config=function(e){return i=e,a},(define=function(e,t,a){t.splice||(a=t,t=[]),o[e]=[e,t,a]}).amd={jQuery:!0}}(),define("../tools/almond",(function(){})),Raphael.el.getSubLengthByCord=function(e,t){var a,n,o,i,r,s,l,c={},u=0;for(o=function(e,t){var a=e.x-t.x,n=e.y-t.y;return Math.sqrt(Math.pow(n,2)+Math.pow(a,2))},s=this.attrs.path.length-1;s>=0;s--)(a=this.attrs.path[s])[1]===e.x&&a[2]===e.y&&(c.from=s),"C"===a[0]||"c"===a[0]?(a[1]===t.x&&a[2]===t.y||a[3]===t.x&&a[4]===t.y||a[5]===t.x&&a[6]===t.y)&&(c.to=s):a[1]===t.x&&a[2]===t.y&&(c.to=s);if(void 0!==c.to&&void 0!==c.from){for(n=Math.max(c.to,c.from),l=Math.min(c.to,c.from);l<n;l++)i=this.attrs.path[l],r=this.attrs.path[l+1],u+=o({x:i[1],y:i[2]},{x:r[1],y:r[2]});return u}return null},Raphael.el.getLengthFromStartByCord=function(e,t){var a=this.attrs.path;return this.getSubLengthByCord({x:a[0][1],y:a[0][2]},{x:e,y:t})},Raphael.el.getLengthFromEndByCord=function(e,t){var a,n;return a=(n=this.attrs.path).length,this.getSubLengthByCord({x:n[a-1][1],y:n[a-1][2]},{x:e,y:t})},define("../src/utils/utils.js",["require"],(function(e){var t=function(){};return t.toFontAttr=function(e){var t={};return Object.keys(e).forEach(((a,n)=>{switch(a){case"font_size":t["font-size"]=e.font_size;break;case"font_color":t.fill=e.font_color;break;case"font_family":t["font-family"]=e.font_family;break;case"font_style":t["font-style"]=e.font_style;break;case"font_weight":t["font-weight"]=e.font_weight}})),t},t})),define("../src/grid/grid",["require","../utils/utils.js"],(function(e){const t=e("../utils/utils.js");var a=function(e){this.parent=e,this.draw()};return a.prototype={draw:function(){this.grid_set=this.getGridSet(this.parent.leftgutter,this.parent.topgutter,this.parent.width-this.parent.leftgutter-this.parent.rightgutter,this.parent.height-this.parent.topgutter-this.parent.bottomgutter-this.parent.dataTableHeight-this.parent.navHeight-this.parent.xLabelHieght,this.parent.period-1*!this.parent.options.grid.padding,this.parent.options.yAxis.range||10,this.parent.grid_hor_color,this.parent.grid_vert_color,this.parent.grid_text_color)},getGridSet:function(e,a,n,o,i,r,s,l,c){var u=this.parent.options,d=this.parent.paper,p=this.parent;c=c||"#777",s=s||"#777",l=l||"#777";var h=["M",Math.round(e)-5,Math.round(a),"L",Math.round(e+n)+5,Math.round(a),"M",Math.round(e)-5,Math.round(a+o),"L",Math.round(e+n)+5,Math.round(a+o),"M",Math.round(e),Math.round(a)-5,"L",Math.round(e),Math.round(a+o)+5,"M",Math.round(e+n),Math.round(a)-5,"L",Math.round(e+n),Math.round(a+o)+5],f=o/r,m=n/i,g=u.grid.padding?0:-m/2,y=t.toFontAttr($.extend({},default_font,u.yAxis.labels.font));y["text-anchor"]="end";var _=t.toFontAttr($.extend({},default_font,u.xAxis.labels.font));if(_["text-anchor"]="middle",this.frame?this.frame.attr({path:h.join(","),stroke:c}):this.frame=d.path(h.join(",")).attr({stroke:c}),u.grid.hor_lines.show){for(var b=[],v=1;v<r;v++)b=b.concat(["M",Math.round(e),Math.round(a+v*f),"H",Math.round(e+n)]);this.hor_lines?this.hor_lines.attr({path:b.join(","),stroke:s}):this.hor_lines=d.path(b.join(",")).attr({stroke:s})}var w=[];for(v=1;v<r;v++)w=w.concat(["M",Math.round(e-5),Math.round(a+v*f),"H",Math.round(e)]);if(this.hor_pick?this.hor_pick.attr({path:w.join(","),stroke:c}):this.hor_pick=d.path(w.join(",")).attr({stroke:c}),u.grid.vert_lines.show){var x=[];for(v=u.grid.padding?0:1;v<=i;v++)x=x.concat(["M",Math.round(e+v*m),Math.round(a),"V",Math.round(a+o)]);this.vert_lines?this.vert_lines.attr({path:x.join(","),stroke:l}):this.vert_lines=d.path(x.join(",")).attr({stroke:l})}if(p.show_grid&&0!==p.Y&&0!==p.max){var k=p.height-p.bottomgutter-p.dataTableHeight-p.navHeight-p.xLabelHieght;for(v=0;v<=r;v++){var D=p.min+v*(p.max-p.min)/r,S=D.toString().split(".")[1],C=0;if("0"===D.toString().split(".")[0]&&0!==D){for(var T in S)if("0"!==S[T]){C=parseInt(T);break}(S=S.substring(T,S.length)).indexOf("000")>-1?C+=S.indexOf("000"):S.indexOf("111")>-1?C=1+C+S.indexOf("111"):S.indexOf("222")>-1?C=1+C+S.indexOf("222"):S.indexOf("333")>-1?C=1+C+S.indexOf("333"):S.indexOf("444")>-1?C=1+C+S.indexOf("444"):S.indexOf("555")>-1?C=1+C+S.indexOf("555"):S.indexOf("666")>-1?C=1+C+S.indexOf("666"):S.indexOf("777")>-1?C=1+C+S.indexOf("777"):S.indexOf("888")>-1?C=1+C+S.indexOf("888"):S.indexOf("999")>-1?C=1+C+S.indexOf("999"):C+=S.length,D=D.toFixed(C)}else D>1&&S&&S.length>0&&((S=S.substring(T,S.length)).indexOf("000")>-1?C+=S.indexOf("000"):S.indexOf("111")>-1?C=1+C+S.indexOf("111"):S.indexOf("222")>-1?C=1+C+S.indexOf("222"):S.indexOf("333")>-1?C=1+C+S.indexOf("333"):S.indexOf("444")>-1?C=1+C+S.indexOf("444"):S.indexOf("555")>-1?C=1+C+S.indexOf("555"):S.indexOf("666")>-1?C=1+C+S.indexOf("666"):S.indexOf("777")>-1?C=1+C+S.indexOf("777"):S.indexOf("888")>-1?C=1+C+S.indexOf("888"):S.indexOf("999")>-1?C=1+C+S.indexOf("999"):C+=S.length,D=D.toFixed(C));p.yAxisLabels[v]?p.yAxisLabels[v].attr({text:D}):p.yAxisLabels.push(d.text(p.leftgutter-10,k-v*(p.max-p.min)/r*p.Y,D).attr(y)),u.yAxis.labels.show?p.yAxisLabels[v].show():p.yAxisLabels[v].hide();var A=t.toFontAttr($.extend({},default_font,u.yAxis.units.font));A["text-anchor"]="end",this.yAxisUnits?this.yAxisUnits.attr({text:u.yAxis.units.label}):this.yAxisUnits=d.text(e-10,a-10-A["font-size"],u.yAxis.units.label).attr(A),u.yAxis.units.show?this.yAxisUnits.show():this.yAxisUnits.hide()}}var P=Math.max.apply(Math,function(){for(var e=[],t=p.start_position,a=p.finish_position+1;t<a;t++){var n=d.text(-1e4,-1e4,u.xAxis.data[t]);e.push(n.getBBox().width),n.remove()}return e}());this.ceil=Math.ceil(P/p.X)+1,this.add_counter=p.X/P>=1?1:this.ceil;var E,I=0;if(u.xAxis.marks.show&&u.xAxis.marks.mark_items&&u.xAxis.marks.mark_items.length){var N={stroke:u.xAxis.marks.style.stroke,"stroke-width":u.xAxis.marks.style["stroke-width"],fill:u.xAxis.marks.style.fill,opacity:u.xAxis.marks.style.opacity};u.xAxis.marks.mark_items.forEach(((t,n)=>{t>=p.start_position&&t<=p.finish_position?(this.marks||(this.marks=[]),this.marks[n]?(E=["M",Math.round(g+e+(t-p.start_position)*m),Math.round(a),"V",Math.round(a+o),"H",Math.round(g+e+(t-p.start_position)*m+m),"V",Math.round(a),"Z"],this.marks[n].attr({path:E}).attr(N)):(E=["M",Math.round(g+e+(t-p.start_position)*m),Math.round(a),"V",Math.round(a+o),"H",Math.round(g+e+(t-p.start_position)*m+m),"V",Math.round(a),"Z"],this.marks.push(d.path(E.join(",")).attr(N)))):(this.marks||(this.marks=[]),this.marks[n]?(E=["M",Math.round(g+e+(1-p.start_position)*m),Math.round(a),"V",Math.round(a+o),"H",Math.round(g+e+(1-p.start_position)*m+m),"V",Math.round(a),"Z"],this.marks[n].attr({path:E,opacity:0})):(E=["M",Math.round(g+e+(1-p.start_position)*m),Math.round(a),"V",Math.round(a+o),"H",Math.round(g+e+(1-p.start_position)*m+m),"V",Math.round(a),"Z"],this.marks.push(d.path(E.join(",")).attr(N).attr({opacity:0}))))}))}for(var M=[],O=(v=p.start_position,p.finish_position);v<=O;v++)if(I<=p.period){var j=Math.round(p.leftgutter+p.X*I+p.X/2+g);p.xAxisLabels[v-p.start_position]?p.xAxisLabels[v-p.start_position].attr({text:u.xAxis.data[p.start_position+I]}):p.xAxisLabels.push(d.text(u.xAxis.labels.offset.dx+j,p.height-p.dataTableHeight-p.navHeight-p.bottomgutter+p.xLabelHieght/2-p.xLabelHieght,u.xAxis.data[p.start_position+I]).attr(_)),v!==p.start_position&&(M=M.concat(["M",Math.round(e+I*m),Math.round(p.topgutter+o),"V",Math.round(p.topgutter+o+5)])),u.xAxis.labels.show?p.xAxisLabels[v-p.start_position].show():p.xAxisLabels[v-p.start_position].hide(),I+=this.add_counter}var R=t.toFontAttr($.extend({},default_font,u.xAxis.units.font));if(R["text-anchor"]="start",this.xAxisUnits?this.xAxisUnits.attr({text:u.xAxis.units.label}):this.xAxisUnits=d.text(p.leftgutter+n+10,a+o,u.xAxis.units.label).attr(R),u.xAxis.units.show?this.xAxisUnits.show():this.xAxisUnits.hide(),this.vert_pick?this.vert_pick.attr({path:M.join(",")}):this.vert_pick=d.path(M.join(",")),p.min<0){var L=Math.round(a+p.Y*p.max);for(this.zero_line?this.zero_line.attr({path:["M",Math.round(e-5),L,"H",Math.round(e+n+5)].join(","),"stroke-width":1,stroke:"#000"}).show():this.zero_line=d.path(["M",Math.round(e-5),L,"H",Math.round(e+n+5)]).attr({"stroke-width":1,stroke:"#000"}),M=[],v=1;v<i;v++)M=M.concat(["M",Math.round(e+v*m),L-2,"V",L+2]);this.zero_vert_pick?this.zero_vert_pick.attr({path:M.join(","),"stroke-width":1,stroke:"#000"}).show():this.zero_vert_pick=d.path(M.join(",")).attr({"stroke-width":1,stroke:"#000"})}else this.zero_line&&(this.zero_vert_pick.hide(),this.zero_line.hide())},refresh:function(){return this.draw()}},a})),define("../src/datatable/datatable",["require","../utils/utils.js"],(function(e){const t=e("../utils/utils.js");var a=function(e){this.parent=e,this.popup_label=e.paper.text(5,5,"").attr({stroke:"none",fill:"#ebebeb",opacity:1,"font-size":12}),this.popup=e.paper.popup(50,50,this.popup_label,"right").attr({fill:e.options.popup.fill||"#000",stroke:e.options.popup.stroke||"#666","stroke-width":e.options.popup["stroke-width"]||2,fill_opacity:e.options.popup.fill_opacity||.7}).hide().toFront(),this.leave_timer,this.draw()};return a.prototype={draw:function(){this.x=this.parent.leftgutter,this.y=this.parent.height-this.parent.bottomgutter-this.parent.dataTableHeight-this.parent.navHeight,this.w=this.parent.width-this.parent.leftgutter-this.parent.rightgutter,this.h=this.parent.dataTableHeight,this.dt_set=this.getDataTableSet(this.parent.series)},getDataTableSet:function(e){var t=this.parent,a=t.paper,n=this.x,o=this.y,i=this.w,r=this.h,s=t.options.grid.padding?0:-t.X/2,l=(t.grid.add_counter,l||"#777");this.txt_grid_l_end={font:"10px Open Sans",fill:l,"font-weight":"bold","text-anchor":"end"},this.table_set=a.set(),this.rowHeight=r/e.length,this.columnWidth=t.X;for(var c=[],u=0;u<e.length+1;u++)c=c.concat(["M",Math.round(n)+.5-5+s,Math.round(o+u*this.rowHeight)+.5,"H",Math.round(n+i-s)+5+.5]);this.hor_lines?this.hor_lines.attr({path:c.join(","),stroke:l}):this.hor_lines=a.path(c.join(",")).attr({stroke:l}),this.table_set.push(this.hor_lines);var d=[];for(u=t.start_position;u<=t.finish_position+1;u++)d=d.concat(["M",Math.round(n+s+(u-t.start_position)*this.columnWidth)+.5,Math.round(o)+.5-5,"V",Math.round(o+r)+.5+5]),this.add_counter;return this.vert_lines?this.vert_lines.attr({path:d.join(","),stroke:l}):this.vert_lines=a.path(d.join(",")).attr({stroke:l}),this.table_set.push(this.vert_lines),e.forEach(((e,t)=>{this.drawLine(e)})),this.table_set},drawLine:function(e){var a=this.parent.series.indexOf(e),n=this.parent.paper,o=this.parent,i=o.options,r=this,s=i.grid.padding?0:-o.X/2,l=this.x,c=this.y,u=[];e.s_dt_lgnd[0]?e.s_dt_lgnd[0].attr({y:c-5+r.rowHeight/2+r.rowHeight*a}):e.s_dt_lgnd[0]=(()=>{var t=n.set();if("bar"===e.s_opt.type){var i={fill:"line"===e.s_opt.type?e.s_opt.style.areaStyle.show?e.s_opt.style.areaStyle.fill||o.color[a]:("solid"===e.s_opt.style.data_points.fill?e.s_opt.style.stroke:e.s_opt.style.data_points.fill)||e.s_opt.style.stroke||o.color[a]:e.s_opt.style.fill||o.color[a],opacity:"line"===e.s_opt.type?e.s_opt.style.areaStyle.opacity||o.opacity[a]:e.s_opt.style.opacity||o.opacity[a],stroke:"none"},u={fill:"none",opacity:e.s_opt.style.opacity||o.opacity[a],stroke:e.s_opt.style.stroke||o.color[a]};t.push(n.path(["m",l-10-24+s,c-3+r.rowHeight+r.rowHeight*a,"h",8,"v",-10,"h",-8,"z"]).attr(i)),t.push(n.path(["m",l-10-24+s,c-3+r.rowHeight+r.rowHeight*a,"h",8,"v",-10,"h",-8,"z"]).attr(u)),t.push(n.path(["m",l-10-13+s,c-3+r.rowHeight+r.rowHeight*a,"h",8,"v",-8,"h",-8,"z"]).attr(i)),t.push(n.path(["m",l-10-13+s,c-3+r.rowHeight+r.rowHeight*a,"h",8,"v",-8,"h",-8,"z"]).attr(u)),t.push(n.path(["m",l-10-2+s,c-3+r.rowHeight+r.rowHeight*a,"h",8,"v",-6,"h",-8,"z"]).attr(i)),t.push(n.path(["m",l-10-2+s,c-3+r.rowHeight+r.rowHeight*a,"h",8,"v",-6,"h",-8,"z"]).attr(u))}else if("line"===e.s_opt.type){var d=["M",l-10-25+s,c-8+r.rowHeight+r.rowHeight*a,"h",30];t.push(n.path(d.join(",")).attr({"stroke-dasharray":e.s_opt.style["stroke-dasharray"]||"",stroke:e.s_opt.style.stroke||o.color[a],opacity:e.s_opt.style.opacity||o.opacity[a],"stroke-width":2}))}return t})(),e.s_dt_lgnd[1]?e.s_dt_lgnd[1].attr({x:l-10-30+s,y:c+r.rowHeight/2+r.rowHeight*a,text:e.s_opt.name}):e.s_dt_lgnd[1]=n.text(l-10-30+s,c+r.rowHeight/2+r.rowHeight*a,e.s_opt.name).attr(r.txt_grid_l_end),t.toFontAttr($.extend({},default_font,e.s_opt.style.data_table.font));for(var d=o.start_position;d<o.finish_position+1;d++){var p=d-o.start_position;e.s_dt_lbls[p]?e.s_dt_lbls[p].attr({text:void 0!==e.s_opt.data[d]?e.s_opt.data[d]:""}):e.s_dt_lbls.push(n.text(l+s+r.columnWidth/2+r.columnWidth*p,c+r.rowHeight/2+r.rowHeight*a,void 0!==e.s_opt.data[d]?e.s_opt.data[d]:""))}e.s_dt_lbls.forEach(((e,t)=>{u.push(e.attr("font-size"))}))},refresh:function(){var e=this.parent,t=e.options;(t||{}).data_table&&!t.data_table.show||(e.dataTableHeight=e.series.length*e.dataTableRowH,this.h=e.dataTableHeight,this.y=e.height-e.bottomgutter-e.dataTableHeight-e.navHeight,this.table_set=this.getDataTableSet(e.series))}},a})),define("../src/popup/popup",["require"],(function(e){var t=function(e){this.parent=e,this.draw()};t.prototype={draw:function(){var e=this.parent,t=e.paper,a=e.options;this.p_pu_set=t.set(),this.p_label_set=t.set(),this.p_pu_set.push(t.text(60,12,"title").attr(txt1).attr({fill:"#fff"})),e.series.forEach(((e,a)=>{e.s_pu_set||(e.s_pu_set=t.set(),this.drawSerie(e,a),this.p_label_set.push(e.s_pu_set))})),this.p_pu_set.push(this.p_label_set),this.p_pu_set.getBBox(),this.frame_set=t.popup(50,50,this.p_pu_set,"right").attr({fill:a.popup.fill||"#000",stroke:a.popup.stroke||"#666","stroke-width":a.popup["stroke-width"]||2,fill_opacity:a.popup.fill_opacity||.7}).hide().toFront(),this.p_pu_set.hide().toFront()},drawSerie:function(e,t){var a,n=this.parent,o=n.paper,i={font:"12px Open Sans",fill:"#e4e4e4","text-anchor":"start"};if(e.s_pu_set[0])e.s_pu_set[0][0].attr({x:60,y:parseInt(27)+parseInt(15*t)-5,fill:"line"===e.s_opt.type?e.s_opt.style.areaStyle.show?e.s_opt.style.areaStyle.fill||n.color[t]:("solid"===e.s_opt.style.data_points.fill?e.s_opt.style.stroke:e.s_opt.style.data_points.fill)||e.s_opt.style.stroke||n.color[t]:e.s_opt.style.fill||n.color[t]}),e.s_pu_set[0][1].attr({x:60,y:parseInt(27)+parseInt(15*t)-5,fill:"none"});else{var r=o.set();r.push(o.rect(60,parseInt(27)+parseInt(15*t)-5,10,10,2).attr({fill:"line"===e.s_opt.type?e.s_opt.style.areaStyle.show?e.s_opt.style.areaStyle.fill||n.color[t]:("solid"===e.s_opt.style.data_points.fill?e.s_opt.style.stroke:e.s_opt.style.data_points.fill)||e.s_opt.style.stroke||n.color[t]:e.s_opt.style.fill||n.color[t],opacity:"line"===e.s_opt.type?e.s_opt.style.areaStyle.opacity||n.opacity[t]:e.s_opt.style.opacity||n.opacity[t],stroke:"none"})),r.push(o.rect(60,parseInt(27)+parseInt(15*t)-5,10,10,2).attr({fill:"none",opacity:e.s_opt.style.opacity||n.opacity[t],stroke:e.s_opt.style.stroke||n.color[t]})),e.s_pu_set.push(r),a=e.s_pu_set.getBBox()}e.s_pu_set[1]?e.s_pu_set[1].attr({y:parseInt(27)+parseInt(15*t)}):(e.s_pu_set.push(o.text(a.x+a.width+5,parseInt(27)+parseInt(15*t),"1000.000 sites").attr(i)),a=e.s_pu_set.getBBox()),e.s_pu_set[2]?e.s_pu_set[2].attr({y:parseInt(27)+parseInt(15*t),text:e.s_opt.name}):e.s_pu_set.push(o.text(a.x+a.width+5,parseInt(27)+parseInt(15*t),e.s_opt.name).attr(i))},refresh:function(){var e=this.parent,t=e.options;if(t.popup.show){e.series.forEach(((a,n)=>{a.s_pu_set?this.drawSerie(a,n):(a.s_pu_set=e.paper.set(),this.drawSerie(a,n),this.p_label_set.splice(n,0,a.s_pu_set),a.s_pu_set.transform(this.p_pu_set[0].transform()),this.frame_set.data("rel_pos")?a.s_pu_set[1].attr({text:a.s_opt.data[parseInt(this.frame_set.data("rel_pos"))]+" "+t.yAxis.units.label}):a.s_pu_set.hide())}));var a="right";this.frame_set.data("x")+this.frame_set.getBBox().width>e.width&&(a="left");var n=e.paper.popup(this.frame_set.data("x"),this.frame_set.data("y"),this.p_pu_set,a,1),o=Raphael.animation({path:n.path,transform:["t",n.dx,n.dy]},200),i=this.p_pu_set[0].matrix.e+n.dx,r=this.p_pu_set[0].matrix.f+n.dy;t.popup.show&&(this.frame_set.stop().animate(o).toFront(),this.p_pu_set.toFront(),this.p_pu_set[0].stop().animateWith(this.frame_set,o,{transform:["t",i,r]},200).toFront(),e.series.forEach(((e,t)=>{e.s_pu_set.stop().animateWith(this.frame_set,o,{transform:["t",i,r]},200).toFront()})))}}};var a=/\{([^\}]+)\}/g,n=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;return Raphael.fn.popup=function(e,t,o,i,r){(i=String(i||"top-middle").split("-"))[1]=i[1]||"middle";var s,l,c=o.getBBox(),u=Math.round(c.width),d=Math.round(c.height),p=Math.round(c.x)-5,h=Math.round(c.y)-5,f=Math.min(d/2,u/2,10),m=[{x:p+5,y:h,w:u,w4:u/4,h4:d/4,right:0,left:u-2*f,bottom:0,top:d-2*f,r:5,h:d,gap:f},{x:p+5,y:h,w:u,w4:u/4,h4:d/4,left:u/2-f,right:u/2-f,top:d/2-f,bottom:d/2-f,r:5,h:d,gap:f},{x:p+5,y:h,w:u,w4:u/4,h4:d/4,left:0,right:u-2*f,top:0,bottom:d-2*f,r:5,h:d,gap:f}]["middle"==i[1]?1:2*("top"==i[1]||"left"==i[1])],g=0,y=0,_=this.path((s={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"}[i[0]],l=m,String(s).replace(a,(function(e,t){return function(e,t,a){var o=a;return t.replace(n,(function(e,t,a,n,i){t=t||n,o&&(t in o&&(o=o[t]),"function"==typeof o&&i&&(o=o()))})),o=(null==o||o==a?e:o)+""}(e,t,l)})))).insertBefore(o);switch(i[0]){case"top":g=e-(p+5+m.left+f),y=t-(h+5+d+5+f);break;case"bottom":g=e-(p+5+m.left+f),y=t-(h-f);break;case"left":g=e-(p+5+u+5+f),y=t-(h+5+m.top+f);break;case"right":g=e-(p-f),y=t-(h+5+m.top+f)}return _.translate(g,y),r?(r=_.attr("path"),_.remove(),{path:r,dx:g,dy:y}):(o.translate(g,y),_)},t})),define("../src/charts/serie",["require"],(function(require){"use strict";var Serie=function(e,t,a){this.r=t,this.parent=a,this.s_opt=e,this.s_path=void 0,this.s_bgp=void 0,this.s_dots=void 0,this.s_d_lbls=void 0,this.s_dt_lbls=this.r.set(),this.s_dt_lbls_bg=this.r.set(),this.s_dt_lbls_fg=this.r.set(),this.s_dt_lgnd=this.r.set(),this.s_dt_lgnd_bg=this.r.set(),this.s_pu_set=void 0,this.bar_index=0};function drawpath(e,t,a,n,o,i,r,s,l){var c=o.path(n).attr({stroke:"none",fill:"none"});e.attr({path:c.getSubpath(0,1)});var u=c.getTotalLength(c),d=(c.getPointAtLength(0),(new Date).getTime()),p=e;a[0].attr({opacity:1}),t.splice(0,1);var h=setInterval((function(){var t=(new Date).getTime()-d,a=t/i*u,n=c.getSubpath(0,a);r.path=n,e.animate(r,50,"",(function(){})),t>=i&&(clearInterval(h),null!=l&&l(),c.remove())}),50);return p}function getHorPosition(e,t){var a;switch(e){case"left":a=jQuery.extend(!0,t,{"text-anchor":"start"});break;case"center":a=jQuery.extend(!0,t,{"text-anchor":"middle"});break;case"right":a=jQuery.extend(!0,t,{"text-anchor":"end"})}return a}function getVerPosition(e,t,a,n){var o;switch(e){case"top":o=-n["font-size"];break;case"center":o=0;break;case"bottom":o=a;break;case"inside":o=a/2;break;case"insideTop":o=n["font-size"];break;case"insideBottom":o=a-n["font-size"]}return o}function getAnchors(e,t,a,n,o,i){var r=(a-e)/2,s=(o-a)/2,l=Math.atan((a-e)/Math.abs(n-t)),c=Math.atan((o-a)/Math.abs(n-i));l=t<n?Math.PI-l:l,c=i<n?Math.PI-c:c;var u=Math.PI/2-(l+c)%(2*Math.PI)/2;return{x1:a-r*Math.sin(u+l),y1:n+r*Math.cos(u+l),x2:a+s*Math.sin(u+c),y2:n+s*Math.cos(u+c)}}return Serie.prototype={draw:function(){var p=[],bgpp=[],pib=[],points=[],parent=this.parent,this_=this,view=parent.options.view,bar_cols=parent.bar_cols,start_position=parent.start_position,finish_position=parent.finish_position,X=parent.X,Y=parent.Y,min=parent.min,max=parent.max,isDraw2d=!1,chart_area_bottom=parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght,index=parent.series.indexOf(this),color=parent.color[index],opacity=parent.opacity[index],grid_padding=parent.options.grid.padding?0:-X/2,animate=this.s_opt.style.animation.animate,anim_speed=this.s_opt.style.animation.anim_speed,anim_style=this.s_opt.style.animation.anim_style,y0,isbar="bar"===this.s_opt.type,format=eval(this.s_opt.style.data_labels.formatter);y0=min<0?Math.round(parent.topgutter+Y*max):chart_area_bottom;var line_width,dot_radius,line_brush_style,started=!1;if("line"===this.s_opt.type)line_width=this.s_opt.style.line_width||2,line_brush_style=this.s_opt.style["stroke-dasharray"]||"",dot_radius=this.s_opt.style.data_points.radius;else{line_width=this.s_opt.style["stroke-width"]||2,dot_radius=default_line.dot_radius||2,line_brush_style=this.s_opt.style["stroke-dasharray"]||"";var s_gap=this.s_opt.style.bars_gap,big_gap=this.s_opt.style.series_gap,bar_w_plan=this.s_opt.style.bar_overlap||"stack"===parent.data_type?X-big_gap:(X-big_gap)/bar_cols-s_gap+s_gap/bar_cols,bar_w=bar_w_plan,stroke_width=line_width}this.s_dots||(this.s_dots=this.r.set());for(var i=start_position,ii=finish_position;i<=ii;i++){var isInStack=void 0!==this.s_opt.stack&&""!==this.s_opt.stack,valid=void 0!==this.s_opt.data[i],isCurved="c"===this.s_opt.style.line_type,relative_position=i-start_position;if(valid){var x,y,prev_position=y0;if(x=Math.round(parent.leftgutter+X*relative_position+X/2+grid_padding),isInStack?this.s_opt.data[i]>=0?(prev_position=Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(parent.last_positive[i][this.stack_ind]-min)),parent.last_positive[i][this.stack_ind]=parent.last_positive[i][this.stack_ind]+this.s_opt.data[i],y=Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(parent.last_positive[i][this.stack_ind]-min))):(prev_position=Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(parent.last_negative[i][this.stack_ind]-min)),parent.last_negative[i][this.stack_ind]=parent.last_negative[i][this.stack_ind]+this.s_opt.data[i],y=Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(parent.last_negative[i][this.stack_ind]-min))):y=Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(this.s_opt.data[i]-min)),points.push({x,y}),"bar"===this.s_opt.type)var yy=y,hstrw=stroke_width/2,xx=this.s_opt.style.bar_overlap||"stack"===parent.data_type?x-X/2+big_gap/2:x-X/2+big_gap/2+bar_w*this_.bar_index+s_gap*this_.bar_index,curr_bar_p=this.s_opt.data[i]>0?["M",xx+hstrw,yy+hstrw,"L",xx+hstrw,prev_position-hstrw,"l",bar_w-stroke_width,0,"L",xx+bar_w-hstrw,yy+hstrw,"Z"]:["M",xx+hstrw,yy-hstrw,"L",xx+hstrw,prev_position+hstrw,"l",bar_w-stroke_width,0,"L",xx+bar_w-hstrw,yy-hstrw,"Z"],curr_bar_bgpp=["M",xx,yy,"L",xx,prev_position,"l",bar_w,0,"L",xx+bar_w,yy,"Z"]}if(i===start_position&&("line"===this.s_opt.type?(valid&&(p=isCurved?["M",x,y,"C",x,y]:["M",x,y],pib=["M",x,y0],bgpp=isCurved?["M",x,y0,"L",x,y,"C",x,y]:["M",x,y0,"L",x,y],started=!0),this.s_path||(this.s_path=this.r.path()),this.s_bgp||(this.s_bgp=this.r.path())):"bar"===this.s_opt.type&&(valid&&(p=curr_bar_p,bgpp=curr_bar_bgpp,pib=["M",xx,y0,"l",0,0,"l",bar_w,0,"l",0,0,"Z"]),this.s_path||(this.s_path=this.r.path().attr({fill:"none",stroke:this.s_opt.style.stroke||color,opacity:this.s_opt.style.opacity||.6,"stroke-width":stroke_width})),this.s_bgp||(this.s_bgp=this.r.path().attr({fill:this.s_opt.style.fill||color,stroke:"none",opacity:this.s_opt.style.opacity||.6})))),i>start_position&&i<ii)if("line"===this.s_opt.type)if(valid)if(started){var Y0=isInStack?Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(parent.last_negative[i-1][this.stack_ind]+parent.last_positive[i-1][this.stack_ind]-min)):Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(this.s_opt.data[i-1]-min)),X0=Math.round(parent.leftgutter+X*(relative_position-1)+grid_padding+X/2),Y2=isInStack?Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(parent.last_positive[i+1][this.stack_ind]+parent.last_negative[i+1][this.stack_ind]+this.s_opt.data[i+1]-min)):Math.round(parent.height-parent.bottomgutter-parent.dataTableHeight-parent.navHeight-parent.xLabelHieght-Y*(this.s_opt.data[i+1]-min)),X2=Math.round(parent.leftgutter+X*(relative_position+1)+grid_padding+X/2),a=getAnchors(X0,Y0,x,y,X2,Y2);p=p.concat(isCurved?[a.x1,a.y1,x,y,a.x2,a.y2]:["L",x,y]),pib=pib.concat(["L",x,y0]),bgpp=bgpp.concat(isCurved?[a.x1,a.y1,x,y,a.x2,a.y2]:["L",x,y])}else p=p.concat(isCurved?["M",x,y,"C",x,y]:["M",x,y]),pib=pib.concat(["M",x,y0]),bgpp=bgpp.concat(isCurved?["M",x,y0,"L",x,y,"C",x,y]:["M",x,y0,"L",x,y]),started=!0;else started&&(isCurved&&p.splice(p.length-6,6),isCurved&&bgpp.splice(bgpp.length-6,6),p=p.concat(isCurved?[x,y,x,y]:null),pib=pib.concat(["M",x,y0]),bgpp=bgpp.concat(isCurved?[x,y,x,y,"L",x,y0,"z"]:["L",x,y0,"z"]),started=!1);else"bar"===this.s_opt.type&&valid&&(p=p.concat(curr_bar_p),bgpp=bgpp.concat(curr_bar_bgpp),pib=pib.concat(["M",xx,y0,"l",0,0,"l",bar_w,0,"l",0,0,"Z"]));if(i===ii&&("line"===this.s_opt.type?valid?started&&(p=p.concat(isCurved?[x,y,x,y]:["L",x,y]),pib=pib.concat(["L",x,y0]),bgpp=bgpp.concat(isCurved?[x,y,x,y,"L",x,y0,"z"]:["L",x,y,"L",x,y0,"z"])):started&&(isCurved&&p.splice(p.length-6,6),isCurved&&bgpp.splice(bgpp.length-6,6),p=p.concat(isCurved?[x,y,x,y]:null),pib=pib.concat(["M",x,y0]),bgpp=bgpp.concat(isCurved?[x,y,x,y,"L",x,y0,"z"]:["L",x,y0,"z"]),started=!1):"bar"===this.s_opt.type&&valid&&(p=p.concat(curr_bar_p),bgpp=bgpp.concat(curr_bar_bgpp),pib=pib.concat(["M",xx,y0,"l",0,0,"l",bar_w,0,"l",0,0,"Z"]))),"line"===this.s_opt.type){if(animate&&valid)var dot_anim=Raphael.animation({cx:x,cy:y,r:dot_radius,"stroke-width":line_width},anim_speed,anim_style);a={fill:this.s_opt.style.data_points.fill?"solid"===this.s_opt.style.data_points.fill?this.s_opt.style.stroke||color:this.s_opt.style.data_points.fill:"#fff",stroke:this.s_opt.style.stroke||color,opacity:this.s_opt.style.data_points.show?this.s_opt.style.data_points.opacity:0,"stroke-width":line_width},this.s_dots[relative_position]?valid?(this.s_dots[relative_position].show(),animate?this.s_dots[relative_position].stop(dot_anim).animate(dot_anim):this.s_dots[relative_position].attr({cx:x,cy:y,r:dot_radius,"stroke-width":line_width})):this.s_dots[relative_position].hide():valid?animate?this.s_dots.push(this.r.circle(x,y0,dot_radius).attr(a).stop(dot_anim).animate(dot_anim)):this.s_dots.push(this.r.circle(x,y,dot_radius).attr(a)):(x=Math.round(parent.leftgutter+X*relative_position+X/2+grid_padding),this.s_dots.push(this.r.circle(x,y0,dot_radius).attr(a).hide()))}else valid?this.s_dots[relative_position]?this.s_dots[relative_position].attr({cx:xx+bar_w,cy:yy}):this.s_dots.push(this.r.circle(xx+bar_w,yy,dot_radius).attr({opacity:0,"stroke-width":0,fill:"#fff",stroke:this.s_opt.style.stroke||color})):this.s_dots[relative_position]||this.s_dots.push(this.r.circle(0,0,0).attr({opacity:0}));if(this.s_opt.style.data_labels.show){var txt={fill:this.s_opt.style.data_labels.font.font_color||"#000","font-size":this.s_opt.style.data_labels.font.font_size||10,"font-family":this.s_opt.style.data_labels.font.font_family||"Open Sans","font-weight":this.s_opt.style.data_labels.font.font_weight||"normal","font-style":this.s_opt.style.data_labels.font.font_style||"normal",opacity:this.s_opt.style.data_labels.opacity},v_corect=isbar?getVerPosition(this.s_opt.style.data_labels.ver_position,0,prev_position-yy,txt)||getVerPosition("center",0,prev_position-yy,txt):0,attr_=getHorPosition(this.s_opt.style.data_labels.hor_position,txt)||getHorPosition("center",txt),dx=this.s_opt.style.data_labels.offset.dx||0,dy=this.s_opt.style.data_labels.offset.dy||0,text=this.r.text(-1e5,-1e5,format(this.s_opt.data[i])).attr(attr_),bb={width:2*this.s_opt.style.data_labels.back.radius,height:text.getBBox().height},label_back_trans=[[{cx:xx+dx+bar_w/2,cy:yy+dy+v_corect},{cx:x+dx,cy:y+dy}],[{x:xx+dx+bar_w/2-bb.width/2,y:yy+dy+v_corect-bb.height/2},{x:x+dx-bb.width/2,y:y+dy-bb.height/2}]],label_text_trans=[[{cx:xx+dx+bar_w/2,cy:yy+dy+v_corect},{cx:x+dx,cy:y+dy}],[{x:xx+dx+bar_w/2,y:yy+dy+v_corect},{x:x+dx,y:y+dy}]],back_type=(()=>{var e;switch(this.s_opt.style.data_labels.back.type){case"circle":e=0;break;case"rect":e=1}return e})(),x_coord_type=["cx","x"],x_coord=label_back_trans[back_type][isbar?0:1][x_coord_type[back_type]],x_coord_text=label_text_trans[back_type][isbar?0:1][x_coord_type[back_type]],y_coord_type=["cy","y"],y_coord=label_back_trans[back_type][isbar?0:1][y_coord_type[back_type]],y_coord_text=label_text_trans[back_type][isbar?0:1][y_coord_type[back_type]],set_anim=Raphael.animation(label_back_trans[back_type]["bar"===this.s_opt.type?0:1],anim_speed,anim_style),trans="r"+this.s_opt.style.data_labels.angle+"T"+(isbar?xx+dx+bar_w/2:x+dx)+","+(isbar?yy+dy+v_corect:y+dy+v_corect),init_trans="T"+(isbar?xx+dx+bar_w/2:x+dx)+","+y0,radius=this.s_opt.style.data_labels.back.radius||10,stroke=this.s_opt.style.data_labels.back.stroke||color,set=this.r.set(),a={fill:"solid"===this.s_opt.style.data_labels.back.fill?stroke:this.s_opt.style.data_labels.back.fill||"#fff",stroke,opacity:this.s_opt.style.data_labels.back.opacity||opacity,fill_opacity:this.s_opt.style.data_labels.back.fill_opacity||opacity,"stroke-width":this.s_opt.style.data_labels.back["stroke-width"]||2};switch(this.s_d_lbls||(this.s_d_lbls=this.r.set()),this.s_opt.style.data_labels.back.type||"circle"){case"circle":this.s_d_lbls[relative_position]?valid&&(animate?this.s_d_lbls[relative_position][0].stop(set_anim).animate(set_anim).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1]):this.s_d_lbls[relative_position][0].stop(set_anim).attr({cx:x_coord,cy:y_coord}).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1])):set.push(valid?animate?this.r.circle(isbar?xx+dx+bar_w/2:x+dx,y0,radius).attr(a).animate(set_anim,anim_speed,anim_style).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1]):this.r.circle(x_coord,y_coord,radius).attr(a).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1]):this.r.circle(0,0,radius).attr(a).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1]));break;case"rect":this.s_d_lbls[relative_position]?valid&&(animate?this.s_d_lbls[relative_position][0].stop(set_anim).animate(set_anim).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1]):this.s_d_lbls[relative_position][0].stop(set_anim).attr({x:x_coord,y:y_coord}).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1])):set.push(valid?animate?this.r.rect(isbar?xx+dx+bar_w/2-bb.width/2:x+dx-bb.width/2,y0-bb.height/2,bb.width,bb.height).attr(a).animate(set_anim).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1]):this.r.rect(x_coord,y_coord,bb.width,bb.height).attr(a).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1]):this.r.rect(0,0,bb.width,bb.height).attr(a).data("geo",label_back_trans[back_type]["bar"===this.s_opt.type?0:1]))}this.s_d_lbls[relative_position]?valid?animate?this.s_d_lbls[relative_position][1].attr({text:format(this.s_opt.data[i])}).animateWith(this.s_d_lbls[relative_position][0],set_anim,{x:x_coord_text,y:y_coord_text},anim_speed,anim_style):this.s_d_lbls[relative_position][1].attr({text:format(this.s_opt.data[i]),x:x_coord_text,y:y_coord_text}):this.r.text(0,0,""):set.push(valid?animate?this.r.text(0,0,format(this.s_opt.data[i])).attr(attr_).attr({x:isbar?xx+dx+bar_w/2:x+dx,y:y0}).toFront().animateWith(set[0],set_anim,{x:x_coord_text,y:y_coord_text},anim_speed,anim_style):this.r.text(0,0,this.s_opt.data[i]).attr(attr_).toFront().attr({x:x_coord_text,y:y_coord_text}):this.r.text(0,0,"").attr(attr_)),this.s_d_lbls[relative_position]||this.s_d_lbls.push(set),this.s_opt.style.data_labels.back.show?this.s_d_lbls[relative_position][0].attr({opacity:this.s_opt.style.data_labels.back.opacity}):this.s_d_lbls[relative_position][0].attr({opacity:0}),this.s_opt.style.data_labels.show?this.s_d_lbls[relative_position].show():this.s_d_lbls[relative_position].hide(),valid?this.s_d_lbls[relative_position].show():this.s_d_lbls[relative_position].hide()}parent.blanketUp[relative_position]&&parent.blanketUp[relative_position].data("onhover")&&this.s_pu_set&&this.s_pu_set[1]&&this.s_pu_set[1].attr({text:this_.s_opt.data[i]+" "+parent.options.yAxis.units.label}),parent.blanketDown[relative_position]&&parent.blanketDown[relative_position].data("onhover")&&this.s_pu_set&&this.s_pu_set[1]&&this.s_pu_set[1].attr({text:this_.s_opt.data[i]+" "+parent.options.yAxis.units.label})}if(""===this.s_path.attr("path")){if("line"===this.s_opt.type)if(animate){this.s_path.attr({path:pib,"stroke-dasharray":line_brush_style,stroke:this.s_opt.style.stroke||color,opacity:this.s_opt.style.opacity||opacity,"stroke-width":line_width,"stroke-linejoin":"round"}),this.s_bgp.attr(this_.s_opt.style.areaStyle.show?{path:pib,stroke:"none",opacity:this_.s_opt.style.areaStyle.opacity||.3,fill:this_.s_opt.style.areaStyle.fill||color}:{stroke:"none",opacity:0,fill:"none"});var anim=Raphael.animation({stroke:this.s_opt.style.stroke||color,path:p},anim_speed,anim_style);this.s_path.stop().animate(anim),this.s_bgp.animateWith(this.s_path,anim,{fill:this_.s_opt.style.areaStyle.fill||color,path:bgpp},anim_speed,anim_style)}else this.s_path.attr({"stroke-dasharray":line_brush_style,stroke:this.s_opt.style.stroke||color,opacity:this.s_opt.style.opacity||opacity,"stroke-width":line_width,"stroke-linejoin":"round",path:p}),this.s_bgp.attr(this_.s_opt.style.areaStyle.show?{path:bgpp,stroke:"none",opacity:this_.s_opt.style.areaStyle.opacity||.3,fill:this_.s_opt.style.areaStyle.fill||color}:{stroke:"none",opacity:0,fill:"none"});else if("bar"===this.s_opt.type)if(animate){this.s_path.attr({stroke:this.s_opt.style.stroke||color,path:pib}),this.s_bgp.attr({fill:this.s_opt.style.fill||color,path:pib});var anim=Raphael.animation({path:p},anim_speed,anim_style);this.s_path.stop().animate(anim),this.s_bgp.animateWith(this.s_path,anim,{path:bgpp},anim_speed,anim_style)}else this.s_path.attr({stroke:this.s_opt.style.stroke||color,path:p}),this.s_bgp.attr({fill:this.s_opt.style.fill||color,path:bgpp})}else if(animate){var anim=Raphael.animation({stroke:this.s_opt.style.stroke||color,path:p},anim_speed,anim_style);this.s_path.stop().animate(anim),this.s_bgp.animateWith(this.s_path,anim,{path:bgpp},anim_speed,anim_style)}else this.s_path.attr({stroke:this.s_opt.style.stroke||color,path:p}),this.s_bgp.attr({path:bgpp})},toFront:function(){this.s_bgp&&this.s_bgp.toFront(),this.s_path&&this.s_path.toFront(),this.s_dots&&this.s_dots.toFront(),this.s_d_lbls&&this.s_d_lbls.toFront(),this.s_dt_lbls&&this.s_dt_lbls.toFront(),this.s_dt_lbls_bg&&this.s_dt_lbls_bg.toFront(),this.s_dt_lgnd&&this.s_dt_lgnd.toFront(),this.s_dt_lgnd_bg&&this.s_dt_lgnd_bg.toFront()},toBack:function(){this.s_bgp&&this.s_bgp.toBack(),this.s_path&&this.s_path.toBack(),this.s_dots&&this.s_dots.toBack(),this.s_d_lbls&&this.s_d_lbls.toBack(),this.s_dt_lbls&&this.s_dt_lbls.toBack(),this.s_dt_lbls_bg&&this.s_dt_lbls_bg.toBack(),this.s_dt_lgnd&&this.s_dt_lgnd.toBack(),this.s_dt_lgnd_bg&&this.s_dt_lgnd_bg.toBack()},update:function(e){void 0!==e&&(this.s_opt=$.extend(!0,this.s_opt,e)),this.draw(),this.parent.options.data_table.show&&this.parent.dataTable.drawLine(this)},remove:function(){var e=this.parent.series.indexOf(this);this.s_path.remove(),this.s_bgp.remove(),this.s_dots.remove(),this.s_pu_set.remove(),this.parent.popup.p_label_set.splice(e,1),this.s_d_lbls&&this.s_d_lbls.remove(),this.parent.series.splice(e,1)}},Serie})),define("../src/navigation/navigation",["require"],(function(e){var t=function(e){this.parent=e,this.x=e.leftgutter,this.h2=15,this.h=e.navHeight,this.y=e.height-e.bottomgutter-this.h+this.h2,this.w=e.width-e.leftgutter-e.rightgutter,this.draw(),this.setOnDrag()};return t.prototype={draw:function(){var e=this.parent,t=e.paper,a=this.x,n=this.y,o=this.w,i=this.h,r=r||"#777",s=e.options.grid.padding?0:-e.X/2;this.nav_set=t.set();var l=[];l=(l=l.concat(["M",Math.round(a)+.5-5+s,Math.round(n)+.5,"H",Math.round(a+o-s)+5+.5])).concat(["M",Math.round(a)+.5-5+s,Math.round(n+this.h-this.h2)+.5,"H",Math.round(a+o-s)+5+.5]),this.control_width=Math.round(o*e.period/e.longest_data);var c={"stroke-width":1,fill:"#eaeaea"};this.hor_lines?this.hor_lines.attr({path:l.join(","),stroke:r}):this.hor_lines=t.path(l.join(",")).attr({stroke:r}),this.nav_set.push(this.hor_lines),this.control_rect?this.control_rect.attr(c):this.control_rect=t.rect(Math.round(a+o-s)+.5-this.control_width,Math.round(n)+.5,this.control_width,i-this.h2).attr(c),this.nav_set.push(this.control_rect),this.nav_set.toFront()},setOnDrag:function(){(()=>{var e,t=this,a=this.parent,n=a.finish_position,o=a.leftgutter+t.w-t.control_width,i=Math.round((t.w-t.control_width)/(a.longest_data-a.period));this.control_rect.drag((function(r,s,l,c,u){u.stopImmediatePropagation(),t.control_rect&&t.control_rect.attr({x:Math.min(Math.max(e+r,a.leftgutter),o)});var d=Math.min(Math.max(e+r,a.leftgutter),o)-o;d<0&&n!==a.finish_position?(a.finish_position=a.longest_data+Math.round(d/i)-1,a.start_position=a.finish_position-a.period+1,n=a.finish_position,a.refresh()):a.finish_position=a.longest_data+Math.round(d/i)-1}),(function(t,n,o){e=this.attr("x"),a.onscrolling=!0,a.context&&(a.context.dragIsLocked=!0)}),(function(e){a.onscrolling=!1,a.context&&(a.context.dragIsLocked=!1)}))})()},refresh:function(){this.draw()}},t})),define("ucharts",["require","../src/grid/grid","../src/datatable/datatable","../src/popup/popup","../src/charts/serie","../src/navigation/navigation"],(function(e){var t=e("../src/grid/grid"),a=e("../src/datatable/datatable"),n=e("../src/popup/popup"),o=e("../src/charts/serie"),i=e("../src/navigation/navigation");CHART_DEBUG=!1,default_grid={show:!0,top_m:60,left_m:20,right_m:20,bottom_m:60,padding:!0,hor_lines:{show:!0,color:"#DAD8D8"},vert_lines:{show:!0,color:"#EDEDED"}},default_data_table={show:!0,hor_lines:{show:!0,color:"#DAD8D8"},vert_lines:{show:!0,color:"#EDEDED"}},default_nav={show:!0,height:35},default_view={colors:{txt_a_label:"#6f6f6f",txt_a_value:"#7e7e7e",txt_a_value_f:"#80aa8b",txt_a_value_b:"#696baa",txt_i_label:"#6f6f6f",txt_i_value:"#7e7e7e",txt_i_value_f:"#80aa8b",txt_i_value_b:"#696baa",txt_addi_value_b:"#5d62c4",txt_addi_value_r:"#c4675a",txt_addi_label:"#7e7e7e"},dot_radius:2,line_width:2},default_font={font_size:10,font_color:"#000",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal"},default_popup={show:!0,fill:"#000",stroke:"#666","stroke-width":2,"fill-opacity":.7,font:default_font},default_units={show:!0,label:"",font:default_font},default_title={show:!0,label:"Title",font_size:18,color:"#000",font_style:"normal",font_weight:"normal"},default_title_left={show:!0,label:"Left title",font:default_font},default_title_right={show:!0,label:"Right Title",font:default_font},default_toolbar={show:!0,buttons:[{name:"line",show:!0,icon:"data:image/png;base64,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"},{name:"bar",show:!0,icon:"data:image/png;base64,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"},{name:"stack",show:!0,icon:"data:image/png;base64,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"},{name:"tiled",show:!0,icon:"data:image/png;base64,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"},{name:"refresh",show:!0,icon:"data:image/png;base64,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"},{name:"full_left",show:!1,icon:"data:image/png;base64,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"},{name:"left",show:!1,icon:"data:image/png;base64,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"},{name:"right",show:!1,icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAAJcEhZcwAACxMAAAsTAQCanBgAAATtSURBVHgB7Z1LiBVHFIb/uj2aDBNRIYPBhbgIWcT3k5BAGHAhgglEIkoUFDSEbBLdiSBI4sKFSFZRsgpBN4q6UJNFDITEgJCHUUFQEEVQjGjEDCoTZzyepr2356W3b3dV9eu/cGf6UXWq6vv7nOru6lsN8EMCJEACJEACJEACJEACJEACJEACJEACJEACJEACJEACyQkskgkI5H39foBp0pM8I1PaJ9AnXSrEL2iIPPve0fW19guixWQEAtk4TIymKKKifIteeSWZEaayRyCQo+MKEnnMJUyQBfYKo6X2BBpy8QWChB4zoN/P2htiCjsEGnKzjSBRGAvkBCbJq3YKpZXnE2jIrUSCRCHsBrqk7/nGuCc7gc4ECb1lSEX5AqslyF44LYwl0LkgzRB2Gt0yY6xBbslGIK0gUQj7V0+PV2WrAHOPJJBNkKa3fI2Z8vJIw1xLR8CGIJG3XMBEeTNdJcqRq1GOarZqORuD+END2ObWFi6kIGDPQ6LwFXpLIIcwVSanqA2z6GlsJ9chMfQoTL1o/arednmrSoTLFrJGs5+JIfyqgm/DTil7W0a3zeG6Ow+JvSeQU+iR1xy2wovp6hxVgmV4hPPat6zwQs5RIdURJALUC8FJve2yB7NkoiNmFTDrI2SNPgEI5He8JK+XjV7VPCTmL1iMx/hLQ9i6eGPxl6orSMR+koawAypKaYaKqy5IJItgA+7izzIMFddDkEiWN/Sa5Yxes3xe5MBVJ0FCHcIzr680hB0v6lBx3QSJnEOwEg9wrohDxfUUJJJlOp7gp6INFZuobo7/htchwDTHpaQ3b/CbBrOP8MhcT2/ETs46e0hMUPAOBvC39i25DxVTkFiWqXrNckRFyXWomCErFmT40gV0YS3+NxeHb/SxTA8Zn/KcZ0PFH4+/291WX4L48US7nLo1hH2jIczrULEvQeyi8mlNsBr/4UdfjyBRkCTiCpbgOrYmSZo1jS9BJGtFC5D/Qx918CWIj7a4LsMLKy+FKKkyduojBW7g+5Eb3Kz5EsRN7f1ZPY8p2O2jOArSjrLBIUzGu7hj+tsltbHflyBl7NQfaqD9BENmDe6Z+zZgJ7HRlSRRDdPw1klhRDfYjxlYmsd9rJABPSQ+Eu5piNqkIeoYrsUbfS9RkJC4wWkdoFrHASrfh9/Y8p6ggV1Yhb4iiBEdG2MraX9LMYdwb6gY6zFofrbf4PQWfZ32pq+hi5wGJ9CDeUUTI2xq3QQZ0DZv0Y77PfSbuy60zmqzTp36ZQQ6LPvYnM0KzWX+eniIwXfoxcKiixEKXXUP6ddT2k81RB3EPy6Pa3u2qyuI0d+zh0+ODJgr9nC5t1TFkKU/BMVezMfbZRPDvdzNEvz9pO22PiXCH302uef63+AUujFX+4sfcq1HxsKrELIGlcF27MByPDDhQ938tCXgLmRxao228H0lMDisQ6vz9drijK8iq1OOXQ95qB2392dufYlRtuuQ3IZWfQlSnk7dYF+eQ6u+BPFTTraQxUkwrauUVpBAOE2sdTFCg50LEk6k/CUnUnaiRseCcKpxVzq07CafjL+wMyy02lKJhWSvqyj0HCSV0KHVCL7QpYWiGAt85VExdGjVInpD2+iXgq1p7edCDgT42rwcoLNIEiABEiABEiABEiABEiABEiABEiABEiABEiABEiCBfAg8BRNI3HAZ5IjoAAAAAElFTkSuQmCC"},{name:"full_right",show:!1,icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAhqSURBVHgB7V17iJVFFD9z7+76QG0zDC2jKDJFoodvelgmmpabhvZSSCXKwKI0DQtJqITKDCqp/iiDkkKoxEzRSu2haRpYYRpWaJKVobnmY91d9/SbvXt37917d+d7zMw3t+bCcr/HzDm/c35nznzz+O4S+Y/3gPeA94D3gPeA94D3gPeA94D3gPeA94D3gPeA94D3gPeA94D3gPeA94AbHujO3ag/V7gBxiSKcr6SyniYSRVaZEucad5EXfhsLfKcFVLGoyjFp2DsNGcxSmDlPAA4GX/7cHyZ01hjgSvj0U2GMlrKYprE6VjyTFVuIUSScgwBNN6UqmTl5hIiIzDN6+gMPjNZUEW05xMiSWnA37wiJUv8Uhnf2NxCMilBGruHKrifU5aV88AiOGUALaMLuKNTWGOBSfOYooamuBrG3hRLts7KbRGSadVbqTP30qnOpKxUROHdiGklyHo0Yn171ZgGUw1ta+z47Wk1pCnNY9toITJ1Zf5kWujNnQwhCCa2nAc148niKvw+gVZ9WzCBrpaSaanQsBYysvfSvI068bmJmRGMEIlbdvZPELNIDKtCcdSUlS+WaSCdou0lMIiURCygMlpO53DnfCPcOFMREiaSelIDbUBamOqGae2gYJpIf9CXaNW92ymVyC2dhEgDOqCzX5rAIDJM4GQdfQVatezsh2QvuP+d5nGB+pBsX5L7nea11gaR5Tw4Ms4U16BVT3GFDN0tpMUuplH0D23FILJvy0Unj2SrfguteqELnb05QjK+v5jqQYr5QWSUlJUfHQ00D539CurBXfJv2D0zTYi0JjuInGvXtAjamKroEG2mjnx+hNpaqqgI0aIEQqSeZ9BSSmFu6VKqRWdfxlfrMj6MHBUh8VNBLhqmu2g/fWFgEKkXJ1EPPMJ/igCalgvfxrFdQqRF2UFkOQ+1YWAMHRXA+gZayiJawCo/xVCTX9Waony11JNO00ZE4N2trrt32kCz6UlaRXLd3sJHRYjuVJBrknzcfBMR+HzslUgmkzhlqx5DR2gLdeCLcg0wcZwkIRl7GmgWvU+rqZIrTRioUWY/qqOvEUDXa5RZIEpFSEEFIxfkIPIojHV/ENkdnf06zArcZ8QPEKoixGwqyLcqO4gcm3850JlNnGVA9Cr6v5foOpbHWj8uESINk4PIDxGBpTCInIkH+DW65+tUhGhlP6AwiUkOIt92foMC00jM18nO/pKAtimLqQixmQrywTJNxiDycwODyHw98c/6oLPfgs5+VHxRbvUhhfYwDQq4ZpFc4GRQV6KzX41U+0ChEeGuqFpIOGlmSvfCIPKzEhhEyl2dLwLnazSAy6O6QkVI0pGXtUvfIDIr0dQ30720gz6mrnxWFBWlQkjGtswg8qMig0hXAieDk2k4HW8cV/UPS0ppESKtYxqNQWQprEReiMW5zUhhoXZ4qggJS7Ct8n1g7BYYO8aWwoh6sotzjwStryLErVSQb9UZaC2r8GQzB5ddxil9/ByCZ2mQt7xKmRBJj8T/LIh5QZ44/WGaSrtpveotLxUhTtvYDM709HuzotgHrJKgIsTlVCBtkwY+jnbysMrQxO8LbCDsSzfQMXGwPSylTMgx9BwTqEEsbM9AB+41AMMcOi2m005Rq8KjffpYpVDT/b3YQ1VFteJ7TfJMiTmKoLkDZKwJqqD0WojApHdnvISTT4aLqfUnBM3QMGRI0kqLEEGvIw+PRB7+K2jEJVJOyKcpGoKg2RVWv4qQsPJMlT8NwbMQbfcEycOmQASSK7CaeI2cTRCHA5VvVUjVh7iQCqrRjm+nerG2FXbXTusB6EEEzSvY4BT54zohe5o6790KC5MOnMMImkkImvUKnMrb7qYsQZ9Q18Y8rCJDaaThAruoHA8ZGsiQOFWEJBN5gpYgD4+havG3YWfGEy+wyaEST1KnxM/xBLXUdo2QOkCbgTw8kzYKmZODfuwHTgrzZ/PpZjosjgYFGaScS33IIbTXiWj6G4MAT7BMLQZ7M4BzKS3Qj0JFiH6NxSX+QBU0jmrEL8VvO3P1IILmVpCxyRSi9lOWjVlUQViSpWExybCRsr7FO8aDTJIhSW6fENMLPylahDxcpTsPa49eQR/gFZ6r6KT4VbvsUAJTPAMrcoU/pRH/mnwVWd+7IWU8whBO+cNtT9l8O1fVh5hIBX+iXU5A0/8qVHC0X9gEzpPovKcD57v4tvaxTcgO5OEqNP391iyMpugApekWqhPbo1WPXkvVh0SX3LqmoPfwIpvMw26TIfAGbkd03gmQIV2mIkRPY03hLb16zPUcECda86TpXA9OQe/QeXQtnRAHNOEKLcZ0ypJ5eCry8HKbeTi0FzJr8/MxQ/A07Y1QW2MVFSFxVP3WlIe/iSPEQt3jCJYpIGOFBV1KFSpCoqUCgX2tHWg8mv7vSgTJFtjXNL3/XbIwWrTr70MELUMeHm6ZjPCBI2hT09q8M2RIWlSEtFCnPpJ7pB5D059Ce0WNuniCJTJ7pEao9kglgVBXypJ7pCaDjJVJGBFCp1ybnwuci2lniFoWi+ogxIU9UkFSVjWC5k6QEXiPlEUemlWpUlb7hhbfI9Us3KEDuUdqmOtkSH+pCGnbp3KP1OWNe1X/s3uk2jY+qTspnlVkFrUe1x5KClJRva3/i0N2NjrNS0z82kJRDFYupnh2K0KOYDp6tBXdYZQUElIH3PeHEeFKWVWnnotzD7a7jMMOix9zLzp4LPdIybX5DQ5iU0JS9SGZTj27R8pdMrIPH9k9UiVJhmRLTYigl0tkjxR+c0vvHillOFsv0IV7WNcZRWE37m7zdxGjQPR1vAe8B7wHvAe8B7wHvAe8B7wHvAe8B7wHvAe8B7wHvAe8B7wHvAe8B/5PHvgXJGUiHtscQBsAAAAASUVORK5CYII="}]},default_animation={animate:"false",anim_style:"ease-in-out",anim_speed:100},default_data_labels={show:!1,back:{show:!1,type:"circle",radius:2,stroke:void 0,"stroke-width":2,opacity:1,fill:"#fff",fill_opacity:1},hor_position:"center",ver_position:"center",font:default_font,formatter:"(a)=>{return a;}",angle:0,opacity:1,offset:{dx:0,dy:0}},default_xAxis={show:!0,range:14,labels:{show:!0,font:default_font,angle:0,offset:{dx:0,dy:0}},data:[],units:default_units,marks:{show:!0,mark_items:[],style:{stroke:"black","stroke-width":2,fill:"#c2c2c2",opacity:.5}}},default_yAxis={show:!0,range:10,scale:!1,labels:{show:!0,font:default_font,angle:0,offset:{dx:0,dy:0}},data:[],units:default_units},default_data_points={show:!0,radius:3,opacity:1},default_data_table_serie={show:!0,font:default_font,fill:"transparent",opacity:.8,stroke:"none"},default_line={dot_radius:3,opacity:.8,line_width:1.5,line_type:"c","stroke-dasharray":"",areaStyle:{normal:{},show:!1},data_points:default_data_points,data_labels:default_data_labels,animation:default_animation,data_table:default_data_table_serie},default_bar={opacity:.6,"stroke-width":1,barWidth:10,bars_gap:4,series_gap:16,bar_overlap:!1,data_labels:default_data_labels,animation:default_animation,data_table:default_data_table_serie},default_any_chart={opacity:.6,barWidth:10,bars_gap:4,series_gap:16,bar_overlap:!1,data_points:default_data_points,data_labels:default_data_labels,animation:default_animation,show_points:!0,dot_radius:3,line_width:1,line_type:"c","stroke-dasharray":"",areaStyle:{normal:{},show:!1},data_table:default_data_table_serie},t_show={type:"boolean",title:"show",default:!0},template_animation={type:"object",title:"Animation",default:default_animation,properties:{animate:{title:"Animate",type:"boolean",default:"true"},anim_style:{title:"Easing",type:"string",default:"ease-in-out",enum:["linear","ease-in","ease-out","ease-in-out","back-in","back-out","elastic","bounce"]},anim_speed:{title:"Speed",type:"integer",default:18}}},template_title={type:"object",title:"Title",default:default_title,properties:{show:{title:"Show",type:"boolean",default:"true"},label:{title:"Label",type:"string",default:""},font_size:{title:"Font Size",type:"integer",default:18},color:{type:"string",title:"Color",default:"#000"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]}}},template_toolbar={type:"object",title:"Toolbar",default:default_toolbar,properties:{buttons:{type:"array",title:"Buttons",items:{type:"object",title:"button",properties:{show:{type:"boolean",title:"show",default:!0},name:{type:"string",title:"name",default:""},icon:{type:"string",title:"icon",default:""},onclick:{type:"function",title:"onclick",format:"hidden"}}}},location:{type:"string",default:"top"},show:{type:"boolean",title:"show",default:!0}}},template_data_table={additionalProperties:!1,type:"object",title:"Data Table",default:default_data_table,properties:{show:t_show,hor_lines:{type:"object",title:"Horizontal Lines",properties:{show:{type:"boolean",title:"Show",default:!0},color:{type:"string",title:"Color",default:"#DAD8D8"}}},vert_lines:{type:"object",title:"Vertical Lines",properties:{show:{type:"boolean",title:"Show",default:!0},color:{type:"string",title:"Color",default:"#EDEDED"}}}}},template_view={type:"object",title:"View Config",properties:{colors:{type:"object",title:"Colors",properties:{txt_a_label:{type:"string",title:"Actual Label Color",default:"#000"},txt_a_value:{type:"string",title:"Actual Value Color",default:"#000"},txt_a_value_f:{type:"string",title:"Forecast Value Color",default:"#000"},txt_a_value_b:{type:"string",title:"Baseline Value Color",default:"#000"},txt_i_label:{type:"string",title:"Actual Info label Color",default:"#000"},txt_i_value:{type:"string",title:"Actual Info value Color",default:"#000"},txt_i_value_f:{type:"string",title:"Forecast Info value Color",default:"#000"},txt_i_value_b:{type:"string",title:"Baseline Info value Color",default:"#000"},txt_addi_value_b:{type:"string",title:"Positive trend Color",default:"#000"},txt_addi_value_r:{type:"string",title:"Negative trend Color",default:"#000"},txt_addi_label:{type:"string",title:"Additional Label Color",default:"#000"},colors_array:{additionalProperties:!1,type:"array",title:"Graph Color",items:{type:"string"}}}},dot_radius:{type:"integer",default:2,title:"Points Radius"},line_width:{type:"integer",default:2,title:"Line Width"}}},template_grid={additionalProperties:!1,type:"object",title:"Grid Options",default:default_grid,properties:{show:t_show,top_m:{type:"integer",title:"Top Margin",default:40},left_m:{type:"integer",title:"Left Margin",default:20},right_m:{type:"integer",title:"Right Margin",default:20},bottom_m:{type:"integer",title:"Bottom Margin",default:60},padding:{type:"boolean",title:"Padding",default:!0},hor_lines:{type:"object",title:"Horizontal Lines",properties:{show:{type:"boolean",title:"Show",default:!0},color:{type:"string",title:"Color",default:"#DAD8D8"}}},vert_lines:{type:"object",title:"Vertical Lines",properties:{show:{type:"boolean",title:"Show",default:!0},color:{type:"string",title:"Color",default:"#EDEDED"}}}}},template_animation={type:"object",title:"Animation",additionalProperties:!1,default:{show:!1,delay:500,attr:{},easing:"linear",repeat:"5"},properties:{show:{type:"boolean",title:"Show",default:!1},delay:{type:"number",title:"Interval (ms)",default:1e3},attr:{type:"object",additionalProperties:!0,title:"Attributes",properties:{opacity:{type:"number",title:"Opacity",default:1},fill:{type:"string",title:"Fill",default:"none"},"font-color":{type:"string",title:"Font Color",default:"none"},"font-size":{type:"number",title:"Font Size",default:0}}},easing:{type:"string",title:"Easing Style",default:"linear",enum:["linear","easeIn","easeOut","easeInOut","backIn","backOut","elastic","bounce"]},repeat:{type:"string",title:"Repeat Times",default:"5"}}},template_font={additionalProperties:!1,type:"object",title:"Font Style",default:default_font,properties:{font_size:{title:"Font Size",type:"integer",default:10},font_color:{title:"Font Color",type:"string",default:"#000"},font_family:{title:"Font Family",type:"string",default:"Tahoma, Geneva"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]},animation:template_animation}},template_title_left={type:"object",title:"Left Title",default:default_title_left,properties:{show:{title:"Show",type:"boolean",default:"true"},label:{title:"Label",type:"string",default:""},font:template_font}},template_title_right={type:"object",title:"Right Title",default:default_title_right,properties:{show:{title:"Show",type:"boolean",default:"true"},label:{title:"Label",type:"string",default:""},font:template_font}},template_popup={type:"object",title:"Pop Up",default:default_popup,properties:{show:{title:"Show",type:"boolean",default:"true"},fill:{type:"string",title:"BG Color",default:"#000"},stroke:{type:"string",title:"Frame Color",default:"#666"},"stroke-width":{type:"integer",title:"Frame Width",default:2},"fill-opacity":{type:"number",title:"Opacity",default:.7},font:template_font}},template_data_labels={additionalProperties:!1,type:"object",title:"Data Labels",properties:{show:{type:"boolean",title:"Show",default:!1},back:{additionalProperties:!1,type:"object",title:"Back Shape",properties:{show:{type:"boolean",title:"Show",default:!1},type:{title:"Shape",type:"string",default:"circle",enum:["circle","rect"]},radius:{type:"integer",default:2,title:"Radius/HalfSide"},stroke:{type:"string",default:"fff",title:"Stroke"},opacity:{type:"number",default:.8,title:"Opacity"},"stroke-width":{type:"integer",default:2,title:"Stroke Width"},fill:{title:"Fill",type:"string",default:"#fff"},fill_opacity:{title:"Fill Opacity",type:"number",default:.7}}},font:template_font,hor_position:{type:"string",title:"Hor Position",enum:["left","center","right"],default:"center"},ver_position:{type:"string",title:"Vert Position",enum:["top","center","bottom","inside","insideTop","insideBottom"],default:"center"},offset:{type:"object",title:"Offset",default:{dx:0,dy:0},additionalProperties:!1,properties:{dx:{type:"integer",default:0},dy:{type:"integer",default:0}}},formatter:{title:"Formatter",type:"string",format:"ace",aceMode:"ace/mode/javascript"},opacity:{type:"number",default:1,title:"Opacity"},angle:{type:"integer",title:"Angle",default:0}}},template_data_points={additionalProperties:!1,type:"object",title:"Data Points",properties:{show:{type:"boolean",title:"Show",default:!0},fill:{title:"Fill",type:"string"},stroke:{title:"Stroke",type:"string"},opacity:{title:"Opacity",type:"number"},radius:{type:"integer",default:3,title:"Radius"}}},template_units={type:"object",title:"Units",default:default_units,properties:{show:{title:"Show",type:"boolean",default:"true"},label:{title:"Label",type:"string",default:""},font:template_font}},template_serie_data_table={type:"object",title:"Serie Table Line",default:default_data_table_serie,properties:{show:{title:"Show",type:"boolean",default:"true"},fill:{title:"Fill Color",type:"string"},opacity:{title:"Opacity",type:"number",default:1},stroke:{title:"Stroke",type:"string"},font:template_font}},template_any_chart={additionalProperties:!1,type:"object",title:"Chart Style",default:default_any_chart,properties:{fill:{title:"Fill Color",type:"string"},opacity:{title:"Opacity",type:"number",default:.8},stroke:{title:"Stroke",type:"string"},"stroke-width":{title:"Frame width",type:"number",default:2},barWidth:{type:"integer",title:"Bar Max Width",default:10},bar_overlap:{type:"boolean",title:"Bars Overlapping",default:!1},bars_gap:{type:"integer",title:"Gap Between Bars",default:4},series_gap:{type:"integer",title:"Series Gap",default:16},data_points:template_data_points,line_width:{type:"number",default:2,title:"Line Width"},"stroke-dasharray":{type:"string",default:"solid",title:"Line Brush Style",enum:["","-",".","-.","-..",". ","- ","--","- .","--.","--.."]},line_type:{type:"string",default:"c",title:"Line Type",enum:["c","s"]},areaStyle:{type:"object",title:"Area Style",properties:{normal:{type:"object"},show:{type:"boolean",title:"Show Shade Area",default:!1},fill:{title:"Fill",type:"string"},opacity:{title:"Opacity",type:"number"}}},data_labels:template_data_labels,animation:template_animation,data_table:template_serie_data_table}},template_serie={type:"object",title:"Chart Series",properties:{name:{type:"string",default:""},type:{type:"string",default:"line",enum:["line","bar"]},trend:{type:"string",title:"Trend",default:"accumulative",enum:["accumulative","incremental"]},force_acc:{type:"boolean",title:"Force accumulative",default:!1},stack:{title:"Name of Stack",type:"string",default:""},style:template_any_chart,data:{type:"array",title:"Data",items:{type:"number",default:0}}}},template_xAxis={type:"object",title:"xAxis",default:default_xAxis,properties:{show:{title:"Show",type:"boolean",default:"true"},range:{type:"integer",title:"Number of Items",default:14},labels:{additionalProperties:!1,type:"object",title:"Labels",properties:{show:{type:"boolean",title:"Show Data Labels",default:!1},font:template_font,offset:{type:"object",title:"Offset",default:{dx:0,dy:0},additionalProperties:!1,properties:{dx:{type:"integer",default:0},dy:{type:"integer",default:0}}},angle:{type:"integer",title:"Angle",default:0}}},data:{type:"array",title:"data",items:{type:"string",default:""}},marks:{additionalProperties:!1,type:"object",title:"Markers",properties:{show:{type:"boolean",title:"Show Markers",default:!1},mark_items:{type:"array",title:"Mark Items",items:{type:"integer"}},style:{additionalProperties:!1,type:"object",title:"Marker Style",properties:{stroke:{title:"Stroke",type:"string",default:"black"},fill:{title:"Fill",type:"string",default:"#c2c2c2"},"stroke-width":{title:"Stroke Width",type:"number",default:1},opacity:{title:"Opacity",type:"number",default:.5}}}}},units:template_units}},template_yAxis={type:"object",title:"yAxis",default:default_yAxis,properties:{show:{title:"Show",type:"boolean",default:"true"},range:{type:"integer",title:"Number of Items"},max:{type:"integer",title:"Max Value"},min:{type:"integer",title:"Min Value",default:0},scale:{title:"Scale",type:"boolean",default:"true"},labels:{additionalProperties:!1,type:"object",title:"Labels",properties:{show:{type:"boolean",title:"Show Data Labels",default:!1},font:template_font,offset:{type:"object",title:"Offset",default:{dx:0,dy:0},additionalProperties:!1,properties:{dx:{type:"integer",default:0},dy:{type:"integer",default:0}}},angle:{type:"integer",title:"Angle",default:0}}},data:{type:"array",title:"data",items:{type:"string",default:""}},units:template_units}};var r={version:"1.0.0"};function s(e,r,s){var l=this,c={title:$.extend(!0,{},default_title),title_left:$.extend(!0,{},default_title_left),title_right:$.extend(!0,{},default_title_right),grid:$.extend(!0,{},default_grid),popup:$.extend(!0,{},default_popup),toolbar:$.extend(!0,{},default_toolbar),view:$.extend(!0,{},default_view),size:{width:e.width,height:e.height},data_table:$.extend(!0,{},default_data_table),nav:$.extend(!0,{},default_nav),xAxis:$.extend(!0,{},default_xAxis),yAxis:$.extend(!0,{},default_yAxis),series:[]},u=r=$.extend(!0,c,r);u.view,this.context=s,this.paper=e,this.options=u,this.anim_speed=1,this.anim_style="linear",this.last_positive=[],this.last_negative=[],this.series=[],this.xAxisLabels=this.paper.set(),this.yAxisLabels=this.paper.set();var d=function(e){var t={};e.colors.colors_array&&e.colors.colors_array.length?t.color=e.colors.colors_array:t.color=["hsl("+[0,.6,.4]+")","hsl("+[.1,.6,.5]+")","hsl("+[.35,.6,.4]+")","hsl("+[.55,.6,.4]+")","hsl("+[.7,.6,.4]+")","hsl("+[.8,.6,.4]+")","hsl("+[.9,.6,.4]+")","hsl("+[.25,.6,.4]+")","hsl("+[.5,.6,.4]+")","hsl("+[.05,.6,.4]+")","hsl("+[.15,.6,.5]+")","hsl("+[.3,.6,.4]+")","hsl("+[.5,.6,.4]+")","hsl("+[.75,.6,.4]+")","hsl("+[.85,.6,.4]+")","hsl("+[.95,.6,.4]+")","hsl("+[.2,.6,.4]+")","hsl("+[.55,.6,.4]+")","hsl("+[0,.45,.7]+")","hsl("+[.1,.45,.7]+")","hsl("+[.35,.45,.7]+")","hsl("+[.55,.45,.7]+")","hsl("+[.7,.45,.7]+")","hsl("+[.8,.45,.7]+")","hsl("+[.9,.45,.7]+")","hsl("+[.25,.45,.7]+")","hsl("+[.5,.45,.7]+")","hsl("+[.05,.45,.7]+")","hsl("+[.15,.45,.7]+")","hsl("+[.3,.45,.7]+")","hsl("+[.5,.45,.7]+")","hsl("+[.75,.45,.7]+")","hsl("+[.85,.45,.7]+")","hsl("+[.95,.45,.7]+")","hsl("+[.2,.45,.7]+")","hsl("+[.55,.45,.7]+")"],t.opacity=[];for(var a=0;a<=20;a++)t.opacity[a]=.8;return t}(u.view);this.color=d.color,this.opacity=d.opacity,this.showTable=u.data_table.show,this.width=u.size.width,this.height=u.size.height,this.show_grid=u.grid.show,this.leftgutter=u.grid.left_m,this.rightgutter=u.grid.right_m,this.bottomgutter=u.grid.bottom_m,this.buttonsgutter=0,this.topgutter=u.grid.top_m,this.colorhue=.6,this.grid_hor_color=(((u||{}).grid||{}).hor_lines||{}).color||"#DAD8D8",this.grid_vert_color=(((u||{}).grid||{}).vert_lines||{}).color||"#EDEDED",this.dataTableRowH=16,this.xLabelHieght=this.show_grid?25+u.xAxis.labels.offset.dy:0,this.dataTableHeight=0,this.navHeight=0,this.X=0,this.Y=0,this.max=0,this.min=0,txt={font:"12px Open Sans",fill:"#ededed","text-anchor":"start"},txt1={font:"14px Open Sans",fill:"#ededed","text-anchor":"start"},txt_grid_l={font:"10px Open Sans",fill:u.xAxis.labels.font.font_color||"#525050"},txt_legend={font:"12px Open Sans",fill:u.xAxis.labels.font.font_color||"#525050","text-anchor":"start"};var p,h={font:u.title_left.font.font_size.toString()+"px "+u.title_left.font.font_family,fill:u.title_left.font.font_color,"text-anchor":"start"},f={font:u.title_right.font.font_size.toString()+"px "+u.title_right.font.font_family,fill:u.title_right.font.font_color,"text-anchor":"end"};this.period=u.xAxis.range||14,this.longest_data=Math.max(...(p=[],u.series.forEach(((e,t)=>{p.push(e.data.length)})),p)),this.period=Math.min(this.period,this.longest_data),this.finish_position=this.longest_data-1,this.start_position=this.longest_data-this.period;var m=u.title_left.label,g=u.title_right.label;if(this.paper.setStart(),txt_title={font:u.title.font_size.toString()+"px Open Sans",fill:u.title.color,"font-weight":u.title.font_weight,"font-style":u.title.font_style,"text-anchor":"end"},u.title.show&&(this.title?this.title.attr({text:u.title.label}).attr(txt_title):this.title=this.paper.text(this.width-this.rightgutter,0+u.title.font_size/2,u.title.label).attr(txt_title)),CHART_DEBUG)var y=performance.now();if(this.getButtonsChart(),CHART_DEBUG&&console.log("Ushart getButtonsChart"+(y-performance.now())),CHART_DEBUG)var _=performance.now();if(u.title_left.show&&(this.add_title_left?this.add_title_left.attr({text:m}).attr(h):this.add_title_left=this.paper.text(this.leftgutter,this.topgutter-15,m).attr(h)),u.title_left.show&&(this.add_title_right?this.add_title_right.attr({text:g}).attr(f):this.add_title_right=this.paper.text(this.width-this.rightgutter,this.topgutter-15,g).attr(f)),CHART_DEBUG&&console.log("Ushart Titles left/right"+(_-performance.now())),this.blanketUp=this.paper.set(),this.blanketDown=this.paper.set(),this.vertMarker=this.paper.set(),CHART_DEBUG)var b=performance.now();if(u.series.forEach((function(e,t){var a=$.extend(!0,{},e);"line"===a.type?a.style=$.extend(!0,{},default_line,e.style):a.style=$.extend(!0,{},default_bar,e.style);var n=new o(a,l.paper,l);n.s_opt_ori=$.extend(!0,{},e),l.series.push(n)})),CHART_DEBUG&&console.log("Ushart prepare series"+(b-performance.now())),CHART_DEBUG)var v=performance.now();if(this.options.nav.show&&this.period<this.longest_data&&(this.navHeight=this.options.nav.height||35,this.nav=new i(this)),CHART_DEBUG&&console.log("Ushart new Navigation"+(v-performance.now())),CHART_DEBUG)var w=performance.now();if(this.getGridConfig(),this.show_grid&&(this.grid=new t(this)),CHART_DEBUG&&console.log("Ushart new Grid"+(w-performance.now())),CHART_DEBUG)var x=performance.now();if(this.redrawSeries(),CHART_DEBUG&&console.log("Ushart redrawSeries"+(x-performance.now())),CHART_DEBUG)var k=performance.now();if(u.popup.show&&(this.popup=new n(this),this.updateBlankets(),this.blanketUp.toFront(),this.blanketDown.toFront()),CHART_DEBUG&&console.log("Ushart popup"+(k-performance.now())),CHART_DEBUG)var D=performance.now();if((u||{}).data_table&&!u.data_table.show||(l.dataTableHeight=u.series.length*l.dataTableRowH,this.dataTable=new a(this)),CHART_DEBUG&&console.log("Ushart data_table"+(D-performance.now())),CHART_DEBUG)var S=performance.now();this.svg_nodes=this.paper.setFinish(),CHART_DEBUG&&console.log("Ushart setFinish"+(S-performance.now()))}return s.prototype.updatePopup=function(){this.label&&this.label.remove().clear(),this.label=this.paper.set();var e=this.label,t=this.options,a=this.paper,n=this;e.push(a.text(60,12,"title").attr(txt1).attr({fill:"#fff"})),t.series.forEach((function(t,o){var i,r={font:"20px Helvetica, Arial",fill:n.color[o],opacity:n.opacity[o],"text-anchor":"start"},s=a.set();s.push(a.rect(60,parseInt(27)+parseInt(15*o)-5,10,10,2).attr({stroke:0,fill:r.fill,opacity:n.opacity[o]})),s.push(a.rect(60,parseInt(27)+parseInt(15*o)-5,10,10,2).attr({stroke:0,fill:r.fill,opacity:0})),i=s[s.length-1].getBBox(),s.push(a.text(i.x+i.width+5,parseInt(27)+parseInt(15*o),"1000.000 sites").attr(txt)),i=s.getBBox(),s.push(a.text(i.x+i.width+5,parseInt(27)+parseInt(15*o),t.name).attr(txt)),e.push(s)})),e.hide(),this.frame=a.popup(0,0,e,"right").attr({fill:t.popup.fill||"#000",stroke:t.popup.stroke||"#666","stroke-width":t.popup["stroke-width"]||2,fill_opacity:t.popup.fill_opacity||.7}).hide()},s.prototype.updateBlankets=function(){for(var e,t=this,a=this.paper,n=this.options,o=this.X,i=0,r=0,s=!1,l=this.popup.frame_set,c=n.grid.padding?0:-o/2,u={x:0,y:0},d=0;d<this.period;d++){t.vertMarker[d]?t.vertMarker[d].attr({path:["M",t.leftgutter+c+o*d+o/2,t.topgutter,"V",t.height-t.bottomgutter-t.dataTableHeight-t.navHeight-t.xLabelHieght].join(",")}):t.vertMarker.push(a.path(["M",t.leftgutter+c+Math.round(o*d)+o/2,t.topgutter,"V",t.height-t.bottomgutter-t.dataTableHeight-t.navHeight-t.xLabelHieght].join(",")).attr({stroke:"#777","stroke-width":1,opacity:0}));var p=a.set();if(t.series.forEach((function(e,t){p.push(e.s_dots[d])})),t.blanketUp[d])t.blanketUp[d].attr({x:t.leftgutter+c+o*d,y:t.topgutter,width:o,height:(t.height-t.topgutter-t.bottomgutter-t.dataTableHeight-t.navHeight)/2});else{var h=a.rect(t.leftgutter+c+o*d,t.topgutter,o,(t.height-t.topgutter-t.bottomgutter-t.dataTableHeight-t.navHeight)/2).attr({stroke:"none",fill:"#fe4d46",opacity:0});t.blanketUp.push(h),function(o,c,d,p,m,g){var y=[];d.forEach((function(e,t){y.push(e.attr("r"))})),h.hover((function(){var c=t.popup.p_pu_set;clearTimeout(e),this.data("onhover",!0);var h="right";o+l.getBBox().width>t.width&&(h="left"),t.context&&(u={x:t.context.getAbsoluteX(),y:t.context.getAbsoluteY()});var _=f.attr().y+f.attr().height/2,b=a.popup(o,_,c,h,1),v=Raphael.animation({path:b.path,transform:["t",b.dx+u.x,b.dy+u.y]},200*s);i=c[0].matrix.e+b.dx+u.x,r=c[0].matrix.f+b.dy+u.y,n.popup.show&&(l.show().stop().animate(v),l.data("rel_pos",g),l.data("x",o),l.data("y",_),t.popup.p_pu_set[0].attr({text:n.xAxis.data[t.start_position+g]+""}).show().stop().animateWith(l,v,{transform:["t",i,r]},200*s),t.series.forEach(((e,a)=>{e.s_pu_set.show().stop().animateWith(l,v,{transform:["t",i,r]},200*s),e.s_pu_set[1].attr({text:e.s_opt.data[t.start_position+g]+" "+n.yAxis.units.label})}))),l.toFront(),c.toFront(),m.attr("opacity",.7),d.forEach((function(e,t){e.attr("r",1.4*y[t])})),null!==p&&(p.attr("opacity",1),p.attr("font","10px Open Sans"),p.attr("font-weight","bold")),s=!0}),(function(){var a=t.popup.p_pu_set;this.data("onhover",!1),l.removeData("rel_pos"),m.attr("opacity",0),d.forEach((function(e,t){e.attr("r",y[t])})),null!==p&&(p.attr("opacity",.7),p.attr("font","10px Open Sans"),p.attr("font-weight","bold")),e=setTimeout((function(){l.hide(),a.hide(),s=!1}),1)}))}(h.attr("x")+h.attr("width")/2,(h.attr("y"),h.attr("height")),p,parent.showTable?parent.dataLabels[d]:null,t.vertMarker[d],d)}if(t.blanketDown[d])t.blanketDown[d].attr({x:t.leftgutter+c+o*d,y:t.topgutter+(t.height-t.topgutter-t.bottomgutter-t.dataTableHeight-t.navHeight)/2,width:o,height:(t.height-t.topgutter-t.bottomgutter-t.dataTableHeight-t.navHeight)/2});else{var f=a.rect(t.leftgutter+c+o*d,t.topgutter+(t.height-t.topgutter-t.bottomgutter-t.dataTableHeight-t.navHeight)/2,o,(t.height-t.topgutter-t.bottomgutter-t.dataTableHeight-t.navHeight)/2).attr({stroke:"none",fill:"#1b1b1b",opacity:0});t.blanketDown.push(f),function(o,c,d,p,m,g){var y=[];d.forEach((function(e,t){y.push(e.attr("r"))})),f.hover((function(){var c=t.popup.p_pu_set;clearTimeout(e),this.data("onhover",!0);var f="right";o+l.getBBox().width>t.width&&(f="left"),t.context&&(u={x:t.context.getAbsoluteX(),y:t.context.getAbsoluteY()});var _=h.attr().y+h.attr().height/2,b=a.popup(o,_,c,f,1),v=Raphael.animation({path:b.path,transform:["t",b.dx+u.x,b.dy+u.y]},200*s);i=c[0].matrix.e+b.dx+u.x,r=c[0].matrix.f+b.dy+u.y,n.popup.show&&(l.show().stop().animate(v),l.data("rel_pos",g),l.data("x",o),l.data("y",_),t.popup.p_pu_set[0].attr({text:n.xAxis.data[t.start_position+g]+""}).show().stop().animateWith(l,v,{transform:["t",i,r]},200*s),t.series.forEach((function(e,a){e.s_pu_set.show().stop().animateWith(l,v,{transform:["t",i,r]},200*s),e.s_pu_set[1].attr({text:t.series[a].s_opt.data[t.start_position+g]+" "+n.yAxis.units.label})}))),l.toFront(),c.toFront(),m.attr("opacity",.7),d.forEach((function(e,t){e.attr("r",1.4*y[t])})),null!==p&&(p.attr("opacity",1),p.attr("font","10px Open Sans"),p.attr("font-weight","bold")),s=!0}),(function(){var a=t.popup.p_pu_set;this.data("onhover",!1),l.removeData("rel_pos"),m.attr("opacity",0),d.forEach((function(e,t){e.attr("r",y[t])})),null!==p&&(p.attr("opacity",.7),p.attr("font","10px Open Sans"),p.attr("font-weight","bold")),e=setTimeout((function(){l.hide(),a.hide(),s=!1}),1)}))}(f.attr("x")+f.attr("width")/2,(f.attr("y"),f.attr("height")),p,parent.showTable?parent.dataLabels[d]:null,t.vertMarker[d],d)}}},s.prototype.addSerie=function(e,t){var a=this,n=this.options,i=void 0!==t?t:a.series.length;this.paper.setStart(),n.series.splice(i,0,e),(!n.yAxis.scale&&!n.data_table||n.data_table.show)&&a.getGridConfig(),a.yAxisLabels&&(a.yAxisLabels.remove(),a.yAxisLabels=a.paper.set()),a.xAxisLabels&&(a.xAxisLabels.remove(),a.xAxisLabels=a.paper.set()),this.options.grid.show&&a.grid.refresh();var r=$.extend(!0,{},e);"line"===r.type?r.style=$.extend(!0,{},default_line,e.style):r.style=$.extend(!0,{},default_bar,e.style);var s=new o(r,a.paper,a);return s.s_opt_ori=$.extend(!0,{},e),a.series.splice(i,0,s),"bar"!==e.type||e.style.bar_overlap||(void 0!==s.s_opt.stack&&""!==s.s_opt.stack?(-1===a.stack_arr.indexOf(s.s_opt.stack)&&(a.stack_arr.push(s.s_opt.stack),a.bar_cols++),s.stack_ind=a.stack_arr.indexOf(s.s_opt.stack)):a.bar_cols++),a.redrawSeries(),this.options.popup.show&&a.popup.refresh(),a.updateBlankets(),a.options.data_table.show&&a.dataTable.refresh(),this.blanketUp.toFront(),this.blanketDown.toFront(),this.paper.setFinish()},s.prototype.removeSerie=function(e){var t,a=this,n=this.options,o=e;if(!(o>-1&&o<=a.series.length-1))return null;if(t=a.series[o],n.series.splice(o,1),(!n.yAxis.scale&&!(n||{}).data_table||n.data_table.show)&&a.getGridConfig(),a.yAxisLabels&&(a.yAxisLabels.remove(),a.yAxisLabels=a.paper.set()),a.xAxisLabels&&(a.xAxisLabels.remove(),a.xAxisLabels=a.paper.set()),this.options.grid.show&&a.grid.refresh(),a.series[o].remove(),"bar"===t.type&&!t.style.bar_overlap&&(a.bar_cols--,void 0!==t.s_opt.stack&&""!==t.s_opt.stack)){var i=!1;a.series.forEach(((e,n)=>{e.stack_ind===a.stack_arr.indexOf(t.s_opt.stack)&&(i=!0)})),i||a.stack_arr.splice(a.stack_arr.indexOf(t.s_opt.stack),1)}a.redrawSeries(),this.options.popup.show&&a.popup.refresh(),a.updateBlankets(),a.options.data_table.show&&a.dataTable.refresh(),this.blanketUp.toFront(),this.blanketDown.toFront()},s.prototype.redrawSeries=function(){this.bar_cols=0,this.line_cols=0,this.stack_arr=[],this.stack_bar_ind_arr=[],this.series.forEach(((e,t)=>{e.s_opt.style.bar_overlap||(void 0!==e.s_opt.stack&&""!==e.s_opt.stack?(-1===this.stack_arr.indexOf(e.s_opt.stack)&&(this.stack_arr.push(e.s_opt.stack),this.stack_bar_ind_arr.push(this.bar_cols),e.s_opt.type,this.bar_cols++),e.stack_ind=this.stack_arr.indexOf(e.s_opt.stack),e.bar_index=this.stack_bar_ind_arr[this.stack_arr.indexOf(e.s_opt.stack)]):"line"===e.s_opt.type?this.line_cols++:(e.bar_index=this.bar_cols,this.bar_cols++))})),this.series.forEach(((e,t)=>{e.draw(),e.toFront()}))},s.prototype.getGridConfig=function(){var e=this.options,t=e.yAxis.scale;e.data_table.show&&(this.dataTableHeight=e.series.length*this.dataTableRowH),e.nav.show&&this.period<this.longest_data&&(this.navHeight=this.options.nav.height||35),this.X=(this.width-this.leftgutter-this.rightgutter)/(this.period+1*this.options.grid.padding-1),isFinite(this.X)||(this.options.grid.padding=!0,this.X=(this.width-this.leftgutter-this.rightgutter)/(this.period+1*this.options.grid.padding-1));var a=[],n=[],o=t?this.finish_position:e.xAxis.data.length-1,i=[],r=[];this.series.forEach((function(e,t){i.push(e.s_opt.data.length),e.s_opt.stack&&""!==e.s_opt.stack&&-1===r.indexOf(e.s_opt.stack)&&r.push(e.s_opt.stack)}));var s=Math.max.apply(Math,i);this.last_positive=[],this.last_negative=[];for(var l=0;l<s;l++){for(var c=[],u=[],d=0;d<r.length;d++)c.push(0),u.push(0);this.last_positive.push(c),this.last_negative.push(u)}for(var p=t?this.start_position:0;p<=o;p++){var h=[],f=[];r.forEach((()=>{f.push([])})),this.series.forEach((function(e,t){e.s_opt.stack&&""!==e.s_opt.stack?f[r.indexOf(e.s_opt.stack)].push(void 0===e.s_opt.data[p]?0:e.s_opt.data[p]):h.push([void 0===e.s_opt.data[p]?0:e.s_opt.data[p]])})),(h=f.concat(h)).forEach(((e,t)=>{e.reduce(((e,t)=>e<0||t<0?-1:1))<0?n.push(e.reduce(((e,t)=>(e<0?e:0)+(t<0?t:0)))):n.push(Math.min.apply(Math,e)),a.push(e.reduce(((e,t)=>(e>0?e:0)+(t>0?t:0))))}))}var m,g=Math.max.apply(Math,a),y=Math.min.apply(Math,n),_=g===y?(g+=1)-(y-=1):g-y,b=_.toString().indexOf(".")>-1?Math.pow(10,_.toString().split(".")[0].length-1):Math.pow(10,_.toString().length-1);function v(e,t){return Math.ceil(e/t)*t}if(this.max=g/Math.abs(g)*v(10*Math.abs(g)/b,2)/10*b,isNaN(this.max)&&(this.max=100),y<0)this.min=0===y?0:-v(10*Math.abs(y)/b,2)/10*b;else{var w=(m=10*Math.abs(y)/b,2*Math.floor(m/2));this.min=0===y?0:w/10*b}this.max=void 0!==e.yAxis.max?e.yAxis.max:this.max,this.min=void 0!==e.yAxis.min?e.yAxis.min:this.min,this.Y=0===this.max?10:(this.height-this.bottomgutter-this.topgutter-this.dataTableHeight-this.xLabelHieght-this.navHeight)/(this.max-this.min)},s.prototype.refresh=function(){this.nav&&this.nav.refresh(),this.getGridConfig(),this.grid&&this.grid.refresh(),this.redrawSeries(),this.dataTable&&this.dataTable.refresh(),this.popup&&this.options.popup.show&&(this.popup.refresh(),this.updateBlankets(),this.blanketUp.toFront(),this.blanketDown.toFront())},s.prototype.getButtonsChart=function(){var e=this,t=this.paper,a=this.options,n=10+this.leftgutter,o=this.longest_data;a.toolbar||(a.toolbar=default_toolbar),a.toolbar.show&&a.toolbar.buttons.length&&a.toolbar.buttons.forEach(((a,i)=>{if(a.show){var r=t.image(a.icon,n,0,21,21);"line"===a.name?a.onclick=function(){e.line_cols=0,e.series.forEach((function(t,a){var n=t.parent.series.indexOf(t),o=t.parent.color[n],i=t.s_opt.style.line_width||2;t.s_opt.type="line",t.s_opt.style=$.extend(!0,{},default_line,t.s_opt_ori.style?t.s_opt_ori.style:{}),t.s_dots.attr({fill:t.s_opt.style.data_points.fill?"solid"===t.s_opt.style.data_points.fill?t.s_opt.style.stroke||o:t.s_opt.style.data_points.fill:"#fff",stroke:t.s_opt.style.stroke||o,opacity:t.s_opt.style.data_points.show?t.s_opt.style.data_points.opacity:0,"stroke-width":i}),t.s_bgp.attr(t.s_opt.style.areaStyle.show?{stroke:"none",opacity:t.s_opt.style.areaStyle.opacity||.3,fill:t.s_opt.style.areaStyle.fill||o}:{stroke:"none",opacity:0,fill:"none"}),e.line_cols++})),e.refresh()}:"bar"===a.name?a.onclick=function(){e.series.forEach((function(e,t){var a=e.parent.series.indexOf(e),n=e.parent.color[a];e.s_opt.type="bar",e.s_opt.style=$.extend(!0,{},default_bar,e.s_opt_ori.style?e.s_opt_ori.style:{}),e.s_dots.attr({opacity:0,"stroke-width":0}),e.s_bgp.attr({fill:e.s_opt.style.fill||n,opacity:e.s_opt.style.opacity||.8})})),e.refresh()}:"refresh"===a.name?a.onclick=function(){e.series.forEach((function(e,t){var a=e.parent.series.indexOf(e),n=e.parent.color[a];e.s_opt.stack=e.s_opt_ori.stack,"line"===e.s_opt_ori.type?(e.s_opt.type="line",e.s_opt.style=$.extend(!0,{},default_line,e.s_opt_ori.style),e.s_dots.attr({opacity:e.s_opt.style.data_points.show?e.s_opt.style.data_points.opacity:0}),e.s_bgp.attr(e.s_opt.style.areaStyle.show?{stroke:"none",opacity:e.s_opt.style.areaStyle.opacity||.3,fill:e.s_opt.style.areaStyle.fill||n}:{stroke:"none",opacity:0,fill:"none"})):(e.s_opt.type="bar",e.s_opt.style=$.extend(!0,{},default_bar,e.s_opt_ori.style),e.s_dots.attr({opacity:0}),e.s_bgp.attr({fill:e.s_opt.style.fill||n,opacity:e.s_opt.style.opacity||.8}))})),e.refresh()}:"full_left"===a.name?a.onclick=function(){e.start_position=0,e.finish_position=e.period-1,e.refresh()}:"left"===a.name?a.onclick=function(){e.start_position=e.start_position-1<0?0:e.start_position-1,e.finish_position=e.start_position+e.period-1,e.refresh()}:"right"===a.name?a.onclick=function(){e.finish_position=e.finish_position+1>o-1?o-1:e.finish_position+1,e.start_position=e.finish_position-e.period+1,e.refresh()}:"full_right"===a.name?a.onclick=function(){e.finish_position=o-1,e.start_position=e.finish_position-e.period+1,e.refresh()}:"stack"===a.name?a.onclick=function(){e.series.forEach((function(e,t){e.s_opt.stack="all"})),e.refresh()}:"tiled"===a.name&&(a.onclick=function(){e.series.forEach((function(e,t){e.s_opt.stack=""})),e.refresh()}),r.mouseup(a.onclick),n+=28,r.attr({opacity:.6}),function(e){e.hover((function(){e.attr({opacity:1})}),(function(){e.attr({opacity:.6})}))}(r)}}))},r.init=function(e,t,a){if(CHART_DEBUG)var n=performance.now();var o=new s(e,t,a);return CHART_DEBUG&&console.log("Ushart New Total "+(n-performance.now())),o},r})),define("jquery",(function(){return $})),require("ucharts")},__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("a45670b3d8fb79ec0258"),__webpack_require__("0307ad93737cf903c40d")],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},"207688a7407ed28dff76":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("d1be49724a1f416e7f57");n.shape.fishbone.cell.Slanode=n.shape.layout.FlexGridLayout.extend({NAME:"draw2d.shape.fishbone.cell.Slanode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Slanode</strong>}<br/><br/>",init:function(e,t,a,r){this._super(o.extend({columns:"grow, grow",rows:"18px, 18px",bgColor:"#09639b",stroke:2},e),t,a,r),this.setColor("#09639b"),this.setRadius(3),this.in_header=new n.shape.layout.HorizontalLayout,this.out_header=new n.shape.layout.HorizontalLayout,this.in_label=new n.shape.basic.Label({text:"In 10 day(s)",resizeable:!1,stroke:0}).setBold(!1).setFontColor("#09639b"),this.out_label=new n.shape.basic.Label({text:"Out of 10 day(s)",resizeable:!1,stroke:0}).setBold(!1).setFontColor("#09639b"),this.in_label.installEditor(new n.ui.LabelInplaceEditor({onCommit:o.proxy((function(e){this.userData.isInEditedLabel=!0,this.userData.Inlabel=e}),this),onCancel:function(){}})),this.out_label.installEditor(new n.ui.LabelInplaceEditor({onCommit:o.proxy((function(e){this.userData.isOutEditedLabel=!0,this.userData.Outlabel=e}),this),onCancel:function(){}})),this.in_label.setFontFamily("Tahoma, Geneva"),this.out_label.setFontFamily("Tahoma, Geneva"),this.in_header.add(this.in_label,new n.layout.locator.TopLocator),this.out_header.add(this.out_label,new n.layout.locator.TopLocator),this.in_header.setStroke(0).setRadius(this.getRadius()),this.in_header.setBackgroundColor("#cde5fe"),this.out_header.setStroke(0).setRadius(this.getRadius()),this.out_header.setBackgroundColor("#ff9795"),this.add(this.in_header,{row:0,col:0}),this.add(this.out_header,{row:1,col:0}),this.in_val_label=new n.shape.basic.Label({text:"0",width:1,height:1,rowspan:1,colspan:1,align:"center",valign:"middle",resizeable:!0,stroke:0}).setBold(!0).setFontSize(16).setPadding({left:10,right:10}).setFontColor("#eaf4ff"),this.out_val_label=new n.shape.basic.Label({text:"0",width:1,height:1,rowspan:1,colspan:1,align:"center",valign:"middle",resizeable:!0,stroke:0}).setBold(!0).setFontSize(16).setPadding({left:10,right:10}).setFontColor("#eaf4ff");var s=this;this.add(this.in_val_label,{row:0,col:1}),this.add(this.out_val_label,{row:1,col:1}),this.setDimension(100,0),this.sites_list_in=[],this.in_sites_list_out=[],this.out_sites_list_out=[],this.sites_list_in_from=[],this.sites_list_in_to=[],null===this.getUserData()&&this.attr({userData:{hidden:!1,sla:10,comp_level:"site_id",done:!1,conditions:[{logic:"",prop:"self",sign:"not equal",value:"empty"}],in_value:0,out_value:0,in_sites_list_out:[],out_sites_list_out:[],isInEditedLabel:!1,Inlabel:"In",isOutEditedLabel:!1,Outlabel:"Out"}}),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},comp_level:{type:"string",title:"Comparision Level",default:"sites",enum:["site_id","site_code","du_id"]},sla:{type:"integer",title:"SLA",default:10},done:{type:"boolean",title:"For Complete",default:!1},conditions:{type:"array",format:"hidden",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},prop:{type:"string",default:"self"},sign:{type:"string",default:"not equal",enum:["not equal","equal","more","less","less or equal","more or equal"]},value:{type:"string",format:"date",default:"empty"}},required:["logic","prop","sign","value"]}},in_value:{type:"integer",title:"In SLA",default:0},out_value:{type:"integer",title:"Out of SLA",default:0},in_sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},out_sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},isInEditedLabel:{type:"boolean",format:"hidden",default:!0},Inlabel:{type:"string",format:"hidden",default:"In"},isOutEditedLabel:{type:"boolean",format:"hidden",default:!0},Outlabel:{type:"string",format:"hidden",default:"Out"}},required:["sla"]},this.updateUI=function(){var e=this.getUserData();this.in_val_label.setText(e.in_value),this.out_val_label.setText(e.out_value),this.userData.isInEditedLabel?this.in_label.setText(this.userData.Inlabel):this.in_label.setText("In "+e.sla+" day(s)"),this.userData.isOutEditedLabel?this.out_label.setText(this.userData.Outlabel):this.out_label.setText("Out "+e.sla+" day(s)")},this.updateTable=function(){console.log("SLA updateTable"),s.startTimer();var e=[];if(s.sites_list_in_from.length>0&&s.sites_list_in_to.length>0){var t,a=s.sites_list_in_from.slice();s.userData.done?"site_id"===s.userData.comp_level?e=i(t="SELECT t.my_date as onto, f.site_id, f.site_code, f.task_name, f.task_type, f.my_date FROM ? f LEFT JOIN ? t ON (t.site_id = f.site_id)",[s.sites_list_in_to,a]):"site_code"===s.userData.comp_level?e=i("SELECT t.my_date as onto, f.site_id, f.site_code, f.task_name, f.task_type, f.my_date FROM ? f LEFT JOIN ? t ON (t.site_code = f.site_code)",[s.sites_list_in_to,a]):"du_id"===s.userData.comp_level&&(e=i(t="SELECT t.my_date as onto, f.du_id, f.site_id, f.site_code, f.task_name, f.task_type, f.my_date FROM ? f LEFT JOIN ? t ON (t.du_id = f.du_id)",[s.sites_list_in_to,a])):"site_id"===s.userData.comp_level?(t='SELECT t.site_id, t.site_code, "'+s.sites_list_in_to[0].task_name+'" as task_name, t.task_type, t.my_date FROM ? AS f Right JOIN ? AS t ON (f.site_id = t.site_id) where f.site_id IS NULL OR t.site_id IS NULL',e=i(t,[s.sites_list_in_to,a])):"site_code"===s.userData.comp_level?e=i("SELECT t.*, f.* FROM ? AS f Right JOIN ? AS t ON (f.site_code = t.site_code) where f.site_id IS NULL OR t.site_id IS NULL",[s.sites_list_in_to,a]):"du_id"===s.userData.comp_level&&(t='SELECT t.du_id, t.site_id, f.site_code, "'+s.sites_list_in_to[0].task_name+'" as task_name, t.task_type, t.my_date FROM ? AS f Right JOIN ? AS t ON (f.du_id = t.du_id) where f.du_id IS NULL OR t.du_id IS NULL',e=i(t,[s.sites_list_in_to,a]))}s.userData.in_sites_list_out=[],s.userData.out_sites_list_out=[],e.length&&(s.userData.done?(i.fn.inSLA=function(e,t){return void 0!==e&&void 0!==t&&!(Math.ceil((t.getTime()-e.getTime())/864e5)>s.userData.sla)},s.userData.in_sites_list_out=i("SELECT * FROM ? WHERE inSLA(onto, my_date)",[e]),s.userData.out_sites_list_out=i("SELECT * FROM ? WHERE not inSLA(onto, my_date)",[e])):(i.fn.inSLA=function(e){var t=new Date;if(void 0!==e){var a=new Date(e);return!(Math.ceil((t.getTime()-a.getTime())/864e5)>s.userData.sla)}return!1},s.userData.in_sites_list_out=i("SELECT * FROM ? AS f WHERE inSLA(my_date)",[e]),s.userData.out_sites_list_out=i("SELECT * FROM ? AS f WHERE not inSLA(my_date)",[e])));var n=s.userData.done?"completed":"pending";s.userData.in_sites_list_out.forEach((function(e,t){e.task_type=n+" in SLA"})),s.userData.out_sites_list_out.forEach((function(e,t){e.task_type=n+" out of SLA"})),s.userData.in_value=s.userData.in_sites_list_out.length,s.userData.out_value=s.userData.out_sites_list_out.length,s.getPort("outputIn").setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.Inlabel,task_type:n+" in SLA",sites_list_out:s.userData.in_sites_list_out}),s.getPort("outputIn").getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(s.getId()),t.setColor(s.getBackgroundColor())}),this)),s.getPort("outputOut").setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.Outlabel,task_type:n+" out of SLA",sites_list_out:s.userData.out_sites_list_out}),s.getPort("outputOut").getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(s.getId()),t.setColor(s.getBackgroundColor())}),this)),this.updateUI(),s.stopTimer()},this.GetHTTPData=function(){this.updateTable()};var l=new n.SLAInputPortTo;l.setConnectionDirection(3),l.setName("SLAInputTo"),l.setColor("#2796ff"),this.addPort(l);var c=new n.SLAInputPortFrom;c.setConnectionDirection(0),c.setName("SLAInputFrom");var u=new n.layout.locator.SQLTopLocator;this.addPort(c,u);var d=new n.OutputPort;d.setConnectionDirection(1),d.setName("outputIn"),this.addPort(d);var p=new n.OutputPort;p.setConnectionDirection(1),p.setName("outputOut"),this.addPort(p),this.updateTickets=0,this.layoutPorts(),this.getRealCount=function(){return 1},this.repaint()},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1){this.updateTickets=this.updateTickets+1,console.log("SLANode update ticket received: "+this.updateTickets);var a=0;this.userData.conn_count?a=this.userData.conn_count:this.getInputPorts().data.forEach((function(e,t){a+=e.getConnections().data.length})),this.updateTickets>=a&&this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.userData||(a.userData={}),a.userData.realCount=this.getRealCount(),a.setValue("ticket"),t.setColor("#dfdfdf")}),t))}))}else{if(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),console.log("SLANode update data received: "+this.updateTickets),"SLAInputTo"==e.name){var n=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in_to=n.getUserData().sites_list_out}"SLAInputFrom"==e.name&&(n=this.getInputPort(1).getConnections().data[0].getSource(),this.sites_list_in_from=n.getUserData().sites_list_out),this.updateTickets<=0&&(this.GetHTTPData(),this.updateUI())}},onTimer:function(){"."!==this.in_val_label.getText()&&".."!==this.in_val_label.getText()&&"..."!==this.in_val_label.getText()&&this.in_val_label.setText("."),"."===this.in_val_label.getText()?this.in_val_label.setText(".."):".."===this.in_val_label.getText()?this.in_val_label.setText("..."):"..."===this.in_val_label.getText()&&this.in_val_label.setText("."),"."!==this.out_val_label.getText()&&".."!==this.out_val_label.getText()&&"..."!==this.out_val_label.getText()&&this.out_val_label.setText("."),"."===this.out_val_label.getText()?this.out_val_label.setText(".."):".."===this.out_val_label.getText()?this.out_val_label.setText("..."):"..."===this.out_val_label.getText()&&this.out_val_label.setText(".")},getPersistentAttributes:function(){return this._super()},setPersistentAttributes:function(e){e.ports.forEach((function(e){"SQLTopLocator"===e.locator&&(e.locator="draw2d.layout.locator.SQLTopLocator")})),this._super(e),this.updateUI()}})},"22cc6edc006f7d982b02":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("d1be49724a1f416e7f57");n.shape.fishbone.cell.Periodnode=n.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Periodnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Periodnode</strong>}<br/><br/> <strong>Period </strong><cite>Node </cite>Calculates period between 2 dates in days.<br/><br/><strong>Configuration: </strong><br/><br/><strong>Comparison Level: </strong> <cite>select between site_code and site_id. Specify field name will be used for sites comparation ",init:function(e,t,a,n){this._super(o.extend({color:"#9a9a9a",filter_str:"Period"},e),t,a,n);var r=this;o.extend(this.userData,{comp_level:"du_id",label:"New Label",type_name:"period"}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{comp_level:{type:"string",title:"Comparision Level",default:"sites",enum:["du_id","site_id","site_code"]},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"add"},ignore_negative:{type:"boolean",title:"Ignore Negative",default:"true"}},required:[]}),this.updateTable=function(){if(console.log("add updateTable"),r.userData.sites_list_out=[],r.userData.row.length>0){var e=[];r.userData.row.forEach((function(t,a){var n;if(0===a)e=t.sites_list_out.slice();else{var o=r.userData.ignore_negative?" where moment(f.my_date).diff(moment(s.my_date), 'days') > -1":"";"du_id"===r.userData.comp_level?n=i("SELECT f.du_id, f.du_model_name, f.site_id, f.site_code, s.my_date as start, f.my_date as finish, moment(f.my_date).diff(moment(s.my_date), 'days') as period FROM ? AS f INNER JOIN ? AS s ON f.du_id = s.du_id"+o,[t.sites_list_out,e]):"site_id"===r.userData.comp_level?n=i("SELECT f.du_id, f.du_model_name, f.site_id, f.site_code, s.my_date as start, f.my_date as finish, moment(f.my_date).diff(moment(s.my_date), 'days') as period FROM ? AS f INNER JOIN ? AS s ON f.site_id = s.site_id"+o,[t.sites_list_out,e]):"site_code"===r.userData.comp_level&&(n=i("SELECT f.du_id, f.du_model_name, f.site_id, f.site_code, s.my_date as start, f.my_date as finish , moment(f.my_date).diff(moment(s.my_date), 'days') as period FROM ? AS f INNER JOIN ? AS s ON f.site_code = s.site_code"+o,[t.sites_list_out,e])),e=n}r.userData.sites_list_out=e}))}r.userData.value=r.userData.sites_list_out.length,r.userData.sites_list_out.forEach((function(e,t){e.task_name=r.userData.label,e.task_type=r.userData.type_name||"period"})),r.getPort("output0").setUserData({project:r.project,scope:r.scope,sop:r.sop,item_name:r.userData.label,task_type:r.userData.type_name||"and",sites_list_out:r.userData.sites_list_out}),r.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(r.getId()),t.setColor(r.frame.attr("stroke"))}),this)),this.updateUI()}}})},"22fa153d84d0dbf77aa0":(e,t,a)=>{var n=a("8a868d10b6533e768658");n.layout.locator.TopInputPortLocator=n.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.TopInputPortLocator",init:function(){this._super()},relocate:function(e,t){var a=t.getParent(),n=1,o=this.NAME,i=1;a.getPorts().each((function(e,a){i=a===t?n:i,n+=a.getLocator().NAME===o?1:0})),this.applyConsiderRotation(t,a.getWidth()/n*i,0)}})},"28333c1a4e064830601d":(e,t,a)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return i(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw r}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}a.d(t,{k:()=>l});var l=function(){return e=function e(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.elements={input:document.getElementById("message-input"),sendButton:document.getElementById("send-button"),messages:document.getElementById("chat-messages"),clearButton:document.getElementById("clear-history")},this.config={typingDelay:a.typingDelay||1e3,copyTimeout:a.copyTimeout||2e3,figure:a.figure,autoUpdate:a.autoUpdate},this.boundHandlers={sendMessage:function(){return t.sendMessage()},handleKeyPress:function(e){return t.handleKeyPress(e)},adjustTextarea:function(){return t.adjustTextareaHeight()},clearHistory:function(){return t.clearHistory()},focusHandler:function(){return t.handleInputFocus()}},this.history=[],this.typingTimeout=null,this.activeRequestStart=null,this.init()},t=[{key:"init",value:function(){var e;this.attachEventListeners(),this.initializeTextarea(),null!==(e=this.elements)&&void 0!==e&&e.messages&&(this.elements.messages.innerHTML=""),this.loadHistory(),0===this.history.length&&this.addMessage({text:"Welcome! I'm your AI Assistant",sender:"bot"})}},{key:"attachEventListeners",value:function(){var e,t,a,n,o;this.elements&&(null===(e=this.elements.sendButton)||void 0===e||e.addEventListener("click",this.boundHandlers.sendMessage),null===(t=this.elements.input)||void 0===t||t.addEventListener("keydown",this.boundHandlers.handleKeyPress),null===(a=this.elements.input)||void 0===a||a.addEventListener("input",this.boundHandlers.adjustTextarea),null===(n=this.elements.input)||void 0===n||n.addEventListener("focus",this.boundHandlers.focusHandler),null===(o=this.elements.clearButton)||void 0===o||o.addEventListener("click",this.boundHandlers.clearHistory))}},{key:"removeEventListeners",value:function(){var e,t,a,n,o;this.elements&&(null===(e=this.elements.sendButton)||void 0===e||e.removeEventListener("click",this.boundHandlers.sendMessage),null===(t=this.elements.input)||void 0===t||t.removeEventListener("keydown",this.boundHandlers.handleKeyPress),null===(a=this.elements.input)||void 0===a||a.removeEventListener("input",this.boundHandlers.adjustTextarea),null===(n=this.elements.input)||void 0===n||n.removeEventListener("focus",this.boundHandlers.focusHandler),null===(o=this.elements.clearButton)||void 0===o||o.removeEventListener("click",this.boundHandlers.clearHistory),this.removeMessageToolListeners())}},{key:"removeMessageToolListeners",value:function(){var e;null!==(e=this.elements)&&void 0!==e&&e.messages&&this.elements.messages.querySelectorAll(".message").forEach((function(e){e.querySelectorAll(".tool-button").forEach((function(e){var t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)}));var t=e.querySelector(".edit-form");if(t){var a=t.cloneNode(!0);t.parentNode.replaceChild(a,t)}}))}},{key:"cleanup",value:function(){var e,t;this.removeEventListeners(),this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null),this.hideTypingIndicator(null===(e=this.elements)||void 0===e||null===(e=e.messages)||void 0===e?void 0:e.querySelector(".typing-indicator")),null!==(t=this.elements)&&void 0!==t&&t.input&&(this.elements.input.value="",this.elements.input.style.height="48px"),this.elements=null,this.config=null,this.boundHandlers=null,this.history=null}},{key:"initializeTextarea",value:function(){var e;null!==(e=this.elements)&&void 0!==e&&e.input&&(this.adjustTextareaHeight(),this.elements.input.value="",this.elements.input.style.height="48px")}},{key:"handleInputFocus",value:function(){var e;null!==(e=this.elements)&&void 0!==e&&e.input&&!this.elements.input.value&&(this.elements.input.style.height="48px")}},{key:"adjustTextareaHeight",value:function(){var e,t=null===(e=this.elements)||void 0===e?void 0:e.input;t&&(t.style.height="auto",t.style.height="".concat(Math.min(t.scrollHeight,200),"px"))}},{key:"handleKeyPress",value:function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),this.sendMessage())}},{key:"loadHistory",value:function(){var e=this;try{var t;if(null===(t=this.config)||void 0===t||!t.figure)return;var a=this.config.figure.chat_history||[];this.history=a,this.history.forEach((function(t){return e.renderMessage(t)})),this.scrollToBottom(),this.config.figure.xhr&&[1,2,3].includes(this.config.figure.xhr.readyState)&&(this.typingIndicator=this.showTypingIndicator(),this.activeRequestStart=Date.now())}catch(e){console.error("Error loading history:",e),this.history=[]}}},{key:"saveHistory",value:function(){try{var e;null!==(e=this.config)&&void 0!==e&&e.figure&&(this.config.figure.chat_history=this.history)}catch(e){console.error("Error saving history:",e)}}},{key:"clearHistory",value:function(){var e,t;confirm("Clear chat history?")&&(this.history=[],null!==(e=this.config)&&void 0!==e&&e.figure&&(this.config.figure.chat_history=[]),null!==(t=this.elements)&&void 0!==t&&t.messages&&(this.elements.messages.innerHTML=""),this.addMessage({text:"History cleared. How can I help you?",sender:"bot"}))}},{key:"sendMessage",value:function(){var e,t;if(null!==(e=this.elements)&&void 0!==e&&e.input){var a=this.elements.input.value.trim();a&&(this.elements.input.value="",this.elements.input.style.height="48px",null!==(t=this.config)&&void 0!==t&&t.figure&&(this.config.figure.userData.prompt=a,this.activeRequestStart=Date.now(),this.config.autoUpdate&&this.config.figure.updateTable()))}}},{key:"sendFigureMessage",value:function(e){"bot"===e.sender&&this.activeRequestStart&&(e.requestDuration=Date.now()-this.activeRequestStart,this.activeRequestStart=null),this.addMessage(e)}},{key:"addMessage",value:function(e){var t,a;console.log("ChatApp.addMessage called with:",e),console.log("Elements available:",{messages:!(null===(t=this.elements)||void 0===t||!t.messages),messagesId:null===(a=this.elements)||void 0===a||null===(a=a.messages)||void 0===a?void 0:a.id}),e.id||(e.id="msg-".concat(Date.now())),e.timestamp||(e.timestamp=(new Date).toISOString()),this.history.push(e),this.saveHistory(),console.log("About to render message..."),this.renderMessage(e),this.scrollToBottom(),console.log("Message rendering complete")}},{key:"renderMessage",value:function(e){var t;if(null!==(t=this.elements)&&void 0!==t&&t.messages){var a=this.elements.messages.querySelector('[data-message-id="'.concat(e.id,'"]'));a&&a.remove();var n=document.createElement("div");n.className="message ".concat(e.sender),n.setAttribute("data-message-id",e.id),n.style.marginBottom="8px",n.style.marginTop="0",n.style.padding="0",n.style.display="flex",n.style.flexDirection="column";var o=document.createElement("div");o.className="message-content-wrapper";var i=document.createElement("div");if(i.className="message-content","code"===e.type)i.appendChild(this.createCodeBlock(e.code,e.language));else if("image"===e.type){var r=document.createElement("img");r.src=e.url,r.className="message-image",r.alt="Chat image",i.appendChild(r)}else i.appendChild(this.processMessageContent(e.text,e.full_text));o.appendChild(i);var s=document.createElement("div");if(s.className="message-footer","user"===e.sender){var l=this.createMessageTools(e);s.appendChild(l);var c=this.createTimestamp(e);s.appendChild(c)}o.appendChild(s),n.appendChild(o),a?this.elements.messages.insertBefore(n,a.nextSibling):this.elements.messages.appendChild(n),this.scrollToBottom()}}},{key:"createMessageTools",value:function(e){var t=this,a=document.createElement("div");a.className="message-tools";var n=document.createElement("button");if(n.className="tool-button",n.innerHTML='<i class="bi bi-clipboard" style="font-size: 1em"></i>',n.title="Copy message",n.onclick=function(a){a.stopPropagation(),t.copyMessage(e)},a.appendChild(n),"user"===e.sender){var o=document.createElement("button");o.className="tool-button",o.innerHTML='<i class="bi bi-pencil" style="font-size: 1em"></i>',o.title="Edit message",o.onclick=function(a){a.stopPropagation(),t.startEditing(e)},a.appendChild(o)}if("bot"===e.sender){var i=document.createElement("button");i.className="tool-button",i.innerHTML='<i class="bi bi-arrow-clockwise" style="font-size: 1em"></i>',i.title="Regenerate response",i.onclick=function(a){a.stopPropagation(),t.retryMessage(e)},a.appendChild(i)}return a}},{key:"startEditing",value:function(e){var t,a;if(null!==(t=this.elements)&&void 0!==t&&t.messages){var n=this.elements.messages.querySelector('[data-message-id="'.concat(e.id,'"]'));if(n){var o=n.querySelector(".message-content");if(o){var i=this.isLastUserMessage(e)&&null!==(a=this.config)&&void 0!==a&&null!==(a=a.figure)&&void 0!==a&&null!==(a=a.userData)&&void 0!==a&&a.prompt?this.config.figure.userData.prompt:e.text,r=this.createEditForm(e,i);o.innerHTML="",o.appendChild(r);var s=r.querySelector("textarea");s&&(s.focus(),s.selectionStart=s.selectionEnd=s.value.length)}}}}},{key:"createEditForm",value:function(e,t){var a=this,n=document.createElement("form");n.className="edit-form";var o=document.createElement("textarea");o.className="edit-textarea",o.value=t,o.rows=Math.max(6,Math.min(20,t.split("\n").length));var i=document.createElement("div");i.className="edit-buttons";var r=document.createElement("button");r.type="submit",r.className="save-button",r.textContent="Save";var s=document.createElement("button");s.type="button",s.className="cancel-button",s.textContent="Cancel";var l=function(n){n.preventDefault();var i,r,s,l=o.value.trim();l&&l!==t?(e.text=l,a.isLastUserMessage(e)&&null!==(i=a.config)&&void 0!==i&&i.figure&&(a.config.figure.userData.prompt=l),a.renderMessage(e),a.saveHistory(),null!==(r=a.config)&&void 0!==r&&r.autoUpdate&&null!==(s=a.config)&&void 0!==s&&s.figure&&a.config.figure.updateTable()):a.renderMessage(e)};return n.addEventListener("submit",l),s.addEventListener("click",(function(){a.renderMessage(e)})),o.addEventListener("keydown",(function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),l(e))})),i.appendChild(r),i.appendChild(s),n.appendChild(o),n.appendChild(i),n}},{key:"isLastUserMessage",value:function(e){var t,a=this.history.filter((function(e){return"user"===e.sender}));return(null===(t=a[a.length-1])||void 0===t?void 0:t.id)===e.id}},{key:"copyMessage",value:function(e){var t=e.text||JSON.stringify(e.result,null,2);navigator.clipboard.writeText(t);var a=document.createElement("div");a.className="copy-tooltip",a.textContent="Copied!",document.body.appendChild(a),setTimeout((function(){return a.remove()}),this.config.copyTimeout)}},{key:"retryMessage",value:function(e){var t,a=this;if(null!==(t=this.config)&&void 0!==t&&t.figure){for(var n=this.history.findIndex((function(t){return t.id===e.id})),o=null,i=n-1;i>=0;i--)if("user"===this.history[i].sender){o=this.history[i];break}if(o){var r,s=this.history.findIndex((function(e){return e.id===o.id}));this.history=this.history.slice(0,s+1),this.saveHistory(),null!==(r=this.elements)&&void 0!==r&&r.messages&&(this.elements.messages.innerHTML="",this.history.forEach((function(e){return a.renderMessage(e)}))),this.config.figure.userData.prompt=o.text,this.activeRequestStart=Date.now(),this.config.figure.updateTable()}}}},{key:"processMessageContent",value:function(e,t){var a=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return document.createElement("div");var i=document.createElement("div"),r=document.createElement("div");i.appendChild(r);for(var s,l=function(e,t){for(var a,n=/```(\w+)?\n?([\s\S]*?)```/g,i="",r=0,s=0,l=[];null!==(a=n.exec(e));)l.push({fullMatch:a[0],lang:a[1]||"",code:a[2],start:a.index,end:a.index+a[0].length});if(0===l.length)return e.slice(0,t)+"...";for(var c=0;c<l.length;c++){var u=l[c],d=e.slice(r,u.start);if(!(s+d.length<=t)){var p=t-s;return i+(d.slice(0,p)+"...")}i+=d,s+=d.length;var h="```"+(u.lang?u.lang+"\n":"\n");if(!(s+u.fullMatch.length<=t)){var f=t-s-h.length-3;if(f>0){var m,g="",y=0,_=o(u.code.split("\n"));try{for(_.s();!(m=_.n()).done;){var b=m.value;if(!(y+b.length+1<=f))break;g+=b+"\n",y+=b.length+1}}catch(e){_.e(e)}finally{_.f()}i+=h+g.trimEnd()+"```"}return i}i+=u.fullMatch,s+=u.fullMatch.length,r=u.end}var v=e.slice(r);if(s+v.length<=t)i+=v;else{var w=t-s;i+=v.slice(0,w)+"..."}return i},c=t,u=n&&e.length>200,d=u?l(e,200):e,p=/```(\w+)?\n?([\s\S]*?)```/g,h=0;null!==(s=p.exec(d));){if(s.index>h){var f=d.slice(h,s.index),m=document.createElement("div");m.innerHTML=this.formatText(f),r.appendChild(m)}var g=s[1]||"",y=s[2];r.appendChild(this.createCodeBlock(y,g)),h=s.index+s[0].length}if(h<d.length){var _=document.createElement("div");_.innerHTML=this.formatText(d.slice(h)),r.appendChild(_)}if(e.length>200){var b=document.createElement("div");b.className="message-buttons";var v=document.createElement("button");if(v.className="expand-button",v.textContent=u?"Show more":"Show less",v.onclick=function(t){t.stopPropagation(),u=!u,r.innerHTML="";for(var n,o=u?l(e,200):e,i=0,s=/```(\w+)?\n?([\s\S]*?)```/g;null!==(n=s.exec(o));){if(n.index>i){var c=o.slice(i,n.index),d=document.createElement("div");d.innerHTML=a.formatText(c),r.appendChild(d)}var p=n[1]||"",h=n[2];r.appendChild(a.createCodeBlock(h,p)),i=n.index+n[0].length}if(i<o.length){var f=document.createElement("div");f.innerHTML=a.formatText(o.slice(i)),r.appendChild(f)}v.textContent=u?"Show more":"Show less"},b.appendChild(v),c&&c!==e){var w=document.createElement("button");w.className="copy-full-button",w.innerHTML='<i class="bi bi-clipboard"></i> Copy full',w.onclick=function(e){e.stopPropagation(),navigator.clipboard.writeText(c);var t=document.createElement("div");t.className="copy-tooltip",t.textContent="Full text copied!",document.body.appendChild(t),setTimeout((function(){return t.remove()}),2e3)},b.appendChild(w)}i.appendChild(b)}return i}},{key:"formatText",value:function(e){return e.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/`(.*?)`/g,"<code>$1</code>").replace(/\n/g,"<br>")}},{key:"createCodeBlock",value:function(e,t){var a=document.createElement("div");a.className="code-block";var n=document.createElement("div");n.className="code-header";var o=document.createElement("span");o.className="code-language",o.textContent=t||"plaintext",n.appendChild(o);var i=document.createElement("button");i.className="copy-code-btn",i.innerHTML='<i class="bi bi-clipboard"></i>',i.title="Copy code",i.onclick=function(){navigator.clipboard.writeText(e),i.innerHTML='<i class="bi bi-check"></i>',setTimeout((function(){i.innerHTML='<i class="bi bi-clipboard"></i>'}),2e3)},n.appendChild(i);var r=document.createElement("pre"),s=document.createElement("code");return s.className=t?"language-".concat(t):"",s.textContent=e,r.appendChild(s),a.appendChild(n),a.appendChild(r),a}},{key:"createTimestamp",value:function(e){var t=document.createElement("div");t.className="timestamp";var a=new Date(e.timestamp),n=new Date,o=a.toDateString()===n.toDateString();if(t.textContent=o?a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):a.toLocaleDateString([],{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),e.requestDuration){var i=Math.round(e.requestDuration/1e3);t.textContent+=" (".concat(i,"s)")}return t}},{key:"showTypingIndicator",value:function(){var e;if(null===(e=this.elements)||void 0===e||!e.messages)return null;var t=this.elements.messages.querySelector(".typing-indicator");if(t)return t;var a=document.createElement("div");return a.className="message bot typing-indicator",a.innerHTML='\n            <div class="typing-dots">\n                <span></span>\n                <span></span>\n                <span></span>\n            </div>\n        ',this.elements.messages.appendChild(a),this.scrollToBottom(),a}},{key:"hideTypingIndicator",value:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"scrollToBottom",value:function(){var e,t=this;null!==(e=this.elements)&&void 0!==e&&e.messages&&requestAnimationFrame((function(){t.elements.messages.scrollTop=t.elements.messages.scrollHeight}))}}],t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},"2d4ccc4a5d7ea7a03847":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("walden",{color:["#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],backgroundColor:"rgba(252,252,252,0)",textStyle:{},title:{textStyle:{color:"#666666"},subtextStyle:{color:"#999999"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"8",symbol:"emptyCircle",smooth:!1},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"8",symbol:"emptyCircle",smooth:!1},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#e6a0d2",color0:"transparent",borderColor:"#e6a0d2",borderColor0:"#3fb1e3",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:"1",color:"#cccccc"},symbolSize:"8",symbol:"emptyCircle",smooth:!1,color:["#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],label:{color:"#ffffff"}},map:{itemStyle:{areaColor:"#eeeeee",borderColor:"#aaaaaa",borderWidth:.5},label:{color:"#ffffff"},emphasis:{itemStyle:{areaColor:"rgba(63,177,227,0.25)",borderColor:"#3fb1e3",borderWidth:1},label:{color:"#3fb1e3"}}},geo:{itemStyle:{areaColor:"#eeeeee",borderColor:"#aaaaaa",borderWidth:.5},label:{color:"#ffffff"},emphasis:{itemStyle:{areaColor:"rgba(63,177,227,0.25)",borderColor:"#3fb1e3",borderWidth:1},label:{color:"#3fb1e3"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#626c91",width:1},itemStyle:{color:"#626c91",borderWidth:1},controlStyle:{color:"#626c91",borderColor:"#626c91",borderWidth:.5},checkpointStyle:{color:"#3fb1e3",borderColor:"#3fb1e3"},label:{color:"#626c91"},emphasis:{itemStyle:{color:"#626c91"},controlStyle:{color:"#626c91",borderColor:"#626c91",borderWidth:.5},label:{color:"#626c91"}}},visualMap:{color:["#2a99c9","#afe8ff"]},dataZoom:{backgroundColor:"rgba(255,255,255,0)",dataBackgroundColor:"rgba(222,222,222,1)",fillerColor:"rgba(114,230,212,0.25)",handleColor:"#cccccc",handleSize:"100%",textStyle:{color:"#999999"}},markPoint:{label:{color:"#ffffff"},emphasis:{label:{color:"#ffffff"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"2f97851495b479d0a251":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("d1be49724a1f416e7f57");n.shape.fishbone.cell.Diffnode=n.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Diffnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Diffnode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(o.extend({color:"#777777",filter_str:"Diff",data_type:"row"},e),t,a,n);var r=this;o.extend(this.userData,{comp_level:"du_id",label:"New Label",type_name:"gap"}),o.extend(!0,this.treema_scheme,{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{comp_level:{type:"string",title:"Comparision Level",default:"sites",enum:["site_id","site_code","du_id","simple"]},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"gap"}}}),this.updateTable=function(){if(console.log("diff updateTable"),r.userData.sites_list_out=[],r.userData.row.length>0){var e=[];r.userData.row.forEach((function(t,a){var n;0===a?e=t.sites_list_out.slice():("site_id"===r.userData.comp_level?n=i("SELECT s.*, f.* FROM ? AS f FULL OUTER JOIN ? AS s ON (f.site_id = s.site_id) WHERE f.site_id IS NULL OR s.site_id IS NULL",[t.sites_list_out,e]):"site_code"===r.userData.comp_level?n=i("SELECT s.*, f.* FROM ? AS f FULL OUTER JOIN ? AS s ON (f.site_code = s.site_code) WHERE f.site_code IS NULL OR s.site_code IS NULL",[t.sites_list_out,e]):"du_id"===r.userData.comp_level?n=i("SELECT s.*, f.* FROM ? AS f FULL OUTER JOIN ? AS s ON (f.du_id = s.du_id) WHERE f.du_id IS NULL OR s.du_id IS NULL",[t.sites_list_out,e]):"simple"===r.userData.comp_level&&(n=i("SELECT s.*, f.* FROM ? AS f FULL OUTER JOIN ? AS s ON (f.site_id = s.site_id and f.marker = s.marker) WHERE f.site_code IS NULL OR s.site_code IS NULL",[t.sites_list_out,e])),e=n),r.userData.sites_list_out=e}))}r.userData.value=r.userData.sites_list_out.length,r.userData.sites_list_out.forEach((function(e,t){e.task_name=r.userData.label,e.task_type=r.userData.type_name||"gap"})),r.getPort("output0").setUserData({project:r.project,scope:r.scope,sop:r.sop,item_name:r.userData.label,task_type:r.userData.type_name||"gap",sites_list_out:r.userData.sites_list_out}),r.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(r.getId()),t.setColor(r.frame.attr("stroke"))}),this)),this.updateUI()}}})},"30818c613adc53d01123":(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var n=a("1ae1679c08b57e46bac7"),o=a("a45670b3d8fb79ec0258");function i(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],a=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}}}throw new TypeError(l(e)+" is not iterable")}function r(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var r=n&&n.prototype instanceof c?n:c,u=Object.create(r.prototype);return s(u,"_invoke",function(a,n,o){var i,r,s,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,r=0,s=e,p.n=a,l}};function h(a,n){for(r=a,s=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(s=i[(r=i[4])?5:(r=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(r=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,r=0))}if(o||a>1)return l;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),r=u,s=f;(t=r<2?e:s)||!d;){i||(r?r<3?(r>1&&(p.n=-1),h(r,s)):p.n=s:p.v=s);try{if(c=2,i){if(r||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,r<2&&(r=0)}else 1===r&&(t=i.return)&&t.call(i),r<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),r=1);i=e}else if((t=(d=p.n<0)?s:a.call(n,p))!==l)break}catch(t){i=e,r=1,s=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),u}var l={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var p=[][n]?t(t([][n]())):(s(t={},n,(function(){return this})),t),h=d.prototype=c.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,s(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,s(h,"constructor",d),s(d,"constructor",u),u.displayName="GeneratorFunction",s(d,o,"GeneratorFunction"),s(h),s(h,o,"Generator"),s(h,n,(function(){return this})),s(h,"toString",(function(){return"[object Generator]"})),(r=function(){return{w:i,m:f}})()}function s(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}s=function(e,t,a,n){function i(t,a){s(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},s(e,t,a,n)}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return u(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw i}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function d(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function p(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function h(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=l(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}var f=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reportGenerator=t,this.settings=t.settings,this.$http=t.$http,this.promptManager=t.promptManager,this.branchRepository=t.branchRepository,this.configNormalizer=t.configNormalizer,this.branchRepository&&this.configNormalizer&&this.promptManager||console.error("BranchExtractionStrategy missing required dependencies (repository, normalizer, or promptManager)!")},t=[{key:"execute",value:(a=r().m((function e(t){var a,s,u,d,p,h,f,m,g,y,_,b,v,w,x,k,D,S,C,T,A,P,E,I,N,M,O,j,R,L,F=this,U=arguments;return r().w((function(e){for(;;)switch(e.p=e.n){case 0:if(a=U.length>1&&void 0!==U[1]?U[1]:1,s=void 0!==this.reportGenerator.aiPromptHistory.stage1Retries?this.reportGenerator.aiPromptHistory.stage1Retries:2,console.log("Executing Branch Extraction AI Call (Attempt ".concat(a,"/").concat(s+1,")")),e.p=1,d=JSON.parse(t),u=this.configNormalizer.normalize(d)){e.n=2;break}throw new Error("Normalization resulted in an empty configuration.");case 2:e.n=4;break;case 3:return e.p=3,j=e.v,console.error("Error parsing or normalizing report content (Attempt ".concat(a,"):"),j),e.a(2,{success:!1,count:0,error:"Failed to parse/normalize input JSON: ".concat(j.message)});case 4:return e.p=4,p=[],e.n=5,this.promptManager.getPrompt("branch-extraction");case 5:if(h=e.v){e.n=6;break}return e.a(2,{success:!1,count:0,error:"Could not load 'branch-extraction' prompt."});case 6:if(f=JSON.stringify(u,null,2),m=f.length>1e5?f.substring(0,1e5)+"... [truncated for size]":f,g="Analyze the following report configuration JSON and extract all distinct functional branches according to the defined schema. Return the result as a JSON array of branch objects.\n\nReport Configuration:\n```json\n".concat(m,"\n```"),p=[{role:"system",content:h},{role:"user",content:g}],y=this.reportGenerator.aiPromptHistory.stage1Provider||"zte_v2",_=this.reportGenerator.aiPromptHistory.stage1Model||"nebulacoder-preview",b=this.reportGenerator.aiPromptHistory.stage1Temperature||.1,v=n.A.getEndpointForProvider(y),w=this.settings.context+"/apiai/"+v+"?user_id="+window.user_id,x=p,"zte_v2"!==y&&"getZTEV2API"!==v||(console.log("Encoding messages for ZTE V2 provider/endpoint: ".concat(y,"/").concat(v)),x=n.A.prepareMessagesForZTEV2(x)),k={messages:x,temperature:b,model:_,max_tokens:this.reportGenerator.aiPromptHistory.maxTokens||16e3},n.A.extractUCSSSOToken()&&(k.UCSSSOToken=n.A.extractUCSSSOToken()),D={"Content-Type":"application/json; charset=utf-8"},!["openrouter","openai","anthropic","deepseek","google"].includes(y)){e.n=8;break}if(!(S=localStorage.getItem("ai_".concat(y,"_key")))){e.n=7;break}D["X-API-Key"]=S,e.n=8;break;case 7:throw new Error("API key required for ".concat(y,". Please configure your API key in the AI settings."));case 8:return e.n=9,new Promise((function(e,t){var a=setTimeout((function(){t(new Error("API request timed out after 480 seconds"))}),48e4);o.ajax({url:w,headers:D,dataType:"json",type:"POST",data:JSON.stringify(k),success:function(t){clearTimeout(a),e(t)},error:function(e,n,o){clearTimeout(a),t({xhr:e,status:n,error:o})}})}));case 9:if(C=e.v,console.log("Branch Extraction AI response received (Attempt ".concat(a,"):"),C),T=n.A.extractJsonFromResponse(C),Array.isArray(T)){e.n=10;break}throw new Error("AI response is not a valid JSON array of branches.");case 10:if(console.log("Parsed extracted branches:",T),A=0,P=[],!(this.branchRepository&&T.length>0)){e.n=18;break}console.log("Storing ".concat(T.length," extracted branches...")),E=c(T),e.p=11,N=r().m((function e(){var t,a,n,o,i;return r().w((function(e){for(;;)switch(e.p=e.n){case 0:if(t=I.value,e.p=1,t&&"object"===l(t)&&t.id){e.n=2;break}return console.warn("Skipping invalid branch object:",t),P.push("Invalid branch object (missing ID)"),e.a(2,1);case 2:a=0,n=!1;case 3:if(n||!(a<3)){e.n=10;break}return e.p=4,e.n=5,F.branchRepository.storeBranch(t);case 5:console.log("Stored branch: ".concat(t.id)),A++,n=!0,e.n=9;break;case 6:if(e.p=6,o=e.v,a++,console.error("Failed to store branch: ".concat(t.id," (Attempt ").concat(a,"/3)"),o),!(a<3)){e.n=8;break}return e.n=7,new Promise((function(e){return setTimeout(e,1e3*Math.pow(2,a))}));case 7:e.n=9;break;case 8:P.push("Failed to store branch ".concat(t.id,": ").concat(o.message));case 9:e.n=3;break;case 10:return e.n=11,new Promise((function(e){return setTimeout(e,200)}));case 11:e.n=13;break;case 12:e.p=12,i=e.v,console.error("Error processing branch: ".concat(t.id),i),P.push("Error processing branch ".concat(t.id,": ").concat(i.message));case 13:return e.a(2)}}),e,null,[[4,6],[1,12]])})),E.s();case 12:if((I=E.n()).done){e.n=15;break}return e.d(i(N()),13);case 13:if(!e.v){e.n=14;break}return e.a(3,14);case 14:e.n=12;break;case 15:e.n=17;break;case 16:e.p=16,R=e.v,E.e(R);case 17:return e.p=17,E.f(),e.f(17);case 18:return P.length>0&&console.warn("Encountered ".concat(P.length," errors while storing branches:"),P),e.a(2,{success:!0,count:A,totalExtracted:T.length,errorCount:P.length});case 19:if(e.p=19,L=e.v,M="Error during AI extraction (Attempt ".concat(a,"): ").concat(L.message||L),L.xhr&&(M="API Error (Attempt ".concat(a,"): Status ").concat(L.status,", Response: ").concat((null===(O=L.xhr)||void 0===O?void 0:O.responseText)||"(No response body)")),console.error(M,L),!(a<=s)){e.n=21;break}return console.warn("Branch Extraction error. Retrying..."),e.n=20,new Promise((function(e){return setTimeout(e,1e3*Math.pow(2,a))}));case 20:return e.a(2,this.execute(t,a+1));case 21:return e.a(2,{success:!1,count:0,error:"Failed after ".concat(s+1," attempts: ").concat(M)});case 22:return e.a(2)}}),e,this,[[11,16,17,18],[4,19],[1,3]])})),s=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=a.apply(e,t);function r(e){d(i,n,o,r,s,"next",e)}function s(e){d(i,n,o,r,s,"throw",e)}r(void 0)}))},function(e){return s.apply(this,arguments)})}],t&&p(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a,s}()},"376226a4d62e8d4e335b":(e,t,a)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e,t,a){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}a.r(t),a.d(t,{default:()=>y,generateContextualNodeDocumentation:()=>h,getNodeClassMapping:()=>m,getNodeDocumentation:()=>c,getNodeNameMapping:()=>g,getNodesByApproach:()=>d,getNodesByCategory:()=>u,getNodesInCanvas:()=>p,getRequiredPropertiesMapping:()=>f,nodeDocumentation:()=>l});var l={1:{name:"Project Node",className:"draw2d.shape.fishbone.cell.Projectnode_api",category:"data_acquisition",approach:"both",source:"fishbone-core-js.js",requiredProperties:["proj_id","proj_name","proj_code"],documentation:"Purpose: Top-level entity; starting point for all reports.\nKey Properties: proj_id, proj_name, proj_code. Crucial: At least one of key properties has to be extracted from user prompt.\nData: Passes its properties downstream.",dataStructure:null,examples:[]},2:{name:"DU Model Node",className:"draw2d.shape.fishbone.cell.DUModelnode_api",category:"data_acquisition",approach:"both",source:"fishbone-core-js.js",requiredProperties:["du_model_name","du_model_id"],documentation:"Purpose: Represents a Delivery Unit model within a project, containing a list of Delivery Units (DUs).\nKey Properties: du_model_id, du_model_name.",dataStructure:{proj_id:"87ae0fae-ae5f-2449-901c-c2743c253088",product_domain:"Wireless RAN",du_model_name:"5G Survey",du_model_id:"2783788536911550150",site_code:"DERE",site_id:"a07327832d15d409237a913136d12377",region:"Central",du_code:"DU00004316500",du_name:"Wireless RAN/5G Survey/DERE",du_id:"8728553282148077252",du_status:"ENABLED",phase_code:"Batch 3 - 1500",cluster:"",site_model_name:"Wireless RAN",longitude:"101.69",latitude:"3.10479",state:"Kuala Lumpur"},examples:[]},3:{name:"Task Node",className:"draw2d.shape.fishbone.cell.Datanode",category:"data_acquisition",approach:"both",source:"fishbone-core-js.js",requiredProperties:["scope_task_name","scope_task_code","scope_task_id","task_type"],documentation:'Purpose: Retrieves data for a single specific task/activity related to DUs.\nKey Properties: scope_task_code, scope_task_name, scope_task_id.\nTask Type: "task_type" field determines task data type: "actual", "forecast". Default value is "actual". Only one data type can be fetch at the time.\nConnection: STRICTLY Connected to a DU Model Node or data derived from it.\nConstraint: Must represent only ONE task. Multiple tasks require multiple Task Nodes. (e.g., scope_task_name: "Task A, Task B" is invalid).\nDefault Filter: Retrieves \'Completed\' tasks unless specified otherwise (the user request implies \'Completed\').\nField my_date: this field is string representation of Date when task is completed. Please ALWAYS convert string value to required format.',dataStructure:{du_id:"162711712924778595",site_id:"18b0c8795194c780c21d84fba42ed86f",du_code:"DU00004420318",site_code:"SSGB",my_date:"2024-11-28 00:00:00",status:"Completed",obs_name:"null",responsible_user_en:"MUHAMMAD",responsible_user_cn:"MUHAMMAD",assign_flag:"N",problem_type:"null",remark:"null",task_type:"actual",scope_task_name:"Site Survey",scope_task_code:"AC0000141889",du_model_name:"5G Survey",du_model_id:"2783788536911550150",proj_id:"87ae0fae-ae5f-2449-901c-c2743c253088",region:"Eastern",phase_code:"New Proposed"},examples:[]},4:{name:"Custom Field Node",className:"draw2d.shape.fishbone.cell.CustomFieldnode",category:"data_acquisition",approach:"both",source:"fishbone-core-js.js",requiredProperties:["field_name","field_code"],documentation:"Purpose: Retrieves user-defined field data associated with DUs.\nKey Properties: field_code, field_name.\nConnection: STRICTLY Connected to a DU Model Node or data derived from it.",dataStructure:{proj_id:"87ae0fae-ae5f-2449-901c-c2743c253088",site_id:"f4e4ee65dce034237093342c69c6d4b3",site_code:"ANDE",du_id:"4747361259506909980",du_code:"DU00004226820",du_name:"Wireless RAN/5G Survey/ANDE",du_model_name:"5G Survey",field_code:"ZDCSZ00918525",field_name:"TSS Subcon",field_owner:"",value:"NR"},examples:[]},16:{name:"DataTable Node",className:"draw2d.shape.fishbone.ra.RaTablenode",category:"data_acquisition",approach:"both",source:"fishbone-core-js.js",requiredProperties:["file_name","table_name"],documentation:"Purpose: Loads and manages data from external files (CSV, JSON, Excel) attached by users. Acts as a persistent data storage.\nKey Properties: file_name (name of attached file to load), table_name (unique table identifier).\nConnection: Can connect directly to Project Node or other data sources. Provides output for Math Nodes and other processing nodes.\nData Loading: Automatically loads data from attached files during node configuration. Supports CSV and JSON formats.\nUse Cases: \n- Loading external datasets for analysis (sales data, survey results, reference data)\n- Importing baseline/target data for comparison with internal metrics\n- Processing uploaded files for integration with Fishbone data pipeline",dataStructure:{table_name:"sales_data",file_name:"Q1_sales.csv"},examples:[]},15:{name:"API Node",className:"draw2d.shape.fishbone.cell.APInode",category:"data_acquisition",approach:"both",source:"fishbone-core-js.js",requiredProperties:["apiid","params"],documentation:'Purpose: Makes API calls to fetch external data using predefined API endpoints.\nKey Properties:\n- apiid: (String) The identifier for the API to call.\n- params: (Array) Parameters to pass to the API, each with structure:\n  {\n    param_name: "name", // API parameter name\n    param_source: "source_node", // Source node label for dynamic data\n    prop_type: "value|list", // Whether parameter is a single value or list\n    param_details: "details", // Additional parameter details\n    prop_key: "key" // Property key to extract from source\n  }\nConnection: Can connect to any node that provides context data for API parameters.\nData Structure: The node outputs API response data in the structure provided by the API endpoint.',dataStructure:null,examples:[]},13:{name:"Math Node",className:"draw2d.shape.fishbone.cell.Mathnode",category:"data_manipulation",approach:"both",source:"fishbone-core-js.js",requiredProperties:["do"],documentation:"Purpose: PRIMARY data manipulation node for JavaScript approach. Performs ALL data operations including joins, unions, aggregations, filtering, and transformations using pure JavaScript + Lodash.\nKey Property: do (contains a JavaScript arrow function that processes input data)\nConnection Requirements:\n- Supports multiple input connections for complex data operations\n- Access all connected datasets via dataFactory.getData()\nRequirements:\n- The 'do' property must contain a JavaScript arrow function: ()=>{ ...code... }\n- Access input data using: let data = dataFactory.getData()\n- Return processed data as flat array of objects\n- Must follow standard JavaScript syntax\n- No code fencing (triple backticks or language identifiers)\n\nData Structure: dataFactory.getData() returns [{\"name\": \"dataset1\", \"values\": [...]}, {\"name\": \"dataset2\", \"values\": [...]}]\n\nALLOWED way to access datasets: \n    let data = dataFactory.getData();\n    let dataset_0 = data[0].values,  // First dataset\n    let dataset_1 = data[1].values,  // Second dataset\n    let dataset_2 = data[2].values   // Third dataset\n\nNOT ALLOWED way to access datasets:\n    let data = dataFactory.getData();\n    let taskData = _.find(data, { name: 'Task' }).values;\n    let cfData = _.find(data, { name: 'Custom Field' }).values;\n\n{{CHART_LIBRARY}} and Tabulator Data Processing Guidelines:\n\n1. {{CHART_LIBRARY}} Data Preparation Patterns:\n\n   PIE/DOUGHNUT CHARTS:\n   - Process data into labels and values arrays\n   - Use lodash groupBy and sumBy for aggregation\n   - Return {labels: [...], datasets: [{data: [...]}]} structure\n\n   BAR/LINE CHARTS:\n   - Group data by categories or time periods\n   - Use moment.js for date formatting and grouping\n   - Support multiple datasets for comparison charts\n   - Ensure chronological sorting for time series\n\n   SCATTER PLOTS:\n   - Transform to {x, y, label} object arrays\n   - Use parseFloat for numeric coordinates\n   - Support bubble charts with size property\n\n2. Tabulator Table Creation:\n   - Use raw data arrays directly\n   - Configure columns for custom formatting\n   - Support grouping, sorting, and pagination\n   - Add interactive features like row selection\n\n3. Math Node Data Processing Examples:\n   - All data manipulation uses lodash utility functions\n   - Moment.js handles date/time operations\n   - {{CHART_LIBRARY}} creates visual elements directly in DOM\n   - Tabulator renders interactive tables\n\n4. Key Principles:\n   - Single Math Node handles both data processing AND visualization\n   - Direct DOM rendering eliminates separate presentation nodes\n   - JavaScript-native approach using familiar libraries\n   - Simplified architecture with fewer node types required\n\n5. Dynamic Example Loading:\n   - Visualization examples are loaded dynamically based on requirements\n   - Only relevant chart/table examples included to optimize token usage\n   - Example types: bar_chart, line_chart, pie_chart, doughnut_chart, scatter_chart, \n     stacked_bar_chart, time_series, multi_series_line, bubble_chart, tree_chart,\n     hierarchy_chart, table, advanced_table, grouped_table, pivot_table, card,\n     custom_html, multi_chart_dashboard, other_chart, custom_chart\n   - Each example includes: implementation code, container HTML, dependencies, use cases\n\n6. {{CHART_LIBRARY}} Layout Configuration Guidelines:\n   - TITLE POSITIONING: Always set title.top property to provide adequate spacing from container edge\n   - LEGEND POSITIONING: Use legend.top property with sufficient spacing below title to avoid overlap\n   - GRID POSITIONING: Adjust grid.top percentage to accommodate title and legend space\n   - RESPONSIVE SPACING: Use percentage-based positioning for responsive design across container sizes\n   - SCROLL LEGENDS: Use legend.type='scroll' with orient='horizontal' and width='80%' for charts with many series to prevent legend overflow\n   - LAYOUT VALIDATION: Ensure minimum spacing requirements between title, legend, and chart area\n\n7. {{CHART_LIBRARY}} Layout Pattern Examples:\n\n   PROPER TITLE/LEGEND SPACING:\n   const option = {\n     title: {\n       text: 'Chart Title',\n       top: 10,              // Fixed 10px from container top\n       left: 'center',\n       textStyle: { fontSize: 16, fontWeight: 'bold' }\n     },\n     legend: {\n       type: 'scroll',       // Scroll for many series\n       top: 45,              // 35px below title (title.top + 35)\n       left: 'center',\n       orient: 'horizontal'\n     },\n     grid: {\n       top: '15%',           // 15% from top for title+legend space\n       bottom: '10%',\n       left: '10%',\n       right: '10%'\n     }\n     // ... rest of chart configuration\n   };\n\n   MULTI-SERIES CHART LAYOUT:\n   const option = {\n     title: {\n       text: 'Multi-Series Analysis',\n       top: 15,\n       left: 'center'\n     },\n     legend: {\n       type: 'scroll',       // CRITICAL for multiple series\n       top: 50,              // Adequate spacing for title\n       left: 'center',\n       orient: 'horizontal',\n       pageIconSize: 12,\n       pageTextStyle: { fontSize: 10 }\n     },\n     grid: {\n       top: '18%',           // Extra space for scrollable legend\n       bottom: '15%',\n       left: '8%',\n       right: '8%'\n     }\n   };\n\n   TIME SERIES LAYOUT:\n   const option = {\n     title: {\n       text: 'Time Series Data',\n       top: 10,\n       left: 'center'\n     },\n     legend: {\n       top: 40,\n       left: 'center',\n       orient: 'horizontal'\n     },\n     grid: {\n       top: '12%',           // Smaller space for simple legends\n       bottom: '20%',        // Extra space for time axis labels\n       left: '10%',\n       right: '10%'\n     }\n   };",dataStructure:null,examples:[{name:"Data Union",code:"()=> {\n  let data = dataFactory.getData();\n  return data.flatMap(dataset => dataset.values); // Simple union\n}"},{name:"Data Join",code:"()=> {\n  let data = dataFactory.getData();\n  let sales = data[0].values;    // First dataset\n  let targets = data[1].values;  // Second dataset\n  const targetMap = _.keyBy(targets, 'join_column_name');\n  return sales.map(s => ({...s, target: targetMap[s.join_column_name]?.amount || 0}));\n}"},{name:"Aggregation",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  return _.chain(data)\n    .groupBy('region')\n    .mapValues(g => ({count: g.length, total: _.sumBy(g, 'sales'), avg: _.meanBy(g, 'sales')}))\n    .map((stats, region) => ({region, ...stats}))\n    .value();\n}"},{name:"Filtering",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  return _.filter(data, item => item.status === 'Active' && item.sales > 1000);\n}"},{name:"Sorting",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  return _.orderBy(data, ['sales', 'date'], ['desc', 'asc']);\n}"},{name:"Complex Multi-Dataset Operations",code:"()=> {\n  let data = dataFactory.getData();\n  \n  // Check if all required datasets exist\n  if (!data[0] || !data[1] || !data[2]) {\n    console.error('Insufficient datasets available. Need at least 3 datasets.');\n    return [];\n  }\n  \n  let [sales, targets, customers] = [\n    data[0].values,  // First dataset\n    data[1].values,  // Second dataset\n    data[2].values   // Third dataset\n  ];\n  \n  const targetMap = _.keyBy(targets, 'region');\n  const customerMap = _.keyBy(customers, 'id');\n  \n  return sales.map(sale => ({\n    ...sale,\n    customer_name: customerMap[sale.customer_id]?.name || 'Unknown',\n    target: targetMap[sale.region]?.amount || 0,\n    achievement: ((sale.amount / (targetMap[sale.region]?.amount || 1)) * 100).toFixed(1)\n  }));\n}"},{name:"Time Series Processing - Monthly",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  return _.chain(data)\n    .groupBy(item => moment(item.date).format('YYYY-MM'))\n    .mapValues(g => ({\n      month: _.first(g).date.substring(0,7),\n      count: g.length, \n      sales: _.sumBy(g, 'amount'),\n      unique_customers: _.uniqBy(g, 'customer_id').length\n    }))\n    .values()\n    .sortBy('month')\n    .value();\n}"},{name:"Time Series Processing - Weekly",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  return _.chain(data)\n    .groupBy(item => moment(item.date).format('YYYY-[W]WW'))\n    .mapValues(g => ({\n      week: moment(_.first(g).date).format('YYYY-[W]WW'),\n      count: g.length, \n      sales: _.sumBy(g, 'amount'),\n      unique_customers: _.uniqBy(g, 'customer_id').length\n    }))\n    .values()\n    .sortBy('week')\n    .value();\n}"},{name:"Time Series Processing - Quarterly",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  return _.chain(data)\n    .groupBy(item => moment(item.date).format('YYYY-[Q]Q'))\n    .mapValues(g => ({\n      quarter: moment(_.first(g).date).format('YYYY-[Q]Q'),\n      count: g.length, \n      sales: _.sumBy(g, 'amount'),\n      unique_customers: _.uniqBy(g, 'customer_id').length\n    }))\n    .values()\n    .sortBy('quarter')\n    .value();\n}"},{name:"Visualization - {{CHART_LIBRARY}} Chart Pattern",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  \n  // Data processing with Lodash\n  const processedData = _.chain(data)\n    .groupBy('category')\n    .mapValues(g => _.sumBy(g, 'value'))\n    .toPairs()\n    .value();\n  \n  // Chart instance cleanup\n  const containerId = 'chart_container_id';\n  if (window.chartInstances && window.chartInstances[containerId]) {\n    window.chartInstances[containerId].destroy();\n  }\n  \n  // {{CHART_LIBRARY}} creation with proper layout configuration\n  const option = {\n    title: {\n      text: 'Chart Title',\n      top: 10,                    // CRITICAL: Fixed spacing from top\n      left: 'center',\n      textStyle: { fontSize: 16 }\n    },\n    legend: {\n      type: 'scroll',             // CRITICAL: Scroll for multiple series\n      top: 45,                    // CRITICAL: Spacing below title\n      left: 'center',\n      orient: 'horizontal'\n    },\n    grid: {\n      top: '15%',                 // CRITICAL: Space for title + legend\n      bottom: '10%',\n      left: '10%',\n      right: '10%'\n    },\n    xAxis: {\n      type: 'category',\n      data: processedData.map(d => d[0])\n    },\n    yAxis: {\n      type: 'value'\n    },\n    series: [{\n      data: processedData.map(d => d[1]),\n      type: 'bar'\n    }]\n  };\n  \n  const chart = echarts.init(document.getElementById(containerId));\n  chart.setOption(option);\n  \n  // Instance storage for cleanup\n  if (!window.chartInstances) window.chartInstances = {};\n  window.chartInstances[containerId] = chart;\n  \n  return processedData;\n}"},{name:"Visualization - Tabulator Table",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  \n  // Process data if needed\n  const tableData = data.map(item => ({\n    ...item,\n    formatted_date: moment(item.date).format('YYYY-MM-DD'),\n    percentage: ((item.value / item.total) * 100).toFixed(2) + '%'\n  }));\n  \n  // Create Tabulator instance\n  const tableContainer = document.getElementById('table_container_id');\n  \n  // Destroy existing table if present\n  if (window.tableInstances && window.tableInstances['table_container_id']) {\n    window.tableInstances['table_container_id'].destroy();\n  }\n  \n  // Create new table\n  const table = new Tabulator(tableContainer, {\n    data: tableData,\n    height: 400,\n    layout: 'fitColumns',\n    responsiveLayout: 'hide',\n    pagination: true,\n    paginationSize: 20,\n    columns: [\n      {title: 'Date', field: 'formatted_date', sorter: 'date'},\n      {title: 'Category', field: 'category', headerFilter: 'input'},\n      {title: 'Value', field: 'value', sorter: 'number', formatter: 'money'},\n      {title: 'Percentage', field: 'percentage', sorter: 'number'}\n    ]\n  });\n  \n  // Store instance for cleanup\n  if (!window.tableInstances) window.tableInstances = {};\n  window.tableInstances['table_container_id'] = table;\n  \n  return tableData;\n}"},{name:"Visualization - Multi-Chart Dashboard",code:"()=> {\n  let data = dataFactory.getData()[0].values;\n  \n  // Aggregate data for multiple visualizations\n  const regionData = _.chain(data)\n    .groupBy('region')\n    .mapValues(g => ({\n      count: g.length,\n      total: _.sumBy(g, 'amount'),\n      avg: _.meanBy(g, 'amount')\n    }))\n    .toPairs()\n    .value();\n  \n  // Create Pie Chart\n  const pieContainerId = 'pie_chart_container';\n  if (window.chartInstances && window.chartInstances[pieContainerId]) {\n    window.chartInstances[pieContainerId].destroy();\n  }\n  \n  const pieOption = {\n    title: {\n      text: 'Distribution by Region',\n      top: 10,\n      left: 'center'\n    },\n    tooltip: {\n      trigger: 'item',\n      formatter: '{a} <br/>{b}: {c} ({d}%)'\n    },\n    legend: {\n      type: 'scroll',\n      top: 45,\n      left: 'center'\n    },\n    series: [{\n      name: 'Region',\n      type: 'pie',\n      radius: '50%',\n      center: ['50%', '60%'],\n      data: regionData.map(([name, stats]) => ({\n        name: name,\n        value: stats.total\n      }))\n    }]\n  };\n  \n  const pieChart = echarts.init(document.getElementById(pieContainerId));\n  pieChart.setOption(pieOption);\n  \n  // Create Bar Chart\n  const barContainerId = 'bar_chart_container';\n  if (window.chartInstances && window.chartInstances[barContainerId]) {\n    window.chartInstances[barContainerId].destroy();\n  }\n  \n  const barOption = {\n    title: {\n      text: 'Regional Performance',\n      top: 10,\n      left: 'center'\n    },\n    legend: {\n      top: 45,\n      left: 'center'\n    },\n    grid: {\n      top: '15%',\n      bottom: '10%',\n      left: '10%',\n      right: '10%'\n    },\n    xAxis: {\n      type: 'category',\n      data: regionData.map(d => d[0])\n    },\n    yAxis: {\n      type: 'value'\n    },\n    series: [\n      {\n        name: 'Count',\n        type: 'bar',\n        data: regionData.map(d => d[1].count)\n      },\n      {\n        name: 'Average',\n        type: 'line',\n        data: regionData.map(d => d[1].avg)\n      }\n    ]\n  };\n  \n  const barChart = echarts.init(document.getElementById(barContainerId));\n  barChart.setOption(barOption);\n  \n  // Store instances\n  if (!window.chartInstances) window.chartInstances = {};\n  window.chartInstances[pieContainerId] = pieChart;\n  window.chartInstances[barContainerId] = barChart;\n  \n  return regionData;\n}"}]},14:{name:"Filter Node",className:"draw2d.shape.fishbone.cell.Filternode",category:"data_manipulation",approach:"both",source:"fishbone-core-js.js",requiredProperties:["filter","cont_id"],documentation:'Purpose: Provides interactive filtering capabilities for the report, allowing end-users to filter data based on specific criteria. Use Mathnode for static filtering.\nKey Properties:\n- filter: (Object) Filter configuration defining initial state and options.\n  {\n    value: "initial value",\n    field: "field_name", //data field name from connected input data\n    params: [],\n    searchInResult: false,\n    filter_list: []\n  }\n- cont_id: (String) Container ID for the filter UI element.\n- win_size: (String) Size of the filter dialog window ("sm", "md", "lg").\n- message: (String) Message to display in the filter dialog.\n- showBusket: (Boolean) Whether to display the selection basket.\nHTML Container Requirements: here is the code you have to use when inserting filter into html  \n<div id="filter_node_cont_id_value" class="input-group input-group-sm mb-1">\n  <label class="input-group-text" for="filter_node_cont_id_value">Filter name</label>\n  <input name="filter_node_cont_id_value" disabled type="text" class="form-control">\n  <button class="btn btn-outline-secondary" type="button" id="button-addon2">Set</button>\n</div>\nConnection: connected to SINGLE data source nodes that provide filter options.\nBehavior: Creates an interactive UI element that triggers filtering on connected data when the user makes selections.',dataStructure:null,examples:[]},5:{name:"SQL Node",className:"draw2d.shape.fishbone.cell.SQLnode",category:"data_manipulation",approach:"traditional",source:"fishbone-core.js",requiredProperties:["sql"],documentation:'Purpose: Performs SQL data manipulations with input data using AlaSQL.js library.\nKey Property: sql (contains the SQL query string).\nSQL Syntax Rules:\nSTRICTLY follow Alasql.js documentation and requirements below. \n- ? Placeholder: Represents data input from connected nodes in sequential order. Must be used in FROM or JOIN clauses (e.g., FROM ? AS a JOIN ? AS b ...) that\'s why it is VERY IMPORTANT to connect input data in corresponding order. \n- Bracket Notation []: MANDATORY for field names that are SQL keywords (e.g., [value]) or contain spaces (e.g., [Subcon TI]).\n- Tables Aliases: Use short (1-3 chars), non-keyword aliases for tables (e.g., FROM ? AS a). \n- Fields Aliases: \n  - ALWAYS use [] for fields aliases\n  - NEVER use SQL keywords, special words, or function names like "count", "sum", "date", "id", "name", "value", "group", "order", "key", "type", "from", "select", "as", "where", "by", "having", "min", "max", "avg" as field aliases\n  - Always prefix these with a descriptive word, such as "task_count", "region_sum", "survey_date", "customer_id", etc\n  - This rule applies in all contexts including column aliases after SELECT, CASE statements, and computed fields\n  - Examples of prohibited aliases: "count", "date", "id"\n  - Examples of valid aliases: "task_count", "survey_date", "customer_id"\n- Explicit Columns: Always specify column names after SELECT (avoid SELECT * unless trivial).\n- Joins: Clearly define JOIN conditions using appropriate fields.\n- please use "::parameter" placeholders for dynamic parameters injection.\n- Use moment.js function to manipulate with dates, f.e. Moment(my_date) will parse string variable and create new Moment.js date object. ',dataStructure:null,examples:[{name:"Basic SELECT with WHERE filter",code:"select * from ?\n                       where field_code = 'ZDCSZ00994761'"},{name:"Date formatting with moment",code:"select\n                           du_id,\n                           site_code,\n                           region,\n                           scope_task_id,\n                           scope_task_code,\n                           scope_task_name,\n                           'E-TSS Approved' as alias,\n                           moment(actual_end_date).format('YYYY-MM-DD') as my_date\n                       from ? a\n                       where a.status = 'Completed'"},{name:"LEFT JOIN with multiple tables",code:"select\n                           a.du_id,\n                           a.site_code,\n                           a.region,\n                           a.last_update_date as my_date\n                       from ? a\n                                left join ? b\n                                          on a.du_id = b.du_id\n                       where a.du_id is not null\n                       group by\n                           a.du_id,\n                           a.site_code,\n                           a.region,\n                           a.last_update_date"},{name:"CASE statement with aliases",code:"select\n                           a.du_id,\n                           c.site_code,\n                           c.region,\n                           case\n                               when b.scope_task_code = 'AC0000151690' then 'TP to UM'\n                               when b.scope_task_code = 'AC0000138748' then 'TP to UM'\n                               else b.task_short_name\n                               end as alias,\n                           case\n                               when b.scope_task_code = 'AC0000151690' then 'API'\n                               when b.scope_task_code in ('AC0000138748') then 'Manual'\n                               else null\n                               end as is_api\n                       from ? a\n                                left join ? b\n                                          on a.du_model_wp_ac_id = b.scope_task_id\n                                inner join ? c\n                                           on a.du_id = c.du_id"},{name:"Complex WHERE with IN clause",code:"select * from ?\n                       where field_code = 'ZDCSZ00953994'\n                         and [value] in (\n                           'Site Owner - Pending Review TP',\n                           'UM - Pending Review Full TP',\n                           'UM - TP Rejected'\n                           )"},{name:"CTE (Common Table Expression)",code:"with\n                           a as (select * from ?\n                                 where is_api = 'Manual'),\n                           all_ as (select * from a\n                                    where alias = 'Pending Reviewed'),\n                           approve as (select * from a\n                                       where alias = 'TP Approved'),\n                           reject as (select * from a\n                                      where alias = 'TP Rejected')\n\n                       select\n                           'Pending Reviewed' as alias,\n                           du_id,\n                           my_date\n                       from all_ a\n                                left join approve b\n                                          on a.du_id = b.du_id\n                                left join reject c\n                                          on a.du_id = c.du_id\n                       where b.du_id is null\n                         and c.du_id is null\n\n                       union all CORRESPONDING\n\n                       select * from approve\n\n                       union all CORRESPONDING\n\n                       select * from reject"},{name:"Aggregation with GROUP BY",code:"select\n                           alias,\n                           is_api,\n                           region,\n                           count(*) as [task_count]\n                       from ?\n                       group by\n                           alias,\n                           is_api,\n                           region"},{name:"Window variables with parseTxt",code:"with a as (select\n                                      count(*) as [region_total]\n                       from ?\n                       where alias = 'Pending Reviewed')\n\n                SELECT\n                    parseTxt({name: \"manual_pending_total\", val: [region_total]}) AS [region_total]\n                from a"},{name:"GROUP_CONCAT for string aggregation",code:"select '['+ GROUP_CONCAT(flow_task+','+flow_create)+']' as flow from ? a"},{name:"UNION ALL with different sources",code:"select\n                           du_id,\n                           site_code,\n                           region,\n                           'Total Sites' as alias,\n                           'total' as scope_task_code\n                       from ?\n\n                       union all CORRESPONDING\n\n                       select\n                           alias,\n                           region,\n                           count(*) as [site_count]\n                       from ?\n                       where scope_task_code is null\n                       group by\n                           alias,\n                           region"},{name:"Complex aging calculation",code:"select\n                           alias,\n                           du_id,\n                           site_code,\n                           region,\n                           my_date,\n                           moment().diff(moment(my_date), 'days') as aging,\n                           case\n                               when moment().diff(moment(my_date), 'days') <= 3 then '<= 3 days'\n                               when moment().diff(moment(my_date), 'days') >= 4 and moment().diff(moment(my_date), 'days') <= 7 then '4 - 7 days'\n                               when moment().diff(moment(my_date), 'days') >= 8 and moment().diff(moment(my_date), 'days') <= 14 then '8 - 14 days'\n                               when moment().diff(moment(my_date), 'days') > 14 then '> 14 days'\n                               else null\n                               end as aging_category\n                       from ?"},{name:"Parameterized WHERE with placeholders",code:"select\n                           du_id,\n                           site_code,\n                           region,\n                           scope_task_id,\n                           scope_task_code,\n                           scope_task_name,\n                           alias,\n                           is_api,\n                           approve_create_date,\n                           my_date,\n                           cluster_id,\n                           structure_owner\n                       from (\n                                select\n                                    a.du_id,\n                                    a.site_code,\n                                    a.region,\n                                    a.scope_task_id,\n                                    a.scope_task_code,\n                                    a.scope_task_name,\n                                    a.alias,\n                                    a.is_api,\n                                    a.approve_create_date,\n                                    a.my_date,\n                                    b.[value] as cluster_id,\n                                    c.[value] as structure_owner\n                                from ? a\n                                         left join ? b\n                                                   on a.du_id = b.du_id\n                                         left join ? c\n                                                   on a.du_id = c.du_id)\n                       where region in (::region)\n                         and cluster_id in (::cluster_id)"}]},6:{name:"Union Node",className:"draw2d.shape.fishbone.cell.Unionnode",category:"data_manipulation",approach:"traditional",source:"fishbone-core.js",requiredProperties:[],documentation:'Purpose: Combine connected datasets in one by using SQL "UNION ALL" statement. Use it when you need to combine same structure datasets into one.\nKey Property: does not require any configuration.',dataStructure:null,examples:[]},7:{name:"Transform Node",className:"draw2d.shape.fishbone.cell.Transformnode",category:"data_manipulation",approach:"traditional",source:"fishbone-core.js",requiredProperties:["transform"],documentation:'Purpose: Primary data manipulation solution for all operations beyond basic selection and joining. Handles grouping, accumulation, sorting, filtering, impute, and other data transformations according to Vega.js transforms documentation.\nKey Property: \n   - transform: vega spec transform array.\nRequirements: Include only transform array without any other component of Vega configuration JSON\nConnection Constraint: CRITICAL Transform node can have only one input connection. Multiple input connections are not allowed.\nData Source Scope: All transforms operate *exclusively* on the single data stream provided by the input connection (implicitly named "table"). Expressions referencing other data sources (e.g., \'data(\'another_source\')\') or the own input source (e.g., \'data(\'table\')\') are **strictly forbidden**. Use \'datum\' to access fields within the current data record.\nSignal Prohibition: The use or reference of Vega signals within the \'transform\' array is **strictly forbidden**. Transforms must operate solely on the input data stream.\nPreferred Data Manipulation Solution:\n- Use Transform node as the primary tool for all data manipulation operations\n- Combine multiple transformations in the same node when logically related\n- Operations that should be performed in Transform node (not SQL node):\n  * Grouping and aggregation (using "aggregate" transform)\n  * Sorting (using "collect" transform with "sort" property)\n  * Filtering (using "filter" transform) \n  * Imputation of missing values (using "impute" transform)\n  * Pivoting data (using "pivot" transform)\n  * Window calculations and running totals (using "window" transform)\n  * Binning numeric values (using "bin" transform)\n  * Formula calculations (using "formula" transform)\n  * Data sampling (using "sample" transform)\n- For complex data flows, chain multiple Transform nodes together\nNOT Allowed transform types: lookup',dataStructure:null,examples:[{name:"Aggregate Transform - Basic",code:'{\n  "type": "aggregate",\n  "groupby": ["region"],\n  "fields": ["du_id", "value"],\n  "ops": ["count", "sum"],\n  "as": ["region_count", "region_total"]\n}'},{name:"Aggregate Transform - Min/Max",code:'{\n  "type": "aggregate",\n  "fields": ["value", "value"],\n  "ops": ["min", "max"],\n  "as": ["min_value", "max_value"]\n}'},{name:"Collect Transform - Sorting",code:'{\n  "type": "collect",\n  "sort": {"field": "region_count", "order": "descending"}\n}'},{name:"Filter Transform",code:'{\n  "type": "filter",\n  "expr": "datum.subcon_name == \'DATASCO\'"\n}'},{name:"Formula Transform",code:'{\n  "type": "formula",\n  "expr": "datum.value / datum.total * 100",\n  "as": "percentage"\n}'},{name:"TimeFormat Transform",code:'{\n  "type": "formula",\n  "expr": "timeFormat(datum.my_date, \'%Y-W%U\')",\n  "as": "week"\n}'},{name:"Pivot Transform",code:'{\n  "type": "pivot",\n  "groupby": ["country"],\n  "field": "type",\n  "value": "count"\n}'},{name:"Window Transform - Running Total",code:'{\n  "type": "window",\n  "groupby": ["category"],\n  "sort": {"field": "week"},\n  "fields": ["total_cnt"],\n  "ops": ["sum"],\n  "as": ["cumulative"]\n}'},{name:"Impute Transform",code:'{\n  "type": "impute",\n  "field": "value",\n  "key": "date",\n  "method": "value",\n  "value": 0\n}'},{name:"Bin Transform",code:'{\n  "type": "bin",\n  "field": "value",\n  "extent": [0, 100],\n  "step": 10,\n  "as": ["bin0", "bin1"]\n}'},{name:"Multiple Transforms Combined",code:'[\n  {\n    "type": "aggregate",\n    "groupby": ["region"],\n    "fields": ["du_id"],\n    "ops": ["count"],\n    "as": ["region_count"]\n  },\n  {\n    "type": "collect",\n    "sort": {"field": "region_count", "order": "descending"}\n  }\n]'}]},8:{name:"Echarts Node",className:"draw2d.shape.fishbone.ra.RaEchartAdapter",category:"presentation",approach:"traditional",source:"fishbone-core.js",requiredProperties:["cont_id","dataset","config"],documentation:'Purpose: Powerful standalone charting node that renders interactive data visualizations using Apache ECharts library. No JavaScript coding required - configuration-based approach.\n\nKey Properties: \n- cont_id: (String) Target HTML element ID where the chart will render.\n- dataset: (String) JSON string defining data structure and dimensions for ECharts.\n- config: (String) ECharts options object defining chart type, styling, and behavior.\n\n"dataset" Value Generation Requirements: \n- Analyze the expected data structure from the input node to identify key dimensions.\n- Consider data patterns, relationships, and hierarchies when defining dimensions.\n- The value MUST be a valid JSON string with this EXACT structure:\n  \'{"dimensions": ["field1", "field2", "field3", ...], "source":[]}\'.\n- The "dimensions" array lists field names that will map to your input data columns.\n- The "source" array MUST always be empty ([]) - data is injected at runtime.\n- Common dimension patterns:\n  * Time series: ["date", "value", "category"]\n  * Geographic: ["region", "metric", "count"]\n  * Comparative: ["product", "sales", "profit", "quarter"]\n  * Hierarchical: ["department", "team", "performance"]\n\n"config" Value Generation Requirements: \n- Create comprehensive ECharts configuration for professional visualizations.\n- Use dataset-based approach exclusively (no hardcoded data).\n- Leverage the power of ECharts\' extensive feature set:\n\nCHART TYPE SELECTION GUIDELINES:\n1. PIE/DOUGHNUT: For composition analysis (parts of whole)\n   - Use for: Budget allocation, market share, survey responses\n   - Features: Rose type for emphasis, radius for nested rings\n   \n2. BAR CHARTS: For categorical comparisons\n   - Use for: Performance metrics, rankings, distributions\n   - Features: Stack for totals, group for side-by-side comparison\n   \n3. LINE/AREA: For trends over time\n   - Use for: Time series, progress tracking, forecasts\n   - Features: Smooth curves, area fill for cumulative data\n   \n4. SCATTER/BUBBLE: For correlation analysis\n   - Use for: Risk assessment, performance matrices, clustering\n   - Features: Size encoding for third dimension\n   \n5. HEATMAP: For matrix data visualization\n   - Use for: Activity patterns, correlation matrices, schedules\n   \n6. RADAR: For multi-dimensional comparison\n   - Use for: Skill assessment, product features, KPI analysis\n   \n7. SANKEY: For flow visualization\n   - Use for: Process flows, budget allocation, user journeys\n   \n8. GAUGE: For single metric display\n   - Use for: KPI status, progress indicators, thresholds\n\nESSENTIAL CONFIGURATION COMPONENTS:\n- title: Chart title with positioning and styling\n- tooltip: Interactive data display on hover\n- legend: Data series identification and filtering\n- toolbox: Export, zoom, data view capabilities\n- grid: Chart area spacing and positioning\n- color: Custom color palettes for branding\n\nADVANCED FEATURES TO CONSIDER:\n- dataZoom: Enable data exploration for large datasets\n- visualMap: Color/size mapping for data ranges\n- markLine/markPoint: Highlight thresholds and targets\n- animation: Smooth transitions and initial animations\n- responsive: Adapt to container size changes\n\nDATA ENCODING WITH DATASET:\n- Use encode property to map dimensions to visual channels:\n  encode: {\n    x: \'dimension1\',      // X-axis mapping\n    y: \'dimension2\',      // Y-axis mapping  \n    value: \'dimension3\',  // Value for pie/gauge\n    itemName: \'dimension1\', // Legend labels\n    tooltip: [\'dimension1\', \'dimension2\'] // Tooltip content\n  }\n\n- CRITICAL: NEVER include "data" property in any configuration object\n- ALL data binding MUST use dataset and encode properties\n- The system automatically populates the dataset.source at runtime',dataStructure:null,examples:[{name:"Time Series Line Chart with Trends",description:"Professional line chart for tracking metrics over time",dataset:'{"dimensions": ["date", "actual", "target", "forecast"], "source":[]}',config:"{\n  title: {\n    text: 'Performance Metrics Over Time',\n    left: 'center',\n    textStyle: { fontSize: 16, fontWeight: 'bold' }\n  },\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: { type: 'cross' }\n  },\n  legend: {\n    data: ['Actual', 'Target', 'Forecast'],\n    bottom: 0\n  },\n  toolbox: {\n    feature: {\n      dataZoom: { yAxisIndex: 'none' },\n      restore: {},\n      saveAsImage: {}\n    }\n  },\n  grid: {\n    left: '3%',\n    right: '4%',\n    bottom: '15%',\n    containLabel: true\n  },\n  xAxis: {\n    type: 'category',\n    boundaryGap: false\n  },\n  yAxis: {\n    type: 'value',\n    axisLabel: { formatter: '{value}' }\n  },\n  series: [\n    {\n      name: 'Actual',\n      type: 'line',\n      smooth: true,\n      encode: { x: 'date', y: 'actual' },\n      itemStyle: { color: '#5470c6' }\n    },\n    {\n      name: 'Target',\n      type: 'line',\n      smooth: true,\n      encode: { x: 'date', y: 'target' },\n      lineStyle: { type: 'dashed' },\n      itemStyle: { color: '#91cc75' }\n    },\n    {\n      name: 'Forecast',\n      type: 'line',\n      smooth: true,\n      encode: { x: 'date', y: 'forecast' },\n      lineStyle: { type: 'dotted' },\n      itemStyle: { color: '#fac858' }\n    }\n  ]\n}"},{name:"Stacked Bar Chart for Category Analysis",description:"Compare multiple metrics across categories with stacking",dataset:'{"dimensions": ["region", "completed", "pending", "cancelled"], "source":[]}',config:"{\n  title: {\n    text: 'Regional Task Status Distribution',\n    left: 'center'\n  },\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: { type: 'shadow' },\n    formatter: function(params) {\n      let result = params[0].name + '<br/>';\n      let total = 0;\n      params.forEach(item => {\n        total += item.value[item.encode.y[0]];\n        result += item.marker + ' ' + item.seriesName + ': ' + item.value[item.encode.y[0]] + '<br/>';\n      });\n      result += 'Total: ' + total;\n      return result;\n    }\n  },\n  legend: {\n    data: ['Completed', 'Pending', 'Cancelled'],\n    bottom: 0\n  },\n  toolbox: {\n    feature: {\n      magicType: { type: ['stack', 'tiled'] },\n      saveAsImage: {}\n    }\n  },\n  grid: {\n    left: '3%',\n    right: '4%',\n    bottom: '10%',\n    containLabel: true\n  },\n  xAxis: {\n    type: 'category',\n    axisLabel: { rotate: 45, interval: 0 }\n  },\n  yAxis: {\n    type: 'value',\n    name: 'Task Count'\n  },\n  series: [\n    {\n      name: 'Completed',\n      type: 'bar',\n      stack: 'total',\n      encode: { x: 'region', y: 'completed' },\n      itemStyle: { color: '#91cc75' }\n    },\n    {\n      name: 'Pending',\n      type: 'bar',\n      stack: 'total',\n      encode: { x: 'region', y: 'pending' },\n      itemStyle: { color: '#fac858' }\n    },\n    {\n      name: 'Cancelled',\n      type: 'bar',\n      stack: 'total',\n      encode: { x: 'region', y: 'cancelled' },\n      itemStyle: { color: '#ee6666' }\n    }\n  ]\n}"},{name:"Advanced Pie Chart with Data Insights",description:"Interactive pie chart with drill-down capabilities",dataset:'{"dimensions": ["category", "value", "percentage"], "source":[]}',config:"{\n  title: {\n    text: 'Distribution Analysis',\n    left: 'center',\n    top: 20,\n    textStyle: { fontSize: 18 }\n  },\n  tooltip: {\n    trigger: 'item',\n    formatter: '{a} <br/>{b}: {c} ({d}%)'\n  },\n  legend: {\n    orient: 'vertical',\n    left: 'left',\n    top: 'middle'\n  },\n  toolbox: {\n    show: true,\n    feature: {\n      saveAsImage: { show: true }\n    }\n  },\n  series: [\n    {\n      name: 'Distribution',\n      type: 'pie',\n      radius: ['40%', '70%'],\n      avoidLabelOverlap: false,\n      itemStyle: {\n        borderRadius: 10,\n        borderColor: '#fff',\n        borderWidth: 2\n      },\n      label: {\n        show: false,\n        position: 'center'\n      },\n      emphasis: {\n        label: {\n          show: true,\n          fontSize: 20,\n          fontWeight: 'bold'\n        },\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)'\n        }\n      },\n      labelLine: { show: false },\n      encode: {\n        itemName: 'category',\n        value: 'value',\n        tooltip: ['category', 'value', 'percentage']\n      }\n    }\n  ],\n  color: ['#5470c6', '#91cc75', '#fac858', '#ee6666', '#73c0de', '#3ba272', '#fc8452', '#9a60b4', '#ea7ccc']\n}"},{name:"Mixed Chart Type Dashboard",description:"Combine bar and line charts for comprehensive insights",dataset:'{"dimensions": ["month", "revenue", "profit", "growth_rate"], "source":[]}',config:"{\n  title: {\n    text: 'Business Performance Dashboard',\n    left: 'center'\n  },\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: {\n      type: 'cross',\n      crossStyle: { color: '#999' }\n    }\n  },\n  toolbox: {\n    feature: {\n      dataView: { show: true, readOnly: false },\n      magicType: { show: true, type: ['line', 'bar'] },\n      restore: { show: true },\n      saveAsImage: { show: true }\n    }\n  },\n  legend: {\n    data: ['Revenue', 'Profit', 'Growth Rate'],\n    bottom: 0\n  },\n  grid: {\n    left: '3%',\n    right: '4%',\n    bottom: '10%',\n    containLabel: true\n  },\n  xAxis: [\n    {\n      type: 'category',\n      axisPointer: { type: 'shadow' }\n    }\n  ],\n  yAxis: [\n    {\n      type: 'value',\n      name: 'Amount ($)',\n      axisLabel: { formatter: '${value}' }\n    },\n    {\n      type: 'value',\n      name: 'Growth Rate',\n      axisLabel: { formatter: '{value}%' }\n    }\n  ],\n  series: [\n    {\n      name: 'Revenue',\n      type: 'bar',\n      encode: { x: 'month', y: 'revenue' },\n      itemStyle: { color: '#5470c6' }\n    },\n    {\n      name: 'Profit',\n      type: 'bar',\n      encode: { x: 'month', y: 'profit' },\n      itemStyle: { color: '#91cc75' }\n    },\n    {\n      name: 'Growth Rate',\n      type: 'line',\n      yAxisIndex: 1,\n      encode: { x: 'month', y: 'growth_rate' },\n      itemStyle: { color: '#ee6666' }\n    }\n  ]\n}"}]},9:{name:"Vega Chart Node",className:"draw2d.shape.fishbone.ra.RaVegaChart",category:"presentation",approach:"traditional",source:"fishbone-core.js",requiredProperties:["cont_id","spec","vega","leaflet","vis_target"],documentation:"Purpose: Render Vega or Vega-Lite visualizations.\nDefault spec: use Vega-lite specification as preferred\n'data' object in 'update_node_data' MUST contain: { cont_id: \"...\", vis_target: \"html\", vega: false|true (according to specifications used Vega-Lite|Vega ),  spec: { /* FULL Vega/Vega-Lite JSON spec object */ } }\nRules for 'spec' generation:\n- The value MUST be a complete and valid Vega or Vega-Lite JSON specification object. Assume Vega-Lite unless the analysis strongly suggests Vega is necessary.\n- **CRITICAL DATA STRUCTURE:** Define data sources within the spec using the exact format: '{\"name\": \"unique_data_source_name\", \"values\": []}'.\n  - The '\"name\"' property should be a unique identifier for the data source, ideally derived from the connected input node or data context.\n  - The '\"values\"' property MUST be an empty array ('[]'). Actual data will be injected later by the system based on the '\"name\". Do NOT include actual data values here.\n- **Strict JSON Formatting (RFC 8259):** The generated JSON object MUST strictly adhere to the following:\n  - All property names (keys) MUST be enclosed in double quotes ('\"').\n  - All string values MUST be enclosed in double quotes ('\"').\n  - Use 'true' and 'false' (lowercase) for booleans.\n  - Use 'null' (lowercase) for null values.\n  - Numbers MUST NOT be enclosed in quotes.\n  - No trailing commas are allowed in objects or arrays.\n  - No comments ('//' or '/* */') are permitted within the JSON structure.\n- **Output Format:** Provide *only* the JSON object for the 'spec' property. Do NOT wrap it in backticks, code fences (like '''json ... '''), or include any explanatory text or comments outside the valid JSON structure itself.\n- **Chart Design:** Based on the input data schema and the visualization goal, design an appropriate Vega/Vega-Lite specification (marks, encodings, scales, axes, legends, interactions, etc.) to create a vibrant, coherent, and informative visualization. Make informed decisions about chart types (bar, line, scatter, map, etc.) suitable for the data.\n- **Field References:** Ensure all '\"field\"' properties correctly reference names that will exist in the data injected later (based on the input data schema).",dataStructure:null,examples:[]},10:{name:"Table Node",className:"draw2d.shape.fishbone.ra.RaTableAdapter",category:"presentation",approach:"traditional",source:"fishbone-core.js",requiredProperties:["cont_id"],documentation:'Purpose: Renders data as a table using Tabulator.js.\nKey Properties: \n- cont_id: (String) Target HTML element ID.\n- config: (String) has 2 options:\n          1. It can be empty array \'[]\' for columns auto detection. This is PREFERRED option.\n          2. It can be JavaScript configuration object for Tabulator in this format: config = {"height": 355, ...}. here is configuration object example:\n                config = {\n                      "height": 355,\n                      "movableColumns": true,\n                      "layout": "fitColumns",\n                      "columns": [\n                          {\n                              "title": "issue_category",\n                              "field": "issue_category"\n                          },\n                         ....\n                         // columns definition objects according to input data\n                      ]\n                  }\n- renderer: (String) Table rendering engine (always "tabulator").',dataStructure:null,examples:[]},11:{name:"HTML Node",className:"draw2d.shape.fishbone.cell.HTMLnode",category:"presentation",approach:"traditional",source:"fishbone-core.js",requiredProperties:["cont_id","html"],documentation:'Purpose: Renders custom HTML content, potentially incorporating data.\nKey Properties: \n- cont_id (target HTML element ID)\n- html (HTML code string)\n- binder: "rivets" (optional, enables Rivets.js data binding)\n- params: Array of parameter definitions for data binding (required when binder="rivets")\nHTML Content Rules: \n- Pure HTML, utilizing Bootstrap classes for styling is strictly recommended.\n- NO <style> or <script> tags.\n- Include only the content that would go inside the <body> tag (no <html>, <head>, <body> tags themselves within the html property).\n- Can utilize peity.js for thumbnail charts and other simple visualizations, you can pass data using parameters described below. For example:<span class="bar" data-peity=\'{ "height": 70,  "width": 170}\'>{ params.data.0.chart_data} </span> where chart data string parameter like this: "5,6,3,7,8". Use Mathnode to create appropriate string.\n\nData Binding with Rivets.js:\n- When binder="rivets", the node supports dynamic data binding using Rivets.js\n- Parameters are defined in the params array with structure:\n    {\n        param_name: "name",      // Binding variable name\n        param_source: "source",  // Data source node label parameter\n        prop_type: "list", // Data type, Always "list"\n        param_details: "sites_list_out",   // Source field name. Always "sites_list_out"\n        full_data: true    // Whether to bind full array or just values. Always true\n    }\n- Binding Patterns:\n    * Array iteration: rv-each-item="params.list"\n    * Nested properties: { params.param_1.0.field } // REQUIRED, always started from "params" reference, like params.param_name.0.field_name  f.e.: params.param_1.0.field,',dataStructure:null,examples:[{name:"Array iteration",code:'{\n  "binder": "rivets",\n  "params": [\n      {\n          "param_name": "data",\n          "param_source": "source_item",\n          "prop_type": "list",\n          "param_details": "sites_list_out", //always "sites_list_out"\n          "full_data": true\n      }\n  ],\n  "html": "<div rv-each-item="params.data">{ item.field }</div>" // rv-each-item always started from "params" reference, like params.param_name  f.e.: params.data, \n}'},{name:"Nested properties",code:'{ \n  "html": "<h5>{ params.par.0.f_el }</h5>", //html property MAST consist html code with rivets binding reference, where 0 is index of item in data (\'sites_list_out\') array, \'f_el\' is field name.\n  "binder": "rivets",\n  "params": [\n    {\n      "param_name": "par",\n      "param_source": "New Query",\n      "prop_type": "list",\n      "param_details": "sites_list_out", //always "sites_list_out",\n      "full_data": true\n    }\n  ],\n  "label": "New Label",\n  "type_name": "html"\n}'}]},12:{name:"Style Node",className:"draw2d.shape.fishbone.cell.Stylenode",category:"presentation",approach:"traditional",source:"fishbone-core.js",requiredProperties:["style"],documentation:'Purpose: Provides CSS styling for the report.\nKey Property: style (contains CSS rules to apply to the report).\nUsage: Connect to the HTML structure to apply custom styling beyond Bootstrap.\nConnection: Style node MAST be connected to DU Model node.\nContent: CSS rules without <style> tags. Example:\n{\n  "style": ".card { border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); } .highlight { font-weight: bold; color: #007bff; }"\n}',dataStructure:null,examples:[]}};function c(e){return l[e]||null}function u(e){return Object.entries(l).filter((function(t){var a=r(t,2);return a[0],a[1].category===e})).reduce((function(e,t){var a=r(t,2),n=a[0],o=a[1];return e[n]=o,e}),{})}function d(e){return Object.entries(l).filter((function(t){var a=r(t,2),n=(a[0],a[1]);return n.approach===e||"both"===n.approach})).reduce((function(e,t){var a=r(t,2),n=a[0],o=a[1];return e[n]=o,e}),{})}function p(e){if(!e||!e.nodes)return{};var t=new Set;return e.nodes.forEach((function(e){e.class&&"number"==typeof e.class&&t.add(e.class)})),Object.entries(l).filter((function(e){var a=r(e,2),n=a[0];return a[1],t.has(parseInt(n))})).reduce((function(e,t){var a=r(t,2),n=a[0],o=a[1];return e[n]=o,e}),{})}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.approach,a=void 0===t?"javascript":t,n=e.categories,s=void 0===n?null:n,c=e.nodeIds,u=void 0===c?null:c,p=e.includeExamples,h=void 0===p||p,f=e.includeDataStructures,m=void 0===f||f,g=e.chartLibrary,y=void 0===g?"echartjs":g,_=l;"both"!==a&&(_=d(a)),s&&Array.isArray(s)&&(_=Object.entries(_).filter((function(e){var t=r(e,2),a=(t[0],t[1]);return s.includes(a.category)})).reduce((function(e,t){var a=r(t,2),n=a[0],o=a[1];return e[n]=o,e}),{})),u&&Array.isArray(u)&&(_=Object.entries(_).filter((function(e){var t=r(e,2),a=t[0];return t[1],u.includes(parseInt(a))})).reduce((function(e,t){var a=r(t,2),n=a[0],o=a[1];return e[n]=o,e}),{}));var b={data_acquisition:[],data_manipulation:[],presentation:[]};Object.entries(_).forEach((function(e){var t=r(e,2),a=t[0],n=t[1];b[n.category].push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({id:parseInt(a)},n))}));var v="";b.data_acquisition.length>0&&(v+="A. Data Acquisition Nodes\n\n",b.data_acquisition.forEach((function(e){v+="".concat(e.id,". ").concat(e.name," (node_class_name: ").concat(e.className,", class_id: ").concat(e.id,")\n"),v+="   ".concat(e.documentation,"\n"),m&&e.dataStructure&&(v+="   Data Fields: ".concat(JSON.stringify(e.dataStructure,null,2),"\n")),h&&e.examples&&e.examples.length>0&&(v+="   Examples:\n",e.examples.forEach((function(e){v+="   ".concat(e.name,":\n"),v+="   ".concat(e.code,"\n")}))),v+="\n"}))),b.data_manipulation.length>0&&(v+="B. Data Manipulation Nodes\n\n",b.data_manipulation.forEach((function(e){v+="".concat(e.id,". ").concat(e.name," (node_class_name: ").concat(e.className,", class_id: ").concat(e.id,")\n"),v+="   ".concat(e.documentation,"\n"),h&&e.examples&&e.examples.length>0&&(v+="   Examples:\n",e.examples.forEach((function(e){v+="   ".concat(e.name,":\n"),v+="   ".concat(e.code,"\n")}))),v+="\n"}))),b.presentation.length>0&&(v+="C. Presentation Nodes\n\n",b.presentation.forEach((function(e){v+="".concat(e.id,". ").concat(e.name," (node_class_name: ").concat(e.className,", class_id: ").concat(e.id,")\n"),v+="   ".concat(e.documentation,"\n"),h&&e.examples&&e.examples.length>0&&(v+="   Examples:\n",e.examples.forEach((function(e){v+="   ".concat(e.name,":\n"),v+="   ".concat(e.code,"\n")}))),v+="\n"})));for(var w="echartjs"===y,x={"{{CHART_LIBRARY}}":w?"ECharts":"Chart.js","{{CHART_LIBRARY_UPPER}}":w?"ECHARTS":"CHART.JS","{{CHART_LIBRARY_VARIABLE}}":w?"echarts":"Chart"},k=0,D=Object.entries(x);k<D.length;k++){var S=r(D[k],2),C=S[0],T=S[1],A=new RegExp(C.replace(/[{}]/g,"\\$&"),"g");v=v.replace(A,T)}return v}function f(){var e={};return Object.entries(l).forEach((function(t){var a=r(t,2),n=(a[0],a[1]),o=n.className.split(".").pop();e[o]=n.requiredProperties})),e}function m(){var e={};return Object.entries(l).forEach((function(t){var a=r(t,2),n=a[0],o=a[1];e[parseInt(n)]=o.className})),e}function g(){var e={};return Object.entries(l).forEach((function(t){var a=r(t,2),n=a[0],o=a[1];e[parseInt(n)]=o.name})),e}const y={nodeDocumentation:l,getNodeDocumentation:c,getNodesByCategory:u,getNodesByApproach:d,getNodesInCanvas:p,generateContextualNodeDocumentation:h,getRequiredPropertiesMapping:f,getNodeClassMapping:m,getNodeNameMapping:g}},"37b68de747b6c7faf795":(e,t,a)=>{var n=a("1bf2fbdb051fe0c57024"),o=a("8deafab7866a125bb9ca"),i=a("8a868d10b6533e768658"),r=a("a45670b3d8fb79ec0258");getPieChart=function(e,t,a,s,l,c){for(var u=e.canvas.paper,d=Math.PI/180,p=u.set(),h=(new n).from(l.data).orderBy([{field:"value"}]).select(),f=0,m=0,g=0,y=function(n){var l,y,_,b=360*h[n].value/m,v=f+b/2,w=500,x=30,k=u.path(["M",t,a,"L",t+(s+x+48)*Math.cos(-v*d),a+(s+x+18)*Math.sin(-v*d)]).attr({stroke:"#2f2f2f",opacity:.8}),D=u.set();"counts"!==c&&void 0!==c||(l=Raphael.hsb(g,.7,.4+n*(.4/h.length)),y=Raphael.hsb(g,1,.7+n*(.3/h.length))),"3St"!==c&&"conditions"!==c||(y=o.get3ColorString(h[n].name),l=(l=new i.util.Color(o.get3ColorString(h[n].name))).darker(.3).hash()),_=h[n].serie&&h[n].serie.areaStyle&&h[n].serie.areaStyle.fill?h[n].serie.areaStyle.fill:v+"-"+y+"-"+l;var S=h[n].serie&&h[n].serie.areaStyle&&h[n].serie.areaStyle.opacity?h[n].serie.areaStyle.opacity:1,C=function(e,t,a,n,o,i){var r=e+a*Math.cos(-n*d),s=e+a*Math.cos(-o*d),l=t+a*Math.sin(-n*d),c=t+a*Math.sin(-o*d);return 360===Math.abs(o-n)?u.circle(e,t,a,a).attr(i):u.path(["M",e,t,"L",r,l,"A",a,a,0,+(o-n>180),0,s,c,"z"]).attr(i)}(t,a,.8*s+n*(s/1.4/h.length),f,f+b,{fill:_,stroke:y,"stroke-width":0,"fill-opacity":S});D.push(u.text(t+(s+x+55)*Math.cos(-v*d),a+(s+x+25)*Math.sin(-v*d),Math.round(100*h[n].value/m)+"%").attr({fill:"#2f2f2f","font-weight":"bold",stroke:"none",opacity:.8,"font-size":15,"text-anchor":v>90&&v<270?"end":"start"}));var T,A=D[D.length-1].getBBox();D.push(u.text(v>90&&v<270?A.x-5:A.x+A.width+5,a+(s+x+25)*Math.sin(-v*d)," ("+h[n].value+")").attr({fill:"#2f2f2f",stroke:"none",opacity:.8,"font-weight":"bold","font-size":13,"text-anchor":v>90&&v<270?"end":"start"})),A=D[D.length-1].getBBox(),D.push(u.text(v>90&&v<270?A.x-5:A.x+A.width+5,a+(s+x+25)*Math.sin(-v*d),h[n].name).attr({fill:"#2f2f2f",stroke:"none",opacity:.8,"font-size":13,"text-anchor":v>90&&v<270?"end":"start"})),(T=C).mouseover((function(){e.getX(),e.getY(),T.scale(1.1,1.1,t,a),D.stop().animate({opacity:1},w,"elastic"),k.stop().animate({opacity:1},w,"elastic")})).mouseout((function(){T.scale(.9090909091,.9090909091,t,a),k.stop().animate({opacity:.8},w,"elastic"),D.stop().animate({opacity:.8},w)})),r(T.node).on("contextmenu",(function(t,a){r.contextMenu({selector:"body",events:{hide:function(){r.contextMenu("destroy")}},callback:r.proxy((function(t,a){switch(t){case"toogleCon":setTimeout((function(){e.toogleInConn()}),10);break;case"exportToExcel":setTimeout((function(){e.userData.col.forEach((function(e,t){if(e.name===h[n].name){var a=e.sites_list_out;o.exportArrayToExcel(a)}}))}),10)}}),this),x:t.originalEvent.screenX,y:t.originalEvent.screenY,items:{toogleCon:e.userData.showInConnections?{name:"Hide Connections"}:{name:"Show Connections"},sep:"---------",exportToExcel:{name:"Export To Excel"}}})})),f+=b,p.push(C),p.push(D),g+=.1},_=0,b=h.length;_<b;_++)m+=h[_].value;for(_=0;_<b;_++)y(_);return p}},"3b9540f14a87b93e9727":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.basic.Image=n.shape.basic.Image.extend({NAME:"draw2d.shape.fishbone.basic.Image",INFO:"{Class: <strong>draw2d.shape.fishbone.basic.Image</strong>}<br/><br/>",init:function(e,t,a){this._super(o.extend({width:100,height:40},e),t,a),null===this.getUserData()&&this.attr({userData:{hidden:!1,index:0,src:"data:image/png;base64,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"}}),this.setPath(this.userData.src),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0},src:{type:"string",title:"SRC",default:""}}},this.GetHTTPData=function(){this.setPath(this.userData.src)}}})},"3f0c1c02d5ee15d6969a":(e,t,a)=>{"use strict";a.d(t,{A:()=>f,b:()=>m}),a("a26e52c4218006ed1d2f");var n=a("0dc5bc842dc3381f43a0"),o=a.n(n),i=(a("bf6903a1118c19c7825f"),a("6775976bccc90e8f9da4"),a("5cd937e8259793698cf8"),a("0563846496024d392663"),a("ed0b68463269518a4934"),a("077a95d378bbdfa3bf1f"),a("cf3ea1d5c1b698c048db"),a("a8d6bfb38cc4f98f246a"),a("6fe5e339b0f8a936ba8c")),r=a("a45670b3d8fb79ec0258");function s(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var s=n&&n.prototype instanceof c?n:c,u=Object.create(s.prototype);return l(u,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),u}var r={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var p=[][n]?t(t([][n]())):(l(t={},n,(function(){return this})),t),h=d.prototype=c.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,l(e,o,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,l(h,"constructor",d),l(d,"constructor",u),u.displayName="GeneratorFunction",l(d,o,"GeneratorFunction"),l(h),l(h,o,"Generator"),l(h,n,(function(){return this})),l(h,"toString",(function(){return"[object Generator]"})),(s=function(){return{w:i,m:f}})()}function l(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,t,a,n){function i(t,a){l(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},l(e,t,a,n)}function c(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function u(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){c(i,n,o,r,s,"next",e)}function s(e){c(i,n,o,r,s,"throw",e)}r(void 0)}))}}var d=i.context||"",p="".concat(d,"/client/ace-workers");o().config.set("basePath","".concat(d,"/client")),o().config.set("workerPath",p),o().config.set("modePath","".concat(d,"/client")),o().config.set("themePath","".concat(d,"/client")),o().config.setModuleUrl("ace/mode/javascript_worker","".concat(p,"/worker-javascript.js")),o().config.setModuleUrl("ace/mode/html_worker","".concat(p,"/worker-html.js")),o().config.setModuleUrl("ace/mode/json_worker","".concat(p,"/worker-json.js")),o().config.setModuleUrl("ace/mode/css_worker","".concat(p,"/worker-css.js")),o().config.setModuleUrl("ace/mode/xml_worker","".concat(p,"/worker-xml.js")),o().config.setModuleUrl("ace/mode/yaml_worker","".concat(p,"/worker-yaml.js")),o().config.setModuleUrl("ace/mode/coffee_worker","".concat(p,"/worker-coffee.js")),o().config.setModuleUrl("ace/mode/lua_worker","".concat(p,"/worker-lua.js")),o().config.setModuleUrl("ace/mode/php_worker","".concat(p,"/worker-php.js")),o().config.setModuleUrl("ace/mode/xquery_worker","".concat(p,"/worker-xquery.js"));var h=function(e,t){var a,n,i,l,c,d,p,h;TreemaNode.prototype.saveChanges=function(e){var a=this;if(e!==this.data)return t((function(){var e=a.getRoot();e&&e.owner&&e.owner.updateUI()}),1),this.addTrackedAction({oldData:e,newData:this.data,path:this.getPath(),action:"edit"})},TreemaNode.setNodeSubclass("boolean",function(e){function a(){return a.__super__.constructor.apply(this,arguments)}return __extends(a,e),a.prototype.valueClass="treema-boolean",a.prototype.buildValueForDisplay=function(e,t){return this.buildValueForDisplaySimply(e,JSON.stringify(t)),this.keepFocus()},a.prototype.buildValueForEditing=function(e,t){var a;return a=this.buildValueForEditingSimply(e,JSON.stringify(t)),r("<span></span>").text(JSON.stringify(this.data)).insertBefore(a),a.focus()},a.prototype.toggleValue=function(e){var a,n,o=this;return null==e&&(e=null),t((function(){var e=o.getRoot();e&&e.owner&&e.owner.updateUI()}),1),a=this.getData(),this.data=!this.data,null!=e&&(this.data=e),n=this.getValEl().empty(),this.isDisplaying()?this.buildValueForDisplay(n,this.getData()):this.buildValueForEditing(n,this.getData()),this.addTrackedAction({oldData:a,newData:this.data,path:this.getPath(),action:"edit"}),this.keepFocus(),this.flushChanges()},a.prototype.onSpacePressed=function(){return this.toggleValue()},a.prototype.onFPressed=function(){return this.toggleValue(!1)},a.prototype.onTPressed=function(){return this.toggleValue(!0)},a.prototype.saveChanges=function(){},a.prototype.onClick=function(e){return r(e.target).closest(".treema-value").length?this.canEdit()?this.toggleValue():void 0:a.__super__.onClick.call(this,e)},a}(TreemaNode)),a=function(){this.super("constructor").apply(this,arguments)},TreemaNode.extend(a),a.prototype.buildValueForDisplay=function(e,t){return null},n=a,TreemaNode.setNodeSubclass("hidden",n),i=function(){this.super("constructor").apply(this,arguments)},TreemaNode.extend(i),i.prototype.buildValueForDisplay=function(e,t){var a;return a=this.buildValueForEditingSimply(e,t),this.workingSchema.maxLength&&a.attr("maxlength",this.workingSchema.maxLength),a.attr("type","color")},i.prototype.buildValueForEditing=function(e,t){var a;return a=this.buildValueForEditingSimply(e,t),this.workingSchema.maxLength&&a.attr("maxlength",this.workingSchema.maxLength),a.attr("type","color")},i.prototype.saveChanges=function(e){this.data=e.find("input").val()},l=i,TreemaNode.setNodeSubclass("colorpicker",l),c=function(){this.super("constructor").apply(this,arguments)},TreemaNode.extend(c),c.prototype.buildValueForDisplay=function(e,t){var a;return a=this.buildValueForEditingSimply(e,t),this.workingSchema.maxLength&&a.attr("maxlength",this.workingSchema.maxLength),a.attr("type","text").attr("rows","4")},c.prototype.buildValueForEditing=function(e,t){var a;return a=this.buildValueForEditingSimply(e,t),this.workingSchema.maxLength&&a.attr("maxlength",this.workingSchema.maxLength),a.attr("type","text")},c.prototype.saveChanges=function(e){this.data=e.find("input").val()},d=c,TreemaNode.setNodeSubclass("memo",d),p=function(){this.super("constructor").apply(this,arguments)},TreemaNode.extend(p),p.prototype.valueClass="treema-ace treema-multiline",p.prototype.initEditor=function(e){var a,n,i,l,c=this,d=this;this.escapeKeyTimer=null,this.escapeKeyCount=0,a=r("<div></div>").css({height:this.schema.height||"500px",display:"flex",flexDirection:"column"}),i=r("<div></div>").css({height:"2em",borderBottom:"1px solid #ddd",display:"flex",alignItems:"center",gap:"0.1em"});var p=r('<div class="overlaySpin"></div>').css({position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.7)",display:"none",alignItems:"center",justifyContent:"center",zIndex:1e3}).append(r("<div></div>").css({display:"flex",flexDirection:"column",alignItems:"center",gap:"10px"}).append(r("<i></i>").addClass("bi bi-arrow-repeat").css({fontSize:"2em",animation:"spin 1s linear infinite"}),r("<span>Cooking Formula...</span>").css({fontSize:"0.9em"})));setTimeout((function(){var e=c.getRoot().owner;null!=e&&e.xhr&&[1,2,3].includes(e.xhr.readyState)&&p.css("display","flex")}),100);var h=document.createElement("style");h.textContent="\n                @keyframes spin {\n                    from { transform: rotate(0deg); }\n                    to { transform: rotate(360deg); }\n                }\n                \n                /* ACE Editor background for uncommitted changes */\n                .ace_editor_uncommitted .ace_scroller {\n                    background-color: rgba(255, 193, 7, 0.05) !important;\n                    transition: background-color 0.3s ease !important;\n                }\n                \n                .ace_editor_uncommitted .ace_gutter {\n                    background-color: rgba(255, 193, 7, 0.08) !important;\n                    transition: background-color 0.3s ease !important;\n                }\n                \n                /* ACE Editor Status Bar */\n                .ace_status_bar {\n                    height: 24px !important;\n                    background-color: #f8f9fa !important;\n                    border-bottom: 1px solid #787878!important;\n                    border-left: 1px solid #787878!important;\n                    border-right: 1px solid #787878!important;\n                    border-radius: 0 0 3px 3px !important;\n                    display: flex !important;\n                    align-items: center !important;\n                    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace !important;\n                    font-size: 11px !important;\n                    color: #6c757d !important;\n                    position: relative !important;\n                    flex-shrink: 0 !important;\n                    width: 100% !important;\n                }\n                \n                .ace_status_commit_area {\n                    width: var(--gutter-width, 50px) !important;\n                    display: flex !important;\n                    align-items: center !important;\n                    justify-content: center !important;\n                    border-right: 1px solid #e9ecef !important;\n                    background-color: #f1f3f4 !important;\n                }\n                \n                .ace_status_message_area {\n                    flex: 1 !important;\n                    padding: 0 12px !important;\n                    white-space: nowrap !important;\n                    overflow: hidden !important;\n                    text-overflow: ellipsis !important;\n                }\n                \n                .ace_status_info_area {\n                    min-width: 120px !important;\n                    padding: 0 12px !important;\n                    border-left: 1px solid #e9ecef !important;\n                    background-color: #f1f3f4 !important;\n                    text-align: right !important;\n                }\n                \n                .ace_status_commit_btn {\n                    width: 16px !important;\n                    height: 16px !important;\n                    border-radius: 50% !important;\n                    border: none !important;\n                    background-color: #10b981 !important;\n                    cursor: pointer !important;\n                    display: flex !important;\n                    align-items: center !important;\n                    justify-content: center !important;\n                    transition: all 0.2s ease !important;\n                    box-shadow: 0 1px 3px rgba(0,0,0,0.12) !important;\n                }\n                \n                .ace_status_commit_btn.hidden {\n                    display: none !important;\n                }\n                \n                .ace_status_commit_btn:hover {\n                    background-color: #059669 !important;\n                    transform: scale(1.1) !important;\n                    box-shadow: 0 2px 6px rgba(0,0,0,0.2) !important;\n                }\n                \n                .ace_status_commit_btn i {\n                    font-size: 8px !important;\n                    color: white !important;\n                }\n            ",document.head.appendChild(h);var f,m,g=function(){return d.editor&&!d.editor.getSession().getUndoManager().isClean()},y=function(){if(d.editor){var e=r(d.editor.container).find(".ace_gutter").outerWidth();e&&document.documentElement.style.setProperty("--gutter-width",e+"px")}},_=function(){var e=g();if(d.commitBtn&&(e?d.commitBtn.removeClass("hidden"):d.commitBtn.addClass("hidden")),d.messageArea&&(e?d.messageArea.text("Ctrl+Enter to commit, Esc×2 to cancel"):d.messageArea.text("")),d.editor){var t=r(d.editor.container);e?t.addClass("ace_editor_uncommitted"):t.removeClass("ace_editor_uncommitted")}!function(){if(d.editor&&d.infoArea){var e=d.editor.getSession(),t=d.editor.getCursorPosition(),a=e.getValue().length,n=t.row+1,o=t.column+1;d.infoArea.text("".concat(a," chars • Ln ").concat(n,", Col ").concat(o))}}(),y()},b=[{icon:"bi-text-indent-left",title:"Auto Indent",onClick:function(){d.editor.getSession().getLength(),d.editor.selectAll();var e=d.editor.autoIndent();e&&(e.exec(d.editor),d.editor.clearSelection(),d.editor.moveCursorTo(0,0))},m_right:"0.5em"},{icon:"bi-eye-slash",title:"Toggle Visibility",onClick:function(){var e=n.is(":visible");n.toggle(),a.css("height",e?"2em":d.schema.height||"500px"),r(event.currentTarget).find("i").removeClass(e?"bi-eye":"bi-eye-slash").addClass(e?"bi-eye-slash":"bi-eye"),e||d.editor.resize()},m_right:"0.5em"},{icon:"bi-check-all",title:"Select All",onClick:function(){return c.editor.selectAll()}},{icon:"bi-clipboard",title:"Copy Content",onClick:(m=u(s().m((function e(){var t;return s().w((function(e){for(;;)switch(e.n){case 0:return t=d.editor.getSelectedText()||d.editor.getValue(),e.n=1,navigator.clipboard.writeText(t);case 1:return e.a(2)}}),e)}))),function(){return m.apply(this,arguments)})},{icon:"bi-clipboard-plus",title:"Paste Content",onClick:(f=u(s().m((function e(){var t,a;return s().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,navigator.clipboard.readText();case 1:t=e.v,d.editor.insert(t),e.n=3;break;case 2:e.p=2,a=e.v,console.error("Failed to paste:",a);case 3:return e.a(2)}}),e,null,[[0,2]])}))),function(){return f.apply(this,arguments)}),m_right:"0.5em"},{icon:"bi-eraser",title:"Clear Content",m_right:"0.5em",onClick:function(){confirm("Are you sure you want to clear all content?")&&(d.editor.setValue(""),_())}}];if(this.schema.AItools){var v=function(e){return p.css("display","flex"),function(e){r(".overlaySpin").css("display","none"),w.editor.setValue(e),w.saveChanges(),w.editor.getSession().getUndoManager().markClean(),_()}},w=this;this.schema.AItools.tools.indexOf("left")>-1&&b.push({icon:"bi-caret-left",title:"Previous Reply",onClick:function(){t((function(){var e,t=c.getRoot();if(null!=t&&null!==(e=t.owner)&&void 0!==e&&null!==(e=e.AI)&&void 0!==e&&null!==(e=e[String(c.keyForParent)])&&void 0!==e&&null!==(e=e.messages)&&void 0!==e&&e.length&&t.owner.AI[String(c.keyForParent)].current_m_index>1){var a=t.owner.AI[String(c.keyForParent)].messages[t.owner.AI[String(c.keyForParent)].current_m_index-2].content;w.editor.setValue(a),t.owner.AI[String(c.keyForParent)].current_m_index=t.owner.AI[String(c.keyForParent)].current_m_index-2,w.saveChanges(),w.editor.getSession().getUndoManager().markClean(),t.owner.updateTable(),_()}}),1)}}),this.schema.AItools.tools.indexOf("gen")>-1&&b.push({icon:"bi-stars",title:"AI Generate",onClick:function(){t((function(){var e,t,a=c.getRoot();null==a||null===(e=a.owner)||void 0===e||null===(e=e.AI)||void 0===e||null===(e=e[String(c.keyForParent)])||void 0===e||null===(t=e.generateAI)||void 0===t||t.call(e,v())}),1)}}),this.schema.AItools.tools.indexOf("edit")>-1&&b.push({icon:"bi-reply",title:"AI Reply",onClick:function(){t((function(){var e,t,a=c.getRoot();null==a||null===(e=a.owner)||void 0===e||null===(e=e.AI)||void 0===e||null===(e=e[String(c.keyForParent)])||void 0===e||null===(t=e.editAI)||void 0===t||t.call(e,v())}),1)}}),this.schema.AItools.tools.indexOf("retry")>-1&&b.push({icon:"bi-arrow-clockwise",title:"AI Retry",onClick:function(){t((function(){var e,t,a=c.getRoot();null==a||null===(e=a.owner)||void 0===e||null===(e=e.AI)||void 0===e||null===(e=e[String(c.keyForParent)])||void 0===e||null===(t=e.optiAI)||void 0===t||t.call(e,v(),a.owner.AI[String(c.keyForParent)].messages[a.owner.AI[String(c.keyForParent)].current_m_index-1].content)}),1)}}),this.schema.AItools.tools.indexOf("edit_p")>-1&&b.push({icon:"bi-feather",title:"AI Edit",onClick:function(){t((function(){var e,t,a=c.getRoot();null==a||null===(e=a.owner)||void 0===e||null===(e=e.AI)||void 0===e||null===(e=e[String(c.keyForParent)])||void 0===e||null===(t=e.editAI)||void 0===t||t.call(e,v(),a.owner.AI[String(c.keyForParent)].messages[a.owner.AI[String(c.keyForParent)].current_m_index-1].user_input,a.owner.AI[String(c.keyForParent)].messages[a.owner.AI[String(c.keyForParent)].current_m_index].content)}),1)}}),this.schema.AItools.tools.indexOf("opti")>-1&&b.push({icon:"bi-bandaid",title:"AI Fix",onClick:function(){t((function(){var e,t,a=c.getRoot();null==a||null===(e=a.owner)||void 0===e||null===(e=e.AI)||void 0===e||null===(e=e[String(c.keyForParent)])||void 0===e||null===(t=e.optiAI)||void 0===t||t.call(e,v())}),1)}}),this.schema.AItools.tools.indexOf("right")>-1&&b.push({icon:"bi-caret-right",title:"Next Reply",onClick:function(){t((function(){var e,t=c.getRoot();if(null!=t&&null!==(e=t.owner)&&void 0!==e&&null!==(e=e.AI)&&void 0!==e&&null!==(e=e[String(c.keyForParent)])&&void 0!==e&&null!==(e=e.messages)&&void 0!==e&&e.length&&t.owner.AI[String(c.keyForParent)].current_m_index<t.owner.AI[String(c.keyForParent)].messages.length-2){var a=t.owner.AI[String(c.keyForParent)].messages[t.owner.AI[String(c.keyForParent)].current_m_index+2].content;w.editor.setValue(a),t.owner.AI[String(c.keyForParent)].current_m_index=t.owner.AI[String(c.keyForParent)].current_m_index+2,w.saveChanges(),w.editor.getSession().getUndoManager().markClean(),t.owner.updateTable(),_()}}),1)}}),this.schema.AItools.tools.indexOf("save_lib")>-1&&b.push({icon:"bi-archive",title:"Save to Library",m_left:"0.5em",onClick:function(){t((function(){var e=c.getRoot();if(e&&e.owner){var t=e.owner.NAME?e.owner.NAME.split(".").pop():"UnknownNode",a=String(c.keyForParent),n=w.editor.getValue(),o=e.owner.canvas||e.owner.getCanvas();if(o){var i=r(o.html).parent(),s=angular.element(i).scope();s&&s.editor&&s.editor.saveNodeLibItem?s.editor.saveNodeLibItem(e.owner,a,t,n):console.error("Unable to access saveNodeLibItem function")}}}),1)}}),this.schema.AItools.tools.indexOf("load_lib")>-1&&b.push({icon:"bi-file-earmark-arrow-down",title:"Load from Library",onClick:function(){t((function(){var e=c.getRoot();if(e&&e.owner){var t=e.owner.NAME?e.owner.NAME.split(".").pop():"UnknownNode",a=String(c.keyForParent),n=e.owner.canvas||e.owner.getCanvas();if(n){var o=r(n.html).parent(),i=angular.element(o).scope();i&&i.editor&&i.editor.loadNodeLibItem?i.editor.loadNodeLibItem(e.owner,a,t,(function(e){w.editor.setValue(e),w.saveChanges(),w.editor.getSession().getUndoManager().markClean(),_()})):console.error("Unable to access loadNodeLibItem function")}}}),1)}})}b.forEach((function(e){i.append(function(e,t,a,n,o){var i=r("<button></button>").css({width:"1.6em",height:"1.6em",padding:"0.1em",border:"1px solid #ddd",borderRadius:"0.2em",backgroundColor:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"}).append(r("<i></i>").addClass("bi ".concat(e)).css({fontSize:"0.8em"})).attr("title",t).hover((function(){r(this).css("backgroundColor","#e9ecef")}),(function(){r(this).css("backgroundColor","white")})).click(a);return n&&i.css("margin-right",n),o&&i.css("margin-left",o),i}(e.icon,e.title,e.onClick,e.m_right,e.m_left))})),n=r("<div></div>").text(this.getData()).css({flex:1,"border-radius":"3px",position:"relative",height:"100%"});var x=r("<div></div>").css({position:"relative",flex:1,display:"flex",flexDirection:"column",height:"100%"}),k=r("<div></div>").css({position:"relative",flex:1,display:"flex",flexDirection:"column"});k.append(n),k.append(p);var D=function(){var e=r("<div></div>").addClass("ace_status_bar"),t=r("<div></div>").addClass("ace_status_commit_area"),a=r("<button></button>").addClass("ace_status_commit_btn hidden").attr("title","Commit Changes").append(r("<i></i>").addClass("bi bi-check")).click((function(){d.saveChanges(),d.editor.getSession().getUndoManager().markClean(),_()}));t.append(a);var n=r("<div></div>").addClass("ace_status_message_area"),o=r("<div></div>").addClass("ace_status_info_area");return e.append(t,n,o),d.statusBar=e,d.commitBtn=a,d.messageArea=n,d.infoArea=o,e}();return x.append(k),x.append(D),a.append(i).append(x),e.append(a),console.log("Worker path:",o().config.get("workerPath")),this.editor=o().edit(n[0]),l=this.editor.getSession(),null!=this.schema.aceMode&&l.setMode(this.schema.aceMode),null!=this.schema.aceTabSize&&l.setTabSize(this.schema.aceTabSize),null!=this.schema.aceUseWrapMode&&l.setUseWrapMode(this.schema.aceUseWrapMode),this.editor.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),l.getUndoManager().markClean(),l.on("change",_),d.editor.on("changeSelection",_),d.editor.commands.addCommand({name:"cancelChanges",bindKey:{win:"Esc",mac:"Esc"},exec:function(e){!function(){if(d.escapeKeyCount++,d.escapeKeyTimer&&clearTimeout(d.escapeKeyTimer),d.escapeKeyTimer=setTimeout((function(){d.escapeKeyCount=0}),1500),d.escapeKeyCount>=2&&(d.escapeKeyCount=0,clearTimeout(d.escapeKeyTimer),g())){for(var e=d.editor.getSession().getUndoManager();e.hasUndo()&&!e.isClean();)e.undo();_()}}()},readOnly:!1}),d.editor.commands.addCommand({name:"commitChanges",bindKey:{win:"Ctrl-Enter",mac:"Cmd-Enter"},exec:function(e,t,a){g()&&(d.saveChanges(),d.editor.getSession().getUndoManager().markClean(),_())},readOnly:!1}),setTimeout((function(){y(),_()}),100),this.editor.$blockScrolling=1/0},p.prototype.toggleEdit=function(){return this.editor||this.initEditor(this.getValEl()),this.deselectAll()},p.prototype.buildValueForDisplay=function(e){if(!this.editor)return this.initEditor(e)},p.prototype.buildValueForEditing=function(){},p.prototype.saveChanges=function(){return this.data=this.editor.getValue(),this.flushChanges(),this.broadcastChanges()},p.prototype.onTabPressed=function(){},p.prototype.onEnterPressed=function(){},p.prototype.destroy=function(){if(this.editor)return this.editor.getSession().setMode(""),this.editor.destroy()},h=p,TreemaNode.setNodeSubclass("ace",h)};h.$inject=["$scope","$timeout"];const f=h;function m(e,t,a,n){e.addClass("treema-wrapper");var o=r('<ul class="nav nav-tabs" id="myTab"></ul>'),i=r('<a class="nav-link active p-2" id="treema-tab" data-bs-toggle="tab" data-bs-target="#treema-tab-pane">Config</a>'),s=r('<a class="nav-link p-2" data-bs-toggle="tab" id="data-tab" data-bs-target="#data-tab-pane">Data</a>'),l=r('<a class="nav-link p-2" data-bs-toggle="tab" id="schema-tab" data-bs-target="#schema-tab-pane">Schema</a>'),c=r('<a class="nav-link p-2" data-bs-toggle="tab" id="errors-tab" data-bs-target="#errors-tab-pane">Errors</a>');o.append(r("<li></li>").append(i)),o.append(r("<li></li>").append(s)),o.append(r("<li></li>").append(l)),o.append(r("<li></li>").append(c));var u=r('<div class="tab-content" id="myTabContent"></div>'),d=r('<div class="tab-pane fade show active" role="tabpanel" id="treema-tab-pane" aria-labelledby="treema-tab" tabindex="0"></div>');u.append(d);var p=r("<div></div>");d.append(p);var h=r('<div class="tab-pane fade" role="tabpanel" id="data-tab-pane" aria-labelledby="data-tab" tabindex="0"></div>'),f=r("<div></div>").append(),m=r("<pre></pre>");f.append(m);var g=r("<code></code>");g.text(JSON.stringify(a,null,2)),m.append(g),m.addClass("border"),f.height("500px"),f.css("overflow-y","scroll"),f.addClass("p-2"),h.append(f),u.append(h);var y=r('<div class="tab-pane fade" role="tabpanel" id="schema-tab-pane" aria-labelledby="schema-tab" tabindex="0"></div>'),_=r("<div></div>"),b=r("<pre></pre>");_.append(b);var v=r("<code></code>");v.text(JSON.stringify(t,null,2)),b.append(v),b.addClass("border"),_.height("500px"),_.css("overflow-y","scroll"),_.addClass("p-2"),y.append(_),u.append(y);var w=r('<div class="tab-pane fade" role="tabpanel" id="errors-tab-pane" aria-labelledby="errors-tab" tabindex="0"></div>');u.append(w);var x=p.treema({schema:t,data:a});return x.build(),n&&(x.owner=n),e.append(o).append(u),x}},"40482ad684dde7d1d558":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";var vega__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("3473246f9665a5e8f7af"),vega_lite__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("8f26381ed0ec1cda1725"),svg_parser__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("9d6ba3997b9d369bf82c"),d_forest__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("c76077976aea7b2d1b64"),d_forest__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(d_forest__WEBPACK_IMPORTED_MODULE_2__),draw2d__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("8a868d10b6533e768658"),draw2d__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(draw2d__WEBPACK_IMPORTED_MODULE_3__),file_saver__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("2862a523e031319710f7"),file_saver__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(file_saver__WEBPACK_IMPORTED_MODULE_4__),vega_embed__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("82fc3aeeb8f5964c98c9"),leaflet__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("6e841ed3e83e93f20bf1"),leaflet__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(leaflet__WEBPACK_IMPORTED_MODULE_6__),leaflet_vega_main_dist_bundle__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("854402d9b0ad1beadd6f"),leaflet_vega_main_dist_bundle__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(leaflet_vega_main_dist_bundle__WEBPACK_IMPORTED_MODULE_7__),_settings__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("6fe5e339b0f8a936ba8c"),_settings__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_settings__WEBPACK_IMPORTED_MODULE_8__),_utils_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("8deafab7866a125bb9ca"),$=__webpack_require__("a45670b3d8fb79ec0258"),Utils=__webpack_require__("8deafab7866a125bb9ca"),jQuery=__webpack_require__("a45670b3d8fb79ec0258");function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function _iterableToArrayLimit(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}draw2d__WEBPACK_IMPORTED_MODULE_3___default().shape.fishbone.ra.RaSVGNode=draw2d__WEBPACK_IMPORTED_MODULE_3___default().SVGFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaSVGNode",init:function(e,t,a,n){this._super($.extend({svg:'<svg xmlns="http://www.w3.org/2000/svg" ><rect id="Rectangle-1" stroke-dasharray="4" stroke-width="2" rx="15" ry="15" stroke="#777" fill="none" width="150" height="50"></rect></svg>',stroke:0,bgColor:null,width:150,height:50},e),t,a);var o=this;this.setResizeable(!1),this.rotateSet=[],this.updateTickets=[],this.oldAbsX=0,this.oldAbsY=0;var i=new(draw2d__WEBPACK_IMPORTED_MODULE_3___default().PivotRowInputPort);i.setConnectionDirection(0),i.setName("input0");var r=new(draw2d__WEBPACK_IMPORTED_MODULE_3___default().layout.locator.TopLocator);this.addPort(i,r),this.row=[],this.userData={},$.extend(this.userData,{row:[]}),this.treema_scheme={},$.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{row:{additionalProperties:!1,type:"array",title:"Inputs",items:{type:"object",title:"Row",properties:{sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},item_name:{title:"Row Name",type:"string"},project:{format:"hidden",optional:!0},scope:{format:"hidden",optional:!0},sop:{format:"hidden",optional:!0},task:{format:"hidden",optional:!0},color:{format:"hidden",optional:!0},id:{format:"hidden",optional:!0},task_type:{format:"hidden",optional:!0},col_name:{format:"hidden",optional:!0},group_name:{format:"hidden",optional:!0},figure_id:{type:"string",title:"Fugure ID",optional:!0},owner_id:{type:"string",title:"Owner ID",optional:!0}}}}}}),this.GetHTTPData=function(){this.updateTable()},this.createOutputPort=function(){var e=new(draw2d__WEBPACK_IMPORTED_MODULE_3___default().OutputPort),t=o.getOutputPorts().data.length;e.setName("output"+t),this.addPort(e),this.layoutPorts()}},showSpinner:function(){var e=document.getElementById(this.userData.cont_id);e&&e.parentNode.querySelector(".spin")&&(e.parentNode.querySelector(".spin").classList.add("show-loader"),e.parentNode.querySelector(".spin").classList.remove("hide-loader"))},createSet:function(){return null===this.svg&&(this.svg=this.getSVG()),this.importSVG(this.canvas,this.svg)},setSVG:function(e,t){if(this.svg=e,null!==this.canvas&&null!==this.svgNodes){var a=this.createSet();if(isNaN(parseFloat(t)))this.svgNodes.remove(),this.svgNodes=a,this.applyTransformation();else{a.hide(),a.insertAfter(this.svgNodes);var n=this.svgNodes;this.svgNodes=a,this.applyTransformation(),n.forEach((function(e){$(e.node).fadeOut(t,(function(){e.remove()}))})),a.forEach((function(e){$(e.node).fadeIn(t)}))}}return this},getTopLevelShapeElement:function(){return 0===this.svgNodes.length?this.shape:"set"!==this.svgNodes[0].type?this.svgNodes[0]:"set"!==this.svgNodes[0][0].type?this.svgNodes[0][0]:"set"!==this.svgNodes[0][0][0].type?this.svgNodes[0][0][0]:"set"!==this.svgNodes[0][0][0][0].type?this.svgNodes[0][0][0][0]:this.svgNodes[0][0][0][0][0]},applyTransformation:function(){var e=this.getAbsoluteX()-this.oldAbsX,t=this.getAbsoluteY()-this.oldAbsY;this.oldAbsX=this.getAbsoluteX(),this.oldAbsY=this.getAbsoluteY();var a="...T"+e+","+t;return this.svgNodes.transform(a),this},importSVG:function importSVG(canvas,rawSVG){var main_set=canvas.paper.set(),figure=this,defin={},config={rect:0,path:0,line:0,text:0};try{if(void 0===rawSVG)throw"No data was provided.";var svgDOM=$(rawSVG);svgDOM.attr("width")&&svgDOM.attr("height")&&(this.originalWidth=parseFloat(svgDOM.attr("width")),this.originalHeight=parseFloat(svgDOM.attr("height")),this.setDimension(parseFloat(svgDOM.attr("width")),parseFloat(svgDOM.attr("height"))));var findStyle=new RegExp("([a-z0-9-]+) ?: ?([^ ;]+)[ ;]?","gi"),parsed=(0,svg_parser__WEBPACK_IMPORTED_MODULE_10__.q)(rawSVG);if("defs"===parsed.children[0].children[parsed.children[0].children.length-1].tagName){var element=parsed.children[0].children.splice(parsed.children[0].children.length-1,1)[0];element.children.length>0&&element.children.forEach((function(e){var t=[];e.properties.x1===e.properties.x2?t.push("90"):t.push("0"),"linearGradient"===e.tagName&&(e.children.length>0&&e.children.forEach((function(e){t.push(e.properties["stop-color"]+":"+Math.round(100*e.properties.offset))})),defin[e.properties.id]=t.join("-"))}))}parsed.children[0].children.forEach((function(e,t){"g"===e.tagName?handleGroup(e,main_set):handleSingleEl(e,main_set)}))}catch(e){alert("The SVG data you entered was invalid! ("+e+")")}function applyTrasform(transform,el){var trans=transform.split(" "),rotate;trans.forEach((function(tran,ind){tran.indexOf("rotate")>-1?("start"===el.attr("text-anchor")&&(tran=tran.replace(")",",0,0)")),el.data("rotate",tran),figure.rotateSet.push(el)):eval("el."+tran)}))}function handleSingleEl(e,t){var a,n=null,o=null,i={},r=e.tagName,s=r.indexOf(":");-1!=s&&(r=r.substr(s+1));for(var l=0,c=Object.entries(e.properties);l<c.length;l++){var u=_slicedToArray(c[l],2),d=u[0],p=u[1];switch(d){case"fill":if(i[d]=p,p.indexOf("url")>-1)for(var h=0,f=Object.entries(defin);h<f.length;h++){var m=_slicedToArray(f[h],2),g=m[0],y=m[1];p.indexOf(g)&&(i[d]=y)}break;case"transform":a=p;break;case"stroke-dasharray":i[d]="- ";break;case"style":o=p;break;case"id":case"xml:space":break;default:i[d]=p||p}}if(null!==o)for(;findStyle.exec(o);)i[RegExp.$1]=RegExp.$2;switch(void 0===i["stroke-width"]&&(i["stroke-width"]=void 0===i.stroke?0:1.2),r){case"rect":DEBUG&&config.rect++,n=canvas.paper.rect(),void 0!==i.rx&&(i.r=parseInt(i.rx),delete i.rx);break;case"circle":DEBUG&&config.circle++,n=canvas.paper.circle();break;case"ellipse":DEBUG&&config.ellipse++,n=canvas.paper.ellipse();break;case"path":DEBUG&&config.path++,n=canvas.paper.path(i.d);break;case"line":DEBUG&&config.line++;var _=i.x1?i.x1:"0",b=i.y1?i.y1:"0",v=i.x2?i.x2:"0",w=i.y2?i.y2:"0";i.d="M "+_+" "+b+"L"+v+" "+w,i.fill="none",n=canvas.paper.path(i.d);break;case"polyline":DEBUG&&config.polyline++;var x=i.points;i.d="M "+x.replace(" "," L"),n=canvas.paper.path(i.d);break;case"polygon":DEBUG&&config.polygon++,n=canvas.paper.polygon(i.points);break;case"image":DEBUG&&config.image++,n=canvas.paper.image();break;case"tspan":case"text":DEBUG&&config.text++,e.children.length>0&&(n=canvas.paper.text(0,0,e.children[0].value),void 0===i.fill&&(i.fill="#000000"),void 0===i["text-anchor"]&&(i["text-anchor"]="start"),void 0!==i["font-size"]&&(i["font-size"]=parseInt(i["font-size"])),void 0!==i["font-family"]&&(i["font-family"]=parseInt(i["font-family"])))}null!==n&&(n.attr(i),a&&applyTrasform(a,n),t.push(n))}function handleGroup(e,t){var a=canvas.paper.set();t.push(a),e.children.forEach((function(e,t){"g"===e.tagName?handleGroup(e,a):handleSingleEl(e,a)})),e.properties.transform&&applyTrasform(e.properties.transform,a)}return figure.rotateSet.forEach((function(el){eval("el."+el.data("rotate"))})),DEBUG&&console.log(config),main_set},getRealCount:function(){return 1},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1){var a=e.getValue().split(",")[1];this.updateTickets.indexOf(a)<0&&this.updateTickets.push(a),Utils.getMessage(t,e,"ticket received from");var n=0;this.userData.conn_count?n=this.userData.conn_count:this.getInputPorts().data.forEach((function(e,t){n+=e.getConnections().data.length})),(this.updateTickets.length>=n||e.superUpdate)&&(this.showSpinner(),this.getOutputPorts().data.forEach((function(a,n){a.getConnections().each($.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),o.superUpdate=!!e.superUpdate,n.setColor("#dfdfdf"),Utils.getMessage(t,o,"ticket send to"),o.setValue("ticket,"+t.id+","+t.userData.cont_id)}),this))})))}else{if("input0"===e.name||"input1"===e.name){if(this.updateTickets.length){var o=e.getValue(),i=this.updateTickets.indexOf(o);i>-1&&this.updateTickets.splice(i,1)}this.getInputPort(e.name).getConnections().data.forEach((function(a,n){if(e.getValue()===a.getSource().getParent().getId()){var o=a.getSource();Utils.getMessage(t,o,"update data received from");var i=jQuery.extend(!0,{},o.userData),r=i.sites_list_out,s=o.getId();i.owner_id=s;var l=-1;t.userData.row.forEach((function(e,a){e.owner_id===s&&(l=a)>-1&&(t.userData.row[l]=i,t.row[l]=r,t.project=o.getUserData().project,t.scope=o.getUserData().scope,t.sop=o.getUserData().sop)}))}}))}this.updateTickets.length||(e.superUpdate=!1,t.updateTable())}},getPersistentAttributes:function(){var e=this._super();return e.originalWidth=this.originalWidth,e.originalHeight=this.originalHeight,e.svg='<svg xmlns="http://www.w3.org/2000/svg" ><rect id="Rectangle-1" stroke-dasharray="6" rx="15" ry="15" stroke-width="2" stroke="#777" fill="none" width="'+this.originalWidth+'" height="'+this.originalHeight+'"></rect></svg>',e},setPersistentAttributes:function(e){this._super(e),this.originalWidth=e.originalWidth,this.originalHeight=e.originalHeight,this.svg=e.svg}})},"4298f14c0830aa46ddf2":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("infographic",{color:["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0"],backgroundColor:"rgba(0,0,0,0)",textStyle:{},title:{textStyle:{color:"#27727b"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{borderWidth:1},lineStyle:{width:"3"},symbolSize:"5",symbol:"emptyCircle",smooth:!1},radar:{itemStyle:{borderWidth:1},lineStyle:{width:"3"},symbolSize:"5",symbol:"emptyCircle",smooth:!1},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#c1232b",color0:"#b5c334",borderColor:"#c1232b",borderColor0:"#b5c334",borderWidth:1}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:"5",symbol:"emptyCircle",smooth:!1,color:["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#dddddd",borderColor:"#eeeeee",borderWidth:.5},label:{color:"#c1232b"},emphasis:{itemStyle:{areaColor:"#fe994e",borderColor:"#444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},geo:{itemStyle:{areaColor:"#dddddd",borderColor:"#eeeeee",borderWidth:.5},label:{color:"#c1232b"},emphasis:{itemStyle:{areaColor:"#fe994e",borderColor:"#444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#27727b"}},axisTick:{show:!0,lineStyle:{color:"#27727b"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!1,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!1,lineStyle:{color:"#333"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#27727b"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#27727b"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{borderColor:"#c1232b"},emphasis:{iconStyle:{borderColor:"#e87c25"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#27727b",width:1},crossStyle:{color:"#27727b",width:1}}},timeline:{lineStyle:{color:"#293c55",width:1},itemStyle:{color:"#27727b",borderWidth:1},controlStyle:{color:"#27727b",borderColor:"#27727b",borderWidth:.5},checkpointStyle:{color:"#c1232b",borderColor:"#c23531"},label:{color:"#293c55"},emphasis:{itemStyle:{color:"#72d4e0"},controlStyle:{color:"#27727b",borderColor:"#27727b",borderWidth:.5},label:{color:"#293c55"}}},visualMap:{color:["#c1232b","#fcce10"]},dataZoom:{backgroundColor:"rgba(0,0,0,0)",dataBackgroundColor:"rgba(181,195,52,0.3)",fillerColor:"rgba(181,195,52,0.2)",handleColor:"#27727b",handleSize:"100%",textStyle:{color:"#999999"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"42dfa9a4f20b59ef0976":(e,t,a)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(e,t,a){return(t=l(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}a.r(t),a.d(t,{default:()=>c});var c=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.aiAssistant=t,this.aiIdToNodeIdMap=new Map,this.nodeIdToAiIdMap=new Map,this.createdNodes=new Map,this.createdConnections=new Map,this.currentGeneration=null,this.generationHistory=[],this.stats={totalNodesCreated:0,totalConnectionsCreated:0,totalNodesDeleted:0,totalConnectionsDeleted:0,lastOperation:null}},t=[{key:"startNewGeneration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generation";return this.currentGeneration={id:"gen-".concat(Date.now()),type:e,startTime:new Date,nodesCreated:[],connectionsCreated:[],nodesDeleted:[],connectionsDeleted:[],nodesUpdated:[]},this.currentGeneration.id}},{key:"completeGeneration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.currentGeneration)return null;this.currentGeneration.endTime=new Date,this.currentGeneration.duration=this.currentGeneration.endTime-this.currentGeneration.startTime,this.currentGeneration.metadata=e,this.generationHistory.push(this.currentGeneration),this.generationHistory.length>20&&this.generationHistory.shift();var t=this.currentGeneration;return this.currentGeneration=null,t}},{key:"registerNode",value:function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.aiIdToNodeIdMap.set(e,t),this.nodeIdToAiIdMap.set(t,e);var o=i({aiId:e,canvasId:t,type:n.type||n.class,label:n.label,createdAt:new Date,generation:null===(a=this.currentGeneration)||void 0===a?void 0:a.id},n);return this.createdNodes.set(t,o),this.currentGeneration&&this.currentGeneration.nodesCreated.push({aiId:e,canvasId:t,type:o.type}),this.stats.totalNodesCreated++,this.stats.lastOperation={type:"node_created",aiId:e,canvasId:t,timestamp:new Date},o}},{key:"registerConnection",value:function(e,t,a){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=i({id:e,sourceAiId:t,targetAiId:a,sourceCanvasId:this.convertAiIdToNodeId(t),targetCanvasId:this.convertAiIdToNodeId(a),sourcePort:o.sourcePort||"output0",targetPort:o.targetPort||"input0",createdAt:new Date,generation:null===(n=this.currentGeneration)||void 0===n?void 0:n.id},o);return this.createdConnections.set(e,r),this.currentGeneration&&this.currentGeneration.connectionsCreated.push({id:e,sourceAiId:t,targetAiId:a}),this.stats.totalConnectionsCreated++,this.stats.lastOperation={type:"connection_created",connectionId:e,timestamp:new Date},r}},{key:"convertAiIdToNodeId",value:function(e){if(!e)return null;if(this.aiIdToNodeIdMap.has(e))return this.aiIdToNodeIdMap.get(e);var t=this.aiAssistant.canvas;if(t){var a,n=t.getFigures().find((function(t){return t.ai_id===e}));if(n)return this.registerNode(e,n.id,{type:n.cssClass||n.NAME,label:null===(a=n.userData)||void 0===a?void 0:a.label}),n.id}if(t){var o,i=t.getFigures().find((function(t){return t.id===e}));if(i)return console.log("[AINodeTrackingManager] Using direct canvas ID mapping for existing node: ".concat(e)),this.registerNode(e,e,{type:i.cssClass||i.NAME,label:null===(o=i.userData)||void 0===o?void 0:o.label}),e}return console.warn("No canvas node found for AI ID: ".concat(e)),null}},{key:"convertNodeIdToAiId",value:function(e){return this.nodeIdToAiIdMap.get(e)||null}},{key:"findNode",value:function(e){if(this.createdNodes.has(e))return this.createdNodes.get(e);var t=this.convertAiIdToNodeId(e);return t&&this.createdNodes.has(t)?this.createdNodes.get(t):null}},{key:"getCreatedNodes",value:function(){return Array.from(this.createdNodes.values())}},{key:"getCreatedConnections",value:function(){return Array.from(this.createdConnections.values())}},{key:"getNodeIdMappings",value:function(){return{aiToCanvas:Object.fromEntries(this.aiIdToNodeIdMap),canvasToAi:Object.fromEntries(this.nodeIdToAiIdMap)}}},{key:"trackNodeUpdate",value:function(e,t){var a=this.findNode(e);a&&(this.currentGeneration&&this.currentGeneration.nodesUpdated.push({nodeId:a.canvasId,aiId:a.aiId,changes:t,timestamp:new Date}),Object.assign(a,t),this.createdNodes.set(a.canvasId,a))}},{key:"trackNodeDeletion",value:function(e){var t=this.findNode(e);if(t){if(console.log("[AINodeTrackingManager] Tracking deletion of node ".concat(e," (canvas ID: ").concat(t.canvasId,")")),this.currentGeneration){var a=this.findNodeConnections(e);this.currentGeneration.nodesDeleted.push({nodeId:t.canvasId,aiId:t.aiId,nodeType:t.type,connectionCount:a.incoming.length+a.outgoing.length,timestamp:new Date,autoCleanedConnections:!0})}this.aiIdToNodeIdMap.delete(t.aiId),this.nodeIdToAiIdMap.delete(t.canvasId),this.createdNodes.delete(t.canvasId),this.stats.totalNodesDeleted++,this.stats.lastOperation={type:"node_deleted",aiId:t.aiId,canvasId:t.canvasId,timestamp:new Date,autoConnectionCleanup:!0},console.log("[AINodeTrackingManager] Node deletion tracked. Total deleted: ".concat(this.stats.totalNodesDeleted))}else console.warn("[AINodeTrackingManager] Cannot track deletion - node ".concat(e," not found in tracking"))}},{key:"trackConnectionDeletion",value:function(e){var t=this.createdConnections.get(e);t&&(this.currentGeneration&&this.currentGeneration.connectionsDeleted.push({connectionId:e,sourceAiId:t.sourceAiId,targetAiId:t.targetAiId,timestamp:new Date}),this.createdConnections.delete(e),this.stats.totalConnectionsDeleted++)}},{key:"findNodeConnections",value:function(e){var t=this.findNode(e);if(!t)return{incoming:[],outgoing:[]};var a=this.getCreatedConnections();return{incoming:a.filter((function(e){return e.targetCanvasId===t.canvasId||e.targetAiId===t.aiId})),outgoing:a.filter((function(e){return e.sourceCanvasId===t.canvasId||e.sourceAiId===t.aiId}))}}},{key:"getTrackingData",value:function(){return{mappings:this.getNodeIdMappings(),nodes:this.getCreatedNodes(),connections:this.getCreatedConnections(),stats:i({},this.stats),currentGeneration:this.currentGeneration,generationHistory:this.generationHistory}}},{key:"restoreTrackingData",value:function(e){e&&(e.mappings&&(this.aiIdToNodeIdMap=new Map(Object.entries(e.mappings.aiToCanvas||{})),this.nodeIdToAiIdMap=new Map(Object.entries(e.mappings.canvasToAi||{}))),e.nodes&&(this.createdNodes=new Map(e.nodes.map((function(e){return[e.canvasId,e]})))),e.connections&&(this.createdConnections=new Map(e.connections.map((function(e){return[e.id,e]})))),e.stats&&(this.stats=i({},e.stats)),e.generationHistory&&(this.generationHistory=e.generationHistory))}},{key:"clear",value:function(){this.aiIdToNodeIdMap.clear(),this.nodeIdToAiIdMap.clear(),this.createdNodes.clear(),this.createdConnections.clear(),this.currentGeneration=null,this.generationHistory=[],this.stats={totalNodesCreated:0,totalConnectionsCreated:0,totalNodesDeleted:0,totalConnectionsDeleted:0,lastOperation:null}}},{key:"getSummary",value:function(){var e;return{totalNodes:this.createdNodes.size,totalConnections:this.createdConnections.size,totalMappings:this.aiIdToNodeIdMap.size,currentGeneration:null===(e=this.currentGeneration)||void 0===e?void 0:e.id,generationCount:this.generationHistory.length,stats:i({},this.stats)}}}],t&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},"45de231a64f7d3e2c9b9":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca");n.shape.fishbone.cell.IFnode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.IFnode",INFO:"{Class: <strong>IFnode</strong>}<br/><br/> <strong>Code </strong><cite>Node </cite>Provide logical IF functionality. If there is no data on input port return False and oposite.<br/><br/><strong>Configuration: </strong>",init:function(e,t,a,r){this._super(o.extend({color:"#2d9068",items:{}},e),t,a,r);var s=this;this.sites_list_in=[],o.extend(this.userData,{label:"IF Node",type_name:"if"}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{label:{type:"string",format:"hidden",default:""},type_name:{type:"string",title:"Type Name",default:"gap"}}}),this.getRealCount=function(){return 1},this.GetHTTPData=function(){s.startTimer(),s.userData.sites_list_out=this.sites_list_in,s.userData.value=s.userData.sites_list_out.length;var e=s.getPort("output_yes"),t=s.getPort("output_no");this.sites_list_in&&this.sites_list_in.length?(e.setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label,task_type:s.userData.type_name||"yesno",sites_list_out:s.userData.sites_list_out}),e.getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.setValue(s.getId()),i.getMessage(s,a,"data send to"),t.setColor(s.frame.attr("stroke"))}),this))):(t.setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label,task_type:s.userData.type_name||"yesno",sites_list_out:s.userData.sites_list_out}),t.getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.setValue(s.getId()),i.getMessage(s,a,"data send to"),t.setColor(s.frame.attr("stroke"))}),this))),s.stopTimer(),s.updateUI()};var l=null;(l=new n.OutputPort).setBackgroundColor("#009adc"),l.setName("output_yes"),this.addPort(l);var c=null;(c=new n.OutputPort).setBackgroundColor("#d73a00"),c.setName("output_no"),this.addPort(c);var u=null;(u=new n.DataInputPort).setConnectionDirection(3),u.setBackgroundColor("#26cc00"),u.setName("dataInput"),this.addPort(u),this.setDimension(this.width,this.height),this.layoutPorts()},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):(this.top_label.setText("IF Node"),this.userData.label="IF Node"),this.filter_label.setText("IF"),this._super(this)},onPortValueChanged:function(e){var t=this,a=this.getInputPort(0).getConnections().data[0].getSource();e.getValue().indexOf("ticket")>-1?("dataInput"===e.name&&(t.project=a.getUserData().project,t.scope=a.getUserData().scope,t.getOutputPorts().data.forEach((function(a,n){a.getConnections().each(o.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),o.superUpdate=!!e.superUpdate,i.getMessage(t,e,"ticket send to"),o.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||n.setColor("#dfdfdf")}),this))}))),i.getMessage(t,e,"ticket received from")):"dataInput"===e.name&&(t.project=a.getUserData().project,t.scope=a.getUserData().scope,this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.GetHTTPData())}})},"4607aee02dca06a179f0":(e,t,a)=>{"use strict";var n=a("d03d36be50c40888c6b4");a("e71453b74b98489c21c0"),a("8deafab7866a125bb9ca"),e=a.hmd(e);var o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca");function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}(function(){var t;t=function(e){return e.pivotUtilities_ra.ra_segment_table_renderers={"Ra Segment Table":function(t,a){var o,s=a.figure,c=a.paper,u=a.update,d=s.userData,p=0,h=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,f='1234567890-=qwertyuiop[]/asdfghjkl;zxcvbnm,./~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?';if(PIVOT_DEBUG){var m,g,y=[];m=performance.now()}var _=function(e,t,a,n,o,i){return a?d.col[e]&&d.col[e].values?{font:d.col[e].values.font_size+"px Tahoma, Geneva","font-style":d.col[e].values.font_style,fill:d.col[e].values.color,"font-weight":d.col[e].values.font_weight}:F:n?d.col[t]&&d.col[t].values?{font:d.col[t].values.font_size+"px Tahoma, Geneva","font-style":d.col[t].values.font_style,fill:d.col[t].values.color,"font-weight":d.col[t].values.font_weight}:F:void 0},b=0,v=(d.pivot.colors.monochromatic?d.pivot.colors.mono_base_color:s.userData.pivot.colors.data_color,d.pivot.colors.monochromatic?d.pivot.colors.mono_base_color:s.userData.pivot.colors.labels_color,d.pivot.colors.monochromatic?d.pivot.colors.mono_base_color:s.userData.pivot.colors.frame_color),w=d.pivot.multi_line_max||400;s.userData.pivot.table.columns?s.userData.pivot.table.columns>t.colKeys.length?(s.c_start_position=0,s.c_finish_position=0===t.colKeys.length?1:t.colKeys.length,o=s.c_finish_position-s.c_start_position):(s.userData.pivot.table.position_on_last_col?(s.c_start_position=t.colKeys.length-s.userData.pivot.table.columns,s.c_finish_position=t.colKeys.length):(s.c_start_position=0,s.c_finish_position=s.userData.pivot.table.columns),o=s.c_finish_position-s.c_start_position):(s.c_start_position=0,s.c_finish_position=0===t.colKeys.length?1:t.colKeys.length,o=s.c_finish_position-s.c_start_position),s.userData.pivot.table.rows?s.userData.pivot.table.rows>t.rowKeys.length?(s.r_start_position=0,s.r_finish_position=t.rowKeys.length,s.r_finish_position,s.r_start_position):(s.userData.pivot.table.position_on_last_row?(s.r_start_position=t.rowKeys.length-s.userData.pivot.table.rows,s.r_finish_position=t.rowKeys.length):(s.r_start_position=0,s.r_finish_position=s.userData.pivot.table.rows),s.r_finish_position,s.r_start_position):(s.r_start_position=0,s.r_finish_position=t.rowKeys.length,s.r_finish_position,s.r_start_position),s.userData.pivot.fonts||(s.userData.pivot.fonts={data_font:{font_size:12,font_color:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal"},titles_font:{font_size:12,font_color:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold"},totals_font:{font_size:12,font_color:"#8c8c8c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold"}});var x,k,D,S,C,T,A,P,E,I,N,M,O,j,R,L,F={"font-size":s.userData.pivot.fonts.data_font.font_size,"font-family":s.userData.pivot.fonts.data_font.font_family,fill:s.userData.pivot.fonts.data_font.font_color,"font-weight":s.userData.pivot.fonts.data_font.font_weight,"font-style":s.userData.pivot.fonts.data_font.font_style,opacity:1},U=(s.userData.pivot.fonts.data_font.font_size,s.userData.pivot.fonts.data_font.font_family,s.userData.pivot.fonts.data_font.font_color,s.userData.pivot.fonts.data_font.font_weight,s.userData.pivot.fonts.data_font.font_style,{"font-size":s.userData.pivot.fonts.totals_font.font_size,"font-family":s.userData.pivot.fonts.totals_font.font_family,fill:s.userData.pivot.fonts.totals_font.font_color,"font-weight":s.userData.pivot.fonts.totals_font.font_weight,"font-style":s.userData.pivot.fonts.totals_font.font_style,opacity:1}),B={"font-size":s.userData.pivot.fonts.totals_font.font_size,"font-family":s.userData.pivot.fonts.totals_font.font_family,fill:s.userData.pivot.fonts.totals_font.font_color,"text-anchor":"start","font-weight":s.userData.pivot.fonts.totals_font.font_weight,"font-style":s.userData.pivot.fonts.totals_font.font_style,opacity:1},z={"font-size":s.userData.pivot.fonts.titles_font.font_size,"font-family":s.userData.pivot.fonts.titles_font.font_family,fill:s.userData.pivot.fonts.titles_font.font_color,"text-anchor":"end","font-weight":s.userData.pivot.fonts.titles_font.font_weight,"font-style":s.userData.pivot.fonts.titles_font.font_style,opacity:1},H={"font-size":s.userData.pivot.fonts.totals_font.font_size,"font-family":s.userData.pivot.fonts.totals_font.font_family,fill:s.userData.pivot.fonts.totals_font.font_color,"text-anchor":"end","font-weight":s.userData.pivot.fonts.totals_font.font_weight,"font-style":s.userData.pivot.fonts.totals_font.font_style,opacity:1},q={"font-size":s.userData.pivot.fonts.titles_font.font_size,"font-family":s.userData.pivot.fonts.titles_font.font_family,fill:s.userData.pivot.fonts.titles_font.font_color,"text-anchor":"start","font-weight":s.userData.pivot.fonts.titles_font.font_weight,"font-style":s.userData.pivot.fonts.titles_font.font_style,opacity:1},V={stroke:v,"stroke-width":3},W={stroke:v,"stroke-width":1},G={stroke:v,"stroke-width":2};PIVOT_DEBUG&&(g=performance.now(),y.push("pre phase "+(g-m))),0===(R=t.getRowKeys()).length&&R.push([]),0===(S=t.getColKeys()).length&&S.push([]),PIVOT_DEBUG&&(m=performance.now(),y.push("get rowKey, colKey "+(m-g))),O=t.rowAttrs,k=t.colAttrs;for(var J=!1,Q=!1,Y=0;Y<O.length;Y++)"task_name"===O[Y]&&(Q=!0);for(Y=0;Y<k.length;Y++)"task_name"===k[Y]&&(J=!0);var X=[],K=[],Z=[],$=c.text(0,0,"").attr(q).attr({opacity:0});if(O.length&&O.forEach((function(e,t){X.push(0),X[t]<O[t].length&&(X[t]=O[t].length)})),k.length&&k.forEach((function(e,t){$.attr({text:k[t]}),K.push([]),K[t].push($.getBBox().width+10+0)})),PIVOT_DEBUG)var ee=performance.now();if(R.forEach((function(e,t){e.forEach((function(e,t){X[t]<e.length&&(X[t]=e.length)})),Z[T]||Z.push([])})),PIVOT_DEBUG){var te=performance.now();y.push("get all rowKeys dimensions "+(te-ee))}var ae=[];X.forEach((function(e,t){$.attr({text:f}).attr(q).attr({opacity:0});var a=$.getBBox().width/92*1.25*X[t];a>w?ae.push(w):ae.push(a+0)}));var ne=50;if(s.userData.pivot.table.attrAreaWidth)ne=s.userData.pivot.table.attrAreaWidth;else if(O.length>0&&(ne=ae.reduce((function(e,t){return e+t}))),k.length>0){var oe=Math.max.apply(Math,K);ne=Math.max(ne,oe)}var ie,re,se,le,ce=0,ue=[];for(var de in ae)ue.push(ce),ce+=ae[de];le=s.userData.size.width-ne,ie=s.userData.showRowTotals?le/(o+1):le/o,$.attr({text:f}).attr(q).attr({opacity:0}),re=Math.round(ie/($.getBBox().width/92)),$.attr({text:f}).attr(F).attr({opacity:0}),se=Math.round(ie/($.getBBox().width/92));var pe=Math.max(s.userData.pivot.fonts.data_font.font_size,s.userData.pivot.fonts.totals_font.font_size,s.userData.pivot.fonts.titles_font.font_size)+10;s.userData.toolbar.show&&(b=40),c.setStart();var he,fe,me=0,ge=0,ye="Performance"===t.aggregatorName;function _e(e,t,a){if(t){if(e>t)return a.fill="green",{value_1:t,value_2:"(+"+Math.round(100*(e-t)/e).toString()+"%)",format:a};if(e<t)return a.fill="red",{value_1:t,value_2:"(-"+Math.round(100*(t-e)/t).toString()+"%)",format:a}}return{value_1:"NA",value_2:"NA",format:a}}function be(e,t){var a=Raphael.animation(function(e,t,a){return(t=function(e){var t=function(e){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=l(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==l(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({width:0},"width",t),200);e.animate(a.delay(100))}t.aggregatorName,PIVOT_DEBUG&&(g=performance.now(),y.push("get width, height "+(g-m)));var ve=f,we=c.text(0,0,ve).attr(q).attr({opacity:0}).getBBox().width/92,xe=w/we;function ke(a,n,o,r){for(var s,l,u,d,f,m,g,y=[],_=0,b=0;b<a.value().length;b++){var v="auto"===a.value()[b].width?r:a.value()[b].width;if(a.value()[b].show_progress)if(!a.value()[b].forecast||a.value()[b].hide_forecast||!a.value()[b].baseline||a.value()[b].hide_baseline)if(g=0,a.value()[b].forecast&&!a.value()[b].hide_forecast?g=a.value()[b].forecast:a.value()[b].baseline&&!a.value()[b].hide_baseline&&(g=a.value()[b].baseline),m=u=Math.round(a.value()[b].value/g*1e3)/10,isNaN(u)&&(u=0),isFinite(u)||(u=0),u>100&&(u=100,m=155),s=h?i.getColorDarker(m/100):"0-"+i.getColorLighter(m/100)+"-"+i.getColorDarker(m/100),l=.4,ot[n]||ot.push([]),ot[n][o]||ot[n].push([]),ot[n][o][b])ot[n][o][b].attr({x:ne+ie*o+_+1,y:p+2,width:v*(u/100),height:pe-4}),be(ot[n][o][b],v*(u/100));else{var w=c.rect(ne+ie*o+_+1,p+2,v*(u/100),pe-4).attr({stroke:"none",opacity:l,fill:s}).toFront();be(w,v*(u/100)),ot[n][o].push(w)}else{a.value()[b].forecast>=a.value()[b].baseline&&a.value()[b].forecast>=a.value()[b].value?(g=a.value()[b].forecast,u=Math.round(a.value()[b].value/g*1e3)/10,d=100,f=Math.round(a.value()[b].baseline/g*1e3)/10,m=u):a.value()[b].baseline>=a.value()[b].forecast&&a.value()[b].baseline>=a.value()[b].value?(g=a.value()[b].baseline,u=Math.round(a.value()[b].value/g*1e3)/10,d=Math.round(a.value()[b].forecast/g*1e3)/10,f=100,m=u):a.value()[b].value>=a.value()[b].baseline&&a.value()[b].value>=a.value()[b].forecast&&(g=a.value()[b].value,u=100,f=Math.round(a.value()[b].baseline/g*1e3)/10,d=Math.round(a.value()[b].forecast/g*1e3)/10,m=155),s=h?i.getColorDarker(m/100):"0-white-#4ae82e",l=.4;var x=c.rect(ne+ie*o+_+1,p+2,0,pe-4).attr({stroke:"none",opacity:1,fill:"45-white-#60acff"});be(x,v*(f/100)),be(c.rect(ne+ie*o+_+1,p+2,0,pe-4).attr({stroke:"none",opacity:1,fill:"0-white-#fd99ac"}),v*(d/100)),g===a.value()[b].forecast&&x.toFront(),be(c.rect(ne+ie*o+_+1,p+2,0,pe-4).attr({stroke:"none",opacity:l,fill:s}),v*(u/100))}var k=0;if(a.value()[b].baseline&&!a.value()[b].hide_baseline){var S=c.text(k+5+ne+ie*o+_,.5*it+p,a.value()[b].baseline+"/").attr(a.value()[b].value_format||format);y.push(S.attr({fill:"blue","font-weight":"bold"})),k+=S.getBBox().width}a.value()[b].forecast&&!a.value()[b].hide_forecast&&(S=c.text(k+5+ne+ie*o+_,.5*it+p,a.value()[b].forecast+"/").attr(a.value()[b].value_format||format),y.push(S.attr({fill:"#af414c","font-weight":"bold"})),k+=S.getBBox().width);var C=c.text(k+5+ne+ie*o+_,.5*it+p,a.value()[b].value).attr(a.value()[b].value_format||format);!function(a,n){e(C.node).on("contextmenu",(function(o,r){e.contextMenu({selector:"body",events:{hide:function(){e.contextMenu("destroy")}},callback:e.proxy((function(e,o){"exportToExcel"===e&&setTimeout((function(){var e=t.getAggregator(a,n).value(!0);i.exportArrayToExcel(e)}),10)}),this),x:o.originalEvent.screenX,y:o.originalEvent.screenY,items:{exportToExcel:{name:"Export To Excel"}}})}))}(j,D),y.push(C.toFront()),k+=C.getBBox().width,a.value()[b].forecast&&!a.value()[b].hide_forecast&&a.value()[b].baseline&&!a.value()[b].hide_baseline||a.value()[b].show_percents&&(a.value()[b].baseline&&!a.value()[b].hide_baseline&&(k+=(S=c.text(k+5+ne+ie*o+_,.5*it+p,": "+Math.round(1e3*a.value()[b].value/a.value()[b].baseline)/10+"%").attr(a.value()[b].value_format||format)).getBBox().width),a.value()[b].forecast&&!a.value()[b].hide_forecast&&(k+=(S=c.text(k+5+ne+ie*o+_,.5*it+p,": "+Math.round(1e3*a.value()[b].value/a.value()[b].forecast)/10+"%").attr(a.value()[b].value_format||format)).getBBox().width),S&&S.node&&e(S.node).css("text-decoration","underline"));var T=_e(a.value()[b].value,a.value()[b].last_value,a.value()[b].value_format);if(a.value()[b].last_value){var A=c.text(k+5+ne+0*ie+_,.5*it+p,": vs "+T.value_1).attr(a.value()[b].value_format||format);y.push(A),k+=A.getBBox().width,y.push(c.text(k+5+5+ne+0*ie+_,.5*it+p,T.value_2).attr(T.format||format))}_+=v}}function De(t,a,n,o,r){var s={fill:"#c8c8c8"},l={stroke:"none",opacity:1},c={stroke:"none",opacity:0};if(n.userData.aggregator.num_format&&n.userData.aggregator.num_format.heat_map)if(r&&r.indexOf("%")>-1){var u=parseFloat(r.replace("%",""));e.extend(l,{fill:i.getColorDarker(u/100)})}else e.extend(l,c);return n.userData.pivot.table.style.banded_rows?o?e.extend(l,c):t%2==0&&e.extend(l,s):n.userData.pivot.table.style.banded_cols&&(o?e.extend(l,c):a%2==0&&e.extend(l,s)),l}var Se=c.set();Se.push(c.text(60,12,"here is my popup text is").attr(q)).hide();var Ce=c.popup(100,100,Se,"right").attr({fill:"#eeeeee",stroke:"#666","stroke-width":2,"fill-opacity":1}).hide().toFront(),Te=0,Ae=0;Se[0].toFront();var Pe=function(e){var t=0,a=0;return e.replace(/[a-z]/gi,(function(e){return a+=++t&&e>"Z"})),1+(a/=t)*(.15*a)},Ee=s.getAbsoluteX(),Ie=s.getAbsoluteY(),Ne=function(){var a,n,u,d,h,f=!1;if(PIVOT_DEBUG){var m,g,y=[];g=performance.now()}for(xt=!0,p=b+pe*(k.length+1),Ue&&Ue.attr({fill:"none"}),T=s.r_start_position,N=0;T<s.r_finish_position;T++,N++){if(j=R[T],He=!0,PIVOT_DEBUG)var P,M=performance.now(),z=[];for(it=pe,rt=0,A=0;A<j.length;A++){E=j[A];var Y=Je.length&&Je[N-1]&&Je[N-1].length===j.length?Je[N-1][A].attr("text"):"";$="object"===l(E)?JSON.stringify(E,null,4):E.toString().replace(/(\r\n|\n|\r)/gm,""),Je[N]||Je.push([]),Qe[N]||Qe.push([]),Je[N][A]?Je[N][A].attr({text:$}):(s.userData.pivot.table.style.banded_cols?Qe[N].push(c.rect(ue[A],p,ae[A],it).attr(De(T,fe,s,!0))):Qe[N].push(c.rect(ue[A],p,ae[A],it).attr(De(T,fe,s,A!==j.length-1))),Je[N].push(c.text(5+ue[A],.5*it+p,$).attr(q))),(ze=Je[N][A].getBBox()).height>it&&(it=ze.height+8),Je[N][A].attr({y:.5*it+p}),Qe[N][A]&&Qe[N][A].attr({height:it,y:p});var X=Pe($.slice(0).substring(0,xe));if(ze.width>w)if(s.userData.pivot.table.do_not_wrap){var K=(" "+$).slice(1).substring(0,xe*X-3).concat("...");Je[N][A].attr({text:K}),function(e,t,a,n){Je[N][A].hover((function(){clearTimeout(h),Se[0].attr({text:a});var o=c.popup(e,t,Se,"right",1),i=Raphael.animation({path:o.path,transform:["t",o.dx+Ee,o.dy+Ie]},200*f);Te=Se[0].matrix.e+o.dx+Ee,Ae=Se[0].matrix.f+o.dy+Ie,Ce.show().stop().animate(i),Se[0].show().stop().animateWith(Ce,i,{transform:["t",Te,Ae]},200*f),n.attr({fill:"#bdf8ff"}),f=!0}),(function(){n.attr({fill:"#ffffff"}),h=setTimeout((function(){Ce.hide(),Se[0].hide(),f=!1}),1)}))}(Je[N][A].attr("x")+w-3,Je[N][A].attr("y"),$,xe,Qe[N][A]),(ze=Je[N][A].getBBox()).height>it&&(it=ze.height+8),Je[N][A].attr({y:.5*it+p}),Qe[N][A]&&Qe[N][A].attr({height:it,y:p})}else $=i.wrapTextChar($,xe),Je[N][A].attr({text:$}),(ze=Je[N][A].getBBox()).height>it&&(it=ze.height+8),Je[N][A].attr({y:.5*it+p}),Qe[N][A]&&Qe[N][A].attr({height:it,y:p});else!function(e,t,a,n){Je[N][A].hover((function(){clearTimeout(h),Se[0].attr({text:a});var o=c.popup(e,t,Se,"right",1);Raphael.animation({path:o.path,transform:["t",o.dx+Ee,o.dy+Ie]},200*f),Te=Se[0].matrix.e+o.dx+Ee,Ae=Se[0].matrix.f+o.dy+Ie,Ce.hide(),Se[0].hide(),n.attr({fill:"#bdf8ff"}),f=!0}),(function(){n.attr({fill:"#ffffff"}),h=setTimeout((function(){Ce.hide(),Se[0].hide(),f=!1}),1)}))}(Je[N][A].attr("x")+w-3,Je[N][A].attr("y"),$,Qe[N][A]);He&&Y===E.toString().replace(/(\r\n|\n|\r)/gm,"")?(rt=A+1,He=!0,Je[N][A].attr({opacity:0})):(He=!1,Je[N][A].attr({opacity:1}))}for(PIVOT_DEBUG&&(P=performance.now(),z.push("add row Attributes "+(P-M))),Ve[N]?Ve[N].attr({path:["M",ue[rt],p,"H",L].join(",")}).attr(1===j.length||A>=1?W:G):Ve.push(c.path(["M",ue[rt],p,"H",L].join(",")).attr(1===j.length||rt+1>=1?W:G)),PIVOT_DEBUG&&(M=performance.now(),z.push("add horizontal line "+(M-P))),Ke[N]||Ke.push([]),Ze[N]||Ze.push([]),$e[N]||$e.push([]),he=s.c_start_position,fe=0;he<s.c_finish_position;he++,fe++)if(D=S[he],void 0===Z[T][he]?(d=(x=t.getAggregator(j,D)).format(x.value()),Z[T].push(d)):d=Z[T][he],Ke[N][fe])0===d.indexOf('[{"')&&(d="Table"),Ze[N][fe].attr({height:it,y:p}).attr(De(N,fe,s,!1,d)),$e[N][fe].attr({height:it,y:p}),Ke[N][fe].attr({text:d.length>se?d.substring(0,se-3)+"...":d,y:.5*it+p}),function(a,n){e($e[N][fe].node).off("contextmenu"),e($e[N][fe].node).on("contextmenu",(function(o,r){e.contextMenu({selector:"body",events:{hide:function(){e.contextMenu("destroy")}},callback:e.proxy((function(e,o){switch(e){case"exportToExcel":setTimeout((function(){var e=t.getAggregator(a,n).value(!0);i.export2DArrayToExcel2(e)}),10);break;case"view":setTimeout((function(){var e=t.getAggregator(a,n).value(!0);s.sscope.editor.viewTable(e)}),10)}}),this),x:o.originalEvent.screenX,y:o.originalEvent.screenY,items:{exportToExcel:{name:"Export To Excel"},view:{name:"View"}}})}))}(j,D),function(a,n,o){e($e[N][fe].node).off("click"),e($e[N][fe].node).on("click",(function(e,i){Ue?(Ue.attr({fill:Be}),Be=o.attr("fill"),Ue=o):(Be=o.attr("fill"),Ue=o),o.attr({fill:"#a6cdff"});var r=[],l=t.getAggregator(a,n).value(!0),c={};O.forEach((function(e,t){c[e]=a[t]})),k.forEach((function(e,t){c[e]=n[t]})),r.push(c),"function"==typeof s.sendParams&&s.sendParams(r,l)}))}(j,D,Ze[N][fe]);else{var ee=_(N,he,Q,J);if(ye&&null!==x.value()){for(var te=0,oe=0,le=0;le<x.value().length;le++)"auto"!==x.value()[le].width?te+=x.value()[le].width:oe++;var ce=(ie-te)/oe;ke(x,N,fe,ce)}else n=c.rect(ne+ie*fe,p,ie,it).attr(De(N,fe,s,!1,d)),Ze[N].push(n),PIVOT_DEBUG&&console.time("value"),a=null,"[object String]"===Object.prototype.toString.call(d)&&0===d.indexOf('[{"')&&(d="Table"),a=c.text(ie/2+ne+ie*fe,.5*it+p,d.length>se?d.substring(0,se-3)+"...":d).attr(ee||F),PIVOT_DEBUG&&console.timeEnd("value"),u=c.rect(ne+ie*fe,p,ie,it).attr({fill:"transparent"}),$e[N].push(u),function(a,n){e(u.node).on("contextmenu",(function(o,r){e.contextMenu({selector:"body",events:{hide:function(){e.contextMenu("destroy")}},callback:e.proxy((function(e,o){switch(e){case"exportToExcel":setTimeout((function(){var e=t.getAggregator(a,n).value(!0);i.export2DArrayToExcel2(e)}),10);break;case"view":setTimeout((function(){var e;e=t.getAggregator(a,n).value(!0),s.sscope.editor.viewTable(e)}),10)}}),this),x:o.originalEvent.screenX,y:o.originalEvent.screenY,items:{exportToExcel:{name:"Export To Excel"},view:{name:"View"}}})}))}(j,D),function(a,n,o){e(u.node).on("click",(function(e,i){Ue?(Ue.attr({fill:Be}),Be=o.attr("fill"),Ue=o):(Be=o.attr("fill"),Ue=o),o.attr({fill:"#a6cdff"});var r=[],l=t.getAggregator(a,n).value(!0),c={};O.forEach((function(e,t){c[e]=a[t]})),k.forEach((function(e,t){c[e]=n[t]})),r.push(c),"function"==typeof s.sendParams&&s.sendParams(r,l)}))}(j,D,n),Ke[N].push(a)}PIVOT_DEBUG&&(P=performance.now(),z.push("add values area "+(P-M)));var de=s.userData.showRowTotals||void 0===s.userData.showRowTotals;x=t.getAggregator(j,[]),et[N]?(tt[N].attr({height:it,y:p}),et[N].attr({x:5+ne+ie*o,y:.5*it+p,text:de?x.format(x.value()):""})):ye&&de?ke(x=t.getAggregator(j,D=[]),N,fe,ce):(s.userData.pivot.table.style.banded_cols||(n=c.rect(ne+ie*fe,p,ie,it).attr(De(N,fe,s,!s.userData.showRowTotals))),tt.push(n),a=c.text(5+ne+ie*o,.5*it+p,de?x.format(x.value()):"").attr(B),et.push(a),function(n){r([],0),e(a.node).on("contextmenu",(function(a,o){e.contextMenu({selector:"body",events:{hide:function(){e.contextMenu("destroy")}},callback:e.proxy((function(e,a){"exportToExcel"===e&&setTimeout((function(){var e=t.getAggregator(n,[]).value(!0);i.exportArrayToExcel(e)}),10)}),this),x:a.originalEvent.screenX,y:a.originalEvent.screenY,items:{exportToExcel:{name:"Export To Excel"}}})})),e(a.node).on("mousewheel",Et)}(j)),PIVOT_DEBUG&&(M=performance.now(),z.push("add row_total value "+(M-P)),console.log("Values and all update details: "+z)),p+=it}PIVOT_DEBUG&&(m=performance.now(),y.push("add values and all "+(m-g)));for(var he=s.c_start_position,fe=0;he<s.c_finish_position;he++,fe++){var me;for(D=S[he],He=!0,st=0,C=0;C<D.length;C++){var ge;Ye[fe]||Ye.push([]),Xe[fe]||Xe.push([]),at[fe]||at.push([]),Xe[fe][C]||Xe[fe].push(D[C]),E=D[C],me=Ye.length&&Xe[fe-1]&&Ye[fe-1].length===D.length?Ye[fe-1][C].attr("text"):"",re<E.length&&C===D.length-1?(I=E.substring(0,re-2)+"...",ge=!0):I=E,Ye[fe][C]?Ye[fe][C].attr({text:I}):(s.userData.pivot.table.style.banded_rows||C!==D.length-1||at[fe].push(c.rect(ne+ie*fe,b+C*pe,ie,it).attr(De(N,fe,s,!1))),Ye[fe].push(c.text(5+ne+ie*fe,b+.5*pe+C*pe,I).attr(q))),ge?function(e,t,a){Ye[fe][C].hover((function(){clearTimeout(h),Se[0].attr({text:a});var n=c.popup(e,t,Se,"right",1),o=Raphael.animation({path:n.path,transform:["t",n.dx+Ee,n.dy+Ie]},200*f);Te=Se[0].matrix.e+n.dx+Ee,Ae=Se[0].matrix.f+n.dy+Ie,Ce.show().stop().animate(o),Se[0].show().stop().animateWith(Ce,o,{transform:["t",Te,Ae]},200*f),f=!0}),(function(){h=setTimeout((function(){Ce.hide(),Se[0].hide(),f=!1}),1)}))}(Ye[fe][C].attr("x")+ie-5,Ye[fe][C].attr("y"),E):function(e,t,a){Ye[fe][C].hover((function(){clearTimeout(h),Se[0].attr({text:a}),Ce.hide(),Se[0].hide()}),(function(){}))}(Ye[fe][C].attr("x"),Ye[fe][C].attr("y"),i.wrapTextChar(E,xe)),He&&me===E?(He=!0,st=C+1,Ye[fe][C].attr({opacity:0})):(He=!1,Ye[fe][C].attr({opacity:1}))}if(We[fe]?We[fe].attr({path:["M",ne+ie*fe,b+st*pe,"V",p+pe+pe*qe+1].join(",")}).attr(0===st?G:W):We.push(c.path(["M",ne+ie*fe,b+st*pe,"V",p+pe+pe*qe+1].join(",")).attr(0===st?G:W)),s.userData.showColTotals||void 0===s.userData.showColTotals)if(ye){ke(x=t.getAggregator(j=[],D),N,fe,ce);var _e=0;for(le=0;le<x.value().length;le++){var be="auto"===x.value()[le].width?ce:x.value()[le].width;c.path(["M",ne+ie*fe+_e,b+kt*pe,"v",p-(b+k.length*pe)+pe].join(",")).attr({stroke:"#000","stroke-width":1}),c.text(ne+ie*fe+_e+1+5,b+.5*pe+kt*pe,x.value()[le].name).attr(x.value()[le].label_format||ee),_e+=be}}else x=t.getAggregator([],D),nt[fe]?nt[fe].attr({x:ie/2+ne+ie*fe,y:p+.5*pe,text:x.format(x.value())}).attr(U):(a=c.text(ie/2+ne+ie*fe,p+.5*pe,x.format(x.value())).attr(U),function(n,o){r([],0),e(a.node).on("contextmenu",(function(a,n){e.contextMenu({selector:"body",events:{hide:function(){e.contextMenu("destroy")}},callback:e.proxy((function(e,a){"exportToExcel"===e&&setTimeout((function(){var e=t.getAggregator([],o).value(!0);i.exportArrayToExcel(e)}),10)}),this),x:a.originalEvent.screenX,y:a.originalEvent.screenY,items:{exportToExcel:{name:"Export To Excel"}}})}))}(0,D),nt.push(a))}PIVOT_DEBUG&&(g=performance.now(),y.push("add col keys labels "+(g-m)));for(var ve=0,we=O.length;ve<we;ve++)Ge[ve]?Ge[ve].attr({path:["M",ue[ve],b+pe*k.length,"v",-b+p+pe+pe*qe-pe*k.length+1].join(",")}):Ge.push(c.path(["M",ue[ve],b+pe*k.length,"v",-b+p+pe+pe*qe-pe*k.length+1].join(",")).attr(G));PIVOT_DEBUG&&(m=performance.now(),y.push("add row attributes "+(m-g))),(s.userData.showRowTotals&&s.userData.showColTotals||void 0===s.userData.showRowTotals&&void 0===s.userData.showColTotals)&&(x=t.getAggregator([],[]),ye?ke(x,N,fe,ce):Re?Re.attr({x:5+ne+ie*o,y:p+.5*pe,text:x.format(x.value())}):(Re=c.text(5+ne+ie*o,p+.5*pe,x.format(x.value())).attr(B),e(Re.node).on("contextmenu",(function(a,n){e.contextMenu({selector:"body",events:{hide:function(){e.contextMenu("destroy")}},callback:e.proxy((function(e,a){"exportToExcel"===e&&setTimeout((function(){var e=t.getAggregator([],[]).value(!0);i.exportArrayToExcel(e)}),10)}),this),x:a.originalEvent.screenX,y:a.originalEvent.screenY,items:{exportToExcel:{name:"Export To Excel"}}})})))),PIVOT_DEBUG&&(g=performance.now(),y.push("add grand total "+(g-m))),Me?Me.attr({path:["M",ne+ie*o,b,"L",ne+ie*o,p+pe+pe*qe+1].join(",")}):Me=c.path(["M",ne+ie*o,b,"L",ne+ie*o,p+pe+pe*qe+1].join(",")).attr(V).attr({cursor:"col-resize"}),PIVOT_DEBUG&&(m=performance.now(),y.push("add row_total vert line "+(m-g))),je?je.attr({path:["M",ne,b,"L",ne,p+pe+pe*qe+1].join(",")}):je=c.path(["M",ne,b,"L",ne,p+pe+pe*qe+1].join(",")).attr(V).attr({cursor:"col-resize"}),PIVOT_DEBUG&&(g=performance.now(),y.push("add data area vert line "+(g-m))),Oe?Oe.attr({path:["M",0,p,"L",L+1,p].join(",")}):Oe=c.path(["M",0,p,"L",L+1,p].join(",")).attr(V),PIVOT_DEBUG&&(m=performance.now(),y.push("add col total hor line "+(m-g))),(s.userData.showColTotals||void 0===s.userData.showColTotals)&&(Le?Le.attr({x:ne-5,y:p+.5*pe}):Le=c.text(ne-5,p+.5*pe,void 0===s.userData.aggregator.t_col_type||"sum"===s.userData.aggregator.t_col_type?"total":s.userData.aggregator.t_col_type).attr(H)),PIVOT_DEBUG&&(g=performance.now(),y.push("add col total line label "+(g-m))),Fe&&Fe.attr({stroke:v,height:p+pe+pe*qe+1-b}),PIVOT_DEBUG&&(m=performance.now(),y.push("reset scroll area "+(m-g)),console.log(y)),Ce.toFront(),Se.toFront(),xt=!1};L=s.userData.size.width;var Me,Oe,je,Re,Le,Fe,Ue,Be,ze,He,qe=s.userData.showColTotals||void 0===s.userData.showColTotals?0:-1,Ve=[],We=[],Ge=[],Je=[],Qe=[],Ye=[],Xe=[],Ke=[],Ze=[],$e=[],et=[],tt=[],at=[],nt=[],ot=[],it=pe,rt=0,st=0;Fe||(Fe=c.rect(0,b,s.userData.size.width,0).attr({fill:"transparent"})),PIVOT_DEBUG&&(m=performance.now(),y.push("add top... "+(m-g))),[].forEach((function(e){e.toFront()}));var lt,ct,ut,dt,pt,ht,ft,mt,gt,yt,_t,bt,vt,wt,xt=!1;Ne();for(var kt=0;kt<k.length;kt++)c.text(ne-5-0,b+.5*pe+kt*pe,k[kt]).attr(z),c.path(["M",ne,b+(kt+1)*pe,"H",s.userData.showRowTotals?L-ie:L].join(",")).attr(W);for(Y=0,P=O.length;Y<P;Y++)M=O[Y],c.text(5+ue[Y],b+.5*pe+pe*k.length,M).attr(q);function Dt(e){ct&&(ct.attr({y:dt+ut*e}),ht=e)}function St(e){mt&&(mt.attr({x:yt+gt*e}),bt=e)}c.path(["M",0,b+pe*k.length,"h",L+1].join(",")).attr(V),c.path(["M",0,b+pe*(k.length+1),"L",L+1,b+pe*(k.length+1)].join(",")).attr(V),s.userData.showRowTotals||void 0===s.userData.showRowTotals?c.text(5+ne+ie*o,b+.5*pe+pe*k.length,void 0===s.userData.aggregator.t_row_type||"sum"===s.userData.aggregator.t_row_type?"total":s.userData.aggregator.t_row_type).attr(B):c.text(5+ne+ie*o,b+.5*pe+pe*k.length,"").attr(B),PIVOT_DEBUG&&(g=performance.now(),y.push("update data "+(g-m))),s.userData.pivot.table.rows&&!s.userData.pivot.table.hide_vert_scroll_bar&&R.length>s.userData.pivot.table.rows&&(ct||(lt=Math.max(Math.round(s.userData.pivot.table.rows*s.userData.pivot.table.rows*it/R.length),30),ct=c.rect(s.userData.size.width-11,b+(k.length+1)*it,10,lt,5).attr({fill:"rgba(0,0,0,0.33)",stroke:"none"}),ht=s.r_start_position,dt=ct.attr("y"),pt=b+(k.length+1+s.userData.pivot.table.rows)*it-lt,ut=(pt-dt)/(R.length-s.userData.pivot.table.rows),ct.drag((function(e,t,a,n,o){o.stopImmediatePropagation(),ct&&ct.attr({y:Math.min(Math.max(vt+t,dt),pt)});var i=Math.min(Math.max(vt+t,dt),pt)-dt,r=Math.round(i/ut);i>=0&&r!==ht?(s.r_start_position=r,s.r_finish_position=s.r_start_position+s.userData.pivot.table.rows,ht=s.r_start_position,xt||Ne()):s.r_start_position=Math.round(i/ut)}),(function(e,t,a){vt=ct.attr("y"),s.dragIsLocked=!0}),(function(e){s.dragIsLocked=!1}))),Dt(s.r_start_position)),s.userData.pivot.table.columns&&!s.userData.pivot.table.hide_hor_scroll_bar&&S.length>s.userData.pivot.table.columns&&(mt||(ft=Math.max(Math.round(20,s.userData.pivot.table.columns*le/S.length),40),mt=c.rect(ne,p-10,ft,10,5).attr({fill:"rgba(0,0,0,0.33)",stroke:"none"}),bt=s.c_start_position,yt=mt.attr("x"),_t=ne+ie*s.userData.pivot.table.columns-ft,gt=(_t-yt)/(S.length-s.userData.pivot.table.columns),mt.drag((function(e,t,a,n,o){o.stopImmediatePropagation(),mt&&mt.attr({x:Math.min(Math.max(wt+e,yt),_t)});var i=Math.min(Math.max(wt+e,yt),_t)-yt,r=Math.round(i/gt);i>=0&&r!==bt?(s.c_start_position=r,s.c_finish_position=s.c_start_position+s.userData.pivot.table.columns,bt=s.c_start_position,xt||Ne()):s.c_start_position=Math.round(i/gt)}),(function(e,t,a){wt=mt.attr("x"),s.dragIsLocked=!0}),(function(e){s.dragIsLocked=!1}))),St(s.c_start_position));var Ct=c.setFinish();Ct.push((0,n.c1)(c,s,t,Ne)),u&&s.setNewData(Ct);var Tt=t.getAggregator(R[0],S[0]).value(!0),At={};O.forEach((function(e,t){At[e]=R[0][t]})),k.forEach((function(e,t){At[e]=S[0][t]}));var Pt=[];Pt.push(At),"function"==typeof s.sendParams&&s.sendParams(Pt,Tt);var Et=function(e){me=e.deltaX,ge=e.deltaY,s.userData.pivot.table.hide_hor_scroll_bar||(me>0?(s.c_finish_position<S.length&&(s.c_start_position++,s.c_finish_position++,Ne(),St(s.c_start_position)),me=0):(s.c_start_position>0&&(s.c_start_position--,s.c_finish_position--,Ne(),St(s.c_start_position)),me=0)),s.userData.pivot.table.hide_vert_scroll_bar||(ge>0?(s.r_finish_position<R.length&&(s.r_start_position++,s.r_finish_position++,Ne(),Dt(s.r_start_position)),ge=0):(s.r_start_position>0&&(s.r_start_position--,s.r_finish_position--,Ne(),Dt(s.r_start_position)),ge=0)),e.preventDefault()};return e(Fe.node).on("mousewheel",Et),e(Fe.node).on("contextmenu",(function(t,a){e.contextMenu({selector:"body",events:{hide:function(){e.contextMenu("destroy")}},callback:e.proxy((function(e,t){"toogleCon"===e&&setTimeout((function(){s.toogleInConn()}),10)}),this),x:t.originalEvent.screenX,y:t.originalEvent.screenY,items:{toogleCon:s.userData.showInConnections?{name:"Hide Connections"}:{name:"Show Connections"}}})})),Fe.mouseover((function(e){me=0,ge=0})),Fe.touchstart((function(e){he=e.touches[0].clientX,fe=e.touches[0].clientY})),Fe.touchmove((function(e){e.stopPropagation();var t=he-e.touches[0].clientX,a=fe-e.touches[0].clientY;Math.abs(t)>5&&(t>0?s.c_finish_position<S.length&&(s.c_start_position++,s.c_finish_position++,Ne(),he=e.touches[0].clientX):s.c_start_position>0&&(s.c_start_position--,s.c_finish_position--,Ne(),he=e.touches[0].clientX)),Math.abs(a)>5&&(a>0?s.r_finish_position<R.length&&(s.r_start_position++,s.r_finish_position++,Ne(),fe=e.touches[0].clientY):s.r_start_position>0&&(s.r_start_position--,s.r_finish_position--,Ne(),fe=e.touches[0].clientY))})),$="Pivot Ra Power",PIVOT_DEBUG&&(m=performance.now(),y.push("finish "+(m-g)),console.log(y)),$}}},"object"===("undefined"==typeof exports?"undefined":l(exports))&&"object"===l(e)?t(a("a45670b3d8fb79ec0258")):"function"==typeof define&&a.amdO?define(["jquery"],t):t(o)}).call(void 0)},"493d9fae3cf8c8c702ff":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.label.Today=n.shape.basic.Label.extend({NAME:"draw2d.shape.fishbone.label.Today",INFO:"{Class: <strong>draw2d.shape.fishbone.label.Today</strong>}<br/><br/>",init:function(e,t,a){this._super(o.extend({color:"rgba(255, 255, 255, 0)",radius:10,padding:10,stroke:1},e),t,a);var n=this.getUserData(),i=new Date,r=this;null===n&&this.attr({userData:{hidden:!1,index:0,today:i.toLocaleDateString(),font:{font_size:18,font_color:"#000",font_family:"Tahoma, Geneva",font_bold:!0},back_color:"",frame_size:0,frame_color:"#989799",padding:10}}),this.setParams=function(){r.setFontSize(this.userData.font.font_size),r.setFontColor(this.userData.font.font_color),r.setFontFamily(this.userData.font.font_family),r.setBackgroundColor(""===this.userData.back_color?null:this.userData.back_color),r.setStroke(this.userData.frame_size),r.setColor(this.userData.frame_color),r.setPadding(this.userData.padding),r.setBold(this.userData.font.font_bold)},this.setParams(),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0},today:{type:"string",title:"Current Date",format:"date",default:""},font:{type:"object",additionalProperties:!1,properties:{font_size:{type:"integer",title:"Font Size",default:24},font_color:{type:"string",title:"Font Color",default:"#000"},font_family:{type:"string",title:"Font Family",default:"Tahoma, Geneva"},font_bold:{type:"boolean",title:"Font Bold",default:!1}}},back_color:{type:"string",title:"Back Color"},frame_size:{type:"integer",title:"Frame Size",default:1},frame_color:{type:"string",title:"Frame Color",default:"#989799"},padding:{type:"integer",title:"Padding",default:10}}},this.GetHTTPData=function(){this.setParams()},this.startTimer(1e3)},onTimer:function(){var e=new Date;this.setText(e.toLocaleDateString())}})},"4e8cf7378c0b5fa93e9c":(e,t,a)=>{var n=a("8a868d10b6533e768658");n.layout.locator.XYLogPortLocator=n.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.XYLogPortLocator",init:function(e,t){this._super(),this.x=e||0,this.y=t||0},relocate:function(e,t){this.applyConsiderRotation(t,this.x,this.y)}})},"4fc010ae914d93447b01":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var draw2d=__webpack_require__("8a868d10b6533e768658");draw2d.Connection=draw2d.shape.basic.PolyLine.extend({NAME:"draw2d.Connection",init:function(e,t,a){this.sourcePort=null,this.targetPort=null,this.oldPoint=null,this.sourceDecorator=null,this.targetDecorator=null,this.sourceDecoratorNode=null,this.targetDecoratorNode=null,this.isMoving=!1;var n=this;this.moveListener=function(e){e===n.sourcePort?n.setStartPoint(n.sourcePort.getAbsoluteX(),n.sourcePort.getAbsoluteY()):n.setEndPoint(n.targetPort.getAbsoluteX(),n.targetPort.getAbsoluteY())},this._super(extend({color:"#129CE4",stroke:2,radius:3},e),extend({sourceDecorator:this.setSourceDecorator,targetDecorator:this.setTargetDecorator,source:this.setSource,target:this.setTarget},t),extend({sourceDecorator:this.getSourceDecorator,targetDecorator:this.getTargetDecorator,source:this.getSource,target:this.getTarget},a))},disconnect:function(){null!==this.sourcePort&&(this.sourcePort.off(this.moveListener),this.sourcePort.connections.remove(this),this.sourcePort.fireEvent("disconnect",{port:this.sourcePort,connection:this}),null!==this.canvas&&this.canvas.fireEvent("disconnect",{port:this.sourcePort,connection:this}),this.sourcePort.onDisconnect(this),this.fireSourcePortRouteEvent()),null!==this.targetPort&&(this.targetPort.off(this.moveListener),this.targetPort.connections.remove(this),this.targetPort.fireEvent("disconnect",{port:this.targetPort,connection:this}),null!==this.canvas&&this.canvas.fireEvent("disconnect",{port:this.targetPort,connection:this}),this.targetPort.onDisconnect(this),this.fireTargetPortRouteEvent())},reconnect:function(){null!==this.sourcePort&&(this.sourcePort.on("move",this.moveListener),this.sourcePort.connections.add(this),this.sourcePort.fireEvent("connect",{port:this.sourcePort,connection:this}),null!==this.canvas&&this.canvas.fireEvent("connect",{port:this.sourcePort,connection:this}),this.sourcePort.onConnect(this),this.fireSourcePortRouteEvent()),null!==this.targetPort&&(this.targetPort.on("move",this.moveListener),this.targetPort.connections.add(this),this.targetPort.fireEvent("connect",{port:this.targetPort,connection:this}),null!==this.canvas&&this.canvas.fireEvent("connect",{port:this.targetPort,connection:this}),this.targetPort.onConnect(this),this.fireTargetPortRouteEvent()),this.routingRequired=!0,this.repaint()},isResizeable:function(){return this.isDraggable()},add:function(e,t,a){if(!(t instanceof draw2d.layout.locator.ConnectionLocator))throw"Locator must implement the class draw2d.layout.locator.ConnectionLocator";this._super(e,t,a)},setSourceDecorator:function(e){this.sourceDecorator=e,this.routingRequired=!0,null!==this.sourceDecoratorNode&&(this.sourceDecoratorNode.remove(),this.sourceDecoratorNode=null),this.repaint()},getSourceDecorator:function(){return this.sourceDecorator},setTargetDecorator:function(e){this.targetDecorator=e,this.routingRequired=!0,null!==this.targetDecoratorNode&&(this.targetDecoratorNode.remove(),this.targetDecoratorNode=null),this.repaint()},getTargetDecorator:function(){return this.targetDecorator},calculatePath:function(e){return null===this.sourcePort||null===this.targetPort||(this._super(e),null!==this.shape&&(this.sourcePort.getZOrder()<this.targetPort.getZOrder()?this.toBack(this.sourcePort):this.toBack(this.targetPort))),this},repaint:function(e){!0!==this.repaintBlocked&&null!==this.shape&&null!==this.sourcePort&&null!==this.targetPort&&this._super(e)},getAbsoluteX:function(){return 0},getAbsoluteY:function(){return 0},postProcess:function(e){this.router.postProcess(this,this.getCanvas(),e)},onDrag:function(e,t,a,n){if(null!==this.command){this.router.onDrag(this,e,t,a,n),this.command.updateVertices(this.getVertices().clone());var o=this;this.editPolicy.each((function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.onDrag(o.canvas,o)})),this.svgPathString=null,this.repaint(),this.editPolicy.each((function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(o.canvas,o)})),this.fireEvent("move",{figure:this,dx:e,dy:e})}},toFront:function(e){return this._super(e),null!==this.shape&&(null!==this.targetDecoratorNode&&this.targetDecoratorNode.insertAfter(this.shape),null!==this.sourceDecoratorNode&&this.sourceDecoratorNode.insertAfter(this.shape)),this},toBack:function(e){return this._super(e),null!==this.shape&&(null!==this.targetDecoratorNode&&this.targetDecoratorNode.insertAfter(this.shape),null!==this.sourceDecoratorNode&&this.sourceDecoratorNode.insertAfter(this.shape)),this},getStartPoint:function(e){return this.getStartPosition(e)},getStartPosition:function(e){return!1===this.isMoving?e?this.sourcePort.getConnectionAnchorLocation(e,this):this.sourcePort.getConnectionAnchorLocation(this.targetPort.getConnectionAnchorReferencePoint(this),this):this._super()},getEndPoint:function(e){return this.getEndPosition(e)},getEndPosition:function(e){return!1===this.isMoving?e?this.targetPort.getConnectionAnchorLocation(e,this):this.targetPort.getConnectionAnchorLocation(this.sourcePort.getConnectionAnchorReferencePoint(this),this):this._super()},setSource:function(e){null!==this.sourcePort&&(this.sourcePort.off(this.moveListener),this.sourcePort.connections.remove(this),this.sourcePort.fireEvent("disconnect",{port:this.sourcePort,connection:this}),null!==this.canvas&&this.canvas.fireEvent("disconnect",{port:this.sourcePort,connection:this}),this.sourcePort.onDisconnect(this)),this.sourcePort=e,null!==this.sourcePort&&(this.routingRequired=!0,this.fireSourcePortRouteEvent(),this.sourcePort.connections.add(this),this.sourcePort.on("move",this.moveListener),null!==this.canvas&&this.canvas.fireEvent("connect",{port:this.sourcePort,connection:this}),this.sourcePort.fireEvent("connect",{port:this.sourcePort,connection:this}),this.sourcePort.onConnect(this),this.setStartPoint(e.getAbsoluteX(),e.getAbsoluteY()),this.fireEvent("connect",{port:this.sourcePort,connection:this}))},getSource:function(){return this.sourcePort},setTarget:function(e){null!==this.targetPort&&(this.targetPort.off(this.moveListener),this.targetPort.connections.remove(this),this.targetPort.fireEvent("disconnect",{port:this.targetPort,connection:this}),null!==this.canvas&&this.canvas.fireEvent("disconnect",{port:this.targetPort,connection:this}),this.targetPort.onDisconnect(this)),this.targetPort=e,null!==this.targetPort&&(this.routingRequired=!0,this.fireTargetPortRouteEvent(),this.targetPort.connections.add(this),this.targetPort.on("move",this.moveListener),null!==this.canvas&&this.canvas.fireEvent("connect",{port:this.targetPort,connection:this}),this.targetPort.fireEvent("connect",{port:this.targetPort,connection:this}),this.targetPort.onConnect(this),this.setEndPoint(e.getAbsoluteX(),e.getAbsoluteY()),this.fireEvent("connect",{port:this.targetPort,connection:this}))},getTarget:function(){return this.targetPort},sharingPorts:function(e){return this.sourcePort==e.sourcePort||this.sourcePort==e.targetPort||this.targetPort==e.sourcePort||this.targetPort==e.targetPort},setCanvas:function(e){if(this.canvas!==e){var t=null==this.canvas?e:this.canvas;this._super(e),null!==e&&null===draw2d.Connection.DROP_FILTER&&(draw2d.Connection.DROP_FILTER=e.paper.createFilter(),draw2d.Connection.DROP_FILTER.element.setAttribute("width","250%"),draw2d.Connection.DROP_FILTER.element.setAttribute("height","250%"),draw2d.Connection.DROP_FILTER.createShadow(1,1,2,.3)),null!==this.sourceDecoratorNode&&(this.sourceDecoratorNode.remove(),this.sourceDecoratorNode=null),null!==this.targetDecoratorNode&&(this.targetDecoratorNode.remove(),this.targetDecoratorNode=null),null===this.canvas?(null!==this.sourcePort&&(this.sourcePort.off(this.moveListener),t.fireEvent("disconnect",{port:this.sourcePort,connection:this}),this.sourcePort.onDisconnect(this)),null!==this.targetPort&&(this.targetPort.off(this.moveListener),t.fireEvent("disconnect",{port:this.targetPort,connection:this}),this.targetPort.onDisconnect(this))):(this.shape.items[0].filter(draw2d.Connection.DROP_FILTER),null!==this.sourcePort&&(this.sourcePort.on("move",this.moveListener),this.canvas.fireEvent("connect",{port:this.sourcePort,connection:this}),this.sourcePort.onConnect(this)),null!==this.targetPort&&(this.targetPort.on("move",this.moveListener),this.canvas.fireEvent("connect",{port:this.targetPort,connection:this}),this.targetPort.onConnect(this)))}},getStartAngle:function(){if(0===this.lineSegments.getSize())return 0;var e=this.lineSegments.get(0).start,t=this.lineSegments.get(0).end;this.router instanceof draw2d.layout.connection.SplineConnectionRouter&&(t=this.lineSegments.get(5).end);var a=Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)),n=-180/Math.PI*Math.asin((e.y-t.y)/a);return n<0?n=t.x<e.x?Math.abs(n)+180:360-Math.abs(n):t.x<e.x&&(n=180-n),n},getEndAngle:function(){if(0===this.lineSegments.getSize())return 90;var e=this.lineSegments.get(this.lineSegments.getSize()-1).end,t=this.lineSegments.get(this.lineSegments.getSize()-1).start;this.router instanceof draw2d.layout.connection.SplineConnectionRouter&&(t=this.lineSegments.get(this.lineSegments.getSize()-5).end);var a=Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)),n=-180/Math.PI*Math.asin((e.y-t.y)/a);return n<0?n=t.x<e.x?Math.abs(n)+180:360-Math.abs(n):t.x<e.x&&(n=180-n),n},fireSourcePortRouteEvent:function(){this.sourcePort.getConnections().each((function(e,t){t.routingRequired=!0,t.repaint()}))},fireTargetPortRouteEvent:function(){this.targetPort.getConnections().each((function(e,t){t.routingRequired=!0,t.repaint()}))},createCommand:function(e){return e.getPolicy()===draw2d.command.CommandType.MOVE&&this.isDraggable()?new draw2d.command.CommandMoveVertices(this):e.getPolicy()===draw2d.command.CommandType.MOVE_BASEPOINT?new draw2d.command.CommandReconnect(this):this._super(e)},getPersistentAttributes:function(){for(var e=this._super(),t=this.getSource().getParent();null!==t.getParent();)t=t.getParent();for(e.source={node:t.getId(),port:this.getSource().getName()},t=this.getTarget().getParent();null!==t.getParent();)t=t.getParent();return e.target={node:t.getId(),port:this.getTarget().getName()},null!==this.sourceDecorator&&(e.source.decoration=this.sourceDecorator.NAME),null!==this.targetDecorator&&(e.target.decoration=this.targetDecorator.NAME),e},setPersistentAttributes:function setPersistentAttributes(memento){this._super(memento),void 0!==memento.target.decoration&&null!=memento.target.decoration&&this.setTargetDecorator(eval("new "+memento.target.decoration)),void 0!==memento.source.decoration&&null!=memento.source.decoration&&this.setSourceDecorator(eval("new "+memento.source.decoration))}}),draw2d.Connection.DROP_FILTER=null},"514c4849ae36c761f260":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca");n.shape.fishbone.cell.YesNOnode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.YesNOnode",INFO:"{Class: <strong>YesNOnode</strong>}<br/><br/> <strong>Code </strong><cite>Node </cite>Provide simple selection based on YES/NO question<br/><br/><strong>Configuration: </strong>",init:function(e,t,a,r){this._super(o.extend({color:"#777777",items:{}},e),t,a,r);var s=this;this.sites_list_in=[],o.extend(this.userData,{query:"",label:"New Label",type_name:"yesno"}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{query:{type:"string",title:"Query",default:"Yes or No?"},label:{type:"string",format:"hidden",default:""},type_name:{type:"string",title:"Type Name",default:"gap"}}}),this.getRealCount=function(){return 1},this.GetHTTPData=function(){s.startTimer(),s.userData.sites_list_out=this.sites_list_in,s.userData.value=s.userData.sites_list_out.length;var e=s.getPort("output_yes"),t=s.getPort("output_no");i.bsToast.question({rtl:!1,layout:1,drag:!1,timeout:!1,close:!1,overlay:!0,displayMode:1,id:"question",progressBar:!0,title:"Hey",message:s.userData.query,position:"center",buttons:[["<button><b>YES</b></button>",function(t,a){s.getOutputPort("output_yes").getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.userData||(a.userData={}),a.userData.realCount=s.getRealCount(),a.setValue("ticket,"+s.id+","+s.userData.label),s.getCanvas().silentMode||t.setColor("#dfdfdf")}),s)),e.setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label,task_type:s.userData.type_name||"yesno",sites_list_out:s.userData.sites_list_out}),e.getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.setValue(s.getId()),i.getMessage(s,a,"data send to"),t.setColor(s.frame.attr("stroke"))}),this)),t.hide({transitionOut:"fadeOut"},a,"button")},!0],["<button>NO</button>",function(e,a){s.getOutputPort("output_no").getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.userData||(a.userData={}),a.userData.realCount=s.getRealCount(),a.setValue("ticket,"+s.id+","+s.userData.label),s.getCanvas().silentMode||t.setColor("#dfdfdf")}),s)),t.setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label,task_type:s.userData.type_name||"yesno",sites_list_out:s.userData.sites_list_out}),t.getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.setValue(s.getId()),i.getMessage(s,a,"data send to"),t.setColor(s.frame.attr("stroke"))}),this)),e.hide({transitionOut:"fadeOut"},a,"button")}]],onClosing:function(e,t,a){},onClosed:function(e,t,a){}}),s.stopTimer(),s.updateUI()};var l=null;(l=new n.OutputPort).setBackgroundColor("#009adc"),l.setName("output_yes"),this.addPort(l);var c=null;(c=new n.OutputPort).setBackgroundColor("#d73a00"),c.setName("output_no"),this.addPort(c);var u=null;(u=new n.DataInputPort).setConnectionDirection(3),u.setBackgroundColor("#26cc00"),u.setName("dataInput"),this.addPort(u),this.setDimension(this.width,this.height),this.layoutPorts()},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText("Decision"),this.filter_label.setText("YES/NO"),this._super(this)},onPortValueChanged:function(e){var t=this,a=this.getInputPort(0).getConnections().data[0].getSource();e.getValue().indexOf("ticket")>-1?"dataInput"===e.name&&(t.project=a.getUserData().project,t.scope=a.getUserData().scope,t.getOutputPorts().data.forEach((function(a,n){a.getConnections().each(o.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),o.superUpdate=!!e.superUpdate,i.getMessage(t,e,"ticket send to"),o.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||n.setColor("#dfdfdf")}),this))}))):"dataInput"===e.name&&(this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.GetHTTPData())}})},"52e0d1661508b2d89b12":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("purple-passion",{color:["#9b8bba","#e098c7","#8fd3e8","#71669e","#cc70af","#7cb4cc"],backgroundColor:"rgba(91,92,110,1)",textStyle:{},title:{textStyle:{color:"#ffffff"},subtextStyle:{color:"#cccccc"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"7",symbol:"circle",smooth:!0},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"7",symbol:"circle",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#e098c7",color0:"transparent",borderColor:"#e098c7",borderColor0:"#8fd3e8",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:"7",symbol:"circle",smooth:!0,color:["#9b8bba","#e098c7","#8fd3e8","#71669e","#cc70af","#7cb4cc"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#eee",borderColor:"#444",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#e098c7",borderColor:"#444",borderWidth:1},label:{color:"#ffffff"}}},geo:{itemStyle:{areaColor:"#eee",borderColor:"#444",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#e098c7",borderColor:"#444",borderWidth:1},label:{color:"#ffffff"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#cccccc"},splitLine:{show:!1,lineStyle:{color:["#eeeeee","#333333"]}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#cccccc"},splitLine:{show:!1,lineStyle:{color:["#eeeeee","#333333"]}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#cccccc"},splitLine:{show:!1,lineStyle:{color:["#eeeeee","#333333"]}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#cccccc"},splitLine:{show:!1,lineStyle:{color:["#eeeeee","#333333"]}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#cccccc"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#8fd3e8",width:1},itemStyle:{color:"#8fd3e8",borderWidth:1},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},checkpointStyle:{color:"#8fd3e8",borderColor:"#8a7ca8"},label:{color:"#8fd3e8"},emphasis:{itemStyle:{color:"#8fd3e8"},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},label:{color:"#8fd3e8"}}},visualMap:{color:["#8a7ca8","#e098c7","#cceffa"]},dataZoom:{backgroundColor:"rgba(0,0,0,0)",dataBackgroundColor:"rgba(255,255,255,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"5319b9f50d5ba746a053":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca"),r=a("6fe5e339b0f8a936ba8c");n.shape.fishbone.cell.ProjectSitesnode_api=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.ProjectSitesnode_api",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.ProjectSitesnode_api</strong>}<br/><br/><strong>Scope </strong><cite>Node </cite>represents relation to particular scope (Site Model), according to available scope list in the project.<br/><br/><strong>Configuration: </strong><br/><br/><strong>Scope*: </strong> <cite>specify project scope (Site Model) you want report to be build for. Select from dropdown list. <br/><i class='fas fa-exclamation-circle'></i>This node should be connected to one of the <strong>Project </strong>nodes available on canvas.</cite>",init:function(e,t,a,n){var s=this;this.clean_conditions={proj_id:"",region:"'all'",site_code:"'all'",site_name:"'all'",publish_status:"-1",site_status:"-1"},this._super(o.extend({color:"#ffa702",items:{filter:{name:"Filter",icon:"fas fa-filter",callback:function(){l.GetFilterData()}},reset_filter:{name:"Reset Filter",icon:"fas fa-redo",callback:function(){l.userData.conditions=l.clean_conditions,l.userData.conditions.proj_id="'"+l.project.proj_id+"'",i.initFallDown(l),l.GetHTTPData(),l.updateUI()}},sep:"---------"}},e),t,a,n);var l=this;this.project={proj_id:"",proj_name:"",proj_code:""},this.sites_list_out=[],o.extend(this.userData,{hidden:!1,autoWidth:!1,conditions:{proj_id:"",region:"'all'",site_code:"'all'",site_name:"'all'",publish_status:"-1",site_status:"-1"},conditions_mapping:{proj_id:{res:"proj_id",req:"proj_id",type:"string",display:"Project ID",show:!1},region:{res:"region",req:"region",type:"string",display:"Region",show:!0},site_code:{res:"site_code",req:"site_code",type:"string",display:"Site Code",show:!0},site_name:{res:"site_name",req:"site_name",type:"string",display:"Site Name",show:!0},publish_status:{res:"publish_status",req:"publish_status",type:"int",display:"Publish Status",show:!0},site_status:{res:"site_status",req:"site_status",type:"int",display:"Site Status",show:!0}},value:0,showInConnections:!0,showOutConnections:!0,sites_list_out:[],index:0}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{conditions:{type:"object",title:"Filter",properties:{proj_id:{type:"string",title:"Project ID",default:""},region:{type:"string",title:"Region",default:"'all'"},site_code:{type:"string",title:"Site Code",default:"'all'"},site_name:{type:"string",title:"Site Name",default:"'all'"},site_status:{type:"string",title:"Site Status",default:"-1"},publish_status:{type:"string",title:"Publish Status",default:"-1"}}},conditions_mapping:{type:"object",title:"Filter",format:"hidden"}}}),this.clearUI=function(){this.val_label.setText("0"),this.filter_label.setText("Scope")},this.GetHTTPData=function(){var e=this.getUserData();l.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500));var t=e.conditions;this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=o.ajax({url:r.context+"/apidata/getAPIData?apiid=527191607008591872&user_id="+window.user_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(t),success:function(e){var t=e.data?e.data:e;t.length>-1&&(l.val_label.setText(t.length.toString()),l.userData.value=t.length,l.userData.sites_list_out=t,l.getPort("output0").setUserData({project:l.project,item_name:"projectsites",sites_list_out:t}),l.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(l.getId()),t.setColor(l.frame.attr("stroke"))}),this))),l.stopTimer(),l.updateUI()},error:function(e,t,a){console.log(t+" "+a)}})},this.GetFilterData=function(){var e=Object.assign({},this.clean_conditions);e.proj_id="'"+this.project.proj_id+"'",this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=o.ajax({url:r.context+"/apidata/getAPIData?apiid=527191607008591872&user_id="+window.user_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(e),success:function(e){var t=e.data?e.data:e;n.editor.selectProjectSitesValues(l,t)}})},this.createPort("input").setMaxFanOut(1),this.createPort("output"),this.getPort("input0").on("connect",(function(e,t){s.project=t.connection.sourcePort.getUserData().project,s.updateUI(),s.GetHTTPData()})),this.getRealCount=function(){return 1}},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.top_label.setText(this.project.proj_name),this.filter_label.setText("Project Sites"),this.userData.conditions.proj_id="'"+this.project.proj_id+"'",this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(o.proxy((function(e,a){var n=a.getTarget();n.userData||(n.userData={}),n.userData.realCount=t.getRealCount(),n.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||a.setColor("#dfdfdf")}),this))}));else if("input0"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.project=a.getUserData().project,this.userData.conditions.proj_id="'"+this.project.proj_id+"'",this.updateUI(),this.GetHTTPData()}},onTimer:function(){"."!==this.val_label.getText()&&".."!=this.val_label.getText()&&"..."!=this.val_label.getText()&&this.val_label.setText("."),"."===this.val_label.getText()?this.val_label.setText(".."):".."===this.val_label.getText()?this.val_label.setText("..."):"..."===this.val_label.getText()&&this.val_label.setText(".")}})},"5337ae24b93bd12275f0":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca"),r=a("6fe5e339b0f8a936ba8c"),s=a("1bf2fbdb051fe0c57024");n.shape.fishbone.cell.DUModelnode_api=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.DUModelnode_api",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.DUModelnode_api</strong>}<br/><br/><strong>Building </strong><cite>Node </cite>represents relation to particular SOP (Building), according to available SOP list in the scope.<br/><br/><strong>Configuration: </strong><br/><br/><strong>SOP (Building)*: </strong> <cite>specify scope SOP (Building) you want to use. Select from dropdown list. <br/><i class='fas fa-exclamation-circle'></i>This node should be connected to one of the <strong>Scope </strong>nodes available on canvas.</cite>",init:function(e,t,a,l){this.clean_conditions={proj_id:"",model_id:"",model_name:"'all'",site_model_name:"'all'",region:"'all'",phase:"'all'",du_code:"'all'",du_name:"'all'",du_status:"'all'",site_id:"'all'",site_code:"'all'",site_name:"'all'"},this._super(o.extend({color:"#02a0fe",items:{filter:{name:"Filter",icon:"fas fa-filter",callback:function(){setTimeout((function(){c.GetFilterData()}),10)}},reset_filter:{name:"Reset Filter",icon:"fas fa-redo",callback:function(){c.userData.conditions=o.extend({},c.clean_conditions),i.initFallDown(c),c.GetHTTPData(),c.updateUI()}},sep:"---------"}},e),t,a,l);var c=this;this.sscope=l,this.project={proj_id:"",proj_name:"",proj_code:""},this.du_model={du_model_id:"",du_model_name:""},this.sites_list_out=[],o.extend(this.userData,{hidden:!1,autoWidth:!1,du_model:{du_model_id:"",du_model_name:"DU Model"},conditions:{proj_id:"",model_id:"",model_name:"'all'",site_model_name:"'all'",region:"'all'",phase:"'all'",du_code:"'all'",du_name:"'all'",du_status:"'all'",site_id:"'all'",site_code:"'all'",site_name:"'all'"},conditions_mapping:{proj_id:{res:"proj_id",req:"proj_id",type:"string",display:"Project ID",show:!1},model_id:{res:"model_id",req:"model_id",type:"string",display:"DU Model ID",show:!1},model_name:{res:"du_model_name",req:"model_name",type:"string",display:"DU Model Name",show:!0},site_model_name:{res:"site_model_name",req:"site_model_name",type:"string",display:"Site Model",show:!0},region:{res:"region",req:"region",type:"string",display:"Region",show:!0},phase:{res:"phase_code",req:"phase",type:"string",display:"Phase",show:!0},du_code:{res:"du_code",req:"du_code",type:"string",display:"DU Code",show:!0},du_name:{res:"du_name",req:"du_name",type:"string",display:"DU Name",show:!0},du_status:{res:"du_status",req:"du_status",type:"string",display:"DU Status",show:!0},site_id:{res:"site_id",req:"site_id",type:"string",display:"Site ID",show:!1},site_code:{res:"site_code",req:"site_code",type:"string",display:"Site Code",show:!0},site_name:{res:"site_name",req:"site_name",type:"string",display:"Site Name",show:!0}},value:0,showInConnections:!0,showOutConnections:!0,sites_list_out:[],index:0}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},du_model:{type:"object",default:{du_model_id:"",du_model_name:"None"},title:"DU Model",format:"du_modelcode",properties:{du_model_id:{type:"string",default:""},du_model_name:{type:"string",default:"DU Model"}}},conditions:{type:"object",title:"Filter",properties:{proj_id:{type:"string",title:"Project ID",default:""},model_id:{type:"string",title:"DU Model ID",default:""},model_name:{type:"string",title:"DU Model Name",default:""},region:{type:"string",title:"Region",default:"'all'"},site_model_name:{type:"string",title:"Site Model",default:"'all'"},phase:{type:"string",title:"Phase",default:"'all'"},du_code:{type:"string",title:"DU Code",default:"'all'"},du_name:{type:"string",title:"DU Name",default:"'all'"},du_status:{type:"string",title:"DU Status",default:"'all'"},site_id:{type:"string",title:"Site ID",default:"'all'"},site_code:{type:"string",title:"Site Code",default:"'all'"},site_name:{type:"string",title:"Site Name",default:"'all'"}}},conditions_mapping:{type:"object",title:"Filter",format:"hidden"},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},value:{type:"integer",title:"Current Value",default:0},sites_list_out:{type:"array",title:"Result Site List",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},index:{type:"integer",title:"Mobile Index",default:0}}}),this.clearUI=function(){this.val_label.setText("0"),this.filter_label.setText("Building")},this.GetHTTPData=function(){DEBUG&&console.log("DU Model node: "+this.id+" init GetHTTPData.");var e=this.getUserData();c.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500)),e.conditions.proj_id=""+this.project.proj_id,this.userData.du_model.du_model_id&&(e.conditions.model_id=""+this.userData.du_model.du_model_id);var t="";for(var a in this.sites_list_in&&(this.sites_list_in.forEach((function(e,a){t=t+""+e.site_id+","})),(t=t.substring(0,t.length-1))&&(e.conditions.site_id=t)),e.conditions)Object.prototype.hasOwnProperty.call(e.conditions,a)&&("'all'"===e.conditions[a]&&delete e.conditions[a],e.conditions[a]&&(e.conditions[a]=e.conditions[a].replace(/'/g,"")));var n=e.conditions;this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=o.ajax({url:r.context+"/apidata/getAPIData?apiid=1059839087123398656&user_id="+window.user_id+"&parse_json=true",contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(n),success:function(e){var t=e.data?e.data:e;c.val_label.setText(t.length.toString()),c.userData.value=t.length,c.userData.sites_list_out=t;var a=c.getPort("output0");c.userData.du_model?a.setUserData({project:c.project,du_model:c.userData.du_model,scope:{scope_id:c.userData.du_model.du_model_id,scope_name:c.userData.du_model.du_model_name},sop:{scope_id:c.userData.du_model.du_model_id,scope_name:c.userData.du_model.du_model_name},item_name:"du_model",sites_list_out:t}):a.setUserData({project:c.project,item_name:"du_model",sites_list_out:t}),c.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(c.getId()),t.setColor(c.frame.attr("stroke"))}),this)),c.updateUI(),c.stopTimer()}})},this.GetFilterData=function(){this.getUserData();var e=Object.assign({},this.clean_conditions);e.proj_id=""+this.project.proj_id,this.userData.du_model.du_model_id&&(e.model_id=""+this.userData.du_model.du_model_id);var t="";for(var a in this.sites_list_in&&(this.sites_list_in.forEach((function(e,a){t=t+e.site_id+","})),(t=t.substring(0,t.length-1))&&(e.site_id=t)),e)Object.prototype.hasOwnProperty.call(e,a)&&"'all'"===e[a]&&delete e[a];this.xhr&&4!==this.xhr.readyState&&this.xhr.abort();var n=o.ajax({url:r.context+"/apidata/getAPIData?apiid=1059839087123398656&user_id="+window.user_id+"&parse_json=true",contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(e)}).done((function(e){return e}));l.editor.selectDUModelValues(c,n)},this.createPort("input"),this.createPort("output");var u=this.getPort("input0");u.setMaxFanOut(1),u.on("connect",(function(e,t){try{t.connection.setTargetDecorator(new n.decoration.connection.DataArrowDecorator),c.sites_list_in=t.connection.sourcePort.userData.sites_list_out,c.updateScopeSearchCol(t.connection.sourcePort.getUserData().project,c)}catch(e){alert("Some problems here....from DU Model node"),t&&t.connection.remove()}})),this.updateScopeSearchCol=function(e,t){var a,n,i="527209159352942592";this.clearUI,DU_Model_CodeSearchTreemaNode=(a=r.context+"/apidata/getAPIData?apiid="+i+"&user_id="+window.user_id,n=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.extend(n),n.prototype.url=a,n.prototype.formatDocument=function(e){return e.du_model_name},n.prototype.buildValueForDisplay=function(e,t){var a;return a=t.du_model_name?this.formatDocument(t):"None",this.buildValueForDisplaySimply(e,a)},n.prototype.search=function(){var e;if((e=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!e&&this.getSearchResultsEl().empty(),e)){this.lastTerm=e,this.getSearchResultsEl().empty().append("Searching");var a=this.searchCallback,n={proj_id:t.project.proj_id};o.ajax({url:r.context+"/apidata/getAPIData?apiid="+i+"&user_id="+window.user_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(n),success:function(t){var n=t.data?t.data:t,o=(new s).from(n).where((function(t,a){return-1!==t.du_model_name.toLowerCase().indexOf(e.toLowerCase())})).select();a(o)}})}},n.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data.du_model_id=e.data("value").du_model_id,this.data.du_model_name=e.data("value").du_model_name,t.GetHTTPData(),t.updateUI())},n.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.du_model_name.toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},n),TreemaNode.setNodeSubclass("du_modelcode",DU_Model_CodeSearchTreemaNode),this.project=e,this.ai_generated||this.GetHTTPData(),this.ai_generated=!1,this.updateUI()},this.getRealCount=function(){return 1}},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.top_label.setText(this.project.proj_name),e.du_model?this.filter_label.setText(e.du_model.du_model_name):this.filter_label.setText("all"),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(a,n){a.getConnections().each(o.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),i.getMessage(t,o,"ticket send to"),o.superUpdate=!!e.superUpdate,o.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||n.setColor("#dfdfdf")}),this))}));else if("input0"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();t.sites_list_in=a.userData.sites_list_out,this.updateScopeSearchCol(a.getUserData().project,this)}},onTimer:function(){"."!==this.val_label.getText()&&".."!==this.val_label.getText()&&"..."!==this.val_label.getText()&&this.val_label.setText("."),"."===this.val_label.getText()?this.val_label.setText(".."):".."===this.val_label.getText()?this.val_label.setText("..."):"..."===this.val_label.getText()&&this.val_label.setText(".")},getPersistentAttributes:function(){return this._super()},setPersistentAttributes:function(e){e.userData.conditions.du_status&&"-1"===e.userData.conditions.du_status&&delete e.userData.conditions.du_status,this._super(e)}})},"5530efb4f964fae4f0ae":e=>{e.exports='/*\nAuthor: Geraint Luff and others\nYear: 2013\n\nThis code is released into the "public domain" by its author(s).  Anybody may use, alter and distribute the code without restriction.  The author makes no guarantees, and takes no liability of any kind for use of this code.\n\nIf you find a bug or make an improvement, it would be courteous to let the author know, but it is not compulsory.\n*/\n(function (global, factory) {\n  if (typeof define === \'function\' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], factory);\n  } else if (typeof module !== \'undefined\' && module.exports){\n    // CommonJS. Define export.\n    module.exports = factory();\n  } else {\n    // Browser globals\n    global.tv4 = factory();\n  }\n}(this, function () {\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FObject%2Fkeys\nif (!Object.keys) {\n\tObject.keys = (function () {\n\t\tvar hasOwnProperty = Object.prototype.hasOwnProperty,\n\t\t\thasDontEnumBug = !({toString: null}).propertyIsEnumerable(\'toString\'),\n\t\t\tdontEnums = [\n\t\t\t\t\'toString\',\n\t\t\t\t\'toLocaleString\',\n\t\t\t\t\'valueOf\',\n\t\t\t\t\'hasOwnProperty\',\n\t\t\t\t\'isPrototypeOf\',\n\t\t\t\t\'propertyIsEnumerable\',\n\t\t\t\t\'constructor\'\n\t\t\t],\n\t\t\tdontEnumsLength = dontEnums.length;\n\n\t\treturn function (obj) {\n\t\t\tif (typeof obj !== \'object\' && typeof obj !== \'function\' || obj === null) {\n\t\t\t\tthrow new TypeError(\'Object.keys called on non-object\');\n\t\t\t}\n\n\t\t\tvar result = [];\n\n\t\t\tfor (var prop in obj) {\n\t\t\t\tif (hasOwnProperty.call(obj, prop)) {\n\t\t\t\t\tresult.push(prop);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (hasDontEnumBug) {\n\t\t\t\tfor (var i=0; i < dontEnumsLength; i++) {\n\t\t\t\t\tif (hasOwnProperty.call(obj, dontEnums[i])) {\n\t\t\t\t\t\tresult.push(dontEnums[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t};\n\t})();\n}\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/create\nif (!Object.create) {\n\tObject.create = (function(){\n\t\tfunction F(){}\n\n\t\treturn function(o){\n\t\t\tif (arguments.length !== 1) {\n\t\t\t\tthrow new Error(\'Object.create implementation only accepts one parameter.\');\n\t\t\t}\n\t\t\tF.prototype = o;\n\t\t\treturn new F();\n\t\t};\n\t})();\n}\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray%2FisArray\nif(!Array.isArray) {\n\tArray.isArray = function (vArg) {\n\t\treturn Object.prototype.toString.call(vArg) === "[object Array]";\n\t};\n}\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FGlobal_Objects%2FArray%2FindexOf\nif (!Array.prototype.indexOf) {\n\tArray.prototype.indexOf = function (searchElement /*, fromIndex */ ) {\n\t\tif (this === null) {\n\t\t\tthrow new TypeError();\n\t\t}\n\t\tvar t = Object(this);\n\t\tvar len = t.length >>> 0;\n\n\t\tif (len === 0) {\n\t\t\treturn -1;\n\t\t}\n\t\tvar n = 0;\n\t\tif (arguments.length > 1) {\n\t\t\tn = Number(arguments[1]);\n\t\t\tif (n !== n) { // shortcut for verifying if it\'s NaN\n\t\t\t\tn = 0;\n\t\t\t} else if (n !== 0 && n !== Infinity && n !== -Infinity) {\n\t\t\t\tn = (n > 0 || -1) * Math.floor(Math.abs(n));\n\t\t\t}\n\t\t}\n\t\tif (n >= len) {\n\t\t\treturn -1;\n\t\t}\n\t\tvar k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\n\t\tfor (; k < len; k++) {\n\t\t\tif (k in t && t[k] === searchElement) {\n\t\t\t\treturn k;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n}\n\n// Grungey Object.isFrozen hack\nif (!Object.isFrozen) {\n\tObject.isFrozen = function (obj) {\n\t\tvar key = "tv4_test_frozen_key";\n\t\twhile (obj.hasOwnProperty(key)) {\n\t\t\tkey += Math.random();\n\t\t}\n\t\ttry {\n\t\t\tobj[key] = true;\n\t\t\tdelete obj[key];\n\t\t\treturn false;\n\t\t} catch (e) {\n\t\t\treturn true;\n\t\t}\n\t};\n}\n// Based on: https://github.com/geraintluff/uri-templates, but with all the de-substitution stuff removed\n\nvar uriTemplateGlobalModifiers = {\n\t"+": true,\n\t"#": true,\n\t".": true,\n\t"/": true,\n\t";": true,\n\t"?": true,\n\t"&": true\n};\nvar uriTemplateSuffices = {\n\t"*": true\n};\n\nfunction notReallyPercentEncode(string) {\n\treturn encodeURI(string).replace(/%25[0-9][0-9]/g, function (doubleEncoded) {\n\t\treturn "%" + doubleEncoded.substring(3);\n\t});\n}\n\nfunction uriTemplateSubstitution(spec) {\n\tvar modifier = "";\n\tif (uriTemplateGlobalModifiers[spec.charAt(0)]) {\n\t\tmodifier = spec.charAt(0);\n\t\tspec = spec.substring(1);\n\t}\n\tvar separator = "";\n\tvar prefix = "";\n\tvar shouldEscape = true;\n\tvar showVariables = false;\n\tvar trimEmptyString = false;\n\tif (modifier === \'+\') {\n\t\tshouldEscape = false;\n\t} else if (modifier === ".") {\n\t\tprefix = ".";\n\t\tseparator = ".";\n\t} else if (modifier === "/") {\n\t\tprefix = "/";\n\t\tseparator = "/";\n\t} else if (modifier === \'#\') {\n\t\tprefix = "#";\n\t\tshouldEscape = false;\n\t} else if (modifier === \';\') {\n\t\tprefix = ";";\n\t\tseparator = ";";\n\t\tshowVariables = true;\n\t\ttrimEmptyString = true;\n\t} else if (modifier === \'?\') {\n\t\tprefix = "?";\n\t\tseparator = "&";\n\t\tshowVariables = true;\n\t} else if (modifier === \'&\') {\n\t\tprefix = "&";\n\t\tseparator = "&";\n\t\tshowVariables = true;\n\t}\n\n\tvar varNames = [];\n\tvar varList = spec.split(",");\n\tvar varSpecs = [];\n\tvar varSpecMap = {};\n\tfor (var i = 0; i < varList.length; i++) {\n\t\tvar varName = varList[i];\n\t\tvar truncate = null;\n\t\tif (varName.indexOf(":") !== -1) {\n\t\t\tvar parts = varName.split(":");\n\t\t\tvarName = parts[0];\n\t\t\ttruncate = parseInt(parts[1], 10);\n\t\t}\n\t\tvar suffices = {};\n\t\twhile (uriTemplateSuffices[varName.charAt(varName.length - 1)]) {\n\t\t\tsuffices[varName.charAt(varName.length - 1)] = true;\n\t\t\tvarName = varName.substring(0, varName.length - 1);\n\t\t}\n\t\tvar varSpec = {\n\t\t\ttruncate: truncate,\n\t\t\tname: varName,\n\t\t\tsuffices: suffices\n\t\t};\n\t\tvarSpecs.push(varSpec);\n\t\tvarSpecMap[varName] = varSpec;\n\t\tvarNames.push(varName);\n\t}\n\tvar subFunction = function (valueFunction) {\n\t\tvar result = "";\n\t\tvar startIndex = 0;\n\t\tfor (var i = 0; i < varSpecs.length; i++) {\n\t\t\tvar varSpec = varSpecs[i];\n\t\t\tvar value = valueFunction(varSpec.name);\n\t\t\tif (value === null || value === undefined || (Array.isArray(value) && value.length === 0) || (typeof value === \'object\' && Object.keys(value).length === 0)) {\n\t\t\t\tstartIndex++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (i === startIndex) {\n\t\t\t\tresult += prefix;\n\t\t\t} else {\n\t\t\t\tresult += (separator || ",");\n\t\t\t}\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\tif (showVariables) {\n\t\t\t\t\tresult += varSpec.name + "=";\n\t\t\t\t}\n\t\t\t\tfor (var j = 0; j < value.length; j++) {\n\t\t\t\t\tif (j > 0) {\n\t\t\t\t\t\tresult += varSpec.suffices[\'*\'] ? (separator || ",") : ",";\n\t\t\t\t\t\tif (varSpec.suffices[\'*\'] && showVariables) {\n\t\t\t\t\t\t\tresult += varSpec.name + "=";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(value[j]).replace(/!/g, "%21") : notReallyPercentEncode(value[j]);\n\t\t\t\t}\n\t\t\t} else if (typeof value === "object") {\n\t\t\t\tif (showVariables && !varSpec.suffices[\'*\']) {\n\t\t\t\t\tresult += varSpec.name + "=";\n\t\t\t\t}\n\t\t\t\tvar first = true;\n\t\t\t\tfor (var key in value) {\n\t\t\t\t\tif (!first) {\n\t\t\t\t\t\tresult += varSpec.suffices[\'*\'] ? (separator || ",") : ",";\n\t\t\t\t\t}\n\t\t\t\t\tfirst = false;\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(key).replace(/!/g, "%21") : notReallyPercentEncode(key);\n\t\t\t\t\tresult += varSpec.suffices[\'*\'] ? \'=\' : ",";\n\t\t\t\t\tresult += shouldEscape ? encodeURIComponent(value[key]).replace(/!/g, "%21") : notReallyPercentEncode(value[key]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (showVariables) {\n\t\t\t\t\tresult += varSpec.name;\n\t\t\t\t\tif (!trimEmptyString || value !== "") {\n\t\t\t\t\t\tresult += "=";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (varSpec.truncate != null) {\n\t\t\t\t\tvalue = value.substring(0, varSpec.truncate);\n\t\t\t\t}\n\t\t\t\tresult += shouldEscape ? encodeURIComponent(value).replace(/!/g, "%21"): notReallyPercentEncode(value);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t};\n\tsubFunction.varNames = varNames;\n\treturn {\n\t\tprefix: prefix,\n\t\tsubstitution: subFunction\n\t};\n}\n\nfunction UriTemplate(template) {\n\tif (!(this instanceof UriTemplate)) {\n\t\treturn new UriTemplate(template);\n\t}\n\tvar parts = template.split("{");\n\tvar textParts = [parts.shift()];\n\tvar prefixes = [];\n\tvar substitutions = [];\n\tvar varNames = [];\n\twhile (parts.length > 0) {\n\t\tvar part = parts.shift();\n\t\tvar spec = part.split("}")[0];\n\t\tvar remainder = part.substring(spec.length + 1);\n\t\tvar funcs = uriTemplateSubstitution(spec);\n\t\tsubstitutions.push(funcs.substitution);\n\t\tprefixes.push(funcs.prefix);\n\t\ttextParts.push(remainder);\n\t\tvarNames = varNames.concat(funcs.substitution.varNames);\n\t}\n\tthis.fill = function (valueFunction) {\n\t\tvar result = textParts[0];\n\t\tfor (var i = 0; i < substitutions.length; i++) {\n\t\t\tvar substitution = substitutions[i];\n\t\t\tresult += substitution(valueFunction);\n\t\t\tresult += textParts[i + 1];\n\t\t}\n\t\treturn result;\n\t};\n\tthis.varNames = varNames;\n\tthis.template = template;\n}\nUriTemplate.prototype = {\n\ttoString: function () {\n\t\treturn this.template;\n\t},\n\tfillFromObject: function (obj) {\n\t\treturn this.fill(function (varName) {\n\t\t\treturn obj[varName];\n\t\t});\n\t}\n};\nvar ValidatorContext = function ValidatorContext(parent, collectMultiple, errorReporter, checkRecursive, trackUnknownProperties) {\n\tthis.missing = [];\n\tthis.missingMap = {};\n\tthis.formatValidators = parent ? Object.create(parent.formatValidators) : {};\n\tthis.schemas = parent ? Object.create(parent.schemas) : {};\n\tthis.collectMultiple = collectMultiple;\n\tthis.errors = [];\n\tthis.handleError = collectMultiple ? this.collectError : this.returnError;\n\tif (checkRecursive) {\n\t\tthis.checkRecursive = true;\n\t\tthis.scanned = [];\n\t\tthis.scannedFrozen = [];\n\t\tthis.scannedFrozenSchemas = [];\n\t\tthis.scannedFrozenValidationErrors = [];\n\t\tthis.validatedSchemasKey = \'tv4_validation_id\';\n\t\tthis.validationErrorsKey = \'tv4_validation_errors_id\';\n\t}\n\tif (trackUnknownProperties) {\n\t\tthis.trackUnknownProperties = true;\n\t\tthis.knownPropertyPaths = {};\n\t\tthis.unknownPropertyPaths = {};\n\t}\n\tthis.errorReporter = errorReporter || defaultErrorReporter(\'en\');\n\tif (typeof this.errorReporter === \'string\') {\n\t\tthrow new Error(\'debug\');\n\t}\n\tthis.definedKeywords = {};\n\tif (parent) {\n\t\tfor (var key in parent.definedKeywords) {\n\t\t\tthis.definedKeywords[key] = parent.definedKeywords[key].slice(0);\n\t\t}\n\t}\n};\nValidatorContext.prototype.defineKeyword = function (keyword, keywordFunction) {\n\tthis.definedKeywords[keyword] = this.definedKeywords[keyword] || [];\n\tthis.definedKeywords[keyword].push(keywordFunction);\n};\nValidatorContext.prototype.createError = function (code, messageParams, dataPath, schemaPath, subErrors, data, schema) {\n\tvar error = new ValidationError(code, messageParams, dataPath, schemaPath, subErrors);\n\terror.message = this.errorReporter(error, data, schema);\n\treturn error;\n};\nValidatorContext.prototype.returnError = function (error) {\n\treturn error;\n};\nValidatorContext.prototype.collectError = function (error) {\n\tif (error) {\n\t\tthis.errors.push(error);\n\t}\n\treturn null;\n};\nValidatorContext.prototype.prefixErrors = function (startIndex, dataPath, schemaPath) {\n\tfor (var i = startIndex; i < this.errors.length; i++) {\n\t\tthis.errors[i] = this.errors[i].prefixWith(dataPath, schemaPath);\n\t}\n\treturn this;\n};\nValidatorContext.prototype.banUnknownProperties = function (data, schema) {\n\tfor (var unknownPath in this.unknownPropertyPaths) {\n\t\tvar error = this.createError(ErrorCodes.UNKNOWN_PROPERTY, {path: unknownPath}, unknownPath, "", null, data, schema);\n\t\tvar result = this.handleError(error);\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.addFormat = function (format, validator) {\n\tif (typeof format === \'object\') {\n\t\tfor (var key in format) {\n\t\t\tthis.addFormat(key, format[key]);\n\t\t}\n\t\treturn this;\n\t}\n\tthis.formatValidators[format] = validator;\n};\nValidatorContext.prototype.resolveRefs = function (schema, urlHistory) {\n\tif (schema[\'$ref\'] !== undefined) {\n\t\turlHistory = urlHistory || {};\n\t\tif (urlHistory[schema[\'$ref\']]) {\n\t\t\treturn this.createError(ErrorCodes.CIRCULAR_REFERENCE, {urls: Object.keys(urlHistory).join(\', \')}, \'\', \'\', null, undefined, schema);\n\t\t}\n\t\turlHistory[schema[\'$ref\']] = true;\n\t\tschema = this.getSchema(schema[\'$ref\'], urlHistory);\n\t}\n\treturn schema;\n};\nValidatorContext.prototype.getSchema = function (url, urlHistory) {\n\tvar schema;\n\tif (this.schemas[url] !== undefined) {\n\t\tschema = this.schemas[url];\n\t\treturn this.resolveRefs(schema, urlHistory);\n\t}\n\tvar baseUrl = url;\n\tvar fragment = "";\n\tif (url.indexOf(\'#\') !== -1) {\n\t\tfragment = url.substring(url.indexOf("#") + 1);\n\t\tbaseUrl = url.substring(0, url.indexOf("#"));\n\t}\n\tif (typeof this.schemas[baseUrl] === \'object\') {\n\t\tschema = this.schemas[baseUrl];\n\t\tvar pointerPath = decodeURIComponent(fragment);\n\t\tif (pointerPath === "") {\n\t\t\treturn this.resolveRefs(schema, urlHistory);\n\t\t} else if (pointerPath.charAt(0) !== "/") {\n\t\t\treturn undefined;\n\t\t}\n\t\tvar parts = pointerPath.split("/").slice(1);\n\t\tfor (var i = 0; i < parts.length; i++) {\n\t\t\tvar component = parts[i].replace(/~1/g, "/").replace(/~0/g, "~");\n\t\t\tif (schema[component] === undefined) {\n\t\t\t\tschema = undefined;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tschema = schema[component];\n\t\t}\n\t\tif (schema !== undefined) {\n\t\t\treturn this.resolveRefs(schema, urlHistory);\n\t\t}\n\t}\n\tif (this.missing[baseUrl] === undefined) {\n\t\tthis.missing.push(baseUrl);\n\t\tthis.missing[baseUrl] = baseUrl;\n\t\tthis.missingMap[baseUrl] = baseUrl;\n\t}\n};\nValidatorContext.prototype.searchSchemas = function (schema, url) {\n\tif (Array.isArray(schema)) {\n\t\tfor (var i = 0; i < schema.length; i++) {\n\t\t\tthis.searchSchemas(schema[i], url);\n\t\t}\n\t} else if (schema && typeof schema === "object") {\n\t\tif (typeof schema.id === "string") {\n\t\t\tif (isTrustedUrl(url, schema.id)) {\n\t\t\t\tif (this.schemas[schema.id] === undefined) {\n\t\t\t\t\tthis.schemas[schema.id] = schema;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (var key in schema) {\n\t\t\tif (key !== "enum") {\n\t\t\t\tif (typeof schema[key] === "object") {\n\t\t\t\t\tthis.searchSchemas(schema[key], url);\n\t\t\t\t} else if (key === "$ref") {\n\t\t\t\t\tvar uri = getDocumentUri(schema[key]);\n\t\t\t\t\tif (uri && this.schemas[uri] === undefined && this.missingMap[uri] === undefined) {\n\t\t\t\t\t\tthis.missingMap[uri] = uri;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\nValidatorContext.prototype.addSchema = function (url, schema) {\n\t//overload\n\tif (typeof url !== \'string\' || typeof schema === \'undefined\') {\n\t\tif (typeof url === \'object\' && typeof url.id === \'string\') {\n\t\t\tschema = url;\n\t\t\turl = schema.id;\n\t\t}\n\t\telse {\n\t\t\treturn;\n\t\t}\n\t}\n\tif (url === getDocumentUri(url) + "#") {\n\t\t// Remove empty fragment\n\t\turl = getDocumentUri(url);\n\t}\n\tthis.schemas[url] = schema;\n\tdelete this.missingMap[url];\n\tnormSchema(schema, url);\n\tthis.searchSchemas(schema, url);\n};\n\nValidatorContext.prototype.getSchemaMap = function () {\n\tvar map = {};\n\tfor (var key in this.schemas) {\n\t\tmap[key] = this.schemas[key];\n\t}\n\treturn map;\n};\n\nValidatorContext.prototype.getSchemaUris = function (filterRegExp) {\n\tvar list = [];\n\tfor (var key in this.schemas) {\n\t\tif (!filterRegExp || filterRegExp.test(key)) {\n\t\t\tlist.push(key);\n\t\t}\n\t}\n\treturn list;\n};\n\nValidatorContext.prototype.getMissingUris = function (filterRegExp) {\n\tvar list = [];\n\tfor (var key in this.missingMap) {\n\t\tif (!filterRegExp || filterRegExp.test(key)) {\n\t\t\tlist.push(key);\n\t\t}\n\t}\n\treturn list;\n};\n\nValidatorContext.prototype.dropSchemas = function () {\n\tthis.schemas = {};\n\tthis.reset();\n};\nValidatorContext.prototype.reset = function () {\n\tthis.missing = [];\n\tthis.missingMap = {};\n\tthis.errors = [];\n};\n\nValidatorContext.prototype.validateAll = function (data, schema, dataPathParts, schemaPathParts, dataPointerPath) {\n\tvar topLevel;\n\tschema = this.resolveRefs(schema);\n\tif (!schema) {\n\t\treturn null;\n\t} else if (schema instanceof ValidationError) {\n\t\tthis.errors.push(schema);\n\t\treturn schema;\n\t}\n\n\tvar startErrorCount = this.errors.length;\n\tvar frozenIndex, scannedFrozenSchemaIndex = null, scannedSchemasIndex = null;\n\tif (this.checkRecursive && data && typeof data === \'object\') {\n\t\ttopLevel = !this.scanned.length;\n\t\tif (data[this.validatedSchemasKey]) {\n\t\t\tvar schemaIndex = data[this.validatedSchemasKey].indexOf(schema);\n\t\t\tif (schemaIndex !== -1) {\n\t\t\t\tthis.errors = this.errors.concat(data[this.validationErrorsKey][schemaIndex]);\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tif (Object.isFrozen(data)) {\n\t\t\tfrozenIndex = this.scannedFrozen.indexOf(data);\n\t\t\tif (frozenIndex !== -1) {\n\t\t\t\tvar frozenSchemaIndex = this.scannedFrozenSchemas[frozenIndex].indexOf(schema);\n\t\t\t\tif (frozenSchemaIndex !== -1) {\n\t\t\t\t\tthis.errors = this.errors.concat(this.scannedFrozenValidationErrors[frozenIndex][frozenSchemaIndex]);\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.scanned.push(data);\n\t\tif (Object.isFrozen(data)) {\n\t\t\tif (frozenIndex === -1) {\n\t\t\t\tfrozenIndex = this.scannedFrozen.length;\n\t\t\t\tthis.scannedFrozen.push(data);\n\t\t\t\tthis.scannedFrozenSchemas.push([]);\n\t\t\t}\n\t\t\tscannedFrozenSchemaIndex = this.scannedFrozenSchemas[frozenIndex].length;\n\t\t\tthis.scannedFrozenSchemas[frozenIndex][scannedFrozenSchemaIndex] = schema;\n\t\t\tthis.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex] = [];\n\t\t} else {\n\t\t\tif (!data[this.validatedSchemasKey]) {\n\t\t\t\ttry {\n\t\t\t\t\tObject.defineProperty(data, this.validatedSchemasKey, {\n\t\t\t\t\t\tvalue: [],\n\t\t\t\t\t\tconfigurable: true\n\t\t\t\t\t});\n\t\t\t\t\tObject.defineProperty(data, this.validationErrorsKey, {\n\t\t\t\t\t\tvalue: [],\n\t\t\t\t\t\tconfigurable: true\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\t//IE 7/8 workaround\n\t\t\t\t\tdata[this.validatedSchemasKey] = [];\n\t\t\t\t\tdata[this.validationErrorsKey] = [];\n\t\t\t\t}\n\t\t\t}\n\t\t\tscannedSchemasIndex = data[this.validatedSchemasKey].length;\n\t\t\tdata[this.validatedSchemasKey][scannedSchemasIndex] = schema;\n\t\t\tdata[this.validationErrorsKey][scannedSchemasIndex] = [];\n\t\t}\n\t}\n\n\tvar errorCount = this.errors.length;\n\tvar error = this.validateBasic(data, schema, dataPointerPath)\n\t\t|| this.validateNumeric(data, schema, dataPointerPath)\n\t\t|| this.validateString(data, schema, dataPointerPath)\n\t\t|| this.validateArray(data, schema, dataPointerPath)\n\t\t|| this.validateObject(data, schema, dataPointerPath)\n\t\t|| this.validateCombinations(data, schema, dataPointerPath)\n\t\t|| this.validateHypermedia(data, schema, dataPointerPath)\n\t\t|| this.validateFormat(data, schema, dataPointerPath)\n\t\t|| this.validateDefinedKeywords(data, schema, dataPointerPath)\n\t\t|| null;\n\n\tif (topLevel) {\n\t\twhile (this.scanned.length) {\n\t\t\tvar item = this.scanned.pop();\n\t\t\tdelete item[this.validatedSchemasKey];\n\t\t}\n\t\tthis.scannedFrozen = [];\n\t\tthis.scannedFrozenSchemas = [];\n\t}\n\n\tif (error || errorCount !== this.errors.length) {\n\t\twhile ((dataPathParts && dataPathParts.length) || (schemaPathParts && schemaPathParts.length)) {\n\t\t\tvar dataPart = (dataPathParts && dataPathParts.length) ? "" + dataPathParts.pop() : null;\n\t\t\tvar schemaPart = (schemaPathParts && schemaPathParts.length) ? "" + schemaPathParts.pop() : null;\n\t\t\tif (error) {\n\t\t\t\terror = error.prefixWith(dataPart, schemaPart);\n\t\t\t}\n\t\t\tthis.prefixErrors(errorCount, dataPart, schemaPart);\n\t\t}\n\t}\n\n\tif (scannedFrozenSchemaIndex !== null) {\n\t\tthis.scannedFrozenValidationErrors[frozenIndex][scannedFrozenSchemaIndex] = this.errors.slice(startErrorCount);\n\t} else if (scannedSchemasIndex !== null) {\n\t\tdata[this.validationErrorsKey][scannedSchemasIndex] = this.errors.slice(startErrorCount);\n\t}\n\n\treturn this.handleError(error);\n};\nValidatorContext.prototype.validateFormat = function (data, schema) {\n\tif (typeof schema.format !== \'string\' || !this.formatValidators[schema.format]) {\n\t\treturn null;\n\t}\n\tvar errorMessage = this.formatValidators[schema.format].call(null, data, schema);\n\tif (typeof errorMessage === \'string\' || typeof errorMessage === \'number\') {\n\t\treturn this.createError(ErrorCodes.FORMAT_CUSTOM, {message: errorMessage}, \'\', \'/format\', null, data, schema);\n\t} else if (errorMessage && typeof errorMessage === \'object\') {\n\t\treturn this.createError(ErrorCodes.FORMAT_CUSTOM, {message: errorMessage.message || "?"}, errorMessage.dataPath || \'\', errorMessage.schemaPath || "/format", null, data, schema);\n\t}\n\treturn null;\n};\nValidatorContext.prototype.validateDefinedKeywords = function (data, schema, dataPointerPath) {\n\tfor (var key in this.definedKeywords) {\n\t\tif (typeof schema[key] === \'undefined\') {\n\t\t\tcontinue;\n\t\t}\n\t\tvar validationFunctions = this.definedKeywords[key];\n\t\tfor (var i = 0; i < validationFunctions.length; i++) {\n\t\t\tvar func = validationFunctions[i];\n\t\t\tvar result = func(data, schema[key], schema, dataPointerPath);\n\t\t\tif (typeof result === \'string\' || typeof result === \'number\') {\n\t\t\t\treturn this.createError(ErrorCodes.KEYWORD_CUSTOM, {key: key, message: result}, \'\', \'\', null, data, schema).prefixWith(null, key);\n\t\t\t} else if (result && typeof result === \'object\') {\n\t\t\t\tvar code = result.code;\n\t\t\t\tif (typeof code === \'string\') {\n\t\t\t\t\tif (!ErrorCodes[code]) {\n\t\t\t\t\t\tthrow new Error(\'Undefined error code (use defineError): \' + code);\n\t\t\t\t\t}\n\t\t\t\t\tcode = ErrorCodes[code];\n\t\t\t\t} else if (typeof code !== \'number\') {\n\t\t\t\t\tcode = ErrorCodes.KEYWORD_CUSTOM;\n\t\t\t\t}\n\t\t\t\tvar messageParams = (typeof result.message === \'object\') ? result.message : {key: key, message: result.message || "?"};\n\t\t\t\tvar schemaPath = result.schemaPath || ("/" + key.replace(/~/g, \'~0\').replace(/\\//g, \'~1\'));\n\t\t\t\treturn this.createError(code, messageParams, result.dataPath || null, schemaPath, null, data, schema);\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n\nfunction recursiveCompare(A, B) {\n\tif (A === B) {\n\t\treturn true;\n\t}\n\tif (A && B && typeof A === "object" && typeof B === "object") {\n\t\tif (Array.isArray(A) !== Array.isArray(B)) {\n\t\t\treturn false;\n\t\t} else if (Array.isArray(A)) {\n\t\t\tif (A.length !== B.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tfor (var i = 0; i < A.length; i++) {\n\t\t\t\tif (!recursiveCompare(A[i], B[i])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tvar key;\n\t\t\tfor (key in A) {\n\t\t\t\tif (B[key] === undefined && A[key] !== undefined) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (key in B) {\n\t\t\t\tif (A[key] === undefined && B[key] !== undefined) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (key in A) {\n\t\t\t\tif (!recursiveCompare(A[key], B[key])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nValidatorContext.prototype.validateBasic = function validateBasic(data, schema, dataPointerPath) {\n\tvar error;\n\tif (error = this.validateType(data, schema, dataPointerPath)) {\n\t\treturn error.prefixWith(null, "type");\n\t}\n\tif (error = this.validateEnum(data, schema, dataPointerPath)) {\n\t\treturn error.prefixWith(null, "type");\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateType = function validateType(data, schema) {\n\tif (schema.type === undefined) {\n\t\treturn null;\n\t}\n\tvar dataType = typeof data;\n\tif (data === null) {\n\t\tdataType = "null";\n\t} else if (Array.isArray(data)) {\n\t\tdataType = "array";\n\t}\n\tvar allowedTypes = schema.type;\n\tif (!Array.isArray(allowedTypes)) {\n\t\tallowedTypes = [allowedTypes];\n\t}\n\n\tfor (var i = 0; i < allowedTypes.length; i++) {\n\t\tvar type = allowedTypes[i];\n\t\tif (type === dataType || (type === "integer" && dataType === "number" && (data % 1 === 0))) {\n\t\t\treturn null;\n\t\t}\n\t}\n\treturn this.createError(ErrorCodes.INVALID_TYPE, {type: dataType, expected: allowedTypes.join("/")}, \'\', \'\', null, data, schema);\n};\n\nValidatorContext.prototype.validateEnum = function validateEnum(data, schema) {\n\tif (schema["enum"] === undefined) {\n\t\treturn null;\n\t}\n\tfor (var i = 0; i < schema["enum"].length; i++) {\n\t\tvar enumVal = schema["enum"][i];\n\t\tif (recursiveCompare(data, enumVal)) {\n\t\t\treturn null;\n\t\t}\n\t}\n\treturn this.createError(ErrorCodes.ENUM_MISMATCH, {value: (typeof JSON !== \'undefined\') ? JSON.stringify(data) : data}, \'\', \'\', null, data, schema);\n};\n\nValidatorContext.prototype.validateNumeric = function validateNumeric(data, schema, dataPointerPath) {\n\treturn this.validateMultipleOf(data, schema, dataPointerPath)\n\t\t|| this.validateMinMax(data, schema, dataPointerPath)\n\t\t|| this.validateNaN(data, schema, dataPointerPath)\n\t\t|| null;\n};\n\nvar CLOSE_ENOUGH_LOW = Math.pow(2, -51);\nvar CLOSE_ENOUGH_HIGH = 1 - CLOSE_ENOUGH_LOW;\nValidatorContext.prototype.validateMultipleOf = function validateMultipleOf(data, schema) {\n\tvar multipleOf = schema.multipleOf || schema.divisibleBy;\n\tif (multipleOf === undefined) {\n\t\treturn null;\n\t}\n\tif (typeof data === "number") {\n\t\tvar remainder = (data/multipleOf)%1;\n\t\tif (remainder >= CLOSE_ENOUGH_LOW && remainder < CLOSE_ENOUGH_HIGH) {\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MULTIPLE_OF, {value: data, multipleOf: multipleOf}, \'\', \'\', null, data, schema);\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateMinMax = function validateMinMax(data, schema) {\n\tif (typeof data !== "number") {\n\t\treturn null;\n\t}\n\tif (schema.minimum !== undefined) {\n\t\tif (data < schema.minimum) {\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MINIMUM, {value: data, minimum: schema.minimum}, \'\', \'/minimum\', null, data, schema);\n\t\t}\n\t\tif (schema.exclusiveMinimum && data === schema.minimum) {\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MINIMUM_EXCLUSIVE, {value: data, minimum: schema.minimum}, \'\', \'/exclusiveMinimum\', null, data, schema);\n\t\t}\n\t}\n\tif (schema.maximum !== undefined) {\n\t\tif (data > schema.maximum) {\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MAXIMUM, {value: data, maximum: schema.maximum}, \'\', \'/maximum\', null, data, schema);\n\t\t}\n\t\tif (schema.exclusiveMaximum && data === schema.maximum) {\n\t\t\treturn this.createError(ErrorCodes.NUMBER_MAXIMUM_EXCLUSIVE, {value: data, maximum: schema.maximum}, \'\', \'/exclusiveMaximum\', null, data, schema);\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateNaN = function validateNaN(data, schema) {\n\tif (typeof data !== "number") {\n\t\treturn null;\n\t}\n\tif (isNaN(data) === true || data === Infinity || data === -Infinity) {\n\t\treturn this.createError(ErrorCodes.NUMBER_NOT_A_NUMBER, {value: data}, \'\', \'/type\', null, data, schema);\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateString = function validateString(data, schema, dataPointerPath) {\n\treturn this.validateStringLength(data, schema, dataPointerPath)\n\t\t|| this.validateStringPattern(data, schema, dataPointerPath)\n\t\t|| null;\n};\n\nValidatorContext.prototype.validateStringLength = function validateStringLength(data, schema) {\n\tif (typeof data !== "string") {\n\t\treturn null;\n\t}\n\tif (schema.minLength !== undefined) {\n\t\tif (data.length < schema.minLength) {\n\t\t\treturn this.createError(ErrorCodes.STRING_LENGTH_SHORT, {length: data.length, minimum: schema.minLength}, \'\', \'/minLength\', null, data, schema);\n\t\t}\n\t}\n\tif (schema.maxLength !== undefined) {\n\t\tif (data.length > schema.maxLength) {\n\t\t\treturn this.createError(ErrorCodes.STRING_LENGTH_LONG, {length: data.length, maximum: schema.maxLength}, \'\', \'/maxLength\', null, data, schema);\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateStringPattern = function validateStringPattern(data, schema) {\n\tif (typeof data !== "string" || (typeof schema.pattern !== "string" && !(schema.pattern instanceof RegExp))) {\n\t\treturn null;\n\t}\n\tvar regexp;\n\tif (schema.pattern instanceof RegExp) {\n\t  regexp = schema.pattern;\n\t}\n\telse {\n\t  var body, flags = \'\';\n\t  // Check for regular expression literals\n\t  // @see http://www.ecma-international.org/ecma-262/5.1/#sec-7.8.5\n\t  var literal = schema.pattern.match(/^\\/(.+)\\/([img]*)$/);\n\t  if (literal) {\n\t    body = literal[1];\n\t    flags = literal[2];\n\t  }\n\t  else {\n\t    body = schema.pattern;\n\t  }\n\t  regexp = new RegExp(body, flags);\n\t}\n\tif (!regexp.test(data)) {\n\t\treturn this.createError(ErrorCodes.STRING_PATTERN, {pattern: schema.pattern}, \'\', \'/pattern\', null, data, schema);\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateArray = function validateArray(data, schema, dataPointerPath) {\n\tif (!Array.isArray(data)) {\n\t\treturn null;\n\t}\n\treturn this.validateArrayLength(data, schema, dataPointerPath)\n\t\t|| this.validateArrayUniqueItems(data, schema, dataPointerPath)\n\t\t|| this.validateArrayItems(data, schema, dataPointerPath)\n\t\t|| null;\n};\n\nValidatorContext.prototype.validateArrayLength = function validateArrayLength(data, schema) {\n\tvar error;\n\tif (schema.minItems !== undefined) {\n\t\tif (data.length < schema.minItems) {\n\t\t\terror = this.createError(ErrorCodes.ARRAY_LENGTH_SHORT, {length: data.length, minimum: schema.minItems}, \'\', \'/minItems\', null, data, schema);\n\t\t\tif (this.handleError(error)) {\n\t\t\t\treturn error;\n\t\t\t}\n\t\t}\n\t}\n\tif (schema.maxItems !== undefined) {\n\t\tif (data.length > schema.maxItems) {\n\t\t\terror = this.createError(ErrorCodes.ARRAY_LENGTH_LONG, {length: data.length, maximum: schema.maxItems}, \'\', \'/maxItems\', null, data, schema);\n\t\t\tif (this.handleError(error)) {\n\t\t\t\treturn error;\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateArrayUniqueItems = function validateArrayUniqueItems(data, schema) {\n\tif (schema.uniqueItems) {\n\t\tfor (var i = 0; i < data.length; i++) {\n\t\t\tfor (var j = i + 1; j < data.length; j++) {\n\t\t\t\tif (recursiveCompare(data[i], data[j])) {\n\t\t\t\t\tvar error = this.createError(ErrorCodes.ARRAY_UNIQUE, {match1: i, match2: j}, \'\', \'/uniqueItems\', null, data, schema);\n\t\t\t\t\tif (this.handleError(error)) {\n\t\t\t\t\t\treturn error;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateArrayItems = function validateArrayItems(data, schema, dataPointerPath) {\n\tif (schema.items === undefined) {\n\t\treturn null;\n\t}\n\tvar error, i;\n\tif (Array.isArray(schema.items)) {\n\t\tfor (i = 0; i < data.length; i++) {\n\t\t\tif (i < schema.items.length) {\n\t\t\t\tif (error = this.validateAll(data[i], schema.items[i], [i], ["items", i], dataPointerPath + "/" + i)) {\n\t\t\t\t\treturn error;\n\t\t\t\t}\n\t\t\t} else if (schema.additionalItems !== undefined) {\n\t\t\t\tif (typeof schema.additionalItems === "boolean") {\n\t\t\t\t\tif (!schema.additionalItems) {\n\t\t\t\t\t\terror = (this.createError(ErrorCodes.ARRAY_ADDITIONAL_ITEMS, {}, \'/\' + i, \'/additionalItems\', null, data, schema));\n\t\t\t\t\t\tif (this.handleError(error)) {\n\t\t\t\t\t\t\treturn error;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (error = this.validateAll(data[i], schema.additionalItems, [i], ["additionalItems"], dataPointerPath + "/" + i)) {\n\t\t\t\t\treturn error;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tfor (i = 0; i < data.length; i++) {\n\t\t\tif (error = this.validateAll(data[i], schema.items, [i], ["items"], dataPointerPath + "/" + i)) {\n\t\t\t\treturn error;\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateObject = function validateObject(data, schema, dataPointerPath) {\n\tif (typeof data !== "object" || data === null || Array.isArray(data)) {\n\t\treturn null;\n\t}\n\treturn this.validateObjectMinMaxProperties(data, schema, dataPointerPath)\n\t\t|| this.validateObjectRequiredProperties(data, schema, dataPointerPath)\n\t\t|| this.validateObjectProperties(data, schema, dataPointerPath)\n\t\t|| this.validateObjectDependencies(data, schema, dataPointerPath)\n\t\t|| null;\n};\n\nValidatorContext.prototype.validateObjectMinMaxProperties = function validateObjectMinMaxProperties(data, schema) {\n\tvar keys = Object.keys(data);\n\tvar error;\n\tif (schema.minProperties !== undefined) {\n\t\tif (keys.length < schema.minProperties) {\n\t\t\terror = this.createError(ErrorCodes.OBJECT_PROPERTIES_MINIMUM, {propertyCount: keys.length, minimum: schema.minProperties}, \'\', \'/minProperties\', null, data, schema);\n\t\t\tif (this.handleError(error)) {\n\t\t\t\treturn error;\n\t\t\t}\n\t\t}\n\t}\n\tif (schema.maxProperties !== undefined) {\n\t\tif (keys.length > schema.maxProperties) {\n\t\t\terror = this.createError(ErrorCodes.OBJECT_PROPERTIES_MAXIMUM, {propertyCount: keys.length, maximum: schema.maxProperties}, \'\', \'/maxProperties\', null, data, schema);\n\t\t\tif (this.handleError(error)) {\n\t\t\t\treturn error;\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateObjectRequiredProperties = function validateObjectRequiredProperties(data, schema) {\n\tif (schema.required !== undefined) {\n\t\tfor (var i = 0; i < schema.required.length; i++) {\n\t\t\tvar key = schema.required[i];\n\t\t\tif (data[key] === undefined) {\n\t\t\t\tvar error = this.createError(ErrorCodes.OBJECT_REQUIRED, {key: key}, \'\', \'/required/\' + i, null, data, schema);\n\t\t\t\tif (this.handleError(error)) {\n\t\t\t\t\treturn error;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateObjectProperties = function validateObjectProperties(data, schema, dataPointerPath) {\n\tvar error;\n\tfor (var key in data) {\n\t\tvar keyPointerPath = dataPointerPath + "/" + key.replace(/~/g, \'~0\').replace(/\\//g, \'~1\');\n\t\tvar foundMatch = false;\n\t\tif (schema.properties !== undefined && schema.properties[key] !== undefined) {\n\t\t\tfoundMatch = true;\n\t\t\tif (error = this.validateAll(data[key], schema.properties[key], [key], ["properties", key], keyPointerPath)) {\n\t\t\t\treturn error;\n\t\t\t}\n\t\t}\n\t\tif (schema.patternProperties !== undefined) {\n\t\t\tfor (var patternKey in schema.patternProperties) {\n\t\t\t\tvar regexp = new RegExp(patternKey);\n\t\t\t\tif (regexp.test(key)) {\n\t\t\t\t\tfoundMatch = true;\n\t\t\t\t\tif (error = this.validateAll(data[key], schema.patternProperties[patternKey], [key], ["patternProperties", patternKey], keyPointerPath)) {\n\t\t\t\t\t\treturn error;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!foundMatch) {\n\t\t\tif (schema.additionalProperties !== undefined) {\n\t\t\t\tif (this.trackUnknownProperties) {\n\t\t\t\t\tthis.knownPropertyPaths[keyPointerPath] = true;\n\t\t\t\t\tdelete this.unknownPropertyPaths[keyPointerPath];\n\t\t\t\t}\n\t\t\t\tif (typeof schema.additionalProperties === "boolean") {\n\t\t\t\t\tif (!schema.additionalProperties) {\n\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_ADDITIONAL_PROPERTIES, {key: key}, \'\', \'/additionalProperties\', null, data, schema).prefixWith(key, null);\n\t\t\t\t\t\tif (this.handleError(error)) {\n\t\t\t\t\t\t\treturn error;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (error = this.validateAll(data[key], schema.additionalProperties, [key], ["additionalProperties"], keyPointerPath)) {\n\t\t\t\t\t\treturn error;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (this.trackUnknownProperties && !this.knownPropertyPaths[keyPointerPath]) {\n\t\t\t\tthis.unknownPropertyPaths[keyPointerPath] = true;\n\t\t\t}\n\t\t} else if (this.trackUnknownProperties) {\n\t\t\tthis.knownPropertyPaths[keyPointerPath] = true;\n\t\t\tdelete this.unknownPropertyPaths[keyPointerPath];\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateObjectDependencies = function validateObjectDependencies(data, schema, dataPointerPath) {\n\tvar error;\n\tif (schema.dependencies !== undefined) {\n\t\tfor (var depKey in schema.dependencies) {\n\t\t\tif (data[depKey] !== undefined) {\n\t\t\t\tvar dep = schema.dependencies[depKey];\n\t\t\t\tif (typeof dep === "string") {\n\t\t\t\t\tif (data[dep] === undefined) {\n\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY, {key: depKey, missing: dep}, \'\', \'\', null, data, schema).prefixWith(null, depKey).prefixWith(null, "dependencies");\n\t\t\t\t\t\tif (this.handleError(error)) {\n\t\t\t\t\t\t\treturn error;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (Array.isArray(dep)) {\n\t\t\t\t\tfor (var i = 0; i < dep.length; i++) {\n\t\t\t\t\t\tvar requiredKey = dep[i];\n\t\t\t\t\t\tif (data[requiredKey] === undefined) {\n\t\t\t\t\t\t\terror = this.createError(ErrorCodes.OBJECT_DEPENDENCY_KEY, {key: depKey, missing: requiredKey}, \'\', \'/\' + i, null, data, schema).prefixWith(null, depKey).prefixWith(null, "dependencies");\n\t\t\t\t\t\t\tif (this.handleError(error)) {\n\t\t\t\t\t\t\t\treturn error;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (error = this.validateAll(data, dep, [], ["dependencies", depKey], dataPointerPath)) {\n\t\t\t\t\t\treturn error;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateCombinations = function validateCombinations(data, schema, dataPointerPath) {\n\treturn this.validateAllOf(data, schema, dataPointerPath)\n\t\t|| this.validateAnyOf(data, schema, dataPointerPath)\n\t\t|| this.validateOneOf(data, schema, dataPointerPath)\n\t\t|| this.validateNot(data, schema, dataPointerPath)\n\t\t|| null;\n};\n\nValidatorContext.prototype.validateAllOf = function validateAllOf(data, schema, dataPointerPath) {\n\tif (schema.allOf === undefined) {\n\t\treturn null;\n\t}\n\tvar error;\n\tfor (var i = 0; i < schema.allOf.length; i++) {\n\t\tvar subSchema = schema.allOf[i];\n\t\tif (error = this.validateAll(data, subSchema, [], ["allOf", i], dataPointerPath)) {\n\t\t\treturn error;\n\t\t}\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateAnyOf = function validateAnyOf(data, schema, dataPointerPath) {\n\tif (schema.anyOf === undefined) {\n\t\treturn null;\n\t}\n\tvar errors = [];\n\tvar startErrorCount = this.errors.length;\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\n\tif (this.trackUnknownProperties) {\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\n\t}\n\tvar errorAtEnd = true;\n\tfor (var i = 0; i < schema.anyOf.length; i++) {\n\t\tif (this.trackUnknownProperties) {\n\t\t\tthis.unknownPropertyPaths = {};\n\t\t\tthis.knownPropertyPaths = {};\n\t\t}\n\t\tvar subSchema = schema.anyOf[i];\n\n\t\tvar errorCount = this.errors.length;\n\t\tvar error = this.validateAll(data, subSchema, [], ["anyOf", i], dataPointerPath);\n\n\t\tif (error === null && errorCount === this.errors.length) {\n\t\t\tthis.errors = this.errors.slice(0, startErrorCount);\n\n\t\t\tif (this.trackUnknownProperties) {\n\t\t\t\tfor (var knownKey in this.knownPropertyPaths) {\n\t\t\t\t\toldKnownPropertyPaths[knownKey] = true;\n\t\t\t\t\tdelete oldUnknownPropertyPaths[knownKey];\n\t\t\t\t}\n\t\t\t\tfor (var unknownKey in this.unknownPropertyPaths) {\n\t\t\t\t\tif (!oldKnownPropertyPaths[unknownKey]) {\n\t\t\t\t\t\toldUnknownPropertyPaths[unknownKey] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// We need to continue looping so we catch all the property definitions, but we don\'t want to return an error\n\t\t\t\terrorAtEnd = false;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t\tif (error) {\n\t\t\terrors.push(error.prefixWith(null, "" + i).prefixWith(null, "anyOf"));\n\t\t}\n\t}\n\tif (this.trackUnknownProperties) {\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\n\t}\n\tif (errorAtEnd) {\n\t\terrors = errors.concat(this.errors.slice(startErrorCount));\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\n\t\treturn this.createError(ErrorCodes.ANY_OF_MISSING, {}, "", "/anyOf", errors, data, schema);\n\t}\n};\n\nValidatorContext.prototype.validateOneOf = function validateOneOf(data, schema, dataPointerPath) {\n\tif (schema.oneOf === undefined) {\n\t\treturn null;\n\t}\n\tvar validIndex = null;\n\tvar errors = [];\n\tvar startErrorCount = this.errors.length;\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\n\tif (this.trackUnknownProperties) {\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\n\t}\n\tfor (var i = 0; i < schema.oneOf.length; i++) {\n\t\tif (this.trackUnknownProperties) {\n\t\t\tthis.unknownPropertyPaths = {};\n\t\t\tthis.knownPropertyPaths = {};\n\t\t}\n\t\tvar subSchema = schema.oneOf[i];\n\n\t\tvar errorCount = this.errors.length;\n\t\tvar error = this.validateAll(data, subSchema, [], ["oneOf", i], dataPointerPath);\n\n\t\tif (error === null && errorCount === this.errors.length) {\n\t\t\tif (validIndex === null) {\n\t\t\t\tvalidIndex = i;\n\t\t\t} else {\n\t\t\t\tthis.errors = this.errors.slice(0, startErrorCount);\n\t\t\t\treturn this.createError(ErrorCodes.ONE_OF_MULTIPLE, {index1: validIndex, index2: i}, "", "/oneOf", null, data, schema);\n\t\t\t}\n\t\t\tif (this.trackUnknownProperties) {\n\t\t\t\tfor (var knownKey in this.knownPropertyPaths) {\n\t\t\t\t\toldKnownPropertyPaths[knownKey] = true;\n\t\t\t\t\tdelete oldUnknownPropertyPaths[knownKey];\n\t\t\t\t}\n\t\t\t\tfor (var unknownKey in this.unknownPropertyPaths) {\n\t\t\t\t\tif (!oldKnownPropertyPaths[unknownKey]) {\n\t\t\t\t\t\toldUnknownPropertyPaths[unknownKey] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (error) {\n\t\t\terrors.push(error);\n\t\t}\n\t}\n\tif (this.trackUnknownProperties) {\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\n\t}\n\tif (validIndex === null) {\n\t\terrors = errors.concat(this.errors.slice(startErrorCount));\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\n\t\treturn this.createError(ErrorCodes.ONE_OF_MISSING, {}, "", "/oneOf", errors, data, schema);\n\t} else {\n\t\tthis.errors = this.errors.slice(0, startErrorCount);\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateNot = function validateNot(data, schema, dataPointerPath) {\n\tif (schema.not === undefined) {\n\t\treturn null;\n\t}\n\tvar oldErrorCount = this.errors.length;\n\tvar oldUnknownPropertyPaths, oldKnownPropertyPaths;\n\tif (this.trackUnknownProperties) {\n\t\toldUnknownPropertyPaths = this.unknownPropertyPaths;\n\t\toldKnownPropertyPaths = this.knownPropertyPaths;\n\t\tthis.unknownPropertyPaths = {};\n\t\tthis.knownPropertyPaths = {};\n\t}\n\tvar error = this.validateAll(data, schema.not, null, null, dataPointerPath);\n\tvar notErrors = this.errors.slice(oldErrorCount);\n\tthis.errors = this.errors.slice(0, oldErrorCount);\n\tif (this.trackUnknownProperties) {\n\t\tthis.unknownPropertyPaths = oldUnknownPropertyPaths;\n\t\tthis.knownPropertyPaths = oldKnownPropertyPaths;\n\t}\n\tif (error === null && notErrors.length === 0) {\n\t\treturn this.createError(ErrorCodes.NOT_PASSED, {}, "", "/not", null, data, schema);\n\t}\n\treturn null;\n};\n\nValidatorContext.prototype.validateHypermedia = function validateCombinations(data, schema, dataPointerPath) {\n\tif (!schema.links) {\n\t\treturn null;\n\t}\n\tvar error;\n\tfor (var i = 0; i < schema.links.length; i++) {\n\t\tvar ldo = schema.links[i];\n\t\tif (ldo.rel === "describedby") {\n\t\t\tvar template = new UriTemplate(ldo.href);\n\t\t\tvar allPresent = true;\n\t\t\tfor (var j = 0; j < template.varNames.length; j++) {\n\t\t\t\tif (!(template.varNames[j] in data)) {\n\t\t\t\t\tallPresent = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (allPresent) {\n\t\t\t\tvar schemaUrl = template.fillFromObject(data);\n\t\t\t\tvar subSchema = {"$ref": schemaUrl};\n\t\t\t\tif (error = this.validateAll(data, subSchema, [], ["links", i], dataPointerPath)) {\n\t\t\t\t\treturn error;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\n// parseURI() and resolveUrl() are from https://gist.github.com/1088850\n//   -  released as public domain by author ("Yaffle") - see comments on gist\n\nfunction parseURI(url) {\n\tvar m = String(url).replace(/^\\s+|\\s+$/g, \'\').match(/^([^:\\/?#]+:)?(\\/\\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\\/?#]*)(?::(\\d*))?))?([^?#]*)(\\?[^#]*)?(#[\\s\\S]*)?/);\n\t// authority = \'//\' + user + \':\' + pass \'@\' + hostname + \':\' port\n\treturn (m ? {\n\t\thref     : m[0] || \'\',\n\t\tprotocol : m[1] || \'\',\n\t\tauthority: m[2] || \'\',\n\t\thost     : m[3] || \'\',\n\t\thostname : m[4] || \'\',\n\t\tport     : m[5] || \'\',\n\t\tpathname : m[6] || \'\',\n\t\tsearch   : m[7] || \'\',\n\t\thash     : m[8] || \'\'\n\t} : null);\n}\n\nfunction resolveUrl(base, href) {// RFC 3986\n\n\tfunction removeDotSegments(input) {\n\t\tvar output = [];\n\t\tinput.replace(/^(\\.\\.?(\\/|$))+/, \'\')\n\t\t\t.replace(/\\/(\\.(\\/|$))+/g, \'/\')\n\t\t\t.replace(/\\/\\.\\.$/, \'/../\')\n\t\t\t.replace(/\\/?[^\\/]*/g, function (p) {\n\t\t\t\tif (p === \'/..\') {\n\t\t\t\t\toutput.pop();\n\t\t\t\t} else {\n\t\t\t\t\toutput.push(p);\n\t\t\t\t}\n\t\t});\n\t\treturn output.join(\'\').replace(/^\\//, input.charAt(0) === \'/\' ? \'/\' : \'\');\n\t}\n\n\thref = parseURI(href || \'\');\n\tbase = parseURI(base || \'\');\n\n\treturn !href || !base ? null : (href.protocol || base.protocol) +\n\t\t(href.protocol || href.authority ? href.authority : base.authority) +\n\t\tremoveDotSegments(href.protocol || href.authority || href.pathname.charAt(0) === \'/\' ? href.pathname : (href.pathname ? ((base.authority && !base.pathname ? \'/\' : \'\') + base.pathname.slice(0, base.pathname.lastIndexOf(\'/\') + 1) + href.pathname) : base.pathname)) +\n\t\t(href.protocol || href.authority || href.pathname ? href.search : (href.search || base.search)) +\n\t\thref.hash;\n}\n\nfunction getDocumentUri(uri) {\n\treturn uri.split(\'#\')[0];\n}\nfunction normSchema(schema, baseUri) {\n\tif (schema && typeof schema === "object") {\n\t\tif (baseUri === undefined) {\n\t\t\tbaseUri = schema.id;\n\t\t} else if (typeof schema.id === "string") {\n\t\t\tbaseUri = resolveUrl(baseUri, schema.id);\n\t\t\tschema.id = baseUri;\n\t\t}\n\t\tif (Array.isArray(schema)) {\n\t\t\tfor (var i = 0; i < schema.length; i++) {\n\t\t\t\tnormSchema(schema[i], baseUri);\n\t\t\t}\n\t\t} else {\n\t\t\tif (typeof schema[\'$ref\'] === "string") {\n\t\t\t\tschema[\'$ref\'] = resolveUrl(baseUri, schema[\'$ref\']);\n\t\t\t}\n\t\t\tfor (var key in schema) {\n\t\t\t\tif (key !== "enum") {\n\t\t\t\t\tnormSchema(schema[key], baseUri);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction defaultErrorReporter(language) {\n\tlanguage = language || \'en\';\n\n\tvar errorMessages = languages[language];\n\n\treturn function (error) {\n\t\tvar messageTemplate = errorMessages[error.code] || ErrorMessagesDefault[error.code];\n\t\tif (typeof messageTemplate !== \'string\') {\n\t\t\treturn "Unknown error code " + error.code + ": " + JSON.stringify(error.messageParams);\n\t\t}\n\t\tvar messageParams = error.params;\n\t\t// Adapted from Crockford\'s supplant()\n\t\treturn messageTemplate.replace(/\\{([^{}]*)\\}/g, function (whole, varName) {\n\t\t\tvar subValue = messageParams[varName];\n\t\t\treturn typeof subValue === \'string\' || typeof subValue === \'number\' ? subValue : whole;\n\t\t});\n\t};\n}\n\nvar ErrorCodes = {\n\tINVALID_TYPE: 0,\n\tENUM_MISMATCH: 1,\n\tANY_OF_MISSING: 10,\n\tONE_OF_MISSING: 11,\n\tONE_OF_MULTIPLE: 12,\n\tNOT_PASSED: 13,\n\t// Numeric errors\n\tNUMBER_MULTIPLE_OF: 100,\n\tNUMBER_MINIMUM: 101,\n\tNUMBER_MINIMUM_EXCLUSIVE: 102,\n\tNUMBER_MAXIMUM: 103,\n\tNUMBER_MAXIMUM_EXCLUSIVE: 104,\n\tNUMBER_NOT_A_NUMBER: 105,\n\t// String errors\n\tSTRING_LENGTH_SHORT: 200,\n\tSTRING_LENGTH_LONG: 201,\n\tSTRING_PATTERN: 202,\n\t// Object errors\n\tOBJECT_PROPERTIES_MINIMUM: 300,\n\tOBJECT_PROPERTIES_MAXIMUM: 301,\n\tOBJECT_REQUIRED: 302,\n\tOBJECT_ADDITIONAL_PROPERTIES: 303,\n\tOBJECT_DEPENDENCY_KEY: 304,\n\t// Array errors\n\tARRAY_LENGTH_SHORT: 400,\n\tARRAY_LENGTH_LONG: 401,\n\tARRAY_UNIQUE: 402,\n\tARRAY_ADDITIONAL_ITEMS: 403,\n\t// Custom/user-defined errors\n\tFORMAT_CUSTOM: 500,\n\tKEYWORD_CUSTOM: 501,\n\t// Schema structure\n\tCIRCULAR_REFERENCE: 600,\n\t// Non-standard validation options\n\tUNKNOWN_PROPERTY: 1000\n};\nvar ErrorCodeLookup = {};\nfor (var key in ErrorCodes) {\n\tErrorCodeLookup[ErrorCodes[key]] = key;\n}\nvar ErrorMessagesDefault = {\n\tINVALID_TYPE: "Invalid type: {type} (expected {expected})",\n\tENUM_MISMATCH: "No enum match for: {value}",\n\tANY_OF_MISSING: "Data does not match any schemas from \\"anyOf\\"",\n\tONE_OF_MISSING: "Data does not match any schemas from \\"oneOf\\"",\n\tONE_OF_MULTIPLE: "Data is valid against more than one schema from \\"oneOf\\": indices {index1} and {index2}",\n\tNOT_PASSED: "Data matches schema from \\"not\\"",\n\t// Numeric errors\n\tNUMBER_MULTIPLE_OF: "Value {value} is not a multiple of {multipleOf}",\n\tNUMBER_MINIMUM: "Value {value} is less than minimum {minimum}",\n\tNUMBER_MINIMUM_EXCLUSIVE: "Value {value} is equal to exclusive minimum {minimum}",\n\tNUMBER_MAXIMUM: "Value {value} is greater than maximum {maximum}",\n\tNUMBER_MAXIMUM_EXCLUSIVE: "Value {value} is equal to exclusive maximum {maximum}",\n\tNUMBER_NOT_A_NUMBER: "Value {value} is not a valid number",\n\t// String errors\n\tSTRING_LENGTH_SHORT: "String is too short ({length} chars), minimum {minimum}",\n\tSTRING_LENGTH_LONG: "String is too long ({length} chars), maximum {maximum}",\n\tSTRING_PATTERN: "String does not match pattern: {pattern}",\n\t// Object errors\n\tOBJECT_PROPERTIES_MINIMUM: "Too few properties defined ({propertyCount}), minimum {minimum}",\n\tOBJECT_PROPERTIES_MAXIMUM: "Too many properties defined ({propertyCount}), maximum {maximum}",\n\tOBJECT_REQUIRED: "Missing required property: {key}",\n\tOBJECT_ADDITIONAL_PROPERTIES: "Additional properties not allowed",\n\tOBJECT_DEPENDENCY_KEY: "Dependency failed - key must exist: {missing} (due to key: {key})",\n\t// Array errors\n\tARRAY_LENGTH_SHORT: "Array is too short ({length}), minimum {minimum}",\n\tARRAY_LENGTH_LONG: "Array is too long ({length}), maximum {maximum}",\n\tARRAY_UNIQUE: "Array items are not unique (indices {match1} and {match2})",\n\tARRAY_ADDITIONAL_ITEMS: "Additional items not allowed",\n\t// Format errors\n\tFORMAT_CUSTOM: "Format validation failed ({message})",\n\tKEYWORD_CUSTOM: "Keyword failed: {key} ({message})",\n\t// Schema structure\n\tCIRCULAR_REFERENCE: "Circular $refs: {urls}",\n\t// Non-standard validation options\n\tUNKNOWN_PROPERTY: "Unknown property (not in schema)"\n};\n\nfunction ValidationError(code, params, dataPath, schemaPath, subErrors) {\n\tError.call(this);\n\tif (code === undefined) {\n\t\tthrow new Error ("No error code supplied: " + schemaPath);\n\t}\n\tthis.message = \'\';\n\tthis.params = params;\n\tthis.code = code;\n\tthis.dataPath = dataPath || "";\n\tthis.schemaPath = schemaPath || "";\n\tthis.subErrors = subErrors || null;\n\n\tvar err = new Error(this.message);\n\tthis.stack = err.stack || err.stacktrace;\n\tif (!this.stack) {\n\t\ttry {\n\t\t\tthrow err;\n\t\t}\n\t\tcatch(err) {\n\t\t\tthis.stack = err.stack || err.stacktrace;\n\t\t}\n\t}\n}\nValidationError.prototype = Object.create(Error.prototype);\nValidationError.prototype.constructor = ValidationError;\nValidationError.prototype.name = \'ValidationError\';\n\nValidationError.prototype.prefixWith = function (dataPrefix, schemaPrefix) {\n\tif (dataPrefix !== null) {\n\t\tdataPrefix = dataPrefix.replace(/~/g, "~0").replace(/\\//g, "~1");\n\t\tthis.dataPath = "/" + dataPrefix + this.dataPath;\n\t}\n\tif (schemaPrefix !== null) {\n\t\tschemaPrefix = schemaPrefix.replace(/~/g, "~0").replace(/\\//g, "~1");\n\t\tthis.schemaPath = "/" + schemaPrefix + this.schemaPath;\n\t}\n\tif (this.subErrors !== null) {\n\t\tfor (var i = 0; i < this.subErrors.length; i++) {\n\t\t\tthis.subErrors[i].prefixWith(dataPrefix, schemaPrefix);\n\t\t}\n\t}\n\treturn this;\n};\n\nfunction isTrustedUrl(baseUrl, testUrl) {\n\tif(testUrl.substring(0, baseUrl.length) === baseUrl){\n\t\tvar remainder = testUrl.substring(baseUrl.length);\n\t\tif ((testUrl.length > 0 && testUrl.charAt(baseUrl.length - 1) === "/")\n\t\t\t|| remainder.charAt(0) === "#"\n\t\t\t|| remainder.charAt(0) === "?") {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nvar languages = {};\nfunction createApi(language) {\n\tvar globalContext = new ValidatorContext();\n\tvar currentLanguage;\n\tvar customErrorReporter;\n\tvar api = {\n\t\tsetErrorReporter: function (reporter) {\n\t\t\tif (typeof reporter === \'string\') {\n\t\t\t\treturn this.language(reporter);\n\t\t\t}\n\t\t\tcustomErrorReporter = reporter;\n\t\t\treturn true;\n\t\t},\n\t\taddFormat: function () {\n\t\t\tglobalContext.addFormat.apply(globalContext, arguments);\n\t\t},\n\t\tlanguage: function (code) {\n\t\t\tif (!code) {\n\t\t\t\treturn currentLanguage;\n\t\t\t}\n\t\t\tif (!languages[code]) {\n\t\t\t\tcode = code.split(\'-\')[0]; // fall back to base language\n\t\t\t}\n\t\t\tif (languages[code]) {\n\t\t\t\tcurrentLanguage = code;\n\t\t\t\treturn code; // so you can tell if fall-back has happened\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\taddLanguage: function (code, messageMap) {\n\t\t\tvar key;\n\t\t\tfor (key in ErrorCodes) {\n\t\t\t\tif (messageMap[key] && !messageMap[ErrorCodes[key]]) {\n\t\t\t\t\tmessageMap[ErrorCodes[key]] = messageMap[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar rootCode = code.split(\'-\')[0];\n\t\t\tif (!languages[rootCode]) { // use for base language if not yet defined\n\t\t\t\tlanguages[code] = messageMap;\n\t\t\t\tlanguages[rootCode] = messageMap;\n\t\t\t} else {\n\t\t\t\tlanguages[code] = Object.create(languages[rootCode]);\n\t\t\t\tfor (key in messageMap) {\n\t\t\t\t\tif (typeof languages[rootCode][key] === \'undefined\') {\n\t\t\t\t\t\tlanguages[rootCode][key] = messageMap[key];\n\t\t\t\t\t}\n\t\t\t\t\tlanguages[code][key] = messageMap[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\tfreshApi: function (language) {\n\t\t\tvar result = createApi();\n\t\t\tif (language) {\n\t\t\t\tresult.language(language);\n\t\t\t}\n\t\t\treturn result;\n\t\t},\n\t\tvalidate: function (data, schema, checkRecursive, banUnknownProperties) {\n\t\t\tvar def = defaultErrorReporter(currentLanguage);\n\t\t\tvar errorReporter = customErrorReporter ? function (error, data, schema) {\n\t\t\t\treturn customErrorReporter(error, data, schema) || def(error, data, schema);\n\t\t\t} : def;\n\t\t\tvar context = new ValidatorContext(globalContext, false, errorReporter, checkRecursive, banUnknownProperties);\n\t\t\tif (typeof schema === "string") {\n\t\t\t\tschema = {"$ref": schema};\n\t\t\t}\n\t\t\tcontext.addSchema("", schema);\n\t\t\tvar error = context.validateAll(data, schema, null, null, "");\n\t\t\tif (!error && banUnknownProperties) {\n\t\t\t\terror = context.banUnknownProperties(data, schema);\n\t\t\t}\n\t\t\tthis.error = error;\n\t\t\tthis.missing = context.missing;\n\t\t\tthis.valid = (error === null);\n\t\t\treturn this.valid;\n\t\t},\n\t\tvalidateResult: function () {\n\t\t\tvar result = {};\n\t\t\tthis.validate.apply(result, arguments);\n\t\t\treturn result;\n\t\t},\n\t\tvalidateMultiple: function (data, schema, checkRecursive, banUnknownProperties) {\n\t\t\tvar def = defaultErrorReporter(currentLanguage);\n\t\t\tvar errorReporter = customErrorReporter ? function (error, data, schema) {\n\t\t\t\treturn customErrorReporter(error, data, schema) || def(error, data, schema);\n\t\t\t} : def;\n\t\t\tvar context = new ValidatorContext(globalContext, true, errorReporter, checkRecursive, banUnknownProperties);\n\t\t\tif (typeof schema === "string") {\n\t\t\t\tschema = {"$ref": schema};\n\t\t\t}\n\t\t\tcontext.addSchema("", schema);\n\t\t\tcontext.validateAll(data, schema, null, null, "");\n\t\t\tif (banUnknownProperties) {\n\t\t\t\tcontext.banUnknownProperties(data, schema);\n\t\t\t}\n\t\t\tvar result = {};\n\t\t\tresult.errors = context.errors;\n\t\t\tresult.missing = context.missing;\n\t\t\tresult.valid = (result.errors.length === 0);\n\t\t\treturn result;\n\t\t},\n\t\taddSchema: function () {\n\t\t\treturn globalContext.addSchema.apply(globalContext, arguments);\n\t\t},\n\t\tgetSchema: function () {\n\t\t\treturn globalContext.getSchema.apply(globalContext, arguments);\n\t\t},\n\t\tgetSchemaMap: function () {\n\t\t\treturn globalContext.getSchemaMap.apply(globalContext, arguments);\n\t\t},\n\t\tgetSchemaUris: function () {\n\t\t\treturn globalContext.getSchemaUris.apply(globalContext, arguments);\n\t\t},\n\t\tgetMissingUris: function () {\n\t\t\treturn globalContext.getMissingUris.apply(globalContext, arguments);\n\t\t},\n\t\tdropSchemas: function () {\n\t\t\tglobalContext.dropSchemas.apply(globalContext, arguments);\n\t\t},\n\t\tdefineKeyword: function () {\n\t\t\tglobalContext.defineKeyword.apply(globalContext, arguments);\n\t\t},\n\t\tdefineError: function (codeName, codeNumber, defaultMessage) {\n\t\t\tif (typeof codeName !== \'string\' || !/^[A-Z]+(_[A-Z]+)*$/.test(codeName)) {\n\t\t\t\tthrow new Error(\'Code name must be a string in UPPER_CASE_WITH_UNDERSCORES\');\n\t\t\t}\n\t\t\tif (typeof codeNumber !== \'number\' || codeNumber%1 !== 0 || codeNumber < 10000) {\n\t\t\t\tthrow new Error(\'Code number must be an integer > 10000\');\n\t\t\t}\n\t\t\tif (typeof ErrorCodes[codeName] !== \'undefined\') {\n\t\t\t\tthrow new Error(\'Error already defined: \' + codeName + \' as \' + ErrorCodes[codeName]);\n\t\t\t}\n\t\t\tif (typeof ErrorCodeLookup[codeNumber] !== \'undefined\') {\n\t\t\t\tthrow new Error(\'Error code already used: \' + ErrorCodeLookup[codeNumber] + \' as \' + codeNumber);\n\t\t\t}\n\t\t\tErrorCodes[codeName] = codeNumber;\n\t\t\tErrorCodeLookup[codeNumber] = codeName;\n\t\t\tErrorMessagesDefault[codeName] = ErrorMessagesDefault[codeNumber] = defaultMessage;\n\t\t\tfor (var langCode in languages) {\n\t\t\t\tvar language = languages[langCode];\n\t\t\t\tif (language[codeName]) {\n\t\t\t\t\tlanguage[codeNumber] = language[codeNumber] || language[codeName];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\treset: function () {\n\t\t\tglobalContext.reset();\n\t\t\tthis.error = null;\n\t\t\tthis.missing = [];\n\t\t\tthis.valid = true;\n\t\t},\n\t\tmissing: [],\n\t\terror: null,\n\t\tvalid: true,\n\t\tnormSchema: normSchema,\n\t\tresolveUrl: resolveUrl,\n\t\tgetDocumentUri: getDocumentUri,\n\t\terrorCodes: ErrorCodes\n\t};\n\tapi.language(language || \'en\');\n\treturn api;\n}\n\nvar tv4 = createApi();\ntv4.addLanguage(\'en-gb\', ErrorMessagesDefault);\n\n//legacy property\ntv4.tv4 = tv4;\n\nreturn tv4; // used by _header.js to globalise.\n\n}));'},"553f5f012df3beea631e":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("vintage",{color:["#d87c7c","#919e8b","#d7ab82","#6e7074","#61a0a8","#efa18d","#787464","#cc7e63","#724e58","#4b565b"],backgroundColor:"rgba(254,248,239,1)",textStyle:{},title:{textStyle:{color:"#333333"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:4,symbol:"emptyCircle",smooth:!1},radar:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:4,symbol:"emptyCircle",smooth:!1},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#c23531",color0:"#314656",borderColor:"#c23531",borderColor0:"#314656",borderWidth:1}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:4,symbol:"emptyCircle",smooth:!1,color:["#d87c7c","#919e8b","#d7ab82","#6e7074","#61a0a8","#efa18d","#787464","#cc7e63","#724e58","#4b565b"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#eeeeee",borderColor:"#444444",borderWidth:.5},label:{color:"#000000"},emphasis:{itemStyle:{areaColor:"rgba(255,215,0,0.8)",borderColor:"#444444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},geo:{itemStyle:{areaColor:"#eeeeee",borderColor:"#444444",borderWidth:.5},label:{color:"#000000"},emphasis:{itemStyle:{areaColor:"rgba(255,215,0,0.8)",borderColor:"#444444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!1,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#293c55",width:1},itemStyle:{color:"#293c55",borderWidth:1},controlStyle:{color:"#293c55",borderColor:"#293c55",borderWidth:.5},checkpointStyle:{color:"#e43c59",borderColor:"#c23531"},label:{color:"#293c55"},emphasis:{itemStyle:{color:"#a9334c"},controlStyle:{color:"#293c55",borderColor:"#293c55",borderWidth:.5},label:{color:"#293c55"}}},visualMap:{color:["#bf444c","#d88273","#f6efa6"]},dataZoom:{backgroundColor:"rgba(47,69,84,0)",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"5988baaf407adbba3b29":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("1bf2fbdb051fe0c57024");n.shape.fishbone.ra.RaphaelPieChart=n.shape.fishbone.ra.SetFigureFB.extend({NAME:"draw2d.shape.fishbone.ra.RaphaelPieChart",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaphaelPieChart</strong>}<br/><br/>",init:function(e,t,a){this._super(o.extend({stroke:0,bgColor:null,width:300,height:300},e),t,a);var i=this;this.updateTickets=0;var r=new n.PieChartInputPort;r.setConnectionDirection(0);var s=new n.layout.locator.TopLocator;r.setName("chartInput0"),this.addPort(r,s);var l=new n.PieChartInputPort,c=new n.layout.locator.LeftLocator;l.setConnectionDirection(3),l.setName("chartInput1"),this.addPort(l,c),this.sites_list_in=[],o.extend(this.userData,{size:{width:300,height:300},col:[],color_type:"counts"}),o.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{size:{type:"object",title:"Size",properties:{width:{type:"integer",default:500},height:{type:"integer",default:300}}},color_type:{type:"string",default:"counts",enum:["counts","conditions","3St"]},clean_data:{type:"boolean",default:!0},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{name:{title:"Name",type:"string",default:""},value:{title:"Value",type:"number",default:""},serie:{type:"object",title:"Chart Series",properties:{areaStyle:{type:"object",title:"Area Style",properties:{fill:{title:"Fill",type:"string"},opacity:{title:"Opacity",type:"number"}}}}},sites_list_out:{type:"array",format:"hidden",title:"Sites List",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}}}}}}}),this.GetHTTPData=function(){this.updateTable()},this.updateTable=function(){if(DEBUG&&console.log("PieChart table Update"),i.svgNodes){var e=i.getUserData();i.setDimension(e.size.width,e.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height;var t={series:[]};if(i.userData.col.length>0){var a=[];i.userData.col.forEach((function(e,t){a.push({value:e.value,name:e.name}),e.serie&&(a[t].serie=e.serie)})),t.series.push({data:a}),t.series.forEach((function(e,t){i.canvas.paper.setStart(),getPieChart(i,i.userData.size.width/2,i.userData.size.height/2,i.userData.size.width/4,e,i.userData.color_type);var a=i.canvas.paper.setFinish();i.setNewData(a)}))}}},i.userData.col=[]},onPortValueChanged:function(e){if(e.getValue().indexOf("ticket")>-1)this.startAnimation(1e3),this.updateTickets=this.updateTickets+1,console.log("RaphaelPieChart update ticket received: "+this.updateTickets);else{if(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),console.log("RaphaelPieChart update data received: "+this.updateTickets),"chartInput0"===e.name||"chartInput1"===e.name){var t="chartInput0"===e.name?0:1,a=this.getInputPort(t).getConnections(),n=this;a.data.forEach((function(t,a){if(e.getValue()===t.getSource().getParent().getId()){var o=t.getSource();if("draw2d.shape.fishbone.cell.Mathnode"===o.parent.NAME||"draw2d.shape.fishbone.cell.SQLnode"===o.parent.NAME||"draw2d.shape.fishbone.ra.RaManyToOne"===o.parent.NAME||"draw2d.shape.fishbone.cell.UDFnode"===o.parent.NAME||"draw2d.shape.fishbone.cell.Codenode"===o.parent.NAME||"draw2d.shape.fishbone.cell.Mapnode"===o.parent.NAME||"draw2d.shape.fishbone.cell.Filternode"===o.parent.NAME||"draw2d.shape.fishbone.cell.CustomFieldnode"===o.parent.NAME){var r=[];if(n.userData.col.forEach((function(e){e.serie&&r.push(e)})),n.userData.col=[],o.userData.sites_list_out.length>0){var s=o.userData.item_name;(n.userData.clean_data?(new i).from(o.userData.sites_list_out).select([{field:s},{field:"val"}]):(new i).from(o.userData.sites_list_out).groupBy(s).count("du_id").select([{field:s},{field:"du_id",text:"val"}])).forEach((function(e,t){n.userData.col.push({value:e.val,name:e[s],sites_list_out:(new i).from(o.userData.sites_list_out).where((function(t,a){return t[s]===e[s]})).select()}),n.userData.col[t]&&r.length&&r.forEach((function(e,a){e.name===n.userData.col[t].name&&(n.userData.col[t].serie=r[a].serie)}))})),n.project=o.getUserData().project,n.scope=o.getUserData().scope,n.sop=o.getUserData().sop,n.updateTable()}}else if(o.userData.sites_list_out.length>0){var l=o.getId(),c=-1;n.userData.col.forEach((function(e,t){e.owner_id===l&&-1!==(c=t)&&(n.userData.col[c]={owner_id:l,value:o.userData.sites_list_out.length,name:o.userData.item_name,task_type:void 0!==o.userData.sites_list_out[0].task_type?o.userData.sites_list_out[0].task_type:""})}))}}}))}this.updateTickets<=0&&this.updateTable()}}})},"5b6edb4a9817549ebdf4":(e,t,a)=>{var n=a("8a868d10b6533e768658");n.layout.locator.BottomOutputPortLocator=n.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.BottomOutputPortLocator",init:function(){this._super()},relocate:function(e,t){var a=t.getParent(),n=1,o=this.NAME,i=1;a.getPorts().each((function(e,a){i=a===t?n:i,n+=a.getLocator().NAME===o?1:0})),this.applyConsiderRotation(t,a.getWidth()/n*i,a.getHeight())}})},"5c78f3f49972b85a1809":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var draw2d=__webpack_require__("8a868d10b6533e768658"),$=__webpack_require__("a45670b3d8fb79ec0258"),Utils=__webpack_require__("8deafab7866a125bb9ca");draw2d.shape.fishbone.ra.RaManyToOne=draw2d.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaManyToOne",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaManyToOne</strong>}<br/><br/><strong>ManyToOne </strong><cite>Node </cite>allows you to select between multiple imput datasets connected to input ports and route data to one output port.",init:function(e,t,a,n){this._super($.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var o=this;this.updateTickets=0,this.sites_list_in=[];var i=this.getUserData();this.updateTickets=0,this.default_user_data={hidden:!1,autoWidth:!1,index:0,slide_show:{interval:2e3,show:!1},routes:[],showConnections:!0},null===i&&this.attr({userData:this.default_user_data});for(var r=0;r<1;r++)this.createPort("output");this.treema_scheme={additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},auto_detect:{type:"boolean",title:"Auto Detect",default:!0},slide_show:{type:"object",title:"Slide Show",default:{interval:2e3,show:!1},properties:{interval:{type:"integer",title:"Interval",default:2e3},show:{type:"boolean",title:"Start",default:!1}}},index:{type:"integer",title:"Mobile Index",default:0}}},this.on("contextmenu",(function(e,t){$.contextMenu({selector:"body",events:{hide:function(){$.contextMenu("destroy")}},callback:$.proxy((function(e,t){switch(e){case"toogleCon":setTimeout((function(){o.toogleConn()}),10);break;case"add_in_port":setTimeout((function(){var e,t;e=new draw2d.RouterInputPort,t=o.getInputPorts().data.length+1,e.setName("routerPort"+t),o.addPort(e),o.layoutPorts(),1===o.getInputPorts().data.length&&o.userData.routes.push({source:e.getId(),target:o.getOutputPort(0).getId()}),o.updateUI()}),10);break;case"next":setTimeout((function(){o.shiftForw(),o.GetHTTPData(),o.updateUI()}),10);break;case"previous":setTimeout((function(){o.shiftBackw(),o.GetHTTPData(),o.updateUI()}),10);break;case"start":setTimeout((function(){o.startTimer(o.userData.slide_show.interval),o.userData.slide_show.show=!0}),10);break;case"stop":setTimeout((function(){o.stopTimer(),o.userData.slide_show.show=!1}),10)}}),this),x:t.x,y:t.y,items:{toogleCon:o.userData.showConnections?{name:"Hide Connections"}:{name:"Show Connections"},sep1:"---------",add_in_port:{name:"Add Input Port",disabled:!n.editor.editorMode},sep2:"---------",next:{name:"Next"},previous:{name:"Previous"},sep3:"---------",start:{name:"Start"},stop:{name:"Stop"}}})})),this.on("timer",(function(e){o.shiftForw(),o.GetHTTPData(),o.updateUI()})),this.GetHTTPData=function(){var e=this;this.userData.routes.forEach((function(t){var a=Utils.getInputPortByID(t.source,o).getConnections();if(a.data&&a.data.length){var n=a.data[0].getSource(),i=Utils.getOutputPortByID(t.target,o);i.setUserData(n.getUserData()),i.getConnections().each($.proxy((function(e,t){var a=t.getTarget();a.setValue(o.getId()),Utils.getMessage(o,a,"data send to"),t.setColor("#777777")}),e))}}))},this.updateUI=function(){var e=this;this.setDimension(100,30+20*o.getInputPorts().data.length),this.repaint();var t=this.getCanvas();t&&(this.userData.slide_show.show?this.startTimer(o.userData.slide_show.interval):this.stopTimer(),t.paper.setStart(),t.paper.rect(0,0,100,30+20*o.getInputPorts().data.length,5).attr({stroke:"#777",opacity:.7}),this.userData.routes.forEach((function(a){var n=Utils.getInputPortByID(a.source,e),o=Utils.getOutputPortByID(a.target,e);e.line?e.line.animate(Raphael.animation({path:getConnection(t.paper,n.shape,o.shape,"none","#777|2",{x:e.getAbsoluteX(),y:e.getAbsoluteY()}).path},600)):e.line=getConnection(t.paper,n.shape,o.shape,"none","#777|2",{x:e.getAbsoluteX(),y:e.getAbsoluteY()}).bg})),this.setNewData(t.paper.setFinish()))},this.setNewData=function(e){o.svgNodes.hide(),o.svgNodes=e,o.applyTransformation(),o.repaint()},this.shiftForw=function(){var e=this.getInputPorts().data.indexOf(Utils.getInputPortByID(this.userData.routes[0].source,this));e===this.getInputPorts().data.length-1?this.userData.routes[0].source=this.getInputPorts().data[0].getId():this.userData.routes[0].source=this.getInputPorts().data[e+1].getId()},this.shiftBackw=function(){var e=this.getInputPorts().data.indexOf(Utils.getInputPortByID(this.userData.routes[0].source,this));this.userData.routes[0].source=0===e?this.getInputPorts().data[this.getInputPorts().data.length-1].getId():this.getInputPorts().data[e-1].getId()},o.updateUI()},applyTransformation:function(){var e="T"+this.getAbsoluteX()+","+this.getAbsoluteY();this.svgNodes.transform(e)},createShapeElement:function(){var e=this._super();return this.originalWidth=100,this.originalHeight=30+20*this.getInputPorts().data.length,e},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1){this.updateTickets=this.updateTickets+1,Utils.getMessage(t,e,"ticket received from");var a=0;this.userData.conn_count?a=this.userData.conn_count:this.getInputPorts().data.forEach((function(e,t){a+=e.getConnections().data.length})),this.updateTickets>=a&&this.getOutputPorts().data.forEach((function(a,n){a.getConnections().each($.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=1,o.setValue("ticket,"+t.id+","+t.userData.label),o.superUpdate=!!e.superUpdate,Utils.getMessage(t,o,"ticket send to"),n.setColor("#dfdfdf")}),this))}))}else Utils.getMessage(t,e,"update data received from"),this.updateTickets=0,this.userData.auto_detect&&(this.userData.routes[0].source=e.getId()),e.getId()===this.userData.routes[0].source&&(this.GetHTTPData(),this.updateUI())},createSet:function(){return this.canvas.paper.setStart(),this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight(),5).attr({stroke:"#777",opacity:.7}),this.canvas.paper.setFinish()},applyAlpha:function(){},addPort:function(e,t){return this._super(e,t),e},getPersistentAttributes:function(){var e=this._super();return e.labels=[],this.children.each((function(t,a){var n=a.figure.getPersistentAttributes();n.locator=a.locator.NAME,e.labels.push(n)})),e},setPersistentAttributes:function setPersistentAttributes(memento){this._super(memento),this.resetChildren(),this.userData=$.extend(!0,{},this.default_user_data,this.userData),$.each(memento.labels,$.proxy((function(i,json){var figure=eval("new "+json.type+"()");figure.attr(json);var locator=eval("new "+json.locator+"()");this.add(figure,locator)}),this))}})},"5d29313f1596c9b18a9b":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var draw2d=__webpack_require__("8a868d10b6533e768658"),$=__webpack_require__("a45670b3d8fb79ec0258"),alasql=__webpack_require__("d1be49724a1f416e7f57");function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperty(e,t,a){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}draw2d.shape.fishbone.ra.RaTopology=draw2d.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaTopology",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaTopology</strong>}<br/><br/>",init:function(e,t,a){var n=this;this._super($.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var o=this;this.updateTickets=0;var i=new draw2d.InputPort;i.setConnectionDirection(3);var r=new draw2d.layout.locator.InputPortLocator;i.setName("topology_port"),this.addPort(i,r);var s=new draw2d.InputPort;s.setConnectionDirection(3),s.setName("data_port"),this.addPort(s,r),this.sites_list_in=[];var l=this.getUserData();function c(){var e=Raphael.animation(_defineProperty({opacity:0},"opacity",1),1e3);shape.animate(e.repeat(interval))}this.default_user_data={hidden:!1,autoWidth:!1,index:0,showInConnections:!0},null===l&&this.attr({userData:this.default_user_data}),this.setDimension(100,100),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},index:{type:"integer",title:"Mobile Index",default:0},showInConnections:{type:"boolean",title:"Show Connections",default:!0},popup:template_popup,col:{type:"array",default:{item_name:"",serie:{name:"",type:"line",barWidth:10,data:[]},sites_list_out:[]},title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},serie:template_serie,sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]},owner_id:{type:"string",format:"hidden"},task_type:{type:"string",format:"hidden",properties:{}}}}}}},this.on("contextmenu",(function(e,t){$.contextMenu({selector:"body",events:{hide:function(){$.contextMenu("destroy")}},callback:$.proxy((function(e,t){"toogleCon"===e&&setTimeout((function(){o.toogleConn()}),10)}),this),x:t.x,y:t.y,items:{toogleCon:o.userData.showInConnections?{name:"Hide Connections"}:{name:"Show Connections"}}})})),this.on("resize",(function(e){o.userData.size={width:e.width,height:e.height},n.uChart&&(n.uChart=null),n.updateTable()})),this.GetHTTPData=function(){this.uChart&&(this.uChart=null),this.updateTable()},this.updateTable=function(){console.log(this.NAME+"...updating");var e=this,t=40,a=t,n=25,o=80,i=20;this.topology_data=this.getInputPort("topology_port").getConnections().data[0].getSource().userData.sites_list_out,this.project_data=this.getInputPort("data_port").getConnections().data[0].getSource().userData.sites_list_out;var r=alasql("SELECT tp.site_type1 as ne_id, tp.site_type2 as fe_id, tp.site_type3 as ll_id, pr.* FROM ? as tp left join ? as pr on tp.site_type1 = pr.site_code",[this.topology_data,this.project_data]),s=alasql("select * from ? r where site_code in (SELECT distinct ll.site_type3 as ll_id FROM ? as ll)",[r,this.topology_data]);this.canvas.paper.setStart();var l=this.canvas.paper,c=[],u=function(e,t){return alasql("SELECT r.* FROM ? as r where fe_id like '"+e+"'",[r])};s.forEach((function(r,s){c.push(getTopologyNode(l,a,n,{width:o,height:i,data:r,parent:{data:{RFTI:"done"}},mw:!1,enode:!0},e));var d=u(r.ll_id);if(d&&d.length){a=a+o+t;var p=c[c.length-1];d.forEach((function(r,s){c.push(getTopologyNode(l,a,n,{width:o,height:i,data:r,parent:p},e));var h=u(r.ne_id);if(h&&h.length){a=a+o+t;var f=c[c.length-1];h.forEach((function(r,s){c.push(getTopologyNode(l,a,n,{width:o,height:i,data:r,parent:f},e));var d=u(r.ne_id);if(d&&d.length){a=a+o+t;var p=c[c.length-1];d.forEach((function(r,s){c.push(getTopologyNode(l,a,n,{width:o,height:i,data:r,parent:p},e));var h=u(r.ne_id);if(h&&h.length){a=a+o+t;var f=c[c.length-1];h.forEach((function(r,s){c.push(getTopologyNode(l,a,n,{width:o,height:i,data:r,parent:f},e));var d=u(r.ne_id);if(d&&d.length){a=a+o+t;var p=c[c.length-1];d.forEach((function(r,s){c.push(getTopologyNode(l,a,n,{width:o,height:i,data:r,parent:p},e));var h=u(r.ne_id);if(h&&h.length){a=a+o+t;var f=c[c.length-1];h.forEach((function(t,r){c.push(getTopologyNode(l,a,n,{width:o,height:i,data:t,parent:f},e)),a=760,h.length>1&&r<h.length-1&&(n+=45)}))}a=640,d.length>1&&s<d.length-1&&(n+=45)}))}a=520,h.length>1&&s<h.length-1&&(n+=45)}))}a=400,d.length>1&&s<d.length-1&&(n+=45)}))}a=280,h.length>1&&s<h.length-1&&(n+=45)}))}a=160,d.length>1&&s<d.length-1&&(n+=45)}))}a=t,n+=90}));var d=this.canvas.paper.setFinish();this.setNewData(d),e.updateTickets=0},this.initDataUpdate=function(e){this.uTopology=void 0},this.updateChartData=function(e){var t=this;e.series.forEach((function(e,a){if(t.uChart.series[a])t.uChart.series[a].update({data:e.data}),o.applyTransformation();else{var n=t.uChart.addSerie(e);o.svgNodes.push(n),o.applyTransformation()}}))},this.setNewData=function(e){o.svgNodes.hide(),o.svgNodes=e,o.applyTransformation(),o.repaint()},this.startAnimation=function(e){if(!o.getCanvas().silentMode){this.canvas.paper.setStart(),this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading...").attr({fill:"#777",stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),c();var t=this.canvas.paper.setFinish();this.setNewData(t)}},this.on("removed",(function(){var e=[];o.getPorts().data.forEach((function(t,a){t.getConnections().data.forEach((function(t,a){e.push(t)}))}))}),this),o.userData.col=[]},createShapeElement:function(){var e=this._super();return this.originalWidth=100,this.originalHeight=100,e},onPortValueChanged:function(e){e.getValue().indexOf("ticket")>-1?(void 0!==e.userData.realCount?this.updateTickets=this.updateTickets+e.userData.realCount:this.updateTickets=this.updateTickets+1,console.log(this.NAME+" update ticket received: "+this.updateTickets)):(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),console.log(this.NAME+"  update data received: "+this.updateTickets),this.updateTickets<=0&&(this.uTopology=null,this.updateTable()))},createSet:function(){this.canvas.paper.setStart();var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"N/A");return e.attr({fill:"#777",stroke:"none",opacity:.5,"font-size":20,"font-weight":"bold"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},applyAlpha:function(){},addPort:function(e,t){return this._super(e,t),e},getPersistentAttributes:function(){var e=this._super();return e.labels=[],this.children.each((function(t,a){var n=a.figure.getPersistentAttributes();n.locator=a.locator.NAME,e.labels.push(n)})),e},setPersistentAttributes:function setPersistentAttributes(memento){this._super(memento),this.resetChildren(),this.userData=$.extend(!0,{},this.default_user_data,this.userData),$.each(memento.labels,$.proxy((function(i,json){var figure=eval("new "+json.type+"()");figure.attr(json);var locator=eval("new "+json.locator+"()");this.add(figure,locator)}),this))}})},"5f70f5db0bc3dc9cd6c8":(e,t,a)=>{"use strict";a.r(t),a.d(t,{chart_examples:()=>c,core_concepts:()=>r,dataQualityMapping:()=>g,dataset_visualization_mapping:()=>u,default:()=>_,getVisualizationMapping:()=>y,lineBarChartMapping:()=>d,nodeClassNames:()=>n,nodeTypeMapping:()=>o,node_types:()=>s,pieChartMapping:()=>p,required_properties:()=>l,reverseClassMapping:()=>i,scatterChartMapping:()=>h,tableMapping:()=>m,treeChartMapping:()=>f});var n={1:"Project Node",2:"DU Model Node",3:"Task Node",4:"Custom Field Node",5:"SQL Node",6:"Union Node",7:"Transform Node",8:"Echarts Node",9:"Vega Chart Node",10:"Table Node",11:"HTML Node",12:"Style Node",13:"Math Node",14:"Filter Node"},o={1:"draw2d.shape.fishbone.cell.Projectnode_api",2:"draw2d.shape.fishbone.cell.DUModelnode_api",3:"draw2d.shape.fishbone.cell.Datanode",4:"draw2d.shape.fishbone.cell.CustomFieldnode",5:"draw2d.shape.fishbone.cell.SQLnode",6:"draw2d.shape.fishbone.cell.Unionnode",7:"draw2d.shape.fishbone.cell.Transformnode",8:"draw2d.shape.fishbone.ra.RaEchartAdapter",9:"draw2d.shape.fishbone.ra.RaVegaChart",10:"draw2d.shape.fishbone.ra.RaTableAdapter",11:"draw2d.shape.fishbone.cell.HTMLnode",12:"draw2d.shape.fishbone.cell.Stylenode",13:"draw2d.shape.fishbone.cell.Mathnode",14:"draw2d.shape.fishbone.cell.Filternode"},i={"draw2d.shape.fishbone.cell.Projectnode_api":1,"draw2d.shape.fishbone.cell.DUModelnode_api":2,"draw2d.shape.fishbone.cell.Datanode":3,"draw2d.shape.fishbone.cell.CustomFieldnode":4,"draw2d.shape.fishbone.cell.SQLnode":5,"draw2d.shape.fishbone.cell.Unionnode":6,"draw2d.shape.fishbone.cell.Transformnode":7,"draw2d.shape.fishbone.ra.RaEchartAdapter":8,"draw2d.shape.fishbone.ra.RaVegaChart":9,"draw2d.shape.fishbone.ra.RaTableAdapter":10,"draw2d.shape.fishbone.cell.HTMLnode":11,"draw2d.shape.fishbone.cell.Stylenode":12,"draw2d.shape.fishbone.cell.Mathnode":13,"draw2d.shape.fishbone.cell.Filternode":14,"draw2d.shape.fishbone.ra.RaTablenode":16},r="\n- Data Flow: Data originates from the Projectnode_api (root node) and flows sequentially through connected nodes. Multiple DU Model Nodes can to be connected to Projectnode_api node. Flow can split and merge using data manipulation nodes.\n- Nodes & Ports: Each node performs a specific function (data acquisition, manipulation, presentation). Nodes connect via input/output ports.\n- Connections: Link nodes using a Connection class specifying source (source node ID) and target (target node ID). STRICTLY all nodes must have at least one input connection, with special attention to Math Nodes which require input connections even when only generating data. This ensures proper data flow and system consistency.- Project Context: The root Projectnode_api provides proj_id, proj_name, and proj_code propagated downstream.\n- Data Manipulation: Primarily uses the Transform Node for most data manipulation operations (grouping, sorting, filtering, etc.). The AlaSQL Node is limited to basic selection and joining operations. Complex logic should be combined in one Transform nodes, when possible. STRICTLY: it is not required to filter data by specific Project, by DU Model name or by Task name/code if data derived from such nodes. \n- Report Output: Achieved via Presentation Nodes (Charts, Tables, HTML) rendering data within specified HTML containers.",s='\nA. Data Acquisition Nodes\n1.    Project Node (node_class_name: draw2d.shape.fishbone.cell.Projectnode_api, class_id: 1)\no     Purpose: Top-level entity; starting point for all reports.\no     Key Properties: proj_id, proj_name, proj_code. Crucial: At least one of key properties has to be extructed from user prompt.\no     Data: Passes its properties downstream.\n\n2.     DU Model Node (node_class_name: draw2d.shape.fishbone.cell.DUModelnode_api, class_id: 2)\no     Purpose: Represents a Delivery Unit model within a project, containing a list of Delivery Units (DUs).\no     Key Properties: du_model_id, du_model_name.\nData Fields: See sample data structure:\n{\n            "proj_id": "87ae0fae-ae5f-2449-901c-c2743c253088",\n            "product_domain": "Wireless RAN",\n            "du_model_name": "5G Survey",\n            "du_model_id": "2783788536911550150",\n            "site_code": "DERE",\n            "site_id": "a07327832d15d409237a913136d12377",\n            "region": "Central",\n            "du_code": "DU00004316500",\n            "du_name": "Wireless RAN/5G Survey/DERE",\n            "du_id": "8728553282148077252",\n            "du_status": "ENABLED",\n            "phase_code": "Batch 3 - 1500",\n            "cluster": "",\n            "site_model_name": "Wireless RAN",\n            "longitude": "101.69",\n            "latitude": "3.10479",\n            "state": "Kuala Lumpur"\no             },\n\n3. Task (Activity) Node (node_class_name: draw2d.shape.fishbone.cell.Datanode, class_id: 3)\n   Purpose: Retrieves data for a single specific task/activity related to DUs.\n   Key Properties: scope_task_code, scope_task_name, scope_task_id.\n   Task Type: "task_type" field is determines task data type: "actual", "forecast". Default value is "actual". Only one data type can be fetch at the time.\n   Connection: STRICTLY Connected to a DU Model Node or data derived from it.\n   Constraint: Must represent only ONE task. Multiple tasks require multiple Task Nodes. (e.g., scope_task_name: "Task A, Task B" is invalid).\n   Default Filter: Retrieves \'Completed\' tasks unless specified otherwise (the user request implies \'Completed\').\n   Field my_date: this field is string representation of Date when task is completed. Please ALWAYS convert string value to required format.\n   Key Data Fields: See provided sample structure:\n   {\n     "du_id": "162711712924778595",\n     "site_id": "18b0c8795194c780c21d84fba42ed86f",\n     "du_code": "DU00004420318",\n     "site_code": "SSGB",\n     "my_date": "2024-11-28 00:00:00",\n     "status": "Completed",\n     "obs_name": "null",\n     "responsible_user_en": "MUHAMMAD",\n     "responsible_user_cn": "MUHAMMAD",\n     "assign_flag": "N",\n     "problem_type": "null",\n     "remark": "null",\n     "task_type": "actual",\n     "scope_task_name": "Site Survey",\n     "scope_task_code": "AC0000141889",\n     "du_model_name": "5G Survey",\n     "du_model_id": "2783788536911550150",\n     "proj_id": "87ae0fae-ae5f-2449-901c-c2743c253088",\n     "region": "Eastern",\n     "phase_code": "New Proposed"\n   }\no     \n\n4.     DU Custom Field Node (node_class_name: draw2d.shape.fishbone.cell.CustomFieldnode, class_id: 4)\no     Purpose: Retrieves user-defined field data associated with DUs.\no     Key Properties: field_code, field_name.\no     Connection: STRICTLY Connected to a DU Model Node or data derived from it.\nKey Data Fields: died, field_name, [value], etc. See provided sample for full structure:\n{\n            "proj_id": "87ae0fae-ae5f-2449-901c-c2743c253088",\n            "site_id": "f4e4ee65dce034237093342c69c6d4b3",\n            "site_code": "ANDE",\n            "du_id": "4747361259506909980",\n            "du_code": "DU00004226820",\n            "du_name": "Wireless RAN/5G Survey/ANDE",\n            "du_model_name": "5G Survey",\n            "field_code": "ZDCSZ00918525",\n            "field_name": "TSS Subcon",\n            "field_owner": "",\n            "value": "NR"\n        },\no     \n\nB. Data Manipulation Nodes\n1.     AlaSQL Node (node_class_name: draw2d.shape.fishbone.cell.SQLnode, class_id: 5) \no     Purpose: Performs basic data selection and joining operations using AlaSQL.js library.\no     Key Property: sql (contains the SQL query string).\no     SQL Syntax Rules:\n    STRICTLY follow Alasql.js documentation and requirements below. \n     Use SELECT statements only.\n     Only perform SELECT and JOIN operations in this node.\n     For all other operations (grouping, sorting, filtering, etc.), use the Transform node.\n     ? Placeholder: Represents data input from connected nodes in sequential order. Must be used in FROM or JOIN clauses (e.g., FROM ? AS a JOIN ? AS b ...) that\'s why it is VERY IMPORTANT to connect input data in corresponding order. \n     Bracket Notation []: MANDATORY for field names that are SQL keywords (e.g., [value]) or contain spaces (e.g., [Subcon TI]).\n     Tables Aliases: Use short (1-3 chars), non-keyword aliases for tables (e.g., FROM ? AS a). \n     Fields Aliases: \n     - ALWAYS use [] for fields aliases\n     - NEVER use SQL keywords, special words, or function names like "count", "sum", "date", "id", "name", "value", "group", "order", "key", "type", "from", "select", "as", "where", "by", "having", "min", "max", "avg" as field aliases\n     - Always prefix these with a descriptive word, such as "task_count", "region_sum", "survey_date", "customer_id", etc\n     - This rule applies in all contexts including column aliases after SELECT, CASE statements, and computed fields\n     - Examples of prohibited aliases: "count", "date", "id"\n     - Examples of valid aliases: "task_count", "survey_date", "customer_id"\n     Explicit Columns: Always specify column names after SELECT (avoid SELECT * unless trivial).\n     Joins: Clearly define JOIN conditions using appropriate fields.\n     Supported join types:\n        [INNER JOIN](Inner Join)\n        [LEFT [OUTER] JOIN](Left Join)\n        [RIGHT [OUTER] JOIN](Right Join)\n        [[FULL] OUTER JOIN](Outer Join)\n        [ANTI JOIN](Anti Join)\n        [SEMI JOIN](Semi Join)\n        [CROSS JOIN](Cross Join)\n        [NATURAL JOIN](Natural Join)\n        \n2.     Union Node (node_class_name: draw2d.shape.fishbone.cell.Unionnode, class_id: 6) \no     Purpose: Combine connected datasets in one by using SQL "UNION ALL" statement. Use it when you need to combine same structure datasets into one.\no     Key Property: does  not require any configuration.\n\n3.     Transform Node (node_class_name: draw2d.shape.fishbone.cell.Transformnode, class_id: 7) \no     Purpose: Primary data manipulation solution for all operations beyond basic selection and joining. Handles grouping, accumulation, sorting, filtering, impute, and other data transformations according to Vega.js transforms documentation.\no     Key Property: \n        - transform: vega spec transform array.\no   Requirements: Include only transform array without any other component of Vega configuration JSON\no   Connection Constraint: CRITICAL Transform node can have only one input connection. Multiple input connections are not allowed.\no   Data Source Scope: All transforms operate *exclusively* on the single data stream provided by the input connection (implicitly named "table"). Expressions referencing other data sources (e.g., \'data(\'another_source\')\') or the own input source (e.g., \'data(\'table\')\') are **strictly forbidden**. Use \'datum\' to access fields within the current data record.\no   Signal Prohibition: The use or reference of Vega signals within the \'transform\' array is **strictly forbidden**. Transforms must operate solely on the input data stream.\no   Preferred Data Manipulation Solution:\n     - Use Transform node as the primary tool for all data manipulation operations\n     - Combine multiple transformations in the same node when logically related\n     - Operations that should be performed in Transform node (not SQL node):\n       * Grouping and aggregation (using "aggregate" transform)\n       * Sorting (using "collect" transform with "sort" property)\n       * Filtering (using "filter" transform) \n       * Imputation of missing values (using "impute" transform)\n       * Pivoting data (using "pivot" transform)\n       * Window calculations and running totals (using "window" transform)\n       * Binning numeric values (using "bin" transform)\n       * Formula calculations (using "formula" transform)\n       * Data sampling (using "sample" transform)\n     - For complex data flows, chain multiple Transform nodes together\n         \no  NOT Allowed transform types: lookup\no  Examples of different transform types applications:\n        "aggregate" (for grouping and summarizing):\n                {\n                "type": "aggregate",\n                "groupby": ["region"],\n                "fields": ["du_id", "value"],\n                "ops": ["count", "sum"],\n                "as": ["region_count", "region_total"]\n                },\n        "aggregate" (Example for min/max):\n                {\n                  "type": "aggregate",\n                  "fields": ["value", "value"], // Field to find min/max for\n                  "ops": ["min", "max"],        // Operations\n                  "as": ["min_value", "max_value"] // Output field names\n                }\n        **CRITICAL RULE for Aggregate:** The number of elements in the \'fields\' array MUST match the number of elements in the \'ops\' array. Each operation in \'ops\' corresponds to the field at the same index in \'fields.\n        *Correct Example:*\n          {\n            "type": "aggregate",\n            "fields": ["weekly_count", "weekly_count", "weekly_count"], // Length 3\n            "ops": ["sum", "max", "min"],                               // Length 3\n            "as": ["total_count", "max_weekly_count", "min_weekly_count"]\n          }\n        *Incorrect Example (lengths mismatch):*\n          {\n            "type": "aggregate",\n            "fields": ["weekly_count"], // Length 1\n            "ops": ["sum", "max", "min"], // Length 3 - ERROR!\n            "as": ["total_count", "max_weekly_count", "min_weekly_count"]\n          }\n        \n        **CRITICAL RULE** "ONLY Valid Vega or Vega-Lite aggregation operations for the \'ops\' array":\n                - count: Total count of data objects.\n                - valid: Count of non-null, non-NaN values.\n                - missing: Count of null or NaN values.\n                - distinct: Count of distinct values.\n                - sum: Sum of values.\n                - mean: Average (mean) of values.\n                - average: Alias for mean. (using shirt version word "avg" is strictly forbidden)\n                - variance: Sample variance.\n                - variancep: Population variance.\n                - stdev: Sample standard deviation.\n                - stdevp: Population standard deviation.\n                - stderr: Standard error of the mean.\n                - median: Median value.\n                - q1: First quartile (25th percentile).\n                - q3: Third quartile (75th percentile).\n                - ci0: Lower boundary of 95% confidence interval.\n                - ci1: Upper boundary of 95% confidence interval.\n                - min: Minimum value.\n                - max: Maximum value.\n                - argmin: Input data object corresponding to the minimum value.\n                - argmax: Input data object corresponding to the maximum value.\n        \n        "collect" (for sorting):\n                {\n                "type": "collect",\n                "sort": {"field": "region_count", "order": "descending"}\n                }\n        \n        "filter" (for filtering data):\n                {\n                "type": "filter",\n                "expr": "datum.subcon_name == \'DATASCO\'"\n                }\n                - IMPORTANT: do not filter data by current Project, current DU Model name or by current Task name/code/status as data already derived from this nodes\n        \n        "formula" (for calculated fields):\n                {\n                "type": "formula",\n                "expr": "datum.value / datum.total * 100",\n                "as": "percentage"\n                }\n                \n        "timeFormat" (for extracting date components):\n                {\n                "type": "formula",\n                "expr": "timeFormat(datum.my_date, \'%Y-W%U\')",\n                "as": "week"\n                }\n                \n        "Common timeFormat patterns":\n                - \'%Y-W%U\': Year-Week (e.g., 2024-W01)\n                - \'%Y-%m\': Year-Month (e.g., 2024-01)\n                - \'%Y-%m-%d\': Year-Month-Day (e.g., 2024-01-15)\n                - \'%b %Y\': Month Year (e.g., Jan 2024)\n        \n        "pivot" (for reshaping data):\n                {\n                "type": "pivot",\n                "groupby": ["country"],\n                "field": "type",\n                "value": "count"\n                }\n        produces the output:\n                [\n                {"country": "Norway",  "gold": 14, "silver": 14, "bronze": 11},\n                {"country": "Germany", "gold": 14, "silver": 10, "bronze":  7},\n                {"country": "Canada",  "gold": 11, "silver":  8, "bronze": 10},\n                ]\n        \n        "window" (for running totals and accumulation):\n                {\n                "type": "window",\n                "groupby": ["category"],\n                "sort": {\n                    "field": "week"\n                },\n                "fields": ["total_cnt"],\n                "ops": ["sum"],\n                "as": ["cumulative"]\n                }\n        \n        "impute" (for filling missing values):\n                {\n                "type": "impute",\n                "field": "value",\n                "key": "date",\n                "method": "value",\n                "value": 0\n                }\n        \n        "bin" (for grouping numeric values):\n                {\n                "type": "bin",\n                "field": "value",\n                "extent": [0, 100],\n                "step": 10,\n                "as": ["bin0", "bin1"]\n                }\n        \n        "Chronological Sorting for Timelines": Ensure data involving timelines is sorted chronologically (e.g., using a "collect" transform with "ascending" order on the formatted time field) to present events logically from past to future.\n\n        "Multiple transforms in one node" (combining operations):\n                [\n                {\n                "type": "aggregate",\n                "groupby": ["region"],\n                "fields": ["du_id"],\n                "ops": ["count"],\n                "as": ["region_count"]\n                },\n                {\n                "type": "collect",\n                "sort": {"field": "region_count", "order": "descending"}\n                }\n                ]\n\n4. Math Node (node_class_name: draw2d.shape.fishbone.cell.Mathnode, class_id: 13)\no Purpose: Performs custom JavaScript-based mathematical operations or complex data transformations that cannot be easily done with SQL or Transform nodes.\no Key Property: do (contains a JavaScript arrow function that processes input data). Please pay special attention when adopting values from functional branches with static data, to update it according to actual report requirements.\no Connection Requirements:\n  - MUST have at least one input connection, SPECIALLY when generating data.\n  - When used for pure data generation (without using input data), STRICTLY maintain one input connection for proper flow and debugging.\no Requirements:\n  - The \'do\' property must contain a JavaScript arrow function: ()=>{ ...code... }\n  - The function must return a valid flat data structure result that can be passed to connected nodes down stream. F.e.:\n  return [\n          { month: \'2025-01\', baseline_count: 200 },\n          { month: \'2025-02\', baseline_count: 145 },\n          { month: \'2025-03\', baseline_count: 206 }\n        ];\n  - Access input stream data inside JavaScript code by using the pattern: let data = dataFactory.getData()\n  - When using input data, properly extract and process it from the dataFactory\n  - When only generating data (without using inputs), still maintain the input connection for system consistency\n  - Result of dataFactory.getData() is data structured as an array of datasets:\n    [\n      {\n        "name": "first dataset name",\n        "values": [first dataset values array]\n      },\n      {\n        "name": "second dataset name",\n        "values": [second dataset values array]\n      }\n    ]\n  - The javaScript function should perform calculations and return processed data as a flat array of objects.\n  - Must follow standard JavaScript syntax\n  - No code fencing (triple backticks or language identifiers) should be included\no     Usage Examples:\n      - Complex mathematical calculations\n      - Statistical analysis\n      - Custom data transformation logic\n      - Data validation and cleaning\n      - Merging or restructuring datasets programmatically\n      - Data generation or simulation\n\n5.     Filter Node (node_class_name: draw2d.shape.fishbone.cell.Filternode, class_id: 14)\no     Purpose: Provides interactive filtering capabilities for the report, allowing end-users to filter data based on specific criteria. Use Transformnode for static filtering.\no     Key Properties:\n      - filter: (Object) Filter configuration defining initial state and options.\n        {\n          value: "initial value",\n          field: "field_name", //data field name from connected input data\n          params: [],\n          searchInResult: false,\n          filter_list: []\n        }\n      - cont_id: (String) Container ID for the filter UI element.\n      - win_size: (String) Size of the filter dialog window ("sm", "md", "lg"). Default Value "lg". \n      - message: (String) Message to display in the filter dialog.\n      - showBusket: (Boolean) Whether to display the selection basket.\no     HTML Container Requirements: here is the code you have to use when inserting filter into html  \n          <div id="filter_node_cont_id_value" class="input-group input-group-sm mb-1">\n                <label class="input-group-text" for="filter_node_cont_id_value">Filter name</label>\n                <input name="filter_node_cont_id_value" disabled type="text" class="form-control">\n                <button class="btn btn-outline-secondary" type="button" id="button-addon2">Set</button>\n            </div>\no     Connection: connected to SINGLE data source nodes that provide filter options.\no     Behavior: Creates an interactive UI element that triggers filtering on connected data when the user makes selections.\n\n\nC. Data Presentation Nodes\n\n1. Echarts Node (node_class_name: draw2d.shape.fishbone.ra.RaEchartAdapter, class_id: 8)\n1.1 Purpose: Renders data as a chart using Echarts.js.\n1.2 Key Properties: \no   cont_id: (String) Target HTML element ID.\no   dataset: (String) JSON string defining data structure for ECharts.\no   config: (String) JavaScript ECharts options object definition.\n1.2.1     "dataset" Value Generation Requirements: \n    o   Analyze the expected data structure from the input node.\n    o   Consider data trends, relations, and hierarchy to determine appropriate dimensions (field names).\n    o   The value MUST be a valid JSON string.\n    o   The JSON string MUST include a "dimensions" array listing the field names derived from the input data structure (e.g., ["product", "date", "value"]).\n    o   The JSON string MUST include a "source" array, which MUST be an empty array ([]).\n    o   The final JSON string format MUST strictly be: \'{"dimensions": [...], "source":[]}\'.\n    o   Ensure all property names ("dimensions", "source") and any string values within the dimensions array are enclosed in double quotes (") for JSON compatibility.\n1.2.2 "config" Value Generation Requirements: \no   Create the content of an ECharts configuration options object.\no   Use the dimensions defined in the sibling dataset property as a structural reference only to configure axes and series encoding.\no   Please consider use of "toolbox" property when suitable and beneficial for visualization.\no   CRITICAL DATA PROPERTY RESTRICTIONS:\n     -NEVER include ANY "data" property ANYWHERE in the configuration object or sub-objects.\n     -STRICTLY PROHIBITED: All forms of "data: []" or "data: [...]" within ANY object, including but not limited to:\n        * series configurations (e.g., "series: [{ data: [] }]")\n        * axis configurations (e.g., "xAxis: { data: [] }", "yAxis: { data: [] }")\n        * category configurations (e.g., "categories: { data: [] }")\n        * Any other component that might accept a data property.\n    - ALWAYS use the dataset component\'s dimensional mapping via encode properties for data visualization.\n    - All data must be provided exclusively through the dataset mechanism.\n    - When scanning the final configuration, if ANY instance of "data:" appears, it MUST be removed and replaced with proper dataset-based encoding.\no   Make an informed decision on the most suitable series type (e.g., bar, line, pie, scatter) and configure axes (xAxis, yAxis), tooltip, legend, grid, etc., based on the nature and structure of the data inferred from the dataset.dimensions. Aim for a vibrant, coherent, and informative visualization.\no   The final value MUST be a JavaScript string starting exactly with option = { and ending with }.\no   DO NOT include javascript, json, or any other code tags or code fencing around the generated JavaScript string.\no   Provide only the option = { ... } string as the value for the config property.\no   CORRECT EXAMPLE: option = { tooltip: {}, legend: {}, xAxis: { type: \'category\' }, yAxis: {}, series: [{ type: \'bar\', encode: { x: \'dimensionName1\', y: \'dimensionName2\' } }] };\no   INCORRECT EXAMPLE: option = { xAxis: { type: \'category\', data: [] }, series: [{ data: [] }] }; // NEVER USE THIS PATTERN\no   CRITICAL: NEWER use pie series formatters for labels and tooltips in this format: label: { show: true, formatter: \'{b}: {e} ({d}%)\', position: \'outside\' } - use this: \n    - for pie chart:\n                \'label: { show: true, position: \'outside\', formatter: function(value) {\n                                                                                    console.log(value);\n                                                                                        const cnt = value.data.cnt;\n                                                                                        const name = value.name;\n                                                                                        const per = value.percent;\n                                                                                        let str = name + \' \' + cnt + \' \' + \'(\' + per + \'%)\';\n                                                                                        return str;\n                                                                                    }\n                                                                                \n                                                                              }, }\'\n    - for line chart: tooltip: {\n                                valueFormatter: function (value) {\n                                  return value;\n                                }\n                              },\n\n2.     Vega Node (node_class_name: draw2d.shape.fishbone.ra.RaVegaChart, class_id: 8)\n     - Purpose: Render Vega or Vega-Lite visualizations.\n     - Default spec: use Vega-lite specification as preferred\n     - \'data\' object in \'update_node_data\' MUST contain: { cont_id: "...", vis_target: "html", vega: false|true (according to specifications used Vega-Lite|Vega ),  spec: { /* FULL Vega/Vega-Lite JSON spec object */ } }\n     - Rules for \'spec\' generation:\n       - The value MUST be a complete and valid Vega or Vega-Lite JSON specification object. Assume Vega-Lite unless the analysis strongly suggests Vega is necessary.\n       - **CRITICAL DATA STRUCTURE:** Define data sources within the spec using the exact format: \'{"name": "unique_data_source_name", "values": []}\'.\n         - The \'"name"\' property should be a unique identifier for the data source, ideally derived from the connected input node or data context.\n         - The \'"values"\' property MUST be an empty array (\'[]\'). Actual data will be injected later by the system based on the \'"name". Do NOT include actual data values here.\n       - **Strict JSON Formatting (RFC 8259):** The generated JSON object MUST strictly adhere to the following:\n         - All property names (keys) MUST be enclosed in double quotes (\'"\').\n         - All string values MUST be enclosed in double quotes (\'"\').\n         - Use \'true\' and \'false\' (lowercase) for booleans.\n         - Use \'null\' (lowercase) for null values.\n         - Numbers MUST NOT be enclosed in quotes.\n         - No trailing commas are allowed in objects or arrays.\n         - No comments (\'//\' or \'/* */\') are permitted within the JSON structure.\n       - **Output Format:** Provide *only* the JSON object for the \'spec\' property. Do NOT wrap it in backticks, code fences (like \'\'\'json ... \'\'\'), or include any explanatory text or comments outside the valid JSON structure itself.\n       - **Chart Design:** Based on the input data schema and the visualization goal, design an appropriate Vega/Vega-Lite specification (marks, encodings, scales, axes, legends, interactions, etc.) to create a vibrant, coherent, and informative visualization. Make informed decisions about chart types (bar, line, scatter, map, etc.) suitable for the data.\n       - **Field References:** Ensure all \'"field"\' properties correctly reference names that will exist in the data injected later (based on the input data schema).\n\n3.     Table Node (node_class_name: draw2d.shape.fishbone.ra.RaTableAdapter, class_id: 10)\no     Purpose: Renders data as a table using Tabulator.js.\no     Key Properties: \n      - cont_id: (String) Target HTML element ID.\n      - config: (String) has 2 options:\n                1. It can be empty array \'[]\' for columns auto detection. This is PREFERRED option.\n                2. It can be JavaScript configuration object for Tabulator in this format: config = {"height": 355, ...}. here is configuration object example:\n                      config = {\n                            "height": 355,\n                            "movableColumns": true,\n                            "layout": "fitColumns",\n                            "columns": [\n                                {\n                                    "title": "issue_category",\n                                    "field": "issue_category"\n                                },\n                               ....\n                               // columns definition objects according to input data\n                            ]\n                        }\n      - renderer: (String) Table rendering engine (always "tabulator").\n    \n\n5.     HTML Node (node_class_name: draw2d.shape.fishbone.cell.HTMLnode, class_id: 11)\no     Purpose: Renders custom HTML content, potentially incorporating data.\no     Key Properties: \n    - cont_id (target HTML element ID)\n    - html (HTML code string)\n    - binder: "rivets" (optional, enables Rivets.js data binding)\n    - params: Array of parameter definitions for data binding (required when binder="rivets")\no     HTML Content Rules: \n     - Pure HTML, utilizing Bootstrap classes for styling is strictly recommended.\n     - NO <style> or <script> tags.\n     - Include only the content that would go inside the <body> tag (no <html>, <head>, <body> tags themselves within the html property).\n     - Can utilize peity.js for thumbnail charts and other simple visualizations, you can pass data using parameters described below. For example:<span class="bar" data-peity=\'{ "height": 70,  "width": 170}\'>{ params.data.0.chart_data} </span> where chart data string parameter like this: "5,6,3,7,8". Use Mathnode to create appropriate string.\n        here are some examples with expected data, please use rivets bindings { params.data.0.chart_data} in real implementations :\n            <span class="donut">1/5</span>\n            <span class="donut">226/360</span>\n            <span class="donut">0.52/1.561</span>\n            <span class="donut">1,4</span>\n            <span class="donut">226,134</span>\n            <span class="donut">0.52,1.041</span>\n            <span class="donut">1,2,3,2,2</span>\n            <span class="bar" data-peity=\'{ "height": 70,  "width": 170}\'>23,345,67,34,23,76</span>\n            <span class="bar">5,3,2,-1,-3,-2,2,3,5,2</span>\n            <span class="bar">0,-3,-6,-4,-5,-4,-7,-3,-5,-2</span>\n            <span class="bar-colours-1">5,3,9,6,5,9,7,3,5,2</span>\n            <span class="bar-colours-2">5,3,2,-1,-3,-2,2,3,5,2</span>\n            <span class="bar-colours-3">0,-3,-6,-4,-5,-4,-7,-3,-5,-2</span>\n            <span class="pie-colours-1">4,7,6,5</span>\n            <span class="pie-colours-2">5,3,9,6,5</span>\n            <span class="line">5,3,9,6,5,9,7,3,5,2</span>\n            <span class="line">5,3,2,-1,-3,-2,2,3,5,2</span>\n            <span class="line">0,-3,-6,-4,-5,-4,-7,-3,-5,-2</span>\n            <span class="donut" data-peity=\'{ "fill": ["red", "#eeeeee"],    "innerRadius": 10, "radius": 40 }\'>1/7</span>\n            <span class="donut" data-peity=\'{ "fill": ["orange", "#eeeeee"], "innerRadius": 14, "radius": 36 }\'>2/7</span>\n\no     Data Binding with Rivets.js:\n    - When binder="rivets", the node supports dynamic data binding using Rivets.js\n    - Parameters are defined in the params array with structure:\n        {\n            param_name: "name",      // Binding variable name\n            param_source: "source",  // Data source node label parameter\n            prop_type: "list", // Data type, Always "list"\n            param_details: "sites_list_out",   // Source field name. Always "sites_list_out"\n            full_data: true    // Whether to bind full array or just values. Always true\n        }\n    - Binding Patterns:\n        * Array iteration: rv-each-item="params.list"\n        * Nested properties: { params.param_1.0.field } // REQUIRED, always started from "params" reference, like params.param_name.0.field_name  f.e.: params.param_1.0.field, \n    - Example Configurations:\n     * for Array iteration\n        {\n            "binder": "rivets",\n            "params": [\n                {\n                    "param_name": "data",\n                    "param_source": "source_item",\n                    "prop_type": "list",\n                    "param_details": "sites_list_out", //always "sites_list_out"\n                    "full_data": true\n                }\n            ],\n            "html": "<div rv-each-item="params.data">{ item.field }</div>" // rv-each-item always started from "params" reference, like params.param_name  f.e.: params.data, \n        }\n      * for Nested properties\n        { \n          "html": "<h5>{ params.par.0.f_el }</h5>", //html property MAST consist html code with rivets binding reference, where 0 is index of item in data (\'sites_list_out\') array, \'f_el\' is field name.\n          "binder": "rivets",\n          "params": [\n            {\n              "param_name": "par",\n              "param_source": "New Query",\n              "prop_type": "list",\n              "param_details": "sites_list_out", //always "sites_list_out",\n              "full_data": true\n            }\n          ],\n          "label": "New Label",\n          "type_name": "html"\n        }\n\n6.     Style Node (node_class_name: draw2d.shape.fishbone.cell.Stylenode, class_id: 12)\no     Purpose: Provides CSS styling for the report.\no     Key Property: style (contains CSS rules to apply to the report).\no     Usage: Connect to the HTML structure to apply custom styling beyond Bootstrap.\no     Connection: Style node MAST be connected to DU Model node.\no     Content: CSS rules without <style> tags. Example:\n     {\n       "style": ".card { border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); } .highlight { font-weight: bold; color: #007bff; }"\n     }',l={Projectnode_api:["proj_id","proj_name","proj_code"],DUModelnode_api:["du_model_name","du_model_id"],Datanode:["scope_task_name","scope_task_code","scope_task_id","task_type"],CustomFieldnode:["field_name","field_code"],SQLnode:["sql"],Unionnode:[],Transformnode:["transform"],RaEchartAdapter:["cont_id","dataset","config"],RaVegaChart:["cont_id","spec","vega","leaflet","vis_target"],RaTableAdapter:["cont_id"],HTMLnode:["cont_id","html"],Stylenode:["style"],Mathnode:["do"],Filternode:["filter","cont_id"],RaTablenode:[]},c={timeSeries:{description:"Best for visualizing trends over time (daily, weekly, monthly, yearly data)",dataset:'{"dimensions": ["date", "trendA", "trendB"], "source": []}',config:"option = {\n      title: { text: 'Time Series Data', left: 'center' },\n      tooltip: { trigger: 'axis' },\n      xAxis: { type: 'time' },\n      yAxis: { type: 'value' },\n      series: [\n        { name: 'Trend A', type: 'line', encode: { x: 'date', y: 'trendA' } },\n        { name: 'Trend B', type: 'line', encode: { x: 'date', y: 'trendB' } }\n      ]\n    }"},pieChart:{description:"Optimal for showing composition and proportion of a whole (parts of 100%)",dataset:'{"dimensions": ["name", "value", "color"], "source": []}',config:"option = {\n          title: { \n            text: 'Distribution', \n            left: 'center',\n            textStyle: { fontSize: 16 }\n          },\n          tooltip: { \n            trigger: 'item'\n          },\n          legend: {\n            orient: 'vertical',\n            left: 'left'\n          },\n          series: [{\n            name: 'Categories',\n            type: 'pie',\n            radius: ['40%', '70%'], // Donut chart - change to '70%' for full pie\n            center: ['50%', '50%'],\n            encode: { \n              itemName: 'name', \n              value: 'value' \n            },\n            label: { \n              show: true, \n              position: 'outside',\n              fontSize: 12,\n              formatter: function(params) {\n                try {\n                  console.log(params);\n                  const value = params.data?.value || params.value || 0;\n                  const name = params.name || 'Unknown';\n                  const percent = params.percent || 0;\n                  return name + '\\n' + value + ' (' + percent.toFixed(1) + '%)';\n                } catch (error) {\n                  console.error('Label formatter error:', error);\n                  return params.name || 'Error';\n                }\n              }\n            },\n            labelLine: {\n              show: true,\n              length: 10,\n              length2: 20\n            },\n            emphasis: {\n              itemStyle: {\n                shadowBlur: 10,\n                shadowOffsetX: 0,\n                shadowColor: 'rgba(0, 0, 0, 0.5)'\n              }\n            }\n          }]\n        }"},barChart:{description:"Ideal for comparing values across categories",dataset:'{"dimensions": ["category", "value1", "value2"], "source": []}',config:"option = {\n      title: { text: 'Category Comparison', left: 'center' },\n      tooltip: { trigger: 'axis' },\n      xAxis: { type: 'category' },\n      yAxis: { type: 'value' },\n      series: [\n        { name: 'Value 1', type: 'bar', encode: { x: 'category', y: 'value1' } },\n        { name: 'Value 2', type: 'bar', encode: { x: 'category', y: 'value2' } }\n      ]\n    }"},scatterChart:{description:"Perfect for showing relationships between two variables",dataset:'{"dimensions": ["xValue", "yValue", "size", "category"], "source": []}',config:"option = {\n      title: { text: 'Correlation Analysis', left: 'center' },\n      tooltip: { trigger: 'item' },\n      xAxis: { type: 'value' },\n      yAxis: { type: 'value' },\n      series: [{\n        type: 'scatter',\n        encode: { x: 'xValue', y: 'yValue', tooltip: ['xValue', 'yValue', 'category'] },\n        symbolSize: function(data) { return data[2] * 5; }\n      }]\n    }"}},u='\n1. Dataset Structure Requirements by Chart Type:\n\n   a. Line/Bar Charts:\n      - Dimensions: ["category", "value1", "value2", ...]\n      - For time series: ["date", "value1", "value2", ...]\n      - **For stacked bar charts:** Use format ["category", "subcategory", "value"] to enable proper stacking\n      - **Crucially, ensure time series data is sorted chronologically (ascending order) using a Transform node before visualization.**\n      - Date fields should be properly formatted for time axis using \'timeFormat\' if necessary.\n      - **For multiple line series:** The dataset MUST be in a "wide" format. Use one dimension for the shared X-axis (e.g., "date" or "category") and separate dimensions for each line\'s Y-axis values (e.g., "seriesA_value", "seriesB_value"). This often requires using a "pivot" transform beforehand.\n      - Example (Multi-series Line): {"dimensions": ["date", "trendA", "trendB"], "source": []}\n      - Example (Single Bar): {"dimensions": ["month", "sales"], "source": []}\n      - Example (Stacked Bar): {"dimensions": ["region", "status", "count"], "source": []}\n\n      **Required Transform Arrays for Line/Bar Charts:**\n\n      Single Series Time Series:\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-%m-%d\')",\n          "as": "date"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["date"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "date", "order": "ascending"}\n        }\n      ]\n\n      Multi-Series Line Chart (Comparative Trends):\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-%m\')",\n          "as": "month"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["month", "region"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["task_count"]\n        },\n        {\n          "type": "pivot",\n          "groupby": ["month"],\n          "field": "region",\n          "value": "task_count"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "month", "order": "ascending"}\n        }\n      ]\n\n      Weekly Aggregation with Running Total:\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-W%U\')",\n          "as": "week"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["week"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["weekly_count"]\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "week", "order": "ascending"}\n        },\n        {\n          "type": "window",\n          "sort": {"field": "week"},\n          "fields": ["weekly_count"],\n          "ops": ["sum"],\n          "as": ["cumulative_total"]\n        }\n      ]\n\n      Category Comparison Bar Chart:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["task_count"]\n        },\n        {\n          "type": "pivot",\n          "groupby": ["region"],\n          "field": "status",\n          "value": "task_count"\n        }\n      ]\n\n      Stacked Bar Chart (Tasks by Region and Status):\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status",\n          "as": "subcategory"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "category", "order": "ascending"}\n        }\n      ]\n\n      Stacked Bar Chart (Time Series with Multiple Categories):\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-%m\')",\n          "as": "month"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["month", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.month",\n          "as": "category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status",\n          "as": "subcategory"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "month", "order": "ascending"}\n        }\n      ]\n\n   b. Pie/Doughnut Charts:\n      - Dimensions: ["name", "value", "color"]\n      - Name field contains category labels\n      - Value field contains numeric values for each segment\n      - Color field (optional) for custom segment colors\n      - Example: {"dimensions": ["region", "sales", "color"], "source": []}\n\n      **Required Transform Arrays for Pie/Doughnut Charts:**\n\n      Basic Distribution:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "name"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "value", "order": "descending"}\n        }\n      ]\n\n      Distribution with Custom Colors:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status",\n          "as": "name"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status === \'Completed\' ? \'#28a745\' : datum.status === \'In Progress\' ? \'#ffc107\' : \'#dc3545\'",\n          "as": "color"\n        }\n      ]\n\n      Percentage-based Distribution:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "joinaggregate",\n          "fields": ["value"],\n          "ops": ["sum"],\n          "as": ["total"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.value / datum.total * 100",\n          "as": "percentage"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "name"\n        }\n      ]\n\n   c. Scatter/Bubble Charts:\n      - Dimensions: ["xValue", "yValue", "size", "category"]\n      - xValue and yValue for positioning points\n      - size (optional) for bubble size\n      - category (optional) for grouping/coloring points\n      - Example: {"dimensions": ["income", "lifeExpectancy", "population", "country"], "source": []}\n\n      **Required Transform Arrays for Scatter/Bubble Charts:**\n\n      Basic Correlation Analysis:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["site_code", "region"],\n          "fields": ["longitude", "latitude"],\n          "ops": ["mean", "mean"],\n          "as": ["xValue", "yValue"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        }\n      ]\n\n      Bubble Chart with Size Dimension:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["site_code", "region"],\n          "fields": ["longitude", "latitude", "du_id"],\n          "ops": ["mean", "mean", "count"],\n          "as": ["xValue", "yValue", "size"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        }\n      ]\n\n      Multi-dimensional Analysis:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "phase_code"],\n          "fields": ["longitude", "latitude", "du_id"],\n          "ops": ["mean", "mean", "count"],\n          "as": ["xValue", "yValue", "size"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.phase_code",\n          "as": "color"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region + \' (\' + datum.size + \')\'",\n          "as": "label"\n        }\n      ]\n\n   d. Tree/Hierarchy Charts:\n      - Dimensions: ["name", "value", "parent", "children", "level"]\n      - Requires parent-child relationships\n      - May need special data structure with nested children arrays\n      - Example: {"dimensions": ["name", "value", "parent"], "source": []}\n\n      **Required Transform Arrays for Tree/Hierarchy Charts:**\n\n      Basic Hierarchical Structure:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "phase_code", "du_model_name"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.du_model_name",\n          "as": "name"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.phase_code",\n          "as": "parent"\n        }\n      ]\n\n   e. Specialized Chart Types:\n\n      **Stacked Bar Chart (Basic):**\n      Dimensions: ["category", "subcategory", "value"]\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status",\n          "as": "subcategory"\n        }\n      ]\n\n      **Stacked Bar Chart (Normalized/Percentage):**\n      Dimensions: ["category", "subcategory", "value", "percentage"]\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "joinaggregate",\n          "groupby": ["region"],\n          "fields": ["value"],\n          "ops": ["sum"],\n          "as": ["category_total"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.value / datum.category_total * 100",\n          "as": "percentage"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status",\n          "as": "subcategory"\n        }\n      ]\n\n      **Heatmap Matrix:**\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "phase_code"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "x_category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.phase_code",\n          "as": "y_category"\n        }\n      ]\n\n      **Calendar Heatmap:**\n      [\n        {\n          "type": "formula",\n          "expr": "toDate(datum.my_date)",\n          "as": "parsed_date"\n        },\n        {\n          "type": "formula",\n          "expr": "timeFormat(datum.parsed_date, \'%Y-%m-%d\')",\n          "as": "date"\n        },\n        {\n          "type": "formula",\n          "expr": "day(datum.parsed_date)",\n          "as": "day_of_week"\n        },\n        {\n          "type": "formula",\n          "expr": "week(datum.parsed_date)",\n          "as": "week_of_year"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["date", "day_of_week", "week_of_year"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        }\n      ]\n\n   f. Data Quality Transform Patterns:\n\n      **Handle Missing Values:**\n      [\n        {\n          "type": "filter",\n          "expr": "datum.my_date != null && datum.my_date != \'\'"\n        },\n        {\n          "type": "impute",\n          "field": "value",\n          "key": "date",\n          "method": "value",\n          "value": 0\n        }\n      ]\n\n      **Outlier Removal:**\n      [\n        {\n          "type": "aggregate",\n          "fields": ["value"],\n          "ops": ["q1", "q3"],\n          "as": ["q1", "q3"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.q3 - datum.q1",\n          "as": "iqr"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.q1 - 1.5 * datum.iqr",\n          "as": "lower_bound"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.q3 + 1.5 * datum.iqr",\n          "as": "upper_bound"\n        },\n        {\n          "type": "filter",\n          "expr": "datum.value >= datum.lower_bound && datum.value <= datum.upper_bound"\n        }\n      ]\n\n   **Transform Pattern Guidelines:**\n   - Always use proper field/ops array matching in aggregate transforms\n   - Use timeFormat for consistent date formatting: timeFormat(toDate(datum.my_date), \'%Y-%m-%d\')\n   - Apply chronological sorting for time series: {"type": "collect", "sort": {"field": "date", "order": "ascending"}}\n   - Use pivot transforms to convert long to wide format for multi-series charts\n   - Combine multiple transforms in single Transform node when logically related\n   - Handle missing data with filter and impute transforms before visualization\n   - Use formula transforms for calculated fields and data derivations\n',d='\n   a. Line/Bar Charts:\n      - Dimensions: ["category", "value1", "value2", ...]\n      - For time series: ["date", "value1", "value2", ...]\n      - **For stacked bar charts:** Use format ["category", "subcategory", "value"] to enable proper stacking\n      - **Crucially, ensure time series data is sorted chronologically (ascending order) using a Transform node before visualization.**\n      - Date fields should be properly formatted for time axis using \'timeFormat\' if necessary.\n      - **For multiple line series:** The dataset MUST be in a "wide" format. Use one dimension for the shared X-axis (e.g., "date" or "category") and separate dimensions for each line\'s Y-axis values (e.g., "seriesA_value", "seriesB_value"). This often requires using a "pivot" transform beforehand.\n      - Example (Multi-series Line): {"dimensions": ["date", "trendA", "trendB"], "source": []}\n      - Example (Single Bar): {"dimensions": ["month", "sales"], "source": []}\n      - Example (Stacked Bar): {"dimensions": ["region", "status", "count"], "source": []}\n\n      **Required Transform Arrays for Line/Bar Charts:**\n\n      Single Series Time Series:\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-%m-%d\')",\n          "as": "date"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["date"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "date", "order": "ascending"}\n        }\n      ]\n\n      Multi-Series Line Chart (Comparative Trends):\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-%m\')",\n          "as": "month"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["month", "region"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["task_count"]\n        },\n        {\n          "type": "pivot",\n          "groupby": ["month"],\n          "field": "region",\n          "value": "task_count"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "month", "order": "ascending"}\n        }\n      ]\n\n      Weekly Aggregation with Running Total:\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-W%U\')",\n          "as": "week"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["week"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["weekly_count"]\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "week", "order": "ascending"}\n        },\n        {\n          "type": "window",\n          "sort": {"field": "week"},\n          "fields": ["weekly_count"],\n          "ops": ["sum"],\n          "as": ["cumulative_total"]\n        }\n      ]\n\n      Category Comparison Bar Chart:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["task_count"]\n        },\n        {\n          "type": "pivot",\n          "groupby": ["region"],\n          "field": "status",\n          "value": "task_count"\n        }\n      ]\n\n      Stacked Bar Chart (Tasks by Region and Status):\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status",\n          "as": "subcategory"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "category", "order": "ascending"}\n        }\n      ]\n\n      Stacked Bar Chart (Time Series with Multiple Categories):\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-%m\')",\n          "as": "month"\n        },\n        {\n          "type": "aggregate",\n          "groupby": ["month", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.month",\n          "as": "category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status",\n          "as": "subcategory"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "month", "order": "ascending"}\n        }\n      ]\n',p='\n   b. Pie/Doughnut Charts:\n      - Dimensions: ["name", "value", "color"]\n      - Name field contains category labels\n      - Value field contains numeric values for each segment\n      - Color field (optional) for custom segment colors\n      - Example: {"dimensions": ["region", "sales", "color"], "source": []}\n\n      **Required Transform Arrays for Pie/Doughnut Charts:**\n\n      Basic Distribution:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "name"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "value", "order": "descending"}\n        }\n      ]\n\n      Distribution with Custom Colors:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status",\n          "as": "name"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.status === \'Completed\' ? \'#28a745\' : datum.status === \'In Progress\' ? \'#ffc107\' : \'#dc3545\'",\n          "as": "color"\n        }\n      ]\n\n      Percentage-based Distribution:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "joinaggregate",\n          "fields": ["value"],\n          "ops": ["sum"],\n          "as": ["total"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.value / datum.total * 100",\n          "as": "percentage"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "name"\n        }\n      ]\n',h='\n   c. Scatter/Bubble Charts:\n      - Dimensions: ["xValue", "yValue", "size", "category"]\n      - xValue and yValue for positioning points\n      - size (optional) for bubble size\n      - category (optional) for grouping/coloring points\n      - Example: {"dimensions": ["income", "lifeExpectancy", "population", "country"], "source": []}\n\n      **Required Transform Arrays for Scatter/Bubble Charts:**\n\n      Basic Correlation Analysis:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["site_code", "region"],\n          "fields": ["longitude", "latitude"],\n          "ops": ["mean", "mean"],\n          "as": ["xValue", "yValue"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        }\n      ]\n\n      Bubble Chart with Size Dimension:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["site_code", "region"],\n          "fields": ["longitude", "latitude", "du_id"],\n          "ops": ["mean", "mean", "count"],\n          "as": ["xValue", "yValue", "size"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        }\n      ]\n\n      Multi-dimensional Analysis:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "phase_code"],\n          "fields": ["longitude", "latitude", "du_id"],\n          "ops": ["mean", "mean", "count"],\n          "as": ["xValue", "yValue", "size"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region",\n          "as": "category"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.phase_code",\n          "as": "color"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.region + \' (\' + datum.size + \')\'",\n          "as": "label"\n        }\n      ]\n',f='\n   d. Tree/Hierarchy Charts:\n      - Dimensions: ["name", "value", "parent", "children", "level"]\n      - Requires parent-child relationships\n      - May need special data structure with nested children arrays\n      - Example: {"dimensions": ["name", "value", "parent"], "source": []}\n\n      **Required Transform Arrays for Tree/Hierarchy Charts:**\n\n      Basic Hierarchical Structure:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "phase_code", "du_model_name"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["value"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.du_model_name",\n          "as": "name"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.phase_code",\n          "as": "parent"\n        }\n      ]\n',m='\n   e. Tables:\n      - Dimensions: All relevant fields for tabular display\n      - No specific transform requirements beyond basic data preparation\n      - Example: {"dimensions": ["region", "status", "count", "percentage"], "source": []}\n\n      **Required Transform Arrays for Tables:**\n\n      Basic Aggregated Table:\n      [\n        {\n          "type": "aggregate",\n          "groupby": ["region", "status"],\n          "fields": ["du_id"],\n          "ops": ["count"],\n          "as": ["count"]\n        },\n        {\n          "type": "joinaggregate",\n          "fields": ["count"],\n          "ops": ["sum"],\n          "as": ["total"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.count / datum.total * 100",\n          "as": "percentage"\n        }\n      ]\n\n      Detailed Information Table:\n      [\n        {\n          "type": "formula",\n          "expr": "timeFormat(toDate(datum.my_date), \'%Y-%m-%d\')",\n          "as": "formatted_date"\n        },\n        {\n          "type": "collect",\n          "sort": {"field": "formatted_date", "order": "descending"}\n        }\n      ]\n',g='\n   f. Data Quality Transform Patterns:\n\n      **Handle Missing Values:**\n      [\n        {\n          "type": "filter",\n          "expr": "datum.my_date != null && datum.my_date != \'\'"\n        },\n        {\n          "type": "impute",\n          "field": "value",\n          "key": "date",\n          "method": "value",\n          "value": 0\n        }\n      ]\n\n      **Outlier Removal:**\n      [\n        {\n          "type": "aggregate",\n          "fields": ["value"],\n          "ops": ["q1", "q3"],\n          "as": ["q1", "q3"]\n        },\n        {\n          "type": "formula",\n          "expr": "datum.q3 - datum.q1",\n          "as": "iqr"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.q1 - 1.5 * datum.iqr",\n          "as": "lower_bound"\n        },\n        {\n          "type": "formula",\n          "expr": "datum.q3 + 1.5 * datum.iqr",\n          "as": "upper_bound"\n        },\n        {\n          "type": "filter",\n          "expr": "datum.value >= datum.lower_bound && datum.value <= datum.upper_bound"\n        }\n      ]\n';function y(e){if(!e||!Array.isArray(e))return u;var t={bar_chart:d,line_chart:d,stacked_bar_chart:d,time_series:d,multi_series_line:d,pie_chart:p,doughnut_chart:p,scatter_plot:h,scatter_chart:h,bubble_chart:h,tree_chart:f,hierarchy_chart:f,table:m,data_table:m},a=new Set;return e.forEach((function(e){var n=t[e.type];n&&a.add(n)})),a.add(g),a.size<=1?u:"1. Dataset Structure Requirements by Chart Type:\n\n".concat(Array.from(a).join("\n\n"),'\n\n   **Transform Pattern Guidelines:**\n   - Always use proper field/ops array matching in aggregate transforms\n   - Use timeFormat for consistent date formatting: timeFormat(toDate(datum.my_date), \'%Y-%m-%d\')\n   - Apply chronological sorting for time series: {"type": "collect", "sort": {"field": "date", "order": "ascending"}}\n   - Use pivot transforms to convert long to wide format for multi-series charts\n   - Combine multiple transforms in single Transform node when logically related\n   - Handle missing data with filter and impute transforms before visualization\n   - Use formula transforms for calculated fields and data derivations')}const _={nodeClassNames:n,nodeTypeMapping:o,reverseClassMapping:i,core_concepts:r,node_types:s,required_properties:l,chart_examples:c,dataset_visualization_mapping:u}},"6010615568d2819f6e5d":()=>{},"6818efa84353bd95c747":(e,t,a)=>{var n=a("8a868d10b6533e768658");n.command.CommandStyle=n.command.Command.extend({NAME:"draw2d.command.CommandStyle",init:function(e,t){var a=this;this._super("Change Style"),this.figure=e,this.newAttributes=t,this.oldAttributes={},Object.keys(t).forEach((function(t){a.oldAttributes[t]=e.userData.view[t]}))},canExecute:function(){return!0},execute:function(){this.redo()},undo:function(){this.figure.userData.view=this.oldAttributes,this.figure.clearTreema(),this.figure.loadTreema(),this.figure.updateUI()},redo:function(){this.figure.userData.view=this.newAttributes,this.figure.clearTreema(),this.figure.loadTreema(),this.figure.updateUI()}})},"681e598f2e0ef0ea9681":(e,t,a)=>{var n=a("8a868d10b6533e768658");n.layout.locator.SQLTopLocator=n.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.SQLTopLocator",init:function(){this._super()},relocate:function(e,t){var a=t.getParent().getBoundingBox(),o=a.w/4,i=t.getBoundingBox();t instanceof n.Port?t.setPosition(a.w/2-o,0):t.setPosition(a.w/2-i.w/2-o,-(i.h+2))}})},"6d82cd49c65221e2540b":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("wonderland",{color:["#4ea397","#22c3aa","#7bd9a5","#d0648a","#f58db2","#f2b3c9"],backgroundColor:"rgba(255,255,255,0)",textStyle:{},title:{textStyle:{color:"#666666"},subtextStyle:{color:"#999999"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"8",symbol:"emptyCircle",smooth:!1},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"8",symbol:"emptyCircle",smooth:!1},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#d0648a",color0:"transparent",borderColor:"#d0648a",borderColor0:"#22c3aa",borderWidth:"1"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:"1",color:"#cccccc"},symbolSize:"8",symbol:"emptyCircle",smooth:!1,color:["#4ea397","#22c3aa","#7bd9a5","#d0648a","#f58db2","#f2b3c9"],label:{color:"#ffffff"}},map:{itemStyle:{areaColor:"#eeeeee",borderColor:"#999999",borderWidth:.5},label:{color:"#28544e"},emphasis:{itemStyle:{areaColor:"rgba(34,195,170,0.25)",borderColor:"#22c3aa",borderWidth:1},label:{color:"#349e8e"}}},geo:{itemStyle:{areaColor:"#eeeeee",borderColor:"#999999",borderWidth:.5},label:{color:"#28544e"},emphasis:{itemStyle:{areaColor:"rgba(34,195,170,0.25)",borderColor:"#22c3aa",borderWidth:1},label:{color:"#349e8e"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#4ea397",width:1},itemStyle:{color:"#4ea397",borderWidth:1},controlStyle:{color:"#4ea397",borderColor:"#4ea397",borderWidth:.5},checkpointStyle:{color:"#4ea397",borderColor:"#3cebd2"},label:{color:"#4ea397"},emphasis:{itemStyle:{color:"#4ea397"},controlStyle:{color:"#4ea397",borderColor:"#4ea397",borderWidth:.5},label:{color:"#4ea397"}}},visualMap:{color:["#d0648a","#22c3aa","#adfff1"]},dataZoom:{backgroundColor:"rgba(255,255,255,0)",dataBackgroundColor:"rgba(222,222,222,1)",fillerColor:"rgba(114,230,212,0.25)",handleColor:"#cccccc",handleSize:"100%",textStyle:{color:"#999999"}},markPoint:{label:{color:"#ffffff"},emphasis:{label:{color:"#ffffff"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"6fe5e339b0f8a936ba8c":e=>{e.exports={context:"/fbr",apiData:"/apidata/getAPIData",ai_provider:"openrouter",ai_model:"google/gemini-2.5-flash-preview",ai_temperature:.7,ai_classification_model:"google/gemini-2.5-flash-preview",ai_enable_rag:!0,ai_max_conversation_history:100}},"7017424798f3b3345cbb":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("westeros",{color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],backgroundColor:"rgba(0,0,0,0)",textStyle:{},title:{textStyle:{color:"#516b91"},subtextStyle:{color:"#93b7e3"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"emptyCircle",smooth:!0},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"emptyCircle",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#edafda",color0:"transparent",borderColor:"#d680bc",borderColor0:"#8fd3e8",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:"6",symbol:"emptyCircle",smooth:!0,color:["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#516b91",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#a5e7f0",borderColor:"#516b91",borderWidth:1},label:{color:"#516b91"}}},geo:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#516b91",borderWidth:.5},label:{color:"#000"},emphasis:{itemStyle:{areaColor:"#a5e7f0",borderColor:"#516b91",borderWidth:1},label:{color:"#516b91"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#cccccc"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#eeeeee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#8fd3e8",width:1},itemStyle:{color:"#8fd3e8",borderWidth:1},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},checkpointStyle:{color:"#8fd3e8",borderColor:"#8a7ca8"},label:{color:"#8fd3e8"},emphasis:{itemStyle:{color:"#8fd3e8"},controlStyle:{color:"#8fd3e8",borderColor:"#8fd3e8",borderWidth:.5},label:{color:"#8fd3e8"}}},visualMap:{color:["#516b91","#59c4e6","#a5e7f0"]},dataZoom:{backgroundColor:"rgba(0,0,0,0)",dataBackgroundColor:"rgba(255,255,255,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"7224621f71697a947db7":function(e,t,a){(function(){var e,t,n={}.hasOwnProperty;e=a("a45670b3d8fb79ec0258"),t=function(t){return function(t,a){var o,i,r,s,l,c,u,d,p,h,f,m,g,y,_,b,v,w,x,k,D,S,C,T,A,P,E,I,N,M;for(p in c={table:{clickCallback:null,rowTotals:!0,colTotals:!0},localeStrings:{totals:"Totals"}},a=e.extend(!0,{},c,a),r=t.colAttrs,y=t.rowAttrs,b=t.getRowKeys(),l=t.getColKeys(),a.table.clickCallback&&(u=function(e,o,i){var s,l,c;for(c in l={},r)n.call(r,c)&&(s=r[c],null!=i[c]&&(l[s]=i[c]));for(c in y)n.call(y,c)&&(s=y[c],null!=o[c]&&(l[s]=o[c]));return function(n){return a.table.clickCallback(n,e,l,t)}}),(g=document.createElement("table")).className="table table-bordered table-hover display compact",v=function(e,t,a){var n,o,i,r,s,l,c,u;if(0!==t){for(r=!0,u=n=0,s=a;0<=s?n<=s:n>=s;u=0<=s?++n:--n)e[t-1][u]!==e[t][u]&&(r=!1);if(r)return-1}for(i=0;t+i<e.length;){for(c=!1,u=o=0,l=a;0<=l?o<=l:o>=l;u=0<=l?++o:--o)e[t][u]!==e[t+i][u]&&(c=!0);if(c)break;i++}return i},(T=document.createElement("thead")).className="table-light ",r)if(n.call(r,p)){for(d in i=r[p],E=document.createElement("tr"),0===parseInt(p)&&0!==y.length&&((D=document.createElement("th")).setAttribute("colspan",y.length),D.setAttribute("rowspan",r.length),E.appendChild(D)),(D=document.createElement("th")).textContent=i,E.appendChild(D),l)n.call(l,d)&&(s=l[d],-1!==(M=v(l,parseInt(d),parseInt(p)))&&((D=document.createElement("th")).textContent=s[p],D.setAttribute("colspan",M),parseInt(p)===r.length-1&&0!==y.length&&D.setAttribute("rowspan",2),E.appendChild(D)));0===parseInt(p)&&a.table.rowTotals&&((D=document.createElement("th")).innerHTML=a.localeStrings.totals,D.setAttribute("rowspan",r.length+(0===y.length?0:1)),E.appendChild(D)),T.appendChild(E)}if(0!==y.length){for(d in E=document.createElement("tr"),y)n.call(y,d)&&(f=y[d],(D=document.createElement("th")).textContent=f,E.appendChild(D));D=document.createElement("th"),0===r.length&&(D.innerHTML=a.localeStrings.totals),E.appendChild(D),T.appendChild(E)}for(d in g.appendChild(T),w=document.createElement("tbody"),b)if(n.call(b,d)){for(p in _=b[d],E=document.createElement("tr"),_)n.call(_,p)&&(I=_[p],(D=document.createElement("th")).textContent=I,E.appendChild(D),parseInt(p)===y.length-1&&0!==r.length&&(S=document.createElement("th"),E.appendChild(S)));for(p in l)n.call(l,p)&&(s=l[p],N=(o=t.getAggregator(_,s)).value(),(x=document.createElement("td")).textContent=o.format(N),x.setAttribute("data-value",N),null!=u&&(x=document.createElement("td"),E.appendChild(x)),E.appendChild(x));(a.table.rowTotals||0===r.length)&&(N=(A=t.getAggregator(_,[])).value(),(x=document.createElement("td")).className="fw-bold",x.textContent=A.format(N),x.setAttribute("data-value",N),null!=u&&(x.onclick=u(N,_,[])),x.setAttribute("data-for","row"+d),E.appendChild(x)),w.appendChild(E)}if(a.table.colTotals||0===y.length){if(k=document.createElement("tfoot"),(E=document.createElement("tr")).className="table-light fw-bold ",a.table.colTotals||0===y.length){if((P=y.length+(0===r.length?0:1)-1)>0)for(M=h=1,m=P;1<=m?h<=m:h>=m;M=1<=m?++h:--h)C=document.createElement("th"),E.appendChild(C);(D=document.createElement("th")).innerHTML=a.localeStrings.totals,E.appendChild(D)}for(p in l)n.call(l,p)&&(s=l[p],N=(A=t.getAggregator([],s)).value(),(x=document.createElement("td")).textContent=A.format(N),x.setAttribute("data-value",N),null!=u&&(x.onclick=u(N,[],s)),x.setAttribute("data-for","col"+p),E.appendChild(x));(a.table.rowTotals||0===r.length)&&(N=(A=t.getAggregator([],[])).value(),(x=document.createElement("td")).className="table-light fw-bolder",x.textContent=A.format(N),x.setAttribute("data-value",N),null!=u&&(x.onclick=u(N,[],[])),E.appendChild(x)),k.appendChild(E)}return g.appendChild(w),k&&g.appendChild(k),g.setAttribute("data-numrows",b.length),g.setAttribute("data-numcols",l.length),g}},e.pivotUtilities.fb_renderer={"FB Table":t()}}).call(this)},"7486e8f4706fb078bf11":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var draw2d=__webpack_require__("8a868d10b6533e768658"),$=__webpack_require__("a45670b3d8fb79ec0258"),Utils=__webpack_require__("8deafab7866a125bb9ca"),ucharts=__webpack_require__("1f44d888ec90c0bf8262"),jQuery=__webpack_require__("a45670b3d8fb79ec0258");function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperty(e,t,a){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}draw2d.shape.fishbone.ra.RaphaelChart=draw2d.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaphaelChart",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaphaelChart</strong>}<br/><br/>",init:function(e,t,a){var n=this;this._super($.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var o=this;this.updateTickets=0;var i=new draw2d.PivotColInputPort;i.setConnectionDirection(0);var r=new draw2d.layout.locator.TopLocator;i.setName("chartInput0"),this.addPort(i,r);var s=new draw2d.PivotColInputPort,l=new draw2d.layout.locator.LeftLocator;s.setConnectionDirection(3),s.setName("chartInput1"),this.addPort(s,l),this.sites_list_in=[],this.getUserData();var c=new Date;this.default_user_data={hidden:!1,autoWidth:!1,index:0,toolbar:$.extend(!0,{},default_toolbar),title:$.extend(!0,{},default_title),title_left:$.extend(!0,{},default_title_left),title_right:$.extend(!0,{},default_title_right),data_table:$.extend(!0,{},default_data_table),xAxis:$.extend(!0,{},default_xAxis),yAxis:$.extend(!0,{},default_yAxis),start_date:new Date(c.getFullYear(),0,1).toLocaleDateString(),trend:"accumulative",period:"monthly",showInConnections:!0,size:{width:800,height:350},grid:$.extend(!0,{},default_grid),view:$.extend(!0,{},default_view)},this.default_user_data.toolbar.buttons.push({show:!0,name:"accumulative",icon:"data:image/png;base64,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",onclick:function(){o.userData.trend="accumulative",o.userData.title_left.label="accumulative",o.options&&(o.options.series=[]),o.uChart=null,o.updateTable()}}),this.default_user_data.toolbar.buttons.push({show:!0,name:"incremental",icon:"data:image/png;base64,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",onclick:function(){o.userData.trend="incremental",o.userData.title_left.label="incremental",o.options&&(o.options.series=[]),o.uChart=null,o.updateTable()}}),this.default_user_data.toolbar.buttons.push({show:!0,name:"monthly",icon:"data:image/png;base64,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",onclick:function(){o.userData.period="monthly",o.userData.title_right.label="monthly",o.options&&(o.options.series=[]),o.uChart=null,o.updateTable()}}),this.default_user_data.toolbar.buttons.push({show:!0,name:"weekly",icon:"data:image/png;base64,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",onclick:function(){o.userData.period="weekly",o.userData.title_right.label="weekly",o.options&&(o.options.series=[]),o.uChart=null,o.updateTable()}}),this.default_user_data.toolbar.buttons.push({show:!0,name:"daily",icon:"data:image/png;base64,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",onclick:function(){o.userData.period="daily",o.userData.title_right.label="daily",o.options&&(o.options.series=[]),o.uChart=null,o.updateTable()}}),this.attr({userData:$.extend(!0,{},this.default_user_data)}),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},index:{type:"integer",title:"Mobile Index",default:0},toolbar:template_toolbar,title:template_title,title_left:template_title_left,title_right:template_title_right,popup:template_popup,start_date:{type:"string",title:"Start Date",format:"date",default:""},end_date:{type:"string",title:"End Date",format:"date",default:""},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:800},height:{type:"integer",default:350}}},grid:template_grid,data_table:template_data_table,xAxis:template_xAxis,yAxis:template_yAxis,trend:{type:"string",title:"Trend",default:"accumulative",enum:["accumulative","incremental"]},period:{type:"string",title:"Period",default:"monthly",enum:["monthly","weekly","daily"]},showInConnections:{type:"boolean",title:"Show Connections",default:!0},showToday:{type:"boolean",title:"Position on Today",default:!0},hide_future:{type:"boolean",title:"Break Lines in Future",default:!0},value:{type:"integer",title:"Current Value",default:0},view:template_view,col:{type:"array",default:{item_name:"",serie:{name:"",type:"line",barWidth:10,data:[]},sites_list_out:[]},title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},serie:template_serie,sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]},owner_id:{type:"string",format:"hidden"},task_type:{type:"string",format:"hidden",properties:{}}}}}},required:[]},this.on("contextmenu",(function(e,t){$.contextMenu({selector:"body",events:{hide:function(){$.contextMenu("destroy")}},callback:$.proxy((function(e,t){"toogleCon"===e&&setTimeout((function(){o.toogleInConn()}),10)}),this),x:t.x,y:t.y,items:{toogleCon:o.userData.showInConnections?{name:"Hide Connections"}:{name:"Show Connections"}}})})),this.on("resize",(function(e){o.userData.size={width:e.width,height:e.height},n.uChart&&(n.uChart=null),n.updateTable()})),this.GetHTTPData=function(){this.uChart&&(this.uChart=null),this.updateTable()},this.updateTable=function(){var e={title:o.userData.title,title_left:o.userData.title_left,title_right:o.userData.title_right,grid:o.userData.grid,popup:o.userData.popup,toolbar:o.userData.toolbar,view:o.userData.view,size:o.userData.size,data_table:o.userData.data_table,xAxis:o.userData.xAxis||default_xAxis,yAxis:o.userData.yAxis||default_yAxis,series:[]};Utils.updateTable(o,e)},this.initDataUpdate=function(e){if(CHART_DEBUG)var t=performance.now();if(this.uChart=ucharts.init(this.canvas.paper,e,this),CHART_DEBUG&&console.log("Ushart Init "+(t-performance.now())),CHART_DEBUG)var a=performance.now();this.setNewData(this.uChart.svg_nodes),CHART_DEBUG&&console.log("setNewData "+(a-performance.now()))},this.updateChartData=function(e){var t=this;e.series.forEach((function(e,a){if(t.uChart.series[a])t.uChart.series[a].update({data:e.data}),o.applyTransformation();else{var n=t.uChart.addSerie(e);o.svgNodes.push(n),o.applyTransformation()}}))},this.setNewData=function(e){o.svgNodes.hide(),o.svgNodes=e,o.applyTransformation(),o.repaint()},this.startAnimation=function(e){if(!o.getCanvas().silentMode){this.canvas.paper.setStart();var t=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading...");t.attr({fill:"#777",stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),n=Raphael.animation(_defineProperty({opacity:0},"opacity",1),1e3),t.animate(n.repeat(e));var a=this.canvas.paper.setFinish();this.setNewData(a)}var n},this.on("removed",(function(){var e=[];o.getPorts().data.forEach((function(t,a){t.getConnections().data.forEach((function(t,a){e.push(t)}))}))}),this),o.userData.col=[]},onPortValueChanged:function(e){if(e.getValue().indexOf("ticket")>-1)void 0!==e.userData.realCount?this.updateTickets=this.updateTickets+e.userData.realCount:this.updateTickets=this.updateTickets+1,DEBUG&&console.log("RaphaelChart update ticket received: "+this.updateTickets),Utils.drawProgress(this,10,!0);else if(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),DEBUG&&console.log("RaphaelChart update data received: "+this.updateTickets),Utils.drawProgress(this),"chartInput0"==e.name||"chartInput1"==e.name){var t="chartInput0"==e.name?0:1,a=this.getInputPort(t).getConnections(),n=this;a.data.forEach((function(t,a){if(e.getValue()===t.getSource().getParent().getId()){var o=t.getSource(),i=o.getId(),r=-1;if(n.userData.col.forEach((function(e,t){if(e.owner_id===i){r=t;var a={};if(void 0!==n.userData.col[r]?(a=jQuery.extend(!0,{},n.userData.col[r].serie)).name=o.userData.item_name:a={name:o.userData.item_name,type:"line",areaStyle:{normal:{},show:!1},data:[]},r>-1){var s=jQuery.extend(!0,{},o.userData);s.serie=a,s.owner_id=i,n.userData.col[r]=s,n.project=o.getUserData().project,n.scope=o.getUserData().scope,n.sop=o.getUserData().sop}}})),-1===r){var s={name:o.userData.item_name,type:"line",areaStyle:{normal:{},show:!1},data:[]},l=jQuery.extend(!0,{},o.userData);l.serie=s,l.owner_id=i,n.userData.col.push(l)}}})),this.updateTickets<=0&&(n.uChart=null,this.updateTable())}},onDragStart:function(e,t,a,n){return!this.dragIsLocked&&this._super(e,t,a,n)},createSet:function(){this.canvas.paper.setStart();var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"N/A");return e.attr({fill:"#777",stroke:"none",opacity:.5,"font-size":20,"font-weight":"bold"}),this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight()).attr({stroke:"#888","stroke-dasharray":"-"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},getTopLevelShapeElement:function(){return 0===this.svgNodes.length?this.shape:this.svgNodes[0]},applyAlpha:function(){},addPort:function(e,t){return this._super(e,t),e},getPersistentAttributes:function(){var e=this._super();return e.labels=[],this.children.each((function(t,a){var n=a.figure.getPersistentAttributes();n.locator=a.locator.NAME,e.labels.push(n)})),e},setPersistentAttributes:function setPersistentAttributes(memento){var _this3=this;if(this._super(memento),this.resetChildren(),"object"===_typeof(this.userData.toolbar.buttons)&&!Array.isArray(this.userData.toolbar.buttons)&&null!==this.userData.toolbar.buttons){var old_toolbar=$.extend({},this.userData.toolbar.buttons);this.userData.toolbar.buttons=this.default_user_data.toolbar.buttons,this.userData.toolbar.buttons.forEach((function(e,t){"full_left"===e.name?_this3.userData.toolbar.buttons[t].show=old_toolbar.full_left:"left"===e.name?_this3.userData.toolbar.buttons[t].show=old_toolbar.left:"right"===e.name?_this3.userData.toolbar.buttons[t].show=old_toolbar.right:"full_right"===e.name?_this3.userData.toolbar.buttons[t].show=old_toolbar.full_right:"monthly"===e.name?_this3.userData.toolbar.buttons[t].show=old_toolbar.monthly:"weekly"===e.name?_this3.userData.toolbar.buttons[t].show=old_toolbar.weekly:"daily"===e.name?_this3.userData.toolbar.buttons[t].show=old_toolbar.daily:"accumulative"===e.name?_this3.userData.toolbar.buttons[t].show=old_toolbar.accumulative:"incremental"===e.name&&(_this3.userData.toolbar.buttons[t].show=old_toolbar.incremental)}))}this.userData=$.extend(!0,{},this.default_user_data,this.userData),$.each(memento.labels,$.proxy((function(i,json){var figure=eval("new "+json.type+"()");figure.attr(json);var locator=eval("new "+json.locator+"()");this.add(figure,locator)}),this))}})},"75d5b6ff75f50ea1bb38":(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var n=a("8a868d10b6533e768658"),o=a.n(n),i=a("ff40a63289dea11bfb3e"),r=a.n(i);function s(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=u(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw i}}}}function u(e,t){if(e){if("string"==typeof e)return d(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return(t=x(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function g(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],a=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}}}throw new TypeError(p(e)+" is not iterable")}function y(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return _(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(_(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,_(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,_(d,"constructor",c),_(c,"constructor",l),l.displayName="GeneratorFunction",_(c,o,"GeneratorFunction"),_(d),_(d,o,"Generator"),_(d,n,(function(){return this})),_(d,"toString",(function(){return"[object Generator]"})),(y=function(){return{w:i,m:p}})()}function _(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_=function(e,t,a,n){function i(t,a){_(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},_(e,t,a,n)}function b(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function v(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){b(i,n,o,r,s,"next",e)}function s(e){b(i,n,o,r,s,"throw",e)}r(void 0)}))}}function w(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x(n.key),n)}}function x(e){var t=function(e){if("object"!=p(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=p(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==p(t)?t:t+""}var k=function(){return e=function e(t,a,n,o,i,r){var s=this,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.scope=a,this.$compile=n,this.$sanitize=o,this.settings=i,this.nodeTrackingManager=r,this.aiAssistant=l,this.currentConnections=[],this.connectionConfigs=[],this.errors=[],this.classMapping={1:"draw2d.shape.fishbone.cell.Projectnode_api",2:"draw2d.shape.fishbone.cell.DUModelnode_api",3:"draw2d.shape.fishbone.cell.Datanode",4:"draw2d.shape.fishbone.cell.CustomFieldnode",5:"draw2d.shape.fishbone.cell.SQLnode",6:"draw2d.shape.fishbone.cell.Unionnode",7:"draw2d.shape.fishbone.cell.Transformnode",8:"draw2d.shape.fishbone.ra.RaEchartAdapter",9:"draw2d.shape.fishbone.ra.RaVegaChart",10:"draw2d.shape.fishbone.ra.RaTableAdapter",11:"draw2d.shape.fishbone.cell.HTMLnode",12:"draw2d.shape.fishbone.cell.Stylenode",13:"draw2d.shape.fishbone.cell.Mathnode",14:"draw2d.shape.fishbone.cell.Filternode",15:"draw2d.shape.fishbone.cell.APInode",16:"draw2d.shape.fishbone.ra.RaTablenode"},this.reverseClassMapping={},Object.keys(this.classMapping).forEach((function(e){s.reverseClassMapping[s.classMapping[e]]=parseInt(e)}))},t=[{key:"retryApiCall",value:(E=v(y().m((function e(t,a){var n,o,i,r,s,l,c=this,u=arguments;return y().w((function(e){for(;;)switch(e.n){case 0:n=u.length>2&&void 0!==u[2]?u[2]:3,o=u.length>3&&void 0!==u[3]?u[3]:500,r=y().m((function e(){var r,s,u;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,console.log("API call attempt ".concat(l,"/").concat(n,": ").concat(t)),e.n=1,fetch(t,a);case 1:if((r=e.v).ok){e.n=2;break}throw new Error("HTTP ".concat(r.status,": ").concat(r.statusText));case 2:return l>1&&c.aiAssistant&&c.postSuccessToChat("Successfully connected to API after ".concat(l," attempts")),e.a(2,{v:r});case 3:if(e.p=3,u=e.v,i=u,console.warn("API call attempt ".concat(l,"/").concat(n," failed:"),u.message),!(l<n)){e.n=5;break}return s=o*Math.pow(2,l-1),console.log("Retrying in ".concat(s,"ms...")),c.aiAssistant&&c.postRetryToChat("Retry attempt ".concat(l,"/").concat(n," failed, retrying in ").concat(s,"ms...")),e.n=4,new Promise((function(e){return setTimeout(e,s)}));case 4:e.n=6;break;case 5:console.error("All ".concat(n," API call attempts failed:"),u.message);case 6:return e.a(2)}}),e,null,[[0,3]])})),l=1;case 1:if(!(l<=n)){e.n=4;break}return e.d(g(r()),2);case 2:if(!(s=e.v)){e.n=3;break}return e.a(2,s.v);case 3:l++,e.n=1;break;case 4:throw i;case 5:return e.a(2)}}),e)}))),function(e,t){return E.apply(this,arguments)})},{key:"postErrorToChat",value:function(e,t,a){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null!==(n=this.aiAssistant)&&void 0!==n&&n.chatInterface){var i="🔴 **".concat(e," Node Error** (ID: ").concat(t,")\n").concat(a);o&&(i+="\n\n*".concat(o,"*")),this.aiAssistant.chatInterface.addMessage({type:"error_response",text:i,sender:"system",timestamp:(new Date).toISOString(),nodeInfo:{nodeType:e,nodeId:t,retryInfo:o}})}else console.warn("AI Assistant chat interface not available for error posting")}},{key:"postRetryToChat",value:function(e){var t;null!==(t=this.aiAssistant)&&void 0!==t&&t.chatInterface&&this.aiAssistant.chatInterface.addMessage({type:"system_notification",text:"🔄 ".concat(e),sender:"system",timestamp:(new Date).toISOString()})}},{key:"postSuccessToChat",value:function(e){var t;null!==(t=this.aiAssistant)&&void 0!==t&&t.chatInterface&&this.aiAssistant.chatInterface.addMessage({type:"system_notification",text:"✅ ".concat(e),sender:"system",timestamp:(new Date).toISOString()})}},{key:"initializeErrorTracking",value:function(){this.errors=[],this.scope&&(this.scope.aiReportNodeErrors=[])}},{key:"trackError",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=f({type:e,nodeId:t,message:a,timestamp:new Date},n);this.errors.push(o),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push(o),console.error("[AINodeManager] ".concat(e," error for node ").concat(t,":"),a,n)}},{key:"createNodeFromConfig",value:(P=v(y().m((function e(t){var a,n,i,r,s,l=arguments;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(a=l.length>2&&void 0!==l[2]?l[2]:{x:100,y:100},n=(l.length>1&&void 0!==l[1]?l[1]:null)||this.canvas,console.log("[AINodeManager] Creating node from config:",t),e.p=1,"number"!=typeof t.class){e.n=3;break}if(i=this.classMapping[t.class]){e.n=2;break}throw new Error("Invalid numeric class ID '".concat(t.class,"'"));case 2:e.n=4;break;case 3:i=t.class;case 4:if(i&&"string"==typeof i&&i.startsWith("draw2d.")){e.n=5;break}throw new Error("Invalid node class '".concat(t.class,"'"));case 5:return(r=new Function("draw2d","scope","compile","sanitize","return new "+i+"(undefined, undefined, undefined, scope, compile, sanitize);")(o(),this.scope,this.$compile,this.$sanitize)).ai_generated=!0,r.ai_id=t.id,n.add(r,a.x,a.y),this.nodeTrackingManager.registerNode(t.id,r.id,{type:t.class,label:t.label,position:a,config:t}),console.log("[AINodeManager] Successfully created node ".concat(t.id," (canvas ID: ").concat(r.id,")")),e.a(2,r);case 6:throw e.p=6,s=e.v,this.trackError("NodeCreation",t.id,s.message,{config:t}),s;case 7:return e.a(2)}}),e,this,[[1,6]])}))),function(e){return P.apply(this,arguments)})},{key:"configureNodeByType",value:(A=v(y().m((function e(t,a){var n,o,i,r,s=arguments;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:n=s.length>2&&void 0!==s[2]?s[2]:null,o=this.reverseClassMapping[t.cssClass]||a.class,e.p=1,i=o,e.n=1===i?2:2===i?4:3===i?6:4===i?8:7===i?10:13===i?12:16===i?14:16;break;case 2:return e.n=3,this.configureProjectNode(t,a,n);case 3:return e.a(3,17);case 4:return e.n=5,this.configureDUModelNode(t,a,n);case 5:return e.a(3,17);case 6:return e.n=7,this.configureTaskNode(t,a,n);case 7:return e.a(3,17);case 8:return e.n=9,this.configureUDFNode(t,a,n);case 9:return e.a(3,17);case 10:return e.n=11,this.configureTransformNode(t,a,n);case 11:return e.a(3,17);case 12:return e.n=13,this.configureMathNode(t,a,n);case 13:return e.a(3,17);case 14:return e.n=15,this.configureRaTableNode(t,a,n);case 15:return e.a(3,17);case 16:return e.n=17,this.configureGenericNode(t,a,n);case 17:e.n=19;break;case 18:e.p=18,r=e.v,this.trackError("NodeConfiguration",a.id,"Failed to configure ".concat(this.getNodeTypeName(o)," node: ").concat(r.message),{nodeType:o,config:a});case 19:return e.a(2)}}),e,this,[[1,18]])}))),function(e,t){return A.apply(this,arguments)})},{key:"configureProjectNode",value:(T=v(y().m((function e(t,a,n){var o,i,r,s,l,c,u,d,p,h,f,m,g,_,b,v,w,x;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!(a.proj_code||a.proj_name||a.proj_id)){e.n=6;break}return t.userData||(t.userData={}),i=(null===(o=this.scope.user)||void 0===o?void 0:o.user_id)||"undefined"!=typeof window&&window.user_id||"6237000453",r={user_id:i,proj_code:a.proj_code,proj_name:a.proj_name},a.proj_id&&(r.proj_id=a.proj_id),e.p=1,l=(null===(s=this.settings)||void 0===s?void 0:s.context)||"",console.log("Fetching Project data:",r),c="".concat(l,"/apidata/getAPIData?apiid=").concat("526129009928470528","&user_id=").concat(i),u={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(r)},e.n=2,this.retryApiCall(c,u,3,500);case 2:return d=e.v,e.n=3,d.json();case 3:p=e.v,(h=p.data&&p.data.length>0?p.data[0]:null)?(console.log("Project data received:",h),t.userData.project={proj_id:h.proj_id||a.proj_id||"",proj_name:h.proj_name||a.proj_name||"",proj_code:h.proj_code||a.proj_code||""},t.userData.isEditedLabel=!0,t.userData.label=t.userData.project.proj_name||"Project",(f=t.getOutputPort(0))?f.setUserData({project:t.userData.project}):console.warn("Output port 'output0' not found on Project node",t.id)):(t.userData.project={proj_id:a.proj_id||"",proj_name:a.proj_name||"",proj_code:a.proj_code||""},m="Project API returned no data for query: ".concat(JSON.stringify(r),". Using config values as fallback."),console.warn(m),this.postErrorToChat("Project",a.id,"Project API returned no data for query","Project may not exist or you may not have access rights for it"),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"Projectnode_api",message:m}),t.userData.isEditedLabel=!0,t.userData.label=t.userData.project.proj_name||"Project",(g=t.getOutputPort(0))&&g.setUserData({project:t.userData.project})),e.n=5;break;case 4:e.p=4,x=e.v,_="Failed to fetch Project API data after 3 attempts: ".concat(x.message),b="API server may not be ready or network connectivity issues",console.error(_,x),this.postErrorToChat("Project",a.id,_,b),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"Projectnode_api",message:_,retryInfo:b}),t.userData.project={proj_id:a.proj_id||"",proj_name:a.proj_name||"",proj_code:a.proj_code||""},t.userData.isEditedLabel=!0,t.userData.label=t.userData.project.proj_name||"Project",(v=t.getOutputPort(0))&&v.setUserData({project:t.userData.project});case 5:e.n=7;break;case 6:w="Project node configuration missing required parameters (proj_code/proj_name/proj_id)",console.warn(w,a),this.postErrorToChat("Project",a.id,w,"Please provide project code, name, or ID for proper configuration"),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"Projectnode_api",message:w});case 7:return e.a(2)}}),e,this,[[1,4]])}))),function(e,t,a){return T.apply(this,arguments)})},{key:"configureDUModelNode",value:(C=v(y().m((function e(t,a,n){var o,i,r,s,l,c,u,d,p,h,f,m,g,_,b,v,w,x,k,D,S,C,T;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!a.du_model_name&&!a.du_model_id){e.n=9;break}if(t.userData||(t.userData={}),o=this.findParentPortData(a.id,n),i=null,o&&o.project?(i=o.project,t.project=i):(r="Could not find valid source node or source port data for DUModel node ".concat(a.id,"."),console.warn(r)),!i||!i.proj_id){e.n=7;break}return l=(null===(s=this.scope.user)||void 0===s?void 0:s.user_id)||"undefined"!=typeof window&&window.user_id||"6237000453",c={proj_id:i.proj_id,du_model_name:a.du_model_name},a.du_model_id&&(c.du_model_id=a.du_model_id),e.p=1,d=(null===(u=this.settings)||void 0===u?void 0:u.context)||"",console.log("Fetching DUModel data:",c),e.n=2,fetch("".concat(d,"/apidata/getAPIData?apiid=").concat("527209159352942592","&user_id=").concat(l),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(c)});case 2:if((p=e.v).ok){e.n=3;break}throw new Error("DUModel API fetch failed: ".concat(p.status));case 3:return e.n=4,p.json();case 4:h=e.v,(f=h.data&&h.data.length>0?h.data[0]:null)?(console.log("DUModel data received:",f),t.userData.du_model={du_model_id:f.du_model_id||a.du_model_id||"",du_model_name:f.du_model_name||a.du_model_name||""},t.du_model=t.userData.du_model,t.userData.isEditedLabel=!0,t.userData.label=t.userData.du_model.du_model_name||"DU Model",(m=t.getOutputPort(0))?m.setUserData({project:i,du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"}):console.warn("Output port 'output0' not found on DUModel node",t.id)):(console.warn("DUModel API returned no data for query:",c),t.userData.du_model={du_model_id:a.du_model_id||"",du_model_name:a.du_model_name||""},t.du_model=t.userData.du_model,g="DUModel API returned no data for query: ".concat(JSON.stringify(c),". Using config values as fallback."),console.warn(g),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"DUModelnode_api",message:g}),t.userData.isEditedLabel=!0,t.userData.label=t.userData.du_model.du_model_name||"DU Model",(_=t.getOutputPort(0))&&_.setUserData({project:i,du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"})),e.n=6;break;case 5:e.p=5,T=e.v,b="Error fetching DUModel API data: ".concat(T.message),console.error(b,T),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"DUModelnode_api",message:b}),t.userData.du_model={du_model_id:a.du_model_id||"",du_model_name:a.du_model_name||""},t.du_model=t.userData.du_model,t.userData.isEditedLabel=!0,t.userData.label=t.userData.du_model.du_model_name||"DU Model",(v=t.getOutputPort(0))&&v.setUserData({project:i,du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"});case 6:e.n=8;break;case 7:w="Cannot fetch DUModel data - missing valid project context from parent node.",console.warn(w,a),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"DUModelnode_api",message:w}),t.userData.du_model={du_model_id:a.du_model_id||"",du_model_name:a.du_model_name||""},t.du_model=t.userData.du_model,t.userData.isEditedLabel=!0,t.userData.label=t.userData.du_model.du_model_name||"DU Model",(x=t.getOutputPort(0))&&x.setUserData({du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"});case 8:e.n=10;break;case 9:k="DUModel node config missing du_model_name/du_model_id.",console.warn(k,a),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"DUModelnode_api",message:k}),t.userData||(t.userData={}),t.userData.du_model={du_model_id:"",du_model_name:""},t.du_model=t.userData.du_model,(D=t.getOutputPort(0))&&(S=this.findParentPortData(a.id,n),C=null==S?void 0:S.project,D.setUserData({project:C,du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"}));case 10:return e.a(2)}}),e,this,[[1,5]])}))),function(e,t,a){return C.apply(this,arguments)})},{key:"configureTaskNode",value:(S=v(y().m((function e(t,a,n){var o,i,r,s,l,c,u,d,p,h,m,g,_,b,v,w,x,k;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!((o=this.findParentPortData(a.id,n))&&o.project&&o.project.proj_id)){e.n=7;break}return t.project=o.project,t.scope=o.scope,t.sop=o.sop,s=(null===(i=this.scope.user)||void 0===i?void 0:i.user_id)||"undefined"!=typeof window&&window.user_id||"6237000453",l=(null===(r=this.settings)||void 0===r?void 0:r.context)||"",c="".concat(l,"/apidata/getAPIData?apiid=").concat("700743337020260352","&user_id=").concat(s),u={proj_id:t.project.proj_id,task_type:"AC"},t.scope&&t.scope.scope_id&&(u.du_model_id=t.scope.scope_id),a.scope_task_name&&(u.scope_task_name=a.scope_task_name),a.scope_task_code&&(u.scope_task_code=a.scope_task_code),a.scope_task_id&&(u.scope_task_id=a.scope_task_id),e.p=1,console.log("Fetching Task data:",u),e.n=2,fetch(c,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(u)});case 2:if((d=e.v).ok){e.n=3;break}throw new Error("Task API fetch failed: ".concat(d.status));case 3:return e.n=4,d.json();case 4:p=e.v,(h=p.data&&p.data.length>0?p.data[0]:null)?(console.log("Task data received:",h),t.userData||(t.userData={}),t.userData.task||(t.userData.task={}),t.userData.task.scope_task_id=h.scope_task_id||a.scope_task_id||"",t.userData.task.scope_task_code=h.scope_task_code||a.scope_task_code||"",t.userData.task.scope_task_name=h.scope_task_name||a.scope_task_name||"",t.userData.task_type=h.task_type||a.task_type||"actual",t.userData.isEditedLabel=!0,t.userData.label=t.userData.task.scope_task_name||"Task",(m=t.getOutputPort(0))?(g=f({},o),m.setUserData(g)):console.warn("Output port 'output0' not found on Datanode",t.id)):(console.warn("Task API returned no data for query:",u),t.userData||(t.userData={}),t.userData.task||(t.userData.task={}),t.userData.task.scope_task_id=a.scope_task_id||"",t.userData.task.scope_task_code=a.scope_task_code||"",t.userData.task.scope_task_name=a.scope_task_name||"",t.userData.task_type=a.task_type||"",_="Task API returned no data for query: ".concat(JSON.stringify(u),". Using config values as fallback."),console.warn(_),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"Datanode",message:_}),t.userData.isEditedLabel=!0,t.userData.label=t.userData.task.scope_task_name||"Task",(b=t.getOutputPort(0))&&b.setUserData(f({},o))),e.n=6;break;case 5:e.p=5,k=e.v,v="Error fetching Task API data: ".concat(k.message),console.error(v,k),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"Datanode",message:v}),t.userData||(t.userData={}),t.userData.task||(t.userData.task={}),t.userData.task.scope_task_id=a.scope_task_id||"",t.userData.task.scope_task_code=a.scope_task_code||"",t.userData.task.scope_task_name=a.scope_task_name||"",t.userData.isEditedLabel=!0,t.userData.label=t.userData.task.scope_task_name||"Task",a.sql_query&&"function"==typeof t.setSql&&t.setSql(a.sql_query),(w=t.getOutputPort(0))&&w.setUserData(f({},o));case 6:e.n=8;break;case 7:x="Cannot fetch Task data - missing valid project context from parent node.",console.warn(x,a),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"Datanode",message:x}),t.userData.isEditedLabel=!0,t.userData.label=a.label||a.scope_task_name||"Task",a.sql_query&&"function"==typeof t.setSql&&t.setSql(a.sql_query);case 8:return e.a(2)}}),e,this,[[1,5]])}))),function(e,t,a){return S.apply(this,arguments)})},{key:"configureVisualizationNode",value:(D=v(y().m((function e(t,a,n){var o;return y().w((function(e){for(;;)switch(e.n){case 0:o=this.findParentPortData(a.id,n),t.userData=t.userData||{},o&&Object.assign(t.userData,o),t.userData.isEditedLabel=!0,t.userData.label=a.label||"Visualization",a.chart_config&&("function"==typeof t.setChartConfig&&t.setChartConfig(a.chart_config),t.userData.chart_config=a.chart_config),a.config&&("function"==typeof t.setConfig&&t.setConfig(a.config),t.userData.config=a.config),a.vega_spec&&("function"==typeof t.setVegaSpec&&t.setVegaSpec(a.vega_spec),t.userData.vega_spec=a.vega_spec),Object.keys(a).forEach((function(e){"id"!==e&&"class"!==e&&(t.userData[e]=a[e])}));case 1:return e.a(2)}}),e,this)}))),function(e,t,a){return D.apply(this,arguments)})},{key:"fixCodeWithAI",value:(k=v(y().m((function e(t,a){var n,o,i,r,s,l,c,u,d,p;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(this.aiAssistant){e.n=1;break}return console.warn("[AINodeManager] AI Assistant not available for code fixing"),e.a(2,null);case 1:return e.p=1,console.log("[AINodeManager] Attempting AI code fix for syntax error:",a),null!==(n=this.aiAssistant)&&void 0!==n&&n.chatInterface&&this.aiAssistant.chatInterface.addMessage({type:"system_notification",text:"Auto-fixing syntax error...",sender:"system",timestamp:(new Date).toISOString()}),o="You are a JavaScript code fixing expert. Fix the syntax error in this Math node code.\n\n**Invalid Code:**\n```javascript\n".concat(t,"\n```\n\n**Error Details:**\n- Message: ").concat(a.message,"\n- Type: ").concat(a.type,"\n- Name: ").concat(a.name,'\n\n**Requirements:**\n1. Fix ONLY the syntax error - preserve original functionality\n2. Code must be a valid JavaScript arrow function or expression\n3. Common patterns for Math nodes: data filtering, calculations, transformations\n4. Return ONLY the corrected code without explanations\n5. If code cannot be fixed, return "UNFIXABLE"\n\n**Fixed Code:**'),i=this.getProvider(),r=this.getModel(),s={messages:[{role:"system",content:'You are a JavaScript syntax error fixing specialist. Return only the corrected code or "UNFIXABLE".'},{role:"user",content:o}],temperature:.1,model:r,provider:i,max_tokens:500,disableTools:!0,config:this.aiAssistant.config.getAll()},e.n=2,this.callAI(s);case 2:if(l=e.v,console.log("[AINodeManager] AI response received:",l),c=null,!l||!l.content){e.n=3;break}c=l.content.trim(),e.n=6;break;case 3:if(!l||!l.message){e.n=4;break}c=l.message.trim(),e.n=6;break;case 4:if("string"!=typeof l){e.n=5;break}c=l.trim(),e.n=6;break;case 5:throw console.error("[AINodeManager] Unexpected response structure:",l),new Error("No usable content in AI response");case 6:if("UNFIXABLE"!==c&&!c.includes("UNFIXABLE")){e.n=7;break}return console.log("[AINodeManager] AI determined code is unfixable"),e.a(2,null);case 7:return u=c.replace(/^```javascript\s*/,"").replace(/^```js\s*/,"").replace(/^```\s*/,"").replace(/```\s*$/,"").trim(),console.log("[AINodeManager] AI suggested fix:",u),e.a(2,u);case 8:return e.p=8,p=e.v,console.error("[AINodeManager] AI code fixing failed:",p),null!==(d=this.aiAssistant)&&void 0!==d&&d.chatInterface&&this.aiAssistant.chatInterface.addMessage({type:"system_notification",text:"Auto-fix failed.",sender:"system",timestamp:(new Date).toISOString()}),e.a(2,null)}}),e,this,[[1,8]])}))),function(e,t){return k.apply(this,arguments)})},{key:"getProvider",value:function(){return this.aiAssistant.config.get("classificationProvider")||"openrouter"}},{key:"getModel",value:function(){return this.aiAssistant.config.get("classificationModel")||"google/gemini-2.5-flash-preview"}},{key:"callAI",value:(x=v(y().m((function e(t){var a,n,o,i;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("[AINodeManager] Attempting AI call with config:",{hasAiAssistant:!!this.aiAssistant,hasConversationalHandler:!(!this.aiAssistant||!this.aiAssistant.conversationalHandler),hasCallAI:!(!this.aiAssistant||!this.aiAssistant.conversationalHandler||"function"!=typeof this.aiAssistant.conversationalHandler.callAI)}),!this.aiAssistant||!this.aiAssistant.conversationalHandler||"function"!=typeof this.aiAssistant.conversationalHandler.callAI){e.n=4;break}return e.p=1,e.n=2,this.aiAssistant.conversationalHandler.callAI(t);case 2:return a=e.v,console.log("[AINodeManager] ConversationalHandler response type:",p(a)),e.a(2,a);case 3:throw e.p=3,o=e.v,console.error("[AINodeManager] ConversationalHandler callAI failed:",o),o;case 4:if(!this.aiAssistant||"function"!=typeof this.aiAssistant.callAI){e.n=8;break}return console.log("[AINodeManager] Using aiAssistant.callAI fallback"),e.p=5,e.n=6,this.aiAssistant.callAI(t);case 6:return e.a(2,e.v);case 7:throw e.p=7,i=e.v,console.error("[AINodeManager] aiAssistant.callAI failed:",i),i;case 8:throw n="AI call functionality not available - no conversationalHandler or callAI method found",console.error("[AINodeManager]",n),new Error(n);case 9:return e.a(2)}}),e,this,[[5,7],[1,3]])}))),function(e){return x.apply(this,arguments)})},{key:"configureMathNode",value:(b=v(y().m((function e(t,a,n){var o,i,r,s,l,c,u,d,h,f,m;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(o=this.findParentPortData(a.id,n),t.userData=t.userData||{},o&&Object.assign(t.userData,o),t.userData.isEditedLabel=!0,t.userData.label=a.label||"Math",!a.do){e.n=6;break}if(!(r=(i=function(e){var t={isValid:!1,error:null,canEval:!1};try{var a=new Function("return (".concat(e,")"))();t.isValid=!0,t.canEval="function"==typeof a,t.functionType=p(a)}catch(e){t.error={message:e.message,name:e.name,type:"syntax_error"}}return t})(a.do)).isValid){e.n=1;break}console.log("[AINodeManager] Math function Validation succeed."),t.userData.do=a.do,e.n=6;break;case 1:return console.error("[AINodeManager] Math function Validation failed:",r.error),s=a.do,e.p=2,console.log("[AINodeManager] Attempting AI auto-fix for syntax error..."),e.n=3,this.fixCodeWithAI(a.do,r.error);case 3:(l=e.v)?(c=i(l)).isValid?(console.log("[AINodeManager] ✅ AI successfully fixed the code!"),s=l,null!==(u=this.aiAssistant)&&void 0!==u&&u.chatInterface&&this.aiAssistant.chatInterface.addMessage({type:"system_notification",text:"Syntax error fixed automatically.",sender:"system",timestamp:(new Date).toISOString()})):(console.warn("[AINodeManager] ❌ AI-fixed code still has validation errors:",c.error),null!==(d=this.aiAssistant)&&void 0!==d&&d.chatInterface&&this.aiAssistant.chatInterface.addMessage({type:"system_notification",text:"Could not fix syntax error automatically.",sender:"system",timestamp:(new Date).toISOString()})):(console.log("[AINodeManager] AI could not fix the code, using original"),null!==(h=this.aiAssistant)&&void 0!==h&&h.chatInterface&&this.aiAssistant.chatInterface.addMessage({type:"system_notification",text:"Could not fix syntax error automatically.",sender:"system",timestamp:(new Date).toISOString()})),e.n=5;break;case 4:e.p=4,m=e.v,console.error("[AINodeManager] AI fixing process failed:",m);case 5:t.userData.do=s;case 6:a.expression&&("function"==typeof t.setExpression&&t.setExpression(a.expression),t.userData.expression=a.expression),a.formula&&("function"==typeof t.setFormula&&t.setFormula(a.formula),t.userData.formula=a.formula),this.enforceInputSourceOrder(t,a,n),(f=t.getOutputPort(0))&&o&&f.setUserData(o),t.userData.ai_config=a;case 7:return e.a(2)}}),e,this,[[2,4]])}))),function(e,t,a){return b.apply(this,arguments)})},{key:"configureFilterNode",value:(_=v(y().m((function e(t,a,n){var o,i;return y().w((function(e){for(;;)switch(e.n){case 0:o=this.findParentPortData(a.id,n),t.userData=t.userData||{},o&&Object.assign(t.userData,o),t.userData.isEditedLabel=!0,t.userData.label=a.label||"Filter",a.filter&&("function"==typeof t.setFilter&&t.setFilter(a.filter),t.userData.filter=a.filter),a.conditions&&("function"==typeof t.setConditions&&t.setConditions(a.conditions),t.userData.conditions=a.conditions),(i=t.getOutputPort(0))&&o&&i.setUserData(o),t.userData.ai_config=a;case 1:return e.a(2)}}),e,this)}))),function(e,t,a){return _.apply(this,arguments)})},{key:"configureTransformNode",value:(m=v(y().m((function e(t,a,n){var o,i,r,s;return y().w((function(e){for(;;)switch(e.n){case 0:if(o=this.findParentPortData(a.id,n),t.userData=t.userData||{},o&&(o.project&&(t.project=o.project),o.scope&&(t.scope=o.scope),o.sop&&(t.sop=o.sop),o.du_model&&(t.du_model=o.du_model)),t.userData.isEditedLabel=!0,t.userData.label=a.label||"Transform",i=a.transform||a.transforms)if(Array.isArray(i))try{t.userData.transform=JSON.stringify(i,null,4),console.log("[AINodeManager] Set transform for node ".concat(a.id,":"),i)}catch(e){console.error("Error stringifying transform for node ".concat(a.id,":"),e),t.userData.transform="[]"}else t.userData.transform=i;(r=t.getOutputPort(0))&&(s=f({},o),r.setUserData(s)),t.userData.ai_config=a;case 1:return e.a(2)}}),e,this)}))),function(e,t,a){return m.apply(this,arguments)})},{key:"configureUDFNode",value:(h=v(y().m((function e(t,a,n){var o,i,r,s,l,c,u,d,p,h,m,g,_,b,v,w,x,k,D;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!((o=this.findParentPortData(a.id,n))&&o.project&&o.project.proj_id)){e.n=7;break}return t.project=o.project,t.scope=o.scope,t.sop=o.sop,s=(null===(i=this.scope.user)||void 0===i?void 0:i.user_id)||"undefined"!=typeof window&&window.user_id||"6237000453",l=(null===(r=this.settings)||void 0===r?void 0:r.context)||"",c="".concat(l,"/apidata/getAPIData?apiid=").concat("553988106803511296","&user_id=").concat(s),u={proj_id:t.project.proj_id},t.scope&&t.scope.scope_id&&(u.du_model_id=t.scope.scope_id),a.field_code&&(u.field_code=a.field_code),a.field_name&&(u.field_name=a.field_name),e.p=1,console.log("Fetching UDF data:",u),e.n=2,fetch(c,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(u)});case 2:if((d=e.v).ok){e.n=3;break}throw new Error("UDF API fetch failed: ".concat(d.status));case 3:return e.n=4,d.json();case 4:p=e.v,(h=p.data&&p.data.length>0?p.data[0]:null)?(console.log("UDF data received:",h),t.userData||(t.userData={}),t.userData.udf||(t.userData.udf={}),t.userData.udf.field_code=h.field_code||a.field_code||"",t.userData.udf.field_name=h.field_name||a.field_name||"",t.userData.isEditedLabel=!0,t.userData.label=t.userData.udf.field_name||"Custom Field","function"==typeof t.setFieldName&&t.setFieldName(t.userData.udf.field_name),(m=t.getOutputPort(0))?(g=f({},o),m.setUserData(g)):console.warn("Output port 'output0' not found on CustomFieldnode",t.id)):(console.warn("UDF API returned no data for query:",u),t.userData||(t.userData={}),t.userData.udf||(t.userData.udf={}),t.userData.udf.field_code=a.field_code||"",t.userData.udf.field_name=a.field_name||"",_="UDF API returned no data for query: ".concat(JSON.stringify(u),". Using config values as fallback."),console.warn(_),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"CustomFieldnode",message:_}),t.userData.isEditedLabel=!0,t.userData.label=t.userData.udf.field_name||"Custom Field","function"==typeof t.setFieldName&&t.userData.udf.field_name&&t.setFieldName(t.userData.udf.field_name),(b=t.getOutputPort(0))&&b.setUserData(f({},o))),e.n=6;break;case 5:e.p=5,D=e.v,v="Error fetching UDF API data: ".concat(D.message),console.error(v,D),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"CustomFieldnode",message:v}),t.userData||(t.userData={}),t.userData.udf||(t.userData.udf={}),t.userData.udf.field_code=a.field_code||"",t.userData.udf.field_name=a.field_name||"",t.userData.isEditedLabel=!0,t.userData.label=t.userData.udf.field_name||"Custom Field","function"==typeof t.setFieldName&&t.userData.udf.field_name&&t.setFieldName(t.userData.udf.field_name),(w=t.getOutputPort(0))&&w.setUserData(f({},o));case 6:e.n=8;break;case 7:x="Cannot fetch UDF data - missing valid project context from parent node.",console.warn(x,a),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"CustomFieldnode",message:x}),k=a.field_name||a.label||"Custom Field",t.userData.isEditedLabel=!0,t.userData.label=k,"function"==typeof t.setFieldName&&a.field_name&&t.setFieldName(a.field_name);case 8:return e.a(2)}}),e,this,[[1,5]])}))),function(e,t,a){return h.apply(this,arguments)})},{key:"configureRaTableNode",value:(d=v(y().m((function e(t,a,n){var o,i,r,s,l,c,u,d,p,h,f,m,g,_,b;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("[AINodeManager] Configuring RaTablenode ".concat(a.id)),o=this.findParentPortData(a.id,n),t.userData||(t.userData={}),o&&(o.project&&(t.project=o.project),o.scope&&(t.scope=o.scope),o.sop&&(t.sop=o.sop),o.du_model&&(t.du_model=o.du_model)),t.userData.isEditedLabel=!0,t.userData.label=a.label||a.table_name||"Data Table",t.userData.table_name=a.table_name||"tbl_1",t.userData.sites_list_out=[],t.userData.table_col_spec=[],!a.file_name){e.n=17;break}if(e.p=1,console.log("[AINodeManager] Looking for attached file: ".concat(a.file_name)),!(s=null===(i=this.aiAssistant)||void 0===i||null===(i=i.chatInterface)||void 0===i||null===(r=i.getSessionAttachments)||void 0===r?void 0:r.call(i))||!s.files){e.n=14;break}if(!(l=s.files.find((function(e){return e.name===a.file_name})))||!l.content){e.n=12;break}if(console.log("[AINodeManager] Found attached file ".concat(a.file_name,", loading data...")),c=[],"csv"!==l.type&&!l.name.toLowerCase().endsWith(".csv")){e.n=2;break}c=this.parseCSVContent(l.content),e.n=11;break;case 2:if("json"!==l.type&&!l.name.toLowerCase().endsWith(".json")){e.n=6;break}e.p=3,c=JSON.parse(l.content),Array.isArray(c)||(c=[c]),e.n=5;break;case 4:throw e.p=4,g=e.v,new Error("Invalid JSON format in file ".concat(a.file_name,": ").concat(g.message));case 5:e.n=11;break;case 6:if("xlsx"!==l.type&&"xls"!==l.type&&!l.name.toLowerCase().endsWith(".xlsx")&&!l.name.toLowerCase().endsWith(".xls")){e.n=10;break}e.p=7,c=JSON.parse(l.content),Array.isArray(c)||(c=[c]),console.log("[AINodeManager] Parsed Excel file with ".concat(c.length," rows")),e.n=9;break;case 8:throw e.p=8,_=e.v,new Error("Invalid Excel data format in file ".concat(a.file_name,": ").concat(_.message));case 9:e.n=11;break;case 10:console.warn("[AINodeManager] Unsupported file type for ".concat(a.file_name,", using raw text")),c=this.parseCSVContent(l.content);case 11:c&&c.length>0?(console.log("[AINodeManager] Loading ".concat(c.length," records into RaTablenode")),t.userData.sites_list_out=c,this.setupTableColumnSpecs(t,c),"function"==typeof t.loadData?t.loadData(c,!0):console.warn("[AINodeManager] RaTablenode loadData method not available, data stored in userData only"),console.log("[AINodeManager] Successfully loaded data from ".concat(a.file_name))):console.warn("[AINodeManager] No valid data found in file ".concat(a.file_name)),e.n=13;break;case 12:l&&l.error?(u="Failed to load file ".concat(a.file_name,": ").concat(l.error),console.error("[AINodeManager] ".concat(u)),this.trackError("FileLoad",a.id,u)):(d="Attached file ".concat(a.file_name," not found or has no content"),console.warn("[AINodeManager] ".concat(d)),this.trackError("FileNotFound",a.id,d));case 13:e.n=15;break;case 14:p="No attached files available for RaTablenode ".concat(a.id),console.warn("[AINodeManager] ".concat(p)),this.trackError("NoAttachments",a.id,p);case 15:e.n=17;break;case 16:e.p=16,b=e.v,h="Error loading file ".concat(a.file_name," into RaTablenode: ").concat(b.message),console.error("[AINodeManager] ".concat(h),b),this.trackError("FileLoadError",a.id,h,{file:a.file_name});case 17:Object.keys(a).forEach((function(e){"id"===e||"class"===e||"label"===e||t.userData.hasOwnProperty(e)||(t.userData[e]=a[e])})),(f=t.getOutputPort(0))&&(m={project:t.project,scope:t.scope,sop:t.sop,du_model:t.du_model,item_name:"table",task_type:t.userData.table_name||"table",sites_list_out:t.userData.sites_list_out},f.setUserData(m)),t.userData.ai_config=a,console.log("[AINodeManager] RaTablenode ".concat(a.id," configured successfully"));case 18:return e.a(2)}}),e,this,[[7,8],[3,4],[1,16]])}))),function(e,t,a){return d.apply(this,arguments)})},{key:"parseCSVContent",value:function(e){var t=this;try{var a=e.trim().split("\n");if(a.length<2)throw new Error("CSV must have at least header and one data row");for(var n=this.parseCSVLine(a[0]),o=[],i=function(){if(a[r].trim()){var e=t.parseCSVLine(a[r]);if(e.length>0){var i={};n.forEach((function(t,a){i[t.trim()]=e[a]?e[a].trim():""})),o.push(i)}}},r=1;r<a.length;r++)i();return o}catch(e){throw console.error("[AINodeManager] CSV parsing error:",e),new Error("CSV parsing failed: ".concat(e.message))}}},{key:"parseCSVLine",value:function(e){for(var t=[],a="",n=!1,o=0;o<e.length;o++){var i=e[o];'"'===i?n=!n:","!==i||n?a+=i:(t.push(a),a="")}return t.push(a),t}},{key:"setupTableColumnSpecs",value:function(e,t){if(t&&0!==t.length){var a=t[0],n=Object.keys(a);e.userData.table_col_spec=n.map((function(e){return{name:e,formatting:"none",prefix:"",affix:"",bg_color:"#fff",fn_color:"#000",font_type:"Tahoma, Geneva",font_size:"12px",totals:"none",width:"auto",data:t.map((function(t){return t[e]}))}})),console.log("[AINodeManager] Set up ".concat(n.length," column specifications"))}}},{key:"configureGenericNode",value:(u=v(y().m((function e(t,a,n){var o,i,r,s,l;return y().w((function(e){for(;;)switch(e.n){case 0:if(o=this.findParentPortData(a.id,n)){for(i in o.project&&(t.project=o.project),o.scope&&(t.scope=o.scope),o.sop&&(t.sop=o.sop),o.du_model&&(t.du_model=o.du_model),a)"id"===i||"class"===i||t.hasOwnProperty(i)||(t.userData||(t.userData={}),"object"!==p(a[i])||null===a[i]||Array.isArray(a[i])?("label"===i&&(t.userData.isEditedLabel=!0,t.userData.label=a.label),t.userData[i]=a[i]):("object"===p(t.userData[i])&&null!==t.userData[i]||(t.userData[i]={}),Object.assign(t.userData[i],a[i])));this.enforceInputSourceOrder(t,a,n),(r=t.getPort("output0"))&&(s=f({},o),r.setUserData(s))}else for(i in l="Generic node (ID: ".concat(a.id,") has no parent context or source node not found. Proceeding with config data only."),console.warn(l),this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:a.class,message:l}),t.userData||(t.userData={}),a)"id"===i||"class"===i||"label"===i||t.hasOwnProperty(i)||(t.userData[i]=a[i]);t.userData.ai_config=a;case 1:return e.a(2)}}),e,this)}))),function(e,t,a){return u.apply(this,arguments)})},{key:"createConnections",value:(i=v(y().m((function e(t,a){var n,o,i,r,s,l,u;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:n=[],o=c(t),e.p=1,o.s();case 2:if((i=o.n()).done){e.n=7;break}return r=i.value,e.p=3,e.n=4,this.createSingleConnection(r,a);case 4:(s=e.v)&&n.push(s),e.n=6;break;case 5:e.p=5,l=e.v,this.trackError("ConnectionCreation","".concat(r.source||r.src,"->").concat(r.target||r.trgt),l.message,{config:r});case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,u=e.v,o.e(u);case 9:return e.p=9,o.f(),e.f(9);case 10:return e.a(2,n)}}),e,this,[[3,5],[1,8,9,10]])}))),function(e,t){return i.apply(this,arguments)})},{key:"createSingleConnection",value:(n=v(y().m((function e(t,a){var n,i,r,s,l,c,u,d,p,h,f,m,g;return y().w((function(e){for(;;)switch(e.n){case 0:if(n=t.source||t.src,i=t.target||t.trgt,r=a.get(n),s=a.get(i),r&&s){e.n=1;break}throw new Error("Cannot create connection: missing nodes (".concat(n," -> ").concat(i,")"));case 1:if(l=r.getOutputPort(0),c=s.getInputPort(0),l&&c){e.n=2;break}throw new Error("Cannot create connection: missing ports");case 2:u=c.getConnections(),d=0;case 3:if(!(d<u.getSize())){e.n=5;break}if((p=u.get(d)).getSource().getParent().id!==r.id){e.n=4;break}return console.log("[AINodeManager] Connection already exists: ".concat(n," -> ").concat(i,", skipping")),e.a(2,p);case 4:d++,e.n=3;break;case 5:return console.log("[AINodeManager] Creating connection: ".concat(n," -> ").concat(i)),(h=new(o().Connection)).setSource(l),h.setTarget(c),f=new(o().layout.connection.SplineConnectionRouter),h.setRouter(f),this.canvas.add(h),this.nodeTrackingManager.registerConnection(h.id,n,i,{sourcePort:t.sourcePort||"output0",targetPort:t.targetPort||"input0"}),m="".concat(n,"->").concat(i),g=this.currentConnections.find((function(e){return e.source===n&&e.target===i})),g?console.log("[AINodeManager] Connection already stored: ".concat(m,", skipping storage")):(this.currentConnections.push({source:n,target:i,connection:h}),console.log("[AINodeManager] Stored connection: ".concat(m))),e.a(2,h)}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"generateNodesFromConfig",value:(a=v(y().m((function e(t){var a,n,i,r,s,u,d,p,h,f,m,g,_,b,v,w,x,k,D,S,C,T,A,P,E,I,N,M,O=arguments;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:if(a=O.length>1&&void 0!==O[1]?O[1]:null,console.log("[AINodeManager] generateNodesFromConfig called with config:",t),n=a||this.canvas,this.initializeErrorTracking(),this.nodeTrackingManager.startNewGeneration("generation"),(i=t.report_config||t).nodes&&0!==i.nodes.length){e.n=1;break}throw console.error("[AINodeManager] No nodes found in configuration:",i),new Error("Configuration must contain at least one node");case 1:this.connectionConfigs=i.connections||[],console.log("[AINodeManager] Processing ".concat(i.nodes.length," nodes and ").concat(this.connectionConfigs.length," connections")),this.currentConnections=[],r=new Set,s=[],this.connectionConfigs.forEach((function(e){var t="".concat(e.source||e.src,"->").concat(e.target||e.trgt);r.has(t)?s.push(t):r.add(t)})),s.length>0&&console.warn("[AINodeManager] Found duplicate connections in config:",s),u=new Map,d=this.calculateNodePositions(i.nodes),e.p=2,p=0;case 3:if(!(p<i.nodes.length)){e.n=9;break}return h=i.nodes[p],f=d[p],e.p=4,e.n=5,this.createNodeFromConfig(h,n,f);case 5:return m=e.v,u.set(h.id,m),e.n=6,this.configureNodeByType(m,h,u);case 6:"function"==typeof m.updateUI?(console.log("[AINodeManager] Calling updateUI for node:",m.id),m.updateUI()):"function"==typeof m.repaint&&m.repaint(),e.n=8;break;case 7:e.p=7,E=e.v,console.error("Failed to create node ".concat(h.id,":"),E);case 8:p++,e.n=3;break;case 9:if(!i.html){e.n=22;break}console.log("[AINodeManager] Creating HTML container node with content"),e.p=10,g=null,_=c(u),e.p=11,_.s();case 12:if((b=_.n()).done){e.n=14;break}if((v=l(b.value,2))[0],"draw2d.shape.fishbone.cell.Projectnode_api"!==(w=v[1]).NAME){e.n=13;break}return g=w,e.a(3,14);case 13:e.n=12;break;case 14:e.n=16;break;case 15:e.p=15,I=e.v,_.e(I);case 16:return e.p=16,_.f(),e.f(16);case 17:if(!g){e.n=19;break}return x={id:"html-container-"+Date.now(),class:11,label:"HTML Container",cont_id:"html-container",html:i.html},k=g.getPosition(),D={x:k.x+250,y:k.y},e.n=18,this.createNodeFromConfig(x,n,D);case 18:(S=e.v)&&(S.userData||(S.userData={}),S.userData.cont_id="html-container",S.userData.html=i.html,C=g.getOutputPort(0),T=S.getInputPort(0),C&&T?(console.log("[AINodeManager] Creating connection: ".concat(g.ai_id||g.id," -> ").concat(S.ai_id||S.id," (HTML container)")),(A=new(o().Connection)).setSource(C),A.setTarget(T),P=new(o().layout.connection.SplineConnectionRouter),A.setRouter(P),n.add(A),console.log("[AINodeManager] HTML container connected to project node")):console.warn("[AINodeManager] Failed to connect HTML container: ports not found"),"function"==typeof S.updateUI?S.updateUI():"function"==typeof S.repaint&&S.repaint(),console.log("[AINodeManager] HTML container node created and connected"),this.scope&&this.scope.report&&(console.log("[AINodeManager] Checking HTML panel setup"),this.scope.report.has_html||(this.scope.report.has_html=!0,console.log("[AINodeManager] Enabled has_html flag"),this.scope.html_area_size&&(this.scope.html_area_size={left:"40%",middle:"40%",right:"20%"},console.log("[AINodeManager] Set initial html_area_size for HTML panel"))),this.scope.report.no_html_ed||(this.scope.report.no_html_ed=!0,console.log("[AINodeManager] Disabled EditorJS for AI-generated content")),this.scope.$apply&&this.scope.$evalAsync((function(){console.log("[AINodeManager] Triggered Angular scope update for HTML panel")})))),e.n=20;break;case 19:console.warn("[AINodeManager] No project node found to connect HTML container to");case 20:e.n=22;break;case 21:e.p=21,N=e.v,console.error("[AINodeManager] Failed to create HTML container node:",N);case 22:if(!(this.connectionConfigs&&this.connectionConfigs.length>0)){e.n=23;break}return console.log("[AINodeManager] About to create ".concat(this.connectionConfigs.length," connections")),e.n=23,this.createConnections(this.connectionConfigs,u);case 23:return i.nodes.length>3&&!t.preservePositions&&this.applyAutoLayout(n),this.nodeTrackingManager.completeGeneration({nodeCount:u.size,connectionCount:this.currentConnections.length,errors:this.errors.length}),e.a(2,{success:!0,nodes:Array.from(u.values()),connections:this.currentConnections,errors:this.errors});case 24:throw e.p=24,M=e.v,console.error("Generation failed:",M),this.nodeTrackingManager.completeGeneration({error:M.message,errors:this.errors.length}),M;case 25:return e.a(2)}}),e,this,[[11,15,16,17],[10,21],[4,7],[2,24]])}))),function(e){return a.apply(this,arguments)})},{key:"calculateNodePositions",value:function(e){if(!this.connectionConfigs||0===this.connectionConfigs.length)return console.log("[AINodeManager] No connections found, using type-based layout"),this.calculateNodePositionsByType(e);try{return console.log("[AINodeManager] Using tree-based layout with",this.connectionConfigs.length,"connections"),this.calculateTreeBasedPositions(e,this.connectionConfigs)}catch(t){return console.warn("[AINodeManager] Tree-based layout failed, falling back to type-based:",t),this.calculateNodePositionsByType(e)}}},{key:"calculateNodePositionsByType",value:function(e){for(var t=[],a=100,n=0,o=[e.filter((function(e){return 1===e.class})),e.filter((function(e){return 2===e.class})),e.filter((function(e){return[3,4,5,6].includes(e.class)})),e.filter((function(e){return[7,13,14].includes(e.class)})),e.filter((function(e){return[8,9,10].includes(e.class)})),e.filter((function(e){return![1,2,3,4,5,6,7,8,9,10,13,14].includes(e.class)}))];n<o.length;n++){var i=o[n];if(0!==i.length){var r,s=100,l=c(i);try{for(l.s();!(r=l.n()).done;){var u=r.value;t[e.indexOf(u)]={x:s,y:a},s+=200}}catch(e){l.e(e)}finally{l.f()}a+=70}}return t}},{key:"calculateTreeBasedPositions",value:function(e,t){var a=[],n=new Map;e.forEach((function(e,t){n.set(e.id,t)}));var o=this.assignToLayers(e,t);if(!o||0===o.length)return console.warn("[AINodeManager] Layer assignment failed, using type-based layout"),this.calculateNodePositionsByType(e);var i=250*Math.max.apply(Math,s(o.map((function(e){return e.length}))));return o.forEach((function(e,t){var o=100+70*t,r=250*e.length,s=100+Math.max(0,(i-r)/2);e.forEach((function(e,t){var i=n.get(e);void 0!==i&&(a[i]={x:s+250*t,y:o})}))})),e.forEach((function(e,t){a[t]||(console.warn("[AINodeManager] Node ".concat(e.id," has no position, placing at default")),a[t]={x:100,y:100})})),a}},{key:"assignToLayers",value:function(e,t){var a=[],n=new Set,o=new Map,i=new Map;e.forEach((function(e){o.set(e.id,0),i.set(e.id,[])})),t.forEach((function(e){var t=e.source||e.src,a=e.target||e.trgt;if(t&&a){o.set(a,(o.get(a)||0)+1);var n=i.get(t)||[];n.push(a),i.set(t,n)}}));var r=[];if(e.forEach((function(e){0===o.get(e.id)&&r.push(e.id)})),0===r.length){console.warn("[AINodeManager] No root nodes found, cycle detected or invalid connections");var l=1/0;e.forEach((function(e){var t=o.get(e.id)||0;t<l&&(l=t)})),e.forEach((function(e){o.get(e.id)===l&&r.push(e.id)}))}for(var c=[].concat(r),u=function(){c.sort(),a.push(s(c)),c.forEach((function(e){return n.add(e)}));var e=new Set;c.forEach((function(a){(i.get(a)||[]).forEach((function(a){n.has(a)||t.filter((function(e){return(e.target||e.trgt)===a})).every((function(e){return n.has(e.source||e.src)}))&&e.add(a)}))})),c=Array.from(e)};c.length>0&&n.size<e.length;)u();var d=e.filter((function(e){return!n.has(e.id)})).map((function(e){return e.id}));return d.length>0&&(console.warn("[AINodeManager] Found",d.length,"disconnected nodes"),a.push(d)),console.log("[AINodeManager] Created",a.length,"layers:",a.map((function(e){return"[".concat(e.length," nodes]")})).join(" -> ")),a}},{key:"applyAutoLayout",value:function(e){try{console.log("[AINodeManager] Auto-layout is currently disabled"),e.getLines().each((function(e,t){(t.getRouter()instanceof o().layout.connection.SplineConnectionRouter||t.getRouter()instanceof o().layout.connection.ManhattanConnectionRouter)&&t.getRouter().route(t)}))}catch(e){console.warn("[AINodeManager] Auto-layout failed:",e)}}},{key:"findParentPortData",value:function(e,t){if(!this.connectionConfigs||0===this.connectionConfigs.length)return console.error("[AINodeManager] findParentPortData called but this.connectionConfigs is not set."),null;var a,n=c(this.connectionConfigs);try{for(n.s();!(a=n.n()).done;){var o=a.value;if((o.trgt||o.target)===e){var i=o.src||o.source,r=t.get?t.get(i):t[i];if(r){var s=r.getOutputPort(0);if(s&&s.getUserData())return console.log("[AINodeManager] findParentPortData: Found parent data for ".concat(e," from source ").concat(i," port ").concat(s.getName())),s.getUserData();console.warn("[AINodeManager] findParentPortData: Source node ".concat(i," for target ").concat(e," found, but output port 'output0' is missing."))}else console.warn("[AINodeManager] findParentPortData: Source node ID '".concat(i,"' specified in connection to target ").concat(e," not found in nodesMap."));return null}}}catch(e){n.e(e)}finally{n.f()}return console.log("[AINodeManager] findParentPortData: No parent connection found for ".concat(e," in config connections.")),null}},{key:"getNodeTypeName",value:function(e){return{1:"Project",2:"DU Model",3:"Task",4:"Custom Field",5:"SQL",6:"Union",7:"Transform",8:"Chart",9:"Vega Chart",10:"Table",11:"HTML",12:"Style",13:"Math",14:"Filter",15:"API",16:"DataTable"}[e]||"Type ".concat(e)}},{key:"getErrorSummary",value:function(){return{total:this.errors.length,byType:this.errors.reduce((function(e,t){return e[t.type]=(e[t.type]||0)+1,e}),{}),errors:this.errors}}},{key:"extractInputSourceOrderFromRowData",value:function(e){var t,a=[];if(null===(t=e.userData)||void 0===t||!t.row||!Array.isArray(e.userData.row))return console.warn("[AINodeManager] No row data found for node ".concat(e.id,", falling back to connection order")),null;var n=new Set;e.userData.row.forEach((function(e){e&&e.owner_id&&n.add(e.owner_id)})),console.log("[AINodeManager] Found ".concat(n.size," unique owner_ids in row data for node ").concat(e.id));var o=this.canvas.getLines();return n.forEach((function(e){o.each((function(t,n){if(n.getSource().getId()===e){var o=n.getSource().getParent(),i=o.ai_id||o.id;a.includes(i)||(a.push(i),console.log("[AINodeManager] Mapped owner_id ".concat(e," to source AI ID ").concat(i)))}}))})),a.length>0?a:null}},{key:"analyzeConnectionsAndSort",value:function(e){console.log("[AINodeManager] Analyzing connections for dependency ordering...");var t=e||this.canvas,a=t.getFigures(),n=t.getLines(),o=new Map,i=new Map,r=new Map;a.each((function(e,t){var a=t.getId();o.set(a,t),r.set(a,0),i.set(a,[])})),n.each((function(e,t){try{var a=t.getSource().getParent(),n=t.getTarget().getParent();if(a&&n){var o=a.getId(),s=n.getId();i.has(o)||i.set(o,[]),i.get(o).push(s),r.set(s,(r.get(s)||0)+1)}}catch(e){console.warn("[AINodeManager] Error analyzing connection:",e)}}));var s,u=[],d=[],p=c(r);try{for(p.s();!(s=p.n()).done;){var h=l(s.value,2),f=h[0];0===h[1]&&u.push(f)}}catch(e){p.e(e)}finally{p.f()}for(;u.length>0;){var m=u.shift(),g=o.get(m);d.push(g);var y,_=c(i.get(m)||[]);try{for(_.s();!(y=_.n()).done;){var b=y.value;r.set(b,r.get(b)-1),0===r.get(b)&&u.push(b)}}catch(e){_.e(e)}finally{_.f()}}if(d.length!==a.getSize()){var v,w=[],x=c(r);try{for(x.s();!(v=x.n()).done;){var k=l(v.value,2),D=k[0];k[1]>0&&w.push(D)}}catch(e){x.e(e)}finally{x.f()}console.warn("[AINodeManager] Circular dependency detected in nodes:",w),w.forEach((function(e){var t=o.get(e);t&&d.push(t)}))}return console.log("[AINodeManager] Dependency analysis complete. Ordered ".concat(d.length," nodes.")),d}},{key:"generateConfigFromNodes",value:function(e){var t,a,n=this;console.log("[AINodeManager] Generating config from nodes...");var o=(e||this.canvas).getLines(),i=[],s=[],l=new Map,c=new Set,u="",d=this.analyzeConnectionsAndSort(e);console.log("[AINodeManager] Processing ".concat(d.length," nodes in dependency order...")),d.forEach((function(e,t){var a,n,o=e.id,i=e.ai_id||o;"draw2d.shape.fishbone.cell.HTMLnode"===e.NAME&&"html-container"===(null===(a=e.userData)||void 0===a?void 0:a.cont_id)&&(c.add(i),null!==(n=e.userData)&&void 0!==n&&n.html&&(u+=e.userData.html)),i&&l.set(i,e)})),d.forEach((function(e){var t,a=e.id,o=e.ai_id||a;if(!c.has(o)){var s={};s.id=o;var l=e.NAME||e.cssClass,u=n.reverseClassMapping[l];if(u){s.class=u,s.label=(null===(t=e.userData)||void 0===t?void 0:t.label)||o;var d,p=e.userData||{};switch(u){case 1:p.project&&(p.project.proj_id&&(s.proj_id=p.project.proj_id),p.project.proj_name&&(s.proj_name=p.project.proj_name),p.project.proj_code&&(s.proj_code=p.project.proj_code));break;case 2:p.du_model&&(p.du_model.du_model_id&&(s.du_model_id=p.du_model.du_model_id),p.du_model.du_model_name&&(s.du_model_name=p.du_model.du_model_name));break;case 3:p.task&&(p.task.scope_task_id&&(s.scope_task_id=p.task.scope_task_id),p.task.scope_task_name&&(s.scope_task_name=p.task.scope_task_name),p.task.scope_task_code&&(s.scope_task_code=p.task.scope_task_code));break;case 4:p.udf&&(p.udf.field_code&&(s.field_code=p.udf.field_code),p.udf.field_name&&(s.field_name=p.udf.field_name));break;case 5:if(console.log("[AINodeManager] Processing SQL node ".concat(o)),p.sql&&(s.sql=p.sql),!(d=n.extractInputSourceOrderFromRowData(e))){console.log("[AINodeManager] Falling back to connection order for SQL node ".concat(o)),d=[];for(var h=function(t){var a=e.getInputPort(t);a&&a.getConnections().each((function(e,a){var n=a.getSource().getParent(),i=n.ai_id||n.id;d.includes(i)||(d.push(i),console.log("[AINodeManager] SQL node ".concat(o," port[").concat(t,"] connection[").concat(e,"]: source AI ID = ").concat(i)))}))},f=0;f<e.getInputPorts().getSize();f++)h(f)}d.length>0?(s.inputSourceOrder=d,console.log("[AINodeManager] ✅ Successfully stored connection order for SQL node ".concat(o,":"),d)):console.warn("[AINodeManager] ❌ No input connections found for SQL node ".concat(o));break;case 6:if(console.log("[AINodeManager] Processing Union node ".concat(o)),!(d=n.extractInputSourceOrderFromRowData(e))){console.log("[AINodeManager] Falling back to connection order for Union node ".concat(o)),d=[];for(var m=function(t){var a=e.getInputPort(t);a&&a.getConnections().each((function(e,a){var n=a.getSource().getParent(),i=n.ai_id||n.id;d.includes(i)||(d.push(i),console.log("[AINodeManager] Union node ".concat(o," port[").concat(t,"] connection[").concat(e,"]: source AI ID = ").concat(i)))}))},g=0;g<e.getInputPorts().getSize();g++)m(g)}d.length>0?(s.inputSourceOrder=d,console.log("[AINodeManager] ✅ Successfully stored connection order for Union node ".concat(o,":"),d)):console.warn("[AINodeManager] ❌ No input connections found for Union node ".concat(o));break;case 7:if(p.transform)if("string"==typeof p.transform)try{s.transform=r().parse(p.transform)}catch(e){console.error("Error parsing transform JSON for node ".concat(o,":"),e),s.transform=[]}else s.transform=p.transform;break;case 8:p.cont_id&&(s.cont_id=p.cont_id),p.dataset&&(s.dataset=p.dataset),p.config&&(s.config=p.config);break;case 9:p.cont_id&&(s.cont_id=p.cont_id),p.vega&&(s.vega=p.vega),p.leaflet&&(s.leaflet=p.leaflet),p.spec&&(s.spec=p.spec),p.vis_target&&(s.vis_target=p.vis_target);break;case 10:p.cont_id&&(s.cont_id=p.cont_id),p.config&&(s.config=p.config),p.renderer&&(s.renderer=p.renderer),p.menu&&(s.menu=p.menu),p.theme&&(s.theme=p.theme);break;case 11:p.cont_id&&(s.cont_id=p.cont_id),p.html&&(s.html=p.html),p.binder&&(s.binder=p.binder),p.params&&(s.params=p.params);break;case 12:p.style&&(s.style=p.style);break;case 13:if(console.log("[AINodeManager] Processing Math node ".concat(o)),p.do&&(s.do=p.do),!(d=n.extractInputSourceOrderFromRowData(e))){console.log("[AINodeManager] Falling back to connection order for Math node ".concat(o)),d=[];for(var y=function(t){var a=e.getInputPort(t);a&&a.getConnections().each((function(e,a){var n=a.getSource().getParent(),i=n.ai_id||n.id;d.includes(i)||(d.push(i),console.log("[AINodeManager] Math node ".concat(o," port[").concat(t,"] connection[").concat(e,"]: source AI ID = ").concat(i)))}))},_=0;_<e.getInputPorts().getSize();_++)y(_)}d.length>0?(s.inputSourceOrder=d,console.log("[AINodeManager] ✅ Successfully stored connection order for Math node ".concat(o,":"),d)):console.warn("[AINodeManager] ❌ No input connections found for Math node ".concat(o));break;case 14:p.filter&&(s.filter=p.filter),p.cont_id&&(s.cont_id=p.cont_id),p.win_size&&(s.win_size=p.win_size),p.message&&(s.message=p.message),p.showBusket&&(s.showBusket=p.showBusket);break;case 15:p.apiid&&(s.apiid=p.apiid),p.params&&(s.params=p.params);break;case 16:p.columns&&(s.columns=p.columns),p.table_config&&(s.table_config=p.table_config)}i.push(s)}else console.error("[AINodeManager] Unknown class name '".concat(l,"' for node '").concat(o,"'"))}})),o.each((function(e,t){var a=t.getSource().getParent(),n=t.getTarget().getParent(),o=a.ai_id||a.id,i=n.ai_id||n.id;l.has(o)&&l.has(i)&&!c.has(o)&&!c.has(i)&&s.push({source:o,target:i})})),console.log("[AINodeManager] Generated config with ".concat(i.length," nodes and ").concat(s.length," connections"));var p={report_config:{nodes:i,connections:s}};if(u&&(p.report_config.html=u),null!==(t=this.scope.report)&&void 0!==t&&t.has_html&&(null===(a=this.scope.report)||void 0===a||!a.no_html_ed)){var h=document.getElementById("editorjs");if(h){var f=h.innerHTML;f&&""!==f.trim()&&(p.report_config.html=f)}}return p}},{key:"enforceInputSourceOrder",value:function(e,t,a){var n=this,o=this.reverseClassMapping[e.cssClass]||t.class;if((5===o||6===o||13===o)&&t.inputSourceOrder&&Array.isArray(t.inputSourceOrder)){var i=5===o?"SQL":6===o?"Union":"Math";console.log("[AINodeManager] Enforcing inputSourceOrder for ".concat(i," node ").concat(t.id,":"),t.inputSourceOrder),e.userData||(e.userData={}),e.userData.inputSourceOrder=s(t.inputSourceOrder),setTimeout((function(){n.reorderNodeInputData(e,t.inputSourceOrder,a)}),100)}}},{key:"reorderNodeInputData",value:function(e,t,a){if(e.userData&&e.userData.row&&Array.isArray(e.userData.row)){var n=e.userData.row,o=[];console.log("[AINodeManager] Reordering node ".concat(e.id," with ").concat(n.length," row items and inputSourceOrder:"),t);var i=new Map,r=e.getInputPort(0);if(r){var s=r.getConnections();console.log("[AINodeManager] Node ".concat(e.id," has ").concat(s.getSize()," input connections on canvas")),s.each((function(e,t){var a=t.getSource().getParent(),o=a.ai_id||a.id,r=t.getSource().getId(),s=n.find((function(e){return e&&e.owner_id===r}));s?(i.set(o,s),console.log("[AINodeManager] Mapped source AI ID ".concat(o," (port ").concat(r,") to row data"))):console.warn("[AINodeManager] No row data found for source port ".concat(r," (AI ID: ").concat(o,")"))}))}console.log("[AINodeManager] Available source AI IDs:",Array.from(i.keys())),console.log("[AINodeManager] Expected inputSourceOrder:",t),t.forEach((function(e,t){var a=i.get(e);a?(o[t]=a,console.log("[AINodeManager] ✅ Positioned data from source AI node ".concat(e," at index ").concat(t))):console.warn("[AINodeManager] ❌ No data found for source AI node ".concat(e))})),e.userData.row=o.filter((function(e){return void 0!==e})),console.log("[AINodeManager] Reordering complete for node ".concat(e.id,". Original length: ").concat(n.length,", new length: ").concat(e.userData.row.length))}else console.log("[AINodeManager] No row data found for node ".concat(e.id,", reordering not needed"))}}],t&&w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a,n,i,u,d,h,m,_,b,x,k,D,S,C,T,A,P,E}()},"772ed6bbdaacd4a99fc5":()=>{},"7c9e29c717f799964fbc":(e,t,a)=>{"use strict";a("d03d36be50c40888c6b4"),a("110432cd068f6fa15fe7"),e=a.hmd(e);var n=a("a45670b3d8fb79ec0258"),o=a("1f44d888ec90c0bf8262");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}(function(){var t;Array.prototype.equals&&console.warn("Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code."),Array.prototype.equals=function(e){if(!e)return!1;if(this.length!=e.length)return!1;for(var t=0,a=this.length;t<a;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].equals(e[t]))return!1}else if(this[t]!=e[t])return!1;return!0},Object.defineProperty(Array.prototype,"equals",{enumerable:!1}),t=function(e){var t;return t=function(e){function t(e,t){var a=-1;return t.forEach((function(t,n){t.name===e&&(a=n)})),a}return null==e&&(e={}),function(a,n){var i,r,s,l,c,u,d,p,h,f,m,g,y,_=n.figure,b=[],v=-1,w={};w.colors=_.userData.pivot.colors;var x={title:_.userData.pivot.chart.title,title_left:_.userData.pivot.chart.title_left,title_right:_.userData.pivot.chart.title_right,grid:_.userData.grid,popup:_.userData.pivot.chart.popup,toolbar:_.userData.pivot.chart.toolbar,view:w,size:_.userData.size,data_table:_.userData.pivot.chart.data_table,xAxis:_.userData.pivot.chart.xAxis||default_xAxis,yAxis:_.userData.pivot.chart.yAxis||default_yAxis,series:[]};for(0===(m=a.getRowKeys()).length&&m.push([]),0===(r=a.getColKeys()).length&&r.push([]),g=a.rowAttrs,n.stack.length&&(v=g.indexOf(n.stack[0])),x.xAxis.data=function(){var e,t,a;for(a=[],e=0,t=r.length;e<t;e++)s=r[e],x.xAxis.labels.multi_line?a.push(s.join("\n")):a.push(s.join(x.xAxis.labels.separator||"-"));return a}(),l=0,c=m.length;l<c;l++){h=(f=m[l]).join("-"),p=[],v>-1&&f[v];var k=0,D=[];for(d=0,u=r.length;d<u;d++)i=r[d],y=parseFloat(a.getAggregator(f,i).value()),D.push(y),isFinite(y)?y<1?t(h,_.userData.pivot.chart.series)>-1&&"accumulative"===_.userData.pivot.chart.series[t(h,_.userData.pivot.chart.series)].trend?(k+=parseFloat(y.toPrecision(3)),p.push(k)):(k=parseFloat(y.toPrecision(3)),p.push(k)):t(h,_.userData.pivot.chart.series)>-1&&"accumulative"===_.userData.pivot.chart.series[t(h,_.userData.pivot.chart.series)].trend?(k+=y,p.push(k)):(k=y,p.push(k)):t(h,_.userData.pivot.chart.series)>-1&&"accumulative"===_.userData.pivot.chart.series[t(h,_.userData.pivot.chart.series)].trend?p.push(k):p.push(0);if(t(h,_.userData.pivot.chart.series)>-1&&!_.userData.pivot.chart.series[t(h,_.userData.pivot.chart.series)].force_acc)for(;!isFinite(D[D.length-1])||0===D[D.length-1];)p.pop(),D.pop();_.userData.pivot.chart.series||(_.userData.pivot.chart.series=[]);var S,C=t(h,_.userData.pivot.chart.series);C>-1?(S=_.userData.pivot.chart.series[C]).data=p:S={name:h,type:"bar"===e.type?"bar":"line",data:p},b.push(S)}_.userData.pivot.chart.series=b,x.series=_.userData.pivot.chart.series,null!==_.uChart?_.uChart=null:_.uChart,_.uChart=o.init(_.canvas.paper,x,_);var T=_.uChart.svg_nodes;return _.setNewDataU(T),!0}},e.pivotUtilities_ra.ra_renderers={"Line UChart":t(),"Bar UChart":t({type:"bar"})}},"object"===("undefined"==typeof exports?"undefined":i(exports))&&"object"===i(e)?t(a("a45670b3d8fb79ec0258")):"function"==typeof define&&a.amdO?define(["jquery"],t):t(n)}).call(void 0)},"7d1977f2f5bd88971e4f":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("d1be49724a1f416e7f57");function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}n.shape.fishbone.cell.Unionnode=n.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Unionnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Unionnode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(o.extend({color:"#20b3b9",filter_str:"Union"},e),t,a,n);var s=this;o.extend(this.userData,{label:"New Label",type_name:"union"}),o.extend(!0,this.treema_scheme,{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{use_push:{type:"boolean",title:"Simple Push",default:!0},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"join"}}}),this.updateTable=function(){if(DEBUG&&console.log(this.NAME+" id:"+this.id+" "+s.userData.label+" updateTable"),this.updateTickets=[],s.userData.sites_list_out=[],s.userData.row.length>0){var e=[];s.userData.use_push?s.userData.row.forEach((function(e,t){var a,n;e.sites_list_out.length&&(a=s.userData.sites_list_out).push.apply(a,function(e){if(Array.isArray(e))return r(e)}(n=e.sites_list_out)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())})):(s.userData.row.forEach((function(t,a){e=0===a?t.sites_list_out.slice():i("SELECT * FROM ? AS l union all CORRESPONDING  SELECT * FROM ? AS r",[t.sites_list_out,e])})),s.userData.sites_list_out=e)}s.userData.value=s.userData.sites_list_out.length,s.userData.group_name&&s.userData.sites_list_out.forEach((function(e,t){e.group_name=s.userData.group_name})),s.getPort("output0").setUserData({project:s.project,scope:s.scope,item_name:s.userData.label,sites_list_out:s.userData.sites_list_out}),s.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(s.getId()),t.setColor(s.frame.attr("stroke"))}),this)),this.updateUI()}}})},"7e16b8e06b5b1b988917":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("d1be49724a1f416e7f57");n.shape.fishbone.cell.Ornode=n.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Ornode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Ornode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(o.extend({color:"#9a9a9a",filter_str:"Or"},e),t,a,n);var r=this;o.extend(this.userData,{comp_level:"site_id",sites_list_out:[],label:"New Label",type_name:"and"}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{comp_level:{type:"string",title:"Comparision Level",default:"sites",enum:["site_id","site_code","du_id"]},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"add"}}}),this.updateTable=function(){if(console.log("add updateTable"),r.userData.sites_list_out=[],r.userData.row.length>0){var e=[];r.userData.row.forEach((function(t,a){var n;0===a?e=t.sites_list_out.slice():("site_id"===r.userData.comp_level?n=i("SELECT f.*, s.* FROM ? AS f FULL OUTER JOIN ? AS s ON f.site_id = s.site_id",[t.sites_list_out,e]):"site_code"===r.userData.comp_level?n=i("SELECT f.*, s.* FROM ? AS f FULL OUTER JOIN ? AS s ON f.site_code = s.site_code",[t.sites_list_out,e]):"du_id"===r.userData.comp_level&&(n=i("SELECT f.*, s.* FROM ? AS f FULL OUTER JOIN ? AS s ON f.du_id = s.du_id",[t.sites_list_out,e])),e=n),r.userData.sites_list_out=e}))}r.userData.value=r.userData.sites_list_out.length,r.userData.sites_list_out.forEach((function(e,t){e.task_name=r.userData.label,e.task_type=r.userData.type_name||"or"})),r.getPort("output0").setUserData({project:r.project,scope:r.scope,sop:r.sop,item_name:r.userData.label,task_type:r.userData.type_name||"or",sites_list_out:r.userData.sites_list_out}),r.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(r.getId()),t.setColor(r.frame.attr("stroke"))}),this)),this.updateUI()}}})},"84c83683c1d44bbbc02a":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("d1be49724a1f416e7f57");n.shape.fishbone.cell.Andnode=n.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Andnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Andnode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(o.extend({color:"#9a9a9a",filter_str:"And",data_type:"row"},e),t,a,n);var r=this;o.extend(this.userData,{comp_level:"du_id",sites_list_out:[],label:"New Label",type_name:"and"}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{comp_level:{type:"string",title:"Comparision Level",default:"du_id",enum:["site_id","site_code","du_id"]},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"add"}}}),this.updateTable=function(){if(console.log("add updateTable"),r.userData.sites_list_out=[],r.userData.row.length>0){var e=[];r.userData.row.forEach((function(t,a){var n;0===a?e=t.sites_list_out.slice():("site_id"===r.userData.comp_level?n=i("SELECT f.*, s.* FROM ? AS f INNER JOIN ? AS s ON f.site_id = s.site_id",[t.sites_list_out,e]):"site_code"===r.userData.comp_level?n=i("SELECT f.*, s.* FROM ? AS f INNER JOIN ? AS s ON f.site_code = s.site_code",[t.sites_list_out,e]):"du_id"===r.userData.comp_level&&(n=i("SELECT f.*, s.* FROM ? AS f INNER JOIN ? AS s ON f.du_id = s.du_id",[t.sites_list_out,e])),e=n),r.userData.sites_list_out=e}))}r.userData.value=r.userData.sites_list_out.length,r.userData.sites_list_out.forEach((function(e,t){e.task_name=r.userData.label,e.task_type=r.userData.type_name||"and"})),r.getPort("output0").setUserData({project:r.project,scope:r.scope,sop:r.sop,item_name:r.userData.label,task_type:r.userData.type_name||"and",sites_list_out:r.userData.sites_list_out}),r.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(r.id),t.setColor(r.frame.attr("stroke"))}),this)),this.updateUI()}}})},"854402d9b0ad1beadd6f":function(e,t,a){!function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t=function(){function e(t){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.onWarning=t||(console?console.log:function(){})}return e.prototype.addToList=function(e,t,a){var n=new Map(a.map((function(e){return"string"==typeof e?[e,{name:e}]:[e.name,e]}))),o=this.findUndefined(e,t,n.keys()),i=Array.isArray(o),r=0;for(o=i?o:o[Symbol.iterator]();;){var s;if(i){if(r>=o.length)break;s=o[r++]}else{if((r=o.next()).done)break;s=r.value}var l=s;e[t].push(n.get(l))}return e},e.prototype.overrideField=function(e,t,a){return e[t]&&e[t]!==a&&this.onWarning("Overriding "+t+": "+e[t]+" 𐃘 "+a),e[t]=a,e},e.prototype.findUndefined=function(e,t,a){if(!e.hasOwnProperty(t))return e[t]=[],a;if(!Array.isArray(e[t]))throw new Error("spec."+t+" must be an array");var n=new Set(a),o=e[t],i=Array.isArray(o),r=0;for(o=i?o:o[Symbol.iterator]();;){var s;if(i){if(r>=o.length)break;s=o[r++]}else{if((r=o.next()).done)break;s=r.value}var l=s;l.name&&n.delete(l.name)}return n},e}(),a=function(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,a){return function n(o,i){try{var r=t[o](i),s=r.value}catch(e){return void a(e)}if(!r.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}},n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,o=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done)&&(a.push(r.value),!t||a.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.vega=function(t,a){return new e.VegaLayer(t,a)},e.VegaLayer=(e.Layer?e.Layer:e.Class).extend({options:{vega:window&&window.vega,bindingsContainer:void 0,parseConfig:void 0,parseOptions:void 0,viewConfig:void 0,delayRepaint:!0,onWarning:!1,onError:!1},initialize:function(a,n){var o=this;e.Util.setOptions(this,n);var i=this.options.vega;i.expressionFunction("setMapView")||i.expressionFunction("setMapView",(function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];var n=this.context.dataflow,o=n.Leaflet_setMapViewHandler;if(!o)throw new Error("setMapView() is not defined for this graph");n.runAfter((function(){return o.apply(void 0,t)}))})),this._ignoreSignals=0,this.disableSignals=function(){o._ignoreSignals++},this.enableSignals=function(){if(o._ignoreSignals--,o._ignoreSignals<0)throw o._ignoreSignals=0,new Error("Too many calls to enableSignals()")};var r=new t(n.onWarning);r.overrideField(a,"padding",0),r.overrideField(a,"autosize","none"),r.addToList(a,"signals",["zoom","latitude","longitude"]),r.addToList(a,"projections",[this.defaultProjection]),this._spec=a},addTo:function(e){return e.addLayer(this),this},onAdd:function(e){return this._onAddAsync(e),this},_onAddAsync:function(t){var o=this;return a(regeneratorRuntime.mark((function a(){var i,r,s,l,c,u;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o.disableSignals(),a.prev=1,o._map=t,o._vegaContainer=e.DomUtil.create("div","leaflet-vega-container"),t._panes.overlayPane.appendChild(o._vegaContainer),i=o.options,r=i.vega,s=i.viewConfig,l=r.parse(o._spec,o.options.parseConfig,o.options.parseOptions),s&&s.loader&&(c=s.loader.load.bind(s.loader),s.loader.load=function(e,t){return c(e,t)}),o._view=new r.View(l,s),s&&void 0!==s.logLevel||o._view.logLevel(r.Warn),o.options.onWarning&&(o._view.warn=o.options.onWarning),o.options.onError&&(o._view.error=o.options.onError),o._view.padding({left:0,right:0,top:0,bottom:0}).initialize(o._vegaContainer,o.options.bindingsContainer).hover(),u=function(e,t){return o._onSignalChange(e,t)},o._view.addSignalListener("latitude",u).addSignalListener("longitude",u).addSignalListener("zoom",u),t.on(o.options.delayRepaint?"moveend":"move",(function(){return o._resetAsync()})),t.on("zoomend",(function(){return o._resetAsync()})),o._view.Leaflet_setMapViewHandler=function(){for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];function r(){throw new Error("Unexpected setMapView() parameters. It could be called with a bounding box setMapView([[longitude1,latitude1],[longitude2,latitude2]]), or it could be the center point setMapView([longitude, latitude], optional_zoom), or it can be used as setMapView(latitude, longitude, optional_zoom)")}function s(e){return Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]||r(),e}var l=void 0,c=void 0,u=void 0;switch(o.length){default:r();break;case 1:var d=o[0];if(Array.isArray(d)&&2===d.length&&Array.isArray(d[0])&&Array.isArray(d[1])){var p=s(d[0]),h=n(p,2),f=h[0],m=h[1],g=s(d[1]),y=n(g,2),_=y[0],b=y[1];d[2]&&(f*=d[2][0],_*=d[2][0],m*=d[2][1],b*=d[2][1]),t.fitBounds(e.latLngBounds(e.latLng(m,f),e.latLng(b,_)))}else{var v=s(d),w=n(v,2);l=w[0],c=w[1]}break;case 2:if(Array.isArray(o[0])){var x=s(o[0]),k=n(x,2);l=k[0],c=k[1],u=o[1]}else c=o[0],l=o[1];break;case 3:c=o[0],l=o[1],u=o[2]}void 0!==c&&void 0!==l&&("number"==typeof c&&"number"==typeof l||r(),void 0===u?u=t.getZoom():"number"!=typeof u&&r(),t.setView({lat:c,lng:l},u))},a.next=20,o._resetAsync(!0);case 20:a.next=25;break;case 22:a.prev=22,a.t0=a.catch(1),o._reportError(a.t0);case 25:return a.prev=25,o.enableSignals(),a.finish(25);case 28:case"end":return a.stop()}}),a,o,[[1,22,25,28]])})))()},onRemove:function(){this._view&&(this._view.finalize(),this._view=null);for(var e=this._vegaContainer;e.firstChild;)e.removeChild(e.firstChild)},_reportError:function(e){this.options.onError?this.options.onError(e):console&&console.error&&console.error(e)},_onSignalChange:function(e,t){if(!this._ignoreSignals)try{var a=this._map,n=a.getCenter(),o=a.getZoom();switch(e){case"latitude":n.lat=t;break;case"longitude":n.lng=t;break;case"zoom":o=t;break;default:return}a.setView(n,o)}catch(e){this._reportError(e)}},_resetAsync:function(t){var n=this;return a(regeneratorRuntime.mark((function a(){var o,i,r,s,l,c,u;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n._view){a.next=2;break}return a.abrupt("return");case 2:if(n.disableSignals(),a.prev=3,o=n._map,i=n._view,r=o.containerPointToLayerPoint([0,0]),e.DomUtil.setPosition(n._vegaContainer,r),s=o.getSize(),l=o.getCenter(),c=o.getZoom(),!((u=function(e,t){return i.signal(e)!==t?(i.signal(e,t),1):0})("width",s.x)+u("height",s.y)+u("latitude",l.lat)+u("longitude",l.lng)+u("zoom",c)>0||t)){a.next=16;break}return a.next=16,i.runAsync();case 16:a.next=21;break;case 18:a.prev=18,a.t0=a.catch(3),n._reportError(a.t0);case 21:return a.prev=21,n.enableSignals(),a.finish(21);case 24:case"end":return a.stop()}}),a,n,[[3,18,21,24]])})))()},defaultProjection:{name:"projection",type:"mercator",scale:{signal:"256*pow(2,zoom)/2/PI"},rotate:[{signal:"-longitude"},0,0],center:[0,{signal:"latitude"}],translate:[{signal:"width/2"},{signal:"height/2"}],fit:!1}}),e.VegaLayer.version="0.9.0"}(a("6e841ed3e83e93f20bf1"))},"883108e75945407806e4":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("macarons",{color:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],backgroundColor:"rgba(0,0,0,0)",textStyle:{},title:{textStyle:{color:"#008acd"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:3,symbol:"emptyCircle",smooth:!0},radar:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:3,symbol:"emptyCircle",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#d87a80",color0:"#2ec7c9",borderColor:"#d87a80",borderColor0:"#2ec7c9",borderWidth:1}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:3,symbol:"emptyCircle",smooth:!0,color:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#dddddd",borderColor:"#eeeeee",borderWidth:.5},label:{color:"#d87a80"},emphasis:{itemStyle:{areaColor:"rgba(254,153,78,1)",borderColor:"#444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},geo:{itemStyle:{areaColor:"#dddddd",borderColor:"#eeeeee",borderWidth:.5},label:{color:"#d87a80"},emphasis:{itemStyle:{areaColor:"rgba(254,153,78,1)",borderColor:"#444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!1,lineStyle:{color:["#eee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#eee"]}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#eee"]}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#008acd"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#eee"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{borderColor:"#2ec7c9"},emphasis:{iconStyle:{borderColor:"#18a4a6"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#008acd",width:"1"},crossStyle:{color:"#008acd",width:"1"}}},timeline:{lineStyle:{color:"#008acd",width:1},itemStyle:{color:"#008acd",borderWidth:1},controlStyle:{color:"#008acd",borderColor:"#008acd",borderWidth:.5},checkpointStyle:{color:"#2ec7c9",borderColor:"#2ec7c9"},label:{color:"#008acd"},emphasis:{itemStyle:{color:"#a9334c"},controlStyle:{color:"#008acd",borderColor:"#008acd",borderWidth:.5},label:{color:"#008acd"}}},visualMap:{color:["#5ab1ef","#e0ffff"]},dataZoom:{backgroundColor:"rgba(47,69,84,0)",dataBackgroundColor:"#efefff",fillerColor:"rgba(182,162,222,0.2)",handleColor:"#008acd",handleSize:"100%",textStyle:{color:"#333333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"8b8d4cc31634fce1d9c5":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("6fe5e339b0f8a936ba8c"),r=a("1bf2fbdb051fe0c57024"),s=a("8deafab7866a125bb9ca");n.shape.fishbone.cell.Projectnode_api=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Projectnode_api",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Projectnode_api</strong>}<br/><br/><strong>Project </strong><cite>Node </cite>is first component in any report and bind it with particular report.<br/><br/><strong>Configuration: </strong><br/><br/><strong>Project*: </strong> <cite>specify EPMS project you want report to be build for. Select from dropdown list. Projects listed according to current user rights in the system. <br/>One report can content many <strong>Project </strong>nodes, so you can compile more complicated reports containing information from multiple projects.</cite>",init:function(e,t,a,n){this._super(o.extend({val_str:"♻",color:"#02d58b"},e),t,a,n);var l=this;o.extend(this.userData,{project:{proj_id:"offline",proj_name:"Project",proj_code:"offline"},value:0,index:0}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{offline:{type:"boolean",title:"Offline Mode",default:!0},auto_detect:{type:"boolean",title:"Auto Detect Mode",default:!0},project:{type:"object",title:"Project",format:"projectcode",properties:{proj_id:{type:"string",default:""},proj_name:{type:"string",default:""},proj_code:{type:"string",default:""}},required:["proj_id","proj_name","proj_code"]}},required:["project"]}),setTimeout((function(){l.val_label.click((function(){l.initDownUpdate()}))}),100),this.initDownUpdate=function(){var e=this;DEBUG&&console.log("Project_api node: "+this.id+" init DownUpdate."),this.getProject((function(){var t=e.getUserData();e.getOutputPort(0).getConnections().each((function(e,a){l.getPort("output0").setUserData({project:{proj_id:t.project.proj_id,proj_name:t.project.proj_name,proj_code:t.project.proj_code}});var n=a.getTarget();n.setValue("ticket,"+l.id+","+l.userData.label),a.setColor("#dfdfdf"),n.setValue(l.getId()),a.setColor(l.frame.attr("stroke"))})),e.updateUI()}))},this.createPort("output"),this.updateSearchCol=function(){var e,t,a="526129009928470528",s=(e=i.context+"/apidata/getAPIData?apiid="+a+"&user_id="+window.user_id,t=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.prototype.searchValueTemplate='<input placeholder="Search" /><div class="treema-search-results"></div>',DatabaseSearchTreemaNode.prototype.buildValueForEditing=function(e,t){var a;if(e.html(this.searchValueTemplate),(a=e.find("input")).focus().keyup(this.search),t)return a.attr("placeholder",this.formatDocument(t))},DatabaseSearchTreemaNode.extend(t),t.prototype.url=e,t.prototype.formatDocument=function(e){return e.proj_name+" "+e.proj_code},t.prototype.search=function(){var e;if((e=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!e&&this.getSearchResultsEl().empty(),e)){this.lastTerm=e,this.getSearchResultsEl().empty().append("Searching");var t=this.searchCallback,s={user_id:n.username};o.ajax({url:i.context+"/apidata/getAPIData?apiid="+a+"&user_id="+window.user_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(s),success:function(a){var n=a.data?a.data:a,o=(new r).from(n).where((function(t,a){return-1!==t.proj_name.toLowerCase().indexOf(e.toLowerCase())||-1!==t.proj_code.toLowerCase().indexOf(e.toLowerCase())})).select();t(o)}})}},t.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data.proj_id=e.data("value").proj_id,this.data.proj_name=e.data("value").proj_name,this.data.proj_code=e.data("value").proj_code,l.updateUI(),l.getPort("output0").setUserData({project:{proj_id:this.data.proj_id,proj_name:this.data.proj_name,proj_code:this.data.proj_code}}))},t.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==(i.proj_name+i.proj_code).toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},t);TreemaNode.setNodeSubclass("projectcode",s)},this.getProject=function(e){if(this.userData.auto_detect&&n.proj_detect){var t={user_id:n.username,proj_id:n.proj_detect};o.ajax({url:i.context+"/apidata/getAPIData?apiid=526129009928470528&user_id="+window.user_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(t),success:function(t){var a=t.data?t.data:t;a[0]?(l.userData.project.proj_id=a[0].proj_id,l.userData.project.proj_name=a[0].proj_name,l.userData.project.proj_code=a[0].proj_code,l.updateUI(),e()):s.bsToast.question({layout:1,drag:!1,timeout:!1,close:!0,overlay:!0,toast_type:"error",displayMode:1,maxWidth:450,title:"User rights issues",message:"Seems you have no rights for this project or your user ID was not added to iEPMS project. At the moment it is required to add your user ID into project directly in iEPMs not only UPP system. This report execution will be stopped.",position:"center"})}}),this.userData.auto_detect=!1}else e()},void 0!==n.username&&l.updateSearchCol()},updateUI:function(){var e=this.getUserData();this.top_label.setText(e.project.proj_name||"Project"),this.filter_label.setText(e.project.proj_code||"Project offline"),this.val_label.setText("♻"),this._super(this)}})},"8b8eccd40d1bc3f8dd2b":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}n.shape.fishbone.ra.SetFigureFB=n.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.SetFigureFB",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.SetFigureFB</strong>}<br/><br/>",init:function(e,t,a){var n=this;this._super(o.extend({stroke:0,bgColor:null,width:300,height:300},e),t,a);var r=this;this.userData={hidden:!1,showInConnections:!0},this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:500},height:{type:"integer",default:300}}},showInConnections:{type:"boolean",title:"Show Connections",default:!0}}},this.setNewData=function(e){r.svgNodes.remove(),r.svgNodes=e,r.applyTransformation(),r.repaint()},this.on("resize",(function(e){r.userData.size={width:e.width,height:e.height},n.updateTable()})),this.startAnimation=function(e){if(!r.getCanvas().silentMode){this.canvas.paper.setStart();var t=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading...");t.attr({fill:"#777",stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),function(e,t){var a,n,o,r=Raphael.animation((a={opacity:0},o=1,(n=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(n="opacity"))in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o,a),1e3);e.animate(r.repeat(t))}(t,e);var a=this.canvas.paper.setFinish();this.setNewData(a)}}},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},createSet:function(){this.canvas.paper.setStart();var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data...");return e.attr({fill:"#777",stroke:"none",opacity:.5,"font-size":28,"font-weight":"bold"}),this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight()).attr({stroke:"#888","stroke-dasharray":"-"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},applyAlpha:function(){}})},"8bc1645a15a8aceb9e2a":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("halloween",{color:["#ff715e","#ffaf51","#ffee51","#8c6ac4","#715c87"],backgroundColor:"rgba(64,64,64,0.5)",textStyle:{},title:{textStyle:{color:"#ffaf51"},subtextStyle:{color:"#eeeeee"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"8",symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z",smooth:!1},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"3"},symbolSize:"8",symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z",smooth:!1},bar:{itemStyle:{barBorderWidth:"0",barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:"0",borderColor:"#ccc"},symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z"},scatter:{itemStyle:{borderWidth:"0",borderColor:"#ccc"},symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z"},boxplot:{itemStyle:{borderWidth:"0",borderColor:"#ccc"},symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z"},parallel:{itemStyle:{borderWidth:"0",borderColor:"#ccc"},symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z"},sankey:{itemStyle:{borderWidth:"0",borderColor:"#ccc"},symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z"},funnel:{itemStyle:{borderWidth:"0",borderColor:"#ccc"},symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z"},gauge:{itemStyle:{borderWidth:"0",borderColor:"#ccc"},symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z"},candlestick:{itemStyle:{color:"#ffee51",color0:"#ffffff",borderColor:"#ff715e",borderColor0:"#797fba",borderWidth:"1"}},graph:{itemStyle:{borderWidth:"0",borderColor:"#ccc"},lineStyle:{width:"1",color:"#888888"},symbolSize:"8",symbol:"path://M237.062,81.761L237.062,81.761c-12.144-14.24-25.701-20.1-40.68-19.072 c-10.843,0.747-20.938,5.154-30.257,13.127c-9.51-5.843-19.8-9.227-30.859-10.366c0.521-3.197,1.46-6.306,2.85-9.363 c3.458-7.038,8.907-12.741,16.331-17.296c-5.609-3.384-11.227-6.799-16.854-10.279c-16.257,8.104-25.06,20.601-26.463,38.417 c-7.599,1.705-14.685,4.486-21.247,8.437c-9.164-7.677-18.996-11.917-29.496-12.632c-14.819-0.998-28.467,4.787-40.938,18.827 C6.445,96.182,0,114.867,0,136.242c-0.007,6.371,0.674,12.646,2.053,18.738c4.593,22.785,15.398,41.367,32.558,55.344 c15.43,12.773,29.901,18.023,43.362,16.981c7.074-0.561,13.624-3.977,19.685-10.192c10.534,5.49,20.391,8.217,29.561,8.203 c9.856-0.012,20.236-2.953,31.125-8.898c6.227,6.692,12.966,10.346,20.211,10.933c13.795,1.073,28.614-4.111,44.377-16.84 c17.49-14.104,28.043-32.79,31.796-55.485c0.836-5.624,1.272-11.292,1.272-16.966C255.998,115.814,249.707,96.601,237.062,81.761z  M54.795,97.7l40.661,14.496c-4.402,8.811-10.766,13.219-19.06,13.219c-2.542,0-4.917-0.419-7.122-1.274 C58.103,118.38,53.263,109.572,54.795,97.7z M150.613,185.396l-9.156-8.389l-7.619,12.951c-3.391,0.341-6.615,0.514-9.665,0.514 c-4.401,0-8.635-0.263-12.708-0.777l-8.634-14.973l-9.151,9.909c-4.91-2.717-9.15-5.856-12.708-9.413 c-8.81-8.295-13.384-17.959-13.727-28.97c2.877,1.692,7.427,3.461,13.675,5.308l10.636,13.629l9.44-9.852 c4.734,0.702,9.234,1.12,13.466,1.275l10.689,11.498l9.671-11.949c3.559-0.173,7.285-0.515,11.182-1.01l9.924,10.159l10.933-14.227 c5.931-1.351,11.196-2.798,15.771-4.323C179.747,163.538,169.068,176.414,150.613,185.396z M175.258,124.907 c-2.209,0.849-4.66,1.273-7.369,1.273c-8.134,0-14.489-4.415-19.052-13.224l40.905-14.477 C191.105,110.331,186.273,119.141,175.258,124.907z",smooth:!1,color:["#ff715e","#ffaf51","#ffee51","#8c6ac4","#715c87"],label:{color:"#333333"}},map:{itemStyle:{areaColor:"#555555",borderColor:"#999999",borderWidth:.5},label:{color:"#ffffff"},emphasis:{itemStyle:{areaColor:"rgba(255,175,81,0.5)",borderColor:"#ffaf51",borderWidth:1},label:{color:"#ffee51"}}},geo:{itemStyle:{areaColor:"#555555",borderColor:"#999999",borderWidth:.5},label:{color:"#ffffff"},emphasis:{itemStyle:{areaColor:"rgba(255,175,81,0.5)",borderColor:"#ffaf51",borderWidth:1},label:{color:"#ffee51"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#666666"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#555555"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#666666"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#555555"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#666666"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#555555"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#666666"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#555555"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#ffaf51",width:1},itemStyle:{color:"#ffaf51",borderWidth:1},controlStyle:{color:"#ffaf51",borderColor:"#ffaf51",borderWidth:.5},checkpointStyle:{color:"#ff715e",borderColor:"#ff715e"},label:{color:"#ff715e"},emphasis:{itemStyle:{color:"#ffaf51"},controlStyle:{color:"#ffaf51",borderColor:"#ffaf51",borderWidth:.5},label:{color:"#ff715e"}}},visualMap:{color:["#ff715e","#ffee51","#797fba"]},dataZoom:{backgroundColor:"rgba(255,255,255,0)",dataBackgroundColor:"rgba(222,222,222,1)",fillerColor:"rgba(255,113,94,0.2)",handleColor:"#cccccc",handleSize:"100%",textStyle:{color:"#999999"}},markPoint:{label:{color:"#333333"},emphasis:{label:{color:"#333333"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"8c55d536dcccaac1d990":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("6fe5e339b0f8a936ba8c"),r=a("1bf2fbdb051fe0c57024");n.shape.fishbone.cell.Projectnode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Projectnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Projectnode</strong>}<br/><br/><strong>Project </strong><cite>Node </cite>is first component in any report and bind it with particular report.<br/><br/><strong>Configuration: </strong><br/><br/><strong>Project*: </strong> <cite>specify EPMS project you want report to be build for. Select from dropdown list. Projects listed according to current user rights in the system. <br/>One report can content many <strong>Project </strong>nodes, so you can compile more complicated reports containing information from multiple projects.</cite>",init:function(e,t,a,n){this._super(o.extend({val_str:"♻",color:"#2EB8A8"},e),t,a,n);var s=this;o.extend(this.userData,{hidden:!1,autoWidth:!1,project:{proj_id:"offline",proj_name:"Project",proj_code:"offline"},value:0,index:0}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{offline:{type:"boolean",title:"Offline Mode",default:!1},project:{type:"object",title:"Project",format:"projectcode",properties:{proj_id:{type:"string",default:""},proj_name:{type:"string",default:""},proj_code:{type:"string",default:""}},required:["proj_id","proj_name","proj_code"]}},required:["project"]}),setTimeout((function(){s.val_label.click((function(){s.initDownUpdate()}))}),100),this.initDownUpdate=function(){DEBUG&&console.log("Project node: "+this.id+" init DownUpdate.");var e=this.getUserData();this.getOutputPort(0).getConnections().each(o.proxy((function(t,a){s.getPort("output0").setUserData({project:{proj_id:e.project.proj_id,proj_name:e.project.proj_name,proj_code:e.project.proj_code}});var n=a.getTarget();n.setValue("ticket,"+s.id+","+s.userData.label),a.setColor("#dfdfdf"),n.setValue(this.getId()),a.setColor(s.frame.attr("stroke"))}),this)),this.updateUI()},this.createPort("output"),this.updateSearchCol=function(){var e,t,a=(e=i.context+"/data/getAllProjects?user="+s.username,t=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.prototype.searchValueTemplate='<input placeholder="Search" /><div class="treema-search-results"></div>',DatabaseSearchTreemaNode.prototype.buildValueForEditing=function(e,t){var a;if(e.html(this.searchValueTemplate),(a=e.find("input")).focus().keyup(this.search),t)return a.attr("placeholder",this.formatDocument(t))},DatabaseSearchTreemaNode.extend(t),t.prototype.url=e,t.prototype.formatDocument=function(e){return e.proj_name+" "+e.proj_code},t.prototype.search=function(){var e;if((e=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!e&&this.getSearchResultsEl().empty(),e)){this.lastTerm=e,this.getSearchResultsEl().empty().append("Searching");var t=this.searchCallback;o.ajax({url:i.context+"/data/getAllProjects?user="+s.username,datatype:"json",type:"GET",success:function(a){var n=(new r).from(a).where((function(t,a){return-1!==t.proj_name.toLowerCase().indexOf(e.toLowerCase())||-1!==t.proj_code.toLowerCase().indexOf(e.toLowerCase())})).select();t(n)}})}},t.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data.proj_id=e.data("value").proj_id,this.data.proj_name=e.data("value").proj_name,this.data.proj_code=e.data("value").proj_code,s.updateUI(),s.getPort("output0").setUserData({project:{proj_id:this.data.proj_id,proj_name:this.data.proj_name,proj_code:this.data.proj_code}}))},t.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==(i.proj_name+i.proj_code).toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},t);TreemaNode.setNodeSubclass("projectcode",a)},void 0!==this.username&&this.updateSearchCol()},updateUI:function(){var e=this.getUserData();this.top_label.setText(e.project.proj_name),this.filter_label.setText(e.project.proj_code),this.val_label.setText("♻"),this._super(this)},getPersistentAttributes:function(){var e=this._super();return e.username=this.username,e},setPersistentAttributes:function(e){this._super(e),this.username=e.username}})},"8c59153af2412b70442c":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca"),r=a("aeb57e88bcb04c329061"),s=a("6fe5e339b0f8a936ba8c"),l=a("1bf2fbdb051fe0c57024");n.shape.fishbone.cell.Scopenode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Scopenode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Scopenode</strong>}<br/><br/><strong>Scope </strong><cite>Node </cite>represents relation to particular scope (Site Model), according to available scope list in the project.<br/><br/><strong>Configuration: </strong><br/><br/><strong>Scope*: </strong> <cite>specify project scope (Site Model) you want report to be build for. Select from dropdown list. <br/><i class='fas fa-exclamation-circle'></i>This node should be connected to one of the <strong>Project </strong>nodes available on canvas.</cite>",init:function(e,t,a,c){this._super(o.extend({color:"#E4AE5B",items:{filter:{name:"Filter",icon:"fas fa-filter",callback:function(){c.editor.selectScopeValues(u)}},reset_filter:{name:"Reset Filter",icon:"fas fa-redo",callback:function(){u.userData.conditions=[{logic:"",openQu:"",prop:"",sign:"consist",value:"empty",values:[],closeQu:""}],i.initFallDown(u),u.GetHTTPData(),u.updateUI()}},sep:"---------"}},e),t,a,c);var u=this;this.project={proj_id:"",proj_name:"",proj_code:""},this.sites_list_out=[],o.extend(this.userData,{hidden:!1,autoWidth:!1,scope:{scope_id:"",scope_name:"Scope"},conditions:[{logic:"",openQu:"",prop:"",sign:"consist",value:"empty",values:[],closeQu:""}],value:0,showInConnections:!0,showOutConnections:!0,sites_list_out:[],index:0}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{scope:{type:"object",title:"Scope",format:"scopecode",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},openQu:{type:"string",title:"",default:""},prop:{type:"string",default:"",enum:r.site_table_columns},sign:{type:"string",default:"consist",enum:["equal","not equal","consist","not consist","in","more than","less than","more than or equal","less than or equal"]},value:{type:"string",title:"Value (Like)",default:"empty"},values:{type:"array",title:"Values (In)",items:{type:"string",title:"Value",default:""}},closeQu:{type:"string",title:"",default:""}},required:["logic","prop","sign","value"]}}},required:["scope"]}),this.clearUI=function(){this.val_label.setText("0"),this.filter_label.setText("Scope")},this.GetHTTPData=function(){var e=this.getUserData();if(null!=e.scope.scope_id&&""!=e.scope.scope_id){u.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500));var t=s.context+"/data/getAllScopeSites?&proj_id="+this.project.proj_id+"&scope_id="+e.scope.scope_id+"&scope_name="+e.scope.scope_name,a=JSON.stringify(e.conditions);this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=o.ajax({url:t,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:a,success:function(t){t.length>-1&&(u.val_label.setText(t.length.toString()),u.userData.value=t.length,u.userData.sites_list_out=t,u.getPort("output0").setUserData({project:u.project,scope:e.scope,item_name:"scope",sites_list_out:t}),u.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(u.getId()),t.setColor(u.frame.attr("stroke"))}),this))),u.stopTimer(),u.updateUI()},error:function(e,t,a){console.log(t+" "+a)}})}},this.createPort("input").setMaxFanOut(1),this.createPort("output"),this.getPort("input0").on("connect",(function(e,t){t.connection.setTargetDecorator(new n.decoration.connection.DataArrowDecorator),u.updateScopeSearchCol(t.connection.sourcePort.getUserData().project,u)})),this.updateScopeSearchCol=function(e,t){var a,n;this.clearUI,ScopeCodeSearchTreemaNode=(a=s.context+"/data/getAllScopes?proj_id="+e.proj_id,n=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.extend(n),n.prototype.url=a,n.prototype.formatDocument=function(e){return e.scope_name},n.prototype.search=function(){var t;if((t=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!t&&this.getSearchResultsEl().empty(),t)){this.lastTerm=t,this.getSearchResultsEl().empty().append("Searching");var a=this.searchCallback;o.ajax({url:s.context+"/data/getAllScopes?proj_id="+e.proj_id,datatype:"json",type:"GET",success:function(e){var n=(new l).from(e).where((function(e,a){return-1!==e.scope_name.toLowerCase().indexOf(t.toLowerCase())})).select();a(n)}})}},n.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data.scope_id=e.data("value").scope_id,this.data.scope_name=e.data("value").scope_name,t.GetHTTPData(),t.updateUI())},n.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.scope_name.toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},n),TreemaNode.setNodeSubclass("scopecode",ScopeCodeSearchTreemaNode),this.project=e,this.GetHTTPData(),this.updateUI()},this.getRealCount=function(){return 1}},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.top_label.setText(this.project.proj_name),this.filter_label.setText(e.scope.scope_name),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(o.proxy((function(e,a){var n=a.getTarget();n.userData||(n.userData={}),n.userData.realCount=t.getRealCount(),n.setValue("ticket"),t.getCanvas().silentMode||a.setColor("#dfdfdf")}),this))}));else if("input0"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.updateScopeSearchCol(a.getUserData().project,this)}},onTimer:function(){"."!==this.val_label.getText()&&".."!=this.val_label.getText()&&"..."!=this.val_label.getText()&&this.val_label.setText("."),"."===this.val_label.getText()?this.val_label.setText(".."):".."===this.val_label.getText()?this.val_label.setText("..."):"..."===this.val_label.getText()&&this.val_label.setText(".")}})},"8deafab7866a125bb9ca":(e,t,a)=>{"use strict";a.r(t),a.d(t,{GetCustomAgg:()=>Je,GetTodayPosition:()=>Le,HSLToRGB:()=>at,IsJsonString:()=>Ue,applyBinMode:()=>Ae,applyParams:()=>$e,applyTextMode:()=>Te,bsToast:()=>Ot,checkDisconn:()=>De,checkDuplicateInObject:()=>qe,checkNested:()=>ie,daysInMonth:()=>V,deg2rad:()=>Ge,delay:()=>J,drawProgress:()=>He,export2DArrayToExcel2:()=>Be,exportArrayToExcel:()=>Fe,generateUUID:()=>Oe,get3Color:()=>be,get3ColorString:()=>ve,getAllDays:()=>le,getAllMonths:()=>te,getAllWeeks:()=>re,getAllWeeks_old:()=>se,getArrayDescr:()=>Z,getCellBg:()=>he,getCircletoPath:()=>K,getColor:()=>fe,getColorAndOpacity:()=>it,getColorDarker:()=>me,getColorDarkerMono:()=>ge,getColorHTML:()=>_e,getColorLighter:()=>ye,getComaList:()=>Se,getDistanceFromLatLonInKm:()=>We,getFontAttr:()=>Qe,getFormatData:()=>pe,getFormula:()=>Pe,getHorPosition:()=>ne,getInputPortByID:()=>Ye,getList:()=>Ce,getMessage:()=>Y,getOutputPortByID:()=>Xe,getParams:()=>tt,getScopeParams:()=>Ze,getShapeSVG:()=>G,getShirtTaskType:()=>Ke,getSortOrder:()=>de,getTaskData:()=>Ne,getTasksData:()=>Me,getTicketOwner:()=>Q,getTotalValue:()=>xe,getVerPosition:()=>oe,getms:()=>st,getsignature:()=>ct,gradientString:()=>X,handleFormDataStream:()=>Dt,handleJsonPostStream:()=>St,handlePostStream:()=>kt,handleRegularResponse:()=>Nt,handleUrlEncodedStream:()=>Ct,hslToRgb:()=>we,initFallDown:()=>ke,injectStyles:()=>wt,isInMalaysia:()=>Et,letter:()=>lt,makeTaskSearchSSOPTreemaNodeClass:()=>dt,makeTaskSearchTreemaNodeClass:()=>ut,median:()=>nt,mobilecheck:()=>ot,moveArrayItem:()=>W,objectArrayIndexOf:()=>Ve,preparePrompt:()=>et,removeCodeBlocks:()=>At,removeData:()=>rt,removeFencing:()=>It,removeInjectedStyles:()=>xt,runAnim:()=>ae,safeEval:()=>vt,sendTaskData:()=>Ie,setConditions:()=>je,updateLookupKeyCol:()=>gt,updateLookupResultCol:()=>_t,updateLookupSourceCol:()=>mt,updateLookupValueCol:()=>yt,updateParamDetailsCol:()=>ht,updateParamSourceCol:()=>pt,updatePort:()=>Ee,updatePropKeyCol:()=>ft,updateSet:()=>ze,updateTable:()=>Re,updateUI:()=>Tt,wrapText:()=>ce,wrapTextChar:()=>ue,zeroPad:()=>ee,zeroPadl:()=>$});var n=a("d03d36be50c40888c6b4"),o=a("da010f21fea25912dd9e"),i=a.n(o),r=a("3473246f9665a5e8f7af"),s=a("42c38932b0e51c63bc07"),l=(a("10acc4c18fdcb8895e1d"),a("8f26381ed0ec1cda1725")),c=a("b0f8c3c2a80ca18eceb0"),u=a("322e90626982c4310329");function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function f(e,t,a){return(t=function(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=d(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function m(){var e=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({maxTimers:10,maxDelay:1e4,maxCallbacks:100,executeImmediately:!1},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),t={activeTimers:0,totalCallbacksExecuted:0,timers:new Map,nextTimerId:1,isDestroyed:!1};return{setTimeout:function(a,n){for(var o=arguments.length,i=new Array(o>2?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];if("function"!=typeof a)throw new Error("Callback must be a function");if(t.isDestroyed)throw new Error("Timer has been destroyed");if(t.activeTimers>=e.maxTimers)throw new Error("Maximum number of concurrent timers (".concat(e.maxTimers,") exceeded"));if(t.totalCallbacksExecuted>=e.maxCallbacks)throw new Error("Maximum number of total callbacks (".concat(e.maxCallbacks,") exceeded"));var s=Math.min(Math.max(0,parseInt(n)||0),e.maxDelay),l=t.nextTimerId++,c=function(){if(!t.isDestroyed&&t.timers.has(l))try{a.apply(void 0,i)}catch(e){console.error("Error in timer callback:",e)}finally{t.timers.delete(l),t.activeTimers--,t.totalCallbacksExecuted++}};if(t.activeTimers++,e.executeImmediately)c();else{var u=setTimeout(c,s);t.timers.set(l,u)}return l},clearTimeout:function(e){if(!t.timers.has(e))return!1;var a=t.timers.get(e);return clearTimeout(a),t.timers.delete(e),t.activeTimers--,!0},getStats:function(){return{activeTimers:t.activeTimers,totalCallbacksExecuted:t.totalCallbacksExecuted,maxTimers:e.maxTimers,maxCallbacks:e.maxCallbacks,maxDelay:e.maxDelay}},destroy:function(){var e,a=function(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return p(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?p(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw i}}}}(t.timers.values());try{for(a.s();!(e=a.n()).done;){var n=e.value;clearTimeout(n)}}catch(e){a.e(e)}finally{a.f()}t.timers.clear(),t.activeTimers=0,t.isDestroyed=!0}}}a("867a564510a7814c3710");var g=a("46a843cf52359732b90b"),y=a("9c772359e08e81b5b3ba"),_=a.n(y),b=a("5d9edb72adf531f9bd0e"),v=(a("7c9c5bc414d1d0ac9570"),a("ef13ca7652af72d4f729")),w={},x=null;function k(e,t,a){if(!x)return console.warn("[initFilter] No Math Node figure reference available"),t;x.userData.filters||(x.userData.filters={});var n=x.userData.filters[e]||w[e];return n?(console.log("[initFilter] Using existing filter config:",{filterId:e,existing_filter_list:n.filter_list,existing_filter_list_length:n.filter_list?n.filter_list.length:0}),n._originalData=t):(console.log("[initFilter] Creating new filter config for:",e),n={field:a.field,value:a.value||"All",filter_list:a.filter_list||[],showBusket:a.showBusket||!1,win_size:a.win_size||"lg",searchInResult:a.searchInResult||!1,use_elip:!1,select_one:a.select_one||!1,only_data_options:!1!==a.only_data_options,use_sum:!1,message:a.message||"Please select required items",_originalData:t}),x.userData.filters[e]=n,w[e]=n,function(e,t){var a=document.getElementById(e);if(a){if(!a.hasChildNodes()){var n=t.value;if(t.filter_list&&t.filter_list.length>0)try{n=t.use_elip?t.filter_list.map((function(e){var a=e&&(e.value||e[t.field]||String(e));return a&&"string"==typeof a?a.substring(0,10)+(a.length>10?"...":""):(console.warn("[createFilterButton] Invalid value for item:",e),"")})).filter((function(e){return e})).join(", "):t.filter_list.map((function(e){var a=e&&(e.value||e[t.field]||String(e));return a&&"string"==typeof a?a:(console.warn("[createFilterButton] Invalid value for item:",e),"")})).filter((function(e){return e})).join(", ")}catch(e){console.error("[createFilterButton] Error processing filter_list:",e,t.filter_list),n="Error"}var o="".concat(e,"_btn"),i='\n            <label class="input-group-text" for="'.concat(e,'">').concat(t.field,'</label>\n            <input name="').concat(e,'" disabled type="text" class="form-control" value="').concat(n,'">\n            <button id="').concat(o,'" class="btn btn-outline-secondary" type="button" onclick="openMathNodeFilter(\'').concat(e,"')\">Set</button>\n        ");a.innerHTML=i,a.className="input-group input-group-sm mb-1";var r=document.getElementById(o);r&&x&&(r._mathNodeFigure=x,console.log("[createFilterButton] Stored figure reference on button ".concat(o)))}}else console.warn("[initFilter] Container with id '".concat(e,"' not found. Filter UI cannot be attached."))}(e,n),function(e,t){if(console.log("[applyJavaScriptFilter] Called with:",{dataLength:e?e.length:0,filterConfig:t,filter_list:t?t.filter_list:"undefined",filter_list_length:t&&t.filter_list?t.filter_list.length:"undefined"}),!t.filter_list||0===t.filter_list.length)return console.log("[applyJavaScriptFilter] No filtering applied - returning original data"),e;var a=t.field,n=new Set(t.filter_list.map((function(e){return e.value||e[a]||String(e)})));return e.filter((function(e){var t=e[a];return!(!n.has("blank")||t&&""!==t)||!(!n.has("not blank")||!t||""===t)||!!(n.has("today")&&t&&t.includes(i()().format("YYYY-MM-DD")))||!!(n.has("yesterday")&&t&&t.includes(i()().subtract(1,"d").format("YYYY-MM-DD")))||n.has(t)}))}(t,n)}"undefined"!=typeof window&&(window.openMathNodeFilter=function(e){var t="".concat(e,"_btn"),a=document.getElementById(t),n=a?a._mathNodeFigure:null;if(n?console.log("[openMathNodeFilter] Using button-stored figure reference for ".concat(e)):(n=window.currentMathNodeFigure,console.warn("[openMathNodeFilter] Using fallback global figure reference for ".concat(e))),n){var o=n.userData.filters[e];if(o){var i=function(e,t){console.log("[createVirtualFilterFigure] Input filter config:",{filterId:e,field:t.field,filter_list:t.filter_list,filter_list_detailed:JSON.stringify(t.filter_list,null,2)});var a=[];return t.filter_list&&t.filter_list.length>0&&(a=t.filter_list.map((function(e){var a=e.value||e[t.field]||String(e),n={value:a};return n[t.field]=a,n}))),console.log("[createVirtualFilterFigure] Converted filter_list:",{original:t.filter_list,converted:a}),{userData:{filter:{field:t.field,value:t.value,filter_list:a,searchInResult:t.searchInResult,use_elip:t.use_elip,select_one:t.select_one,only_data_options:t.only_data_options,use_sum:t.use_sum,params:[]},message:t.message,showBusket:t.showBusket,win_size:t.win_size,row:[{sites_list_out:t._originalData}],sites_list_out:t._originalData}}}(e,o);console.log("[openMathNodeFilter] Created virtual figure:",{filterId:e,field:i.userData.filter.field,dataLength:i.userData.row[0].sites_list_out.length,showBusket:i.userData.showBusket});try{var r=angular.element(document.body).injector().get("$uibModal");console.log("[openMathNodeFilter] Opening modal with config:",{templateUrl:"views/common/ValueSelectorController.html",controller:"FilterController",size:o.win_size}),r.open({templateUrl:"views/common/ValueSelectorController.html",controller:"FilterController",size:o.win_size,resolve:{figure:function(){return i}}}).result.then((function(t){console.log("[openMathNodeFilter] Modal resolved with selections:",t),o.filter_list=t||[],o.value=t&&t.length>0?"Filtered":"All",console.log("[openMathNodeFilter] Updated filter config:",{filterId:e,filter_list:o.filter_list,filter_list_length:o.filter_list.length,value:o.value,selections:t}),w[e]=o,function(e,t){console.log("[updateFilterButtonDisplay] Called with:",{filterId:e,filterConfig:t,filter_list:t?t.filter_list:"undefined"});var a=document.getElementById(e);if(a){var n=a.querySelector('input[type="text"]');if(n){var o=t.value||"All";if(t.filter_list&&t.filter_list.length>0)try{o=t.use_elip?t.filter_list.map((function(e){var a=e&&(e.value||e[t.field]||String(e));return a&&"string"==typeof a?a.substring(0,10)+(a.length>10?"...":""):(console.warn("[updateFilterButtonDisplay] Invalid value for item:",e),"")})).filter((function(e){return e})).join(", "):t.filter_list.map((function(e){var a=e&&(e.value||e[t.field]||String(e));return a&&"string"==typeof a?a:(console.warn("[updateFilterButtonDisplay] Invalid value for item:",e),"")})).filter((function(e){return e})).join(", ")}catch(e){console.error("[updateFilterButtonDisplay] Error processing filter_list:",e,t.filter_list),o="Error"}console.log("[updateFilterButtonDisplay] Setting display value:",o),n.value=o}else console.warn("[updateFilterButtonDisplay] Input not found in container:",e)}else console.warn("[updateFilterButtonDisplay] Container not found:",e)}(e,o),console.log("[openMathNodeFilter] Triggering Math Node re-execution"),n.updateTable()})).catch((function(e){console.log("[openMathNodeFilter] Filter modal was cancelled/dismissed:",e)}))}catch(e){console.error("[openMathNodeFilter] Error opening filter modal:",e)}}else console.error("[openMathNodeFilter] No filter configuration found for '".concat(e,"'"))}else console.error("[openMathNodeFilter] No Math Node figure reference available")});var D=a("a45670b3d8fb79ec0258"),S=a("8deafab7866a125bb9ca"),C=a("1bf2fbdb051fe0c57024"),T=a("a45670b3d8fb79ec0258"),A=a("8a868d10b6533e768658"),P=a("6fe5e339b0f8a936ba8c"),E=a("aeb57e88bcb04c329061"),I=a("d1be49724a1f416e7f57");function N(e,t){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},N(e,t)}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(M=function(){return!!e})()}function O(e,t){if(e){if("string"==typeof e)return j(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function R(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return L(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(L(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,L(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,L(d,"constructor",c),L(c,"constructor",l),l.displayName="GeneratorFunction",L(c,o,"GeneratorFunction"),L(d),L(d,o,"Generator"),L(d,n,(function(){return this})),L(d,"toString",(function(){return"[object Generator]"})),(R=function(){return{w:i,m:p}})()}function L(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}L=function(e,t,a,n){function i(t,a){L(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},L(e,t,a,n)}function F(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?F(Object(a),!0).forEach((function(t){H(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function B(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function H(e,t,a){return(t=function(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=z(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var q=a("d3949897a1eac25025cc");function V(e,t){return 2===e?3&t||!(t%25)&&15&t?28:29:30+(e+(e>>3)&1)}function W(e,t,a){if(a>=e.length)for(var n=a-e.length;1+n--;)e.push(void 0);return e.splice(a,0,e.splice(t,1)[0]),e}function G(e,t,a){return'<svg width="150" height="50" xmlns="http://www.w3.org/2000/svg" ><rect id="Rectangle-1" rx="15" ry="15" stroke-width="2" stroke="#777" fill="none" width="150" height="50"></rect><text x="12" y="13" text-anchor="start" font-family="Tahoma, Geneva" font-size="16px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 16px; font-weight: bold; font-style: normal;" font-weight="bold" font-style="normal">'+e+'</text><text x="12" y="27" text-anchor="start" font-family="Tahoma, Geneva" font-size="12px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 12px; font-weight: bold; font-style: normal;" font-weight="bold" font-style="normal">'+t+'</text><text x="12" y="41" text-anchor="start" font-family="Tahoma, Geneva" font-size="8px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 8px; font-weight: bold; font-style: normal;" font-style="normal">'+a+"</text></svg>"}function J(e){return e=e||2e3,new Promise((function(t){setTimeout((function(){t()}),e)}))}function Q(e){return e.getValue()&&e.getValue().indexOf("ticket")>-1?e.getValue().split(",")[1]:null}function Y(e,t,a){var n,o,i;DEBUG&&(t.getValue()&&t.getValue().indexOf("ticket")>-1?(t.getValue()&&(n=t.getValue().split(",")),o=n[1]+"-"+n[2]):o=(n=[t.getParent().id,t.getParent().userData.label])[0]+"-"+n[1],i=e.updateTickets instanceof Array?e.updateTickets.length:e.updateTickets,console.log(e.NAME+" id:"+e.id+" "+e.userData.label+" t:"+i+" "+a+" "+o+", Super: "+t.superUpdate))}function X(e,t){var a,n="45-"+e[0],o=e.length;for(a=0;a<100/t;a+=1)n+="-"+e[a%o]+":"+a*t+"-"+e[(a+1)%o]+":"+a*t;return n}function K(e,t,a){var n="M";return n+""+e+","+(t-a)+"A"+a+","+a+",0,1,1,"+(e-.1)+","+(t-a)+"z"}function Z(e){var t="["+e.length+"]";return e[0].length&&(t=t+"["+e[0].length+"]",e[0][0].length&&(t=t+"["+e[0][0].length+"]")),t}function $(e){return("0"+e).substr(-2,2)}function ee(e,t){var a=Math.abs(e),n=Math.max(0,t-Math.floor(a).toString().length),o=Math.pow(10,n).toString().substr(1);return e<0&&(o="-"+o),o+a}function te(e,t,a){var n=[],o=0,i=e.getFullYear(),r=e.getMonth()+1,s=0;for(n.push({my_month:i+"-"+this.zeroPad(r,2),col_name:a,my_count:0});n[n.length-1].my_month!==t.getFullYear()+"-"+this.zeroPad(t.getMonth()+1,2);)13===++r&&(r=0,o=1,s++),n.push({my_month:parseInt(i)+parseInt(s)+"-"+this.zeroPad(o+r,2),col_name:a,my_count:0});return n}function ae(e,t,a,n,o){var i=Raphael.animation(H({opacity:n.line},"opacity",o.line),300),r=Raphael.animation(H({opacity:n.lbl_back},"opacity",o.lbl_back),300),s=Raphael.animation(H({opacity:n.line_dots},"opacity",o.line_dots),300);e.animate(i.delay(50)),a.animate(r.delay(50)),t.animate(s.delay(50))}function ne(e,t){var a;switch(e){case"left":a=D.extend(!0,t,{"text-anchor":"start"});break;case"center":a=D.extend(!0,t,{"text-anchor":"middle"});break;case"right":a=D.extend(!0,t,{"text-anchor":"end"})}return a}function oe(e,t,a,n){var o;switch(e){case"top":o=-n["font-size"];break;case"center":o=0;break;case"bottom":case"insideTop":o=n["font-size"];break;case"inside":o=a/2;break;case"insideBottom":o=a-n["font-size"]}return o}function ie(e){for(var t=Array.prototype.slice.call(arguments,1),a=0;a<t.length;a++){if(!e||!e.hasOwnProperty(t[a]))return!1;e=e[t[a]]}return!0}function re(e,t,a){for(var n=[],o=[],i=new Date(e.valueOf());i<=t;){var r=i.ISO8601_y_week_no();-1===n.indexOf(r)&&n.push(r),i.setDate(i.getDate()+1)}return n.forEach((function(e,t){o.push({my_week:e,col_name:a,my_count:0})})),o}function se(e,t,a){var n=[],o=0,i=e.getFullYear();e>=Date.parse("Jan 01 "+i+" 00:00:00 GMT+0800 (+08)")&&e<=Date.parse("Jan 03 "+i+" 00:00:00 GMT+0800 (+08)")&&(e=new Date("Jan 04 "+i+" 00:00:00 GMT+0800 (+08)"));var r=e.getWeek(),s=0;n.push({my_week:i+"-"+this.zeroPad(r,2),col_name:a,my_count:0});for(var l=t.getFullYear()+"-"+this.zeroPad(t.getWeek(),2);n[n.length-1].my_week!==l;)53===++r?(n.push({my_week:parseInt(i)+parseInt(s)+"-"+this.zeroPad(o+r,2),col_name:a,my_count:0}),r=0,o=1,s++):n.push({my_week:parseInt(i)+parseInt(s)+"-"+this.zeroPad(o+r,2),col_name:a,my_count:0});return n}function le(e,t,a){for(var n=[],o=[],i=new Date(e);i<t;)o.push(new Date(i)),i.setDate(i.getDate()+1);return o.forEach((function(e,t){var o=e.getFullYear();n.push({my_day:o.toString().substring(2,4)+"-"+$(e.getMonth()+1)+"-"+$(e.getDate()),col_name:a,my_count:0})})),n}function ce(e,t,a){for(var n=e.split(" "),o="",i=0;i<n.length;i++)t.attr("text",o+" "+n[i]),t.getBBox().width>a?o+="\n"+n[i]:o+=0===i?n[i]:" "+n[i];return o}function ue(e,t){var a="";if("string"==typeof e){for(var n=e.split(" "),o="",i=0;i<n.length;i++)(o+" "+n[i]).length>t?(a+=o+="\n",o=n[i]):o+=0===i?n[i]:" "+n[i];a+=o}return a}function de(e){if(e.col.length>0){var t=[];return e.col.forEach((function(e,a){t.push(e.item_name)})),function(e){if("task_name"==e)return(0,n.lq)(t)}}return function(){}}function pe(e,t){return"none"===e?t:isNaN(t)||"0"!==e?isNaN(t)||"0.0"!==e?isNaN(t)||"0.00"!==e?isNaN(t)||"0.000"!==e?!isNaN(t)&&e.indexOf("0%")>-1?Math.round(parseInt(t))+"%":!isNaN(t)&&e.indexOf("0.00%")>-1?Math.round(parseInt(100*t))/100+"%":"3St"===e?t:void 0:Math.round(parseInt(1e3*t))/1e3:Math.round(parseInt(100*t))/100:Math.round(parseInt(10*t))/10:Math.round(parseInt(t))}function he(e,t,a,n,o,i,r){if(!isNaN(r)&&("0%"===t||"0.00%"===t)){var s=o*(r/100);return e.rect(a,n,s,i).attr({"stroke-width":.1,fill:S.getColor(r/100)})}return isNaN(r)||"0%f"!==t&&"0.00%f"!==t?isNaN(r)||"0%f(3c)"!==t&&"0.00%f(3c)"!==t?"3St"===t||"2St"===t?(s=o,e.rect(a,n,s,i).attr({"stroke-width":.1,fill:this.get3ColorString(r)})):null:(s=o,e.rect(a,n,s,i).attr({"stroke-width":.1,fill:this.get3Color(r)})):(s=o,e.rect(a,n,s,i).attr({"stroke-width":.1,fill:S.getColor(r/100)}))}function fe(e){return["hsl(",(120*e).toString(10)+"deg",",1,.5)"].join("")}function me(e){return["hsl(",(120*e).toString(10)+"deg",",1,.46)"].join("")}function ge(e){return["hsl(",(120*e).toString(10)+"deg",",1,.46)"].join("")}function ye(e){return["hsl(",(120*e).toString(10)+"deg",",1,1)"].join("")}function _e(e){return["hsl(",Math.abs(120-Math.round(120*e)).toString(10),",70%,80%)"].join("")}function be(e){return e<50?"#ffab35":e>=50&&e<80?"#fff435":e>=80?"#32dd2c":void 0}function ve(e){return"Openned"===e||"na"===e||"empty"===e||"not"===e||""===e?"#dd7a7e":"expired"===e||"bad"===e||"low"===e||"small"===e?"#ffa800":"attention"===e||"alarm"===e||"fine"===e||"average"===e||"medium"===e?"#fff435":"Closed"===e||"active"===e||"normal"===e||"good"===e||"high"===e||"big"===e?"#83dd77":void 0}function we(e,t,a){var n,o,i;if(0==t)n=o=i=a;else{var r=function(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e},s=a<.5?a*(1+t):a+t-a*t,l=2*a-s;n=r(l,s,e+1/3),o=r(l,s,e),i=r(l,s,e-1/3)}return[Math.round(255*n),Math.round(255*o),Math.round(255*i)]}function xe(e,t){return"count"===e?t.length:"sum"===e?t.reduce((function(e,t){return e+t})):"max"===e?Math.max.apply(null,t):"min"===e?Math.min.apply(null,t):"avg"===e?Math.round(100*t.reduce((function(e,t){return e+t}))/t.length)/100:void 0}function ke(e,t){e.getOutputPorts().data.forEach((function(a,n){a.getConnections().data.forEach((function(n,o){n.setColor("#dfdfdf");var i=n.getTarget();i.userData||(i.userData={}),"function"==typeof e.getRealCount&&(i.userData.realCount=e.getRealCount(a)),i.superUpdate=!!t,i.setValue("ticket,"+e.id+","+e.userData.label)}))}))}function De(e,t){var a=-1;e.userData.col.forEach((function(e,n){e.owner_id===t&&(a=n)})),a>-1&&e.userData.col.splice(a,1),"draw2d.shape.fishbone.ra.RaphaelChart"===e.NAME&&(e.uChart=null)}function Se(e,t){var a="";return e.forEach((function(e,n){null!==e[t]&&(a=a+"'"+e[t]+"',")})),a=a.substring(0,a.length-1)}function Ce(e,t){var a="";return e.forEach((function(e,n){null!==e[t]&&(a=a+"'"+e[t]+"'\n")})),a=a.substring(0,a.length-1)}function Te(e){e.userData.view.text_mode&&e.userData.view.text_mode.on?e.setTextMode():e.setTableMode()}function Ae(e){setTimeout((function(){e.userData.view.bin_mode&&e.userData.view.bin_mode.on&&(e.userData.value>0?(e.top_label.attr({fill:e.userData.view.bin_mode.invert?"#c81d07":"#37a621"}),e.filter_label.attr({fill:e.userData.view.bin_mode.invert?"#c81d07":"#37a621"}),e.val_label.attr({fill:e.userData.view.bin_mode.invert?"#c81d07":"#37a621"}),e.frame.attr({stroke:e.userData.view.bin_mode.invert?"#c81d07":"#37a621"})):(e.top_label.attr({fill:e.userData.view.bin_mode.invert?"#37a621":"#c81d07"}),e.filter_label.attr({fill:e.userData.view.bin_mode.invert?"#37a621":"#c81d07"}),e.val_label.attr({fill:e.userData.view.bin_mode.invert?"#37a621":"#c81d07"}),e.frame.attr({stroke:e.userData.view.bin_mode.invert?"#37a621":"#c81d07"})))}),10)}function Pe(e,t){var a=e.conditions;return(new C).from(t).where((function(e,t){var n,o,r,s,l,c,u=!0;return a.forEach((function(t,a){if(n="self"===t.prop?"my_date":t.prop,"custom"!==t.preset&&void 0!==t.preset||(o=t.value,"empty"===t.value?o=null:"my_date"===n&&(o=new Date(t.value)),"and"===t.logic||0===a?"not equal"===t.sign?u=u&&e[n]!==o:"equal"===t.sign?u=u&&e[n]===o:"more"===t.sign?u=u&&e[n]>o:"less"===t.sign?u=u&&e[n]<o:"less or equal"===t.sign?u=u&&e[n]<=o:"more or equal"===t.sign&&(u=u&&e[n]>=o):"or"===t.logic&&("not equal"===t.sign?u=u||e[n]!==o:"equal"===t.sign?u=u||e[n]===o:"more"===t.sign?u=u&&e[n]>o:"less"===t.sign?u=u&&e[n]<o:"less or equal"===t.sign?u=u&&e[n]<=o:"more or equal"===t.sign&&(u=u&&e[n]>=o))),"All"===t.preset&&(u=!0),"not Empty"===t.preset&&(o=null,"and"===t.logic||0===a?u=u&&e.my_date!==o:"or"===t.logic&&(u=u||e.my_date!==o)),"Empty"===t.preset)o=null,"and"===t.logic||0===a?u=u&&e.my_date===o:"or"===t.logic&&(u=u||e.my_date===o);else if("EOM"===t.preset)if(null!==e.my_date){var d=new Date,p=d.getFullYear(),h=e.my_date.getFullYear(),f=d.getMonth(),m=e.my_date.getMonth();t.shift&&("+"===t.shift.sign?12===(f+=t.shift.value)&&(f=0,p+=1):-1===(f-=t.shift.value)&&(f=11,p-=1)),"and"===t.logic||0===a?u=h<p?u&&!0:h===p?u&&m<=f:u&&!1:"or"===t.logic&&(u=h<p?u||!0:h===p?u||m<=f:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("EOW"===t.preset)if(null!==e.my_date){var g=new Date,y=g.getFullYear(),_=e.my_date.getFullYear(),b=(f=g.getWeek(),e.my_date.getWeek());t.shift&&("+"===t.shift.sign?f+=t.shift.value:f-=t.shift.value),"and"===t.logic||0===a?u=_<y?u&&!0:_===y?u&&b<=f:u&&!1:"or"===t.logic&&(u=_<y?u||!0:_===y?u||b<=f:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("EOT"===t.preset)if(null!==e.my_date){f=new Date;var v=e.my_date;t.shift&&("+"===t.shift.sign?f+=t.shift.value:f-=t.shift.value),"and"===t.logic||0===a?u=v<=f?u&&!0:u&&!1:"or"===t.logic&&(u=v<=f?u||!0:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("this Year"===t.preset)if(null!=e.my_date){p=(new Date).getFullYear(),t.shift&&("+"===t.shift.sign?p+=t.shift.value:p-=t.shift.value);var w=e.my_date.getFullYear();"and"===t.logic||0===a?u=w===p?u&&!0:u&&!1:"or"===t.logic&&(u=w===p?u||!0:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("last Year"===t.preset)if(null!=e.my_date){var x=(new Date).getFullYear()-1,k=e.my_date.getFullYear();"and"===t.logic||0===a?u=k===x?u&&!0:u&&!1:"or"===t.logic&&(u=k===x?u||!0:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("next Year"===t.preset)if(null!=e.my_date){var D=(new Date).getFullYear()+1,S=e.my_date.getFullYear();"and"===t.logic||0===a?u=S===D?u&&!0:u&&!1:"or"===t.logic&&(u=S===D?u||!0:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("this Month"===t.preset)if(null!=e.my_date){var C=new Date,T=(p=C.getFullYear(),e.my_date.getFullYear());f=C.getMonth(),t.shift&&("+"===t.shift.sign?12===(f+=t.shift.value)&&(f=0,p+=1):-1===(f-=t.shift.value)&&(f=11,p-=1));var A=e.my_date.getMonth();"and"===t.logic||0===a?u=T===p?u&&A===f:u&&!1:"or"===t.logic&&(u=T===p?u||A===f:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("next Month"===t.preset)if(null!=e.my_date){var P=new Date,E=(p=P.getFullYear(),e.my_date.getFullYear()),I=(f=P.getMonth()+1,e.my_date.getMonth());12===f&&(f=0,p+=1),"and"===t.logic||0===a?u=E===p?u&&I===f:u&&!1:"or"===t.logic&&(u=E===p?u||I===f:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("last Month"===t.preset)if(null!=e.my_date){var N=new Date,M=(p=N.getFullYear(),E=e.my_date.getFullYear(),e.my_date.getMonth());-1==(f=N.getMonth()-1)&&(f=11,p-=1),"and"===t.logic||0===a?u=E===p?u&&M===f:u&&!1:"or"===t.logic&&(u=E===p?u||M===f:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("this Week"===t.preset)null!=e.my_date?(r=i()(e.my_date.toISOString()),s=i()().clone().startOf("isoWeek"),l=i()().clone().endOf("isoWeek"),t.shift&&("+"===t.shift.sign?(s.add(parseInt(t.shift.value),"week"),l.add(parseInt(t.shift.value),"week")):(s.add(-parseInt(t.shift.value),"week"),l.add(-parseInt(t.shift.value),"week"))),t.range&&("+"===t.range.sign?l.add(parseInt(t.range.value),"week"):s.add(-parseInt(t.range.value),"week")),c=i()(r).isBetween(s,l,null,"[]"),"and"===t.logic||0===a?u=u&&c:"or"===t.logic&&(u=u||c)):"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("last Week"===t.preset)if(null!=e.my_date){var O=new Date,j=(p=O.getFullYear(),E=e.my_date.getFullYear(),f=O.getWeek(),M=e.my_date.getWeek(),new Date(p-1,11,31,0,0,0,0).getWeek());1===f?(f=j,p-=1):f-=1,"and"===t.logic||0===a?u=E===p?u&&M===f:u&&!1:"or"===t.logic&&(u=E===p?u||M===f:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("next Week"===t.preset)if(null!=e.my_date){var R=new Date;p=R.getFullYear(),E=e.my_date.getFullYear(),f=R.getWeek(),M=e.my_date.getWeek(),f===new Date(p,11,31,0,0,0,0).getWeek()?(f=1,p+=1):f+=1,"and"===t.logic||0===a?u=E===p?u&&M===f:u&&!1:"or"===t.logic&&(u=E===p?u||M===f:u||!1)}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("Today"===t.preset)null!=e.my_date?(r=i()(e.my_date.toISOString()),s=i()(),l=i()(),t.shift&&("+"===t.shift.sign?(s.add(parseInt(t.shift.value),"days"),l.add(parseInt(t.shift.value),"days")):(s.add(-parseInt(t.shift.value),"days"),l.add(-parseInt(t.shift.value),"days"))),t.range&&("+"===t.range.sign?l.add(parseInt(t.range.value),"days"):s.add(-parseInt(t.range.value),"days")),c=s.isSame(l,"day")?s.isSame(r,"day"):i()(r).isBetween(s,l,"day","[]"),"and"===t.logic||0===a?u=u&&c:"or"===t.logic&&(u=u||c)):"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("Monday"===t.preset)if(null!=e.my_date){var L=i()().startOf("isoWeek");t.shift&&("+"===t.shift.sign?L.add(t.shift.value,"days"):L.subtract(t.shift.value,"days")),r=i()(L);var F=i()(e.my_date);"and"===t.logic||0===a?u=u&&F.isSame(r,"day"):"or"===t.logic&&(u=u||F.isSame(r,"day"))}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("Yesterday"===t.preset)if(null!=e.my_date){var U=new Date,B=new Date(U.getFullYear(),U.getMonth(),U.getDate(),0,0,0,0);B.setDate(U.getDate()-1);var z=e.my_date;"and"===t.logic||0===a?u=u&&B.isSameDateAs(z):"or"===t.logic&&(u=u||B.isSameDateAs(z))}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1);else if("Tomorrow"===t.preset)if(null!=e.my_date){var H=new Date,q=new Date(H.getFullYear(),H.getMonth(),H.getDate(),0,0,0,0);q.setDate(H.getDate()+1);var V=e.my_date;"and"===t.logic||0===a?u=u&&q.isSameDateAs(V):"or"===t.logic&&(u=u||q.isSameDateAs(V))}else"and"===t.logic||0===a?u=u&&!1:"or"===t.logic&&(u=u||!1)})),u})).select()}function Ee(e,t,a){var n,o,i={};T.extend(!0,i,e.userData.view.bar,t.view&&t.view.bar?view.bar:{}),t.outPort?((n=e.getOutputPort(t.outPort))||((n=new A.OutputPort).setConnectionDirection(1),n.setName(n.getId().toString()),t.outPort=n.getId(),e.addPort(n,o),delete t.ID),o=new A.layout.locator.XYLogPortLocator(e.userData.size.width,i.height/2+i.height*a),n.setLocator(o)):(n=new A.OutputPort,o=new A.layout.locator.XYLogPortLocator(e.userData.size.width,i.height/2+i.height*a),n.setConnectionDirection(1),n.setName(n.getId().toString()),t.outPort=n.getId(),e.addPort(n,o))}function Ie(e,t,a,n,o){var i={};for(var r in e)i[r]=e[r];i.sites_list_out=a,i.item_name=e.col_name,i.task_type=e.task_type,e.project||(i.project=e.project),e.scope||(i.scope=e.scope),t.userData=i,t.getConnections().each(T.proxy((function(a,n){var o=n.getTarget();o.setValue(e.figure_id),n.setColor(e.color),DEBUG&&console.log("Data send from: "+t.getName()+" to: "+o.getParent().NAME)}),this)),n&&T.isFunction(n)&&n(a,o,e)}function Ne(e,t,a,n,o,r){var s=this;if("real time"===e.data_type||void 0===e.data_type){var l,c,u,d,p=P.context+"/data/MLPerSite",h=P.context+"/data/MLPerSiteMulti_10",f=P.context+"/data/MLPerSiteMultiLogic_10",m=[];if(void 0!==e.bypass&&e.bypass)m=Pe(e,t),this.sendTaskData(n,a,m,o);else if(""!==e.task.scope_task_id&&void 0!==e.task.scope_task_id||""!==e.multy_milestones[0].scope_task_id&&void 0!==e.multy_milestones[0].scope_task_id){var g,y,_=function(r,s){r.length>0&&r.forEach((function(t,a){null!=t.my_date&&(t.my_date=i()(t.my_date).toDate(),t[n.col_name]=i()(t.my_date).format("YYYY-MM-DD")),t.task_name=n.col_name,t.task_type=e.task_type,t.group_name=n.group_name})),!e.multy_milestone&&e.task.scope_task_id&&(n.task=e.task);var l=Pe(e,r);s.sendTaskData(n,a,l,o,t?t.length:0)};if(void 0===e.count_type||"physical"===e.count_type)if(e.multy_milestone){var b=void 0!==e.multy_milestones[0]?e.multy_milestones[0].scope_task_id:"",v=void 0!==e.multy_milestones[1]?e.multy_milestones[1].scope_task_id:"",w=void 0!==e.multy_milestones[2]?e.multy_milestones[2].scope_task_id:"",x=void 0!==e.multy_milestones[3]?e.multy_milestones[3].scope_task_id:"",k=void 0!==e.multy_milestones[4]?e.multy_milestones[4].scope_task_id:"",D=void 0!==e.multy_milestones[5]?e.multy_milestones[5].scope_task_id:"",S=void 0!==e.multy_milestones[6]?e.multy_milestones[6].scope_task_id:"",C=void 0!==e.multy_milestones[7]?e.multy_milestones[7].scope_task_id:"",A=void 0!==e.multy_milestones[8]?e.multy_milestones[8].scope_task_id:"",I=void 0!==e.multy_milestones[9]?e.multy_milestones[9].scope_task_id:"";e.config?(c=e.config.field_name?e.config.field_name:"",u=e.config.array?JSON.stringify(e.config.array):""):(c="",u="");var N=h+"?&val1="+b+"&val2="+v+"&val3="+w+"&val4="+x+"&val5="+k+"&val6="+D+"&val7="+S+"&val8="+C+"&val9="+A+"&val10="+I+"&task_type="+e.task_type+"&config="+c+"&array="+u}else if(r){if(d=e.use_task_name&&e.task.scope_task_name?{task_name:e.task.scope_task_name,proj_id:n.project.proj_id}:e.use_ssop_code&&e.task.task_code?{stand_activity_code:e.task.task_code,proj_id:n.project.proj_id}:{task_id:e.task.scope_task_id,proj_id:n.project.proj_id},n.sop&&n.sop.scope_id&&(d.du_model_id=n.sop.scope_id),e.conditions.length&&1===e.conditions.length&&"All"!==e.conditions[0].preset&&e.task_type.indexOf("forecast")<0&&(d.status="Completed, OnGoing"),void 0!==t)if(e.use_du_id)M="empty,",t.forEach((function(e,t){M=M+e.du_id+","})),M=M.substring(0,M.length-1),d.du_id=M;else{var M="empty,";t.forEach((function(e,t){M=M+e.site_id+","})),M=M.substring(0,M.length-1),d.site_id=M}}else N=p+"?&task_id="+e.task.scope_task_id+"&task_type="+e.task_type;else if("logical"===e.count_type&&e.multy_milestone)if(r){if(e.use_task_name){d={proj_id:n.project.proj_id};var O="";e.multy_milestones.forEach((function(e,t){e.scope_task_name&&(O=O+e.scope_task_name+",")})),(O=O.substring(0,O.length-1)).length&&(d.task_name=O)}else d={proj_id:n.project.proj_id},O="",e.multy_milestones.forEach((function(e,t){e.scope_task_id&&(O=O+e.scope_task_id+",")})),(O=O.substring(0,O.length-1)).length&&(d.task_id=O);n.sop&&n.sop.scope_id&&(d.du_model_id=n.sop.scope_id),t&&(e.use_du_id?(M="epmsty,",t.forEach((function(e,t){M=M+e.du_id+","})),(M=M.substring(0,M.length-1)).length&&(d.du_id=M)):(M="empty,",t.forEach((function(e,t){M=M+e.site_id+","})),(M=M.substring(0,M.length-1)).length&&(d.site_id=M)))}else b=void 0!==e.multy_milestones[0]?e.multy_milestones[0].scope_task_id:"",v=void 0!==e.multy_milestones[1]?e.multy_milestones[1].scope_task_id:"",w=void 0!==e.multy_milestones[2]?e.multy_milestones[2].scope_task_id:"",x=void 0!==e.multy_milestones[3]?e.multy_milestones[3].scope_task_id:"",k=void 0!==e.multy_milestones[4]?e.multy_milestones[4].scope_task_id:"",D=void 0!==e.multy_milestones[5]?e.multy_milestones[5].scope_task_id:"",S=void 0!==e.multy_milestones[6]?e.multy_milestones[6].scope_task_id:"",C=void 0!==e.multy_milestones[7]?e.multy_milestones[7].scope_task_id:"",A=void 0!==e.multy_milestones[8]?e.multy_milestones[8].scope_task_id:"",I=void 0!==e.multy_milestones[9]?e.multy_milestones[9].scope_task_id:"",e.config?(c=e.config.field_name?e.config.field_name:"",u=e.config.array?JSON.stringify(e.config.array):""):(c="",u=""),N=f+"?&val1="+b+"&val2="+v+"&val3="+w+"&val4="+x+"&val5="+k+"&val6="+D+"&val7="+S+"&val8="+C+"&val9="+A+"&val10="+I+"&task_type="+e.task_type+"&config="+c+"&array="+u;this["xhr"+n.id]&&4!==this["xhr"+n.id].readyState&&this["xhr"+n.id].abort(),r?""===d.site_id?this.sendTaskData(n,a,[],o):e.task.scope_task_code.indexOf("WP")>-1?("forecast"===(g=e.task_type)||"forecast end"===g||"forecast_end"===g||"forecastend"===g||"fcst end"===g?y=P.context+"/apidata/getAPIData?apiid=529641159439450112&user_id="+window.user_id:"actual"===g||"actual end"===g||"actual_end"===g||"actualend"===g||"act end"===g?y=P.context+"/apidata/getAPIData?apiid=529666460521365504&user_id="+window.user_id:"forecast start"===g||"forecast_start"===g||"forecaststart"===g||"fcst strt"===g?y=P.context+"/apidata/getAPIData?apiid=529641779160449024&user_id="+window.user_id:"actual start"!==g&&"actual_start"!==g&&"actualstart"!==g&&"act strt"!==g||(y=P.context+"/apidata/getAPIData?apiid=529640177791959040&user_id="+window.user_id),this.xhr=T.ajax({url:y,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(d),success:function(e){var t=e.data?e.data:e;_(t,s)}})):("forecast"===(g=e.task_type)||"forecast end"===g||"forecast_end"===g||"forecastend"===g||"fcst end"===g?y=P.context+"/apidata/getAPIData?apiid=529652620081528832&user_id="+window.user_id:"actual"===g||"actual end"===g||"actual_end"===g||"actualend"===g||"act end"===g?y=P.context+"/apidata/getAPIData?apiid=529648514487058432&user_id="+window.user_id:"forecast start"===g||"forecast_start"===g||"forecaststart"===g||"fcst strt"===g?y=P.context+"/apidata/getAPIData?apiid=529653342755913728&user_id="+window.user_id:"actual start"!==g&&"actual_start"!==g&&"actualstart"!==g&&"act strt"!==g||(y=P.context+"/apidata/getAPIData?apiid=529649932061147136&user_id="+window.user_id),this.xhr=T.ajax({url:y,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(d),success:function(e){var t=e.data?e.data:e;_(t,s)}})):t&&t.length?this["xhr"+n.id]=T.ajax({url:N,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(t),success:function(e){var t=e.data?e.data:e;_(t,s)}}):this.sendTaskData(n,a,[],o)}else this.sendTaskData(n,a,[],o,0)}else if("fixed month"===e.data_type)e.fixed_data.length>0&&(m=[],t&&t.length&&e.fixed_data.forEach((function(a,o){new Date(a.year,E.months.indexOf(a.month),1,0,0,0,0);var i=s.daysInMonth(E.months.indexOf(a.month)+1,a.year),r=Math.floor(a.value/i),c=[];if(r>=1){for(var u=1;u<=i;u++)c.push({value:r});l=a.value-r*i;for(var d=0;d<l;d++)c[d].value=c[d].value+1}else{var p=Math.floor(i/a.value),h=0,f=1;for(u=1;u<=i;u++)f>p?(f=1,h++,c.push({value:1})):(f++,c.push({value:0}));for(l=a.value-h,d=0;d<l;d++)0===c[d].value?c[d].value=c[d].value+1:l++}c.forEach((function(o,i){for(var r=0;r<o.value;r++){var s=t&&t.length?t[0].site_id:"dummy";m.push({my_date:new Date(a.year,E.months.indexOf(a.month),i+1,0,0,0,0),site_code:"dummy",site_id:s,task_name:n.col_name,task_type:e.task_type})}}))})),m=Pe(e,m),this.sendTaskData(n,a,m,o,t.length));else if("baseline month"===e.data_type){var j=JSON.stringify(t);this["xhr"+n.id]&&4!==this["xhr"+n.id].readyState&&this["xhr"+n.id].abort(),this["xhr"+n.id]=T.ajax({url:P.context+"/data/GetPrBaseline?&task_id="+e.task.scope_task_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:j,success:function(i){i.length>0&&i.length>0&&(m=[],t&&t.length&&i.forEach((function(a,o){new Date(a.year,E.months.indexOf(a.month),1,0,0,0,0);var i=s.daysInMonth(E.months.indexOf(a.month)+1,a.year),r=Math.floor(a.value/i),c=[];if(r>=1){for(var u=1;u<=i;u++)c.push({value:r});l=a.value-r*i;for(var d=0;d<l;d++)c[d].value=c[d].value+1}else{var p=Math.floor(i/a.value),h=0,f=1;for(u=1;u<=i;u++)f>p?(f=1,h++,c.push({value:1})):(f++,c.push({value:0}));for(l=a.value-h,d=0;d<l;d++)0===c[d].value?c[d].value=c[d].value+1:l++}c.forEach((function(o,i){for(var r=0;r<o.value;r++){var s=t&&t.length?t[0].site_id:"dummy";m.push({my_date:new Date(a.year,E.months.indexOf(a.month),i+1,0,0,0,0),site_code:"dummy",site_id:s,task_name:n.col_name,task_type:e.task_type})}}))})),m=Pe(e,m),s.sendTaskData(n,a,m,o))}})}else"fixed week"===e.data_type&&e.fixed_data.length>0&&(m=[],t&&t.length&&e.fixed_data.forEach((function(a,o){i()(a.year+"-"+a.week,"YYYY-W WW");var r=Math.floor(a.value/7),s=[];if(r>=1){for(var l=1;l<=7;l++)s.push({value:r});h=a.value-7*r;for(var c=0;c<h;c++)s[c].value=s[c].value+1}else{var u=Math.floor(7/a.value),d=0,p=1;for(l=1;l<=7;l++)p>u?(p=1,d++,s.push({value:1})):(p++,s.push({value:0}));var h=a.value-d;for(c=0;c<h;c++)0===s[c].value?s[c].value=s[c].value+1:h++}s.forEach((function(o,r){for(var s=0;s<o.value;s++){var l=t&&t.length?t[0].site_id:"dummy",c=r+1,u=a.year+$(a.week)+c;m.push({my_date:i()(u,"YYYYWWE").toDate(),site_code:"dummy",site_id:l,task_name:n.col_name,task_type:e.task_type})}}))})),m=Pe(e,m),this.sendTaskData(n,a,m,o,t.length))}function Me(e,t,a,n){var o;o={proj_id:"'"+a.project.proj_id+"'",site_id:"'all'",du_id:"'all'"};var i="";if(e.forEach((function(e,t){e&&(i=i+"'"+e+"',")})),i=""===(i=i.substring(0,i.length-1))?"all":i,o.task_id=i,a.sop&&a.sop.scope_id&&(o.du_model_id="'"+a.sop.scope_id+"'"),t){var r="";t.forEach((function(e,t){r=r+"'"+e.du_id+"',"})),r=""===(r=r.substring(0,r.length-1))?"all":r,o.du_id=r}this["xhr"+a.id]&&4!==this["xhr"+a.id].readyState&&this["xhr"+a.id].abort();var s,l=a.task_type;"forecast"===l||"forecast end"===l||"forecast_end"===l||"forecastend"===l||"fcst end"===l?s=P.context+"/apidata/getAPIData?apiid=529652620081528832&user_id="+window.user_id:"actual"===l||"actual end"===l||"actual_end"===l||"actualend"===l||"act end"===l?s=P.context+"/apidata/getAPIData?apiid=529648514487058432&user_id="+window.user_id:"forecast start"===l||"forecast_start"===l||"forecaststart"===l||"fcst strt"===l?s=P.context+"/apidata/getAPIData?apiid=529653342755913728&user_id="+window.user_id:"actual start"!==l&&"actual_start"!==l&&"actualstart"!==l&&"act strt"!==l||(s=P.context+"/apidata/getAPIData?apiid=529649932061147136&user_id="+window.user_id),this.xhr=T.ajax({url:s,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(o),success:function(e){e.data&&e.data}})}function Oe(){var e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?a:3&a|8).toString(16)}))}function je(e,t){function a(e,a,n,o){""!==t.filter_label.getText()&&t.filter_label.setText(t.filter_label.getText()+"\n"),t.filter_label.attr({text:t.filter_label.getText()+e+" ("+t.userData.task_type+")"+a+n})}t.filter_label.setText(""),t.userData.hide_cond?t.filter_label.hide():(t.filter_label.show(),e.forEach((function(e,n){var o=e.shift?" s:"+e.shift.sign+" "+e.shift.value:"",i=e.range?" r:"+e.range.sign+" "+e.range.value:"";"custom"===e.preset||void 0===e.preset?(""!==t.filter_label.getText()&&t.filter_label.setText(t.filter_label.getText()+"\n"),t.filter_label.attr({text:t.filter_label.getText()+e.logic+" "+e.sign+" "+e.value+" ("+t.userData.task_type+")"})):"All"===e.preset?a("All",o,i):"not Empty"===e.preset?a("not Empty",o,i):"Empty"===e.preset?a("Empty",o,i):"EOM"===e.preset?a("EOM",o,i):"EOW"===e.preset?a("EOW",o,i):"EOT"===e.preset?a("EOT",o,i):"this Year"===e.preset?a("this Year",o,i):"this Month"===e.preset?a("this Month",o,i):"this Week"===e.preset?a("this Week",o,i):"Today"===e.preset?a("Today",o,i):"last Year"===e.preset?a("last Year",o,i):"last Month"===e.preset?a("last Month",o,i):"last Week"===e.preset?a("last Week",o,i):"Yesterday"===e.preset?a("Yesterday",o,i):"next Year"===e.preset?a("next Year",o,i):"next Month"===e.preset?a("next Month",o,i):"next Week"===e.preset?a("next Week",o,i):"Tomorrow"===e.preset&&a("Tomorrow",o,i)})))}function Re(e,t){var a=this;if(DEBUG&&console.log(e.NAME+"...updateTable"),CHART_DEBUG){var n,o,i=[];n=performance.now()}var r=e.getUserData(),s=r.trend,l=r.period;if(e.setDimension(r.size.width,r.size.height),e.originalWidth=e.userData.size.width,e.originalHeight=e.userData.size.height,e.userData.title_left.label=s,e.userData.title_right.label=l,e.userData.col.length>0){var c;if(CHART_DEBUG)var u,d=[];if(e.userData.col.forEach((function(n,o){if(CHART_DEBUG)var i=performance.now();var c,p=new Date(r.start_date);c=void 0!==e.userData.end_date?new Date(r.end_date):new Date;for(var h=[],f=[],m=[],g=0;g<=Math.floor((c-p)/864e5);g++)h.push({my_date:new Date(p.getTime()+864e5*g)});if(n.sites_list_out){n.sites_list_out.length>0&&n.sites_list_out.forEach((function(e,t){null!=e.my_date&&(e.my_date=new Date(e.my_date))}));var y,_=n.serie.trend?n.serie.trend:s,b=[],v=[],w={},x=0;if("monthly"===l){I.fn.toPeriod=function(e){return void 0!==e?e>p||"incremental"===_?e.getFullYear()+"-"+$(e.getMonth()+1):p.getFullYear()+"-"+$(p.getMonth()+1):null};var k=I("SELECT task_name, toPeriod(my_date) as my_month, count(site_id) as my_count FROM ? group by col_name, toPeriod(my_date) order by my_month",[n.sites_list_out]);m=S.getAllMonths(p,c,n.item_name);var C=I("SELECT *  FROM ? as all_m Left JOIN ? as res USING my_month order by my_month",[m,k]);for(y=0,g=C.length-1;g>=0;g--)0!==C[g].my_count&&(y=g),v.splice(0,0,"M"+C[g].my_month.substring(5,7)+"-"+C[g].my_month.substring(2,4));t.xAxis.data=v;var T=a.GetTodayPosition(t,l);y<T&&(y=T),"accumulative"===_?(b=[],v=[],w={},x=0,C.forEach((function(t,a){x+=t.my_count,(!e.userData.hide_future||n.serie.force_acc||a<=y)&&b.push(x)})),void 0===n.serie?alert("Something went wrong, please reconnect Task Node for "+n.item_name):(null===n.serie.type&&(w.type="line"),(w=n.serie).data=b,t.series.push(w))):"incremental"===_&&(b=[],v=[],C.forEach((function(t,a){(!e.userData.hide_future||n.serie.force_acc||a<=y)&&b.push(t.my_count)})),void 0===n.serie?alert("Something went wrong, please reconnect Task Node for "+n.item_name):((w=n.serie).data=b,void 0===n.serie.type&&(w.type="bar"),t.series.push(w)))}else if("weekly"===l){for(I.fn.toPeriod=function(e){return void 0!==e?e>p||"incremental"===_?e.ISO8601_y_week_no():p.ISO8601_y_week_no():null},k=I("SELECT task_name, toPeriod(my_date) as my_week, count(site_id) as my_count FROM ? group by col_name, toPeriod(my_date) order by my_week",[n.sites_list_out]),f=S.getAllWeeks(p,c,n.item_name),C=I("SELECT *  FROM ? as all_m Left JOIN ? as res USING my_week order by my_week",[f,k]),y=0,v=[],g=C.length-1;g>=0;g--)0!==C[g].my_count&&(y=g),v.splice(0,0,"W"+C[g].my_week.substring(5,7)+"-"+C[g].my_week.substring(2,4));t.xAxis.data=v,T=a.GetTodayPosition(t,l),y<T&&(y=T),"accumulative"===_?(b=[],w={},x=0,C.forEach((function(t,a){x+=t.my_count,(!e.userData.hide_future||n.serie.force_acc||a<=y)&&b.push(x)})),void 0===n.serie?alert("Something went wrong, please reconnect Task Node for "+n.item_name):(w=n.serie,null===n.serie.type&&(w.type="line"),w.data=b,t.series.push(w))):"incremental"===_&&(b=[],C.forEach((function(t,a){(!e.userData.hide_future||n.serie.force_acc||a<=y)&&b.push(t.my_count)})),void 0===n.serie?alert("Something went wrong, please reconnect Task Node for "+n.item_name):((w=n.serie).data=b,void 0===n.serie.type&&(w.type="bar"),t.series.push(w)))}else if("daily"===l){for(I.fn.toPeriod=function(e){return void 0!==e?e>p||"incremental"===_?e.getFullYear().toString().substring(2,4)+"-"+$(e.getMonth()+1)+"-"+$(e.getDate()):p.getFullYear().toString().substring(2,4)+"-"+$(p.getMonth()+1)+"-"+$(p.getDate()):null},k=I("SELECT task_name, toPeriod(my_date) as my_day, count(site_id) as my_count FROM ? group by col_name, toPeriod(my_date) order by my_day",[n.sites_list_out]),h=S.getAllDays(p,c,n.item_name),C=I("SELECT *  FROM ? as all_m Left JOIN ? as res USING my_day order by my_day",[h,k]),y=0,g=C.length-1;g>=0;g--)0!==C[g].my_count&&(y=g),v.splice(0,0,C[g].my_day);t.xAxis.data=v,T=a.GetTodayPosition(t,l),y<T&&(y=T),"accumulative"===_?(b=[],v=[],w={},x=0,C.forEach((function(t,a){x+=t.my_count,(!e.userData.hide_future||n.serie.force_acc||a<=y)&&b.push(x)})),void 0===n.serie?alert("Something went wrong, please reconnect Task Node for "+n.item_name):(w=n.serie,null===n.serie.type&&(w.type="line"),w.data=b,t.series.push(w))):"incremental"===_&&(b=[],v=[],C.forEach((function(t,a){(!e.userData.hide_future||n.serie.force_acc||a<=y)&&b.push(t.my_count)})),void 0===n.serie?alert("Something went wrong, please reconnect Task Node for "+n.item_name):((w=n.serie).data=b,void 0===n.serie.type&&(w.type="bar"),t.series.push(w)))}}else h=[],f=[],m=[],"monthly"===l&&(m=S.getAllMonths(p,c,n.serie.name),b=[],v=[],w={},"accumulative"===_?m.forEach((function(e,t){void 0!==n.serie.data[t]?(x=parseInt(n.serie.data[t]),b.push(x)):b.push(x),v.push("M"+e.my_month.substring(5,7)+"-"+e.my_month.substring(2,4))})):"incremental"===_&&m.forEach((function(e,t){if(void 0!==n.serie.data[t]){var a=0;0!==t&&(a=n.serie.data[t-1]),b.push(n.serie.data[t]-a)}else b.push(0);v.push("M"+e.my_month.substring(5,7)+"-"+e.my_month.substring(2,4))})),t.xAxis.data=v,void 0===n.serie?alert("Data is missing for "+n.item_name):((w=D.extend({},n.serie)).data=b,void 0===n.serie.type&&(w.type="line"),t.series.push(w)));CHART_DEBUG&&(u=performance.now(),d.push("serie "+(i-u)))})),CHART_DEBUG&&console.log(d),c=this.GetTodayPosition(t,l),t.xAxis.marks.mark_items=[],t.xAxis.marks.mark_items.push(c),e.uChart)e.updateChartData(t),CHART_DEBUG&&console.log(t);else{if(CHART_DEBUG)var p=performance.now();if(e.initDataUpdate(t),CHART_DEBUG&&console.log("initDataUpdate "+(p-performance.now())),CHART_DEBUG&&console.log(t),CHART_DEBUG)var h=performance.now();e.userData.showToday&&e.uChart.longest_data+1>e.uChart.period&&(c+1>e.uChart.period?(e.uChart.finish_position=c,e.uChart.start_position=e.uChart.finish_position-e.uChart.period+1,e.uChart.refresh()):(e.uChart.start_position=0,e.uChart.finish_position=e.uChart.period-1,e.uChart.refresh())),CHART_DEBUG&&console.log("UChart Show Today "+(h-performance.now()))}}e.updateTickets=0,CHART_DEBUG&&(o=performance.now(),i.push("finish "+(n-o)),console.log(i))}function Le(e,t){var a,n,o=new Date,i=o.getFullYear().toString().substring(2,4),r=o.getMonth(),s=o.getDate();return e.xAxis.data.forEach((function(e,l){var c="daily"===t?e.substring(0,2):e.substring(4,6);if("monthly"===t)a=parseInt(e.substring(1,3)),i===c&&r+1===a&&(n=l);else if("weekly"===t){var u=o.getWeek(),d=parseInt(e.substring(1,3));i===c&&u===d&&(n=l)}else if("daily"===t){var p=parseInt(e.substring(6,8));a=parseInt(e.substring(3,5)),i===c&&r+1===a&&s===p&&(n=l)}})),n}function Fe(e){I.options.columnlookup=e.length;var t=I("RECORDSET OF SELECT * from ?",[e]).columns;t.forEach((function(e,a){"site_id"!==e.columnid||t.splice(a,1)}));for(var a="",n="",o=0;o<t.length;o++)n+='"'+(t[o].columnid+"").replace(/"/g,'""')+'",';a+=(n=n.slice(0,-1))+"\r\n";for(var r=0;r<e.length;r++){for(n="",o=0;o<t.length;o++)e[r][t[o].columnid]?n+='"'+(e[r][t[o].columnid]instanceof Date?i()(e[r][t[o].columnid]).format("DD-MMMM-YYYY"):e[r][t[o].columnid]+"").replace(/"/g,'""')+'",':n+='"",';a+=(n=n.slice(0,-1))+"\r\n"}var s=document.createElement("a");s.setAttribute("href","data:text/csv;charset=utf-8,"+escape(a)),s.setAttribute("download","fish_bone_export.csv"),s.click()}function Ue(e){try{JSON.parse(e)}catch(e){return!1}return!0}function Be(e){var t;t=Ue(e)?JSON.parse(e):e;var a=[];"object"!==z(t[0])||Array.isArray(t[0])||null===t[0]?a=t:(a.push(Object.keys(t[0])),t.forEach((function(e,t){a.push(Object.values(e))}))),alert("Excel export is temporarily disabled due to compatibility issues. Please use CSV export instead.")}function ze(e,t){return e.getAbsoluteX(),e.getAbsoluteY(),e.canvas.paper.setStart(),e.canvas.paper.rect(0,0,e.getWidth(),e.getHeight(),1).attr({fill:"white",opacity:.5,stroke:"none"}),e.canvas.paper.rect(0,0,t*e.getWidth()/100,e.getHeight(),1).attr({fill:"0-white-rgba(132,202,255,0.51)",opacity:.7,stroke:"none"}),e.canvas.paper.text(e.userData.size.width/2+0,e.userData.size.height/2+0,t+"%").attr({fill:"#777",stroke:"none",opacity:.9,"font-size":16,"font-weight":"bold","font-style":"normal","font-family":"Tahoma"}),e.canvas.paper.setFinish()}function He(e,t,a){a||e.maxTicketsNumber||(e.maxTicketsNumber=e.updateTickets),e.progress=t||(e.updateTickets!==e.maxTicketsNumber?Math.round(100*(1-e.updateTickets/e.maxTicketsNumber)):e.progress),e.svgNodes.hide(),e.svgNodes=this.updateSet(e,e.progress),e.applyTransformation(),e.repaint()}function qe(e,t){var a=!1,n={};return t.map((function(t){var o=t[e];o in n?(n[o].duplicate=!0,t.duplicate=!0,a=!0):(n[o]=t,delete t.duplicate)})),a}function Ve(e,t,a){var n=!1;return e&&e.length&&e.forEach((function(e){e[Object.keys(e)[a]]===t&&(n=!0)})),n}function We(e,t,a,n){var o=this.deg2rad(a-e),i=this.deg2rad(n-t),r=Math.sin(o/2)*Math.sin(o/2)+Math.cos(this.deg2rad(e))*Math.cos(this.deg2rad(a))*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r))*6371}function Ge(e){return e*(Math.PI/180)}function Je(e){var t,a=T.pivotUtilities.numberFormat,o=[].indexOf||function(e){for(var t=0,a=this.length;t<a;t++)if(t in this&&this[t]===e)return t;return-1};return e.userData.aggregator.num_format&&(t=a(e.userData.aggregator.num_format)),{Count:function(e,a,o){return e[0],function(e,i,r){return{count:0,summ:0,avg:0,min:0,max:0,rec_set:[],push:function(e){var t;return this.rec_set.push((delete(t=e)["Aging(days)"],delete t["Aging(Working days)"],delete t["Aging(range)"],delete t["Aging(3 range)"],t)),this.count++},value:function(t){return t?this.rec_set:i.length?r.length?this.count:"avg"===a?Math.round(this.count/e.colKeys.length):this.count:"avg"===o?Math.round(this.count/e.rowKeys.length):this.count},format:t||n.hm,numInputs:1}}},"Count If":function(e,a,o){var i=e[0];return function(e,r,s){return{count:0,summ:0,avg:0,min:0,max:0,rec_set:[],push:function(e){var t;if(this.rec_set.push((delete(t=e)["Aging(days)"],delete t["Aging(Working days)"],delete t["Aging(range)"],delete t["Aging(3 range)"],t)),e[i])return this.count++},value:function(t){return t?this.rec_set:r.length?s.length?this.count:"avg"===a?Math.round(this.count/e.colKeys.length):this.count:"avg"===o?Math.round(this.count/e.rowKeys.length):this.count},format:t||n.hm,numInputs:1}}},Average:function(e,a,o){var i;return i=e[0],function(e,r,s){return{sum:0,len:0,rec_set:[],val_set:[],push:function(e){var t;if(this.rec_set.push((delete(t=e)["Aging(days)"],delete t["Aging(Working days)"],delete t["Aging(range)"],delete t["Aging(3 range)"],t)),!isNaN(parseFloat(e[i])))return this.sum+=parseFloat(e[i]),this.val_set.push(parseFloat(e[i])),this.len++},value:function(t){var n,i=r.join(String.fromCharCode(0)),l=s.join(String.fromCharCode(0));return t?this.rec_set:r.length?s.length?this.sum/this.len:"sum"===a?(n=0,Object.keys(e.tree[i]).forEach((function(t,a){n+=e.tree[i][t].sum/e.tree[i][t].len})),n):"min"===a?(n=e.tree[i][Object.keys(e.tree[i])[0]].sum/e.tree[i][Object.keys(e.tree[i])[0]].len,Object.keys(e.tree[i]).forEach((function(t,a){n=e.tree[i][t].sum/e.tree[i][t].len<n?e.tree[i][t].sum/e.tree[i][t].len:n})),n):"max"===a?(n=e.tree[i][Object.keys(e.tree[i])[0]].sum/e.tree[i][Object.keys(e.tree[i])[0]].len,Object.keys(e.tree[i]).forEach((function(t,a){n=e.tree[i][t].sum/e.tree[i][t].len>n?e.tree[i][t].sum/e.tree[i][t].len:n})),n):this.sum/this.len:"sum"===o?(n=0,Object.keys(e.tree).forEach((function(t,a){e.tree[t][l]&&(n+=e.tree[t][l].sum/e.tree[t][l].len)})),n):"min"===o?(n=0,Object.keys(e.tree).forEach((function(t,a){e.tree[t][l]&&(0===n&&(n=e.tree[t][l].sum/e.tree[t][l].len),n=e.tree[t][l].sum/e.tree[t][l].len<n?e.tree[t][l].sum/e.tree[t][l].len:n)})),n):"max"===o?(n=0,Object.keys(e.tree).forEach((function(t,a){e.tree[t][l]&&(0===n&&(n=e.tree[t][l].sum/e.tree[t][l].len),n=e.tree[t][l].sum/e.tree[t][l].len>n?e.tree[t][l].sum/e.tree[t][l].len:n)})),n):this.sum/this.len},format:t||n._O,numInputs:null!=i?0:1}}},"Running Totals":function(e){var a=e[0],o=e[1];return function(e,i,r){return{sum:0,push:function(e){if(!isNaN(parseFloat(e[a])))return this.sum+=parseFloat(e[a])},value:function(){var t,a,n,s,l,c,u,d,p,h,f;for(a=e.getColKeys(),n=0,s=r.join(String.fromCharCode(0)),u=0,p=a.length;u<p;u++)a[u].join(String.fromCharCode(0))===s&&(c=n),n++;h=0;var m=[];if(c>0)for(l=d=1,f=c+1;1<=f?d<f:d>f;l=1<=f?++d:--d){t=e.getAggregator(i,a[c-l]);var g=e.colAttrs.indexOf(o);"sum"in t&&a[c-l][g]===r[g]&&(h+=t.sum,m.push.apply(m,t.row_set))}return this.sum+h},format:t||n._O,numInputs:1}}},"Count Accumulative":function(e){var a=e[0];return function(e,o,i){return{count:0,row_set:[],push:function(e){var t;return this.row_set.push((delete(t=e)["Aging(days)"],delete t["Aging(Working days)"],delete t["Aging(range)"],delete t["Aging(3 range)"],t)),this.count+=1},value:function(t){var n,r,s,l,c,u,d,p,h,f,m;for(r=e.getColKeys(),s=0,l=i.join(String.fromCharCode(0)),d=0,h=r.length;d<h;d++)r[d].join(String.fromCharCode(0))===l&&(u=s),s++;f=0;var g=[];if(u>0)for(c=p=1,m=u+1;1<=m?p<m:p>m;c=1<=m?++p:--p){n=e.getAggregator(o,r[u-c]);var y=e.colAttrs.indexOf(a);"count"in n&&r[u-c][y]===i[y]&&(f+=n.count,g.push.apply(g,n.row_set))}if(void 0!==this.count)return t?this.row_set.concat(g):this.count+f},format:t||n.hm,numInputs:1}}},"Count Incremental-Accumulative":function(e){var a=e[0];return function(e,o,i){return{count:0,row_set:[],push:function(e){var t;return this.row_set.push((delete(t=e)["Aging(days)"],delete t["Aging(Working days)"],delete t["Aging(range)"],delete t["Aging(3 range)"],t)),this.count+=1},value:function(r){var s,l,c,u,d,p,h,f,m,g,y;for(l=e.getColKeys(),c=0,u=i.join(String.fromCharCode(0)),h=0,m=l.length;h<m;h++)l[h].join(String.fromCharCode(0))===u&&(p=c),c++;g=0;var _=[];if(p>0)for(d=f=1,y=p+1;1<=y?f<y:f>y;d=1<=y?++f:--f){s=e.getAggregator(o,l[p-d]);var b=e.colAttrs.indexOf(a);"count"in s&&l[p-d][b]===i[b]&&(g+=s.count,_.push.apply(_,s.row_set))}if(void 0!==this.count)return t||n._O,r?this.row_set.concat(_):this.count+g+" ("+this.count+")"},format:function(e){return e},numInputs:1}}},"Sum Incremental-Accumulative":function(e){var a=e[0],o=e[1];return function(e,i,r){return{sum:0,row_set:[],push:function(e){var t;return this.row_set.push((delete(t=e)["Aging(days)"],delete t["Aging(Working days)"],delete t["Aging(range)"],delete t["Aging(3 range)"],t)),this.sum+=parseFloat(e[a])},value:function(a){var s,l,c,u,d,p,h,f,m,g,y;for(l=e.getColKeys(),c=0,u=r.join(String.fromCharCode(0)),h=0,m=l.length;h<m;h++)l[h].join(String.fromCharCode(0))===u&&(p=c),c++;g=0;var _=[];if(p>0)for(d=f=1,y=p+1;1<=y?f<y:f>y;d=1<=y?++f:--f){s=e.getAggregator(i,l[p-d]);var b=e.colAttrs.indexOf(o);"sum"in s&&l[p-d][b]===r[b]&&(g+=s.sum,_.push.apply(_,s.row_set))}var v=t||n._O;if(void 0!==this.sum)return a?this.row_set.concat(_):v(this.sum+g)+" ("+v(this.sum)+")"},format:function(e){return e},numInputs:1}}},"List Unique Value (Format)":function(t){var a;return a=t[0],function(t,n,o){return{uniq:[],push:function(t){var n;if(n=t[a])return n instanceof Date?e.userData.pivot.date_format?this.uniq.push(i()(n).format(e.userData.pivot.date_format)):this.uniq.push(i()(n).format("dd-mm-yyy")):this.uniq.push(t[a])},value:function(){return n.length&&o.length?this.uniq.join(","):this.uniq.length},format:function(e){return e},numInputs:null!=a?0:1}}},Performance:function(a){return function(a,o,r){return{scope_count:0,total_count:0,today_count:0,d30_count:0,d7_count:0,d60_count:0,d14_count:0,yesterday_count:0,this_month_count:0,this_week_count:0,last_month_count:0,last_week_count:0,total_count_f:0,today_count_f:0,d30_count_f:0,d7_count_f:0,yesterday_count_f:0,this_month_count_f:0,this_week_count_f:0,last_month_count_f:0,last_week_count_f:0,total_count_b:0,today_count_b:0,d30_count_b:0,d7_count_b:0,yesterday_count_b:0,this_month_count_b:0,this_week_count_b:0,last_month_count_b:0,last_week_count_b:0,in_sla_count:0,out_sla_count:0,d_in_sla_count:0,d_out_sla_count:0,rec_set:[],push:function(e){var t;if(this.rec_set.push((delete(t=e)["Aging(days)"],delete t["Aging(Working days)"],delete t["Aging(range)"],delete t["Aging(3 range)"],t)),i()(e.my_date).isValid()){var a=new Date,n=i()(e.my_date).toDate(),o=a.getFullYear(),r=a.getMonth(),s=a.getWeek(),l=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);l.setDate(a.getDate()-7);var c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);c.setDate(a.getDate()-14);var u=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);u.setDate(a.getDate()-30);var d=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);d.setDate(a.getDate()-60);var p=n.getFullYear(),h=n.getMonth(),f=n.getWeek(),m=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0,0);m.setDate(m.getDate()-1),"actual"===e.task_type?(this.this_month_count+=o===p&&r===h,this.this_week_count+=o===p&&s===f,this.last_month_count+=i()(n).isSameOrAfter(i()(a).subtract(1,"months").startOf("month"))&&i()(n).isSameOrBefore(i()(a).subtract(1,"months").endOf("month")),this.last_week_count+=i()(n).isSame(i()().subtract(1,"isoWeek"),"isoWeek"),this.today_count+=i()(a).isSame(n,"day"),this.yesterday_count+=i()(m).isSame(n,"day"),this.d7_count+=n>=l,this.d14_count+=n>=c&&n<l,this.d30_count+=n>=u,this.d60_count+=n>=d&&n<u,this.total_count++):"baseline"===e.task_type?(this.this_month_count_b+=o===p&&r===h,this.this_week_count_b+=o===p&&s===f,this.last_month_count_b+=i()(n).isSameOrAfter(i()(a).subtract(1,"months").startOf("month"))&&i()(n).isSameOrBefore(i()(a).subtract(1,"months").endOf("month")),this.last_week_count_b+=i()(n).isSame(i()().subtract(1,"isoWeek"),"isoWeek"),this.today_count_b+=i()(a).isSame(n,"day"),this.yesterday_count_b+=i()(m).isSame(n,"day"),this.d7_count_b+=n>=l,this.d30_count_b+=n>=u,this.total_count_b++):"forecast"===e.task_type?(this.this_month_count_f+=o===p&&r===h,this.this_week_count_f+=o===p&&s===f,this.last_month_count_f+=i()(n).isSameOrAfter(i()(a).subtract(1,"months").startOf("month"))&&i()(n).isSameOrBefore(i()(a).subtract(1,"months").endOf("month")),this.last_week_count_f+=i()(n).isSame(i()().subtract(1,"isoWeek"),"isoWeek"),this.today_count_f+=i()(a).isSame(n,"day"),this.yesterday_count_f+=i()(m).isSame(n,"day"),this.d7_count_f+=n>=l,this.d30_count_f+=n>=u,this.total_count_f++):"scope"===e.task_type?this.scope_count++:"completed in SLA"===e.task_type?this.d_in_sla_count++:"completed out of SLA"===e.task_type?this.d_out_sla_count++:"pending in SLA"===e.task_type?this.in_sla_count++:"pending out of SLA"===e.task_type&&this.out_sla_count++}},value:function(t){var a=this;if(t)return this.rec_set;var n=[];return e.userData.pivot.performance.forEach((function(e,t){e.show&&n.push({id:e.id,name:e.name,value:a[e.value],hide_baseline:e.hide_baseline,hide_forecast:e.hide_forecast,show_progress:e.show_progress,show_percents:e.show_percents,last_value:a[e.last_value],width:"auto"!==e.width?parseInt(e.width):e.width,baseline:a[e.baseline],forecast:a[e.forecast],scope:a[e.scope],value_format:{"font-size":e.value_format.font_size,"font-family":e.value_format.font_family,fill:e.value_format.fill,"font-weight":e.value_format.font_weight,"font-style":e.value_format.font_style,opacity:e.value_format.opacity,"text-anchor":e.value_format["text-anchor"]},label_format:{"font-size":e.label_format.font_size,"font-family":e.label_format.font_family,fill:e.label_format.fill,"font-weight":e.label_format.font_weight,"font-style":e.label_format.font_style,opacity:e.label_format.opacity,"text-anchor":e.label_format["text-anchor"]}})})),n},format:t||n.hm,numInputs:1}}},"Rating as Count in Rows":n.BJ.rateOf(n.BJ.count(),"row",t||n.hm),"Rating as Count in Columns":n.BJ.rateOf(n.BJ.count(),"col",t||n.hm),"Count Unique Values":n.BJ.countUnique(t||n.hm),"List Unique Values":function(e,t,a){var n;return n=e[0],function(e,i,r){return{uniq:[],count:0,push:function(e){var t,a,i,r,s;if(e[n]&&this.count++,t=e[n],o.call(this.uniq,t)<0)return t instanceof Date?this.uniq.push((i=""+((a=new Date(t)).getMonth()+1),r=""+a.getDate(),s=a.getFullYear(),i.length<2&&(i="0"+i),r.length<2&&(r="0"+r),[s,i,r].join("-"))):this.uniq.push(e[n])},value:function(){return i.length?r.length?this.uniq.join("; "):"count"===t?this.count:this.uniq.length:"count"===a?this.count:this.uniq.length},format:function(e){return e},numInputs:null!=n?0:1}}},Sum:n.BJ.sum(t||n._O),"Integer Sum":n.BJ.sum(t||n.hm),Minimum:n.BJ.min(t||n._O),Maximum:n.BJ.max(t||n._O),"Sum over Sum":n.BJ.sumOverSum(t||n._O),"Count over Count":function(e){var a,o;return o=e[0],a=e[1],function(e,i,r){return{sumNum:0,sumDenom:0,push:function(e){if(isNaN(parseFloat(e[o]))||this.sumNum++,!isNaN(parseFloat(e[a])))return this.sumDenom++},value:function(){return this.sumNum/this.sumDenom},format:t||n._O,numInputs:null!=o&&null!=a?0:2}}},"80% Upper Bound":n.BJ.sumOverSumBound80(!0,t||n._O),"80% Lower Bound":n.BJ.sumOverSumBound80(!1,t||n._O),"Sum as Fraction of Total":n.BJ.fractionOf(n.BJ.sum(),"total",t||n.Bv),"Sum as Fraction of Rows":n.BJ.fractionOf(n.BJ.sum(),"row",t||n.Bv),"Sum as Fraction of Columns":n.BJ.fractionOf(n.BJ.sum(),"col",t||n.Bv),"Count as Fraction of Total":n.BJ.fractionOf(n.BJ.count(),"total",t||n.Bv),"Count as Fraction of Rows":n.BJ.fractionOf(n.BJ.count(),"row",t||n.Bv),"Count as Fraction of Columns":n.BJ.fractionOf(n.BJ.count(),"col",t||n.Bv)}}function Qe(e,t,a){return{"text-anchor":"start","font-size":e.font_size||a.font_size,"font-family":e.font_family||a.font_family,fill:e.font_color||t,"font-weight":e.font_weight||a.font_weight,"font-style":e.font_style||a.font_style}}function Ye(e,t){var a=null;return t.getInputPorts().data.forEach((function(t){t.getId()===e&&(a=t)})),a}function Xe(e,t){var a=null;return t.getOutputPorts().data.forEach((function(t){t.getId()===e&&(a=t)})),a}function Ke(e){return"baseline"===e?"BL":"forecast"===e||"forecast end"===e||"forecast_end"===e||"forecastend"===e||"fcst end"===e?"FE":"actual"===e||"actual end"===e||"actual_end"===e||"actualend"===e||"act end"===e?"AE":"forecast start"===e||"forecast_start"===e||"forecaststart"===e||"fcst strt"===e?"FS":"actual start"===e||"actual_start"===e||"actualstart"===e||"act strt"===e?"AS":e}function Ze(e){var t={},a=[];if(e.params)if("string"==typeof e.params)try{e.params=JSON.parse(e.params)}catch(t){console.error("Failed to parse data.params as JSON:",t),e.params=[]}else Array.isArray(e.params)||(e.params=[]);else e.params=[];return e.params.forEach((function(n,o){"value"===n.prop_type?e.row.forEach((function(e){e.item_name===n.param_source&&(void 0!==n.prop_key?"string"==typeof e[n.param_details]?t[n.param_name]=e[n.param_details]:t[n.param_name]=e[n.param_details][n.prop_key]:t[n.param_name]=e[n.param_details])})):"list"===n.prop_type&&e.row.forEach((function(o){o.item_name===n.param_source&&(n.full_data?t[n.param_name]=o.sites_list_out:(void 0!==n.prop_key&&(a=o[n.param_details]),e.useListAsList?(a.length||(t[n.param_name]="''"),a.forEach((function(e,a){0===a?n.is_clean?t[n.param_name]=e[n.prop_key]:t[n.param_name]="'"+e[n.prop_key]+"'":n.is_clean?t[n.param_name]=result_str+", "+e[n.prop_key]:t[n.param_name]=result_str+", '"+e[n.prop_key]+"'"}))):t[n.param_name]=a))}))})),t}function $e(e,t,a){for(var n=0,o=0,i=0,r=0,s="",l=["number"],c=e;i<=o;){for(;-1!==e.indexOf("::",n);){n=e.indexOf("::",n),-1===(r=e.indexOf(" ",n))&&(r=e.length),s=(s=e.substr(n+1,r-n)).replace(/\W/g,"");var u="",d=[];l.indexOf(s)<0?(t.params.forEach((function(a,n){a.param_name===s&&("value"===a.prop_type?t.row.forEach((function(e){e.item_name===a.param_source&&(u=void 0!==a.prop_key?"string"==typeof e[a.param_details]?e[a.param_details]:e[a.param_details][a.prop_key]:e[a.param_details])})):"list"===a.prop_type&&(a.repeat?t.row.forEach((function(e){e.item_name===a.param_source&&void 0!==a.prop_key&&(d=e[a.param_details],o=d.length-1,u=d.length?d[i][a.prop_key]:"''")})):t.row.forEach((function(e){e.item_name===a.param_source&&(void 0!==a.prop_key&&(d=e[a.param_details]),d.length||(u="''"),d.forEach((function(e,t){u=0===t?a.is_clean?e[a.prop_key]:"'"+e[a.prop_key]+"'":a.is_clean?u+", "+e[a.prop_key]:u+", '"+e[a.prop_key]+"'"})))}))),e=e.replace("::"+s,u))})),t.lookups.forEach((function(t,a){t.param_name===s&&(t.result.value&&(u=t.result.value),e=e.replace("::"+s,u))}))):u=s,n+=u.length}++i<=o&&(e=a?e+"\n union all CORRESPONDING \n"+c:e+"\n union all\n"+c)}return e}function et(e,t){if(!e||"string"!=typeof e)throw new Error("Prompt must be a non-empty string");if(null==t||!t.params||!Array.isArray(t.params)||null==t||!t.row)throw new Error("Invalid data structure provided");var a=new Set(["number"]),n=new Map(t.row.map((function(e){return[e.item_name,e]}))),o=new Map(t.params.map((function(e){return[e.param_name,e]})));try{return e.replace(/::\w+/g,(function(e){return function(e){if(a.has(e))return e;var t=o.get(e);if(!t)return":".concat(e);var i=n.get(t.param_source);if(!i)return"";if("value"===t.prop_type)return function(e,t){if(!t||!t[e.param_details])return"";if(void 0!==e.prop_key){var a=t[e.param_details];return"string"==typeof a?a:a[e.prop_key]}return t[e.param_details]}(t,i);if("list"===t.prop_type){if(t.full_data)return JSON.stringify(i.sites_list_out||[]);var r=i[t.param_details];return Array.isArray(r)?r.map((function(e){return t.prop_key?e[t.prop_key]:e})).filter(Boolean).join(", "):""}return""}(e.slice(2))}))}catch(e){throw new Error("Error processing prompt: ".concat(e.message))}}function tt(e){var t,a={},n=[];return e.params.forEach((function(o,i){o.disabled||("value"===o.prop_type?e.row.forEach((function(e){e.item_name===o.param_source&&(t=void 0!==o.prop_key?"string"==typeof e[o.param_details]?""+e[o.param_details]:""+e[o.param_details][o.prop_key]:""+e[o.param_details])})):"list"===o.prop_type?e.row.forEach((function(e){e.item_name===o.param_source&&(void 0!==o.prop_key&&(n=e[o.param_details]),n.length||(t=""),n.forEach((function(e,a){t=0===a?""+e[o.prop_key]:t+", "+e[o.prop_key]})))})):o.param_name&&o.value&&(t=o.value),a[o.param_name]=t)})),e.lookups&&e.lookups.forEach((function(e,n){e.param_name===substr&&(e.result.value&&(t=e.result.value),a[e.param_name]=t)})),a}function at(e){var t=e.indexOf(",")>-1?",":" ",a=(e=e.substr(4).split(")")[0].split(t))[0],n=e[1],o=e[2];a.indexOf("deg")>-1?a=a.substr(0,a.length-3):a.indexOf("rad")>-1?a=Math.round(a.substr(0,a.length-3)*(180/Math.PI)):a.indexOf("turn")>-1&&(a=Math.round(360*a.substr(0,a.length-4))),a>=360&&(a%=360);var i=(1-Math.abs(2*o-1))*n,r=i*(1-Math.abs(a/60%2-1)),s=o-i/2,l=0,c=0,u=0;return 0<=a&&a<60?(l=i,c=r,u=0):60<=a&&a<120?(l=r,c=i,u=0):120<=a&&a<180?(l=0,c=i,u=r):180<=a&&a<240?(l=0,c=r,u=i):240<=a&&a<300?(l=r,c=0,u=i):300<=a&&a<360&&(l=i,c=0,u=r),"rgb("+(l=Math.round(255*(l+s)))+","+(c=Math.round(255*(c+s)))+","+(u=Math.round(255*(u+s)))+")"}function nt(e){if(0===e.length)return 0;e.sort((function(e,t){return e-t}));var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}function ot(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}function it(e){var t={};if(e.colors.monochromatic){t.color=[];for(var a=0;a<=20;a++)t.color[a]=e.colors.mono_base_color;t.opacity=[1,.85,.7,.55,.4,.25,1,.85,.7,.55,.4,.25,1,.85,.7,.55,.4,.25,1,.85,.7,.55,.4,.25,1,.85,.7,.55,.4,.25,1,.85,.7,.55,.4,.25]}else for(e.colors.colors_array&&e.colors.colors_array.length?t.color=e.colors.colors_array:t.color=["hsl("+[0,.6,.4]+")","hsl("+[.1,.6,.5]+")","hsl("+[.35,.6,.4]+")","hsl("+[.55,.6,.4]+")","hsl("+[.7,.6,.4]+")","hsl("+[.8,.6,.4]+")","hsl("+[.9,.6,.4]+")","hsl("+[.25,.6,.4]+")","hsl("+[.5,.6,.4]+")","hsl("+[.05,.6,.4]+")","hsl("+[.15,.6,.5]+")","hsl("+[.3,.6,.4]+")","hsl("+[.5,.6,.4]+")","hsl("+[.75,.6,.4]+")","hsl("+[.85,.6,.4]+")","hsl("+[.95,.6,.4]+")","hsl("+[.2,.6,.4]+")","hsl("+[.55,.6,.4]+")","hsl("+[0,.45,.7]+")","hsl("+[.1,.45,.7]+")","hsl("+[.35,.45,.7]+")","hsl("+[.55,.45,.7]+")","hsl("+[.7,.45,.7]+")","hsl("+[.8,.45,.7]+")","hsl("+[.9,.45,.7]+")","hsl("+[.25,.45,.7]+")","hsl("+[.5,.45,.7]+")","hsl("+[.05,.45,.7]+")","hsl("+[.15,.45,.7]+")","hsl("+[.3,.45,.7]+")","hsl("+[.5,.45,.7]+")","hsl("+[.75,.45,.7]+")","hsl("+[.85,.45,.7]+")","hsl("+[.95,.45,.7]+")","hsl("+[.2,.45,.7]+")","hsl("+[.55,.45,.7]+")"],t.opacity=[],a=0;a<=20;a++)t.opacity[a]=.8;return t}function rt(e){e.forEach((function(e,t){e.ports&&e.ports.length&&e.ports.forEach((function(e,t){e.userData.sites_list_out=[]})),e.userData.filter&&e.userData.filter.original_list&&e.userData.filter.original_list.length&&(e.userData.filter.original_list=[]),e.userData.sites_list_out&&e.userData.sites_list_out.length&&(e.userData.preserve_data||(e.userData.sites_list_out=[])),e.userData.tasks&&e.userData.tasks.forEach((function(e,t){e.actual&&e.actual.sites_list_out&&e.actual.sites_list_out.length&&(e.actual.sites_list_out=[]),e.forecast&&e.forecast.sites_list_out&&e.forecast.sites_list_out.length&&(e.forecast.sites_list_out=[]),e.baseline&&e.baseline.sites_list_out&&e.baseline.sites_list_out.length&&(e.baseline.sites_list_out=[]),e.sites_list_out&&(e.sites_list_out=[])})),e.userData.actual&&e.userData.actual.sites_list_out&&e.userData.actual.sites_list_out.length&&(e.userData.actual.sites_list_out=[]),e.userData.forecast&&e.userData.forecast.sites_list_out&&e.userData.forecast.sites_list_out.length&&(e.userData.forecast.sites_list_out=[]),e.userData.baseline&&e.userData.baseline.sites_list_out&&e.userData.baseline.sites_list_out.length&&(e.userData.baseline.sites_list_out=[]),e.userData.xAxis&&e.userData.xAxis.data.length&&(e.userData.xAxis.data=[]),e.userData.yAxis&&e.userData.xAxis.data.length&&(e.userData.xAxis.data=[]),e.userData.col&&e.userData.col.length&&e.userData.col.forEach((function(e,t){e.sites_list_out&&e.sites_list_out.length&&(e.sites_list_out=[]),e.serie&&e.serie.data&&e.serie.data.length&&(e.serie.data=[])})),e.userData.row&&e.userData.row.length&&e.userData.row.forEach((function(e,t){e.sites_list_out&&e.sites_list_out.length&&(e.sites_list_out=[])})),e.userData.rowsToRepeat&&e.userData.rowsToRepeat.length&&e.userData.rowsToRepeat.forEach((function(e,t){e.sites_list_out&&e.sites_list_out.length&&(e.sites_list_out=[])}))}))}function st(){return(new Date).getTime()}function lt(e){for(var t="",a=0;a<e;a++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t}function ct(e,t,a){var n=(new TextEncoder).encode(e);return crypto.subtle.digest("SHA-256",n).then((function(e){var n=Array.from(new Uint8Array(e)).map((function(e){return e.toString(16).padStart(2,"0")})).join("");PIVOT_DEBUG&&console.log("Encripted Signature: "+n.toUpperCase()),t(n.toUpperCase(),a)}))}function ut(e,t,a,n){var o=function(){this.super("constructor").apply(this,arguments)};return DatabaseSearchTreemaNode.extend(o),o.prototype.url=e,o.prototype.formatDocument=function(e){return(e.du_model_name?e.du_model_name+" ":"")+e.scope_task_code+" "+e.scope_task_name},o.prototype.formatDocumentView=function(e){return e.scope_task_code+" "+e.scope_task_name},o.prototype.buildValueForDisplay=function(e,t){var a;return a=t?this.formatDocumentView(t):"None",this.buildValueForDisplaySimply(e,a)},o.prototype.search=function(){var t;if((t=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!t&&this.getSearchResultsEl().empty(),t)){this.lastTerm=t,this.getSearchResultsEl().empty().append("Searching");var a=this.searchCallback;T.ajax({url:e,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(n),success:function(e){var n=e.data?e.data:e,o=(new C).from(n).where((function(e,a){return-1!==e.du_model_name.toLowerCase().indexOf(t.toLowerCase())||-1!==e.scope_task_code.toLowerCase().indexOf(t.toLowerCase())||-1!==e.scope_task_name.toLowerCase().indexOf(t.toLowerCase())})).select();a(o)}})}},o.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data||(this.data={scope_task_id:"",scope_task_code:"",scope_task_name:""}),this.data.scope_task_id=e.data("value").scope_task_id,this.data.scope_task_code=e.data("value").scope_task_code,this.data.scope_task_name=e.data("value").scope_task_name,a&&t.GetHTTPData())},o.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==(i.du_model_name+i.scope_task_name+i.scope_task_code).toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},o}function dt(e,t,a,n){var o=function(){this.super("constructor").apply(this,arguments)};return DatabaseSearchTreemaNode.extend(o),o.prototype.url=e,o.prototype.formatDocument=function(e){return(e.du_model_name?e.du_model_name+" ":"")+e.task_code+" "+e.task_name},o.prototype.formatDocumentView=function(e){return e.task_code+" "+e.task_name},o.prototype.buildValueForDisplay=function(e,t){var a;return a=t?this.formatDocumentView(t):"None",this.buildValueForDisplaySimply(e,a)},o.prototype.search=function(){var t;if((t=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!t&&this.getSearchResultsEl().empty(),t)){this.lastTerm=t,this.getSearchResultsEl().empty().append("Searching");var a=this.searchCallback;T.ajax({url:e,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(n),success:function(e){var n=e.data?e.data:e,o=(new C).from(n).where((function(e,t){return e.task_code&&e.task_name})).select();o=(new C).from(o).where((function(e,a){return-1!==e.du_model_name.toLowerCase().indexOf(t.toLowerCase())||-1!==e.task_code.toLowerCase().indexOf(t.toLowerCase())||-1!==e.task_name.toLowerCase().indexOf(t.toLowerCase())})).select(),a(o)}})}},o.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data||(this.data={scope_task_id:"",task_code:"",task_name:""}),this.data.scope_task_id=e.data("value").scope_task_id,this.data.task_code=e.data("value").task_code,this.data.task_name=e.data("value").task_name,a&&t.GetHTTPData())},o.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==(i.du_model_name+i.task_name+i.task_code).toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},o}function pt(e){var t=function(){var t=function(){this.super("constructor").apply(this,arguments)};TreemaNode.extend(t);var a=t;return t.prototype.formatDocument=function(e){return e},t.prototype.buildValueForDisplay=function(e,t){var a;return a=t?this.formatDocument(t):"None",this.buildValueForDisplaySimply(e,a)},t.prototype.buildValueForEditing=function(t,n){var o,i,r,s,l,c,u=[];for(e.userData.row.forEach((function(e,t){u.push(e.item_name)})),a.enum=u,i=T("<select></select>"),s=0,l=(c=a.enum).length;s<l;s++)r=c[s],i.append(T("<option></option>").text(r));return(o=a.enum.indexOf(n))>=0&&i.prop("selectedIndex",o),t.append(i),i.focus(),i.blur(a.onEditInputBlur),i},t.prototype.saveChanges=function(e){var t;return t=e.find("select").prop("selectedIndex"),this.addTrackedAction({oldData:this.data,newData:a.enum[t],path:this.getPath(),action:"edit"}),this.data=a.enum[t],TreemaNode.changedTreemas.push(this),this.broadcastChanges()},t}();TreemaNode.setNodeSubclass("param_source",t)}function ht(e){var t=function(){var t=function(){this.super("constructor").apply(this,arguments)};TreemaNode.extend(t);var a=t;return t.prototype.formatDocument=function(e){return e},t.prototype.buildValueForDisplay=function(e,t){var a;return a=t?this.formatDocument(t):"None",this.buildValueForDisplaySimply(e,a)},t.prototype.buildValueForEditing=function(t,n){var o,i,r,s,l,c,u=this.parent.data.param_source,d=[];for(e.userData.row.forEach((function(e,t){if(e.item_name===u)for(var a in e)d.push(a)})),a.enum=d,i=T("<select></select>"),s=0,l=(c=a.enum).length;s<l;s++)r=c[s],i.append(T("<option></option>").text(r));return(o=a.enum.indexOf(n))>=0&&i.prop("selectedIndex",o),t.append(i),i.focus(),i.blur(a.onEditInputBlur),i},t.prototype.saveChanges=function(t){var n;n=t.find("select").prop("selectedIndex"),this.addTrackedAction({oldData:this.data,newData:a.enum[n],path:this.getPath(),action:"edit"}),this.data=a.enum[n];var o=this.parent.data,i=o.param_source,r=this.data;return e.userData.row.forEach((function(t,a){t.item_name===i&&(null!==t[r]&&"string"==typeof t[r]?e.userData.params.forEach((function(e,t){e.param_name===o.param_name&&(e.prop_type="value")})):null===t[r]||"object"!==z(t[r])||t[r]instanceof Array?t[r]instanceof Array&&e.userData.params.forEach((function(e,t){e.param_name===o.param_name&&(e.prop_type="list")})):e.userData.params.forEach((function(e,t){e.param_name===o.param_name&&(e.prop_type="value")})))})),TreemaNode.changedTreemas.push(this),this.broadcastChanges()},t}();TreemaNode.setNodeSubclass("param_details",t)}function ft(e){var t=function(){var t=function(){this.super("constructor").apply(this,arguments)};TreemaNode.extend(t);var a=t;return t.prototype.formatDocument=function(e){return e},t.prototype.buildValueForDisplay=function(e,t){var a;return a=t?this.formatDocument(t):"None",this.buildValueForDisplaySimply(e,a)},t.prototype.buildValueForEditing=function(t){var n,o,i,r,s,l,c=this.parent.data.param_source,u=this.parent.data.param_details,d=this.parent.data,p=[];for(e.userData.row.forEach((function(e,t){if(void 0!==u&&e.item_name===c)if("string"==typeof e[u])p.push(e[u]);else if(void 0!==e[u][0])for(var a in e[u][0])p.push(a);else if(null!==e[u]&&"object"===z(e[u]))for(var a in e[u])p.push(a)})),a.enum=p,o=T("<select></select>"),r=0,s=(l=a.enum).length;r<s;r++)i=l[r],o.append(T("<option></option>").text(i));return(n=a.enum.indexOf(d))>=0&&o.prop("selectedIndex",n),t.append(o),o.focus(),o.blur(a.onEditInputBlur),o},t.prototype.saveChanges=function(e){var t;return t=e.find("select").prop("selectedIndex"),this.addTrackedAction({oldData:this.data,newData:a.enum[t],path:this.getPath(),action:"edit"}),this.data=a.enum[t],TreemaNode.changedTreemas.push(this),this.broadcastChanges()},t}();TreemaNode.setNodeSubclass("prop_key",t)}function mt(){var e,t,a,n=P.context+"/data/natural",o=JSON.stringify({sql:"SELECT table_name FROM information_schema.tables where TABLE_SCHEMA='epms'"}),i=(t=n,a=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.prototype.searchValueTemplate='<input placeholder="Search" /><div class="treema-search-results"></div>',DatabaseSearchTreemaNode.extend(a),a.prototype.url=t,a.prototype.formatDocument=function(e){return e.table_name},a.prototype.buildValueForEditing=function(e,t){var a;if(e.html(this.searchValueTemplate),(a=e.find("input")).focus().keyup(this.search),t)return a.attr("placeholder",this.formatDocument(t))},a.prototype.search=function(){var a;if((a=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!a&&this.getSearchResultsEl().empty(),a)){this.lastTerm=a,this.getSearchResultsEl().empty().append("Searching");var n,i=this.searchCallback;e?(n=(new C).from(e).where((function(e,t){return-1!==e.table_name.toLowerCase().indexOf(a.toLowerCase())})).select(),i(n)):T.ajax({url:t,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:o,success:function(t){var n=t.data?t.data:t;e=n;var o=(new C).from(n).where((function(e,t){return-1!==e.table_name.toLowerCase().indexOf(a.toLowerCase())})).select();i(o)}})}},a.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data={table_name:e.data("value").table_name})},a.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.table_name.toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},a);TreemaNode.setNodeSubclass("lookup_source",i)}function gt(){var e,t,a,n=P.context+"/data/natural",o=(t=n,a=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.prototype.searchValueTemplate='<input placeholder="Search" /><div class="treema-search-results"></div>',DatabaseSearchTreemaNode.prototype.buildValueForEditing=function(e,t){var a;if(e.html(this.searchValueTemplate),(a=e.find("input")).focus().keyup(this.search),t)return a.attr("placeholder",this.formatDocument(t))},DatabaseSearchTreemaNode.extend(a),a.prototype.url=t,a.prototype.formatDocument=function(e){return e.column_name},a.prototype.search=function(){var a;if((a=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!a&&this.getSearchResultsEl().empty(),a)){this.lastTerm=a,this.getSearchResultsEl().empty().append("Searching");var n=this.searchCallback,o=this.parent.data.param_source.table_name,i=JSON.stringify({sql:"SELECT column_name FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = 'epms' AND TABLE_NAME = '"+o+"'"});if(e){var r=(new C).from(e).where((function(e,t){return-1!==e.column_name.toLowerCase().indexOf(a.toLowerCase())})).select();n(r)}else T.ajax({url:t,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:i,success:function(t){var o=t.data?t.data:t;e=o;var i=(new C).from(o).where((function(e,t){return-1!==e.column_name.toLowerCase().indexOf(a.toLowerCase())})).select();n(i)}})}},a.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data={column_name:e.data("value").column_name})},a.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.column_name.toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},a);TreemaNode.setNodeSubclass("lookup_key",o)}function yt(){var e,t,a,n=P.context+"/data/natural",o=(t=n,a=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.prototype.searchValueTemplate='<input placeholder="Search" /><div class="treema-search-results"></div>',DatabaseSearchTreemaNode.prototype.buildValueForEditing=function(e,t){var a;if(e.html(this.searchValueTemplate),(a=e.find("input")).focus().keyup(this.search),t)return a.attr("placeholder",this.formatDocument(t))},DatabaseSearchTreemaNode.extend(a),a.prototype.url=t,a.prototype.formatDocument=function(e){return e.column_name},a.prototype.search=function(){var a;if((a=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!a&&this.getSearchResultsEl().empty(),a)){this.lastTerm=a,this.getSearchResultsEl().empty().append("Searching");var n=this.searchCallback,o=this.parent.data.param_source.table_name,i=JSON.stringify({sql:"SELECT column_name FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = 'epms' AND TABLE_NAME = '"+o+"'"});if(e){var r=(new C).from(e).where((function(e,t){return-1!==e.column_name.toLowerCase().indexOf(a.toLowerCase())})).select();n(r)}else T.ajax({url:t,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:i,success:function(t){var o=t.data?t.data:t;e=o;var i=(new C).from(o).where((function(e,t){return-1!==e.column_name.toLowerCase().indexOf(a.toLowerCase())})).select();n(i)}})}},a.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data={column_name:e.data("value").column_name})},a.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.column_name.toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},a);TreemaNode.setNodeSubclass("prop_value",o)}function _t(){var e,t,a,n=P.context+"/data/natural",o=(t=n,a=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.prototype.searchValueTemplate='<input placeholder="Search" /><div class="treema-search-results"></div>',DatabaseSearchTreemaNode.prototype.buildValueForEditing=function(e,t){var a;if(e.html(this.searchValueTemplate),(a=e.find("input")).focus().keyup(this.search),t)return a.attr("placeholder",this.formatDocument(t))},DatabaseSearchTreemaNode.extend(a),a.prototype.url=t,a.prototype.formatDocument=function(e){return e.key},a.prototype.search=function(){var a;if((a=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!a&&this.getSearchResultsEl().empty(),a)){this.lastTerm=a,this.getSearchResultsEl().empty().append("Searching");var n=this.searchCallback,o=this.parent.data.param_source.table_name,i=this.parent.data.key.column_name,r=this.parent.data.value.column_name,s=JSON.stringify({sql:"SELECT "+i+" as `key`, "+r+" as value FROM `"+o+"`"});if(e){var l=(new C).from(e).where((function(e,t){return-1!==e.key.toLowerCase().indexOf(a.toLowerCase())})).select();n(l)}else T.ajax({url:t,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:s,success:function(t){var o=t.data?t.data:t;e=o;var i=(new C).from(o).where((function(e,t){return-1!==e.key.toLowerCase().indexOf(a.toLowerCase())})).select();n(i)}})}},a.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data={value:e.data("value").value,key:e.data("value").key})},a.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.key.toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},a);TreemaNode.setNodeSubclass("prop_result",o)}function bt(){var e=["CREATE","DROP","ALTER","TRUNCATE","DELETE","INSERT","UPDATE","ATTACH","DETACH","LOAD","SAVE","BACKUP","RESTORE","INTO","FILESTORAGE","LOCALSTORAGE","INDEXEDDB","FILE","CSV","XLSX","XLS","HTML","JSON","HTTP","FTP","HTTPS","WWW"],t=["SELECT","FROM","WHERE","GROUP BY","HAVING","ORDER BY","LIMIT","OFFSET","JOIN","INNER JOIN","LEFT JOIN","RIGHT JOIN","ON","AS","AND","OR","NOT","IN","BETWEEN","LIKE","COUNT","SUM","AVG","MIN","MAX","DISTINCT"];return{query:function(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=function(a){for(var n=a.toUpperCase(),o=0,i=e;o<i.length;o++){var r=i[o];if(n.includes(r))throw new Error("Dangerous keyword detected: ".concat(r))}var s,l=function(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=O(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw i}}}}(n.replace(/[^a-zA-Z\s]/g," ").split(/\s+/).filter((function(e){return e.length>2})));try{for(l.s();!(s=l.n()).done;){var c=s.value;if(!t.includes(c)&&!c.match(/^[0-9]+$/)&&!c.match(/^[A-Z_]+$/))throw new Error("Unauthorized keyword or operation: ".concat(c))}}catch(e){l.e(e)}finally{l.f()}return a}(a),i=function(e){if(!Array.isArray(e))throw new Error("Parameters must be an array");return e.map((function(e){return Array.isArray(e)?e.map((function(e){return"object"===z(e)&&null!==e?JSON.parse(JSON.stringify(e)):e})):"object"===z(e)&&null!==e?JSON.parse(JSON.stringify(e)):e}))}(n);try{var r=I(o,i);return JSON.parse(JSON.stringify(r))}catch(e){throw new Error("Query execution error: ".concat(e.message))}},version:I.version,fn:I.fn,aggr:I.aggr,options:I.options}}function vt(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{Object.assign((function(){return i().apply(void 0,arguments)}),{isMoment:i().isMoment.bind(i()),isDate:i().isDate.bind(i()),unix:i().unix.bind(i()),utc:i().utc.bind(i()),parseZone:i().parseZone.bind(i())});var o=bt(),d={userData:t?t.userData:null},p=m({maxTimers:5,maxDelay:5e3,maxCallbacks:20}),h=(function(){var e=["/fbr/mongo/getUserReports","/fbr/apidata/getAPIData"];function t(e){if("string"==typeof e&&["script","link","style","iframe","object","embed","form"].some((function(t){return e.toLowerCase().includes(t)})))throw new Error("Unsafe selector blocked");var a=D(e),n=Object.create(null);Object.defineProperty(n,"length",{get:function(){return a.length}});var o={find:function(e){return t(a.find(e))},filter:function(e){return t(a.filter(e))},first:function(){return t(a.first())},last:function(){return t(a.last())},eq:function(e){return t(a.eq(e))},parent:function(e){return t(a.parent(e))},parents:function(e){return t(a.parents(e))},parentsUntil:function(e,n){return t(a.parentsUntil(e,n))},children:function(e){return t(a.children(e))},siblings:function(e){return t(a.siblings(e))},next:function(e){return t(a.next(e))},nextAll:function(e){return t(a.nextAll(e))},nextUntil:function(e,n){return t(a.nextUntil(e,n))},prev:function(e){return t(a.prev(e))},prevAll:function(e){return t(a.prevAll(e))},prevUntil:function(e,n){return t(a.prevUntil(e,n))},closest:function(e){return t(a.closest(e))},on:function(e,t,o,i){return a.on(e,t,o,i),n},off:function(e,t,o){return a.off(e,t,o),n},one:function(e,t,o,i){return a.one(e,t,o,i),n},trigger:function(e,t){return a.trigger(e,t),n},addClass:function(e){return a.addClass(e),n},removeClass:function(e){return a.removeClass(e),n},toggleClass:function(e,t){return a.toggleClass(e,t),n},hasClass:function(e){return a.hasClass(e)},attr:function(e,t){return void 0===t?a.attr(e):(a.attr(e,t),n)},removeAttr:function(e){return a.removeAttr(e),n},prop:function(e,t){return void 0===t?a.prop(e):(a.prop(e,t),n)},css:function(e,t){return"object"===z(e)||void 0!==t?(a.css(e,t),n):a.css(e)},show:function(){return a.show(),n},hide:function(){return a.hide(),n},toggle:function(e){return a.toggle(e),n},width:function(e){return void 0===e?a.width():(a.width(e),n)},height:function(e){return void 0===e?a.height():(a.height(e),n)},innerWidth:function(){return a.innerWidth()},innerHeight:function(){return a.innerHeight()},outerWidth:function(e){return a.outerWidth(e)},outerHeight:function(e){return a.outerHeight(e)},text:function(e){return void 0===e?a.text():(a.text(e),n)},html:function(e){if(void 0===e)return a.html();var t=DOMPurify?DOMPurify.sanitize(e):e;return a.html(t),n},val:function(e){return void 0===e?a.val():(a.val(e),n)},empty:function(){return a.empty(),n},each:function(e){return a.each((function(t){e.call(this,t,this)})),n},map:function(e){return a.map((function(t,a){return e.call(this,t,a)})).get()},data:function(e,t){return void 0===t&&"object"!==z(e)?a.data(e):(a.data(e,t),n)},removeData:function(e){return a.removeData(e),n},fadeIn:function(e,t){return a.fadeIn(e,t),n},fadeOut:function(e,t){return a.fadeOut(e,t),n},fadeToggle:function(e,t){return a.fadeToggle(e,t),n},slideDown:function(e,t){return a.slideDown(e,t),n},slideUp:function(e,t){return a.slideUp(e,t),n},slideToggle:function(e,t){return a.slideToggle(e,t),n},is:function(e){return a.is(e)},index:function(e){return a.index(e)},get:function(e){return a.get(e)},toArray:function(){return a.toArray()}};return Object.assign(n,o),Object.freeze(n)}t.ajax=function(){var t,a=(t=R().m((function t(a){var n,o,i,r,s,l,c,u,d;return R().w((function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,a.url){t.n=1;break}throw new Error("URL is required");case 1:if(n=new URL(a.url,window.location.origin),e.some((function(e){return n.pathname===e}))){t.n=2;break}throw new Error("URL not in allowed endpoints");case 2:if(n.origin===window.location.origin){t.n=3;break}throw new Error("Cross-origin requests are not allowed");case 3:if(o=["GET","POST"],i=(a.method||"GET").toUpperCase(),o.includes(i)){t.n=4;break}throw new Error("Invalid HTTP method");case 4:if(r=["application/json","application/json; charset=utf-8","application/x-www-form-urlencoded"],!a.contentType||r.includes(a.contentType)){t.n=5;break}throw new Error("Invalid content type");case 5:return(s=a.data)&&("object"===z(s)?(s=JSON.parse(JSON.stringify(s)),(l=function(e){for(var t in e)"object"===z(e[t])&&null!==e[t]?l(e[t]):"string"==typeof e[t]&&(e[t]=e[t].replace(/[<>'"&]/g,""))})(s)):"string"==typeof s&&(s=s.replace(/[<>'"&]/g,""))),c=U(U({},a),{},{url:a.url,method:i,data:JSON.stringify(s),contentType:a.contentType||"application/json",headers:U({"X-Requested-With":"XMLHttpRequest"},a.headers||{})}),a.xhrFields&&(c.xhrFields=a.xhrFields),t.n=6,D.ajax(c);case 6:if("string"!=typeof(u=t.v)){t.n=7;break}if(!/<script|javascript:|data:/i.test(u)){t.n=7;break}throw new Error("Invalid response content");case 7:return a.success&&"function"==typeof a.success&&a.success(u),t.a(2,u);case 8:throw t.p=8,d=t.v,a.error&&"function"==typeof a.error&&a.error(d),d;case 9:return t.p=9,a.complete&&"function"==typeof a.complete&&a.complete(),t.f(9);case 10:return t.a(2)}}),t,null,[[0,8,9,10]])})),function(){var e=this,a=arguments;return new Promise((function(n,o){var i=t.apply(e,a);function r(e){B(i,n,o,r,s,"next",e)}function s(e){B(i,n,o,r,s,"throw",e)}r(void 0)}))});return function(e){return a.apply(this,arguments)}}(),t.fn=D.fn,t.trim=D.trim,t.isNumeric=D.isNumeric,t.type=D.type,Object.freeze(t)}(),{log:console.log.bind(console),error:console.error.bind(console),warn:console.warn.bind(console)}),f=(document.title,document.readyState,document.doctype,{self:void 0,globalThis:void 0,global:void 0,top:void 0,parent:void 0,frames:void 0,location:void 0,history:void 0,HTMLElement:void 0,Element:void 0,Node:void 0,localStorage:void 0,sessionStorage:void 0,indexedDB:void 0,fetch:void 0,XMLHttpRequest:void 0,WebSocket:void 0,Function:void 0,constructor:void 0,eval:void 0,process:void 0,require:void 0,crypto:void 0,Reflect:void 0,Proxy:void 0,Worker:void 0,SharedWorker:void 0,ServiceWorker:void 0,__proto__:void 0,prototype:void 0}),g=Object.keys(n),y=Object.values(n),v=/^ *function|^.*= *function|^ *\(.+?\) *=>|^.*=>|^.* *=>/i.test(e.trim()),w="\n            with (Object.create(null)) {\n                ".concat(Object.entries(f).map((function(e){var t,a,n=(a=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(t,a)||O(t,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0];return n[1],"const ".concat(o," = undefined;")})).join("\n"),"\n\n                return ").concat(v?"(".concat(e,")()"):"(()=>{".concat(e,"})()"),";\n            }\n        ");!function(e){x=e,"undefined"!=typeof window&&(window.currentMathNodeFigure=e)}(t);var S=["moment","console","alasql","figure","setTimeout","clearTimeout","vega","vl","echarts","d3","Tabulator","zip","_","Chart","initFilter"].concat(g,[w]),C=function(e,t,a){if(M())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,t);var o=new(e.bind.apply(e,n));return a&&N(o,a.prototype),o}(Function,function(e){if(Array.isArray(e))return j(e)}(a=S)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||O(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),T=(window.fb_exchange,function(){p.destroy(),x=null,"undefined"!=typeof window&&(window.currentMathNodeFigure=null)});try{return{success:!0,result:C.call.apply(C,[void 0,i(),h,o,d,p.setTimeout,p.clearTimeout,r,l,s,c,u.mu,q,_(),b.Ay,k].concat(y)),timerStats:p.getStats(),cleanup:T}}catch(e){return T(),{success:!1,error:e.message,cleanup:T}}}catch(e){return{success:!1,error:e.message}}}function wt(e){try{var t=document.createElement("style"),a=function(e){return e.replace(/\/\*[\s\S]*?\*\//g,"").replace(/@import\s*[^;]*;?/g,"").replace(/javascript:/gi,"").replace(/expression\s*\([^)]*\)/gi,"").replace(/url\s*\(\s*[^)]*\)/gi,(function(e){return/^url\s*\(\s*['"]?[^'"()]+['"]?\s*\)$/i.test(e)?e:""}))}(e),n=document.createTextNode(a);t.appendChild(n);var o="style-"+Math.random().toString(36).substr(2,9);return t.id=o,document.head.appendChild(t),o}catch(e){return console.error("Error injecting styles:",e),null}}function xt(e){var t=document.getElementById(e);return!!t&&(t.remove(),!0)}function kt(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=U(U({},{timeout:12e4,contentType:"application/json",onChunk:function(e){return console.log("Received chunk:",e)},onComplete:function(){return console.log("Stream complete")},onError:function(e){return console.error("Error:",e)},onProgress:function(e){return console.log("Progress:",e)},processChunk:function(e){return e}}),a),o="",i=n.contentType.includes("json")&&"object"===z(t)?JSON.stringify(t):t;T.ajax({url:e,contentType:n.contentType,dataType:"json",type:"POST",data:i,xhrFields:{onprogress:function(e){console.log("on progress");var t=e.currentTarget.response,a=t.slice(o.length);if(o=t,a)try{a.split("\n").filter(Boolean).forEach((function(e){var t=n.processChunk(e);n.onChunk(t)})),console.log("Receiving data...")}catch(e){console.error("Error processing chunk:",e),console.log("Error processing data",!0)}}},success:function(e){if(o.length>0){var t=n.processChunk(o);n.onChunk(t)}n.onComplete(e)},error:function(e,t,a){n.onError({status:e.status,statusText:e.statusText,errorThrown:a})},timeout:n.timeout})}function Dt(e,t){return kt(e,t,U({contentType:!1,processData:!1},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}))}function St(e,t){return kt(e,t,U({contentType:"application/json"},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}))}function Ct(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return kt(e,T.param(t),U({contentType:"application/x-www-form-urlencoded"},a))}function Tt(e,t){if(t.length){var a=T("<div>").text("object"===z(e)?JSON.stringify(e):e);t.append(a),t.scrollTop(t[0].scrollHeight)}}function At(e){return e.replace(/```[\w-]*\n/g,"").replace(/```\s*$/g,"").trim()}var Pt={peninsular:{minLat:1.2,maxLat:6.75,minLong:99.63,maxLong:104.5},eastMalaysia:{minLat:.85,maxLat:7.38,minLong:109.38,maxLong:119.27}};function Et(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={isInMalaysia:!1,region:null};return"number"!=typeof e||"number"!=typeof t||isNaN(e)||isNaN(t)||e<-90||e>90||t<-180||t>180?(n.region="wrong_coordinates",n):e>=Pt.peninsular.minLat&&e<=Pt.peninsular.maxLat&&t>=Pt.peninsular.minLong&&t<=Pt.peninsular.maxLong?(n.isInMalaysia=!0,n.region="Peninsular Malaysia",n):(a&&e>=Pt.eastMalaysia.minLat&&e<=Pt.eastMalaysia.maxLat&&t>=Pt.eastMalaysia.minLong&&t<=Pt.eastMalaysia.maxLong&&(n.isInMalaysia=!0,n.region="East Malaysia"),n)}function It(e){var t=e.match(/```[a-z]*\s*([\s\S]*?)\s*```/);return t?t[1].trim():e}function Nt(e,t,a,n,o,i){var r={};try{var s=localStorage.getItem("fishbone_ai_assistant_config");s&&(r=JSON.parse(s))}catch(e){console.warn("Failed to load AI Assistant config from localStorage:",e)}var l=r.provider||"fbopenai",c=r.model||"gpt-4.1-mini",u=r.temperature||.3;t.AI||(t.AI={}),t.AI[o]||(t.AI[o]={}),DEBUG&&console.log("Original payload:",e);var d=e.text.replace(/^\s+/gm,""),p={messages:[{role:"system",content:"You are an expert AI assistant helping with data visualization and processing. Provide clean, executable code without explanations unless asked."},{role:"user",content:d}],model:c,temperature:u,max_tokens:4e3,provider:l},h=v.A.buildAPIPayload(p);(e.chatUuid||t.AI[o].chatUuid)&&(h.chatUuid=e.chatUuid||t.AI[o].chatUuid||""),(e.chatName||t.AI[o].chatName)&&(h.chatName=e.chatName||t.AI[o].chatName||"");var f=v.A.getEndpointForProvider(l),m="".concat(P.context,"/apiai/").concat(f,"?user_id=").concat(window.user_id);function g(e){if(null!=e&&e.result){var r,s=It(e.result);DEBUG&&console.log("before:"+t.AI[o].current_m_index),DEBUG&&console.log(t.AI[o].messages),a(s),t.updateTable(),t.AI[o].messages?(null!==(r=t.AI)&&void 0!==r&&null!==(r=r[o])&&void 0!==r&&r.messages&&t.AI[o].current_m_index>0&&t.AI[o].current_m_index<t.AI[o].messages.length-1?t.AI[o].messages=t.AI[o].messages.slice(0,t.AI[o].current_m_index-1):t.AI[o].messages.length>1&&(t.AI[o].messages[t.AI[o].current_m_index].content=n),DEBUG&&console.log("after trim:"+t.AI[o].current_m_index),DEBUG&&console.log(t.AI[o].messages),t.AI[o].messages.push({role:"user",content:d,user_input:i})):t.AI[o].messages=[{role:"user",content:"",user_input:""},{role:"assistant",content:n,user_input:i},{role:"user",content:d,user_input:i}],t.AI[o].chatUuid=e.chatUuid,t.AI[o].chatName||(t.AI[o].chatName="conversation from figure:"+t.id),t.AI[o].messages.push({role:"assistant",content:s}),t.AI[o].current_m_index=t.AI[o].messages.length-1,DEBUG&&console.log("after:"+t.AI[o].current_m_index),DEBUG&&console.log(t.AI[o].messages)}else a(e.error)}DEBUG&&console.log("New payload for fbopenai:",h),t.xhr&&4!==t.xhr.readyState&&t.xhr.abort();var y={"Content-Type":"application/json; charset=utf-8"};if(["openrouter","openai","anthropic","deepseek","google"].includes(l)){var _=localStorage.getItem("ai_".concat(l,"_key"));if(!_){var b="API key required for ".concat(l,". Please configure it in AI Assistant settings.");return console.error("AI API Error:",b),void g({error:b})}y["X-API-Key"]=_}t.xhr=T.ajax({url:m,headers:y,dataType:"json",type:"POST",data:JSON.stringify(h),success:function(e){if(e.choices){var t;g({result:null===(t=e.choices)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.message)||void 0===t?void 0:t.content})}else{var a=e.error||e.message||"No result returned from model";console.error("AI API Error:",a),g({error:a})}},error:function(e,t,a){var n,o=(null===(n=e.responseJSON)||void 0===n?void 0:n.error)||a;g({error:o}),console.error("AI API Error:",o)}})}function Mt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={topRight:"top-0 end-0",topLeft:"top-0 start-0",topCenter:"top-0 start-50 translate-middle-x",bottomRight:"bottom-0 end-0",bottomLeft:"bottom-0 start-0",bottomCenter:"bottom-0 start-50 translate-middle-x",center:"top-50 start-50 translate-middle"},a={id:e.id||"toast-".concat(Date.now()),title:e.title||"",message:e.message||"",type:{info:"info",success:"success",warning:"warning",error:"danger",question:"primary"}[e.toast_type||e.type]||"info",position:t[e.position]||"top-0 end-0",timeout:!1!==e.timeout&&(parseInt(e.timeout)||5e3),close:void 0===e.close||e.close,overlay:e.overlay||!1,progressBar:void 0===e.progressBar||e.progressBar,buttons:e.buttons||[],onClosing:e.onClosing||function(){},onClosed:e.onClosed||function(){},maxWidth:e.maxWidth||350,drag:void 0===e.drag||e.drag,layout:e.layout||1,displayMode:e.displayMode||0,rtl:e.rtl||!1},n="toast-container-".concat(a.position.replace(/\s+/g,"-")),o=document.getElementById(n);o||((o=document.createElement("div")).id=n,o.className="toast-container position-fixed p-3",o.className+=" ".concat(a.position),o.style.zIndex="1060",document.body.appendChild(o));var i=document.createElement("div");i.id=a.id,i.className="toast bg-".concat(a.type," text-white"),i.setAttribute("role","alert"),i.setAttribute("aria-live","assertive"),i.setAttribute("aria-atomic","true"),!1===a.timeout&&i.setAttribute("data-bs-autohide","false"),a.maxWidth&&(i.style.maxWidth="".concat(a.maxWidth,"px"));var r=document.createElement("div");r.className="toast-header";var s=document.createElement("span");s.className="me-2 ".concat({info:"bi bi-info-circle-fill",success:"bi bi-check-circle-fill",warning:"bi bi-exclamation-triangle-fill",danger:"bi bi-x-circle-fill",primary:"bi bi-question-circle-fill"}[a.type]),r.appendChild(s);var l=document.createElement("strong");if(l.className="me-auto",l.textContent=a.title,r.appendChild(l),a.close){var c=document.createElement("button");c.type="button",c.className="btn-close",c.setAttribute("data-bs-dismiss","toast"),c.setAttribute("aria-label","Close"),r.appendChild(c)}i.appendChild(r);var u=document.createElement("div");if(u.className="toast-body","string"==typeof a.message?u.textContent=a.message:u.appendChild(a.message),a.buttons&&a.buttons.length>0){var d=document.createElement("div");d.className="mt-2 pt-2 border-top d-flex justify-content-end",a.buttons.forEach((function(e){var t=document.createElement("button");t.type="button",t.className="btn btn-sm mx-1",t.innerHTML=e[0],t.addEventListener("click",(function(){"function"==typeof e[1]&&e[1]({hide:function(e,t,a){var n=g.y8.getInstance(i);n&&n.hide()}},i,"button")})),d.appendChild(t)})),u.appendChild(d)}i.appendChild(u),o.appendChild(i);var p=new g.y8(i,{animation:!0,autohide:!1!==a.timeout,delay:!1!==a.timeout?a.timeout:864e5});if(!1===a.timeout&&i.setAttribute("data-bs-autohide","false"),a.position.includes("translate-middle")&&(o.style.width="100%",o.style.pointerEvents="none",i.style.pointerEvents="auto",i.style.marginLeft="auto",i.style.marginRight="auto"),i.addEventListener("hide.bs.toast",(function(){a.onClosing(p,i,"dismiss")})),i.addEventListener("hidden.bs.toast",(function(){a.onClosed(p,i,"dismiss"),i.remove()})),a.overlay){var h=document.createElement("div");h.className="toast-overlay",h.style.position="fixed",h.style.top="0",h.style.left="0",h.style.width="100%",h.style.height="100%",h.style.backgroundColor="rgba(0, 0, 0, 0.5)",h.style.zIndex="1050",document.body.appendChild(h),i.addEventListener("hidden.bs.toast",(function(){h.remove()}))}return p.show(),{hide:function(){p.hide()}}}var Ot={info:function(e){return Mt(U(U({},e),{},{toast_type:"info"}))},success:function(e){return Mt(U(U({},e),{},{toast_type:"success"}))},warning:function(e){return Mt(U(U({},e),{},{toast_type:"warning"}))},error:function(e){return Mt(U(U({},e),{},{toast_type:"error"}))},question:function(e){return Mt(U(U({},e),{},{toast_type:"question"}))},show:function(e){return Mt(e)}}},"91d67ebe639bc5023d4d":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.label.HTML_link=n.shape.basic.Label.extend({NAME:"draw2d.shape.fishbone.label.HTML_link",INFO:"{Class: <strong>draw2d.shape.fishbone.label.HTML_link</strong>}<br/><br/>",init:function(e,t,a){this._super(o.extend({text:"Simple Label",color:"rgba(255, 255, 255, 0)",radius:10,padding:10,stroke:1},e),t,a);var i=this.getUserData(),r=this;null===i&&this.attr({userData:{hidden:!1,index:0,font:{font_size:18,font_color:"#000",font_family:"Tahoma, Geneva",font_bold:!0},back_color:"",frame_size:0,frame_color:"#989799",padding:10,text:"Simple Text",link:""}}),setTimeout((function(){r.label&&r.label.click((function(){if(r.userData.link){var e=window.open(r.userData.link,"_blank");e?e.focus():alert("Please allow popups for this website")}}))}),100),this.installEditor(new n.ui.LabelInplaceMemoEditor({onCommit:o.proxy((function(e){this.userData.text=e}),this),onCancel:function(){}})),this.setParams=function(){r.setFontSize(this.userData.font.font_size),r.setFontColor(this.userData.font.font_color),r.setFontFamily(this.userData.font.font_family),r.setBackgroundColor(""===this.userData.back_color?null:this.userData.back_color),r.setStroke(this.userData.frame_size),r.setColor(this.userData.frame_color),r.setPadding(this.userData.padding),r.setBold(this.userData.font.font_bold),r.setText(this.userData.text)},this.setParams(),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0},font:{type:"object",additionalProperties:!1,properties:{font_size:{type:"integer",title:"Font Size",default:24},font_color:{type:"string",format:"colorpicker",title:"Font Color",default:"#000"},font_family:{type:"string",title:"Font Family",default:"Tahoma, Geneva"},font_bold:{type:"boolean",title:"Font Bold",default:!1}}},back_color:{type:"string",format:"colorpicker",title:"Back Color"},frame_size:{type:"integer",title:"Frame Size",default:1},frame_color:{type:"string",format:"colorpicker",title:"Frame Color",default:"#989799"},padding:{type:"integer",title:"Padding",default:10},text:{type:"string",title:"Text",default:"Simple Label"},link:{type:"string",title:"HTML Link",default:""}}},this.setCssClass("pointer"),this.GetHTTPData=function(){this.setParams()}},createSet:function(){return this.label=this.canvas.paper.text(0,0,this.text),this.label}})},"93809f4e6976f07313fb":(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca"),r=a("aeb57e88bcb04c329061"),s=a("6fe5e339b0f8a936ba8c"),l=a("1bf2fbdb051fe0c57024");n.shape.fishbone.cell.Buildingnode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Buildingnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Buildingnode</strong>}<br/><br/><strong>Building </strong><cite>Node </cite>represents relation to particular SOP (Building), according to available SOP list in the scope.<br/><br/><strong>Configuration: </strong><br/><br/><strong>SOP (Building)*: </strong> <cite>specify scope SOP (Building) you want to use. Select from dropdown list. <br/><i class='fas fa-exclamation-circle'></i>This node should be connected to one of the <strong>Scope </strong>nodes available on canvas.</cite>",init:function(e,t,a,c){this._super(o.extend({color:"#67c7e4",items:{filter:{name:"Filter",icon:"fas fa-filter",callback:function(){setTimeout((function(){c.editor.selectBuildingValues(u)}),10)}},reset_filter:{name:"Reset Filter",icon:"fas fa-redo",callback:function(){u.userData.conditions=[{logic:"",openQu:"",prop:"",sign:"consist",value:"empty",values:[],closeQu:""}],i.initFallDown(u),u.GetHTTPData(),u.updateUI()}},sep:"---------"}},e),t,a,c);var u=this;this.project={proj_id:"",proj_name:"",proj_code:""},this.scope={scope_id:"",scope_name:""},this.sites_list_out=[],this.getUserData(),o.extend(this.userData,{hidden:!1,autoWidth:!1,scope:{scope_id:"",scope_name:"SOP"},conditions:[{logic:"",openQu:"",prop:"",sign:"consist",value:"empty",values:[],closeQu:""}],value:0,showInConnections:!0,showOutConnections:!0,sites_list_out:[],index:0}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},scope:{type:"object",title:"SOP (Building)",format:"sopscopecode",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},openQu:{type:"string",title:"",default:""},prop:{type:"string",default:"",enum:r.building_table_columns},sign:{type:"string",default:"consist",enum:["equal","not equal","consist","not consist","in","more than","less than","more than or equal","less than or equal"]},value:{type:"string",title:"Value (Like)",default:"empty"},values:{type:"array",title:"Values (In)",items:{type:"string",title:"Value",default:""}},closeQu:{type:"string",title:"",default:""}},required:["logic","prop","sign","value"]}},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},value:{type:"integer",title:"Current Value",default:0},sites_list_out:{type:"array",title:"Result Site List",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},index:{type:"integer",title:"Mobile Index",default:0}},required:["scope"]}),this.clearUI=function(){this.val_label.setText("0"),this.filter_label.setText("Building")},this.GetHTTPData=function(){var e=this.getUserData();if(void 0!==e.scope.scope_id&&""!==e.scope.scope_id){u.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500));var t=s.context+"/data/getAllBuildingSites?&proj_id="+this.project.proj_id+"&scope_id="+e.scope.scope_id,a=JSON.stringify(e.conditions);this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=o.ajax({url:t,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:a,success:function(t){u.val_label.setText(t.length.toString()),u.userData.value=t.length,u.userData.sites_list_out=t,u.getPort("output0").setUserData({project:u.project,scope:u.scope,sop:e.scope,item_name:"building",sites_list_out:t}),u.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(u.getId()),t.setColor(u.frame.attr("stroke"))}),this)),u.updateUI(),u.stopTimer()}})}},this.createPort("input"),this.createPort("output"),this.getPort("input0").on("connect",(function(e,t){try{t.connection.setTargetDecorator(new n.decoration.connection.DataArrowDecorator),u.updateScopeSearchCol(t.connection.sourcePort.getUserData().project,t.connection.sourcePort.getUserData().scope,u)}catch(e){alert("Building node can be connected only to Scope node"),t&&t.connection.remove()}})),this.updateScopeSearchCol=function(e,t,a){var n,i;this.clearUI,ScopeSOPCodeSearchTreemaNode=(n=s.context+"/data/getAllSOP?scope_id="+t.scope_id+"&proj_id="+e.proj_id,i=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.extend(i),i.prototype.url=n,i.prototype.formatDocument=function(e){return e.scope_name},i.prototype.search=function(){var a;if((a=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!a&&this.getSearchResultsEl().empty(),a)){this.lastTerm=a,this.getSearchResultsEl().empty().append("Searching");var n=this.searchCallback;o.ajax({url:s.context+"/data/getAllSOP?scope_id="+t.scope_id+"&proj_id="+e.proj_id,datatype:"json",type:"GET",success:function(e){var t=(new l).from(e).where((function(e,t){return-1!==e.scope_name.toLowerCase().indexOf(a.toLowerCase())})).select();n(t)}})}},i.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data.scope_id=e.data("value").scope_id,this.data.scope_name=e.data("value").scope_name,a.GetHTTPData(),a.updateUI())},i.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.scope_name.toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},i),TreemaNode.setNodeSubclass("sopscopecode",ScopeSOPCodeSearchTreemaNode),this.project=e,this.scope=t,this.GetHTTPData(),this.updateUI()},this.getRealCount=function(){return 1}},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.top_label.setText(this.project.proj_name),this.filter_label.setText(e.scope.scope_name),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(o.proxy((function(e,a){var n=a.getTarget();n.userData||(n.userData={}),n.userData.realCount=t.getRealCount(),n.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||a.setColor("#dfdfdf")}),this))}));else if("input0"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.updateScopeSearchCol(a.getUserData().project,a.getUserData().scope,this)}},onTimer:function(){"."!==this.val_label.getText()&&".."!==this.val_label.getText()&&"..."!==this.val_label.getText()&&this.val_label.setText("."),"."===this.val_label.getText()?this.val_label.setText(".."):".."===this.val_label.getText()?this.val_label.setText("..."):"..."===this.val_label.getText()&&this.val_label.setText(".")}})},"995a246cbfc2a2a7c934":(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var draw2d=__webpack_require__("8a868d10b6533e768658"),$=__webpack_require__("a45670b3d8fb79ec0258"),jinqJs=__webpack_require__("1bf2fbdb051fe0c57024");draw2d.shape.fishbone.ra.RaphaelText=draw2d.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaphaelText",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaphaelText</strong>}<br/><br/>",init:function(e,t,a){this._super($.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var n=this;this.updateTickets=0,this.setResizeable(!1);var o=new draw2d.PieChartInputPort;o.setConnectionDirection(0);var i=new draw2d.layout.locator.TopLocator;o.setName("chartInput0"),this.addPort(o,i);var r=new draw2d.PieChartInputPort,s=new draw2d.layout.locator.LeftLocator;r.setConnectionDirection(3),r.setName("chartInput1"),this.addPort(r,s),this.sites_list_in=[],null===this.getUserData()&&this.attr({userData:{hidden:!1,size:{width:300,height:300},showInConnections:!0,col:[],color_type:"counts",sites_list_out:[]}}),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:500},height:{type:"integer",default:300}}},showInConnections:{type:"boolean",title:"Show Connections",default:!0},color_type:{type:"string",default:"counts",enum:["counts","conditions","3St"]},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},serie:{type:"object",title:"Chart Series",properties:{name:{type:"string",default:""},type:{type:"string",default:"line",enum:["line","bar"]},areaStyle:{type:"object",title:"Area Style",properties:{normal:{type:"object"}}},data:{type:"array",items:{}}}},sites_list_out:{type:"array",title:"Sites List",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},project:{type:"object",title:"Project",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}}},sites_list_out:{type:"array",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},site_id:{type:"string",title:"Site ID"}}}}},required:["hidden"]},this.GetHTTPData=function(){this.updateTable()},this.updateTable=function(){n.svgNodes&&(n.svgNodes.remove(),n.svgNodes=this.createSet(),n.applyTransformation())},this.userData.sites_list_out=[],n.userData.col=[]},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onPortValueChanged:function(e){if(e.getValue().indexOf("ticket")>-1)this.updateTickets=this.updateTickets+1,console.log("RaphaelPieChart update ticket received: "+this.updateTickets);else{if(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),console.log("RaphaelPieChart update data received: "+this.updateTickets),"chartInput0"===e.name||"chartInput1"===e.name){var t="chartInput0"===e.name?0:1,a=this.getInputPort(t).getConnections(),n=this;a.data.forEach((function(t,a){if(e.getValue()===t.getSource().getParent().getId()){var o=t.getSource();if("draw2d.shape.fishbone.cell.Mathnode"===o.parent.NAME||"draw2d.shape.fishbone.cell.SQLnode"===o.parent.NAME||"draw2d.shape.fishbone.ra.RaManyToOne"===o.parent.NAME||"draw2d.shape.fishbone.cell.UDFnode"===o.parent.NAME||"draw2d.shape.fishbone.cell.Codenode"===o.parent.NAME||"draw2d.shape.fishbone.cell.Mapnode"===o.parent.NAME){if(n.userData.col=[],o.userData.sites_list_out.length>0){var i=o.userData.item_name;(new jinqJs).from(o.userData.sites_list_out).groupBy(i).count("site_id").select().forEach((function(e,t){n.userData.col.push({value:e.site_id,name:e[i],sites_list_out:(new jinqJs).from(o.userData.sites_list_out).where((function(t,a){return t[i]===e[i]})).select()})})),n.project=o.getUserData().project,n.scope=o.getUserData().scope,n.sop=o.getUserData().sop,n.updateTable()}}else if(o.userData.sites_list_out.length>0){var r=o.getId(),s=-1;n.userData.col.forEach((function(e,t){e.owner_id==r&&-1!=(s=t)&&(n.userData.col[s]={owner_id:r,value:o.userData.sites_list_out.length,name:o.userData.item_name,task_type:void 0!==o.userData.sites_list_out[0].task_type?o.userData.sites_list_out[0].task_type:""})}))}}}))}this.updateTickets<=0&&this.updateTable()}},createSet:function(){this.canvas.paper.setStart();for(var e=0;e<=100;e++)console.time("text"),this.canvas.paper.text(60,30,"this is text"),console.timeEnd("text"),console.time("text1"),this.canvas.paper.text(60,30,"this is text"),console.timeEnd("text1"),console.time("text2"),this.canvas.paper.text(60,30,"this is text"),console.timeEnd("text2");return this.canvas.paper.setFinish()},applyAlpha:function(){},addPort:function(e,t){return this._super(e,t),e},getPersistentAttributes:function(){var e=this._super();return e.labels=[],this.children.each((function(t,a){var n=a.figure.getPersistentAttributes();n.locator=a.locator.NAME,e.labels.push(n)})),e},setPersistentAttributes:function setPersistentAttributes(memento){this._super(memento),this.resetChildren(),$.each(memento.labels,$.proxy((function(i,json){var figure=eval("new "+json.type+"()");figure.attr(json);var locator=eval("new "+json.locator+"()");this.add(figure,locator)}),this))}})},"9a6579c5821a9fbd537c":function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("essos",{color:["#893448","#d95850","#eb8146","#ffb248","#f2d643","#ebdba4"],backgroundColor:"rgba(242,234,191,0.15)",textStyle:{},title:{textStyle:{color:"#893448"},subtextStyle:{color:"#d95850"}},line:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"emptyCircle",smooth:!0},radar:{itemStyle:{borderWidth:"2"},lineStyle:{width:"2"},symbolSize:"6",symbol:"emptyCircle",smooth:!0},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#eb8146",color0:"transparent",borderColor:"#d95850",borderColor0:"#58c470",borderWidth:"2"}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:"6",symbol:"emptyCircle",smooth:!0,color:["#893448","#d95850","#eb8146","#ffb248","#f2d643","#ebdba4"],label:{color:"#ffffff"}},map:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#999999",borderWidth:.5},label:{color:"#893448"},emphasis:{itemStyle:{areaColor:"#ffb248",borderColor:"#eb8146",borderWidth:1},label:{color:"#893448"}}},geo:{itemStyle:{areaColor:"#f3f3f3",borderColor:"#999999",borderWidth:.5},label:{color:"#893448"},emphasis:{itemStyle:{areaColor:"#ffb248",borderColor:"#eb8146",borderWidth:1},label:{color:"#893448"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#aaaaaa"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#aaaaaa"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#aaaaaa"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#aaaaaa"}},axisTick:{show:!1,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#999999"},splitLine:{show:!0,lineStyle:{color:["#e6e6e6"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.05)","rgba(200,200,200,0.02)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#999999"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#893448",width:1},itemStyle:{color:"#893448",borderWidth:1},controlStyle:{color:"#893448",borderColor:"#893448",borderWidth:.5},checkpointStyle:{color:"#eb8146",borderColor:"#ffb248"},label:{color:"#893448"},emphasis:{itemStyle:{color:"#ffb248"},controlStyle:{color:"#893448",borderColor:"#893448",borderWidth:.5},label:{color:"#893448"}}},visualMap:{color:["#893448","#d95850","#eb8146","#ffb248","#f2d643","rgb(247,238,173)"]},dataZoom:{backgroundColor:"rgba(255,255,255,0)",dataBackgroundColor:"rgba(255,178,72,0.5)",fillerColor:"rgba(255,178,72,0.15)",handleColor:"#ffb248",handleSize:"100%",textStyle:{color:"#333"}},markPoint:{label:{color:"#ffffff"},emphasis:{label:{color:"#ffffff"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},"9e00802368dd999ed9a9":e=>{e.exports="var TreemaNode,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },\n    __slice = [].slice;\n\nTreemaNode = (function() {\n  var defaults;\n\n  TreemaNode.prototype.schema = {};\n\n  TreemaNode.prototype.$el = null;\n\n  TreemaNode.prototype.data = null;\n\n  TreemaNode.prototype.options = null;\n\n  TreemaNode.prototype.parent = null;\n\n  TreemaNode.prototype.lastSelectedTreema = null;\n\n  TreemaNode.prototype.treemaFilterHiddenClass = 'treema-filter-hidden';\n\n  TreemaNode.prototype.nodeTemplate = '<div class=\"treema-row treema-clearfix\"><div class=\"treema-value\"></div></div>';\n\n  TreemaNode.prototype.childrenTemplate = '<div class=\"treema-children\"></div>';\n\n  TreemaNode.prototype.addChildTemplate = '<div class=\"treema-add-child\" tabindex=\"9009\">+</div>';\n\n  TreemaNode.prototype.tempErrorTemplate = '<span class=\"treema-temp-error\"></span>';\n\n  TreemaNode.prototype.toggleTemplate = '<span class=\"treema-toggle-hit-area\"><span class=\"treema-toggle\"></span></span>';\n\n  TreemaNode.prototype.keyTemplate = '<span class=\"treema-key\"></span>';\n\n  TreemaNode.prototype.errorTemplate = '<div class=\"treema-error\"></div>';\n\n  TreemaNode.prototype.newPropertyTemplate = '<input class=\"treema-new-prop\" />';\n\n  TreemaNode.prototype.collection = false;\n\n  TreemaNode.prototype.ordered = false;\n\n  TreemaNode.prototype.keyed = false;\n\n  TreemaNode.prototype.editable = true;\n\n  TreemaNode.prototype.directlyEditable = true;\n\n  TreemaNode.prototype.skipTab = false;\n\n  TreemaNode.prototype.valueClass = null;\n\n  TreemaNode.prototype.removeOnEmptyDelete = true;\n\n  TreemaNode.prototype.keyForParent = null;\n\n  TreemaNode.prototype.childrenTreemas = null;\n\n  TreemaNode.prototype.integrated = false;\n\n  TreemaNode.prototype.workingSchema = null;\n\n  TreemaNode.prototype.nodeDescription = 'Node';\n\n  TreemaNode.prototype.isValid = function() {\n    var errors;\n    errors = this.getErrors();\n    return errors.length === 0;\n  };\n\n  TreemaNode.prototype.getErrors = function() {\n    var e, errors, moreErrors, my_path, root, _i, _len;\n    if (!this.tv4) {\n      return [];\n    }\n    if (this.isRoot()) {\n      if (this.cachedErrors) {\n        return this.cachedErrors;\n      }\n      this.cachedErrors = this.tv4.validateMultiple(this.data, this.schema)['errors'];\n      return this.cachedErrors;\n    }\n    root = this.getRoot();\n    errors = root.getErrors();\n    my_path = this.getPath();\n    errors = (function() {\n      var _i, _len, _results;\n      _results = [];\n      for (_i = 0, _len = errors.length; _i < _len; _i++) {\n        e = errors[_i];\n        if (e.dataPath.slice(0, +my_path.length + 1 || 9e9) === my_path) {\n          _results.push(e);\n        }\n      }\n      return _results;\n    })();\n    for (_i = 0, _len = errors.length; _i < _len; _i++) {\n      e = errors[_i];\n      if (e.dataPath === my_path) {\n        e.subDataPath = '';\n      } else {\n        e.subDataPath = e.dataPath.slice(0, +my_path.length + 1 || 9e9);\n      }\n    }\n    if (this.workingSchema) {\n      moreErrors = this.tv4.validateMultiple(this.data, this.workingSchema).errors;\n      errors = errors.concat(moreErrors);\n    }\n    return errors;\n  };\n\n  TreemaNode.prototype.setUpValidator = function() {\n    var root, _ref;\n    if (!this.parent) {\n      this.tv4 = (_ref = window['tv4']) != null ? _ref.freshApi() : void 0;\n      this.tv4.addSchema('#', this.schema);\n      if (this.schema.id) {\n        return this.tv4.addSchema(this.schema.id, this.schema);\n      }\n    } else {\n      root = this.getRoot();\n      return this.tv4 = root.tv4;\n    }\n  };\n\n  TreemaNode.prototype.saveChanges = function(oldData) {\n    if (oldData === this.data) {\n      return;\n    }\n    return this.addTrackedAction({\n      'oldData': oldData,\n      'newData': this.data,\n      'path': this.getPath(),\n      'action': 'edit'\n    });\n  };\n\n  TreemaNode.prototype.getChildSchema = function(key) {\n    return TreemaNode.utils.getChildSchema(key, this.workingSchema);\n  };\n\n  TreemaNode.prototype.buildValueForDisplay = function() {\n    return console.error('\"buildValueForDisplay\" has not been overridden.');\n  };\n\n  TreemaNode.prototype.buildValueForEditing = function() {\n    if (!(this.editable && this.directlyEditable)) {\n      return;\n    }\n    return console.error('\"buildValueForEditing\" has not been overridden.');\n  };\n\n  TreemaNode.prototype.getChildren = function() {\n    return console.error('\"getChildren\" has not been overridden.');\n  };\n\n  TreemaNode.prototype.canAddChild = function() {\n    return this.collection && this.editable && !this.settings.readOnly;\n  };\n\n  TreemaNode.prototype.canAddProperty = function() {\n    return true;\n  };\n\n  TreemaNode.prototype.addingNewProperty = function() {\n    return false;\n  };\n\n  TreemaNode.prototype.addNewChild = function() {\n    return false;\n  };\n\n  TreemaNode.prototype.buildValueForDisplaySimply = function(valEl, text) {\n    if (text.length > 200) {\n      text = text.slice(0, 200) + '...';\n    }\n    return valEl.append($(\"<div></div>\").addClass('treema-shortened').text(text));\n  };\n\n  TreemaNode.prototype.buildValueForEditingSimply = function(valEl, value, inputType) {\n    var input;\n    if (inputType == null) {\n      inputType = null;\n    }\n    input = $('<input />');\n    if (inputType) {\n      input.attr('type', inputType);\n    }\n    if (value !== null) {\n      input.val(value);\n    }\n    valEl.append(input);\n    input.focus().select();\n    input.blur(this.onEditInputBlur);\n    return input;\n  };\n\n  TreemaNode.prototype.onEditInputBlur = function(e) {\n    var closest, input, shouldRemove;\n    shouldRemove = this.shouldTryToRemoveFromParent();\n    closest = $(e.relatedTarget).closest('.treema-node')[0];\n    if (closest === this.$el[0]) {\n      shouldRemove = false;\n    }\n    this.markAsChanged();\n    this.saveChanges(this.getValEl());\n    input = this.getValEl().find('input, textarea, select');\n    if (this.isValid()) {\n      if (this.isEditing()) {\n        this.display();\n      }\n    } else {\n      input.focus().select();\n    }\n    if (shouldRemove) {\n      this.remove();\n    } else {\n      this.flushChanges();\n    }\n    return this.broadcastChanges();\n  };\n\n  TreemaNode.prototype.shouldTryToRemoveFromParent = function() {\n    var input, inputs, val, _i, _len;\n    val = this.getValEl();\n    if (val.find('select').length) {\n      return;\n    }\n    inputs = val.find('input, textarea');\n    for (_i = 0, _len = inputs.length; _i < _len; _i++) {\n      input = inputs[_i];\n      input = $(input);\n      if (input.attr('type') === 'checkbox' || input.val()) {\n        return false;\n      }\n    }\n    if (!this.getErrors().length) {\n      return false;\n    }\n    return true;\n  };\n\n  TreemaNode.prototype.limitChoices = function(options) {\n    var _this = this;\n    this[\"enum\"] = options;\n    this.buildValueForEditing = function(valEl, data) {\n      var index, input, option, _i, _len, _ref;\n      input = $('<select></select>');\n      _ref = _this[\"enum\"];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        option = _ref[_i];\n        input.append($('<option></option>').text(option));\n      }\n      index = _this[\"enum\"].indexOf(data);\n      if (index >= 0) {\n        input.prop('selectedIndex', index);\n      }\n      valEl.append(input);\n      input.focus();\n      input.blur(_this.onEditInputBlur);\n      return input;\n    };\n    return this.saveChanges = function(valEl) {\n      var index;\n      index = valEl.find('select').prop('selectedIndex');\n      _this.addTrackedAction({\n        'oldData': _this.data,\n        'newData': _this[\"enum\"][index],\n        'path': _this.getPath(),\n        'action': 'edit'\n      });\n      _this.data = _this[\"enum\"][index];\n      TreemaNode.changedTreemas.push(_this);\n      return _this.broadcastChanges();\n    };\n  };\n\n  TreemaNode.pluginName = \"treema\";\n\n  defaults = {\n    schema: {},\n    callbacks: {}\n  };\n\n  function TreemaNode($el, options, parent) {\n    this.$el = $el;\n    this.parent = parent;\n    this.onSelectType = __bind(this.onSelectType, this);\n    this.onSelectSchema = __bind(this.onSelectSchema, this);\n    this.orderDataFromUI = __bind(this.orderDataFromUI, this);\n    this.onMouseLeave = __bind(this.onMouseLeave, this);\n    this.onMouseEnter = __bind(this.onMouseEnter, this);\n    this.onEditInputBlur = __bind(this.onEditInputBlur, this);\n    this.setWorkingSchema(options.workingSchema, options.workingSchemas);\n    delete options.workingSchema;\n    delete options.workingSchemas;\n    this.$el = this.$el || $('<div></div>');\n    this.settings = $.extend({}, defaults, options);\n    this.schema = $.extend({}, this.settings.schema);\n    this.data = options.data;\n    this.defaultData = options.defaultData;\n    this.keyForParent = options.keyForParent;\n    this.patches = [];\n    this.trackedActions = [];\n    this.currentStateIndex = 0;\n    this.trackingDisabled = false;\n    this.callbacks = this.settings.callbacks;\n    this._defaults = defaults;\n    this._name = TreemaNode.pluginName;\n    this.setUpValidator();\n    this.populateData();\n    this.previousState = this.copyData();\n    this.unloadNodeSpecificSettings();\n  }\n\n  TreemaNode.prototype.unloadNodeSpecificSettings = function() {\n    var key, _i, _len, _ref, _results;\n    _ref = ['data', 'defaultData', 'schema', 'type'];\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      key = _ref[_i];\n      if (this.settings[key] != null) {\n        this[key] = this.settings[key];\n      }\n      _results.push(delete this.settings[key]);\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.build = function() {\n    var schema, valEl, _ref;\n    this.$el.addClass('treema-node').addClass('treema-clearfix');\n    this.$el.empty().append($(this.nodeTemplate));\n    this.$el.data('instance', this);\n    if (!this.parent) {\n      this.$el.addClass('treema-root');\n    }\n    if (!this.parent) {\n      this.$el.attr('tabindex', 9001);\n    }\n    if (this.collection) {\n      this.$el.append($(this.childrenTemplate)).addClass('treema-closed');\n    }\n    valEl = this.getValEl();\n    if (this.valueClass) {\n      valEl.addClass(this.valueClass);\n    }\n    if (this.directlyEditable) {\n      valEl.addClass('treema-display');\n    }\n    this.buildValueForDisplay(valEl, this.getData());\n    if (this.collection && !this.parent) {\n      this.open();\n    }\n    if (!this.parent) {\n      this.setUpGlobalEvents();\n    }\n    if (this.parent) {\n      this.setUpLocalEvents();\n    }\n    if (this.collection) {\n      this.updateMyAddButton();\n    }\n    this.createTypeSelector();\n    if (((_ref = this.workingSchemas) != null ? _ref.length : void 0) > 1) {\n      this.createSchemaSelector();\n    }\n    schema = this.workingSchema || this.schema;\n    if (schema[\"enum\"]) {\n      this.limitChoices(schema[\"enum\"]);\n    }\n    this.updateDefaultClass();\n    return this.$el;\n  };\n\n  TreemaNode.prototype.populateData = function() {};\n\n  TreemaNode.prototype.setWorkingSchema = function(workingSchema, workingSchemas) {\n    this.workingSchema = workingSchema;\n    this.workingSchemas = workingSchemas;\n  };\n\n  TreemaNode.prototype.createSchemaSelector = function() {\n    var i, label, option, schema, select, _i, _len, _ref;\n    select = $('<select></select>').addClass('treema-schema-select');\n    _ref = this.workingSchemas;\n    for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n      schema = _ref[i];\n      label = this.makeWorkingSchemaLabel(schema);\n      option = $('<option></option>').attr('value', i).text(label);\n      if (schema === this.workingSchema) {\n        option.attr('selected', true);\n      }\n      select.append(option);\n    }\n    select.change(this.onSelectSchema);\n    return this.$el.find('> .treema-row').prepend(select);\n  };\n\n  TreemaNode.prototype.makeWorkingSchemaLabel = function(schema) {\n    if (schema.title != null) {\n      return schema.title;\n    }\n    if (schema.type != null) {\n      return schema.type;\n    }\n    return '???';\n  };\n\n  TreemaNode.prototype.getTypes = function() {\n    var schema, types;\n    schema = this.workingSchema || this.schema;\n    types = schema.type || [\"string\", \"number\", \"integer\", \"boolean\", \"null\", \"array\", \"object\"];\n    if (!$.isArray(types)) {\n      types = [types];\n    }\n    return types;\n  };\n\n  TreemaNode.prototype.createTypeSelector = function() {\n    var currentType, option, schema, select, type, types, _i, _len;\n    types = this.getTypes();\n    if (!(types.length > 1)) {\n      return;\n    }\n    schema = this.workingSchema || this.schema;\n    if (schema[\"enum\"]) {\n      return;\n    }\n    select = $('<select></select>').addClass('treema-type-select');\n    currentType = $.type(this.getData());\n    if (this.valueClass === 'treema-integer') {\n      currentType = 'integer';\n    }\n    for (_i = 0, _len = types.length; _i < _len; _i++) {\n      type = types[_i];\n      option = $('<option></option>').attr('value', type).text(this.getTypeName(type));\n      if (type === currentType) {\n        option.attr('selected', true);\n      }\n      select.append(option);\n    }\n    select.change(this.onSelectType);\n    return this.$el.find('> .treema-row').prepend(select);\n  };\n\n  TreemaNode.prototype.getTypeName = function(type) {\n    return {\n      \"null\": 'null',\n      array: 'arr',\n      number: 'num',\n      string: 'str',\n      integer: 'int',\n      boolean: 'bool',\n      object: 'obj'\n    }[type];\n  };\n\n  TreemaNode.prototype.setUpGlobalEvents = function() {\n    var _this = this;\n    this.$el.unbind();\n    this.$el.dblclick(function(e) {\n      var _ref;\n      return (_ref = $(e.target).closest('.treema-node').data('instance')) != null ? _ref.onDoubleClick(e) : void 0;\n    });\n    this.$el.click(function(e) {\n      var _ref;\n      if ((_ref = $(e.target).closest('.treema-node').data('instance')) != null) {\n        _ref.onClick(e);\n      }\n      return _this.broadcastChanges(e);\n    });\n    this.keysPreviouslyDown = {};\n    this.$el.keydown(function(e) {\n      var closest, lastSelected, _ref;\n      e.heldDown = _this.keysPreviouslyDown[e.which] || false;\n      closest = $(e.target).closest('.treema-node').data('instance');\n      lastSelected = _this.getLastSelectedTreema();\n      if ((_ref = lastSelected || closest) != null) {\n        _ref.onKeyDown(e);\n      }\n      _this.broadcastChanges(e);\n      _this.keysPreviouslyDown[e.which] = true;\n      if (e.ctrlKey || e.metaKey) {\n        return _this.manageCopyAndPaste(e);\n      }\n    });\n    return this.$el.keyup(function(e) {\n      var _ref, _ref1;\n      if ((_ref = e.which) === 17 || _ref === 91) {\n        if ((_ref1 = _this.targetOfCopyPaste) != null) {\n          _ref1.removeClass('treema-target-of-copy-paste');\n        }\n        _this.targetOfCopyPaste = null;\n      }\n      return delete _this.keysPreviouslyDown[e.which];\n    });\n  };\n\n  TreemaNode.prototype.manageCopyAndPaste = function(e) {\n    var el, target, _ref,\n        _this = this;\n    el = document.activeElement;\n    if ((el != null) && (el.tagName.toLowerCase() === 'input' && el.type === 'text') || (el.tagName.toLowerCase() === 'textarea' && !$(el).hasClass('treema-clipboard'))) {\n      return;\n    }\n    target = (_ref = this.getLastSelectedTreema()) != null ? _ref : this;\n    if (e.which === 86 && $(e.target).hasClass('treema-clipboard')) {\n      if (e.shiftKey && $(e.target).hasClass('treema-clipboard')) {\n        this.saveScrolls();\n        return setTimeout((function() {\n          var newData, result;\n          _this.loadScrolls();\n          if (!(newData = _this.$clipboard.val())) {\n            return;\n          }\n          try {\n            newData = JSON.parse(newData);\n          } catch (_error) {\n            e = _error;\n            _this.$el.trigger({\n              type: 'treema-error',\n              message: 'Could not parse pasted data as JSON.'\n            });\n            return;\n          }\n          result = target.tv4.validateMultiple(newData, target.schema);\n          if (result.valid) {\n            target.set('/', newData);\n            return _this.$el.trigger('treema-paste');\n          } else {\n            _this.$el.trigger({\n              type: 'treema-error',\n              message: 'Data provided is invalid according to schema.'\n            });\n            return console.log(\"not pasting\", newData, \"because it's not valid:\", result);\n          }\n        }), 5);\n      } else {\n        return e.preventDefault();\n      }\n    } else if (e.shiftKey) {\n      if (!this.$clipboardContainer) {\n        return;\n      }\n      this.saveScrolls();\n      this.$clipboardContainer.find('.treema-clipboard').focus().select();\n      return this.loadScrolls();\n    } else {\n      this.saveScrolls();\n      if (!this.$clipboardContainer) {\n        this.$clipboardContainer = $('<div class=\"treema-clipboard-container\"></div>').appendTo(this.$el);\n        this.$clipboardContainer.on('paste', function() {\n          var _ref1;\n          return (_ref1 = _this.targetOfCopyPaste) != null ? _ref1.removeClass('treema-target-of-copy-paste') : void 0;\n        });\n        this.$clipboardContainer.on('copy', function() {\n          var _ref1;\n          _this.$el.trigger('treema-copy');\n          return (_ref1 = _this.targetOfCopyPaste) != null ? _ref1.removeClass('treema-target-of-copy-paste') : void 0;\n        });\n      }\n      this.targetOfCopyPaste = target.$el;\n      this.targetOfCopyPaste.addClass('treema-target-of-copy-paste');\n      this.$clipboardContainer.empty().show();\n      this.$clipboard = $('<textarea class=\"treema-clipboard\"></textarea>').val(JSON.stringify(target.getData(), null, '  ')).appendTo(this.$clipboardContainer).focus().select();\n      return this.loadScrolls();\n    }\n  };\n\n  TreemaNode.prototype.broadcastChanges = function(e) {\n    var changes, t, _base;\n    if (this.getRoot().hush) {\n      return;\n    }\n    if (this.callbacks.select && TreemaNode.didSelect) {\n      TreemaNode.didSelect = false;\n      this.callbacks.select(e, this.getSelectedTreemas());\n    }\n    if (TreemaNode.changedTreemas.length) {\n      changes = (function() {\n        var _i, _len, _ref, _results;\n        _ref = TreemaNode.changedTreemas;\n        _results = [];\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          t = _ref[_i];\n          if (t.integrated || !t.parent) {\n            _results.push(t);\n          }\n        }\n        return _results;\n      })();\n      if (typeof (_base = this.callbacks).change === \"function\") {\n        _base.change(e, jQuery.unique(changes));\n      }\n      return TreemaNode.changedTreemas = [];\n    }\n  };\n\n  TreemaNode.prototype.markAsChanged = function() {\n    return TreemaNode.changedTreemas.push(this);\n  };\n\n  TreemaNode.prototype.setUpLocalEvents = function() {\n    var row;\n    row = this.$el.find('> .treema-row');\n    if (this.callbacks.mouseenter != null) {\n      row.mouseenter(this.onMouseEnter);\n    }\n    if (this.callbacks.mouseleave != null) {\n      return row.mouseleave(this.onMouseLeave);\n    }\n  };\n\n  TreemaNode.prototype.onMouseEnter = function(e) {\n    return this.callbacks.mouseenter(e, this);\n  };\n\n  TreemaNode.prototype.onMouseLeave = function(e) {\n    return this.callbacks.mouseleave(e, this);\n  };\n\n  TreemaNode.prototype.onClick = function(e) {\n    var clickedToggle, clickedValue, usedModKey, _ref;\n    if ((_ref = e.target.nodeName) === 'INPUT' || _ref === 'TEXTAREA' || _ref === 'SELECT') {\n      return;\n    }\n    clickedValue = $(e.target).closest('.treema-value').length;\n    clickedToggle = $(e.target).hasClass('treema-toggle') || $(e.target).hasClass('treema-toggle-hit-area');\n    usedModKey = e.shiftKey || e.ctrlKey || e.metaKey;\n    if (!(clickedValue && !this.collection)) {\n      this.keepFocus();\n    }\n    if (this.isDisplaying() && clickedValue && this.canEdit() && !usedModKey) {\n      return this.toggleEdit();\n    }\n    if (!usedModKey && (clickedToggle || (clickedValue && this.collection))) {\n      if (!clickedToggle) {\n        this.deselectAll();\n        this.select();\n      }\n      return this.toggleOpen();\n    }\n    if ($(e.target).closest('.treema-add-child').length && this.collection) {\n      return this.addNewChild();\n    }\n    if (this.isRoot() || this.isEditing()) {\n      return;\n    }\n    if (e.shiftKey) {\n      return this.shiftSelect();\n    }\n    if (e.ctrlKey || e.metaKey) {\n      return this.toggleSelect();\n    }\n    return this.select();\n  };\n\n  TreemaNode.prototype.onDoubleClick = function(e) {\n    var clickedKey, _base, _base1, _base2;\n    if (!this.collection) {\n      return typeof (_base = this.callbacks).dblclick === \"function\" ? _base.dblclick(e, this) : void 0;\n    }\n    clickedKey = $(e.target).hasClass('treema-key');\n    if (!clickedKey) {\n      return typeof (_base1 = this.callbacks).dblclick === \"function\" ? _base1.dblclick(e, this) : void 0;\n    }\n    if (this.isClosed()) {\n      this.open();\n    }\n    this.addNewChild();\n    return typeof (_base2 = this.callbacks).dblclick === \"function\" ? _base2.dblclick(e, this) : void 0;\n  };\n\n  TreemaNode.prototype.onKeyDown = function(e) {\n    var _ref;\n    if (e.which === 27) {\n      this.onEscapePressed(e);\n    }\n    if (e.which === 9) {\n      this.onTabPressed(e);\n    }\n    if (e.which === 37) {\n      this.onLeftArrowPressed(e);\n    }\n    if (e.which === 38) {\n      this.onUpArrowPressed(e);\n    }\n    if (e.which === 39) {\n      this.onRightArrowPressed(e);\n    }\n    if (e.which === 40) {\n      this.onDownArrowPressed(e);\n    }\n    if (e.which === 13) {\n      this.onEnterPressed(e);\n    }\n    if (e.which === 78) {\n      this.onNPressed(e);\n    }\n    if (e.which === 32) {\n      this.onSpacePressed(e);\n    }\n    if (e.which === 84) {\n      this.onTPressed(e);\n    }\n    if (e.which === 70) {\n      this.onFPressed(e);\n    }\n    if (e.which === 90) {\n      this.onZPressed(e);\n    }\n    if (((_ref = e.which) === 8 || _ref === 46) && !e.heldDown) {\n      return this.onDeletePressed(e);\n    }\n  };\n\n  TreemaNode.prototype.onLeftArrowPressed = function(e) {\n    if (this.inputFocused()) {\n      return;\n    }\n    this.navigateOut();\n    return e.preventDefault();\n  };\n\n  TreemaNode.prototype.onRightArrowPressed = function(e) {\n    if (this.inputFocused()) {\n      return;\n    }\n    this.navigateIn();\n    return e.preventDefault();\n  };\n\n  TreemaNode.prototype.onUpArrowPressed = function(e) {\n    if (this.inputFocused()) {\n      return;\n    }\n    this.navigateSelection(-1);\n    return e.preventDefault();\n  };\n\n  TreemaNode.prototype.onDownArrowPressed = function(e) {\n    if (this.inputFocused()) {\n      return;\n    }\n    this.navigateSelection(1);\n    return e.preventDefault();\n  };\n\n  TreemaNode.prototype.inputFocused = function() {\n    var _ref;\n    if (((_ref = document.activeElement.nodeName) === 'INPUT' || _ref === 'TEXTAREA' || _ref === 'SELECT') && !$(document.activeElement).hasClass('treema-clipboard')) {\n      return true;\n    }\n  };\n\n  TreemaNode.prototype.onSpacePressed = function() {};\n\n  TreemaNode.prototype.onTPressed = function() {};\n\n  TreemaNode.prototype.onFPressed = function() {};\n\n  TreemaNode.prototype.onDeletePressed = function(e) {\n    var editing;\n    editing = this.editingIsHappening();\n    if (editing && !$(e.target).val() && this.removeOnEmptyDelete) {\n      this.display();\n      this.select();\n      this.removeSelectedNodes();\n      e.preventDefault();\n    }\n    if (editing) {\n      return;\n    }\n    e.preventDefault();\n    return this.removeSelectedNodes();\n  };\n\n  TreemaNode.prototype.onEscapePressed = function() {\n    if (!this.isEditing()) {\n      return;\n    }\n    if (this.parent && (!this.integrated) && this.defaultData === void 0) {\n      return this.remove();\n    }\n    if (this.isEditing()) {\n      this.display();\n    }\n    if (!this.isRoot()) {\n      this.select();\n    }\n    return this.keepFocus();\n  };\n\n  TreemaNode.prototype.onEnterPressed = function(e) {\n    var offset;\n    offset = e.shiftKey ? -1 : 1;\n    if (offset === 1 && $(e.target).hasClass('treema-add-child')) {\n      return this.addNewChild();\n    }\n    return this.traverseWhileEditing(offset, true);\n  };\n\n  TreemaNode.prototype.onTabPressed = function(e) {\n    var offset;\n    offset = e.shiftKey ? -1 : 1;\n    if (this.hasMoreInputs(offset)) {\n      return;\n    }\n    e.preventDefault();\n    return this.traverseWhileEditing(offset, false);\n  };\n\n  TreemaNode.prototype.hasMoreInputs = function(offset) {\n    var input, inputs, passedFocusedEl, _i, _len;\n    inputs = this.getInputs().toArray();\n    if (offset < 0) {\n      inputs = inputs.reverse();\n    }\n    passedFocusedEl = false;\n    for (_i = 0, _len = inputs.length; _i < _len; _i++) {\n      input = inputs[_i];\n      if (input === document.activeElement) {\n        passedFocusedEl = true;\n        continue;\n      }\n      if (!passedFocusedEl) {\n        continue;\n      }\n      return true;\n    }\n    return false;\n  };\n\n  TreemaNode.prototype.onNPressed = function(e) {\n    var selected, success, target;\n    if (this.editingIsHappening()) {\n      return;\n    }\n    selected = this.getLastSelectedTreema();\n    target = (selected != null ? selected.collection : void 0) ? selected : selected != null ? selected.parent : void 0;\n    if (!target) {\n      return;\n    }\n    success = target.addNewChild();\n    if (success) {\n      this.deselectAll();\n    }\n    return e.preventDefault();\n  };\n\n  TreemaNode.prototype.onZPressed = function(e) {\n    if (e.ctrlKey || e.metaKey) {\n      if (e.shiftKey) {\n        return this.getRoot().redo();\n      } else {\n        return this.getRoot().undo();\n      }\n    }\n  };\n\n  TreemaNode.prototype.traverseWhileEditing = function(offset, aggressive) {\n    var ctx, editing, selected, shouldRemove, targetEl, _ref;\n    shouldRemove = false;\n    selected = this.getLastSelectedTreema();\n    editing = this.isEditing();\n    if (!editing && (selected != null ? selected.canEdit() : void 0)) {\n      return selected.edit();\n    }\n    if (editing) {\n      shouldRemove = this.shouldTryToRemoveFromParent();\n      this.saveChanges(this.getValEl());\n      if (!shouldRemove) {\n        this.flushChanges();\n      }\n      if (!(aggressive || this.isValid())) {\n        this.refreshErrors();\n        return;\n      }\n      if (shouldRemove && ((_ref = $(this.$el[0].nextSibling)) != null ? _ref.hasClass('treema-add-child') : void 0) && offset === 1) {\n        offset = 2;\n      }\n      this.endExistingEdits();\n      this.select();\n    }\n    ctx = this.traversalContext(offset);\n    if (!(ctx != null ? ctx.origin : void 0)) {\n      return;\n    }\n    selected = $(ctx.origin).data('instance');\n    if (offset > 0 && aggressive && selected && selected.collection && selected.isClosed()) {\n      return selected.open();\n    }\n    targetEl = offset > 0 ? ctx.next : ctx.prev;\n    if (!targetEl) {\n      targetEl = offset > 0 ? ctx.first : ctx.last;\n    }\n    this.selectOrActivateElement(targetEl);\n    if (shouldRemove) {\n      return this.remove();\n    } else {\n      return this.refreshErrors();\n    }\n  };\n\n  TreemaNode.prototype.selectOrActivateElement = function(el) {\n    var treema;\n    el = $(el);\n    treema = el.data('instance');\n    if (treema) {\n      if (treema.canEdit()) {\n        return treema.edit();\n      } else {\n        return treema.select();\n      }\n    }\n    this.deselectAll();\n    return el.focus();\n  };\n\n  TreemaNode.prototype.navigateSelection = function(offset) {\n    var ctx, targetTreema;\n    ctx = this.navigationContext();\n    if (!ctx) {\n      return;\n    }\n    if (!ctx.origin) {\n      targetTreema = offset > 0 ? ctx.first : ctx.last;\n      return targetTreema.select();\n    }\n    targetTreema = offset > 0 ? ctx.next : ctx.prev;\n    if (!targetTreema) {\n      targetTreema = offset > 0 ? ctx.first : ctx.last;\n    }\n    return targetTreema != null ? targetTreema.select() : void 0;\n  };\n\n  TreemaNode.prototype.navigateOut = function() {\n    var selected;\n    selected = this.getLastSelectedTreema();\n    if (!selected) {\n      return;\n    }\n    if (selected.isOpen()) {\n      return selected.close();\n    }\n    if ((!selected.parent) || selected.parent.isRoot()) {\n      return;\n    }\n    return selected.parent.select();\n  };\n\n  TreemaNode.prototype.navigateIn = function() {\n    var treema, _i, _len, _ref, _results;\n    _ref = this.getSelectedTreemas();\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      treema = _ref[_i];\n      if (!treema.collection) {\n        continue;\n      }\n      if (treema.isClosed()) {\n        _results.push(treema.open());\n      } else {\n        _results.push(void 0);\n      }\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.traversalContext = function(offset) {\n    var list, origin, _ref;\n    list = this.getNavigableElements(offset);\n    origin = (_ref = this.getLastSelectedTreema()) != null ? _ref.$el[0] : void 0;\n    if (!origin) {\n      origin = this.getRootEl().find('.treema-add-child:focus')[0];\n    }\n    if (!origin) {\n      origin = this.getRootEl().find('.treema-new-prop')[0];\n    }\n    return this.wrapContext(list, origin, offset);\n  };\n\n  TreemaNode.prototype.navigationContext = function() {\n    var list, origin;\n    list = this.getFilterVisibleTreemas();\n    origin = this.getLastSelectedTreema();\n    return this.wrapContext(list, origin);\n  };\n\n  TreemaNode.prototype.wrapContext = function(list, origin, offset) {\n    var c, originIndex;\n    if (offset == null) {\n      offset = 1;\n    }\n    if (!list.length) {\n      return;\n    }\n    c = {\n      first: list[0],\n      last: list[list.length - 1],\n      origin: origin\n    };\n    if (origin) {\n      offset = Math.abs(offset);\n      originIndex = list.indexOf(origin);\n      c.next = list[originIndex + offset];\n      c.prev = list[originIndex - offset];\n    }\n    return c;\n  };\n\n  TreemaNode.prototype.canEdit = function() {\n    var _ref;\n    if (this.workingSchema.readOnly || ((_ref = this.parent) != null ? _ref.schema.readOnly : void 0)) {\n      return false;\n    }\n    if (this.settings.readOnly) {\n      return false;\n    }\n    if (!this.editable) {\n      return false;\n    }\n    if (!this.directlyEditable) {\n      return false;\n    }\n    if (this.collection && this.isOpen()) {\n      return false;\n    }\n    return true;\n  };\n\n  TreemaNode.prototype.display = function() {\n    return this.toggleEdit('treema-display');\n  };\n\n  TreemaNode.prototype.edit = function(options) {\n    if (options == null) {\n      options = {};\n    }\n    this.toggleEdit('treema-edit');\n    if ((options.offset != null) && options.offset < 0) {\n      return this.focusLastInput();\n    }\n  };\n\n  TreemaNode.prototype.toggleEdit = function(toClass) {\n    var valEl;\n    if (toClass == null) {\n      toClass = null;\n    }\n    if (!this.editable) {\n      return;\n    }\n    valEl = this.getValEl();\n    if (toClass && valEl.hasClass(toClass)) {\n      return;\n    }\n    toClass = toClass || (valEl.hasClass('treema-display') ? 'treema-edit' : 'treema-display');\n    if (toClass === 'treema-edit') {\n      this.endExistingEdits();\n    }\n    valEl.removeClass('treema-display').removeClass('treema-edit').addClass(toClass);\n    valEl.empty();\n    if (this.isDisplaying()) {\n      this.buildValueForDisplay(valEl, this.getData());\n    }\n    if (this.isEditing()) {\n      this.buildValueForEditing(valEl, this.getData());\n      return this.deselectAll();\n    }\n  };\n\n  TreemaNode.prototype.endExistingEdits = function() {\n    var editing, elem, treema, _i, _len, _results;\n    editing = this.getRootEl().find('.treema-edit').closest('.treema-node');\n    _results = [];\n    for (_i = 0, _len = editing.length; _i < _len; _i++) {\n      elem = editing[_i];\n      treema = $(elem).data('instance');\n      treema.saveChanges(treema.getValEl());\n      treema.display();\n      _results.push(this.markAsChanged());\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.flushChanges = function() {\n    var parent, _results;\n    if (this.parent && (!this.integrated) && this.data !== void 0) {\n      this.parent.integrateChildTreema(this);\n    }\n    this.getRoot().cachedErrors = null;\n    this.markAsChanged();\n    if (!this.parent) {\n      return this.refreshErrors();\n    }\n    this.updateDefaultClass();\n    if (this.data !== void 0) {\n      this.parent.data[this.keyForParent] = this.data;\n    }\n    this.parent.refreshErrors();\n    parent = this.parent;\n    _results = [];\n    while (parent) {\n      parent.buildValueForDisplay(parent.getValEl().empty(), parent.getData());\n      _results.push(parent = parent.parent);\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.focusLastInput = function() {\n    var inputs, last;\n    inputs = this.getInputs();\n    last = inputs[inputs.length - 1];\n    return $(last).focus().select();\n  };\n\n  TreemaNode.prototype.removeSelectedNodes = function(nodes) {\n    var data, nextSibling, parentPaths, paths, prevSibling, selected, toSelect, treema, _i, _j, _len, _len1, _ref;\n    if (nodes == null) {\n      nodes = [];\n    }\n    selected = nodes;\n    if (!nodes.length) {\n      selected = this.getSelectedTreemas();\n    }\n    toSelect = null;\n    if (selected.length === 1) {\n      nextSibling = selected[0].$el.next('.treema-node').data('instance');\n      prevSibling = selected[0].$el.prev('.treema-node').data('instance');\n      toSelect = nextSibling || prevSibling || selected[0].parent;\n    }\n    data = [];\n    paths = [];\n    parentPaths = [];\n    this.getRoot().hush = true;\n    for (_i = 0, _len = selected.length; _i < _len; _i++) {\n      treema = selected[_i];\n      data.push(treema.data);\n      paths.push(treema.getPath());\n      parentPaths.push((_ref = treema.parent) != null ? _ref.getPath() : void 0);\n    }\n    this.addTrackedAction({\n      'data': data,\n      'path': paths,\n      'parentPath': parentPaths,\n      'action': 'delete'\n    });\n    for (_j = 0, _len1 = selected.length; _j < _len1; _j++) {\n      treema = selected[_j];\n      treema.remove();\n    }\n    if (toSelect && !this.getSelectedTreemas().length) {\n      toSelect.select();\n    }\n    this.getRoot().hush = false;\n    return this.broadcastChanges();\n  };\n\n  TreemaNode.prototype.remove = function() {\n    var newNode, options, readOnly, required, tempError, _ref, _ref1;\n    required = this.parent && (this.parent.schema.required != null) && (_ref = this.keyForParent, __indexOf.call(this.parent.schema.required, _ref) >= 0);\n    if (required) {\n      tempError = this.createTemporaryError('required');\n      this.$el.prepend(tempError);\n      return false;\n    }\n    readOnly = this.workingSchema.readOnly || ((_ref1 = this.parent) != null ? _ref1.schema.readOnly : void 0);\n    if (readOnly) {\n      tempError = this.createTemporaryError('read only');\n      this.$el.prepend(tempError);\n      return false;\n    }\n    if (this.defaultData !== void 0) {\n      options = $.extend({}, this.settings, {\n        defaultData: this.defaultData,\n        schema: this.workingSchema\n      });\n      newNode = TreemaNode.make(null, options, this.parent, this.keyForParent);\n      if (this.parent) {\n        this.parent.segregateChildTreema(this);\n      }\n      this.replaceNode(newNode);\n      this.destroy();\n      return true;\n    }\n    this.$el.remove();\n    if (document.activeElement === $('body')[0]) {\n      this.keepFocus();\n    }\n    if (this.parent) {\n      this.parent.segregateChildTreema(this);\n    }\n    this.destroy();\n    return true;\n  };\n\n  TreemaNode.prototype.updateDefaultClass = function() {\n    var child, key, _ref, _results;\n    this.$el.removeClass('treema-default-stub');\n    if (this.isDefaultStub() && !this.parent.isDefaultStub()) {\n      this.$el.addClass('treema-default-stub');\n    }\n    _ref = this.childrenTreemas;\n    _results = [];\n    for (key in _ref) {\n      child = _ref[key];\n      _results.push(child.updateDefaultClass());\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.toggleOpen = function() {\n    if (this.isClosed()) {\n      this.open();\n    } else {\n      this.close();\n    }\n    return this;\n  };\n\n  TreemaNode.prototype.open = function(depth) {\n    var child, childIndex, childNode, childrenContainer, treema, _i, _len, _ref, _ref1, _ref2, _results;\n    var this_ = this;\n    if (depth == null) {\n      depth = 1;\n    }\n    if (this.isClosed()) {\n      childrenContainer = this.$el.find('.treema-children').detach();\n      childrenContainer.empty();\n      this.childrenTreemas = {};\n      _ref = this.getChildren();\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        child = _ref[_i];\n        if (child.schema.format === 'hidden') {\n          continue;\n        }\n        treema = TreemaNode.make(null, {\n          schema: child.schema,\n          data: child.value,\n          defaultData: child.defaultData\n        }, this, child.key);\n        if (!(treema.data === void 0 || (this.data === void 0 && !this.integrated))) {\n          this.integrateChildTreema(treema);\n        }\n        this.childrenTreemas[treema.keyForParent] = treema;\n        childNode = this.createChildNode(treema);\n        childrenContainer.append(childNode);\n      }\n      this.$el.append(childrenContainer).removeClass('treema-closed').addClass('treema-open');\n      childrenContainer.append($(this.addChildTemplate));\n      if (this.ordered && childrenContainer.sortable && !this.settings.noSortable) {\n        if (typeof childrenContainer.sortable === \"function\") {\n          childrenContainer.sortable({\n            deactivate: this.orderDataFromUI,\n            forcePlaceholderSize: true,\n            placeholder: 'placeholder'\n          });\n        }\n      }\n      this.refreshErrors();\n    }\n    depth -= 1;\n    if (depth) {\n      _ref2 = (_ref1 = this.childrenTreemas) != null ? _ref1 : {};\n      _results = [];\n      for (childIndex in _ref2) {\n        child = _ref2[childIndex];\n        _results.push(child.open(depth));\n      }\n      return _results;\n    }\n  };\n\n  TreemaNode.prototype.orderDataFromUI = function() {\n    var child, children, index, treema, _i, _len;\n    children = this.$el.find('> .treema-children > .treema-node');\n    index = 0;\n    this.childrenTreemas = {};\n    this.data = $.isArray(this.data) ? [] : {};\n    for (_i = 0, _len = children.length; _i < _len; _i++) {\n      child = children[_i];\n      treema = $(child).data('instance');\n      if (!(treema != null ? treema.data : void 0)) {\n        continue;\n      }\n      if ($.isArray(this.data)) {\n        treema.keyForParent = index;\n        this.childrenTreemas[index] = treema;\n        this.data[index] = treema.data;\n      } else {\n        this.childrenTreemas[treema.keyForParent] = treema;\n        this.data[treema.keyForParent] = treema.data;\n      }\n      index += 1;\n    }\n    return this.refreshDisplay();\n  };\n\n  TreemaNode.prototype.close = function(saveChildData) {\n    var child, key, treema, _ref;\n    if (saveChildData == null) {\n      saveChildData = true;\n    }\n    if (!this.isOpen()) {\n      return;\n    }\n    if (saveChildData) {\n      _ref = this.childrenTreemas;\n      for (key in _ref) {\n        treema = _ref[key];\n        if (treema.integrated) {\n          this.data[key] = treema.data;\n        }\n      }\n    }\n    this.$el.find('.treema-children').empty();\n    this.$el.addClass('treema-closed').removeClass('treema-open');\n    for (child in this.childrenTreemas) {\n      this.childrenTreemas[child].destroy();\n    }\n    this.childrenTreemas = null;\n    this.refreshErrors();\n    return this.buildValueForDisplay(this.getValEl().empty(), this.getData());\n  };\n\n  TreemaNode.prototype.select = function() {\n    var excludeSelf, numSelected;\n    numSelected = this.getSelectedTreemas().length;\n    excludeSelf = numSelected === 1;\n    this.deselectAll(excludeSelf);\n    this.toggleSelect();\n    this.keepFocus();\n    TreemaNode.didSelect = true;\n    return TreemaNode.lastTreemaWithFocus = this.getRoot();\n  };\n\n  TreemaNode.prototype.deselectAll = function(excludeSelf) {\n    var treema, _i, _len, _ref;\n    if (excludeSelf == null) {\n      excludeSelf = false;\n    }\n    _ref = this.getSelectedTreemas();\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      treema = _ref[_i];\n      if (excludeSelf && treema === this) {\n        continue;\n      }\n      treema.$el.removeClass('treema-selected');\n    }\n    this.clearLastSelected();\n    return TreemaNode.didSelect = true;\n  };\n\n  TreemaNode.prototype.toggleSelect = function() {\n    this.clearLastSelected();\n    if (!this.isRoot()) {\n      this.$el.toggleClass('treema-selected');\n    }\n    if (this.isSelected()) {\n      this.setLastSelectedTreema(this);\n    }\n    return TreemaNode.didSelect = true;\n  };\n\n  TreemaNode.prototype.clearLastSelected = function() {\n    var _ref;\n    if ((_ref = this.getLastSelectedTreema()) != null) {\n      _ref.$el.removeClass('treema-last-selected');\n    }\n    return this.setLastSelectedTreema(null);\n  };\n\n  TreemaNode.prototype.shiftSelect = function() {\n    var allNodes, endNodes, lastSelected, node, started, _i, _len;\n    lastSelected = this.getRootEl().find('.treema-last-selected');\n    this.select();\n    if (!lastSelected.length) {\n      return;\n    }\n    this.deselectAll();\n    allNodes = this.getRootEl().find('.treema-node');\n    endNodes = [this, lastSelected.data('instance')];\n    started = false;\n    for (_i = 0, _len = allNodes.length; _i < _len; _i++) {\n      node = allNodes[_i];\n      node = $(node).data('instance');\n      if (!started) {\n        if (__indexOf.call(endNodes, node) >= 0) {\n          node.$el.addClass('treema-selected');\n          started = true;\n        }\n        continue;\n      }\n      node.$el.addClass('treema-selected');\n      if (started && (__indexOf.call(endNodes, node) >= 0)) {\n        break;\n      }\n    }\n    lastSelected.removeClass('treema-last-selected');\n    this.$el.addClass('treema-last-selected');\n    return TreemaNode.didSelect = true;\n  };\n\n  TreemaNode.prototype.addTrackedAction = function(action) {\n    var root;\n    root = this.getRoot();\n    if (root.trackingDisabled) {\n      return;\n    }\n    root.trackedActions.splice(root.currentStateIndex, root.trackedActions.length - root.currentStateIndex);\n    root.trackedActions.push(action);\n    return root.currentStateIndex++;\n  };\n\n  TreemaNode.prototype.disableTracking = function() {\n    return this.getRoot().trackingDisabled = true;\n  };\n\n  TreemaNode.prototype.enableTracking = function() {\n    return this.getRoot().trackingDisabled = false;\n  };\n\n  TreemaNode.prototype.canUndo = function() {\n    return this.getCurrentStateIndex() !== 0;\n  };\n\n  TreemaNode.prototype.undo = function() {\n    var currentStateIndex, deleteIndex, i, parentData, parentPath, restoreChange, root, trackedActions, treemaData, treemaPath, _i, _len, _ref;\n    if (!this.canUndo()) {\n      return;\n    }\n    trackedActions = this.getTrackedActions();\n    currentStateIndex = this.getCurrentStateIndex();\n    root = this.getRoot();\n    this.disableTracking();\n    restoreChange = trackedActions[currentStateIndex - 1];\n    switch (restoreChange.action) {\n      case 'delete':\n        if (!$.isArray(restoreChange.path)) {\n          restoreChange.data = [restoreChange.data];\n          restoreChange.path = [restoreChange.path];\n          restoreChange.parentPath = [restoreChange.parentPath];\n        }\n        _ref = restoreChange.data;\n        for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n          treemaData = _ref[i];\n          parentPath = restoreChange.parentPath[i];\n          treemaPath = restoreChange.path[i];\n          parentData = this.get(parentPath);\n          switch ($.isArray(parentData)) {\n            case false:\n              this.set(treemaPath, treemaData);\n              break;\n            case true:\n              deleteIndex = parseInt(treemaPath.substring(treemaPath.lastIndexOf('/') + 1));\n              if (deleteIndex < parentData.length) {\n                parentData.splice(deleteIndex, 0, treemaData);\n                this.set(parentPath, parentData);\n              } else {\n                this.insert(parentPath, treemaData);\n              }\n          }\n        }\n        break;\n      case 'edit':\n        if (restoreChange.oldData === void 0) {\n          this[\"delete\"](restoreChange.path);\n        } else {\n          this.set(restoreChange.path, restoreChange.oldData);\n        }\n        break;\n      case 'replace':\n        restoreChange.newNode.replaceNode(restoreChange.oldNode);\n        this.set(restoreChange.path, restoreChange.oldNode.data);\n        break;\n      case 'insert':\n        this[\"delete\"](restoreChange.path);\n    }\n    root.currentStateIndex--;\n    return this.enableTracking();\n  };\n\n  TreemaNode.prototype.canRedo = function() {\n    return this.getCurrentStateIndex() !== this.getTrackedActions().length;\n  };\n\n  TreemaNode.prototype.redo = function() {\n    var currentStateIndex, parentData, path, restoreChange, root, trackedActions, _i, _len, _ref;\n    if (!this.canRedo()) {\n      return;\n    }\n    trackedActions = this.getTrackedActions();\n    currentStateIndex = this.getCurrentStateIndex();\n    root = this.getRoot();\n    this.disableTracking();\n    restoreChange = trackedActions[currentStateIndex];\n    switch (restoreChange.action) {\n      case 'delete':\n        if (!$.isArray(restoreChange.path)) {\n          restoreChange.path = [restoreChange.path];\n        }\n        _ref = restoreChange.path;\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          path = _ref[_i];\n          this[\"delete\"](path);\n        }\n        break;\n      case 'edit':\n        this.set(restoreChange.path, restoreChange.newData);\n        break;\n      case 'replace':\n        restoreChange.oldNode.replaceNode(restoreChange.newNode);\n        this.set(restoreChange.path, restoreChange.newNode.data);\n        break;\n      case 'insert':\n        parentData = this.get(restoreChange.parentPath);\n        switch ($.isArray(parentData)) {\n          case true:\n            this.insert(restoreChange.parentPath, restoreChange.data);\n            break;\n          case false:\n            this.set(restoreChange.path, restoreChange.data);\n        }\n    }\n    root.currentStateIndex++;\n    return this.enableTracking();\n  };\n\n  TreemaNode.prototype.getUndoDescription = function() {\n    var currentStateIndex, trackedActions;\n    if (!this.canUndo()) {\n      return '';\n    }\n    trackedActions = this.getTrackedActions();\n    currentStateIndex = this.getCurrentStateIndex();\n    return this.getTrackedActionDescription(trackedActions[currentStateIndex - 1]);\n  };\n\n  TreemaNode.prototype.getRedoDescription = function() {\n    var currentStateIndex, trackedActions;\n    if (!this.canRedo()) {\n      return '';\n    }\n    trackedActions = this.getTrackedActions();\n    currentStateIndex = this.getCurrentStateIndex();\n    return this.getTrackedActionDescription(trackedActions[currentStateIndex]);\n  };\n\n  TreemaNode.prototype.getTrackedActionDescription = function(trackedAction) {\n    var path, trackedActionDescription;\n    switch (trackedAction.action) {\n      case 'insert':\n        trackedActionDescription = 'Add New ' + this.nodeDescription;\n        break;\n      case 'delete':\n        trackedActionDescription = 'Delete ' + this.nodeDescription;\n        break;\n      case 'edit':\n        path = trackedAction.path.split('/');\n        if (path[path.length - 1] === 'pos') {\n          trackedActionDescription = 'Move ' + this.nodeDescription;\n        } else {\n          trackedActionDescription = 'Edit ' + this.nodeDescription;\n        }\n        break;\n      default:\n        trackedActionDescription = '';\n    }\n    return trackedActionDescription;\n  };\n\n  TreemaNode.prototype.getTrackedActions = function() {\n    return this.getRoot().trackedActions;\n  };\n\n  TreemaNode.prototype.getCurrentStateIndex = function() {\n    return this.getRoot().currentStateIndex;\n  };\n\n  TreemaNode.prototype.onSelectSchema = function(e) {\n    var index, newNode, settings, workingSchema;\n    index = parseInt($(e.target).val());\n    workingSchema = this.workingSchemas[index];\n    settings = $.extend(true, {}, this.settings);\n    settings = $.extend(settings, {\n      workingSchemas: this.workingSchemas,\n      workingSchema: workingSchema,\n      data: this.data,\n      defaultData: this.defaultData,\n      schema: this.schema\n    });\n    newNode = TreemaNode.make(null, settings, this.parent, this.keyForParent);\n    return this.replaceNode(newNode);\n  };\n\n  TreemaNode.prototype.onSelectType = function(e) {\n    var newNode, newType, settings;\n    newType = $(e.target).val();\n    settings = $.extend(true, {}, this.settings, {\n      workingSchemas: this.workingSchemas,\n      workingSchema: this.workingSchema,\n      type: newType,\n      data: this.data,\n      defaultData: this.defaultData,\n      schema: this.schema\n    });\n    if ($.type(this.data) !== newType) {\n      settings.data = TreemaNode.defaultForType(newType);\n    }\n    newNode = TreemaNode.make(null, settings, this.parent, this.keyForParent);\n    return this.replaceNode(newNode);\n  };\n\n  TreemaNode.prototype.replaceNode = function(newNode) {\n    newNode.tv4 = this.tv4;\n    if (this.keyForParent != null) {\n      newNode.keyForParent = this.keyForParent;\n    }\n    if (this.parent) {\n      this.parent.childrenTreemas[this.keyForParent] = newNode;\n    }\n    this.parent.createChildNode(newNode);\n    this.$el.replaceWith(newNode.$el);\n    newNode.flushChanges();\n    return this.addTrackedAction({\n      'oldNode': this,\n      'newNode': newNode,\n      'path': this.getPath(),\n      'action': 'replace'\n    });\n  };\n\n  TreemaNode.prototype.integrateChildTreema = function(treema) {\n    var newData;\n    if (this.parent && !this.integrated) {\n      this.data = $.isArray(this.defaultData) ? [] : {};\n      this.parent.integrateChildTreema(this);\n    } else {\n      treema.updateDefaultClass();\n    }\n    newData = this.data[treema.keyForParent] !== treema.data;\n    treema.integrated = true;\n    this.childrenTreemas[treema.keyForParent] = treema;\n    this.data[treema.keyForParent] = treema.data;\n    if (newData) {\n      if (this.ordered) {\n        this.orderDataFromUI();\n      }\n      this.refreshErrors();\n      this.updateMyAddButton();\n      this.markAsChanged();\n      this.buildValueForDisplay(this.getValEl().empty(), this.getData());\n      this.broadcastChanges();\n    }\n    return treema;\n  };\n\n  TreemaNode.prototype.segregateChildTreema = function(treema) {\n    treema.integrated = false;\n    delete this.childrenTreemas[treema.keyForParent];\n    delete this.data[treema.keyForParent];\n    if (this.ordered) {\n      this.orderDataFromUI();\n    }\n    this.refreshErrors();\n    this.updateMyAddButton();\n    this.markAsChanged();\n    this.buildValueForDisplay(this.getValEl().empty(), this.getData());\n    this.broadcastChanges();\n    return treema;\n  };\n\n  TreemaNode.prototype.createChildNode = function(treema) {\n    var childNode, defnEl, keyEl, name, required, row, suffix, _ref;\n    childNode = treema.build();\n    row = childNode.find('.treema-row');\n    if (this.collection && this.keyed) {\n      name = treema.schema.title || treema.keyForParent;\n      required = this.workingSchema.required || [];\n      suffix = ': ';\n      if (_ref = treema.keyForParent, __indexOf.call(required, _ref) >= 0) {\n        suffix = '*' + suffix;\n      }\n      keyEl = $(this.keyTemplate).text(name + suffix);\n      row.prepend(keyEl);\n      defnEl = $('<span></span>').addClass('treema-description').text(treema.schema.description || '');\n      row.append(defnEl);\n    }\n    if (treema.collection) {\n      childNode.prepend($(this.toggleTemplate));\n    }\n    return childNode;\n  };\n\n  TreemaNode.prototype.refreshErrors = function() {\n    this.clearErrors();\n    return this.showErrors();\n  };\n\n  TreemaNode.prototype.showErrors = function() {\n    var childErrors, deepestTreema, e, error, erroredTreemas, errors, message, messages, ownErrors, path, subpath, treema, _i, _j, _k, _len, _len1, _len2, _ref, _ref1, _results;\n    if (this.parent && !this.integrated) {\n      return;\n    }\n    if (this.settings.skipValidation) {\n      return;\n    }\n    errors = this.getErrors();\n    erroredTreemas = [];\n    for (_i = 0, _len = errors.length; _i < _len; _i++) {\n      error = errors[_i];\n      path = ((_ref = error.subDataPath) != null ? _ref : error.dataPath).slice(1);\n      path = path ? path.split('/') : [];\n      deepestTreema = this;\n      for (_j = 0, _len1 = path.length; _j < _len1; _j++) {\n        subpath = path[_j];\n        if (!deepestTreema.childrenTreemas) {\n          error.forChild = true;\n          break;\n        }\n        if (deepestTreema.ordered) {\n          subpath = parseInt(subpath);\n        }\n        deepestTreema = deepestTreema.childrenTreemas[subpath];\n        if (!deepestTreema) {\n          console.error('could not find treema down path', path, this, \"so couldn't show error\", error);\n          return;\n        }\n      }\n      if (!(deepestTreema._errors && __indexOf.call(erroredTreemas, deepestTreema) >= 0)) {\n        deepestTreema._errors = [];\n      }\n      deepestTreema._errors.push(error);\n      erroredTreemas.push(deepestTreema);\n    }\n    _ref1 = $.unique(erroredTreemas);\n    _results = [];\n    for (_k = 0, _len2 = _ref1.length; _k < _len2; _k++) {\n      treema = _ref1[_k];\n      childErrors = (function() {\n        var _l, _len3, _ref2, _results1;\n        _ref2 = treema._errors;\n        _results1 = [];\n        for (_l = 0, _len3 = _ref2.length; _l < _len3; _l++) {\n          e = _ref2[_l];\n          if (e.forChild) {\n            _results1.push(e);\n          }\n        }\n        return _results1;\n      })();\n      ownErrors = (function() {\n        var _l, _len3, _ref2, _results1;\n        _ref2 = treema._errors;\n        _results1 = [];\n        for (_l = 0, _len3 = _ref2.length; _l < _len3; _l++) {\n          e = _ref2[_l];\n          if (!e.forChild) {\n            _results1.push(e);\n          }\n        }\n        return _results1;\n      })();\n      messages = (function() {\n        var _l, _len3, _results1;\n        _results1 = [];\n        for (_l = 0, _len3 = ownErrors.length; _l < _len3; _l++) {\n          e = ownErrors[_l];\n          _results1.push(e.message);\n        }\n        return _results1;\n      })();\n      if (childErrors.length > 0) {\n        message = \"[\" + childErrors.length + \"] error\";\n        if (childErrors.length > 1) {\n          message = message + 's';\n        }\n        messages.push(message);\n      }\n      _results.push(treema.showError(messages.join('<br />')));\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.showError = function(message) {\n    this.$el.prepend($(this.errorTemplate));\n    this.$el.find('> .treema-error').html(message).show();\n    return this.$el.addClass('treema-has-error');\n  };\n\n  TreemaNode.prototype.clearErrors = function() {\n    this.$el.find('.treema-error').remove();\n    this.$el.find('.treema-has-error').removeClass('treema-has-error');\n    return this.$el.removeClass('treema-has-error');\n  };\n\n  TreemaNode.prototype.createTemporaryError = function(message, attachFunction) {\n    if (attachFunction == null) {\n      attachFunction = null;\n    }\n    if (!attachFunction) {\n      attachFunction = this.$el.prepend;\n    }\n    this.clearTemporaryErrors();\n    return $(this.tempErrorTemplate).text(message).delay(3000).fadeOut(1000, function() {\n      return $(this).remove();\n    });\n  };\n\n  TreemaNode.prototype.clearTemporaryErrors = function() {\n    return this.getRootEl().find('.treema-temp-error').remove();\n  };\n\n  TreemaNode.prototype.get = function(path) {\n    var data, seg, _i, _len;\n    if (path == null) {\n      path = '/';\n    }\n    path = this.normalizePath(path);\n    if (path.length === 0) {\n      return this.data;\n    }\n    if (this.childrenTreemas != null) {\n      return this.digDeeper(path, 'get', void 0, []);\n    }\n    data = this.data;\n    for (_i = 0, _len = path.length; _i < _len; _i++) {\n      seg = path[_i];\n      data = data[this.normalizeKey(seg, data)];\n      if (data === void 0) {\n        break;\n      }\n    }\n    return data;\n  };\n\n  TreemaNode.prototype.set = function(path, newData) {\n    var oldData;\n    oldData = this.get(path);\n    if (this.setRecursive(path, newData)) {\n      if (JSON.stringify(newData) !== JSON.stringify(oldData)) {\n        this.addTrackedAction({\n          'oldData': oldData,\n          'newData': newData,\n          'path': path,\n          'action': 'edit'\n        });\n      }\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  TreemaNode.prototype.setRecursive = function(path, newData) {\n    var data, i, nodePath, oldData, result, seg, _i, _len;\n    path = this.normalizePath(path);\n    if (path.length === 0) {\n      this.data = newData;\n      this.refreshDisplay();\n      return true;\n    }\n    if (this.childrenTreemas != null) {\n      result = this.digDeeper(path, 'setRecursive', false, [newData]);\n      if (result === false && path.length === 1 && $.isPlainObject(this.data)) {\n        this.data[path[0]] = newData;\n        this.refreshDisplay();\n        return true;\n      }\n      return result;\n    }\n    data = this.data;\n    nodePath = this.getPath();\n    for (i = _i = 0, _len = path.length; _i < _len; i = ++_i) {\n      seg = path[i];\n      seg = this.normalizeKey(seg, data);\n      if (path.length === i + 1) {\n        oldData = data[seg];\n        data[seg] = newData;\n        this.refreshDisplay();\n        return true;\n      } else {\n        data = data[seg];\n        if (data === void 0) {\n          return false;\n        }\n      }\n    }\n  };\n\n  TreemaNode.prototype[\"delete\"] = function(path) {\n    var oldData, parentPath;\n    oldData = this.get(path);\n    if (this.deleteRecursive(path)) {\n      parentPath = path.substring(0, path.lastIndexOf('/'));\n      this.addTrackedAction({\n        'data': oldData,\n        'path': path,\n        'parentPath': parentPath,\n        'action': 'delete'\n      });\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  TreemaNode.prototype.deleteRecursive = function(path) {\n    var data, i, parentPath, seg, _i, _len;\n    path = this.normalizePath(path);\n    if (path.length === 0) {\n      return this.remove();\n    }\n    if (this.childrenTreemas != null) {\n      return this.digDeeper(path, 'deleteRecursive', false, []);\n    }\n    data = this.data;\n    parentPath = this.getPath();\n    for (i = _i = 0, _len = path.length; _i < _len; i = ++_i) {\n      seg = path[i];\n      seg = this.normalizeKey(seg, data);\n      if (path.length === i + 1) {\n        if ($.isArray(data)) {\n          data.splice(seg, 1);\n        } else {\n          delete data[seg];\n        }\n        this.refreshDisplay();\n        return true;\n      } else {\n        data = data[seg];\n        if (data === void 0) {\n          return false;\n        }\n      }\n      parentPath += '/' + seg;\n    }\n  };\n\n  TreemaNode.prototype.insert = function(path, newData) {\n    var childPath, insertPos, key, parentData, parentPath, val;\n    if (this.insertRecursive(path, newData)) {\n      parentPath = path;\n      parentData = this.get(parentPath);\n      childPath = parentPath;\n      if (parentPath !== '/') {\n        childPath += '/';\n      }\n      if (parentData[parentData.length - 1] !== newData) {\n        for (key in parentData) {\n          val = parentData[key];\n          if (JSON.stringify(val) === JSON.stringify(newData)) {\n            insertPos = key;\n            break;\n          }\n        }\n      } else {\n        insertPos = parentData.length - 1;\n      }\n      childPath += insertPos.toString();\n      this.addTrackedAction({\n        'data': newData,\n        'path': childPath,\n        'parentPath': parentPath,\n        'action': 'insert'\n      });\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  TreemaNode.prototype.insertRecursive = function(path, newData) {\n    var data, i, parentPath, seg, _i, _len;\n    path = this.normalizePath(path);\n    if (path.length === 0) {\n      if (!$.isArray(this.data)) {\n        return false;\n      }\n      this.data.push(newData);\n      this.refreshDisplay();\n      this.flushChanges();\n      return true;\n    }\n    if (this.childrenTreemas != null) {\n      return this.digDeeper(path, 'insertRecursive', false, [newData]);\n    }\n    data = this.data;\n    parentPath = this.getPath();\n    for (i = _i = 0, _len = path.length; _i < _len; i = ++_i) {\n      seg = path[i];\n      parentPath += '/' + seg;\n      seg = this.normalizeKey(seg, data);\n      data = data[seg];\n      if (data === void 0) {\n        return false;\n      }\n    }\n    if (!$.isArray(data)) {\n      return false;\n    }\n    data.push(newData);\n    this.refreshDisplay();\n    return true;\n  };\n\n  TreemaNode.prototype.normalizeKey = function(key, collection) {\n    var i, parts, value, _i, _len;\n    if ($.isArray(collection)) {\n      if (__indexOf.call(key, '=') >= 0) {\n        parts = key.split('=');\n        for (i = _i = 0, _len = collection.length; _i < _len; i = ++_i) {\n          value = collection[i];\n          if (value[parts[0]] === parts[1]) {\n            return i;\n          }\n        }\n      } else {\n        return parseInt(key);\n      }\n    }\n    return key;\n  };\n\n  TreemaNode.prototype.normalizePath = function(path) {\n    var s;\n    if ($.type(path) === 'string') {\n      path = path.split('/');\n      path = (function() {\n        var _i, _len, _results;\n        _results = [];\n        for (_i = 0, _len = path.length; _i < _len; _i++) {\n          s = path[_i];\n          if (s.length) {\n            _results.push(s);\n          }\n        }\n        return _results;\n      })();\n    }\n    return path;\n  };\n\n  TreemaNode.prototype.digDeeper = function(path, func, def, args) {\n    var childTreema, seg;\n    seg = this.normalizeKey(path[0], this.data);\n    childTreema = this.childrenTreemas[seg];\n    if (childTreema === void 0 || !childTreema.integrated) {\n      return def;\n    }\n    return childTreema[func].apply(childTreema, [path.slice(1)].concat(__slice.call(args)));\n  };\n\n  TreemaNode.prototype.refreshDisplay = function() {\n    if (this.isDisplaying()) {\n      this.buildValueForDisplay(this.getValEl().empty(), this.getData());\n    } else {\n      this.display();\n    }\n    if (this.collection && this.isOpen()) {\n      this.close(false);\n      this.open();\n    }\n    this.flushChanges();\n    return this.broadcastChanges();\n  };\n\n  TreemaNode.prototype.getNodeEl = function() {\n    return this.$el;\n  };\n\n  TreemaNode.prototype.getValEl = function() {\n    return this.$el.find('> .treema-row .treema-value');\n  };\n\n  TreemaNode.prototype.getRootEl = function() {\n    return this.$el.closest('.treema-root');\n  };\n\n  TreemaNode.prototype.getRoot = function() {\n    var node;\n    node = this;\n    while (node.parent != null) {\n      node = node.parent;\n    }\n    return node;\n  };\n\n  TreemaNode.prototype.getInputs = function() {\n    return this.getValEl().find('input, textarea');\n  };\n\n  TreemaNode.prototype.getSelectedTreemas = function() {\n    var el, _i, _len, _ref, _results;\n    _ref = this.getRootEl().find('.treema-selected');\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      el = _ref[_i];\n      _results.push($(el).data('instance'));\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.getLastSelectedTreema = function() {\n    return this.getRoot().lastSelectedTreema;\n  };\n\n  TreemaNode.prototype.setLastSelectedTreema = function(node) {\n    this.getRoot().lastSelectedTreema = node;\n    return node != null ? node.$el.addClass('treema-last-selected') : void 0;\n  };\n\n  TreemaNode.prototype.getAddButtonEl = function() {\n    return this.$el.find('> .treema-children > .treema-add-child');\n  };\n\n  TreemaNode.prototype.getVisibleTreemas = function() {\n    var el, _i, _len, _ref, _results;\n    _ref = this.getRootEl().find('.treema-node');\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      el = _ref[_i];\n      _results.push($(el).data('instance'));\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.getNavigableElements = function() {\n    return this.getRootEl().find('.treema-node, .treema-add-child:visible').toArray();\n  };\n\n  TreemaNode.prototype.getPath = function() {\n    var pathPieces, pointer;\n    pathPieces = [];\n    pointer = this;\n    while (pointer && (pointer.keyForParent != null)) {\n      pathPieces.push(pointer.keyForParent + '');\n      pointer = pointer.parent;\n    }\n    pathPieces.reverse();\n    return '/' + pathPieces.join('/');\n  };\n\n  TreemaNode.prototype.getData = function() {\n    if ($.type(this.data) === 'undefined') {\n      return this.defaultData;\n    } else {\n      return this.data;\n    }\n  };\n\n  TreemaNode.prototype.isDefaultStub = function() {\n    return this.data === void 0;\n  };\n\n  TreemaNode.getLastTreemaWithFocus = function() {\n    return this.lastTreemaWithFocus;\n  };\n\n  TreemaNode.prototype.isRoot = function() {\n    return !this.parent;\n  };\n\n  TreemaNode.prototype.isEditing = function() {\n    return this.getValEl().hasClass('treema-edit');\n  };\n\n  TreemaNode.prototype.isDisplaying = function() {\n    return this.getValEl().hasClass('treema-display');\n  };\n\n  TreemaNode.prototype.isOpen = function() {\n    return this.$el.hasClass('treema-open');\n  };\n\n  TreemaNode.prototype.isClosed = function() {\n    return this.$el.hasClass('treema-closed');open\n  };\n\n  TreemaNode.prototype.isSelected = function() {\n    return this.$el.hasClass('treema-selected');\n  };\n\n  TreemaNode.prototype.wasSelectedLast = function() {\n    return this.$el.hasClass('treema-last-selected');\n  };\n\n  TreemaNode.prototype.editingIsHappening = function() {\n    return this.getRootEl().find('.treema-edit').length;\n  };\n\n  TreemaNode.prototype.rootSelected = function() {\n    return $(document.activeElement).hasClass('treema-root');\n  };\n\n  TreemaNode.prototype.setFilterVisible = function(isFilterVisible) {\n    if (isFilterVisible) {\n      return this.$el.find('.treema-node').andSelf().removeClass(this.treemaFilterHiddenClass);\n    } else {\n      return this.$el.find('.treema-node').andSelf().addClass(this.treemaFilterHiddenClass);\n    }\n  };\n\n  TreemaNode.prototype.getFilterVisibleTreemas = function() {\n    var el, _i, _len, _ref, _results;\n    _ref = this.getRootEl().find('.treema-node').not('.' + this.treemaFilterHiddenClass);\n    _results = [];\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      el = _ref[_i];\n      _results.push($(el).data('instance'));\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.isFilterVisible = function() {\n    return !this.$el.hasClass(this.treemaFilterHiddenClass);\n  };\n\n  TreemaNode.prototype.saveScrolls = function() {\n    var parent, rootEl, _results;\n    this.scrolls = [];\n    rootEl = this.getRootEl();\n    parent = rootEl;\n    _results = [];\n    while (parent[0]) {\n      this.scrolls.push({\n        el: parent,\n        scrollTop: parent.scrollTop(),\n        scrollLeft: parent.scrollLeft()\n      });\n      if (parent.prop('tagName').toLowerCase() === 'body') {\n        break;\n      }\n      _results.push(parent = parent.parent());\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.loadScrolls = function() {\n    var scroll, _i, _len, _ref;\n    if (!this.scrolls) {\n      return;\n    }\n    _ref = this.scrolls;\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      scroll = _ref[_i];\n      scroll.el.scrollTop(scroll.scrollTop);\n      scroll.el.scrollLeft(scroll.scrollLeft);\n    }\n    return this.scrolls = null;\n  };\n\n  TreemaNode.prototype.keepFocus = function() {\n    this.saveScrolls();\n    this.getRootEl().focus();\n    return this.loadScrolls();\n  };\n\n  TreemaNode.prototype.copyData = function() {\n    return $.extend(null, {}, {\n      'd': this.data\n    })['d'];\n  };\n\n  TreemaNode.prototype.updateMyAddButton = function() {\n    this.$el.removeClass('treema-full');\n    if (!this.canAddChild()) {\n      return this.$el.addClass('treema-full');\n    }\n  };\n\n  TreemaNode.nodeMap = {};\n\n  TreemaNode.setNodeSubclass = function(key, NodeClass) {\n    return this.nodeMap[key] = NodeClass;\n  };\n\n  TreemaNode.make = function(element, options, parent, keyForParent) {\n    var NodeClass, key, localClasses, newNode, schema, tv4, type, value, workingData, workingSchema, workingSchemas, _ref, _ref1;\n    schema = options.schema || {};\n    if (schema.$ref) {\n      tv4 = options.tv4 || (parent != null ? parent.tv4 : void 0);\n      if (!tv4) {\n        tv4 = TreemaUtils.getGlobalTv4().freshApi();\n        tv4.addSchema('#', schema);\n      }\n      schema = this.utils.resolveReference(schema, tv4);\n    }\n    if ((schema[\"default\"] != null) && !((options.data != null) || (options.defaultData != null))) {\n      if ($.type(schema[\"default\"]) === 'object') {\n        options.data = {};\n      } else {\n        options.data = this.utils.cloneDeep(schema[\"default\"]);\n      }\n    }\n    workingData = options.data || options.defaultData;\n    workingSchemas = options.workingSchemas || this.utils.buildWorkingSchemas(schema, parent != null ? parent.tv4 : void 0);\n    workingSchema = options.workingSchema || this.utils.chooseWorkingSchema(workingData, workingSchemas, options.tv4);\n    this.massageData(options, workingSchema);\n    type = options.type || $.type((_ref = options.data) != null ? _ref : options.defaultData);\n    if (type === 'undefined') {\n      type = 'null';\n    }\n    localClasses = parent ? parent.settings.nodeClasses : options.nodeClasses;\n    NodeClass = this.getNodeClassForSchema(workingSchema, type, localClasses);\n    if (parent) {\n      _ref1 = parent.settings;\n      for (key in _ref1) {\n        value = _ref1[key];\n        if (key === 'data' || key === 'defaultData' || key === 'schema') {\n          continue;\n        }\n        options[key] = value;\n      }\n    }\n    options.workingSchema = workingSchema;\n    options.workingSchemas = workingSchemas;\n    if (keyForParent != null) {\n      options.keyForParent = keyForParent;\n    }\n    newNode = new NodeClass(element, options, parent);\n    return newNode;\n  };\n\n  TreemaNode.massageData = function(options, workingSchema) {\n    var dataType, defaultDataType, schemaTypes;\n    schemaTypes = workingSchema.type || ['string', 'number', 'integer', 'object', 'array', 'boolean', 'null'];\n    if ($.type(schemaTypes) !== 'array') {\n      schemaTypes = [schemaTypes];\n    }\n    if (__indexOf.call(schemaTypes, 'integer') >= 0 && __indexOf.call(schemaTypes, 'number') < 0) {\n      schemaTypes.push('number');\n    }\n    dataType = $.type(options.data);\n    defaultDataType = $.type(options.defaultData);\n    if (dataType !== 'undefined' && __indexOf.call(schemaTypes, dataType) < 0) {\n      options.data = this.defaultForType(schemaTypes[0]);\n    }\n    if (dataType === 'undefined' && __indexOf.call(schemaTypes, defaultDataType) < 0) {\n      return options.data = this.defaultForType(schemaTypes[0]);\n    }\n  };\n\n  TreemaNode.defaultForType = function(type) {\n    return TreemaNode.utils.defaultForType(type);\n  };\n\n  TreemaNode.getNodeClassForSchema = function(schema, def, localClasses) {\n    var NodeClass, type, typeMismatch, _ref;\n    if (def == null) {\n      def = 'string';\n    }\n    if (localClasses == null) {\n      localClasses = null;\n    }\n    typeMismatch = false;\n    if (schema.type) {\n      if ($.isArray(schema.type)) {\n        if (_ref = !def, __indexOf.call(schema.type, _ref) >= 0) {\n          typeMismatch = true;\n        }\n      } else {\n        typeMismatch = def !== schema.type;\n      }\n    }\n    NodeClass = null;\n    localClasses = localClasses || {};\n    if (schema.format) {\n      NodeClass = localClasses[schema.format] || this.nodeMap[schema.format];\n    }\n    if (NodeClass && !typeMismatch) {\n      return NodeClass;\n    }\n    type = schema.type || def;\n    if ($.isArray(type) || typeMismatch) {\n      type = def;\n    }\n    NodeClass = localClasses[type] || this.nodeMap[type];\n    if (NodeClass) {\n      return NodeClass;\n    }\n    return this.nodeMap['any'];\n  };\n\n  TreemaNode.extend = function(child) {\n    var ctor;\n    ctor = function() {};\n    ctor.prototype = this.prototype;\n    child.prototype = new ctor();\n    child.prototype.constructor = child;\n    child.__super__ = this.prototype;\n    child.prototype[\"super\"] = function(method) {\n      return this.constructor.__super__[method];\n    };\n    return child;\n  };\n\n  TreemaNode.didSelect = false;\n\n  TreemaNode.changedTreemas = [];\n\n  TreemaNode.prototype.filterChildren = function(filter) {\n    var keyForParent, treemaNode, _ref, _results;\n    _ref = this.childrenTreemas;\n    _results = [];\n    for (keyForParent in _ref) {\n      treemaNode = _ref[keyForParent];\n      _results.push(treemaNode.setFilterVisible(!filter || filter(treemaNode, keyForParent)));\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.clearFilter = function() {\n    var keyForParent, treemaNode, _ref, _results;\n    _ref = this.childrenTreemas;\n    _results = [];\n    for (keyForParent in _ref) {\n      treemaNode = _ref[keyForParent];\n      _results.push(treemaNode.setFilterVisible(true));\n    }\n    return _results;\n  };\n\n  TreemaNode.prototype.destroy = function() {\n    var child;\n    for (child in this.childrenTreemas) {\n      this.childrenTreemas[child].destroy();\n    }\n    return this.$el.remove();\n  };\n\n  return TreemaNode;\n\n})();\n;var __init,\n    __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n(__init = function() {\n  var ArrayNode, BooleanNode, IntegerNode, NullNode, NumberNode, ObjectNode, StringNode, _ref, _ref1, _ref2, _ref3, _ref4, _ref5, _ref6;\n  TreemaNode.setNodeSubclass('string', StringNode = (function(_super) {\n    __extends(StringNode, _super);\n\n    function StringNode() {\n      _ref = StringNode.__super__.constructor.apply(this, arguments);\n      return _ref;\n    }\n\n    StringNode.prototype.valueClass = 'treema-string';\n\n    StringNode.inputTypes = ['color', 'date', 'datetime', 'datetime-local', 'email', 'month', 'range', 'search', 'tel', 'text', 'time', 'url', 'week'];\n\n    StringNode.prototype.buildValueForDisplay = function(valEl, data) {\n      return this.buildValueForDisplaySimply(valEl, \"\\\"\" + data + \"\\\"\");\n    };\n\n    StringNode.prototype.buildValueForEditing = function(valEl, data) {\n      var input, _ref1;\n      input = this.buildValueForEditingSimply(valEl, data);\n      if (this.workingSchema.maxLength) {\n        input.attr('maxlength', this.workingSchema.maxLength);\n      }\n      if (_ref1 = this.workingSchema.format, __indexOf.call(StringNode.inputTypes, _ref1) >= 0) {\n        return input.attr('type', this.workingSchema.format);\n      }\n    };\n\n    StringNode.prototype.saveChanges = function(valEl) {\n      var oldData;\n      oldData = this.data;\n      this.data = $('input', valEl).val();\n      return StringNode.__super__.saveChanges.call(this, oldData);\n    };\n\n    return StringNode;\n\n  })(TreemaNode));\n  TreemaNode.setNodeSubclass('number', NumberNode = (function(_super) {\n    __extends(NumberNode, _super);\n\n    function NumberNode() {\n      _ref1 = NumberNode.__super__.constructor.apply(this, arguments);\n      return _ref1;\n    }\n\n    NumberNode.prototype.valueClass = 'treema-number';\n\n    NumberNode.prototype.buildValueForDisplay = function(valEl, data) {\n      return this.buildValueForDisplaySimply(valEl, JSON.stringify(data));\n    };\n\n    NumberNode.prototype.buildValueForEditing = function(valEl, data) {\n      var input;\n      input = this.buildValueForEditingSimply(valEl, JSON.stringify(data), 'number');\n      if (this.workingSchema.maximum) {\n        input.attr('max', this.workingSchema.maximum);\n      }\n      if (this.workingSchema.minimum) {\n        return input.attr('min', this.workingSchema.minimum);\n      }\n    };\n\n    NumberNode.prototype.saveChanges = function(valEl) {\n      var oldData;\n      oldData = this.data;\n      this.data = parseFloat($('input', valEl).val());\n      return NumberNode.__super__.saveChanges.call(this, oldData);\n    };\n\n    return NumberNode;\n\n  })(TreemaNode));\n  TreemaNode.setNodeSubclass('integer', IntegerNode = (function(_super) {\n    __extends(IntegerNode, _super);\n\n    function IntegerNode() {\n      _ref2 = IntegerNode.__super__.constructor.apply(this, arguments);\n      return _ref2;\n    }\n\n    IntegerNode.prototype.valueClass = 'treema-integer';\n\n    IntegerNode.prototype.buildValueForDisplay = function(valEl, data) {\n      return this.buildValueForDisplaySimply(valEl, JSON.stringify(data));\n    };\n\n    IntegerNode.prototype.buildValueForEditing = function(valEl, data) {\n      var input;\n      input = this.buildValueForEditingSimply(valEl, JSON.stringify(data), 'number');\n      if (this.workingSchema.maximum) {\n        input.attr('max', this.workingSchema.maximum);\n      }\n      if (this.workingSchema.minimum) {\n        return input.attr('min', this.workingSchema.minimum);\n      }\n    };\n\n    IntegerNode.prototype.saveChanges = function(valEl) {\n      var oldData;\n      oldData = this.data;\n      this.data = parseInt($('input', valEl).val());\n      return IntegerNode.__super__.saveChanges.call(this, oldData);\n    };\n\n    return IntegerNode;\n\n  })(TreemaNode));\n  TreemaNode.setNodeSubclass('null', NullNode = NullNode = (function(_super) {\n    __extends(NullNode, _super);\n\n    function NullNode() {\n      _ref3 = NullNode.__super__.constructor.apply(this, arguments);\n      return _ref3;\n    }\n\n    NullNode.prototype.valueClass = 'treema-null';\n\n    NullNode.prototype.editable = false;\n\n    NullNode.prototype.buildValueForDisplay = function(valEl) {\n      return this.buildValueForDisplaySimply(valEl, 'null');\n    };\n\n    return NullNode;\n\n  })(TreemaNode));\n  TreemaNode.setNodeSubclass('boolean', BooleanNode = (function(_super) {\n    __extends(BooleanNode, _super);\n\n    function BooleanNode() {\n      _ref4 = BooleanNode.__super__.constructor.apply(this, arguments);\n      return _ref4;\n    }\n\n    BooleanNode.prototype.valueClass = 'treema-boolean';\n\n    BooleanNode.prototype.buildValueForDisplay = function(valEl, data) {\n      this.buildValueForDisplaySimply(valEl, JSON.stringify(data));\n      return this.keepFocus();\n    };\n\n    BooleanNode.prototype.buildValueForEditing = function(valEl, data) {\n      var input;\n      input = this.buildValueForEditingSimply(valEl, JSON.stringify(data));\n      $('<span></span>').text(JSON.stringify(this.data)).insertBefore(input);\n      return input.focus();\n    };\n\n    BooleanNode.prototype.toggleValue = function(newValue) {\n      var oldData, valEl;\n      if (newValue == null) {\n        newValue = null;\n      }\n      oldData = this.getData();\n      this.data = !this.data;\n      if (newValue != null) {\n        this.data = newValue;\n      }\n      valEl = this.getValEl().empty();\n      if (this.isDisplaying()) {\n        this.buildValueForDisplay(valEl, this.getData());\n      } else {\n        this.buildValueForEditing(valEl, this.getData());\n      }\n      this.addTrackedAction({\n        'oldData': oldData,\n        'newData': this.data,\n        'path': this.getPath(),\n        'action': 'edit'\n      });\n      this.keepFocus();\n      return this.flushChanges();\n    };\n\n    BooleanNode.prototype.onSpacePressed = function() {\n      return this.toggleValue();\n    };\n\n    BooleanNode.prototype.onFPressed = function() {\n      return this.toggleValue(false);\n    };\n\n    BooleanNode.prototype.onTPressed = function() {\n      return this.toggleValue(true);\n    };\n\n    BooleanNode.prototype.saveChanges = function() {};\n\n    BooleanNode.prototype.onClick = function(e) {\n      var value;\n      value = $(e.target).closest('.treema-value');\n      if (!value.length) {\n        return BooleanNode.__super__.onClick.call(this, e);\n      }\n      if (this.canEdit()) {\n        return this.toggleValue();\n      }\n    };\n\n    return BooleanNode;\n\n  })(TreemaNode));\n  TreemaNode.setNodeSubclass('array', ArrayNode = (function(_super) {\n    __extends(ArrayNode, _super);\n\n    function ArrayNode() {\n      _ref5 = ArrayNode.__super__.constructor.apply(this, arguments);\n      return _ref5;\n    }\n\n    ArrayNode.prototype.valueClass = 'treema-array';\n\n    ArrayNode.prototype.collection = true;\n\n    ArrayNode.prototype.ordered = true;\n\n    ArrayNode.prototype.directlyEditable = false;\n\n    ArrayNode.prototype.sort = false;\n\n    ArrayNode.prototype.getChildren = function() {\n      var key, value, _i, _len, _ref6, _results;\n      _ref6 = this.getData();\n      _results = [];\n      for (key = _i = 0, _len = _ref6.length; _i < _len; key = ++_i) {\n        value = _ref6[key];\n        _results.push({\n          key: key,\n          value: value,\n          schema: this.getChildSchema(key)\n        });\n      }\n      return _results;\n    };\n\n    ArrayNode.prototype.buildValueForDisplay = function(valEl, data) {\n      var child, empty, helperTreema, index, text, val, _i, _len, _ref6;\n      text = [];\n      if (!data) {\n        return;\n      }\n      _ref6 = data.slice(0, 3);\n      for (index = _i = 0, _len = _ref6.length; _i < _len; index = ++_i) {\n        child = _ref6[index];\n        helperTreema = TreemaNode.make(null, {\n          schema: TreemaNode.utils.getChildSchema(index, this.workingSchema),\n          data: child\n        }, this);\n        val = $('<div></div>');\n        helperTreema.buildValueForDisplay(val, helperTreema.getData());\n        text.push(val.text());\n      }\n      if (data.length > 3) {\n        text.push('...');\n      }\n      empty = this.workingSchema.title != null ? \"(empty \" + this.workingSchema.title + \")\" : '(empty)';\n      text = text.length ? text.join(' | ') : empty;\n      return this.buildValueForDisplaySimply(valEl, text);\n    };\n\n    ArrayNode.prototype.buildValueForEditing = function(valEl, data) {\n      return this.buildValueForEditingSimply(valEl, JSON.stringify(data));\n    };\n\n    ArrayNode.prototype.canAddChild = function() {\n      if (this.settings.readOnly || this.workingSchema.readOnly) {\n        return false;\n      }\n      if (this.workingSchema.additionalItems === false && this.getData().length >= this.workingSchema.items.length) {\n        return false;\n      }\n      if ((this.workingSchema.maxItems != null) && this.getData().length >= this.workingSchema.maxItems) {\n        return false;\n      }\n      return true;\n    };\n\n    ArrayNode.prototype.addNewChild = function() {\n      var childNode, newTreema, new_index, schema;\n      if (!this.canAddChild()) {\n        return;\n      }\n      if (this.isClosed()) {\n        this.open();\n      }\n      new_index = Object.keys(this.childrenTreemas).length;\n      schema = TreemaNode.utils.getChildSchema(new_index, this.workingSchema);\n      newTreema = TreemaNode.make(void 0, {\n        schema: schema\n      }, this, new_index);\n      newTreema.tv4 = this.tv4;\n      childNode = this.createChildNode(newTreema);\n      this.addTrackedAction({\n        'data': newTreema.data,\n        'path': newTreema.getPath(),\n        'parentPath': this.getPath(),\n        'action': 'insert'\n      });\n      this.getAddButtonEl().before(childNode);\n      if (newTreema.canEdit()) {\n        newTreema.edit();\n      } else {\n        newTreema.select();\n        this.integrateChildTreema(newTreema);\n        newTreema.flushChanges();\n      }\n      return newTreema;\n    };\n\n    ArrayNode.prototype.open = function() {\n      if (this.data && this.sort) {\n        this.data.sort(this.sortFunction);\n      }\n      return ArrayNode.__super__.open.apply(this, arguments);\n    };\n\n    ArrayNode.prototype.close = function() {\n      var valEl;\n      ArrayNode.__super__.close.apply(this, arguments);\n      valEl = this.getValEl().empty();\n      return this.buildValueForDisplay(valEl, this.getData());\n    };\n\n    ArrayNode.prototype.sortFunction = function(a, b) {\n      if (a > b) {\n        return 1;\n      }\n      if (a < b) {\n        return -1;\n      }\n      return 0;\n    };\n\n    return ArrayNode;\n\n  })(TreemaNode));\n  window.TreemaArrayNode = ArrayNode;\n  TreemaNode.setNodeSubclass('object', ObjectNode = (function(_super) {\n    __extends(ObjectNode, _super);\n\n    function ObjectNode() {\n      this.cleanupAddNewChild = __bind(this.cleanupAddNewChild, this);\n      this.onAutocompleteSelect = __bind(this.onAutocompleteSelect, this);\n      _ref6 = ObjectNode.__super__.constructor.apply(this, arguments);\n      return _ref6;\n    }\n\n    ObjectNode.prototype.valueClass = 'treema-object';\n\n    ObjectNode.prototype.collection = true;\n\n    ObjectNode.prototype.keyed = true;\n\n    ObjectNode.prototype.directlyEditable = false;\n\n    ObjectNode.prototype.getChildren = function() {\n      var children, defaultData, key, keysAccountedFor, schema, value, _ref7;\n      children = [];\n      keysAccountedFor = [];\n      if (this.workingSchema.properties) {\n        for (key in this.workingSchema.properties) {\n          defaultData = this.getDefaultDataForKey(key);\n          if ($.type(this.getData()[key]) === 'undefined') {\n            if (defaultData != null) {\n              keysAccountedFor.push(key);\n              children.push({\n                key: key,\n                schema: this.getChildSchema(key),\n                defaultData: defaultData\n              });\n            }\n            continue;\n          }\n          keysAccountedFor.push(key);\n          schema = this.getChildSchema(key);\n          children.push({\n            key: key,\n            value: this.getData()[key],\n            schema: schema,\n            defaultData: defaultData\n          });\n        }\n      }\n      _ref7 = this.getData();\n      for (key in _ref7) {\n        value = _ref7[key];\n        if (__indexOf.call(keysAccountedFor, key) >= 0) {\n          continue;\n        }\n        keysAccountedFor.push(key);\n        children.push({\n          key: key,\n          value: value,\n          schema: this.getChildSchema(key),\n          defaultData: this.getDefaultDataForKey(key)\n        });\n      }\n      if ($.isPlainObject(this.defaultData)) {\n        for (key in this.defaultData) {\n          if (__indexOf.call(keysAccountedFor, key) >= 0) {\n            continue;\n          }\n          keysAccountedFor.push(key);\n          children.push({\n            key: key,\n            schema: this.getChildSchema(key),\n            defaultData: this.getDefaultDataForKey(key)\n          });\n        }\n      }\n      if ($.isPlainObject(this.workingSchema[\"default\"])) {\n        for (key in this.workingSchema[\"default\"]) {\n          if (__indexOf.call(keysAccountedFor, key) >= 0) {\n            continue;\n          }\n          keysAccountedFor.push(key);\n          children.push({\n            key: key,\n            schema: this.getChildSchema(key),\n            defaultData: this.getDefaultDataForKey(key)\n          });\n        }\n      }\n      return children;\n    };\n\n    ObjectNode.prototype.getDefaultDataForKey = function(key) {\n      var childDefaultData, _ref7, _ref8, _ref9;\n      childDefaultData = (_ref7 = (_ref8 = this.defaultData) != null ? _ref8[key] : void 0) != null ? _ref7 : (_ref9 = this.workingSchema[\"default\"]) != null ? _ref9[key] : void 0;\n      if ($.isArray(childDefaultData)) {\n        childDefaultData = $.extend(true, [], childDefaultData);\n      }\n      if ($.isPlainObject(childDefaultData)) {\n        childDefaultData = $.extend(true, {}, childDefaultData);\n      }\n      return childDefaultData;\n    };\n\n    ObjectNode.prototype.buildValueForDisplay = function(valEl, data) {\n      var childSchema, displayValue, empty, i, key, name, schema, text, value, valueString;\n      text = [];\n      if (!data) {\n        return;\n      }\n      displayValue = data[this.workingSchema.displayProperty];\n      if (displayValue) {\n        text = displayValue;\n        return this.buildValueForDisplaySimply(valEl, text);\n      }\n      i = 0;\n      schema = this.workingSchema || this.schema;\n      for (key in data) {\n        value = data[key];\n        if (value === void 0) {\n          continue;\n        }\n        if (i === 3) {\n          text.push('...');\n          break;\n        }\n        i += 1;\n        childSchema = this.getChildSchema(key);\n        name = childSchema.title || key;\n        if ($.isPlainObject(value) || $.isArray(value)) {\n          text.push(\"\" + name);\n          continue;\n        }\n        valueString = value;\n        if ($.type(value) !== 'string') {\n          valueString = JSON.stringify(value);\n        }\n        if (typeof value === 'undefined') {\n          valueString = 'undefined';\n        }\n        if (valueString.length > 20) {\n          valueString = valueString.slice(0, 21) + ' ...';\n        }\n        text.push(\"\" + name + \"=\" + valueString);\n      }\n      empty = this.workingSchema.title != null ? \"(empty \" + this.workingSchema.title + \")\" : '(empty)';\n      text = text.length ? text.join(', ') : empty;\n      return this.buildValueForDisplaySimply(valEl, text);\n    };\n\n    ObjectNode.prototype.populateData = function() {\n      ObjectNode.__super__.populateData.call(this);\n      return TreemaNode.utils.populateRequireds(this.data, this.workingSchema, this.tv4);\n    };\n\n    ObjectNode.prototype.close = function() {\n      ObjectNode.__super__.close.apply(this, arguments);\n      return this.buildValueForDisplay(this.getValEl().empty(), this.getData());\n    };\n\n    ObjectNode.prototype.addNewChild = function() {\n      var keyInput, properties,\n          _this = this;\n      if (!this.canAddChild()) {\n        return;\n      }\n      if (!this.isRoot()) {\n        this.open();\n      }\n      this.deselectAll();\n      properties = this.childPropertiesAvailable();\n      keyInput = $(this.newPropertyTemplate);\n      keyInput.blur(this.cleanupAddNewChild);\n      keyInput.keydown(function(e) {\n        return _this.originalTargetValue = $(e.target).val();\n      });\n      if (typeof keyInput.autocomplete === \"function\") {\n        keyInput.autocomplete({\n          source: properties,\n          minLength: 0,\n          delay: 0,\n          autoFocus: true,\n          select: this.onAutocompleteSelect\n        });\n      }\n      this.getAddButtonEl().before(keyInput).hide();\n      keyInput.focus();\n      keyInput.autocomplete('search');\n      return true;\n    };\n\n    ObjectNode.prototype.onAutocompleteSelect = function(e, ui) {\n      $(e.target).val(ui.item.value);\n      return this.tryToAddNewChild(e, true);\n    };\n\n    ObjectNode.prototype.canAddChild = function() {\n      if (this.settings.readOnly || this.workingSchema.readOnly) {\n        return false;\n      }\n      if ((this.workingSchema.maxProperties != null) && Object.keys(this.getData()).length >= this.workingSchema.maxProperties) {\n        return false;\n      }\n      if (this.workingSchema.additionalProperties !== false) {\n        return true;\n      }\n      if (this.workingSchema.patternProperties != null) {\n        return true;\n      }\n      if (this.childPropertiesAvailable().length) {\n        return true;\n      }\n      return false;\n    };\n\n    ObjectNode.prototype.childPropertiesAvailable = function() {\n      var childSchema, data, properties, property, schema, _ref7;\n      schema = this.workingSchema || this.schema;\n      if (!schema.properties) {\n        return [];\n      }\n      properties = [];\n      data = this.getData();\n      _ref7 = schema.properties;\n      for (property in _ref7) {\n        childSchema = _ref7[property];\n        if ((data != null ? data[property] : void 0) != null) {\n          continue;\n        }\n        if (childSchema.format === 'hidden') {\n          continue;\n        }\n        if (childSchema.readOnly) {\n          continue;\n        }\n        properties.push(childSchema.title || property);\n      }\n      return properties.sort();\n    };\n\n    ObjectNode.prototype.onDeletePressed = function(e) {\n      if (!this.addingNewProperty()) {\n        return ObjectNode.__super__.onDeletePressed.call(this, e);\n      }\n      if (!$(e.target).val()) {\n        this.cleanupAddNewChild();\n        e.preventDefault();\n        return this.$el.find('.treema-add-child').focus();\n      }\n    };\n\n    ObjectNode.prototype.onEscapePressed = function() {\n      return this.cleanupAddNewChild();\n    };\n\n    ObjectNode.prototype.onTabPressed = function(e) {\n      if (!this.addingNewProperty()) {\n        return ObjectNode.__super__.onTabPressed.call(this, e);\n      }\n      e.preventDefault();\n      return this.tryToAddNewChild(e, false);\n    };\n\n    ObjectNode.prototype.onEnterPressed = function(e) {\n      if (!this.addingNewProperty()) {\n        return ObjectNode.__super__.onEnterPressed.call(this, e);\n      }\n      return this.tryToAddNewChild(e, true);\n    };\n\n    ObjectNode.prototype.tryToAddNewChild = function(e, aggressive) {\n      var key, keyInput, offset, treema;\n      if ((!this.originalTargetValue) && (!aggressive)) {\n        offset = e.shiftKey ? -1 : 1;\n        this.cleanupAddNewChild();\n        this.$el.find('.treema-add-child').focus();\n        this.traverseWhileEditing(offset);\n        return;\n      }\n      keyInput = $(e.target);\n      key = this.getPropertyKey($(e.target));\n      if (key.length && !this.canAddProperty(key)) {\n        this.clearTemporaryErrors();\n        this.showBadPropertyError(keyInput);\n        return;\n      }\n      if (this.childrenTreemas[key] != null) {\n        this.cleanupAddNewChild();\n        treema = this.childrenTreemas[key];\n        if (treema.canEdit()) {\n          return treema.toggleEdit();\n        } else {\n          return treema.select();\n        }\n      }\n      this.cleanupAddNewChild();\n      return this.addNewChildForKey(key);\n    };\n\n    ObjectNode.prototype.getPropertyKey = function(keyInput) {\n      var child_key, child_schema, key, _ref7;\n      key = keyInput.val();\n      if (this.workingSchema.properties) {\n        _ref7 = this.workingSchema.properties;\n        for (child_key in _ref7) {\n          child_schema = _ref7[child_key];\n          if (child_schema.title === key) {\n            key = child_key;\n          }\n        }\n      }\n      return key;\n    };\n\n    ObjectNode.prototype.canAddProperty = function(key) {\n      var pattern, _ref7;\n      if (this.workingSchema.additionalProperties !== false) {\n        return true;\n      }\n      if (((_ref7 = this.workingSchema.properties) != null ? _ref7[key] : void 0) != null) {\n        return true;\n      }\n      if (this.workingSchema.patternProperties != null) {\n        for (pattern in this.workingSchema.patternProperties) {\n          if (RegExp(pattern).test(key)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n\n    ObjectNode.prototype.showBadPropertyError = function(keyInput) {\n      var tempError;\n      keyInput.focus();\n      tempError = this.createTemporaryError('Invalid property name.');\n      tempError.insertAfter(keyInput);\n    };\n\n    ObjectNode.prototype.addNewChildForKey = function(key) {\n      var child, childNode, children, newTreema, schema;\n      schema = this.getChildSchema(key);\n      newTreema = TreemaNode.make(null, {\n        schema: schema\n      }, this, key);\n      childNode = this.createChildNode(newTreema);\n      this.findObjectInsertionPoint(key).before(childNode);\n      if (newTreema.canEdit()) {\n        newTreema.edit();\n      } else {\n        this.integrateChildTreema(newTreema);\n        if (newTreema.collection) {\n          children = newTreema.getChildren();\n          if (children.length) {\n            newTreema.open();\n            child = newTreema.childrenTreemas[children[0]['key']];\n            if (child != null) {\n              child.select();\n            }\n          } else {\n            newTreema.addNewChild();\n          }\n        }\n      }\n      this.addTrackedAction({\n        'data': newTreema.data,\n        'path': newTreema.getPath(),\n        'parentPath': this.getPath(),\n        action: 'insert'\n      });\n      return this.updateMyAddButton();\n    };\n\n    ObjectNode.prototype.findObjectInsertionPoint = function(key) {\n      var afterKeys, allChildren, allProps, child, _i, _len, _ref7, _ref8;\n      if (!((_ref7 = this.workingSchema.properties) != null ? _ref7[key] : void 0)) {\n        return this.getAddButtonEl();\n      }\n      allProps = Object.keys(this.workingSchema.properties);\n      afterKeys = allProps.slice(allProps.indexOf(key) + 1);\n      allChildren = this.$el.find('> .treema-children > .treema-node');\n      for (_i = 0, _len = allChildren.length; _i < _len; _i++) {\n        child = allChildren[_i];\n        if (_ref8 = $(child).data('instance').keyForParent, __indexOf.call(afterKeys, _ref8) >= 0) {\n          return $(child);\n        }\n      }\n      return this.getAddButtonEl();\n    };\n\n    ObjectNode.prototype.cleanupAddNewChild = function() {\n      this.$el.find('.treema-new-prop').remove();\n      this.getAddButtonEl().show();\n      return this.clearTemporaryErrors();\n    };\n\n    ObjectNode.prototype.addingNewProperty = function() {\n      return document.activeElement === this.$el.find('.treema-new-prop')[0];\n    };\n\n    return ObjectNode;\n\n  })(TreemaNode));\n  return window.TreemaObjectNode = ObjectNode;\n})();\n;var __hasProp = {}.hasOwnProperty,\n    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },\n    __slice = [].slice;\n\n(function() {\n  var AceNode, DatabaseSearchTreemaNode, LongStringNode, Point2DNode, Point3DNode, debounce, _ref, _ref1, _ref2, _ref3, _ref4;\n  TreemaNode.setNodeSubclass('point2d', Point2DNode = (function(_super) {\n    __extends(Point2DNode, _super);\n\n    function Point2DNode() {\n      _ref = Point2DNode.__super__.constructor.apply(this, arguments);\n      return _ref;\n    }\n\n    Point2DNode.prototype.valueClass = 'treema-point2d';\n\n    Point2DNode.prototype.buildValueForDisplay = function(valEl, data) {\n      return this.buildValueForDisplaySimply(valEl, \"(\" + data.x + \", \" + data.y + \")\");\n    };\n\n    Point2DNode.prototype.buildValueForEditing = function(valEl, data) {\n      var xInput, yInput;\n      xInput = $('<input />').val(data.x).attr('placeholder', 'x');\n      yInput = $('<input />').val(data.y).attr('placeholder', 'y');\n      valEl.append('(').append(xInput).append(', ').append(yInput).append(')');\n      return valEl.find('input:first').focus().select();\n    };\n\n    Point2DNode.prototype.saveChanges = function(valEl) {\n      if (this.data == null) {\n        this.data = {};\n      }\n      this.data.x = parseFloat(valEl.find('input:first').val());\n      return this.data.y = parseFloat(valEl.find('input:last').val());\n    };\n\n    return Point2DNode;\n\n  })(TreemaNode));\n  TreemaNode.setNodeSubclass('point3d', Point3DNode = (function(_super) {\n    __extends(Point3DNode, _super);\n\n    function Point3DNode() {\n      _ref1 = Point3DNode.__super__.constructor.apply(this, arguments);\n      return _ref1;\n    }\n\n    Point3DNode.prototype.valueClass = 'treema-point3d';\n\n    Point3DNode.prototype.buildValueForDisplay = function(valEl, data) {\n      return this.buildValueForDisplaySimply(valEl, \"(\" + data.x + \", \" + data.y + \", \" + data.z + \")\");\n    };\n\n    Point3DNode.prototype.buildValueForEditing = function(valEl, data) {\n      var xInput, yInput, zInput;\n      xInput = $('<input />').val(data.x).attr('placeholder', 'x');\n      yInput = $('<input />').val(data.y).attr('placeholder', 'y');\n      zInput = $('<input />').val(data.z).attr('placeholder', 'z');\n      valEl.append('(').append(xInput).append(', ').append(yInput).append(', ').append(zInput).append(')');\n      return valEl.find('input:first').focus().select();\n    };\n\n    Point3DNode.prototype.saveChanges = function() {\n      var inputs;\n      inputs = this.getInputs();\n      if (this.data == null) {\n        this.data = {};\n      }\n      this.data.x = parseFloat($(inputs[0]).val());\n      this.data.y = parseFloat($(inputs[1]).val());\n      return this.data.z = parseFloat($(inputs[2]).val());\n    };\n\n    return Point3DNode;\n\n  })(TreemaNode));\n  DatabaseSearchTreemaNode = (function(_super) {\n    __extends(DatabaseSearchTreemaNode, _super);\n\n    function DatabaseSearchTreemaNode() {\n      this.searchCallback = __bind(this.searchCallback, this);\n      this.search = __bind(this.search, this);\n      _ref2 = DatabaseSearchTreemaNode.__super__.constructor.apply(this, arguments);\n      return _ref2;\n    }\n\n    DatabaseSearchTreemaNode.prototype.valueClass = 'treema-search';\n\n    DatabaseSearchTreemaNode.prototype.searchValueTemplate = '<input placeholder=\"Search\" /><div class=\"treema-search-results\"></div>';\n\n    DatabaseSearchTreemaNode.prototype.url = null;\n\n    DatabaseSearchTreemaNode.prototype.lastTerm = null;\n\n    DatabaseSearchTreemaNode.prototype.buildValueForDisplay = function(valEl, data) {\n      var val;\n      val = data ? this.formatDocument(data) : 'None';\n      return this.buildValueForDisplaySimply(valEl, val);\n    };\n\n    DatabaseSearchTreemaNode.prototype.formatDocument = function(doc) {\n      if ($.isString(doc)) {\n        return doc;\n      }\n      return JSON.stringify(doc);\n    };\n\n    DatabaseSearchTreemaNode.prototype.buildValueForEditing = function(valEl, data) {\n      var input;\n      valEl.html(this.searchValueTemplate);\n      input = valEl.find('input');\n      input.focus().keyup(this.search);\n      if (data) {\n        return input.attr('placeholder', this.formatDocument(data));\n      }\n    };\n\n    DatabaseSearchTreemaNode.prototype.search = function() {\n      var term;\n      term = this.getValEl().find('input').val();\n      if (term === this.lastTerm) {\n        return;\n      }\n      if (this.lastTerm && !term) {\n        this.getSearchResultsEl().empty();\n      }\n      if (!term) {\n        return;\n      }\n      this.lastTerm = term;\n      this.getSearchResultsEl().empty().append('Searching');\n      return $.ajax(this.url + '?term=' + term, {\n        dataType: 'json',\n        success: this.searchCallback\n      });\n    };\n\n    DatabaseSearchTreemaNode.prototype.searchCallback = function(results) {\n      var container, first, i, result, row, text, _i, _len;\n      container = this.getSearchResultsEl().detach().empty();\n      first = true;\n      for (i = _i = 0, _len = results.length; _i < _len; i = ++_i) {\n        result = results[i];\n        row = $('<div></div>').addClass('treema-search-result-row');\n        text = this.formatDocument(result);\n        if (text == null) {\n          continue;\n        }\n        if (first) {\n          row.addClass('treema-search-selected');\n        }\n        first = false;\n        row.text(text);\n        row.data('value', result);\n        container.append(row);\n      }\n      if (!results.length) {\n        container.append($('<div>No results</div>'));\n      }\n      return this.getValEl().append(container);\n    };\n\n    DatabaseSearchTreemaNode.prototype.getSearchResultsEl = function() {\n      return this.getValEl().find('.treema-search-results');\n    };\n\n    DatabaseSearchTreemaNode.prototype.getSelectedResultEl = function() {\n      return this.getValEl().find('.treema-search-selected');\n    };\n\n    DatabaseSearchTreemaNode.prototype.saveChanges = function() {\n      var selected;\n      selected = this.getSelectedResultEl();\n      if (!selected.length) {\n        return;\n      }\n      return this.data = selected.data('value');\n    };\n\n    DatabaseSearchTreemaNode.prototype.onDownArrowPressed = function(e) {\n      this.navigateSearch(1);\n      return e.preventDefault();\n    };\n\n    DatabaseSearchTreemaNode.prototype.onUpArrowPressed = function(e) {\n      e.preventDefault();\n      return this.navigateSearch(-1);\n    };\n\n    DatabaseSearchTreemaNode.prototype.navigateSearch = function(offset) {\n      var func, next, selected;\n      selected = this.getSelectedResultEl();\n      func = offset > 0 ? 'next' : 'prev';\n      next = selected[func]('.treema-search-result-row');\n      if (!next.length) {\n        return;\n      }\n      selected.removeClass('treema-search-selected');\n      return next.addClass('treema-search-selected');\n    };\n\n    DatabaseSearchTreemaNode.prototype.onClick = function(e) {\n      var newSelection;\n      newSelection = $(e.target).closest('.treema-search-result-row');\n      if (!newSelection.length) {\n        return DatabaseSearchTreemaNode.__super__.onClick.call(this, e);\n      }\n      this.getSelectedResultEl().removeClass('treema-search-selected');\n      newSelection.addClass('treema-search-selected');\n      this.saveChanges();\n      return this.display();\n    };\n\n    DatabaseSearchTreemaNode.prototype.shouldTryToRemoveFromParent = function() {\n      var selected;\n      if (this.getData() != null) {\n        return;\n      }\n      selected = this.getSelectedResultEl();\n      return !selected.length;\n    };\n\n    return DatabaseSearchTreemaNode;\n\n  })(TreemaNode);\n  debounce = function(func, threshold, execAsap) {\n    var timeout;\n    timeout = null;\n    return function() {\n      var args, delayed, obj;\n      args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\n      obj = this;\n      delayed = function() {\n        if (!execAsap) {\n          func.apply(obj, args);\n        }\n        return timeout = null;\n      };\n      if (timeout) {\n        clearTimeout(timeout);\n      } else if (execAsap) {\n        func.apply(obj, args);\n      }\n      return timeout = setTimeout(delayed, threshold || 100);\n    };\n  };\n  DatabaseSearchTreemaNode.prototype.search = debounce(DatabaseSearchTreemaNode.prototype.search, 200);\n  window.DatabaseSearchTreemaNode = DatabaseSearchTreemaNode;\n  TreemaNode.setNodeSubclass('ace', AceNode = (function(_super) {\n    __extends(AceNode, _super);\n\n    function AceNode() {\n      this.saveChanges = __bind(this.saveChanges, this);\n      _ref3 = AceNode.__super__.constructor.apply(this, arguments);\n      return _ref3;\n    }\n\n    AceNode.prototype.valueClass = 'treema-ace treema-multiline';\n\n    AceNode.prototype.initEditor = function(valEl) {\n      var d, session;\n      d = $('<div></div>').text(this.getData());\n      if (this.schema.height != null)\n        d.height(this.schema.height);\n      else d.height(\"500px\");\n\n      valEl.append(d);\n      this.editor = ace.edit(d[0]);\n\n      session = this.editor.getSession();\n      if (this.schema.aceMode != null) {\n        session.setMode(this.schema.aceMode);\n      }\n\n      if (this.schema.aceTabSize != null) {\n        session.setTabSize(this.schema.aceTabSize);\n      }\n      if (this.schema.aceUseWrapMode != null) {\n        session.setUseWrapMode(this.schema.aceUseWrapMode);\n      }\n      if (this.schema.disableWorker) {\n        session.setUseWorker(false);\n      }\n\n      this.editor.setOptions({\n        enableBasicAutocompletion: true,\n        enableSnippets: true,\n        enableLiveAutocompletion: true\n      });\n\n      session.on('change', this.saveChanges);\n\n      return this.editor.$blockScrolling = Infinity;\n    };\n\n    AceNode.prototype.toggleEdit = function() {\n      if (!this.editor) {\n        this.initEditor(this.getValEl());\n      }\n      return this.deselectAll();\n    };\n\n    AceNode.prototype.buildValueForDisplay = function(valEl) {\n      if (!this.editor) {\n        return this.initEditor(valEl);\n      }\n    };\n\n    AceNode.prototype.buildValueForEditing = function() {};\n\n    AceNode.prototype.saveChanges = function() {\n      // var lineHeight = this.editor.renderer.lineHeight;\n      // this.d.height(lineHeight * this.editor.getSession().getDocument().getLength() + \"px\");\n      // this.editor.resize();\n\n      this.data = this.editor.getValue();\n      this.flushChanges();\n      return this.broadcastChanges();\n    };\n\n    AceNode.prototype.onTabPressed = function() {};\n\n    AceNode.prototype.onEnterPressed = function() {};\n\n    AceNode.prototype.destroy = function() {\n      var session;\n      if (this.editor) {\n        session = this.editor.getSession();\n        session.setMode('');\n        return this.editor.destroy();\n      }\n    };\n\n    return AceNode;\n\n  })(TreemaNode));\n  return TreemaNode.setNodeSubclass('long-string', LongStringNode = (function(_super) {\n    __extends(LongStringNode, _super);\n\n    function LongStringNode() {\n      _ref4 = LongStringNode.__super__.constructor.apply(this, arguments);\n      return _ref4;\n    }\n\n    LongStringNode.prototype.valueClass = 'treema-long-string treema-multiline';\n\n    LongStringNode.prototype.buildValueForDisplay = function(valEl, data) {\n      var text;\n      text = data.replace(/\\n/g, '<br />');\n      return valEl.append($(\"<div></div>\").html(text));\n    };\n\n    LongStringNode.prototype.buildValueForEditing = function(valEl, data) {\n      var input;\n      input = $('<textarea />');\n      if (data !== null) {\n        input.val(data);\n      }\n      valEl.append(input);\n      input.focus().select();\n      input.blur(this.onEditInputBlur);\n      return input;\n    };\n\n    LongStringNode.prototype.saveChanges = function(valEl) {\n      var input;\n      input = valEl.find('textarea');\n      return this.data = input.val();\n    };\n\n    return LongStringNode;\n\n  })(TreemaNode));\n})();\n;(function($) {\n  return $.fn[TreemaNode.pluginName] = function(options) {\n    var element;\n    if (this.length === 0) {\n      return null;\n    }\n    element = $(this[0]);\n    return TreemaNode.make(element, options);\n  };\n})(jQuery);\n;var TreemaUtils;\n\nTreemaUtils = (function() {\n  var utils;\n  utils = {};\n  utils.populateDefaults = function(rootData, rootSchema, tv4) {\n    var _this = this;\n    if (rootSchema[\"default\"] && !rootData) {\n      rootData = this.cloneDeep(rootSchema[\"default\"]);\n    }\n    this.walk(rootData, rootSchema, tv4, function(path, data, schema) {\n      var def, key, value, _results;\n      def = schema[\"default\"];\n      if (!(_this.type(def) === 'object' && _this.type(data) === 'object')) {\n        return;\n      }\n      _results = [];\n      for (key in def) {\n        value = def[key];\n        if (data[key] === void 0) {\n          _results.push(data[key] = _this.cloneDeep(value));\n        } else {\n          _results.push(void 0);\n        }\n      }\n      return _results;\n    });\n    return rootData;\n  };\n  utils.populateRequireds = function(rootData, rootSchema, tv4) {\n    var _this = this;\n    if (rootData == null) {\n      rootData = {};\n    }\n    this.walk(rootData, rootSchema, tv4, function(path, data, schema) {\n      var childSchema, key, schemaDefault, type, workingSchema, _i, _len, _ref, _ref1, _results;\n      if (!(schema.required && _this.type(data) === 'object')) {\n        return;\n      }\n      _ref = schema.required;\n      _results = [];\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        key = _ref[_i];\n        if (data[key] != null) {\n          continue;\n        }\n        if (schemaDefault = (_ref1 = schema[\"default\"]) != null ? _ref1[key] : void 0) {\n          _results.push(data[key] = _this.cloneDeep(schemaDefault));\n        } else {\n          childSchema = _this.getChildSchema(key, schema);\n          workingSchema = _this.buildWorkingSchemas(childSchema, tv4)[0];\n          schemaDefault = workingSchema[\"default\"];\n          if (schemaDefault != null) {\n            _results.push(data[key] = _this.cloneDeep(schemaDefault));\n          } else {\n            type = workingSchema.type;\n            if (_this.type(type) === 'array') {\n              type = type[0];\n            }\n            if (!type) {\n              type = 'string';\n            }\n            _results.push(data[key] = _this.defaultForType(type));\n          }\n        }\n      }\n      return _results;\n    });\n    return rootData;\n  };\n  utils.walk = function(data, schema, tv4, callback, path) {\n    var dataType, f, key, value, workingSchema, workingSchemas, _i, _len, _results, _results1,\n        _this = this;\n    if (path == null) {\n      path = '';\n    }\n    if (!tv4) {\n      tv4 = this.getGlobalTv4().freshApi();\n      tv4.addSchema('#', schema);\n      if (schema.id) {\n        tv4.addSchema(schema.id, schema);\n      }\n    }\n    workingSchemas = this.buildWorkingSchemas(schema, tv4);\n    workingSchema = this.chooseWorkingSchema(data, workingSchemas, tv4);\n    callback(path, data, workingSchema);\n    dataType = this.type(data);\n    if (dataType === 'array' || dataType === 'object') {\n      f = function(key, value) {\n        var childPath, childSchema;\n        value = data[key];\n        childPath = path.slice();\n        if (childPath) {\n          childPath += '.';\n        }\n        childPath += key;\n        childSchema = _this.getChildSchema(key, workingSchema);\n        return _this.walk(value, childSchema, tv4, callback, childPath);\n      };\n      if (dataType === 'array') {\n        _results = [];\n        for (key = _i = 0, _len = data.length; _i < _len; key = ++_i) {\n          value = data[key];\n          _results.push(f(key, value));\n        }\n        return _results;\n      } else {\n        _results1 = [];\n        for (key in data) {\n          value = data[key];\n          _results1.push(f(key, value));\n        }\n        return _results1;\n      }\n    }\n  };\n  utils.getChildSchema = function(key, schema) {\n    var childKey, childSchema, index, _ref, _ref1;\n    if (this.type(key) === 'string') {\n      _ref = schema.properties;\n      for (childKey in _ref) {\n        childSchema = _ref[childKey];\n        if (childKey === key) {\n          return childSchema;\n        }\n      }\n      _ref1 = schema.patternProperties;\n      for (childKey in _ref1) {\n        childSchema = _ref1[childKey];\n        if (key.match(new RegExp(childKey))) {\n          return childSchema;\n        }\n      }\n      if (typeof schema.additionalProperties === 'object') {\n        return schema.additionalProperties;\n      }\n    }\n    if (this.type(key) === 'number') {\n      index = key;\n      if (schema.items) {\n        if (Array.isArray(schema.items)) {\n          if (index < schema.items.length) {\n            return schema.items[index];\n          } else if (schema.additionalItems) {\n            return schema.additionalItems;\n          }\n        } else if (schema.items) {\n          return schema.items;\n        }\n      }\n    }\n    return {};\n  };\n  utils.buildWorkingSchemas = function(schema, tv4) {\n    var allOf, anyOf, baseSchema, newBase, oneOf, singularSchema, singularSchemas, workingSchemas, _i, _j, _len, _len1;\n    if (schema == null) {\n      schema = {};\n    }\n    baseSchema = this.resolveReference(schema, tv4);\n    if (!(schema.allOf || schema.anyOf || schema.oneOf)) {\n      return [schema];\n    }\n    baseSchema = this.cloneSchema(baseSchema);\n    allOf = baseSchema.allOf;\n    anyOf = baseSchema.anyOf;\n    oneOf = baseSchema.oneOf;\n    if (baseSchema.allOf != null) {\n      delete baseSchema.allOf;\n    }\n    if (baseSchema.anyOf != null) {\n      delete baseSchema.anyOf;\n    }\n    if (baseSchema.oneOf != null) {\n      delete baseSchema.oneOf;\n    }\n    if (allOf != null) {\n      for (_i = 0, _len = allOf.length; _i < _len; _i++) {\n        schema = allOf[_i];\n        this.combineSchemas(baseSchema, this.resolveReference(schema, tv4));\n      }\n    }\n    workingSchemas = [];\n    singularSchemas = [];\n    if (anyOf != null) {\n      singularSchemas = singularSchemas.concat(anyOf);\n    }\n    if (oneOf != null) {\n      singularSchemas = singularSchemas.concat(oneOf);\n    }\n    for (_j = 0, _len1 = singularSchemas.length; _j < _len1; _j++) {\n      singularSchema = singularSchemas[_j];\n      singularSchema = this.resolveReference(singularSchema, tv4);\n      newBase = this.cloneSchema(baseSchema);\n      this.combineSchemas(newBase, singularSchema);\n      workingSchemas.push(newBase);\n    }\n    if (workingSchemas.length === 0) {\n      workingSchemas = [baseSchema];\n    }\n    return workingSchemas;\n  };\n  utils.chooseWorkingSchema = function(data, workingSchemas, tv4) {\n    var result, schema, _i, _len;\n    if (workingSchemas.length === 1) {\n      return workingSchemas[0];\n    }\n    if (tv4 == null) {\n      tv4 = this.getGlobalTv4();\n    }\n    for (_i = 0, _len = workingSchemas.length; _i < _len; _i++) {\n      schema = workingSchemas[_i];\n      result = tv4.validateMultiple(data, schema);\n      if (result.valid) {\n        return schema;\n      }\n    }\n    return workingSchemas[0];\n  };\n  utils.resolveReference = function(schema, tv4, scrubTitle) {\n    var resolved;\n    if (scrubTitle == null) {\n      scrubTitle = false;\n    }\n    if (schema.$ref == null) {\n      return schema;\n    }\n    if (tv4 == null) {\n      tv4 = this.getGlobalTv4();\n    }\n    resolved = tv4.getSchema(schema.$ref);\n    if (!resolved) {\n      console.warn('could not resolve reference', schema.$ref, tv4.getMissingUris());\n    }\n    if (resolved == null) {\n      resolved = {};\n    }\n    if (scrubTitle && (resolved.title != null)) {\n      delete resolved.title;\n    }\n    return resolved;\n  };\n  utils.getGlobalTv4 = function() {\n    if (typeof window !== 'undefined') {\n      return window.tv4;\n    }\n    if (typeof global !== 'undefined') {\n      return global.tv4;\n    }\n    if (typeof tv4 !== 'undefined') {\n      return tv4;\n    }\n  };\n  utils.cloneSchema = function(schema) {\n    var clone, key, value;\n    clone = {};\n    for (key in schema) {\n      value = schema[key];\n      clone[key] = value;\n    }\n    return clone;\n  };\n  utils.combineSchemas = function(schema1, schema2) {\n    var key, value;\n    for (key in schema2) {\n      value = schema2[key];\n      schema1[key] = value;\n    }\n    return schema1;\n  };\n  utils.cloneDeep = function(data) {\n    var clone, key, type, value;\n    clone = data;\n    type = this.type(data);\n    if (type === 'object') {\n      clone = {};\n    }\n    if (type === 'array') {\n      clone = [];\n    }\n    if (type === 'object' || type === 'array') {\n      for (key in data) {\n        value = data[key];\n        clone[key] = this.cloneDeep(value);\n      }\n    }\n    return clone;\n  };\n  utils.type = (function() {\n    var classToType, name, _i, _len, _ref;\n    classToType = {};\n    _ref = \"Boolean Number String Function Array Date RegExp Undefined Null\".split(\" \");\n    for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n      name = _ref[_i];\n      classToType[\"[object \" + name + \"]\"] = name.toLowerCase();\n    }\n    return function(obj) {\n      var strType;\n      strType = Object.prototype.toString.call(obj);\n      return classToType[strType] || \"object\";\n    };\n  })();\n  utils.defaultForType = function(type) {\n    return {\n      string: '',\n      number: 0,\n      \"null\": null,\n      object: {},\n      integer: 0,\n      boolean: false,\n      array: []\n    }[type];\n  };\n  if (typeof TreemaNode !== 'undefined') {\n    return TreemaNode.utils = utils;\n  } else if (typeof module !== 'undefined' && module.exports) {\n    return module.exports = utils;\n  } else {\n    return utils;\n  }\n})();\n;"},a07cf1589ac14f300c0c:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function a(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return n(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?n(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function o(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function s(a,n,o,r){var s=n&&n.prototype instanceof c?n:c,u=Object.create(s.prototype);return i(u,"_invoke",function(a,n,o){var i,r,s,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,r=0,s=e,p.n=a,l}};function h(a,n){for(r=a,s=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(s=i[(r=i[4])?5:(r=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(r=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,r=0))}if(o||a>1)return l;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),r=u,s=f;(t=r<2?e:s)||!d;){i||(r?r<3?(r>1&&(p.n=-1),h(r,s)):p.n=s:p.v=s);try{if(c=2,i){if(r||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,r<2&&(r=0)}else 1===r&&(t=i.return)&&t.call(i),r<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),r=1);i=e}else if((t=(d=p.n<0)?s:a.call(n,p))!==l)break}catch(t){i=e,r=1,s=t}finally{c=1}}return{value:t,done:d}}}(a,o,r),!0),u}var l={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var p=[][n]?t(t([][n]())):(i(t={},n,(function(){return this})),t),h=d.prototype=c.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,i(e,r,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,i(h,"constructor",d),i(d,"constructor",u),u.displayName="GeneratorFunction",i(d,r,"GeneratorFunction"),i(h),i(h,r,"Generator"),i(h,n,(function(){return this})),i(h,"toString",(function(){return"[object Generator]"})),(o=function(){return{w:s,m:f}})()}function i(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}i=function(e,t,a,n){function r(t,a){i(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(r("next",0),r("throw",1),r("return",2))},i(e,t,a,n)}function r(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function s(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function s(e){r(i,n,o,s,l,"next",e)}function l(e){r(i,n,o,s,l,"throw",e)}s(void 0)}))}}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e,t,a){return(t=d(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function u(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,d(n.key),n)}}function d(e){var a=function(e){if("object"!=t(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,"string");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==t(a)?a:a+""}var p=function(){return e=function e(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.settings=a,this.config=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){c(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({embeddingModel:n.embeddingModel||"text-embedding-3-small",embeddingDimension:n.embeddingDimension||1536,maxBatchSize:n.maxBatchSize||8,cacheTTL:n.cacheTTL||864e5},n),this.embeddingCache=new Map,this.similarityMeasures={cosine:this.cosineSimilarity.bind(this),dotProduct:this.dotProduct.bind(this),euclidean:this.euclideanDistance.bind(this)}},t=[{key:"createBranchTextRepresentation",value:function(e){var t=this,a=[];e.name&&a.push("Name: ".concat(e.name)),e.description&&a.push("Description: ".concat(e.description)),e.metadata&&(e.metadata.category&&a.push("Category: ".concat(e.metadata.category)),e.metadata.tags&&Array.isArray(e.metadata.tags)&&a.push("Tags: ".concat(e.metadata.tags.join(", "))));var n=e.components||{};if(n.acquisition&&Array.isArray(n.acquisition)){var o=n.acquisition.map((function(e){return t.getNodeTypeName(e.type)}));a.push("Data Sources: ".concat(o.join(", ")))}if(n.transformation&&Array.isArray(n.transformation)){var i=n.transformation.map((function(e){return t.getNodeTypeName(e.type)}));a.push("Transformations: ".concat(i.join(", ")))}if(n.visualization&&Array.isArray(n.visualization)){var r=n.visualization.map((function(e){return t.getNodeTypeName(e.type)}));a.push("Visualizations: ".concat(r.join(", ")))}if(e.visualization_output&&(e.visualization_output.type&&a.push("Visualization Type: ".concat(e.visualization_output.type)),e.visualization_output.metrics&&Array.isArray(e.visualization_output.metrics)&&a.push("Metrics: ".concat(e.visualization_output.metrics.join(", ")))),e.input_requirements&&(e.input_requirements.fields&&Array.isArray(e.input_requirements.fields)&&a.push("Required Fields: ".concat(e.input_requirements.fields.join(", "))),e.input_requirements.sources&&Array.isArray(e.input_requirements.sources)&&a.push("Data Sources: ".concat(e.input_requirements.sources.join(", ")))),e.node_properties){var s=Object.keys(e.node_properties);if(s.length>0){var l=s.map((function(t){var a=e.node_properties[t],n=[];return a.sql&&n.push("sql"),a.transform&&n.push("transform"),a.config&&n.push("config"),a.dataset&&n.push("dataset"),a.html&&n.push("html"),n.length>0?n.join("+"):"basic"}));a.push("Property Types: ".concat(l.join(", ")))}}return a.join("\n")}},{key:"createQueryTextRepresentation",value:function(e){if("string"==typeof e)return e;var t=[];return e.description&&t.push(e.description),e.category&&t.push("Category: ".concat(e.category)),e.visualization_type&&t.push("Visualization: ".concat(e.visualization_type)),e.required_fields&&Array.isArray(e.required_fields)&&t.push("Fields: ".concat(e.required_fields.join(", "))),e.purpose&&t.push("Purpose: ".concat(e.purpose)),t.join("\n")}},{key:"getEmbedding",value:(i=s(o().m((function e(t){var a,n,i,r,s,l,c,u;return o().w((function(e){for(;;)switch(e.p=e.n){case 0:if(a=this.normalizeText(t),n=this.getCacheKey(a),!this.embeddingCache.has(n)){e.n=2;break}if(i=this.embeddingCache.get(n),!(Date.now()-i.timestamp<this.config.cacheTTL)){e.n=1;break}return e.a(2,i.embedding);case 1:this.embeddingCache.delete(n);case 2:return e.p=2,r=this.settings.context+"/api/embeddings/create",s={text:a},e.n=3,this.$http.post(r,s);case 3:return l=e.v,c=this.extractEmbeddingFromBackendResponse(l.data),this.embeddingCache.set(n,{embedding:c,timestamp:Date.now()}),e.a(2,c);case 4:return e.p=4,u=e.v,console.error("Error getting embedding:",u),e.a(2,new Array(this.config.embeddingDimension).fill(0))}}),e,this,[[2,4]])}))),function(e){return i.apply(this,arguments)})},{key:"getBatchEmbeddings",value:(n=s(o().m((function e(t){var n,i,r,s,l,c=this;return o().w((function(e){for(;;)switch(e.n){case 0:n=[],i=this.config.maxBatchSize,r=0;case 1:if(!(r<t.length)){e.n=4;break}return s=t.slice(r,r+i),e.n=2,Promise.all(s.map((function(e){return c.getEmbedding(e)})));case 2:l=e.v,n.push.apply(n,a(l));case 3:r+=i,e.n=1;break;case 4:return e.a(2,n)}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"calculateSimilarity",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cosine";return(this.similarityMeasures[a]||this.similarityMeasures.cosine)(e,t)}},{key:"cosineSimilarity",value:function(e,t){if(e.length!==t.length)throw new Error("Vector dimensions don't match: ".concat(e.length," vs ").concat(t.length));for(var a=0,n=0,o=0,i=0;i<e.length;i++)a+=e[i]*t[i],n+=e[i]*e[i],o+=t[i]*t[i];var r=(n=Math.sqrt(n))*(o=Math.sqrt(o));return 0===r?0:a/r}},{key:"dotProduct",value:function(e,t){if(e.length!==t.length)throw new Error("Vector dimensions don't match: ".concat(e.length," vs ").concat(t.length));for(var a=0,n=0;n<e.length;n++)a+=e[n]*t[n];return a}},{key:"euclideanDistance",value:function(e,t){if(e.length!==t.length)throw new Error("Vector dimensions don't match: ".concat(e.length," vs ").concat(t.length));for(var a=0,n=0;n<e.length;n++){var o=e[n]-t[n];a+=o*o}return Math.sqrt(a)}},{key:"findTopKSimilar",value:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"cosine",i=t.map((function(t){return{id:t.id,score:a.calculateSimilarity(e,t.embedding,o)}})),r="euclidean"===o;return i.sort((function(e,t){return r?e.score-t.score:t.score-e.score})),i.slice(0,n)}},{key:"normalizeText",value:function(e){if(!e)return"";var t=String(e);return(t=(t=t.trim()).replace(/\s+/g," ")).length>8e3&&(t=t.substring(0,8e3)),t}},{key:"getCacheKey",value:function(e){for(var t=0,a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t&=t;return"".concat(this.config.embeddingModel,"_").concat(t)}},{key:"extractEmbeddingFromBackendResponse",value:function(e){return e&&e.embedding&&Array.isArray(e.embedding)?e.embedding:(console.error("Unexpected backend embedding API response format:",e),new Array(this.config.embeddingDimension).fill(0))}},{key:"getNodeTypeName",value:function(e){return"string"==typeof e?e.split(".").pop()||e:{1:"Project",2:"DU Model",3:"Task",4:"Custom Field",5:"SQL",6:"Union",7:"Transform",8:"ECharts",9:"Vega",10:"Table",11:"HTML",12:"Style",13:"Math",14:"Filter",15:"API"}[e]||"Type ".concat(e)}},{key:"clearCache",value:function(){this.embeddingCache.clear()}}],t&&u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,i}();e.exports=p},a0dec2fcb181bcfd6db2:function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("shine",{color:["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487"],backgroundColor:"rgba(0,0,0,0)",textStyle:{},title:{textStyle:{color:"#333333"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:4,symbol:"emptyCircle",smooth:!1},radar:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:4,symbol:"emptyCircle",smooth:!1},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#c12e34",color0:"#2b821d",borderColor:"#c12e34",borderColor0:"#2b821d",borderWidth:1}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:4,symbol:"emptyCircle",smooth:!1,color:["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#ddd",borderColor:"#eee",borderWidth:.5},label:{color:"#c12e34"},emphasis:{itemStyle:{areaColor:"#e6b600",borderColor:"#ddd",borderWidth:1},label:{color:"#c12e34"}}},geo:{itemStyle:{areaColor:"#ddd",borderColor:"#eee",borderWidth:.5},label:{color:"#c12e34"},emphasis:{itemStyle:{areaColor:"#e6b600",borderColor:"#ddd",borderWidth:1},label:{color:"#c12e34"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!1,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{borderColor:"#06467c"},emphasis:{iconStyle:{borderColor:"#4187c2"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#005eaa",width:1},itemStyle:{color:"#005eaa",borderWidth:1},controlStyle:{color:"#005eaa",borderColor:"#005eaa",borderWidth:.5},checkpointStyle:{color:"#005eaa",borderColor:"#316bc2"},label:{color:"#005eaa"},emphasis:{itemStyle:{color:"#005eaa"},controlStyle:{color:"#005eaa",borderColor:"#005eaa",borderWidth:.5},label:{color:"#005eaa"}}},visualMap:{color:["#1790cf","#a2d4e6"]},dataZoom:{backgroundColor:"rgba(47,69,84,0)",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},a30e422529f6c1711469:(e,t,a)=>{"use strict";a("bf3a7adf03eb92c1e626"),a("75ad9e5d6e20c6667143"),a("47c3aee7a1a956816e9e"),a("b3e5f8d8d0de75e4a088");var n=a("46a843cf52359732b90b"),o=(a("75bccc7e6502a82545f2"),a("2347165fe3b0894ad77f"),a("8b52f2c459e5acb6ae4d"),a("5cfc434adff61222a659"),a("f6ad18ecffcb847d71bb"),a("6fe5e339b0f8a936ba8c")),i=a.n(o),r=a("46f8f4ccfe1b73ca4d0c"),s=a.n(r),l=(a("f198dc12440589058fdd"),a("678df2910024feec841c"),a("6adc45c1f6c34de94250"),a("cf4db5d4fa357e7913a5"),a("c17cbde916a3209a02c9"),a("baff60b47cc5a2e68c0c"),a("c25ca3268486c77b2b61"),a("4eeb3774dbc1dc375e3e"),a("adfc4316ea65a7999a6b"),a("1dbb936ccf1e069ca280"),a("e39997e646b2edcb5217"),a("cce0f78d072842ac664a"),a("a58047af64786831fb1f"),a("8a868d10b6533e768658")),c=a.n(l),u=a("c851a24319a91156c382"),d=a("04d35588fc3deec75d6a"),p=a.n(d),h=a("8deafab7866a125bb9ca"),f=a("ff40a63289dea11bfb3e"),m=a.n(f);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function y(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return _(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(_(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,_(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,_(d,"constructor",c),_(c,"constructor",l),l.displayName="GeneratorFunction",_(c,o,"GeneratorFunction"),_(d),_(d,o,"Generator"),_(d,n,(function(){return this})),_(d,"toString",(function(){return"[object Generator]"})),(y=function(){return{w:i,m:p}})()}function _(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}_=function(e,t,a,n){function i(t,a){_(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},_(e,t,a,n)}function b(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function v(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){b(i,n,o,r,s,"next",e)}function s(e){b(i,n,o,r,s,"throw",e)}r(void 0)}))}}function w(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,x(n.key),n)}}function x(e){var t=function(e){if("object"!=g(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=g(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==g(t)?t:t+""}var k=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"getPrompt",value:(o=v(y().m((function e(t){var n,o,i,r,s;return y().w((function(e){for(;;)switch(e.p=e.n){case 0:e.p=1,i=t,e.n="three-stage-requirements"===i||"three-stage-requirements-to-planning"===i||"three-stage-planning"===i||"three-stage-planning-to-implementation"===i||"three-stage-implementation"===i?2:"branch-extraction"===i?10:"granular-components-extraction"===i?11:12;break;case 2:return e.n=3,a.e(313).then(a.bind(a,"f37a50b9a29db7d45507"));case 3:n=e.v,o=n.threeStageConversationalPrompt,r=t,e.n="three-stage-requirements"===r?4:"three-stage-requirements-to-planning"===r?5:"three-stage-planning"===r?6:"three-stage-planning-to-implementation"===r?7:"three-stage-implementation"===r?8:9;break;case 4:return e.a(2,o.requirementsAnalysisPrompt);case 5:return e.a(2,o.requirementsToStage1Prompt);case 6:return e.a(2,o.planningPrompt);case 7:return e.a(2,o.planningToImplementationPrompt);case 8:return e.a(2,o.implementationPrompt);case 9:return e.a(3,13);case 10:return console.warn("Branch extraction prompts should use new AI assistant prompt system"),e.a(2,"Default branch extraction prompt");case 11:return console.warn("Granular components extraction prompts should use new AI assistant prompt system"),e.a(2,"Default granular components extraction prompt");case 12:return console.warn("Unsupported prompt type: ".concat(t,". Please use the new AI assistant system.")),e.a(2,"Default prompt for ".concat(t));case 13:e.n=15;break;case 14:return e.p=14,s=e.v,console.error("Error loading prompt for type ".concat(t,":"),s),e.a(2,"Default fallback prompt for ".concat(t));case 15:return e.a(2)}}),e,null,[[1,14]])}))),function(e){return o.apply(this,arguments)})},{key:"getPromptForStrategy",value:(n=v(y().m((function e(t){var a,n,o=arguments;return y().w((function(e){for(;;)switch(e.n){case 0:a=o.length>1&&void 0!==o[1]?o[1]:null,n=t,e.n="single-stage"===n?1:"two-stage"===n?2:"conversational"===n?3:"modular-conversational"===n?4:5;break;case 1:return e.a(2,this.getPrompt("single-stage"));case 2:case 5:return e.a(2,this.getPrompt("two-stage",a));case 3:return e.a(2,this.getPrompt("conversational"));case 4:return e.a(2,this.getPrompt("modular-conversational"));case 6:return e.a(2)}}),e,this)}))),function(e){return n.apply(this,arguments)})}],t&&w(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,o}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function S(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return C(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(C(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,C(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,C(d,"constructor",c),C(c,"constructor",l),l.displayName="GeneratorFunction",C(c,o,"GeneratorFunction"),C(d),C(d,o,"Generator"),C(d,n,(function(){return this})),C(d,"toString",(function(){return"[object Generator]"})),(S=function(){return{w:i,m:p}})()}function C(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}C=function(e,t,a,n){function i(t,a){C(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},C(e,t,a,n)}function T(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=I(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw i}}}}function A(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function P(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){A(i,n,o,r,s,"next",e)}function s(e){A(i,n,o,r,s,"throw",e)}r(void 0)}))}}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(e,t)||I(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(e){if("string"==typeof e)return N(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?N(e,t):void 0}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function O(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){j(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function j(e,t,a){return(t=F(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function R(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,F(n.key),n)}}function F(e){var t=function(e){if("object"!=D(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=D(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==D(t)?t:t+""}var U=function(){return e=function e(t,a,n,o,i){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.scope=a,this.$compile=n,this.$sanitize=o,this.settings=i,this.aiIdToNodeIdMap=new Map,this.classMapping={1:"draw2d.shape.fishbone.cell.Projectnode_api",2:"draw2d.shape.fishbone.cell.DUModelnode_api",3:"draw2d.shape.fishbone.cell.Datanode",4:"draw2d.shape.fishbone.cell.CustomFieldnode",5:"draw2d.shape.fishbone.cell.SQLnode",6:"draw2d.shape.fishbone.cell.Unionnode",7:"draw2d.shape.fishbone.cell.Transformnode",8:"draw2d.shape.fishbone.ra.RaEchartAdapter",9:"draw2d.shape.fishbone.ra.RaVegaChart",10:"draw2d.shape.fishbone.ra.RaTableAdapter",11:"draw2d.shape.fishbone.cell.HTMLnode",12:"draw2d.shape.fishbone.cell.Stylenode",13:"draw2d.shape.fishbone.cell.Mathnode",14:"draw2d.shape.fishbone.cell.Filternode",15:"draw2d.shape.fishbone.cell.APInode",16:"draw2d.shape.fishbone.ra.RaTablenode"},this.reverseClassMapping={},Object.keys(this.classMapping).forEach((function(e){r.reverseClassMapping[r.classMapping[e]]=parseInt(e)}))},t=[{key:"createNodeFromConfig",value:function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:100,y:100};if(console.log("Creating node from config:",e),"number"==typeof e.class){if(!(a=this.classMapping[e.class])){var o="Invalid numeric class ID '".concat(e.class,"' specified.");throw console.error(o,e),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeCreation",id:e.id,message:o}),new Error(o)}}else a=e.class;if(!a||"string"!=typeof a||!a.startsWith("draw2d.")){var i="Invalid or missing node class '".concat(e.class,"' in config.");throw console.error(i,e),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeCreation",id:e.id,message:i}),new Error(i)}try{var r=new Function("draw2d","scope","compile","sanitize","return new "+a+"(undefined, undefined, undefined, scope, compile, sanitize);")(c(),this.scope,this.$compile,this.$sanitize);return r.ai_generated=!0,r.ai_id=e.id,t.add(r,n.x,n.y),this.aiIdToNodeIdMap.set(e.id,r.id),console.log("Mapped AI ID ".concat(e.id," to node ID ").concat(r.id)),e.userData?r.userData=O(O({},r.userData||{}),e.userData):r.userData||(r.userData={}),e.label&&(r.userData.isEditedLabel=!0,r.userData.label=e.label),[1,2,3,4].includes(e.class)||Object.entries(e).forEach((function(e){var t=E(e,2),a=t[0],n=t[1];"id"!==a&&"class"!==a&&"label"!==a&&"userData"!==a&&(["position","x","y"].includes(a)||(r.userData[a]=n))})),r}catch(t){var s="Error creating node from config for ID ".concat(e.id,": ").concat(t.message);throw console.error(s,e,t),this.scope.aiReportNodeErrors&&this.scope.aiReportNodeErrors.push({type:"NodeError",id:e.id,message:s}),t}}},{key:"generateNodesFromConfig",value:(s=P(S().m((function e(t,a){var n,o,i,r,s,l,c,u,d,p;return S().w((function(e){for(;;)switch(e.p=e.n){case 0:this.scope.aiReportNodeErrors=[],console.log("Initialized/Cleared scope.aiReportNodeErrors at start of generateNodesFromConfig"),console.log("Generating nodes from config:",t),this.currentConnections=t.connections||[],n={},o=T(t.nodes),e.p=1,o.s();case 2:if((i=o.n()).done){e.n=7;break}return r=i.value,s=t.nodes.indexOf(r),e.p=3,l=this.calculateNodePosition(s,r),c=this.createNodeFromConfig(r,a,l),n[r.id]=c,null!==c.getCanvas()&&void 0!==c.getCanvas()||console.log("missing canvas node!"),e.n=4,this.configureNodeByType(c,r,n);case 4:"function"==typeof c.updateUI?(console.log("Calling updateUI for node:",c.id),c.updateUI()):"function"==typeof c.repaint&&c.repaint(),e.n=6;break;case 5:e.p=5,d=e.v,u="Error processing node config for ID ".concat(r.id,": ").concat(d.message),console.error(u,r,d),this.scope.aiReportNodeErrors.push({type:"NodeError",id:r.id,message:u});case 6:e.n=2;break;case 7:e.n=9;break;case 8:e.p=8,p=e.v,o.e(p);case 9:return e.p=9,o.f(),e.f(9);case 10:this.createConnections(t.connections,n,a),t.nodes.length>4&&this.layoutNodes(n,t,a),console.log("Node and connection generation complete.");case 11:return e.a(2)}}),e,this,[[3,5],[1,8,9,10]])}))),function(e,t){return s.apply(this,arguments)})},{key:"calculateNodePosition",value:function(e,t){return{x:50+e%4*200,y:50+150*Math.floor(e/4)}}},{key:"configureNodeByType",value:(r=P(S().m((function e(t,a,n){var o,i;return S().w((function(e){for(;;)switch(e.n){case 0:o="number"==typeof a.class?this.classMapping[a.class]:a.class,i=o,e.n="draw2d.shape.fishbone.cell.Projectnode_api"===i?1:"draw2d.shape.fishbone.cell.DUModelnode_api"===i?3:"draw2d.shape.fishbone.cell.Datanode"===i?5:"draw2d.shape.fishbone.cell.CustomFieldnode"===i?7:"draw2d.shape.fishbone.cell.Transformnode"===i?9:10;break;case 1:return e.n=2,this.configureProjectNode(t,a);case 2:case 4:case 6:case 8:return e.a(3,11);case 3:return e.n=4,this.configureDUModelNode(t,a,n);case 5:return e.n=6,this.configureTaskNode(t,a,n);case 7:return e.n=8,this.configureUDFNode(t,a,n);case 9:return this.configureTransformNode(t,a,n),e.a(3,11);case 10:return this.configureGenericNode(t,a,n),e.a(3,11);case 11:return e.a(2)}}),e,this)}))),function(e,t,a){return r.apply(this,arguments)})},{key:"configureProjectNode",value:(i=P(S().m((function e(t,a){var n,o,i,r,s,l,c,u,d,p,h,f;return S().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!(a.proj_code||a.proj_name||a.proj_id)){e.n=7;break}return t.userData||(t.userData={}),n={user_id:window.user_id,proj_code:a.proj_code,proj_name:a.proj_name},a.proj_id&&(n.proj_id=a.proj_id),e.p=1,i=(null===(o=this.settings)||void 0===o?void 0:o.context)||"",console.log("Fetching Project data:",n),e.n=2,fetch("".concat(i,"/apidata/getAPIData?apiid=").concat("526129009928470528","&user_id=").concat(window.user_id),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(n)});case 2:if((r=e.v).ok){e.n=3;break}throw new Error("Project API fetch failed: ".concat(r.status));case 3:return e.n=4,r.json();case 4:s=e.v,(l=s.data&&s.data.length>0?s.data[0]:null)?(console.log("Project data received:",l),t.userData.project={proj_id:l.proj_id||a.proj_id||"",proj_name:l.proj_name||a.proj_name||"",proj_code:l.proj_code||a.proj_code||""},(c=t.getPort("output0"))?c.setUserData({project:t.userData.project}):console.warn("Output port 'output0' not found on Project node",t.id)):(console.warn("Project API returned no data for query:",n),t.userData.project={proj_id:a.proj_id||"",proj_name:a.proj_name||"",proj_code:a.proj_code||""},u="Project API returned no data for query: ".concat(JSON.stringify(n),". Using config values as fallback."),console.warn(u),this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"Projectnode_api",message:u})),e.n=6;break;case 5:e.p=5,f=e.v,d="Error fetching Project API data: ".concat(f.message),console.error(d,f),this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"Projectnode_api",message:d}),t.userData.project={proj_id:a.proj_id||"",proj_name:a.proj_name||"",proj_code:a.proj_code||""},(p=t.getPort("output0"))&&p.setUserData({project:t.userData.project});case 6:e.n=8;break;case 7:h="Project node config missing proj_code/proj_name/proj_id.",console.warn(h,a),this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"Projectnode_api",message:h});case 8:return e.a(2)}}),e,this,[[1,5]])}))),function(e,t){return i.apply(this,arguments)})},{key:"configureDUModelNode",value:(o=P(S().m((function e(t,a,n){var o,i,r,s,l,c,u,d,p,h,f,m,g,y,_,b,v,w,x,k;return S().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!a.du_model_name&&!a.du_model_id){e.n=9;break}if(t.userData||(t.userData={}),o=null,(i=this.findIncomingConnection(a.id,n))&&i.sourceNode?(r=i.sourceNode).userData&&r.userData.project&&(o=r.userData.project,t.project=o):(s="Could not find valid source node or source port data for DUModel node ".concat(a.id,"."),console.warn(s)),!o||!o.proj_id){e.n=7;break}return l={proj_id:o.proj_id,du_model_name:a.du_model_name},a.du_model_id&&(l.du_model_id=a.du_model_id),e.p=1,u=(null===(c=this.settings)||void 0===c?void 0:c.context)||"",console.log("Fetching DUModel data:",l),e.n=2,fetch("".concat(u,"/apidata/getAPIData?apiid=").concat("527209159352942592","&user_id=").concat(window.user_id),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(l)});case 2:if((d=e.v).ok){e.n=3;break}throw new Error("DUModel API fetch failed: ".concat(d.status));case 3:return e.n=4,d.json();case 4:p=e.v,(h=p.data&&p.data.length>0?p.data[0]:null)?(console.log("DUModel data received:",h),t.userData.du_model={du_model_id:h.du_model_id||a.du_model_id||"",du_model_name:h.du_model_name||a.du_model_name||""},t.du_model=t.userData.du_model,(f=t.getPort("output0"))?f.setUserData({project:o,du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"}):console.warn("Output port 'output0' not found on DUModel node",t.id)):(console.warn("DUModel API returned no data for query:",l),t.userData.du_model={du_model_id:a.du_model_id||"",du_model_name:a.du_model_name||""},t.du_model=t.userData.du_model,m="DUModel API returned no data for query: ".concat(JSON.stringify(l),". Using config values as fallback."),console.warn(m),this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"DUModelnode_api",message:m}),(g=t.getPort("output0"))&&g.setUserData({project:o,du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"})),e.n=6;break;case 5:e.p=5,k=e.v,y="Error fetching DUModel API data: ".concat(k.message),console.error(y,k),this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"DUModelnode_api",message:y}),t.userData.du_model={du_model_id:a.du_model_id||"",du_model_name:a.du_model_name||""},t.du_model=t.userData.du_model,(_=t.getPort("output0"))&&_.setUserData({project:o,du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"});case 6:e.n=8;break;case 7:b="Cannot fetch DUModel data - missing valid project context from parent node.",console.warn(b,a),this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"DUModelnode_api",message:b}),t.userData.du_model={du_model_id:a.du_model_id||"",du_model_name:a.du_model_name||""},t.du_model=t.userData.du_model,(v=t.getPort("output0"))&&v.setUserData({du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"});case 8:e.n=10;break;case 9:w="DUModel node config missing du_model_name/du_model_id.",console.warn(w,a),this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"DUModelnode_api",message:w}),t.userData||(t.userData={}),t.userData.du_model={du_model_id:"",du_model_name:""},t.du_model=t.userData.du_model,(x=t.getPort("output0"))&&x.setUserData({project:o,du_model:t.userData.du_model,scope:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},sop:{scope_id:t.userData.du_model.du_model_id,scope_name:t.userData.du_model.du_model_name},item_name:"du_model"});case 10:return e.a(2)}}),e,this,[[1,5]])}))),function(e,t,a){return o.apply(this,arguments)})},{key:"configureTaskNode",value:(n=P(S().m((function e(t,a,n){var o,i,r,s,l,c,u,d,p,h,f,m,g,y,_,b;return S().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!((o=this.findParentPortData(a.id,n))&&o.project&&o.project.proj_id)){e.n=7;break}return t.project=o.project,t.scope=o.scope,t.sop=o.sop,r=(null===(i=this.settings)||void 0===i?void 0:i.context)||"",s="".concat(r,"/apidata/getAPIData?apiid=").concat("700743337020260352","&user_id=").concat(window.user_id),l={proj_id:t.project.proj_id,task_type:"AC"},t.scope&&t.scope.scope_id&&(l.du_model_id=t.scope.scope_id),a.scope_task_name&&(l.scope_task_name=a.scope_task_name),a.scope_task_code&&(l.scope_task_code=a.scope_task_code),a.scope_task_id&&(l.scope_task_id=a.scope_task_id),e.p=1,console.log("Fetching Task data:",l),e.n=2,fetch(s,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(l)});case 2:if((c=e.v).ok){e.n=3;break}throw new Error("Task API fetch failed: ".concat(c.status));case 3:return e.n=4,c.json();case 4:u=e.v,(d=u.data&&u.data.length>0?u.data[0]:null)?(console.log("Task data received:",d),t.userData||(t.userData={}),t.userData.task||(t.userData.task={}),t.userData.task.scope_task_id=d.scope_task_id||a.scope_task_id||"",t.userData.task.scope_task_code=d.scope_task_code||a.scope_task_code||"",t.userData.task.scope_task_name=d.scope_task_name||a.scope_task_name||"",(p=t.getPort("output0"))?(h=O({},o),p.setUserData(h)):console.warn("Output port 'output0' not found on Datanode",t.id)):(console.warn("Task API returned no data for query:",l),t.userData||(t.userData={}),t.userData.task||(t.userData.task={}),t.userData.task.scope_task_id=a.scope_task_id||"",t.userData.task.scope_task_code=a.scope_task_code||"",t.userData.task.scope_task_name=a.scope_task_name||"",f="Task API returned no data for query: ".concat(JSON.stringify(l),". Using config values as fallback."),console.warn(f),this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"Datanode",message:f}),(m=t.getPort("output0"))&&m.setUserData(O({},o))),e.n=6;break;case 5:e.p=5,b=e.v,g="Error fetching Task API data: ".concat(b.message),console.error(g,b),this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"Datanode",message:g}),t.userData||(t.userData={}),t.userData.task||(t.userData.task={}),t.userData.task.scope_task_id=a.scope_task_id||"",t.userData.task.scope_task_code=a.scope_task_code||"",t.userData.task.scope_task_name=a.scope_task_name||"",(y=t.getPort("output0"))&&y.setUserData(O({},o));case 6:e.n=8;break;case 7:_="Cannot fetch Task data - missing valid project context from parent node.",console.warn(_,a),this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"Datanode",message:_});case 8:return e.a(2)}}),e,this,[[1,5]])}))),function(e,t,a){return n.apply(this,arguments)})},{key:"configureUDFNode",value:(a=P(S().m((function e(t,a,n){var o,i,r,s,l,c,u,d,p,h,f,m,g,y,_,b;return S().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!((o=this.findParentPortData(a.id,n))&&o.project&&o.project.proj_id)){e.n=7;break}return t.project=o.project,t.scope=o.scope,t.sop=o.sop,r=(null===(i=this.settings)||void 0===i?void 0:i.context)||"",s="".concat(r,"/apidata/getAPIData?apiid=").concat("553988106803511296","&user_id=").concat(window.user_id),l={proj_id:t.project.proj_id},t.scope&&t.scope.scope_id&&(l.du_model_id=t.scope.scope_id),a.field_code&&(l.field_code=a.field_code),a.field_name&&(l.field_name=a.field_name),e.p=1,console.log("Fetching UDF data:",l),e.n=2,fetch(s,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(l)});case 2:if((c=e.v).ok){e.n=3;break}throw new Error("UDF API fetch failed: ".concat(c.status));case 3:return e.n=4,c.json();case 4:u=e.v,(d=u.data&&u.data.length>0?u.data[0]:null)?(console.log("UDF data received:",d),t.userData||(t.userData={}),t.userData.udf||(t.userData.udf={}),t.userData.udf.field_code=d.field_code||a.field_code||"",t.userData.udf.field_name=d.field_name||a.field_name||"",(p=t.getPort("output0"))?(h=O({},o),p.setUserData(h)):console.warn("Output port 'output0' not found on CustomFieldnode",t.id)):(console.warn("UDF API returned no data for query:",l),t.userData||(t.userData={}),t.userData.udf||(t.userData.udf={}),t.userData.udf.field_code=a.field_code||"",t.userData.udf.field_name=a.field_name||"",f="UDF API returned no data for query: ".concat(JSON.stringify(l),". Using config values as fallback."),console.warn(f),this.scope.aiReportNodeErrors.push({type:"Warning",id:a.id,nodeType:"CustomFieldnode",message:f}),(m=t.getPort("output0"))&&m.setUserData(O({},o))),e.n=6;break;case 5:e.p=5,b=e.v,g="Error fetching UDF API data: ".concat(b.message),console.error(g,b),this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"CustomFieldnode",message:g}),t.userData||(t.userData={}),t.userData.udf||(t.userData.udf={}),t.userData.udf.field_code=a.field_code||"",t.userData.udf.field_name=a.field_name||"",(y=t.getPort("output0"))&&y.setUserData(O({},o));case 6:e.n=8;break;case 7:_="Cannot fetch UDF data - missing valid project context from parent node.",console.warn(_,a),this.scope.aiReportNodeErrors.push({type:"NodeError",id:a.id,nodeType:"CustomFieldnode",message:_});case 8:return e.a(2)}}),e,this,[[1,5]])}))),function(e,t,n){return a.apply(this,arguments)})},{key:"configureTransformNode",value:function(e,t,a){var n=this.findParentPortData(t.id,a);if(n){if(n.project&&(e.project=n.project),n.scope&&(e.scope=n.scope),n.sop&&(e.sop=n.sop),n.du_model&&(e.du_model=n.du_model),e.userData||(e.userData={}),t.hasOwnProperty("transform"))if(Array.isArray(t.transform))try{e.userData.transform=JSON.stringify(t.transform,null,4),console.log("Stringified transform for node ".concat(t.id))}catch(a){console.error("Error stringifying transform for node ".concat(t.id,":"),a),e.userData.transform="[]"}else e.userData.transform=t.transform;var o=e.getPort("output0");if(o){var i=O({},n);o.setUserData(i)}}else{var r="Transform node (ID: ".concat(t.id,") has no parent context or source node not found. Proceeding with config data only.");if(console.warn(r),this.scope.aiReportNodeErrors.push({type:"Warning",id:t.id,nodeType:"Transformnode",message:r}),e.userData||(e.userData={}),t.hasOwnProperty("transform")&&Array.isArray(t.transform))if(Array.isArray(t.transform))try{e.userData.transform=JSON.stringify(t.transform)}catch(a){console.error("Error stringifying transform for node ".concat(t.id," (fallback):"),a),e.userData.transform="[]"}else e.userData.transform=t.transform}}},{key:"configureGenericNode",value:function(e,t,a){var n=this.findParentPortData(t.id,a);if(n){for(var o in n.project&&(e.project=n.project),n.scope&&(e.scope=n.scope),n.sop&&(e.sop=n.sop),n.du_model&&(e.du_model=n.du_model),t)"id"===o||"class"===o||"label"===o||e.hasOwnProperty(o)||(e.userData||(e.userData={}),"object"!==D(t[o])||null===t[o]||Array.isArray(t[o])?e.userData[o]=t[o]:("object"===D(e.userData[o])&&null!==e.userData[o]||(e.userData[o]={}),Object.assign(e.userData[o],t[o])));var i=e.getPort("output0");if(i){var r=O({},n);i.setUserData(r)}}else{var s="Generic node (ID: ".concat(t.id,") has no parent context or source node not found. Proceeding with config data only.");for(var o in console.warn(s),this.scope.aiReportNodeErrors.push({type:"Warning",id:t.id,nodeType:t.class,message:s}),e.userData||(e.userData={}),t)"id"===o||"class"===o||"label"===o||e.hasOwnProperty(o)||(e.userData[o]=t[o])}}},{key:"createConnections",value:function(e,t,a){var n=this;e.forEach((function(e){var o=t[e.src]||t[e.source],i=t[e.trgt]||t[e.target],r="Connection ".concat(e.src||e.source," -> ").concat(e.trgt||e.target);if(o&&i)try{var s=o.getOutputPort(0),l=i.getInputPort(0);if(s&&l){var u=new(c().Connection);u.setSource(s),u.setTarget(l);var d=new(c().layout.connection.SplineConnectionRouter);u.setRouter(d),a.add(u),console.log("".concat(r,": Created successfully."))}else{var p="";s||(p="Source port not found on node ".concat(o.ai_id," (Class: ").concat(o.getCssClass(),")."),console.error("".concat(r,": ").concat(p))),l||(p+="".concat(p?" ":"","Target port not found on node ").concat(i.ai_id," (Class: ").concat(i.getCssClass(),")."),console.error("".concat(r,": ").concat(p))),n.scope.aiReportNodeErrors.push({type:"ConnectionError",src:e.src||e.source,trgt:e.trgt||e.target,message:"".concat(r,": ").concat(p)})}}catch(t){var h="Error creating connection: ".concat(t.message);console.error("".concat(r,": ").concat(h),e,t),n.scope.aiReportNodeErrors.push({type:"ConnectionError",src:e.src||e.source,trgt:e.trgt||e.target,message:"".concat(r,": ").concat(h)})}else{var f="";o||(f="Source node ID '".concat(e.src||e.source,"' not found in created nodes map."),console.error("".concat(r,": ").concat(f))),i||(f+="".concat(f?" ":"","Target node ID '").concat(e.trgt||e.target,"' not found in created nodes map."),console.error("".concat(r,": ").concat(f))),n.scope.aiReportNodeErrors.push({type:"ConnectionError",src:e.src||e.source,trgt:e.trgt||e.target,message:"".concat(r,": ").concat(f)})}}))}},{key:"findParentPortData",value:function(e,t){if(!this.currentConnections||0===this.currentConnections.length)return console.error("findParentPortData called but this.currentConnections is not set."),null;var a,n=T(this.currentConnections);try{for(n.s();!(a=n.n()).done;){var o=a.value;if((o.trgt||o.target)===e){var i=o.src||o.source,r=t[i];if(r){var s=r.getOutputPort(0);if(s)return console.log("findParentPortData: Found parent data for ".concat(e," from source ").concat(i," port ").concat(s.getName())),s.getUserData();console.warn("findParentPortData: Source node ".concat(i," for target ").concat(e," found, but output port 'output0' is missing."))}else console.warn("findParentPortData: Source node ID '".concat(i,"' specified in connection to target ").concat(e," not found in nodesMap."));return null}}}catch(e){n.e(e)}finally{n.f()}return console.log("findParentPortData: No parent connection found for ".concat(e," in config connections.")),null}},{key:"findIncomingConnection",value:function(e,t){for(var a=0,n=Object.entries(t);a<n.length;a++)for(var o=E(n[a],2),i=(o[0],o[1]),r=i.getOutputPorts(),s=0;s<r.getSize();s++){var l=r.get(s);if(l&&l.getParent()&&l.userData&&l.userData.project)return{sourceNode:i,sourcePort:l}}return null}},{key:"layoutNodes",value:function(e,t,a){console.log("Running simple layout...");var n={},o={},i=new Set,r={};t.nodes.forEach((function(e){return r[e.id]=0})),t.connections.forEach((function(e){var t=e.trgt||e.target;void 0!==r[t]&&r[t]++})),o[0]=[],t.nodes.forEach((function(e){0===r[e.id]&&(o[0].push(e.id),n[e.id]=0,i.add(e.id))}));for(var s=0,l=function(){var a=s+1;if(o[a]=[],o[s].forEach((function(r){t.connections.forEach((function(t){var l=t.src||t.source,c=t.trgt||t.target;if(l===r){var u=c;e[u]&&!i.has(u)?(n[u]=a,o[a].push(u),i.add(u)):e[u]&&void 0!==n[u]&&n[u]<=s&&console.warn("Layout: Node ".concat(u," reached again at level ").concat(s,", already at ").concat(n[u]))}}))})),o[a]=function(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(new Set(o[a])),o[a].forEach((function(e){return n[e]=a})),0===o[a].length)return delete o[a],1;s++};o[s]&&o[s].length>0&&!l(););var u=s+1;o[u]=[],t.nodes.forEach((function(e){i.has(e.id)||(console.warn("Layout: Node ".concat(e.id," was unprocessed. Placing at orphan level ").concat(u)),o[u].push(e.id),n[e.id]=u,i.add(e.id))})),0===o[u].length&&delete o[u],Object.keys(o).sort((function(e,t){return e-t})).forEach((function(t){var n=o[t],i=50+120*parseInt(t),r=200*n.length,s=a&&"function"==typeof a.getWidth?a.getWidth():800,l=Math.max(50,(s-r)/2);n.forEach((function(t,a){var n=e[t];if(n){var o=l+200*a+(100-n.getWidth()/2),r=n.getHeight?n.getHeight():50,s=i+a*r;console.log("Positioning node ".concat(t," at (").concat(o,", ").concat(s,")")),n.setPosition(o,s)}}))})),a.getLines().each((function(e,t){(t.getRouter()instanceof c().layout.connection.SplineConnectionRouter||t.getRouter()instanceof c().layout.connection.ManhattanConnectionRouter)&&t.getRouter().route(t)})),console.log("Layout finished.")}},{key:"generateConfigFromNodes",value:function(e){var t=this;console.log("Generating config from nodes...");var a=e.getFigures(),n=e.getLines(),o=[],i=[],r=new Map,s=new Set,l="";console.log("Processing ".concat(a.getSize()," figures from canvas...")),a.each((function(e,t){var a,n,o=t.id,i=t.ai_id,c=i||o;console.log("  Figure ".concat(e,": ID=").concat(o,", AI_ID=").concat(i,", MapID=").concat(c)),"draw2d.shape.fishbone.cell.HTMLnode"===t.NAME&&"html-container"===(null===(a=t.userData)||void 0===a?void 0:a.cont_id)&&(console.log("  -> Found HTML container node: ".concat(c)),s.add(c),null!==(n=t.userData)&&void 0!==n&&n.html&&(l+=t.userData.html,console.log("  -> Added HTML content from node ".concat(c)))),c?r.set(c,t):console.warn("  -> Node found without ai_id or id, skipping:",t)})),console.log("Mapped ".concat(r.size," nodes for config generation.")),0===r.size&&a.getSize()>0&&console.error("CRITICAL: No nodes were mapped despite figures being present on canvas. Check node ID properties (id, ai_id)."),r.forEach((function(e,a){var n;if(s.has(a))console.log("Skipping HTML container node ".concat(a," from nodes array"));else{var i={};i.id=a;var r=e.NAME,l=t.reverseClassMapping[r];if(l){i.class=l,i.label=(null===(n=e.userData)||void 0===n?void 0:n.label)||a;try{var c=e.userData||{};switch(l){case 1:c.project&&(c.project.proj_id&&(i.proj_id=c.project.proj_id),c.project.proj_name&&(i.proj_name=c.project.proj_name),c.project.proj_code&&(i.proj_code=c.project.proj_code));break;case 2:c.du_model&&(c.du_model.du_model_id&&(i.du_model_id=c.du_model.du_model_id),c.du_model.du_model_name&&(i.du_model_name=c.du_model.du_model_name));break;case 3:c.task&&(c.task.scope_task_id&&(i.scope_task_id=c.task.scope_task_id),c.task.scope_task_name&&(i.scope_task_name=c.task.scope_task_name),c.task.scope_task_code&&(i.scope_task_code=c.task.scope_task_code));break;case 4:c.udf&&(c.udf.field_name&&(i.field_name=c.udf.field_name),c.udf.field_code&&(i.field_code=c.udf.field_code));break;case 5:c.sql&&(i.sql=c.sql);break;case 6:break;case 7:if(c.transform)if("string"==typeof c.transform)try{i.transform=m().parse(c.transform)}catch(e){console.error("Error parsing transform JSON for node ".concat(a,":"),e),i.transform=[]}else i.transform=c.transform;break;case 8:c.cont_id&&(i.cont_id=c.cont_id),c.dataset&&(i.dataset=c.dataset),c.config&&(i.config=c.config);break;case 9:c.cont_id&&(i.cont_id=c.cont_id),c.vega&&(i.vega=c.vega),c.leaflet&&(i.leaflet=c.leaflet),c.spec&&(i.spec=c.spec),c.vis_target&&(i.vis_target=c.vis_target);break;case 10:c.cont_id&&(i.cont_id=c.cont_id),c.config&&(i.config=c.config),c.renderer&&(i.renderer=c.renderer),c.menu&&(i.menu=c.menu),c.theme&&(i.theme=c.theme);break;case 11:c.cont_id&&(i.cont_id=c.cont_id),c.html&&(i.html=c.html),c.binder&&(i.binder=c.binder),c.params&&(i.params=c.params);break;case 12:c.style&&(i.style=c.style);break;case 13:c.do&&(i.do=c.do);break;case 14:c.filter&&(i.filter=c.filter),c.cont_id&&(i.cont_id=c.cont_id),c.win_size&&(i.win_size=c.win_size),c.message&&(i.message=c.message),c.showBusket&&(i.showBusket=c.showBusket);break;case 15:c.apiid&&(i.apiid=c.apiid),c.params&&(i.params=c.params)}}catch(e){console.error("Error extracting properties for node ".concat(a," (Class ").concat(l,"):"),e)}o.push(i)}else console.error("Cannot generate config: Unknown class name '".concat(r,"' for node with ID '").concat(a,"'. Skipping node."))}})),n.each((function(e,t){var a,n,o=null===(a=t.getSource())||void 0===a?void 0:a.getParent(),l=null===(n=t.getTarget())||void 0===n?void 0:n.getParent(),c=o?o.ai_id||o.id:null,u=l?l.ai_id||l.id:null;if(c&&s.has(c))console.log("Skipping connection: Source node ".concat(c," is an HTML container node"));else if(u&&s.has(u))console.log("Skipping connection: Target node ".concat(u," is an HTML container node"));else if(c&&u&&r.has(c)&&r.has(u)){var d={src:c,trgt:u};i.push(d)}else console.warn("Skipping connection: Source or target node not found in map or missing ID. Src: ".concat(c,", Trgt: ").concat(u))})),console.log("Processed ".concat(i.length," connections between mapped nodes."));var c={report_config:{nodes:o,connections:i}};return l&&(console.log("Adding HTML container content to report_config.html"),c.report_config.html=l),console.log("Config generation complete.",c),c}},{key:"convertAiIdToNodeId",value:function(e){return e?this.aiIdToNodeIdMap.has(e)?this.aiIdToNodeIdMap.get(e):(console.warn("No node found for AI ID: ".concat(e)),null):null}}],t&&R(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a,n,o,i,r,s}(),B=a("8deafab7866a125bb9ca");function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function H(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,q(n.key),n)}}function q(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=z(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}var V=function(){return e=function e(t,a,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scope=t,this.$uibModal=a,this.$timeout=n},(t=[{key:"handleAPIError",value:function(e,t,a,n,o,i){if(n<=o){console.warn("API error on attempt ".concat(n,". Retrying..."));var r="API Error: Status ".concat(t,", Response: ").concat(e.responseText||"(No response body)");this.$timeout((function(){return i(r)}),1e3)}else this.showErrorToast("API Error (Attempt ".concat(n,"/").concat(o+1,")"),"Failed to communicate with AI service after ".concat(o+1," attempts. Status: ").concat(t,". Please try again later."))}},{key:"handleJSONError",value:function(e,t,a,n){if(t<=a){console.warn("JSON error on attempt ".concat(t,". Retrying..."));var o="JSON Processing Error: ".concat(e.message);this.$timeout((function(){return n(o)}),500)}else this.showErrorToast("JSON Processing Error (Attempt ".concat(t,"/").concat(a+1,")"),"Failed to process response data after ".concat(a+1," attempts. ").concat(e.message,". Please check console."))}},{key:"handleNodeErrors",value:function(e,t,a){console.warn("Errors detected during node generation:",e),this.$uibModal.open({templateUrl:"views/common/aiRetryConfirmModal.html",controller:"AIRetryConfirmModalCtrl",resolve:{nodeErrors:function(){return e}}}).result.then((function(e){"retry"===e?(console.log("User confirmed retry. Retrying..."),t()):(console.log("User cancelled retry. Proceeding anyway."),a())}),(function(e){console.log("Retry confirmation modal dismissed. Proceeding anyway. Reason:",e),a()}))}},{key:"showErrorToast",value:function(e,t){B.bsToast.error({id:"error-".concat(Date.now()),title:e,message:t,timeout:!1,position:"topCenter"})}},{key:"formatNodeErrorsForPrompt",value:function(e){if(!e||0===e.length)return"";var t="--- Previous Node Update Errors ---";return t+="\nThe following nodes/connections failed during the last update. Please review the configuration and correct the issues based on the errors:",e.forEach((function(e){if("NodeError"===e.type||"NodeCreation"===e.type||"Warning"===e.type){var a=e.nodeLabel||"Node ".concat(e.id||e.nodeId||"?"),n=e.nodeType||e.nodeName||"(Unknown Type)",o=e.message||e.errorMessage||"(No details)";t+="\n- ".concat(a," (ID: ").concat(e.id||e.nodeId||"?",", Type: ").concat(n,")\n  ").concat(e.type,": ").concat(o)}else if("ConnectionError"===e.type){var i=e.message||e.errorMessage||"(No details)";t+="\n- Connection ".concat(e.src," -> ").concat(e.trgt,"\n  Error: ").concat(i)}else t+="\n- Unknown Error: ".concat(JSON.stringify(e))})),t+="\n--- End Errors ---",t+="\n\nPlease retry the request based on the original/edited prompt and these errors."}}])&&H(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),W=a("1ae1679c08b57e46bac7");function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function J(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Q(n.key),n)}}function Q(e){var t=function(e){if("object"!=G(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=G(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==G(t)?t:t+""}const Y=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"unknown-strategy";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logs=[],this.strategyName=t,this.startTime=new Date},(t=[{key:"log",value:function(e,t,a){var n=new Date;this.logs.push({stage:e,timestamp:n.toISOString(),request:t,response:a}),console.log("ApiLogger: Logged data for stage '".concat(e,"'"))}},{key:"getLogs",value:function(){return this.logs}},{key:"clearLogs",value:function(){this.logs=[],this.startTime=new Date,console.log("ApiLogger: Logs cleared.")}},{key:"downloadLogs",value:function(){if(0===this.logs.length)return console.warn("ApiLogger: No logs to download."),void alert("No API call data has been logged yet.");var e=JSON.stringify(this.logs,null,2),t=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(t),n=document.createElement("a"),o=this.startTime.toISOString().replace(/[:.]/g,"-");n.href=a,n.download="".concat(this.strategyName,"-api-logs-").concat(o,".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a),console.log("ApiLogger: Logs download initiated as ".concat(n.download))}}])&&J(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();var X=a("ddb769317bccdb9508d6"),K=a.n(X),Z=a("a07cf1589ac14f300c0c"),$=a.n(Z),ee=a("0f5f6c58c44433ecd53f"),te=a.n(ee),ae=a("da32941d39823d668307"),ne=a.n(ae),oe=(a("30818c613adc53d01123"),a("ac589d12568d55d68f1b")),ie=a.n(oe),re=a("a45670b3d8fb79ec0258");function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function le(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return ce(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(ce(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,ce(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,ce(d,"constructor",c),ce(c,"constructor",l),l.displayName="GeneratorFunction",ce(c,o,"GeneratorFunction"),ce(d),ce(d,o,"Generator"),ce(d,n,(function(){return this})),ce(d,"toString",(function(){return"[object Generator]"})),(le=function(){return{w:i,m:p}})()}function ce(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ce=function(e,t,a,n){function i(t,a){ce(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},ce(e,t,a,n)}function ue(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function de(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){ue(i,n,o,r,s,"next",e)}function s(e){ue(i,n,o,r,s,"throw",e)}r(void 0)}))}}function pe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,he(n.key),n)}}function he(e){var t=function(e){if("object"!=se(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=se(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==se(t)?t:t+""}var fe=function(){return e=function e(t,a,n,o,i,r,s,l,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.scope=a,this.settings=n,this.$compile=o,this.$sanitize=i,this.$http=r,this.$rootScope=s,this.$timeout=l,this.$uibModal=c,this.$interval=u,this.initHistory={currentPrompt:"",currentResponse:"",currentModel:"",currentTemperature:.2,stage1Provider:"openrouter",stage1Model:"",stage1Temperature:.2,stage1Retries:2,stage2Provider:"openrouter",stage2Model:"",stage2Temperature:.1,stage2Retries:2,maxTokens:16e3,promptApproach:"three-stage-rag",useIncrementalUpdates:!1,conversationMessages:[],requirementsAnalysisResponse:void 0,planningResponse:void 0,implementationResponse:void 0,scoreThreshold:.6,lastIncrementalUpdate:null},this.ApiLoggerClass=Y,this.aiPromptHistory=re.extend({},this.initHistory),this.promptManager=new k,this.nodeManager=new U(t,a,o,i,n),this.errorHandler=new V(a,c,l),this.strategies={};try{this.configNormalizer=new(K()),this.embeddingUtils=new($())(this.$http,this.settings,this.settings.embeddingConfig||{}),this.branchRepository=new(te())(this.$http,this.settings,this.embeddingUtils),this.componentRepository=new(ne())(this.$http,this.settings,this.embeddingUtils),this.componentExtractor=new(ie()),console.log("RAG components initialized (client-side part). Backend handles DB connection.")}catch(e){console.error("Error initializing RAG components:",e),this.branchRepository=null,W.A.showErrorToast("RAG Init Error","Failed to initialize RAG components: ".concat(e.message))}},t=[{key:"generateAIReport",value:function(){var e,t=this;if(console.log("generateAIReport called"),null!==(e=this.scope.editor)&&void 0!==e&&e.fishboneAIAssistant)return console.log("Redirecting to AI Assistant for report generation"),this.scope.editor.showAIAssistant=!0,void this.scope.editor.fishboneAIAssistant.sendSystemMessage("Ready to create a new report. Please describe what kind of report you'd like to generate.");this.openConfigModal("generate",[]).then((function(e){return t.executeReportGeneration(e)})).catch((function(e){return console.log("Modal dismissed:",e)}))}},{key:"retryAIRequest",value:function(){var e,t=this;return console.log("retryAIRequest called"),null!==(e=this.scope.editor)&&void 0!==e&&e.fishboneAIAssistant?(console.log("Redirecting to AI Assistant for retry"),this.scope.editor.showAIAssistant=!0,void this.scope.editor.fishboneAIAssistant.sendSystemMessage("Ready to retry the previous report generation. You can modify your previous request or provide new instructions.")):this.aiPromptHistory&&this.aiPromptHistory.currentPrompt||0!==this.aiPromptHistory.conversationMessages.length?void this.openConfigModal("retry",this.scope.aiReportNodeErrors||[]).then((function(e){return t.executeReportGeneration(e)})).catch((function(e){return console.log("Retry modal dismissed:",e)})):(console.warn("Retry requested, but no previous history found. Starting new chat instead."),W.A.showWarningToast("No previous report to retry. Starting new report generation."),void this.startNewAIChat())}},{key:"replyToAIRequest",value:function(){var e,t=this;if(console.log("replyToAIRequest called"),null!==(e=this.scope.editor)&&void 0!==e&&e.fishboneAIAssistant)return console.log("Redirecting to AI Assistant for reply"),this.scope.editor.showAIAssistant=!0,void this.scope.editor.fishboneAIAssistant.sendSystemMessage("You can continue working on the current report. What changes would you like to make?");this.openConfigModal("reply",[]).then((function(e){return t.executeReplyGeneration(e)})).catch((function(e){return console.log("Reply modal dismissed:",e)}))}},{key:"startNewAIChat",value:function(){this.aiPromptHistory=re.extend({},this.initHistory),this.generateAIReport()}},{key:"openConfigModal",value:function(e,t){var a=this;return console.log("Opening AI Report modal for ".concat(e)),this.$uibModal.open({templateUrl:"views/common/aiReplyModalTemplate.html",controller:"AIReportModalCtrl",size:"lg",resolve:{aiPromptHistory:function(){return a.aiPromptHistory},settings:function(){return a.settings},canvas:function(){return a.canvas},modalType:function(){return e},errorArray:function(){return t}}}).result}},{key:"executeReportGeneration",value:function(e){if(e){console.log("Processing AI Report modal result. Method:",e.generationMethod),this.updatePromptHistory(e);var t=this.getStrategyForMethod(e.generationMethod,e.promptApproach);if(!t)return console.warn("No strategy available - redirecting to new AI assistant"),void W.A.showWarningToast("Report Generation","Please use the AI Assistant for report generation");t.execute(e)}else console.log("AI Report modal returned empty result")}},{key:"executeReplyGeneration",value:function(e){if(e&&e.replyText){console.log("Processing AI Report modal reply result. Method:",e.generationMethod);var t,a,n=!this.aiPromptHistory||!this.aiPromptHistory.currentPrompt||!this.aiPromptHistory.currentResponse;if(n){console.log("Generating context from current canvas state...");try{t="You are updating existing report from existing configuration. Please provide existing configuration in nex message.",this.aiPromptHistory.conversationMessages.push({role:"user",content:t}),a={implementation:this.nodeManager.generateConfigFromNodes(this.canvas)},this.aiPromptHistory.implementationResponse=a.implementation,this.aiPromptHistory.conversationMessages.push({role:"assistant",content:JSON.stringify(a.implementation)}),console.log("Generated context:",a)}catch(e){return console.error("Error generating config from nodes:",e),void W.A.showErrorToast("Context Generation Failed","Could not generate context from the current report: ".concat(e.message))}}else t=this.aiPromptHistory.currentPrompt,a=this.aiPromptHistory.currentResponse;var o=this.buildReplyPrompt(t,a,e.replyText,n);e.prompt=o,e.needsGeneratedContext=n,this.updatePromptHistory(e),(this.isConversationalProvider(e.stage1Provider)||this.isConversationalProvider(e.stage2Provider))&&(0===this.aiPromptHistory.conversationMessages.length?console.log("Conversational reply with empty history. Strategy will initialize."):(this.aiPromptHistory.conversationMessages.push({role:"user",content:e.replyText}),console.log("Added user reply to existing conversationMessages.")));var i=this.getStrategyForMethod(e.generationMethod,e.promptApproach);if(!i)return console.warn("No strategy available - redirecting to new AI assistant"),void W.A.showWarningToast("Report Generation","Please use the AI Assistant for report generation");i.execute(e,!0)}else console.log("AI Report modal returned empty or invalid result (missing replyText)")}},{key:"buildReplyPrompt",value:function(e,t,a,n){var o=n?"### Current Report Context ###\n".concat(e,"\n"):"### Previous Conversation Context ###\nOriginal User Request: ".concat(e,"\n"),i="";return t&&(!n&&"classic"===this.aiPromptHistory.generationMethod&&t.stage1?(i+="AI Thinking/Structure (Stage 1): ".concat(JSON.stringify(t.stage1),"\n"),t.stage2&&(i+="AI Generated Config (Stage 2): ".concat(JSON.stringify(t.stage2),"\n"))):i+="AI Previous Response / Current Config: ".concat(JSON.stringify(t),"\n")),"".concat(o).concat(i,"### End Context ###\n\n### New User Instruction ###\n").concat(a,"\n### End Instruction ###\n\nPlease process the new instruction based on the provided context.")}},{key:"updatePromptHistory",value:function(e){this.aiPromptHistory.currentPrompt=e.prompt||this.aiPromptHistory.currentPrompt,this.aiPromptHistory.currentResponse="",this.aiPromptHistory.generationMethod=e.generationMethod,this.aiPromptHistory.promptApproach=e.promptApproach||this.aiPromptHistory.promptApproach,"classic"===e.generationMethod&&(this.aiPromptHistory.stage1Provider=e.stage1Provider,this.aiPromptHistory.stage1Model=e.stage1Model,this.aiPromptHistory.stage1Temperature=e.stage1Temperature,this.aiPromptHistory.stage1Retries=e.stage1Retries,this.aiPromptHistory.stage2Provider=e.stage2Provider,this.aiPromptHistory.stage2Model=e.stage2Model,this.aiPromptHistory.stage2Temperature=e.stage2Temperature,this.aiPromptHistory.stage2Retries=e.stage2Retries),this.aiPromptHistory.maxTokens=e.maxTokens}},{key:"getStrategyForMethod",value:function(e){return console.warn("Old strategy system called - this should redirect to new AI assistant"),null}},{key:"isConversationalProvider",value:function(e){return["zte_v2","openai","deepseek","openrouter"].includes(e)}},{key:"exportReportConfigToFile",value:function(e){console.log("Exporting report configuration to file...");try{var t=this.nodeManager.generateConfigFromNodes(this.canvas);if(!t||!t.report_config||0===t.report_config.nodes.length)return console.warn("No nodes found on canvas or configuration is empty. Cannot export."),void W.A.showWarningToast("Export Failed","No report configuration found on the canvas to export.");var a=JSON.stringify(t,null,2),n=new Blob([a],{type:"application/json;charset=utf-8;"}),o=document.createElement("a");if(void 0!==o.download){var i=URL.createObjectURL(n);o.setAttribute("href",i),o.setAttribute("download","report-config("+e+").json"),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),console.log("Report configuration export initiated.")}else console.error("Browser does not support the download attribute."),W.A.showErrorToast("Export Failed","Your browser does not support direct file downloads.")}catch(e){console.error("Error exporting report configuration:",e),W.A.showErrorToast("Export Failed","An error occurred while exporting the configuration: ".concat(e.message))}}},{key:"readFileContentClientSide",value:function(e){return new Promise((function(t,a){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(t){console.error("Error reading file:",t),a(new Error("Error reading file ".concat(e.name,": ").concat(t)))},n.readAsText(e)}))}},{key:"extractAndStoreBranchesFromFiles",value:(o=de(le().m((function e(t){var n,o,i,r,s,l,c,u,d,p,h,f,m,g,y,_,b,v,w,x,k,D=arguments;return le().w((function(e){for(;;)switch(e.p=e.n){case 0:if(n=D.length>1&&void 0!==D[1]?D[1]:null,o=Array.from(t),console.log("Starting branch extraction from ".concat(o.length," selected files.")),this.branchRepository){e.n=1;break}throw i=new Error("Branch repository is not initialized. Cannot store branches."),W.A.showErrorToast({title:"Extraction Error",message:i.message}),i;case 1:if(this.configNormalizer){e.n=2;break}throw r=new Error("Config normalizer is not initialized."),W.A.showErrorToast({title:"Extraction Error",message:r.message}),r;case 2:return e.p=2,e.n=3,Promise.resolve().then(a.bind(a,"30818c613adc53d01123"));case 3:l=e.v,s=l.default,e.n=5;break;case 4:throw e.p=4,w=e.v,console.error("Failed to load BranchExtractionStrategy:",w),c=new Error("Could not load the branch extraction strategy module."),W.A.showErrorToast({title:"Extraction Error",message:c.message}),c;case 5:u=new s(this),d=!n,n||(n=W.A.createLoadingIndicator("Starting branch extraction...","Processing 0/".concat(o.length," files."))),p=0,h=0,f=0,e.p=6,console.log("File array length before branch extraction loop: ".concat(o.length)),m=0,g=o;case 7:if(!(m<g.length)){e.n=15;break}if(y=g[m],p++,_="Processing branch extraction ".concat(p,"/").concat(o.length,": ").concat(y.name),console.log(_),n.find(".loading-main-message").text(_),n.find(".loading-details").text("Extracted: ".concat(h,", Errors: ").concat(f)),"application/json"===y.type){e.n=9;break}return console.warn("Skipping non-JSON file: ".concat(y.name)),f++,e.n=8,new Promise((function(e){return setTimeout(e,100)}));case 8:return e.a(3,14);case 9:return e.p=9,e.n=10,this.readFileContentClientSide(y);case 10:return b=e.v,console.log("Read content for ".concat(y.name,", size: ").concat(b.length," characters")),e.n=11,u.execute(b);case 11:return(v=e.v).success?(console.log("Successfully processed ".concat(y.name,", extracted ").concat(v.count," branches.")),h+=v.count):(console.error("Failed to process ".concat(y.name,": ").concat(v.error||"Unknown strategy error")),f++),e.n=12,new Promise((function(e){return setTimeout(e,500)}));case 12:e.n=14;break;case 13:e.p=13,x=e.v,console.error("Error processing file ".concat(y.name,":"),x),f++;case 14:m++,e.n=7;break;case 15:return e.a(2,{processed:p,extracted:h,errors:f});case 16:throw e.p=16,k=e.v,console.error("Error during batch branch extraction process:",k),k;case 17:return e.p=17,d&&n&&n.remove(),e.f(17);case 18:return e.a(2)}}),e,this,[[9,13],[6,16,17,18],[2,4]])}))),function(e){return o.apply(this,arguments)})},{key:"extractAndStoreGranularComponents",value:(n=de(le().m((function e(t){var n,o,i,r,s,l,c,u,d,p,h,f,m,g,y,_,b,v,w,x,k,D=arguments;return le().w((function(e){for(;;)switch(e.p=e.n){case 0:if(n=D.length>1&&void 0!==D[1]?D[1]:null,o=Array.from(t),console.log("Starting granular components extraction from ".concat(o.length," selected files.")),this.componentRepository){e.n=1;break}throw i=new Error("Component repository is not initialized. Cannot store components."),W.A.showErrorToast({title:"Extraction Error",message:i.message}),i;case 1:if(this.configNormalizer){e.n=2;break}throw r=new Error("Config normalizer is not initialized."),W.A.showErrorToast({title:"Extraction Error",message:r.message}),r;case 2:return e.p=2,e.n=3,a.e(258).then(a.bind(a,"b0cc4c2b12cd7e142b55"));case 3:l=e.v,s=l.default,e.n=5;break;case 4:throw e.p=4,w=e.v,console.error("Failed to load GranularComponentsExtractionStrategy:",w),c=new Error("Could not load the granular components extraction strategy module."),W.A.showErrorToast({title:"Extraction Error",message:c.message}),c;case 5:u=new s(this),d=!n,n||(n=W.A.createLoadingIndicator("Starting granular components extraction...","Processing 0/".concat(o.length," files."))),p=0,h=0,f=0,e.p=6,console.log("File array length before components extraction loop: ".concat(o.length)),m=0,g=o;case 7:if(!(m<g.length)){e.n=15;break}if(y=g[m],p++,_="Processing component extraction ".concat(p,"/").concat(o.length,": ").concat(y.name),console.log(_),n.find(".loading-main-message").text(_),n.find(".loading-details").text("Extracted: ".concat(h,", Errors: ").concat(f)),"application/json"===y.type){e.n=9;break}return console.warn("Skipping non-JSON file: ".concat(y.name)),f++,e.n=8,new Promise((function(e){return setTimeout(e,100)}));case 8:return e.a(3,14);case 9:return e.p=9,e.n=10,this.readFileContentClientSide(y);case 10:return b=e.v,console.log("Read content for ".concat(y.name,", size: ").concat(b.length," characters")),e.n=11,u.execute(b);case 11:return(v=e.v).success?(console.log("Successfully processed ".concat(y.name,", extracted ").concat(v.count," components.")),h+=v.count):(console.error("Failed to process ".concat(y.name,": ").concat(v.error||"Unknown strategy error")),f++),e.n=12,new Promise((function(e){return setTimeout(e,500)}));case 12:e.n=14;break;case 13:e.p=13,x=e.v,console.error("Error processing file ".concat(y.name,":"),x),f++;case 14:m++,e.n=7;break;case 15:return e.a(2,{processed:p,extracted:h,errors:f});case 16:throw e.p=16,k=e.v,console.error("Error during batch component extraction process:",k),k;case 17:return e.p=17,d&&n&&n.remove(),e.f(17);case 18:return e.a(2)}}),e,this,[[9,13],[6,16,17,18],[2,4]])}))),function(e){return n.apply(this,arguments)})},{key:"executeIncrementalUpdate",value:function(){var e,t=this;if(console.log("executeIncrementalUpdate called"),null!==(e=this.scope.editor)&&void 0!==e&&e.fishboneAIAssistant)return console.log("Redirecting to AI Assistant for incremental update"),this.scope.editor.showAIAssistant=!0,void this.scope.editor.fishboneAIAssistant.sendSystemMessage("Ready to make incremental updates to your report. What specific changes would you like to make?");this.openConfigModal("incremental",[]).then((function(e){return e.useIncrementalUpdates=!0,e.replyText||(e.replyText=e.prompt||"Please update this report with the latest changes.",console.log("Added missing replyText for incremental update:",e.replyText)),t.executeReplyGeneration(e)})).catch((function(e){return console.log("Incremental update modal dismissed:",e)}))}}],t&&pe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,o}();function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function ge(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return ye(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(ye(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,ye(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,ye(d,"constructor",c),ye(c,"constructor",l),l.displayName="GeneratorFunction",ye(c,o,"GeneratorFunction"),ye(d),ye(d,o,"Generator"),ye(d,n,(function(){return this})),ye(d,"toString",(function(){return"[object Generator]"})),(ge=function(){return{w:i,m:p}})()}function ye(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ye=function(e,t,a,n){function i(t,a){ye(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},ye(e,t,a,n)}function _e(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function be(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){_e(i,n,o,r,s,"next",e)}function s(e){_e(i,n,o,r,s,"throw",e)}r(void 0)}))}}var ve=a("75d5b6ff75f50ea1bb38"),we=a("42dfa9a4f20b59ef0976"),xe=a("a45670b3d8fb79ec0258"),ke=a("8deafab7866a125bb9ca"),De=a("a45670b3d8fb79ec0258");function Se(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return Ce(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Ce(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,Ce(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,Ce(d,"constructor",c),Ce(c,"constructor",l),l.displayName="GeneratorFunction",Ce(c,o,"GeneratorFunction"),Ce(d),Ce(d,o,"Generator"),Ce(d,n,(function(){return this})),Ce(d,"toString",(function(){return"[object Generator]"})),(Se=function(){return{w:i,m:p}})()}function Ce(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ce=function(e,t,a,n){function i(t,a){Ce(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},Ce(e,t,a,n)}function Te(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function Ae(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){Te(i,n,o,r,s,"next",e)}function s(e){Te(i,n,o,r,s,"throw",e)}r(void 0)}))}}function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}var Ee=a("a45670b3d8fb79ec0258"),Ie=function(e,t,a){return{restrict:"E,A",link:function(e,t,n,o){a((function(){Ee(".draw2d_droppable").draggable({appendTo:"body",stack:"body",zIndex:27e3,helper:"clone",drag:function(e,t){},stop:function(e,t){},start:function(e,t){Ee(t.helper).addClass("shadow")}})}),0)},templateUrl:"./views/common/pallet.html"}};Ie.$inject=["$window","$parse","$timeout"];const Ne=Ie;var Me=a("81da13ea95571ac08f44"),Oe=a.n(Me),je=a("a45670b3d8fb79ec0258");function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function Le(){document.querySelectorAll(".snap-guide").forEach((function(e){return e.style.opacity="0"}))}const Fe=s().module("services",[]).factory("loginUserService",["$resource",function(e){return e(i().context+"/users/:action",{},{authUser:{method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"}}})}]).factory("FileFactory",["$http","$rootScope",function(e,t){return{getReport:function(a,n){return e.get(i().context+"/mongo/getData?file_name="+a+"&username="+t.username+"&proj_id="+t.project_id+"&action="+n).then((function(e){return t.report_name=e.data.report_name,t.author=e.data.author,e.data}),(function(e){}))},getReportList:function(t,a){return e.get(i().context+"/data/getSimpleReportList?user="+t+"&project_code="+a).then((function(e){return e.data}),(function(e){}))},getPlaylist:function(t){return e.get(i().context+"/mongo/getPlaylist?playlist_id="+t).then((function(t){var a={slides:[]};if(a.playlist=t.data,t.data.reports.length)return e.post(i().context+"/mongo/getReportsByIds",t.data.reports).then((function(e){var n,o,i=[];t.data.reports.forEach((function(t,a){e.data.forEach((function(e){e.file_name===t&&i.push(e)}))}));for(var r=0;r<i.length;r++)n=r,o=i[r],a.slides.push({content:o.file_name,description:o.description,author:o.author,has_html:o.has_html,no_html_ed:o.no_html_ed,editorJson:o.editorJson,create_date:o.create_date.substring(0,10),id:n,canvas:{width:o.canvas_width?o.canvas_width:6e3,height:o.canvas_height?o.canvas_height:6e3,auto_width:o.auto_width,auto_height:o.auto_height},report_name:o.report_name});return a}))}),(function(e){}))}}}]).service("DraggableService",(function(){var e=new WeakSet;return{initializeDraggable:function(t){if(!e.has(t)){var a=t[0],n=a.querySelector(".ibox-title");if(n&&!e.has(n)){var o=null,i=null;Oe()(n).draggable({inertia:!0,modifiers:[Oe().modifiers.restrict({restriction:"#layout_container",elementRect:{top:0,left:0,bottom:1,right:1}}),Oe().modifiers.snap({targets:[function(e,t,n){if(!a.classList.contains("ibox-detached"))return null;var o=[],i=a.getBoundingClientRect(),r=je("#layout_container");return o.push({x:0,y:t,range:20},{x:r.innerWidth-i.width,y:t,range:20},{x:e,y:0,range:20},{x:e,y:r.innerHeight-i.height,range:20}),o}],relativePoints:[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}],endOnly:!1})],listeners:{start:function(e){if(!a.classList.contains("ibox-detached")){o=a.getBoundingClientRect(),i={width:a.offsetWidth,height:a.offsetHeight},a.classList.add("ibox-detached"),a.style.width="".concat(i.width,"px"),a.style.height="".concat(i.height,"px"),a.style.left="".concat(o.left,"px"),a.style.top="".concat(o.top,"px");var t=a.querySelector(".restore-position");t&&t.removeAttribute("hidden")}var n,r=Math.max.apply(Math,function(e){if(Array.isArray(e))return Re(e)}(n=Array.from(document.querySelectorAll(".ibox-detached")).map((function(e){return parseInt(getComputedStyle(e).zIndex)||0})))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return Re(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Re(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());a.style.zIndex=r+1},move:function(e){var t=(parseFloat(a.getAttribute("data-x"))||0)+e.dx,n=(parseFloat(a.getAttribute("data-y"))||0)+e.dy;a.style.transform="translate(".concat(t,"px, ").concat(n,"px)"),a.setAttribute("data-x",t),a.setAttribute("data-y",n),e.snap?(a.classList.add("snapping"),function(e,t){!function(){if(!document.querySelector(".snap-guides")){var e=document.createElement("div");e.className="snap-guides";var t=document.createElement("div");t.className="snap-guide horizontal",e.appendChild(t);var a=document.createElement("div");a.className="snap-guide vertical",e.appendChild(a),document.body.appendChild(e)}}();var a=t.getBoundingClientRect(),n=document.querySelector(".snap-guide.horizontal"),o=document.querySelector(".snap-guide.vertical");void 0!==e.snap.x&&(o.style.left="".concat(a.left,"px"),o.style.opacity="1"),void 0!==e.snap.y&&(n.style.top="".concat(a.top,"px"),n.style.opacity="1")}(e,a)):(a.classList.remove("snapping"),Le())},end:function(e){Le(),a.classList.remove("snapping")}}}),Oe()(a).resizable({edges:{left:!0,right:!0,bottom:!0,top:!1},listeners:{start:function(e){document.body.classList.add("resize-in-progress"),a.classList.contains("ibox-detached")&&e.stopPropagation()},move:function(e){e.stopPropagation();var t=e.target.dataset,a=t.x,n=t.y;a=parseFloat(a)||0,n=parseFloat(n)||0,e.target.style.width="".concat(e.rect.width,"px"),e.target.style.height="".concat(e.rect.height,"px"),a+=e.deltaRect.left,n+=e.deltaRect.top,e.target.style.transform="translate(".concat(a,"px, ").concat(n,"px)"),Object.assign(e.target.dataset,{x:a,y:n}),r(e.target)},end:function(e){document.body.classList.remove("resize-in-progress"),e.stopPropagation(),r(e.target)}},modifiers:[Oe().modifiers.restrictEdges({outer:"window"}),Oe().modifiers.restrictSize({min:{width:200,height:200}})],inertia:!1}),e.add(t[0])}}function r(e){var t,a=e.querySelector(".chat-container, .ai-chat-container");if(a){var n=a.querySelector(".input-area, .ai-input-area");if(n){var o=a.querySelector(".chat-messages, .ai-chat-messages");if(o){var i=e.querySelector(".ibox-content");if(i){var r=(null===(t=e.querySelector(".ibox-title"))||void 0===t?void 0:t.offsetHeight)||0,s=e.offsetHeight-r;i.style.height="".concat(s,"px"),i.style.overflow="hidden";var l=e.querySelector(".ai-assistant-container");if(l){l.style.height="100%";var c=l.querySelector(".ai-config-section"),u=c?c.offsetHeight:0,d=l.querySelector(".ai-typing-panel"),p=s-u-(d&&!d.classList.contains("ng-hide")?d.offsetHeight:0)-(n?n.offsetHeight:0)-20;o&&(o.style.height="".concat(p,"px"))}else{a.style.height="100%",a.style.display="flex",a.style.flexDirection="column";var h=s-n.offsetHeight;o.style.height="".concat(h,"px"),o.style.overflowY="auto",n.style.marginTop="auto"}}}}}}}}})).name;var Ue=a("a45670b3d8fb79ec0258");function Be(e,t){return{link:function(a,n){e.$on("$stateChangeStart",(function(e,a,o,i,r){var s="ZTE | FishBone EPMS PlugIn";a.data&&a.data.pageTitle&&(s="FishBone | "+a.data.pageTitle),t((function(){n.text(s)}))}))}}}function ze(e){return{restrict:"A",link:function(t,a){e((function(){a.metisMenu()}))}}}function He(e){return{restrict:"A",scope:!0,templateUrl:"views/common/ibox_tools.html",controller:["$scope","$element",function(t,a){t.showhide=function(){var t=a.closest("div.ibox"),n=a.find("svg:first");t.find("div.ibox-content").slideToggle(200),n.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),t.toggleClass("").toggleClass("border-bottom"),e((function(){t.resize(),t.find("[id^=map-]").resize()}),50)},t.closebox=function(){a.closest("div.ibox").remove()},t.closebox=function(){a.closest("div.ibox").remove()},t.restore=function(){var e=a.closest("div.ibox"),t=e.find(".restore-position");e.removeClass("ibox-detached"),e.css("transform","none"),e.css("width",""),e.css("height",""),e.css("left",""),e.css("top",""),e.removeAttr("data-x"),e.removeAttr("data-y"),t&&t.attr("hidden","")}}]}}function qe(e){return{restrict:"A",scope:!0,templateUrl:"views/common/ibox_tools_ai.html",controller:["$scope","$element",function(t,a){var n=t.$parent;t.showhide=function(){var t=a.closest("div.ibox"),o=a.find("i.fa-chevron-up, i.fa-chevron-down").first();t.find("div.ibox-content").slideToggle(200),o.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),t.toggleClass("").toggleClass("border-bottom"),e((function(){t.resize(),t.find("[id^=map-]").resize()}),50),n.editor&&(n.editor.aiAssistantCollapsed=o.hasClass("fa-chevron-down"))},t.closebox=function(){n.editor&&n.editor.toggleAIAssistant?n.editor.toggleAIAssistant():a.closest("div.ibox").remove()},t.restore=function(){var e=a.closest("div.ibox"),t=e.find(".restore-position");e.removeClass("ibox-detached"),e.css("transform","none"),e.css("width",""),e.css("height",""),e.css("left",""),e.css("top",""),e.removeAttr("data-x"),e.removeAttr("data-y"),t&&t.attr("hidden",""),n.editor&&(n.editor.aiAssistantDetached=!1)},t.showAIConfig=function(){n.editor&&n.editor.showAIConfigModal&&n.editor.showAIConfigModal()},t.clearAIHistory=function(){n.editor&&n.editor.clearAIChatHistory&&n.editor.clearAIChatHistory()},t.exportAIHistory=function(){n.editor&&n.editor.exportAIChatHistory&&n.editor.exportAIChatHistory()},t.dockAIAssistant=function(){n.editor&&n.editor.dockAIAssistant&&n.editor.dockAIAssistant()},t.isAIAssistant=function(){return a.closest("#ai-assistant-panel").length>0},t.getAIState=function(){return n.editor&&n.editor.aiAssistant?n.editor:{}}}]}}function Ve(e){return{restrict:"A",scope:!0,templateUrl:"views/common/ibox_tools_full_screen.html",controller:["$scope","$element",function(t,a){t.showhide=function(){var t=a.closest("div.ibox"),n=a.find("i:first");t.find("div.ibox-content").slideToggle(200),n.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),t.toggleClass("").toggleClass("border-bottom"),e((function(){t.resize(),t.find("[id^=map-]").resize()}),50)},t.fullscreen=function(){var t=a.closest("div.ibox"),n=a.find("i.fa-expand"),o=t.closest('[ng-show="editor.selection.attr != null"]').find("div.ibox"),i=t.find(".ibox-content"),r=i.find(".chat-container"),s=r.find(".chat-messages");if(t.hasClass("fullscreen")){var l=t.data("originalStates");o.not(t).slideDown(200),Ue("body").removeClass("fullscreen-ibox-mode"),n.toggleClass("fa-compress fa-expand"),t.removeClass("fullscreen"),l&&(r.length&&(i.css({"min-height":"",overflow:""}),r.css("height","60vh"),s.css({height:"calc(60vh - 80px)","overflow-y":""})),Ue("body").css("overflow",l.bodyOverflow))}else if(t.data("originalStates")||t.data("originalStates",{iboxHeight:t.height(),chatContainerHeight:r.length?r.height():null,chatMessagesHeight:s.length?s.height():null,bodyOverflow:Ue("body").css("overflow")}),o.not(t).slideUp(200),Ue("body").addClass("fullscreen-ibox-mode"),n.toggleClass("fa-expand fa-compress"),t.addClass("fullscreen"),r.length){var c=Ue("#rightsidepanel").height(),u=2*t.find(".ibox-title").outerHeight(),d=r.find(".input-area").outerHeight();i.css("min-height",c-u+"px"),i.css("overflow","hidden"),r.css("height",c-u+"px"),s.css("height",c-u-d-80+"px"),s.css("overflow-y","auto")}e((function(){Ue(window).trigger("resize"),s.length&&(s[0].scrollTop=s[0].scrollHeight)}),250)},t.closebox=function(){a.closest("div.ibox").remove()}}]}}function We(e){return{restrict:"A",template:'<a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="" ng-click="minimalize()"><i class="fa fa-bars"></i></a>',controller:["$scope","$element",function(e,t){e.minimalize=function(){Ue("body").toggleClass("mini-navbar"),!Ue("body").hasClass("mini-navbar")||Ue("body").hasClass("body-small")?(Ue("#side-menu").hide(),setTimeout((function(){Ue("#side-menu").fadeIn(400)}),200)):Ue("body").hasClass("fixed-sidebar")?(Ue("#side-menu").hide(),setTimeout((function(){Ue("#side-menu").fadeIn(400)}),100)):Ue("#side-menu").removeAttr("style")}}]}}function Ge(e){return{restrict:"A",link:function(t,a){e((function(){a.slimscroll({height:"234px",railOpacity:.4})}))}}}function Je(e){return{restrict:"A",scope:{truncateOptions:"="},link:function(t,a){e((function(){a.dotdotdot(t.truncateOptions)}))}}}function Qe(e,t,a){return{restrict:"A",compile:function(n,o){var i=t(o.compileHtml),r=t(o.compileHtml,(function(e){return(e||"").toString()}));return a.$$addBindingClass(n),function(t,n,o){a.$$addBindingInfo(n,o.compileHtml),t.$watch(r,(function(){n.html(e.trustAsHtml(i(t))||""),a(n.contents())(t)}))}}}}function Ye(e){return function(t,a,n){function o(e){if("vertical"==n.resizer){var t=e.pageX;n.resizerMax&&t>n.resizerMax&&(t=parseInt(n.resizerMax)),a.css({left:t+"px"}),Ue(n.resizerLeft).css({width:t+"px"}),Ue(n.resizerRight).css({left:t+parseInt(n.resizerWidth)+"px"})}else{var o=window.innerHeight-e.pageY;a.css({bottom:o+"px"}),Ue(n.resizerTop).css({bottom:o+parseInt(n.resizerHeight)+"px"}),Ue(n.resizerBottom).css({height:o+"px"})}}function i(){e.unbind("mousemove",o),e.unbind("mouseup",i)}a.on("mousedown",(function(t){t.preventDefault(),e.on("mousemove",o),e.on("mouseup",i)}))}}function Xe(e){return{restrict:"E",template:"<h1 ng-if='isRouteLoading'>Loading...</h1>",link:function(t,a,n){t.isRouteLoading=!1,e.$on("$routeChangeStart",(function(){t.isRouteLoading=!0})),e.$on("$routeChangeSuccess",(function(){t.isRouteLoading=!1}))}}}Xe.$inject=["$rootScope"],Ye.$inject=["$document"],Je.$inject=["$timeout"],Ve.$inject=["$timeout"],Ge.$inject=["$timeout"],We.$inject=["$timeout"],qe.$inject=["$timeout"],He.$inject=["$timeout"],ze.$inject=["$timeout"],Be.$inject=["$rootScope","$timeout"],Qe.$inject=["$sce","$parse","$compile"];const Ke=s().module("directives",[Fe]).directive("resizableDivider",(function(){return{restrict:"A",scope:{targetPanel:"@",nextPanel:"@"},link:function(e,t){var a=document.querySelector(e.targetPanel),n=document.querySelector(e.nextPanel);Oe()(t[0]).styleCursor(!1),Oe()(t[0]).draggable({startAxis:"x",lockAxis:"x",styleCursor:!1,listeners:{start:function(e){e.stopPropagation(),document.body.classList.add("resizing-in-progress"),t[0]._initialPanelWidth=a.offsetWidth,t[0]._initialNextPanelWidth=n.offsetWidth},move:function(e){e.stopPropagation(),document.querySelector(".layout-container").clientWidth;var t=a.offsetWidth+e.dx,o=n.offsetWidth-e.dx;t>=100&&o>=100&&(a.style.width="".concat(t,"px"),n.style.width="".concat(o,"px"))},end:function(e){e.stopPropagation(),document.body.classList.remove("resizing-in-progress"),delete t[0]._initialPanelWidth,delete t[0]._initialNextPanelWidth}}}),t[0].addEventListener("mousedown",(function(e){e.stopPropagation()}))}}})).directive("compileHtml",Qe).directive("pageTitle",Be).directive("sideNavigation",ze).directive("iboxTools",He).directive("iboxToolsAI",qe).directive("iboxDetachPanel",["DraggableService",function(e){return{restrict:"A",link:function(t,a){e.initializeDraggable(a)}}}]).directive("minimalizaSidebar",We).directive("vectorMap",(function(){return{restrict:"A",scope:{myMapData:"="},link:function(e,t,a){t.vectorMap({map:"world_mill_en",backgroundColor:"transparent",regionStyle:{initial:{fill:"#e4e4e4","fill-opacity":.9,stroke:"none","stroke-width":0,"stroke-opacity":0}},series:{regions:[{values:e.myMapData,scale:["#1ab394","#22d6b1"],normalizeFunction:"polynomial"}]}}),e.$on("$destroy",(function(){t.remove()}))}}})).directive("sparkline",(function(){return{restrict:"A",scope:{sparkData:"=",sparkOptions:"="},link:function(e,t,a){e.$watch(e.sparkData,(function(){n()})),e.$watch(e.sparkOptions,(function(){n()}));var n=function(){Ue(t).sparkline(e.sparkData,e.sparkOptions)}}}})).directive("ionRangeSlider",(function(){return{restrict:"A",scope:{rangeOptions:"="},link:function(e,t,a){t.ionRangeSlider(e.rangeOptions)}}})).directive("responsiveVideo",(function(){return{restrict:"A",link:function(e,t){var a=t,n=t.children();n.attr("data-aspectRatio",n.height()/n.width()).removeAttr("height").removeAttr("width"),Ue(window).resize((function(){var e=a.width();n.width(e).height(e*n.attr("data-aspectRatio"))})).resize()}}})).directive("chatSlimScroll",Ge).directive("customValid",(function(){return{require:"ngModel",link:function(e,t,a,n){e.$watch(a.ngModel,(function(){"Inspinia"==e.extras?n.$setValidity("cvalid",!0):n.$setValidity("cvalid",!1)}))}}})).directive("closeOffCanvas",(function(){return{restrict:"A",template:'<a class="close-canvas-menu" ng-click="closeOffCanvas()"><i class="fa fa-times"></i></a>',controller:["$scope","$element",function(e,t){e.closeOffCanvas=function(){Ue("body").toggleClass("mini-navbar")}}]}})).directive("clockPicker",(function(){return{restrict:"A",link:function(e,t){t.clockpicker()}}})).directive("landingScrollspy",(function(){return{restrict:"A",link:function(e,t,a){t.scrollspy({target:".navbar-fixed-top",offset:80})}}})).directive("fitHeight",(function(){return{restrict:"A",link:function(e,t){t.css("height",Ue(window).height()+"px"),t.css("min-height",Ue(window).height()+"px")}}})).directive("iboxToolsFullScreen",Ve).directive("truncate",Je).directive("touchSpin",(function(){return{restrict:"A",scope:{spinOptions:"="},link:function(e,t,a){e.$watch(e.spinOptions,(function(){n()}));var n=function(){Ue(t).TouchSpin(e.spinOptions)}}}})).directive("markdownEditor",(function(){return{restrict:"A",require:"ngModel",link:function(e,t,a,n){Ue(t).markdown({savable:!1,onChange:function(e){n.$setViewValue(e.getContent())}})}}})).directive("stringToNumber",(function(){return{require:"ngModel",link:function(e,t,a,n){n.$parsers.push((function(e){return""+e})),n.$formatters.push((function(e){return parseFloat(e)}))}}})).directive("emHeightTarget",(function(){return{link:function(e,t,a){e.$watch("__height",(function(e,a){t.attr("style","height: "+(e-100)+"px")}))}}})).directive("emHeightSource",(function(){return{link:function(e,t,a){e.$watch((function(){e.__height=t.height()}))}}})).directive("emHeightTargetB",(function(){return{link:function(e,t,a){e.$watch("__height",(function(e,a){t.attr("style","height: "+(e-75)+"px")}))}}})).directive("emHeightSourceB",(function(){return{link:function(e,t,a){e.$watch((function(){e.__height=t.height()}))}}})).directive("resizer",Ye).directive("routeLoadingIndicator",Xe).directive("dynamicElement",["$compile",function(e){return{restrict:"E",scope:{message:"="},replace:!0,template:'<input class="form-control m-0 input-xs">',link:function(t,a,n){var o=Ue("input",a);t.message&&t.message.type&&a.attr("type",t.message.type),t.message&&t.message.step&&a.attr("step",t.message.step),e(o)(t)}}}]).directive("draw2dCanvas",["$timeout","$http","$rootScope","$interval","$compile","$sanitize","$uibModal",function(e,t,n,o,r,l,d){return{restrict:"E,A",link:function(h,f,m){var g,y=6e3,_=0,b=0,v=JSON.parse(m.canvas);_=v.width?v.width:!h.editor.editorMode&&h.report.has_html?0:y,b=v.height?v.height:y,h.editor=xe.extend(!0,{canvas:{width:_,height:b},palette:{figures:[]},pivot:{showUI:!1},state:{dirty:!1,canUndo:!1,canRedo:!1},snap:{grid:!1,geometry:!1,centers:!1,between:!1},selection:{className:null,figure:null,attr:null}},h.editor),f.on("$destroy",(function(){o.cancel(g)})),e((function(){var f=xe("#main-container-viewer").width(),w=(xe("#"+m.id).height(),1);h.editor.editorMode||v.auto_width&&(w=f/_);var x=new(c().Canvas)(m.id,h.editor.editorMode?y:_,h.editor.editorMode?y:b);x.setScrollArea("#"+m.id),h.editor.editorMode&&!x.viewBorders&&(x.viewBorders=x.paper.path(["M",0,0,"h",_,"v",b,"h",-_,"v",-b].join(",")));var k="";h.slide&&(k="-"+h.slide.id),xe("#canvas_zoom_out"+k).on("click",(function(){x.setZoom(.9*x.getZoom())})),xe("#canvas_zoom_normal"+k).on("click",(function(){x.setZoom(1/w)})),xe("#canvas_zoom_in"+k).on("click",(function(){x.setZoom(1.1*x.getZoom())})),x.startTimer=function(e,t){s().isDefined(g)||(g=o((function(){e()}),t||1e3))},x.stopTimer=function(){s().isDefined(g)&&(o.cancel(g),g=void 0)},x.isTimerOn=function(){return g},x.installEditPolicy(new(c().policy.canvas.BoundingboxSelectionPolicy));var D=new Function("draw2d","return new "+h.editor.default_router+"();")(c());x.installEditPolicy(new(c().policy.connection.DragConnectionCreatePolicy)({createConnection:function(){return new(c().Connection)({stroke:2,color:"a3a3a3",router:D})}})),x.onDrop=xe.proxy((function(e,t,a,o,i){var r,s=xe(e).data("shape"),l=xe(e).data("apiid");if("draw2d.shape.basic.Line"===s)r=new(c().shape.basic.Line)({startX:t,startY:a,endX:t+100,endY:a}),this.add(r);else{var u=performance.now();r=new Function("draw2d","scope","api_id","return new "+s+"(undefined, undefined, undefined, scope, api_id);")(c(),h,l);var d=new(c().command.CommandAdd)(this,r,t,a);this.getCommandStack().execute(d);var p=performance.now();console.log("Call to create took "+(p-u)+" milliseconds."),h.username=n.username,h.proj_detect=n.project_id}}),x);var S=x.getCommandStack();S.addEventListener((function(t){e((function(){h.editor.state.canUndo=S.canUndo(),h.editor.state.canRedo=S.canRedo()}),0)}));var C,T,A=function(t,a){e((function(){null!==h.editor.selection.attr&&(h.editor.selection.attr[a]=t.attr(a))}),0)};(C=xe("#group_btn")).on("click",xe.proxy((function(){x.getCommandStack().execute(new(c().command.CommandGroup)(x,x.getSelection()))}),this)).prop("disabled",!0),(T=xe("#ungroup_btn")).on("click",xe.proxy((function(){x.getCommandStack().execute(new(c().command.CommandUngroup)(x,x.getSelection())),x.getCommandStack().execute(new(c().command.CommandUngroup)(x,x.getSelection()))}),this)).prop("disabled",!0),x.on("unselect",(function(e,t){if(DEBUG&&console.log("canvas.on Unselect"),h.editor.selection.figure){if(t.figure.userData&&t.figure.userData.cont_id){var a=document.getElementById(t.figure.userData.cont_id);if(a){var n=a.closest(".col-cont");n&&(n.classList.remove("border"),n.classList.remove("border-2"),n.classList.remove("border-primary"))}}h.editor.selection.figure.off("change",A);var o=document.getElementById("treema_container");if(o)for(;o.firstChild;)o.removeChild(o.firstChild);t.figure.chat&&t.figure.cleanupChat();var i=document.getElementById("iboxes");i&&function(e){for(var t=e.children,a=0;a<t.length;a++)t[a].style.display=""}(i)}var r,s;h.$$phase?(null===(r=h.editor.selection)||void 0===r||delete r.className,null===(s=h.editor.selection)||void 0===s||delete s.figure):h.$apply((function(){var e,t;null===(e=h.editor.selection)||void 0===e||delete e.className,null===(t=h.editor.selection)||void 0===t||delete t.figure}))})),x.on("select",(function(t,a){if(DEBUG&&console.log("canvas.on select start"),e((function(){T.prop("disabled",!(a.figure instanceof c().shape.composite.Group)),C.prop("disabled",!(t.getSelection().getSize()>=2))}),100),null!==a.figure&&void 0!==a.figure){if(a.figure.userData&&a.figure.userData.cont_id){var n=document.getElementById(a.figure.userData.cont_id);if(n){var o=n.closest(".col-cont");o&&((0,u.A)(o,{behavior:"smooth",block:"center",inline:"center"}),o.classList.add("border"),o.classList.add("border-2"),o.classList.add("border-primary"))}}if(h.editor.selection.className=a.figure.NAME,delete h.editor.selection.attr,h.editor.selection.attr=a.figure.attr(),["draw2d.shape.fishbone.basic.Rect","draw2d.shape.fishbone.basic.Oval","draw2d.shape.basic.Line","draw2d.shape.fishbone.label.Header1"].indexOf(h.editor.selection.className)>-1){h.editor.selection.keys=Object.getOwnPropertyNames(h.editor.selection.attr),h.editor.selection.elements=[],e((function(){for(var e=document.querySelectorAll(".ibox"),t=0;t<e.length;t++)if(e[t].querySelector("i.bi-building")&&e[t].classList.contains("collapsed")){e[t].classList.remove("collapsed");break}}),50);for(var i=["text","angle","x","y","width","height","opacity","dasharray","radius","bgColor","color","stroke","fill_opacity"],r=0;r<h.editor.selection.keys.length;r++)if(i.indexOf(h.editor.selection.keys[r])>-1){var s={};s.key=h.editor.selection.keys[r],"boolean"==typeof h.editor.selection.attr[h.editor.selection.keys[r]]?(s.type="checkbox",s.value=h.editor.selection.attr[h.editor.selection.keys[r]]):"number"==typeof h.editor.selection.attr[h.editor.selection.keys[r]]?(s.type="number",h.editor.selection.keys[r].indexOf("opacity")>-1||h.editor.selection.keys[r].indexOf("alpha")>-1?s.step="0.1":s.step="1",s.value=h.editor.selection.attr[h.editor.selection.keys[r]]):"object"===Pe(h.editor.selection.attr[h.editor.selection.keys[r]])&&h.editor.selection.attr[h.editor.selection.keys[r]]instanceof c().util.Color?(s.type="color",s.value=h.editor.selection.attr[h.editor.selection.keys[r]].hash()):(s.type="text",s.value=h.editor.selection.attr[h.editor.selection.keys[r]]),h.editor.selection.elements.push(s)}}}else delete h.editor.selection.className,delete h.editor.selection.attr;void 0!==h.editor.selection.figure&&null!==h.editor.selection.figure&&"draw2d.shape.basic.Line"!==h.editor.selection.figure.NAME&&(h.editor.selection.figure.off("change",A),void 0!==h.editor.selection.figure.clearTreema&&h.editor.editorMode&&h.editor.selection.figure.clearTreema()),delete h.editor.selection.figure,h.editor.selection.figure=a.figure,null!==h.editor.selection.figure&&"draw2d.shape.basic.Line"!==h.editor.selection.figure.NAME&&(h.editor.selection.figure.on("change",A),void 0!==h.editor.selection.figure.loadTreema&&h.editor.editorMode&&h.editor.selection.figure.loadTreema())})),h.$watchCollection("editor.selection.attr",(function(e,t){if(!(x.getSelection().getSize()>=2)&&h.editor.selection.figure&&("draw2d.shape.fishbone.basic.Line"===h.editor.selection.figure.NAME||"draw2d.shape.fishbone.basic.Oval"===h.editor.selection.figure.NAME||"draw2d.shape.fishbone.basic.Rect"===h.editor.selection.figure.NAME||"draw2d.shape.fishbone.label.Header1"===h.editor.selection.figure.NAME)&&e&&void 0!==t&&null!==e&&null!==t&&e.id===t.id){var a=c().util.JSON.diff(e,t);Object.keys(a).length>0&&(h.editor.selection.figure.off("change",A),h.editor.selection.figure.attr(a),h.editor.selection.figure.on("change",A),h.editor.selection.figure.repaint())}}));var P=new(c().policy.canvas.SnapToGridEditPolicy),E=new(c().policy.canvas.SnapToGeometryEditPolicy),I=new(c().policy.canvas.SnapToCenterEditPolicy),N=new(c().policy.canvas.SnapToInBetweenEditPolicy);h.editor.updateRouterPilicy=xe.proxy((function(e){var t=e,a=new Function("draw2d","return new "+t+"();")(c());x.getLines().each((function(e,t){t.setRouter(a)})),h.editor.default_router=t,x.installEditPolicy(new(c().policy.connection.DragConnectionCreatePolicy)({createConnection:function(){return new(c().Connection)({stroke:2,color:"a3a3a3",router:a})}}))}),x),h.editor.updateGridSnapPilicy=xe.proxy((function(){h.editor.snap.grid?x.installEditPolicy(P):x.uninstallEditPolicy(P)}),x),h.editor.updateGeometrySnapPilicy=xe.proxy((function(){h.editor.snap.geometry?x.installEditPolicy(E):x.uninstallEditPolicy(E)}),x),h.editor.updateCentersSnapPilicy=xe.proxy((function(){h.editor.snap.centers?x.installEditPolicy(I):x.uninstallEditPolicy(I)}),x),h.editor.updateBetweenSnapPilicy=xe.proxy((function(){h.editor.snap.between?x.installEditPolicy(N):x.uninstallEditPolicy(N)}),x),h.editor.undo=xe.proxy(S.undo,S),h.editor.redo=xe.proxy(S.redo,S),h.editor.delete=xe.proxy((function(){if(x.getSelection().getSize()>=2){for(var e=new(c().command.CommandCollection),t=x.getSelection().getAll(!0),a=0;a<t.getSize();a++){var n=t.get(a);"draw2d.shape.fishbone.ra.RaphaelChart"!==n.NAME&&"draw2d.shape.fishbone.ra.RaPivotnode_new"!==n.NAME&&"draw2d.shape.fishbone.ra.RaPivotnode"!==n.NAME||(n.blockUpdate=!0);var o=n.createCommand(new(c().command.CommandType)(c().command.CommandType.DELETE));e.add(o)}e.execute()}else{var i=this.getPrimarySelection();"draw2d.shape.fishbone.ra.RaphaelChart"!==i.NAME&&"draw2d.shape.fishbone.ra.RaPivotnode_new"!==i.NAME&&"draw2d.shape.fishbone.ra.RaPivotnode"!==i.NAME||(i.blockUpdate=!0);var r=new(c().command.CommandDelete)(i);this.getCommandStack().execute(r)}}),x),m.content&&""!==m.content&&(h.slide.progress=10,h.slide.status="loading report...",t.get(i().context+"/mongo/getData?file_name="+m.content).then((function(e){h.slide.progress=100,h.slide.status="updating data...",h.username=n.username,h.proj_detect=n.project_id,x.clear(),(new(c().io.json.LReader)).unmarshal(x,e.data.jsonText,ke.mobilecheck(),x.getWidth(),h.editor.editorMode,h,r,l),h.editor.editorMode||(x.installEditPolicy(new(c().policy.canvas.ReadOnlySelectionPolicy)),h.editor.updateProjects())}),(function(e){}))),x.onFinishUpdate=function(){h.slide&&(h.slide.status="Done.",h.slide.progress=100)},h.editor.new=xe.proxy((function(){x.clear()}),x),h.editor.findFigByID=xe.proxy((function(){var e=prompt("Please enter figure id",""),t=x.getFigure(e);x.scrollTo(t.getAbsoluteY(),t.getAbsoluteX())}),x),h.editor.findDuplConn=xe.proxy((function(){var e=x.getLines();if(e&&e.data.length){var t=[],a=[],n=[];e.data.forEach((function(e){var o=[e.sourcePort.id,e.targetPort.id].join(",");t.indexOf(o)>-1&&-1===a.indexOf(e.id)?(e.setColor("#ed070f"),e.toFront(),n.push(e.id),a.push(e.id),t.push(o)):(a.push(e.id),t.push(o))}))}}),x),h.editor.load=xe.proxy((function(){var t=document.getElementById("fileElem");t&&t.click(),t.addEventListener("change",(function(t){var a=t.target.files[0],o=new FileReader;o.onload=function(){h.username=n.username,h.proj_detect=n.project_id;var e=JSON.parse(this.result);x.clear();var t=new(c().io.json.LReader);e.canvas?t.unmarshal(x,e.canvas,ke.mobilecheck(),x.getWidth(),h.editor.editorMode,h,r,l):t.unmarshal(x,e,ke.mobilecheck(),x.getWidth(),h.editor.editorMode,h,r,l),e.editor&&h.loadEditorFromFile(e.editor),h.editor.setRouterFromJson()},e((function(){o.readAsText(a)}),500)}),!1)}),x),h.editor.setRouterFromJson=xe.proxy((function(){var e=x.getLines().data;if(e.length>0)if(void 0!==e[0].getRouter().spline){h.editor.default_router="draw2d.layout.connection.SplineConnectionRouter";var t=new(c().layout.connection.SplineConnectionRouter);x.installEditPolicy(new(c().policy.connection.DragConnectionCreatePolicy)({createConnection:function(){return new(c().Connection)({stroke:2,color:"a3a3a3",router:t})}}))}else h.editor.default_router="draw2d.layout.connection.InteractiveManhattanConnectionRouter",t=new(c().layout.connection.InteractiveManhattanConnectionRouter),x.installEditPolicy(new(c().policy.connection.DragConnectionCreatePolicy)({createConnection:function(){return new(c().Connection)({stroke:2,color:"a3a3a3",router:t})}}))}),x),h.editor.loadFromFile=xe.proxy((function(e){h.editor.editorMode&&x.installEditPolicy(new(c().policy.canvas.CoronaDecorationPolicy)),h.username=n.username,h.proj_detect=n.project_id,x.clear(),(new(c().io.json.LReader)).unmarshal(x,e,ke.mobilecheck(),_,h.editor.editorMode,h,r,l),h.isLoading=!1,h.$apply(),h.editor.setRouterFromJson(),h.editor.editorMode||x.installEditPolicy(new(c().policy.canvas.ReadOnlySelectionPolicy))}),x),h.editor.renderFromJson=xe.proxy((function(e,t){x.clear(),t&&(h.message=t),h.username=n.username,h.proj_detect=n.project_id,(new(c().io.json.LReader)).unmarshal(x,e,ke.mobilecheck(),x.getWidth(),h.editor.editorMode,h,r,l),h.editor.setRouterFromJson(),h.editor.editorMode||x.installEditPolicy(new(c().policy.canvas.ReadOnlySelectionPolicy))}),x),h.editor.getMyReportsOnServer=xe.proxy((function(e){h.editor.getMyReports((function(e){h.editor.loadFromFile(e)}))}),x),h.editor.save=xe.proxy((function(){(new(c().io.json.LWriter)).marshal(x,(function(e){ke.removeData(e),h.report.editorJS?h.report.viewer?h.editor.fileSave(JSON.stringify({canvas:e,editor:h.report.editorJS})):h.report.editorJS.save().then((function(t){h.editor.fileSave(JSON.stringify({canvas:e,editor:t}))})).catch((function(e){console.log("Saving failed: ",e)})):h.editor.fileSave(JSON.stringify(e))}))}),x),h.editor.publish=xe.proxy((function(e,t){(new(c().io.json.LWriter)).marshal(x,(function(a){ke.removeData(a);var n=JSON.stringify(a,null,2);h.report.editorJS?h.report.viewer?h.editor.requestPublish(n,h.report.editorJS,e,t):h.report.editorJS.save().then((function(a){h.editor.requestPublish(n,a,e,t)})).catch((function(e){console.log("Saving failed: ",e)})):h.editor.requestPublish(n,null,e,t)}))}),x),h.editor.saveUpdate=xe.proxy((function(e,t){(new(c().io.json.LWriter)).marshal(x,(function(a){var n,o=(n=[],a.forEach((function(e){n.push(Object.assign({},e))})),n);ke.removeData(o);var i=JSON.stringify(o,null,2);h.report.editorJS?h.report.viewer?(h.report.editorJS.bsTheme=e,h.report.editorJS.echartsTheme=t,h.editor.requestSaveUpdate(i,h.report.editorJS)):h.report.editorJS.save().then((function(a){a.bsTheme=e,a.echartsTheme=t,h.editor.requestSaveUpdate(i,a)})).catch((function(e){console.log("Saving failed: ",e)})):h.editor.requestSaveUpdate(i)}))}),x),h.editor.getPivotDAttr=xe.proxy((function(e,t){h.editor.getPivotDAttrModal(e,t)}),x),h.editor.updateProjects=xe.proxy((function(){var e=x.getFigures();e.each((function(e,t){"draw2d.shape.fishbone.ra.RaphaelChart"!==t.NAME&&"draw2d.shape.fishbone.ra.RaphaelPieChart"!==t.NAME&&"draw2d.shape.fishbone.ra.RaPivotnode"!==t.NAME&&"draw2d.shape.fishbone.ra.RaDataNode"!==t.NAME&&"draw2d.shape.fishbone.ra.Progress"!==t.NAME||(t.updateTickets=0)})),e.each((function(e,t){"draw2d.shape.fishbone.cell.Projectnode"!==t.NAME&&"draw2d.shape.fishbone.cell.Projectnode_api"!==t.NAME||t.initDownUpdate()}))}),x),h.editor.findDuplicateConn=xe.proxy((function(){var e=x.getFigures(),t=[];return e.each((function(e,a){"draw2d.shape.fishbone.cell.Scopenode"===a.NAME&&t.push(a)})),t}),x),h.editor.loadJsonConf=xe.proxy((function(){var e=xe('<input type="file" accept=".json" style="display: none;">');e.on("change",(function(e){var t=e.target.files[0];if(t){t.type&&"application/json"!==t.type&&console.warn("Warning: Selected file might not be JSON based on MIME type:",t.type);var a=new FileReader;a.onload=function(e){var t=e.target.result;try{var a=JSON.parse(t);console.log("JSON file loaded successfully:"),console.log(a),generateNodesFromConfig(a.report_config,x).then((function(e){console.log("Async operation completed successfully. Result:",e)})).catch((function(e){console.error("Async operation failed:",e)}))}catch(e){console.error("Error parsing JSON file:",e),alert("Failed to parse JSON file. Please ensure it's valid JSON.\nError: "+e.message)}},a.onerror=function(e){console.error("Error reading file:",a.error),alert("Error reading file: "+a.error)},a.readAsText(t)}else console.log("No file selected.")})),xe("body").append(e),e.trigger("click")}),x);var M=new fe(x,h,i(),r,l,t,n,e,d),O=new we.default(null),j=new ve.default(x,h,r,l,i(),O,null);h.editor.generateAIReport=function(){return M.generateAIReport()},function(e,t,n,o,i,r,s,l,c,u){Promise.all([a.e(207),a.e(534)]).then(a.bind(a,"65aa867a37ce9a4f6d4d")).then((function(a){var d=a.default;e.editor.fishboneAIAssistant=new d({canvas:t,scope:e,settings:n,$compile:o,$sanitize:i,$http:r,$rootScope:s,$timeout:l,$uibModal:c,$interval:u}),e.editor.showAIAssistant=!1,e.editor.showAIConfig=!1,e.editor.aiAssistant={currentMessage:"",unreadCount:0,isTyping:!1,config:{}},e.editor.aiAssistantCollapsed=!1,e.editor.aiAssistantDetached=!1,e.editor.toggleAIAssistant=function(){e.editor.showAIAssistant=!e.editor.showAIAssistant,e.editor.showAIAssistant&&l((function(){e.editor.fishboneAIAssistant.initialize(),e.editor.fishboneAIAssistant.resetUnreadCount()}),100)},e.editor.sendAIMessage=be(ge().m((function t(){var a,n,o;return ge().w((function(t){for(;;)switch(t.p=t.n){case 0:if(console.log("🚀 sendAIMessage called from AngularJS"),null===(a=e.editor.fishboneAIAssistant)||void 0===a||null===(a=a.chatInterface)||void 0===a||!a.sendMessage){t.n=1;break}console.log("📤 Delegating to Enhanced Chat Interface..."),e.editor.fishboneAIAssistant.chatInterface.sendMessage(),console.log("✅ sendMessage delegation completed"),t.n=6;break;case 1:if(n=e.editor.aiAssistant.currentMessage.trim()){t.n=2;break}return t.a(2);case 2:return console.log("🎯 Fallback: Processing message directly:",n),e.editor.aiAssistant.currentMessage="",l((function(){var e=document.getElementById("ai-message-input");e&&(e.style.height="auto",e.style.height="36px")}),0),t.p=3,t.n=4,e.editor.fishboneAIAssistant.processUserMessage(n);case 4:console.log("✅ Fallback processUserMessage completed"),t.n=6;break;case 5:t.p=5,o=t.v,console.error("❌ AI Assistant fallback error:",o);case 6:return t.a(2)}}),t,null,[[3,5]])}))),e.editor.handleAIKeyPress=function(t){"Enter"!==t.key||t.shiftKey||(t.preventDefault(),e.editor.sendAIMessage())},e.editor.toggleAIAssistantCollapse=function(){e.editor.aiAssistantCollapsed=!e.editor.aiAssistantCollapsed;var t=document.getElementById("ai-assistant-panel"),a=null==t?void 0:t.querySelector(".ai-chat-container");a&&(e.editor.aiAssistantCollapsed?(a.style.display="none",t.style.height="auto"):(a.style.display="flex",t.style.height=""))},e.editor.clearAIChatHistory=function(){e.editor.fishboneAIAssistant&&e.editor.fishboneAIAssistant.chatInterface&&e.editor.fishboneAIAssistant.chatInterface.clearHistory()},e.editor.clearAIHistory=function(){e.editor.clearAIChatHistory()},e.editor.exportAIChatHistory=function(){try{if(e.editor.fishboneAIAssistant&&e.editor.fishboneAIAssistant.conversationManager){var t=e.editor.fishboneAIAssistant.conversationManager.exportHistory(),a=JSON.stringify(t,null,2),n=new Blob([a],{type:"application/json"}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download="ai-chat-history-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o),l((function(){alert("Chat history exported successfully!")}),100)}else alert("No chat history available to export.")}catch(e){console.error("Error exporting chat history:",e),alert("Failed to export chat history. Please try again.")}},e.editor.dockAIAssistant=function(){var t=document.getElementById("ai-assistant-panel");t&&(t.classList.remove("ibox-detached"),t.style.cssText="",t.removeAttribute("data-x"),t.removeAttribute("data-y"),e.editor.aiAssistantDetached=!1)},e.editor.restoreAIAssistantPosition=function(){var t=document.getElementById("ai-assistant-panel");t&&(t.classList.remove("ibox-detached"),t.style.cssText="",t.removeAttribute("data-x"),t.removeAttribute("data-y"),e.editor.aiAssistantDetached=!1)},e.editor.showAIConfigModal=function(){var t=e.editor.fishboneAIAssistant?e.editor.fishboneAIAssistant.config.getPublicConfig():e.editor.aiAssistant.config||{};c.open({animation:!0,templateUrl:"views/common/aiConfigModalTemplate.html",controller:"AIConfigModalCtrl",size:"lg",backdrop:"static",resolve:{currentConfig:function(){return t}}}).result.then((function(t){try{e.editor.fishboneAIAssistant&&e.editor.fishboneAIAssistant.config.update(t),e.editor.aiAssistant.config=t,console.log("AI Assistant configuration updated:",{generalProvider:t.provider,generalModel:t.model,stage0:"".concat(t.stage0Provider,"/").concat(t.stage0Model),stage1:"".concat(t.stage1Provider,"/").concat(t.stage1Model),stage2:"".concat(t.stage2Provider,"/").concat(t.stage2Model),classification:"".concat(t.classificationProvider,"/").concat(t.classificationModel),explanatoryAnalysis:t.enableExplanatoryAnalysis,ragEnabled:t.enableRAG}),l((function(){s.showNotification?s.showNotification({type:"success",message:"AI Assistant configuration updated successfully",timeout:3e3}):console.log("Configuration updated successfully")}),100)}catch(e){console.error("Error updating AI Assistant configuration:",e),alert("Failed to update configuration. Please try again.")}})).catch((function(e){"cancel"!==e&&"backdrop click"!==e&&"escape key press"!==e&&console.error("Configuration modal error:",e)}))},e.editor.validateAIConfiguration=function(){if(!e.editor.fishboneAIAssistant)return{valid:!1,errors:["AI Assistant not initialized"]};var t=e.editor.fishboneAIAssistant.config.getPublicConfig(),a=[];t.provider&&t.model||a.push("General provider and model must be configured"),[{provider:"stage0Provider",model:"stage0Model",name:"Stage 0 (Request Enhancement)"},{provider:"stage1Provider",model:"stage1Model",name:"Stage 1 (Requirements Analysis)"},{provider:"stage2Provider",model:"stage2Model",name:"Stage 2 (Planning)"}].forEach((function(e){t[e.provider]&&t[e.model]||a.push("".concat(e.name," provider and model must be configured"))})),t.classificationProvider&&t.classificationModel||a.push("Classification provider and model must be configured");var n,o=["openai"],i=[t.provider,t.stage0Provider,t.stage1Provider,t.stage2Provider,t.classificationProvider],r=function(e){if(Array.isArray(e))return me(e)}(n=new Set(i.filter((function(e){return o.includes(e)}))))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return me(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?me(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();if(r.length>0&&!r.some((function(e){return localStorage.getItem("ai_"+e+"_key")||t.apiKey}))){var s=r.join(", ");a.push("🔑 API Key Required: Missing API keys for providers: ".concat(s,". Please click the ⚙️ AI Settings button to configure your API keys."))}return{valid:0===a.length,errors:a,config:t}},e.editor.getAIConfigurationSummary=function(){if(!e.editor.fishboneAIAssistant)return"AI Assistant not initialized";var t=e.editor.fishboneAIAssistant.config.getPublicConfig();return{general:"".concat(t.provider,"/").concat(t.model),stage0:"".concat(t.stage0Provider,"/").concat(t.stage0Model),stage1:"".concat(t.stage1Provider,"/").concat(t.stage1Model),stage2:"".concat(t.stage2Provider,"/").concat(t.stage2Model),classification:"".concat(t.classificationProvider,"/").concat(t.classificationModel),features:{explanatoryAnalysis:t.enableExplanatoryAnalysis,rag:t.enableRAG,streaming:t.enableStreaming,debug:t.enableDebug}}},e.editor.toggleAIConfig=function(){e.editor.showAIConfig=!e.editor.showAIConfig},e.$watch("editor.selection.figure",(function(t,a){t&&e.editor.showAIAssistant&&e.editor.fishboneAIAssistant&&e.editor.fishboneAIAssistant.onNodeSelected(t)})),e.editor.generateAIReport,e.editor.generateAIReport=function(){e.editor.showAIAssistant=!0,l((function(){e.editor.fishboneAIAssistant.sendSystemMessage("Ready to generate a new report! Please describe what you'd like to create.")}),200)},e.editor.retryAIRequest,e.editor.retryAIRequest=function(){e.editor.showAIAssistant=!0,l((function(){e.editor.fishboneAIAssistant.sendSystemMessage("I'll help you retry the last request. What would you like to adjust?")}),200)},e.editor.replyToAIRequest,e.editor.replyToAIRequest=function(){e.editor.showAIAssistant=!0,l((function(){e.editor.fishboneAIAssistant.sendSystemMessage("Please continue with your request or provide additional details.")}),200)},e.editor.executeIncrementalUpdate,e.editor.executeIncrementalUpdate=function(){e.editor.showAIAssistant=!0,l((function(){e.editor.fishboneAIAssistant.sendSystemMessage("I can help you update your report. What changes would you like to make?")}),200)},e.editor.startNewAIChat=function(){e.editor.clearAIChatHistory()},e.$on("$destroy",(function(){e.editor.fishboneAIAssistant&&e.editor.fishboneAIAssistant.destroy()})),l((function(){var t=e.editor.validateAIConfiguration();t.valid||console.warn("AI Assistant configuration issues:",t.errors)}),1e3),console.log("Enhanced AI Assistant integrated with canvas:",{configurationSupport:"Full stage-specific and classification support",features:["Stage 0: Request Enhancement","Stage 1: Requirements Analysis","Stage 2: Planning","Classification Configuration","Explanatory Analysis","Enhanced RAG Settings","Multiple Provider Support"]})})).catch((function(e){console.error("Failed to load AI Assistant:",e),alert("Failed to initialize AI Assistant. Please check the console for details.")}))}(h,x,i(),r,l,t,n,e,d,o),h.editor.retryAIRequest=function(){return M.retryAIRequest()},h.editor.replyToAIRequest=function(){return M.replyToAIRequest()},h.editor.executeIncrementalUpdate=function(){return M.executeIncrementalUpdate()},h.editor.editAIPrompt=function(){return M.editAIPrompt()},h.editor.startNewAIChat=function(){return M.startNewAIChat()},h.editor.exportReportConfigToFile=function(e){console.log("Exporting report configuration to file using AINodeManager...");try{var t=j.generateConfigFromNodes(x);if(!t||!t.report_config||0===t.report_config.nodes.length)return console.warn("No nodes found on canvas or configuration is empty. Cannot export."),void W.A.showWarningToast("Export Failed","No report configuration found on the canvas to export.");var a=JSON.stringify(t,null,2),n=new Blob([a],{type:"application/json;charset=utf-8;"}),o=document.createElement("a");if(void 0!==o.download){var i=URL.createObjectURL(n);o.setAttribute("href",i),o.setAttribute("download","report-config("+e+").json"),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),console.log("Report configuration export initiated.")}else console.error("Browser does not support the download attribute."),W.A.showErrorToast("Export Failed","Your browser does not support direct file downloads.")}catch(e){console.error("Error exporting report configuration:",e),W.A.showErrorToast("Export Failed","An error occurred while exporting the configuration: ".concat(e.message))}},h.editor.exportFunctionalBranchesAndComponents=Ae(Se().m((function e(){var t,a,n,o,i,r,s,l,c,u,d,p;return Se().w((function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("Exporting functional branches and components for Qdrant import..."),t=null,e.p=1,t=W.A.createLoadingIndicator("Exporting for Qdrant...","Extracting functional branches and components from current report"),(a=j.generateConfigFromNodes(M.canvas))&&a.report_config&&0!==a.report_config.nodes.length){e.n=2;break}return console.warn("No nodes found on canvas or configuration is empty. Cannot extract data."),W.A.showWarningToast("Export Failed","No report configuration found on the canvas to extract."),t&&t.remove(),e.a(2);case 2:t.find(".loading-main-message").text("Processing nodes and extracting components..."),n=[],o=[],a.report_config.nodes.forEach((function(e,t){if(e.userData&&e.userData.node_params){var a={id:e.userData.id||"node_".concat(t),name:{name:e.userData.node_params.name||e.userData.displayLabel||"Node ".concat(t),context:e.userData.node_params.description||"Extracted from FishBone report"},description:e.userData.node_params.description||"",type:e.userData.type||"unknown",category:e.userData.category||"report_component",source:"fishbone_report",timestamp:(new Date).toISOString(),metadata:{node_type:e.userData.type,position:{x:e.x||0,y:e.y||0},extracted_from:h.report.report_name||"unnamed_report"}};n.push(a),e.userData.node_params.components&&e.userData.node_params.components.forEach((function(n,i){var r={id:"".concat(e.userData.id||"node_".concat(t),"_comp_").concat(i),name:{generic_name:n.name||"Component ".concat(i),context:n.description||"Sub-component from FishBone report"},description:n.description||"",parent_branch_id:a.id,category:n.category||"sub_component",source:"fishbone_report",timestamp:(new Date).toISOString(),metadata:{parent_node:e.userData.id||"node_".concat(t),extracted_from:h.report.report_name||"unnamed_report"}};o.push(r)}))}})),i={metadata:{date:(new Date).toISOString(),version:"1.0",source:window.location.hostname,report_name:h.report.report_name||"unnamed_report",export_type:"functional_branches_and_components",total_branches:n.length,total_components:o.length},branches:n,components:o},t.find(".loading-main-message").text("Generating export file..."),r=JSON.stringify(i,null,2),s=new Blob([r],{type:"application/json;charset=utf-8;"}),l=h.report.report_name||"unnamed_report",c=l.replace(/[^a-zA-Z0-9_-]/g,"_"),u="qdrant-export-".concat(c,"-").concat((new Date).toISOString().slice(0,10),".json"),(d=document.createElement("a")).href=URL.createObjectURL(s),d.download=u,d.style.display="none",document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(d.href),W.A.showSuccessToast("Export Complete","Successfully exported ".concat(n.length," functional branches and ").concat(o.length," granular components to ").concat(u)),console.log("Export completed: ".concat(n.length," branches, ").concat(o.length," components")),e.n=4;break;case 3:e.p=3,p=e.v,console.error("Error exporting functional branches and components:",p),W.A.showErrorToast("Export Failed","Failed to export data: ".concat(p.message));case 4:return e.p=4,t&&t.remove(),e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])}))),h.editor.loadConfigFromFile=function(){var e=xe('<input type="file" accept=".json" style="display: none;">');e.on("change",(function(e){var t=e.target.files[0];if(t){t.type&&"application/json"!==t.type&&console.warn("Warning: Selected file might not be JSON based on MIME type:",t.type);var a=new FileReader;a.onload=function(e){var t=e.target.result;try{var a=JSON.parse(t);console.log("JSON file loaded successfully:",a);var n=W.A.createLoadingIndicator("Loading Configuration...","Generating nodes from configuration file");try{j.generateNodesFromConfig(a.report_config||a,x).then((function(e){if(console.log("Nodes generated successfully from config file"),W.A.showSuccessToast({title:"Success",message:"Configuration loaded successfully"}),a.report_config.html)try{var t=null;if(x.getFigures().each((function(e,a){if("draw2d.shape.fishbone.cell.Projectnode_api"===a.NAME)return t=a,!1})),t){var n=new(c().shape.fishbone.cell.HTMLnode)(void 0,void 0,void 0,h,r,l);n.ai_generated=!0,n.userData||(n.userData={}),n.userData.html=a.report_config.html,n.userData.cont_id="html-container";var o=t.getPosition();x.add(n,o.x+250,o.y);var i=t.getOutputPort(0),s=n.getInputPort(0);if(i&&s){var u=new(c().Connection);u.setSource(i),u.setTarget(s);var d=new(c().layout.connection.SplineConnectionRouter);u.setRouter(d),x.add(u),console.log("Created HTMLnode and connected to project node")}else console.error("Failed to create connection: ports not found");"function"==typeof n.updateUI?n.updateUI():"function"==typeof n.repaint&&n.repaint()}else console.error("No project node found to connect HTMLnode to")}catch(e){console.error("Error creating HTMLnode:",e)}h.editor.updateProjects(),console.log("Called scope.editor.updateProjects() after successful node generation")})).catch((function(e){console.error("Error generating nodes from config:",e),W.A.showErrorToast({title:"Error",message:"Failed to generate nodes from config: "+e.message})})).finally((function(){n&&n.remove()}))}catch(e){console.error("Error processing config file:",e),n&&n.remove(),W.A.showErrorToast({title:"Error",message:"Failed to process config file: "+e.message})}}catch(e){console.error("Error parsing JSON file:",e),alert("Failed to parse JSON file. Please ensure it's valid JSON.\nError: "+e.message)}},a.onerror=function(e){console.error("Error reading file:",a.error),alert("Error reading file: "+a.error)},a.readAsText(t)}else console.log("No file selected.")})),xe("body").append(e),e.trigger("click")},h.editor.triggerBranchExtractionFileSelect=function(){var e=document.getElementById("branchExtractionFileInput");e?e.click():(console.error("Branch extraction file input element not found."),alert("Error: Could not find the file input element. Please check the HTML."))},h.editor.handleExtractionFiles=function(){var e=Ae(Se().m((function e(t){var a,n,o,i;return Se().w((function(e){for(;;)switch(e.p=e.n){case 0:if(t&&0!==t.length){e.n=1;break}return console.log("No files selected for extraction."),e.a(2);case 1:return a=Array.from(t),console.log("Selected ".concat(a.length," files for extraction.")),n=W.A.createLoadingIndicator("Starting extraction process...","Processing 0/".concat(a.length," files.")),e.p=2,e.n=3,h.editor.handleBranchExtractionFiles(a,n);case 3:return e.n=4,h.editor.handleGranularComponentsExtractionFiles(a,n);case 4:W.A.showSuccessToast({title:"Extraction Complete",message:"Successfully processed ".concat(a.length," files.")}),e.n=6;break;case 5:e.p=5,i=e.v,console.error("Error during extraction process:",i),W.A.showErrorToast({title:"Extraction Error",message:"Error during extraction: ".concat(i.message)});case 6:return e.p=6,n.remove(),(o=document.getElementById("branchExtractionFileInput"))&&(o.value=null),e.f(6);case 7:return e.a(2)}}),e,null,[[2,5,6,7]])})));return function(t){return e.apply(this,arguments)}}(),h.editor.handleBranchExtractionFiles=function(){var e=Ae(Se().m((function e(t,a){var n;return Se().w((function(e){for(;;)switch(e.p=e.n){case 0:if(t&&0!==t.length){e.n=1;break}return console.log("No files selected for branch extraction."),e.a(2);case 1:if(console.log("Starting branch extraction for ".concat(t.length," files")),a&&a.find(".loading-main-message").text("Processing branches extraction..."),!M||"function"!=typeof M.extractAndStoreBranchesFromFiles){e.n=6;break}return e.p=2,e.n=3,M.extractAndStoreBranchesFromFiles(t,a);case 3:console.log("Branch extraction and storage process completed successfully."),e.n=5;break;case 4:throw e.p=4,n=e.v,console.error("Error during branch extraction:",n),n;case 5:e.n=7;break;case 6:throw console.error("AIReportGenerator instance or extractAndStoreBranchesFromFiles method not found on editor scope."),new Error("AI Report Generator is not properly initialized for branch extraction.");case 7:return e.a(2)}}),e,null,[[2,4]])})));return function(t,a){return e.apply(this,arguments)}}(),h.editor.extractAndUpdateRAG=Ae(Se().m((function e(){var t,a,n,o,i,r,s;return Se().w((function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("Extracting config and updating RAG in one operation..."),t=null,e.p=1,t=W.A.createLoadingIndicator("Extracting and updating RAG...","Generating configuration from current report"),(a=j.generateConfigFromNodes(M.canvas))&&a.report_config&&0!==a.report_config.nodes.length){e.n=2;break}return console.warn("No nodes found on canvas or configuration is empty. Cannot extract and update."),W.A.showWarningToast("Operation Failed","No report configuration found on the canvas to extract."),t.remove(),e.a(2);case 2:return n=JSON.stringify(a,null,2),o=new Blob([n],{type:"application/json;charset=utf-8;"}),i=new File([o],"current-report-config.json",{type:"application/json"}),t.find(".loading-main-message").text("Updating RAG with extracted configuration..."),r=[i],e.n=3,h.editor.handleBranchExtractionFiles(r,t);case 3:return e.n=4,h.editor.handleGranularComponentsExtractionFiles(r,t);case 4:W.A.showSuccessToast({title:"Operation Complete",message:"Successfully extracted configuration and updated RAG."}),e.n=6;break;case 5:e.p=5,s=e.v,console.error("Error during extraction and update process:",s),W.A.showErrorToast({title:"Operation Error",message:"Error during extraction and update: ".concat(s.message)});case 6:return e.p=6,t&&(console.log("Removing loading indicator after extraction and update process"),t.remove(),xe(".loading-overlay").remove()),e.f(6);case 7:return e.a(2)}}),e,null,[[1,5,6,7]])}))),h.editor.handleGranularComponentsExtractionFiles=function(){var e=Ae(Se().m((function e(t,a){var n;return Se().w((function(e){for(;;)switch(e.p=e.n){case 0:if(t&&0!==t.length){e.n=1;break}return console.log("No files selected for granular components extraction."),e.a(2);case 1:if(console.log("Starting granular components extraction for ".concat(t.length," files")),a&&a.find(".loading-main-message").text("Processing granular components extraction..."),!M||"function"!=typeof M.extractAndStoreGranularComponents){e.n=6;break}return e.p=2,e.n=3,M.extractAndStoreGranularComponents(t,a);case 3:console.log("Granular components extraction and storage process completed successfully."),e.n=5;break;case 4:throw e.p=4,n=e.v,console.error("Error during granular components extraction:",n),n;case 5:e.n=7;break;case 6:throw console.error("AIReportGenerator instance or extractAndStoreGranularComponents method not found on editor scope."),new Error("AI Report Generator is not properly initialized for components extraction.");case 7:return e.a(2)}}),e,null,[[2,4]])})));return function(t,a){return e.apply(this,arguments)}}(),h.editor.setEchartsTheme=xe.proxy((function(e){x.getFigures().each((function(t,a){"draw2d.shape.fishbone.ra.RaEchartAdapter"===a.NAME?(a.userData.theme=e,a.updateTable()):"draw2d.shape.fishbone.cell.HTMLnode"===a.NAME?a.userData.html&&(a.userData.html=function(e,t,a,n){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=(new DOMParser).parseFromString(e,"text/html"),r=i.querySelectorAll(t);return 0===r.length?(console.log("No elements found matching selector: ".concat(t)),e):(console.log("Found ".concat(r.length," element(s) matching selector: ").concat(t)),r.forEach((function(e,t){var i=e.hasAttribute(a),r=i?e.getAttribute(a):null;!i||o?(e.setAttribute(a,n),console.log("Element #".concat(t," - ").concat(i?"Modified":"Added"," attribute: ").concat(a,'="').concat(n,'"'))):console.log("Element #".concat(t," - Skipped (overwrite=false): ").concat(a,'="').concat(r,'"'))})),(new XMLSerializer).serializeToString(i))}(a.userData.html,"rv-echarts","ec-theme","'"+e+"'"),a.updateTable()):"draw2d.shape.fishbone.ra.RaTableAdapter"===a.NAME&&a.userData.theme&&(a.userData.theme=e,a.updateTable())}))}),x),h.editor.getScopeNode=xe.proxy((function(){var e=x.getFigures(),t=[];return e.each((function(e,a){"draw2d.shape.fishbone.cell.Scopenode"===a.NAME&&t.push(a)})),t}),x),h.editor.updateProgress=xe.proxy((function(e){h.load_progress=e,h.$apply()}),x),h.editor.figureToPNG=xe.proxy((function(e){setTimeout((function(){(new(c().io.png.Writer)).marshal(e,(function(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","fish_bone_figure.png"),t.click()}))}),1)}),x),window.exportVisualizationToPNG=function(e){console.log("[PNG Export] Function called with vizId:",e);try{var t=document.getElementById("html-container");if(!t)return void alert("Visualization container not found. Please ensure the chart is loaded.");if(console.log("[PNG Export] Found visualization container, generating PNG..."),console.log("[PNG Export] Capturing visualization without layout changes..."),void 0===p())return void alert("html2canvas library not available. Please refresh the page and try again.");console.log("[PNG Export] Capturing with html2canvas (better for SVG content)...");var a=[],n=t.querySelectorAll('.card, .chart-container, [class*="shadow"]');n.forEach((function(e,t){a[t]={boxShadow:e.style.boxShadow,filter:e.style.filter,borderRadius:e.style.borderRadius},e.style.boxShadow="none",e.style.filter="none",e.style.borderRadius="4px"})),p()(t,{backgroundColor:"#ffffff",useCORS:!0,allowTaint:!1,scale:1,logging:!1,height:t.scrollHeight,scrollX:0,scrollY:0,windowHeight:t.scrollHeight}).then((function(e){var t=e.toDataURL("image/png"),o=document.createElement("a"),i="visualization_export_".concat((new Date).toISOString().slice(0,10),".png");o.download=i,o.href=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),console.log("[PNG Export] PNG saved successfully: ".concat(i)),n.forEach((function(e,t){a[t]&&(e.style.boxShadow=a[t].boxShadow,e.style.filter=a[t].filter,e.style.borderRadius=a[t].borderRadius)}))})).catch((function(e){console.error("[PNG Export] Error:",e),alert("PNG export failed: ".concat(e.message)),n.forEach((function(e,t){a[t]&&(e.style.boxShadow=a[t].boxShadow,e.style.filter=a[t].filter,e.style.borderRadius=a[t].borderRadius)}))}))}catch(e){console.error("[PNG Export] Error:",e),alert("PNG export failed. Error: "+e.message)}},h.editor.saveToPNG=xe.proxy((function(){setTimeout((function(){var e=document.getElementById("html-container");if(e&&e.offsetHeight>0&&""!==e.innerHTML.trim())return console.log("[PNG Export] HTML panel detected, using html2canvas export"),void(window.exportVisualizationToPNG?window.exportVisualizationToPNG("main-report"):alert("HTML export functionality not available. Please refresh the page."));console.log("[PNG Export] Using Draw2D canvas export");var t,a,n=[],o=[];x.getFigures().each((function(e,t){var a=t.getBoundingBox();n.push(a.x,a.x+a.w),o.push(a.y,a.y+a.h)})),v.width!==y?(t=_,a=w*(Math.max.apply(Math,o)+50)):(t=Math.max.apply(Math,n)+50,a=Math.max.apply(Math,o)+50),(new(c().io.png.Writer)).marshal(x,(function(e){var t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","fish_bone.png"),t.click()}),new(c().geo.Rectangle)(0,0,t,a))}),1)}),x),h.editor.like=xe.proxy((function(e){e?t.post(i().context+"/mongo/unlike?file_name="+n.filename+"&username="+n.username+"&proj_id="+n.project_id,null).then((function(e){DEBUG&&console.log("UnLine was successfully updated!"),h.likedCount--,h.isLiked=!h.isLiked})).catch((function(e){console.log(e.data)})):t.post(i().context+"/mongo/like?file_name="+n.filename+"&username="+n.username+"&proj_id="+n.project_id,null).then((function(e){DEBUG&&console.log("Like was successfully updated!"),h.likedCount++,h.isLiked=!h.isLiked})).catch((function(e){console.log(e.data)}))}),x),h.editor.comment=xe.proxy((function(){var e=h.report.newComment;e&&t.post(i().context+"/mongo/addComment?file_name="+n.filename+"&username="+n.username+"&proj_id="+n.project_id,{comment:e}).then((function(t){DEBUG&&console.log("Like was successfully updated!"),h.report.newComment="";var a=-1;h.report.comments.forEach((function(e,t){e.username===n.username&&(a=t)})),a>-1&&h.report.comments.splice(a,1),h.report.comments.push({comment:e,username:n.username,updated:new Date})})).catch((function(e){console.log(e.data)}))}),x),h.editor.deleteComment=xe.proxy((function(){var e=h.report.newComment;t.post(i().context+"/mongo/deleteComment?file_name="+n.filename+"&username="+n.username+"&proj_id="+n.project_id,{comment:e}).then((function(e){DEBUG&&console.log("Like was successfully deleted!"),h.report.newComment="";var t=-1;h.report.comments.forEach((function(e,a){e.username===n.username&&(t=a)})),t>-1&&h.report.comments.splice(t,1)})).catch((function(e){console.log(e.data)}))}),x),h.editor.duplicate=xe.proxy((function(e){var t=new Function("draw2d","scope","return new "+e.className+"(undefined, undefined, undefined, scope);")(c(),h),a=t.getId(),n=De.extend(!0,{},e.figure.attr());t.attr(n),t.attr({id:a});var o=De.extend(!0,{},e.figure.getUserData());t.setUserData(o),"draw2d.shape.fishbone.cell.Datanode"===e.figure.NAME?t.userData.label="":"draw2d.shape.fishbone.cell.iffnode"!==e.figure.NAME&&"draw2d.shape.fishbone.cell.Addnode"!==e.figure.NAME&&"draw2d.shape.fishbone.cell.Andnode"!==e.figure.NAME&&"draw2d.shape.fishbone.cell.Mathnode"!==e.figure.NAME&&"draw2d.shape.fishbone.cell.Signnode"!==e.figure.NAME||(t.userData.col&&(t.userData.col=[]),t.userData.row&&(t.userData.row=[])),t.setDimension(e.figure.getWidth(),e.figure.getHeight());var i=new(c().command.CommandAdd)(x,t,e.figure.getX()+20,e.figure.getY()+20);if(x.getCommandStack().execute(i),"draw2d.shape.fishbone.cell.Diffnode"!==e.figure.NAME&&"draw2d.shape.fishbone.cell.Addnode"!==e.figure.NAME&&"draw2d.shape.fishbone.cell.Andnode"!==e.figure.NAME&&"draw2d.shape.fishbone.cell.Mathnode"!==e.figure.NAME&&"draw2d.shape.fishbone.cell.Signnode"!==e.figure.NAME){var r=new(c().Connection),s=e.figure.getInputPort(0).getConnections().data[0].getSource();r.setSource(s),r.setTarget(t.getInputPort(0));var l=new(c().layout.connection.InteractiveManhattanConnectionRouter);r.setRouter(l),(i=new(c().command.CommandConnect)(s,t.getInputPort(0))).setConnection(r),x.getCommandStack().execute(i)}}),x),h.editor.rotateLeft=xe.proxy((function(e){e.rotate("left")}),x),h.editor.rotateRight=xe.proxy((function(e){e.rotate("right")}),x),h.editor.getStatistics=xe.proxy((function(){var e=x.getFigures(),t=x.getLines(),a={"draw2d.shape.fishbone.cell.Projectnode_api":"Project Node","draw2d.shape.fishbone.cell.DUModelnode_api":"DU Model Node","draw2d.shape.fishbone.cell.Datanode":"Task Node","draw2d.shape.fishbone.cell.CustomFieldnode":"Custom Field Node","draw2d.shape.fishbone.cell.Mathnode":"Math Node","draw2d.shape.fishbone.cell.Filternode":"Filter Node","draw2d.shape.fishbone.cell.APInode":"API Node","draw2d.shape.fishbone.ra.RaTablenode":"DataTable Node"},n={"Project Node":"#007bff","DU Model Node":"#28a745","Task Node":"#ffc107","Custom Field Node":"#17a2b8","Math Node":"#dc3545","Filter Node":"#6f42c1","API Node":"#fd7e14","DataTable Node":"#20c997"},o={},i=0;e.each((function(e,t){if(t.NAME){var n=a[t.NAME]||t.NAME;o[n]=(o[n]||0)+1,i++}}));var r=Object.keys(o).map((function(e){return{name:e,count:o[e],percentage:i>0?Math.round(o[e]/i*100):0,color:n[e]||"#6c757d"}}));return r.sort((function(e,t){return t.count-e.count})),{totalNodes:i,totalConnections:t.getSize(),nodeTypes:r}}),x),m.jsonContent?(h.editor.loadFromFile(m.jsonContent),!h.editor.editorMode&&v.auto_width&&x.setZoom(1/w),h.editor.editorMode||h.editor.updateProjects()):h.slide&&(h.slide.progress=10,h.slide.status="loading report...",t.get(i().context+"/mongo/getData?file_name="+h.slide.content).then((function(e){h.slide.progress=100,h.slide.status="loaded...",h.username=n.username,h.proj_detect=n.project_id,x.clear(),(new(c().io.json.LReader)).unmarshal(x,e.data.jsonText,ke.mobilecheck(),_,h.editor.editorMode,h,r,l),h.editor.editorMode||(x.installEditPolicy(new(c().policy.canvas.ReadOnlySelectionPolicy)),h.editor.updateProjects())}),(function(e){})))}),1e3)}}}]).directive("draw2dPalette",Ne).name;var Ze=a("6fe5e339b0f8a936ba8c"),$e=a("a45670b3d8fb79ec0258"),et=a("8deafab7866a125bb9ca"),tt=function(e,t,a,n,o,i){var r=n.getUserData();e.values=[],e.current_condition={},e.gridOptionsConditions={};var s=JSON.stringify(n.sites_list_in);e.gridOptionsFilters={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!0,onRegisterApi:function(t){e.gridApiReportsSel=t,t.selection.on.rowSelectionChanged(e,(function(){var t=r.conditions.indexOf(e.current_condition);if(r.conditions[t].values=[],e.gridApiReportsSel.selection.getSelectedRows().length){var a=e.gridApiReportsSel.selection.getSelectedRows(),n="";a.forEach((function(e,a){-1===r.conditions[t].values.indexOf(e.key_value)&&(r.conditions[t].values.push(e.key_value),n=n+" "+e.key_value)})),r.conditions[t].value=n,r.conditions[t].sign="in",e.gridOptionsConditions.columnDefs[4].enableCellEdit=!1}else r.conditions[t].value="empty",r.conditions[t].sign="consist",e.gridOptionsConditions.columnDefs[4].enableCellEdit=!0}))},columnDefs:[{field:"value",displayName:"Filter Value"},{field:"sites",displayName:"Sites count",width:"20%",aggregationType:i.aggregationTypes.sum}]},e.gridOptionsConditions={enableRowSelection:!0,enableRowHeaderSelection:!1,enableFiltering:!0,multiSelect:!0,modifierKeysToMultiSelect:!0,noUnselect:!0,onRegisterApi:function(a){e.gridApiConditions=a,a.selection.on.rowSelectionChanged(e,(function(t){e.current_condition=e.gridApiConditions.selection.getSelectedRows()[0];var a=Ze.context+"/data/getAllBuildingFilterValues?scope_id="+n.userData.scope.scope_id+"&proj_id="+n.project.proj_id+"&filter_name="+e.current_condition.prop;$e.ajax({url:a,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:s,success:function(t){e.gridOptionsFilters.data=t,e.current_condition.values&&e.current_condition.values.length&&e.current_condition.values.forEach((function(a,n){t.forEach((function(t,n){t.key_value===a&&(e.gridApiReportsSel.grid.modifyRows(e.gridOptionsFilters.data),e.gridApiReportsSel.selection.selectRow(e.gridOptionsFilters.data[n]))}))}))}})})),a.edit.on.afterCellEdit(e,(function(a,o){e.current_condition=e.gridApiConditions.selection.getSelectedRows()[0];var i=Ze.context+"/data/getAllBuildingFilterValues?scope_id="+n.userData.scope.scope_id+"&proj_id="+n.project.proj_id+"&filter_name="+e.current_condition.prop;$e.ajax({url:i,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:s,success:function(a){t((function(){e.gridOptionsFilters.data=a,e.current_condition.values&&e.current_condition.values.length&&e.current_condition.values.forEach((function(t,n){a.forEach((function(a,n){a.value===t&&(e.gridApiReportsSel.grid.modifyRows(e.gridOptionsFilters.data),e.gridApiReportsSel.selection.selectRow(e.gridOptionsFilters.data[n]))}))}))}),200)}})}))}},e.gridOptionsConditions.columnDefs=[{field:"logic",displayName:"Logic",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownOptionsArray:[{id:"",value:""},{id:"and",value:"and"},{id:"or",value:"or"}]},{field:"openQu",displayName:"",enableFiltering:!1,enableCellEdit:!1,width:20},{field:"prop",displayName:"Property",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownOptionsArray:[{id:"",value:""},{id:"region_id",value:"region_id"},{id:"building_code",value:"building_code"},{id:"building_name",value:"building_name"},{id:"site_type",value:"site_type"},{id:"site_type1",value:"site_type1"},{id:"site_type2",value:"site_type2"},{id:"site_type3",value:"site_type3"},{id:"site_type4",value:"site_type4"},{id:"site_type5",value:"site_type5"},{id:"site_type6",value:"site_type6"},{id:"site_type7",value:"site_type7"},{id:"site_type8",value:"site_type8"},{id:"site_type9",value:"site_type9"},{id:"site_type10",value:"site_type10"},{id:"schedule_obs",value:"schedule_obs"},{id:"schedule_status",value:"schedule_status"},{id:"phase_id",value:"phase_id"},{id:"cluster_name",value:"cluster_name"}]},{field:"sign",displayName:"Sign",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownOptionsArray:[{id:"equal",value:"equal"},{id:"not equal",value:"not equal"},{id:"consist",value:"consist"},{id:"not consist",value:"not consist"},{id:"in",value:"in"},{id:"more than",value:"more than"},{id:"less than",value:"less than"},{id:"more than or equal",value:"more than or equal"},{id:"less than or equal",value:"less than or equal"}]},{field:"value",displayName:"Value"},{field:"closeQu",displayName:"",enableFiltering:!1,enableCellEdit:!1,width:20}],t((function(){e.gridOptionsConditions.data=r.conditions}),200),e.ok=function(){et.initFallDown(n),n.GetHTTPData(),a.dismiss("ok")},e.cancel=function(){a.dismiss("cancel")},e.new=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);r.conditions.splice(t,0,{logic:"",openQu:"",prop:"",sign:"consist",value:"empty",values:[],closeQu:""})}else alert("Nothing selected...!")},e.delete=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);r.conditions.splice(t,1)}else alert("Nothing selected...!")},e.openQu=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);"("===r.conditions[t].openQu?r.conditions[t].openQu="":r.conditions[t].openQu="("}else alert("Nothing selected...!")},e.closeQu=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);")"===r.conditions[t].closeQu?r.conditions[t].closeQu="":r.conditions[t].closeQu=")"}else alert("Nothing selected...!")},e.moveUp=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);t>0&&et.moveArrayItem(r.conditions,t,t-1)}else alert("Nothing selected...!")},e.moveDown=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);t<r.conditions.length-1&&et.moveArrayItem(r.conditions,t,t+1)}else alert("Nothing selected...!")},e.refresh=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){e.current_condition=e.gridApiConditions.selection.getSelectedRows()[0];var a=Ze.context+"/data/getAllBuildingFilterValues?scope_id="+n.userData.scope.scope_id+"&proj_id="+n.project.proj_id+"&filter_name="+e.current_condition.prop;$e.ajax({url:a,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:s,success:function(a){t((function(){e.gridOptionsFilters.data=a,e.current_condition.values&&e.current_condition.values.length&&e.current_condition.values.forEach((function(t,n){a.forEach((function(a,n){a.value===t&&(e.gridApiReportsSel.grid.modifyRows(e.gridOptionsFilters.data),e.gridApiReportsSel.selection.selectRow(e.gridOptionsFilters.data[n]))}))}))}),200)}})}else alert("Nothing selected...!")}};tt.$inject=["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants"];const at=tt;var nt=a("a45670b3d8fb79ec0258"),ot=a("1bf2fbdb051fe0c57024"),it=a("8deafab7866a125bb9ca"),rt=function(e,t,a,n,o,i,r){var s=n.getUserData();e.values=[],e.gridOptionsConditions={};var l=nt.extend({},n.clean_conditions);nt.extend(l,s.conditions),e.gridOptionsFilters={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!0,onRegisterApi:function(t){e.gridApiReportsSel=t,t.selection.on.rowSelectionChanged(e,(function(t){var a=e.gridApiConditions.selection.getSelectedRows()[0],n=s.conditions_mapping[a.prop],o="";e.gridApiReportsSel.selection.getSelectedRows().length?(e.gridApiReportsSel.selection.getSelectedRows().forEach((function(e,t){o="string"===n.type?o+e.value+",":o+e.value.toString()+","})),o=o.substring(0,o.length-1),l[a.prop]=o,e.gridOptionsConditions.data[e.gridOptionsConditions.data.indexOf(a)].value=o):"string"===n.type?(l[a.prop]="'all'",e.gridOptionsConditions.data[e.gridOptionsConditions.data.indexOf(a)].value="'all'"):(l[a.prop]="-1",e.gridOptionsConditions.data[e.gridOptionsConditions.data.indexOf(a)].value="-1")}))},columnDefs:[{field:"value",displayName:"Filter Value"},{field:"count",displayName:"Count",width:"20%",aggregationType:r.aggregationTypes.sum}]},e.gridOptionsConditions={enableRowSelection:!0,enableRowHeaderSelection:!1,enableFiltering:!0,multiSelect:!0,modifierKeysToMultiSelect:!0,noUnselect:!0,onRegisterApi:function(t){e.gridApiConditions=t,t.selection.on.rowSelectionChanged(e,(function(t){var a=t.entity,n=s.conditions_mapping[a.prop],i=(new ot).from(o.data).groupBy(n.res).count("site_id").orderBy(n.res).select([{text:"value",field:n.res},{text:"count",field:"site_id"}]);e.gridOptionsFilters.data=i,a.value&&a.value.split(",").forEach((function(t,a){i.forEach((function(a,n){a.value===t.replace(/[']+/g,"")&&(e.gridApiReportsSel.grid.modifyRows(e.gridOptionsFilters.data),e.gridApiReportsSel.selection.selectRow(e.gridOptionsFilters.data[n]))}))}))}))}},e.gridOptionsConditions.columnDefs=[{field:"prop",displayName:"Property"},{field:"value",displayName:"Value"}],t((function(){var t=[],a=nt.extend({},n.clean_conditions);nt.extend(a,s.conditions),Object.keys(a).forEach((function(e){s.conditions_mapping[e].show&&t.push({prop:e,value:a[e]})})),e.gridOptionsConditions.data=t}),200),e.ok=function(){JSON.stringify(l)!==JSON.stringify(s.conditions)&&(s.conditions=l,n.userData.updateBlock&&n.sscope.editor.editorMode||(it.initFallDown(n),n.GetHTTPData())),a.dismiss("ok")},e.cancel=function(){a.dismiss("cancel")}};rt.$inject=["$scope","$timeout","$uibModalInstance","figure","filterdata","$interval","uiGridConstants"];const st=rt;var lt=a("8deafab7866a125bb9ca"),ct=function(e,t,a,n,o,i){var r,s,l=n.getUserData();e.values=[],e.gridOptionsConditions={},e.gridOptions={enableFiltering:!0,showGridFooter:!0,fastWatch:!0,showHeader:!0,enableRowSelection:!0,data:structuredClone(l.sites_list_out),onRegisterApi:function(t){e.gridApi=t},columnDefs:(r=l.table_col_spec,s=[],r.forEach((function(e){s.push({field:e.name,displayName:e.name,width:120})})),s)},e.ok=function(){l.sites_list_out=structuredClone(e.gridOptions.data),n.userData.updateBlock||lt.initFallDown(n),n.GetHTTPData(),a.dismiss("ok")},e.cancel=function(){a.dismiss("cancel")},e.add_record=function(){var t={};l.table_col_spec.forEach((function(e){t[e.name]=null})),e.gridOptions.data.unshift(t)},e.delete_record=function(){var t=e.gridApi.selection.getSelectedRows();t.length>0?(t.forEach((function(t,a){var n=e.gridOptions.data.indexOf(t);e.gridOptions.data.splice(n,1)})),e.gridApi.core.refresh()):alert("Nothing selected...!")}};ct.$inject=["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants"];const ut=ct;var dt=a("d1be49724a1f416e7f57"),pt=function(e,t,a,n,o,i){var r;e.values=[],e.gridOptionsConditions={},r=n.shape?n.arraySync():n,dt.options.columnlookup=r.length;var s,l,c=dt("RECORDSET OF SELECT * from ?",[r]).columns;e.gridOptions={enableFiltering:!0,showGridFooter:!0,fastWatch:!0,showHeader:!0,enableRowSelection:!0,columnDefs:(s=c,l=[],s.forEach((function(e){l.push({field:e.columnid,displayName:e.columnid,width:120})})),l),enableGridMenu:!0,exporterCsvFilename:"table_data.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(e,t){return{text:e.toString()+" of "+t.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(e){return e.styles.headerStyle={fontSize:22,bold:!0},e.styles.footerStyle={fontSize:10,bold:!0},e},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),exporterExcelFilename:"table_data.xlsx",exporterExcelSheetName:"Sheet1"},t((function(){e.gridOptions.data=r}),200),e.ok=function(){a.dismiss("ok")},e.cancel=function(){a.dismiss("cancel")}};pt.$inject=["$scope","$timeout","$uibModalInstance","valarr","$interval","uiGridConstants"];const ht=pt;var ft=a("1bf2fbdb051fe0c57024"),mt=function(e,t,a,n,o,i){var r,s=n.getUserData();s=n.userData,r=""!==s.label&&void 0!==s.label?s.label:s.code.code_type_name,e.gridOptions={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!0,onRegisterApi:function(t){e.gridApi=t,o((function(){e.gridApi.core.handleWindowResize()}),500,10)},columnDefs:[{field:"value",displayName:r},{field:"sites",displayName:"Sites count",width:"20%",aggregationType:i.aggregationTypes.sum}]};var l=(new ft).from(s.sites_list_out).groupBy(r).count("site_code").select();t((function(){e.gridOptions.data=[],l.forEach((function(t){e.gridOptions.data.push({value:t[r],sites:t.site_code})}))}),100),e.ok=function(){var t=e.gridApi.selection.getSelectedRows();a.close(t)},e.cancel=function(){a.dismiss("cancel")}};mt.$inject=["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants"];const gt=mt;var yt=a("3f0c1c02d5ee15d6969a"),_t=a("d9ffa02cec6b78d0f4f4"),bt=(a("081e6f7ec5160f909dba"),a("1cc733311f00a24f4ec8")),vt=a("9fc5d822b028d8196303"),wt=a("a388386adb676c29695c");function xt(e){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xt(e)}function kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function Dt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function St(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Dt(Object(a),!0).forEach((function(t){Ct(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ct(e,t,a){return(t=At(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Tt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,At(n.key),n)}}function At(e){var t=function(e){if("object"!=xt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=xt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==xt(t)?t:t+""}var Pt=function(){return e=function e(t){var a=t.data,n=t.block,o=t.config,i=t.api,r=t.readOnly;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=i,this.readOnly=r,this.block=n,this.col_count=a.level,this.icon=o.icon,this.col_class_suff=12/this.col_count,this.blockIndex=this.api.blocks.getCurrentBlockIndex()+1;for(var s,l,c=[],u=0;u<this.col_count;u++)c.push("");this.CSS={baseClass:this.api.styles.block,loading:this.api.styles.loader,input:this.api.styles.input,wrapper:"cdx-simple-image",imageHolder:"cdx-simple-image__picture",caption:"cdx-simple-image__caption",cont_id:"cdx-simple-image__id"},this.nodes={wrapper:[],imageHolder:[],container:[],caption:[],col:[]},s=a&&a.id&&a.id.length?a.id:c,l=a&&a.caption&&a.caption.length?a.caption:c,this.data={id:s,caption:l,withBorder:void 0!==a.withBorder&&a.withBorder,withBackground:void 0!==a.withBackground&&a.withBackground,stretched:void 0!==a.stretched&&a.stretched,nocaption:void 0!==a.nocaption&&a.nocaption,"p-none":void 0!==a["p-none"]&&a["p-none"],"px-1":void 0!==a["px-1"]&&a["px-1"],"px-2":void 0!==a["px-2"]&&a["px-2"],"px-3":void 0!==a["px-3"]&&a["px-3"],"px-4":void 0!==a["px-4"]&&a["px-4"],"px-5":void 0!==a["px-5"]&&a["px-5"]},this.tunes=[{name:"withBorder",label:"Add Border",icon:wt.vN},{name:"stretched",label:"Stretch Image",icon:wt.pK},{name:"withBackground",label:"Add Background",icon:wt.BB},{name:"nocaption",label:"Hide Caption",icon:wt.qA},{name:"p-none",label:"No Padding",icon:wt.vg},{name:"px-1",label:"Padding 1",icon:wt.J1},{name:"px-2",label:"Padding 2",icon:wt.J1},{name:"px-3",label:"Padding 3",icon:wt.J1},{name:"px-4",label:"Padding 4",icon:wt.J1},{name:"px-5",label:"Padding 5",icon:wt.J1}]},t=[{key:"render",value:function(){var e=this,t=this._make("div",["row","p-1",this.CSS.baseClass,this.CSS.wrapper]),a=this._make("div",["col-cont","col-md-"+this.col_class_suff]),n=this.readOnly?"display: none":"",o=this._make("div",[this.CSS.input,this.CSS.cont_id],{contentEditable:!this.readOnly,style:n}),i=this._make("div",[this.CSS.imageHolder,"position-relative"]),r=this._make("div",["cont"],{style:"height: 200px"}),s=this._make("div",[this.CSS.input,this.CSS.caption],{contentEditable:!this.readOnly}),l=this._make("div",["spin","position-absolute","w-100","h-100","d-flex","flex-column","align-items-center","bg-white","justify-content-center"],{style:"height: 200px"}),c=this._make("div",["spinner-border"],{role:"status"}),u=this._make("span",["sr-only"]);s.dataset.placeholder="Enter a caption",o.dataset.placeholder="Paste an Container ID...",c.appendChild(u),l.appendChild(c);for(var d=function(){var n=r.cloneNode(!0),c=i.cloneNode(!0),u=a.cloneNode(!0),d=s.cloneNode(!0),h=o.cloneNode(!0),f=p;h.addEventListener("paste",(function(t){e.data.id[f]=t.clipboardData.getData("text"),n.id=e.data.id[f],e.observers&&e.observers[f]||e._setupContentObserver(n,m)})),u.appendChild(h),u.appendChild(d);var m=l.cloneNode(!0);m.classList.add("container-loader"),c.appendChild(m),""!==e.data.id[p]&&(n.id=e.data.id[p],d.innerHTML=e.data.caption[p],h.innerHTML=e.data.id[p],e._setupContentObserver(n,m)),e.nodes.imageHolder.push(c),e.nodes.container.push(n),e.nodes.loaders||(e.nodes.loaders=[]),e.nodes.loaders.push(m),e.nodes.caption.push(d),e.nodes.col.push(u),c.appendChild(n),u.appendChild(c),t.appendChild(u)},p=0;p<this.col_count;p++)d();return this.nodes.wrapper=t,setTimeout((function(){e._acceptTuneView()}),100),t}},{key:"save",value:function(e){var t=this,a=e.querySelectorAll(".col-cont.col-md-"+this.col_class_suff),n=[],o=[];return a&&a.forEach((function(e){var a=e.querySelector(".cont"),i=e.querySelector("."+t.CSS.caption);n.push(a.id),o.push(i.innerHTML)})),Object.assign(this.data,{id:n,caption:o,level:a.length})}},{key:"onPaste",value:function(e){switch(e.type){case"tag":var t=e.detail.data;this.data={url:t.src};break;case"pattern":var a=e.detail.data;this.data={url:a}}}},{key:"data",get:function(){return this._data},set:function(e){var t=this;this._data=Object.assign({},this.data,e),this.nodes.container&&this.nodes.container.length&&this.nodes.container.forEach((function(e,a){t.nodes.container[a].id=t.data.id[a]})),this.nodes.caption&&this.nodes.caption.length&&this.nodes.caption.forEach((function(e,a){t.nodes.caption[a].innerHTML=t.data.caption[a]}))}},{key:"renderSettings",value:function(){var e=this;return this.tunes.map((function(t){return St(St({},t),{},{label:e.api.i18n.t(t.label),toggle:!0,onActivate:function(){return e._toggleTune(t.name)},isActive:!!e.data[t.name]})}))}},{key:"_make",value:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=document.createElement(e);for(var i in Array.isArray(a)?(t=o.classList).add.apply(t,function(e){return function(e){if(Array.isArray(e))return kt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return kt(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?kt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(a)):a&&o.classList.add(a),n)o[i]=n[i];return o}},{key:"hideLoaders",value:function(){this.nodes.loaders&&this.nodes.loaders.forEach((function(e){e&&(e.classList.add("hide-loader"),e.classList.remove("show-loader"))}))}},{key:"showLoaders",value:function(){this.nodes.loaders&&this.nodes.loaders.forEach((function(e){e&&(e.classList.remove("hide-loader"),e.classList.add("show-loader"))}))}},{key:"destroy",value:function(){this.observers&&(this.observers.forEach((function(e){e&&e.disconnect()})),this.observers=[])}},{key:"_setupContentObserver",value:function(e,t){var a=this,n=!1,o=new MutationObserver((function(i){if(!n){var r=i.some((function(e){return e.addedNodes.length>0&&Array.from(e.addedNodes).some((function(e){var t,a,n,o;return e.nodeType===Node.ELEMENT_NODE&&(null===(t=e.classList)||void 0===t||!t.contains("container-loader"))&&!["tooltip","popover","dropdown","modal","overlay","echarts-tooltip","tooltip-content","chart-tooltip","tabulator-tooltip","hover-info","popup","floating"].some((function(t){var a,n;return(null===(a=e.classList)||void 0===a?void 0:a.contains(t))||(null===(n=e.className)||void 0===n?void 0:n.includes(t))}))&&e.tagName&&("canvas"===e.tagName.toLowerCase()||"table"===e.tagName.toLowerCase()||"svg"===e.tagName.toLowerCase()||(null===(a=e.classList)||void 0===a?void 0:a.contains("tabulator"))||(null===(n=e.classList)||void 0===n?void 0:n.contains("chart"))||(null===(o=e.classList)||void 0===o?void 0:o.contains("visualization"))||e.children&&e.children.length>0)}))})),s=e.querySelector("canvas, table, svg, .tabulator, .chart, .visualization");if((r||s)&&(n=!0,t.classList.add("hide-loader"),t.classList.remove("show-loader"),o.disconnect(),a.observers)){var l=a.observers.indexOf(o);l>-1&&a.observers.splice(l,1)}}}));o.observe(e,{childList:!0,subtree:!1}),this.observers||(this.observers=[]),this.observers.push(o),setTimeout((function(){!n&&e.querySelector("canvas, table, svg, .tabulator, .chart")&&(n=!0,t.classList.add("hide-loader"),t.classList.remove("show-loader"),o.disconnect())}),1e3)}},{key:"_toggleTune",value:function(e){this.data[e]=!this.data[e],this._acceptTuneView()}},{key:"_acceptTuneView",value:function(){var e=this;this.tunes.forEach((function(t){e.nodes.imageHolder.forEach((function(a,n){a.classList.toggle(e.CSS.imageHolder+"--"+t.name.replace(/([A-Z])/g,(function(e){return"-".concat(e[0].toLowerCase())})),!!e.data[t.name]),"stretched"===t.name&&(e.block.stretched=!!e.data.stretched)})),e.nodes.caption.forEach((function(a,n){"nocaption"===t.name&&a.classList.toggle(e.CSS.caption+"--"+t.name.replace(/([A-Z])/g,(function(e){return"-".concat(e[0].toLowerCase())})),!!e.data[t.name])})),e.nodes.col.forEach((function(a,n){["p-none","px-1","px-2","px-3","px-4","px-5"].indexOf(t.name)>-1&&a.classList.toggle(t.name.replace(/([A-Z])/g,(function(e){return"-".concat(e[0].toLowerCase())})),!!e.data[t.name])}))}))}}],a=[{key:"sanitize",get:function(){return{id:{},withBorder:{},withBackground:{},stretched:{},nocaption:{},caption:{br:!0}}}},{key:"toolbox",get:function(){return[{icon:wt.cW,title:"1 DOMContainer",data:{level:1}},{icon:wt.cW,title:"2 DOMContainer",data:{level:2}},{icon:wt.cW,title:"3 DOMContainer",data:{level:3}},{icon:wt.cW,title:"4 DOMContainer",data:{level:4}},{icon:wt.cW,title:"6 DOMContainer",data:{level:6}}]}},{key:"isReadOnlySupported",get:function(){return!0}}],t&&Tt(e.prototype,t),a&&Tt(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a}(),Et=a("d0b16f9cde0a6810e9d5"),It=a("090ad2af62951668df73"),Nt=a("00103368d8c89b0d69d8"),Mt=a("920c96ae59e31beed77f"),Ot=a("b8858e1412474da1b0a6"),jt=a.n(Ot),Rt=a("08d49b9c7ed557cedd8a"),Lt=a.n(Rt),Ft=a("51b72cdca90f115d2152"),Ut=a("d185385445bac96d17cd"),Bt=a("207de54da2b27896bb4a"),zt=a("bfe0c15f6305a0cb0984"),Ht=a("5812134b653fb3353c79"),qt=a("babd4609b2c92f247ac4"),Vt=a("8deafab7866a125bb9ca"),Wt=a("a45670b3d8fb79ec0258"),Gt=function(e,t,a,n,o,r,s,l,c,u,d){var p,h,f=!d.file_name;if(d.has_html&&!d.no_html_ed){var m={readOnly:!1,holder:"editorjs",tools:{header:{class:bt.A,inlineToolbar:!0,config:{placeholder:"Header"},shortcut:"CMD+SHIFT+H",tunes:["anyTuneName"]},image:{class:vt.A},domcontainer1:{class:Pt,inlineToolbar:!0,tunes:["anyTuneName"]},list:{class:Et.A,inlineToolbar:!0,config:{defaultStyle:"unordered"}},quote:{class:It.A,inlineToolbar:!0,config:{quotePlaceholder:"Enter a quote",captionPlaceholder:"Quote's author"},shortcut:"CMD+SHIFT+O"},warning:Nt.A,underline:Mt.A,Marker:{class:jt(),config:{defaultColor:"#FFBF00",type:"marker",icon:'<svg fill="#000000" height="200px" width="200px" version="1.1" id="Icons" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M17.6,6L6.9,16.7c-0.2,0.2-0.3,0.4-0.3,0.6L6,23.9c0,0.3,0.1,0.6,0.3,0.8C6.5,24.9,6.7,25,7,25c0,0,0.1,0,0.1,0l6.6-0.6 c0.2,0,0.5-0.1,0.6-0.3L25,13.4L17.6,6z"></path> <path d="M26.4,12l1.4-1.4c1.2-1.2,1.1-3.1-0.1-4.3l-3-3c-0.6-0.6-1.3-0.9-2.2-0.9c-0.8,0-1.6,0.3-2.2,0.9L19,4.6L26.4,12z"></path> </g> <g> <path d="M28,29H4c-0.6,0-1-0.4-1-1s0.4-1,1-1h24c0.6,0,1,0.4,1,1S28.6,29,28,29z"></path> </g> </g></svg>'}},anyTuneName:{class:Lt(),config:{default:"center",blocks:{header:"center",list:"right"}}},code:{class:Ft.A,shortcut:"CMD+SHIFT+C"},delimiter:Ut.A,inlineCode:{class:Bt.A,shortcut:"CMD+SHIFT+C"},linkTool:{class:zt.A,config:{endpoint:"http://localhost:8008/fetchUrl"}},embed:{class:Ht.A,config:{services:{youtube:!0}}},table:{class:qt.A,inlineToolbar:!0,shortcut:"CMD+ALT+T"}},defaultBlock:"paragraph",data:{}};d.editorJson?m.data=d.editorJson:m.data={blocks:[{type:"header",data:{text:"Report Editor Example",level:2}},{type:"header",data:{text:"Key features",level:3}}]};var g=new _t.A(m)}l.filename=d.file_name,f||(e.isLoading=!0),f||d.author&&d.author.indexOf(l.username)>-1||d.perm&&Vt.objectArrayIndexOf(d.perm,l.username,0)?(e.editor.editorMode=!0,e.report={canvas:{width:d.canvas_width?d.canvas_width:6e3,height:d.canvas_height?d.canvas_height:6e3,auto_width:d.auto_width,auto_height:d.auto_height},report_name:d.report_name,json_content:d.jsonText,has_html:d.has_html,no_html_ed:d.no_html_ed,editorJS:g},d.has_html?e.html_area_size={left:"40%",middle:"40%",right:"20%"}:e.html_area_size={left:"0%",middle:"80%",right:"20%"}):(e.editor.editorMode=!1,e.report={canvas:{width:d.canvas_width?d.canvas_width:6e3,height:d.canvas_height?d.canvas_height:6e3,auto_width:d.auto_width,auto_height:d.auto_height},report_name:d.report_name,has_html:d.has_html,no_html_ed:d.no_html_ed,json_content:'[\n  {\n    "type": "Label",\n    "id": "79262171-1597-e38c-1833-0ef6a6fc978b",\n    "x": 56,\n    "y": 68,\n    "width": 71.90625,\n    "height": 31,\n    "alpha": 1,\n    "angle": 0,\n    "userData": {\n      "hidden": false,\n      "index": 0,\n      "font": {\n        "font_size": 34,\n        "font_color": "#f44242",\n        "font_family": "Tahoma, Geneva",\n        "font_bold": true\n      },\n      "back_color": "",\n      "frame_size": 0,\n      "frame_color": "#989799",\n      "padding": 10,\n      "text": "Access Denied!"\n    },\n    "cssClass": "Label",\n    "ports": [],\n    "bgColor": "none",\n    "color": "#989799",\n    "stroke": 0,\n    "radius": 10,\n    "dasharray": null,\n    "text": "Access Denied!",\n    "outlineStroke": 0,\n    "outlineColor": "none",\n    "fontSize": 34,\n    "fontColor": "#F44242",\n    "fontFamily": "Tahoma, Geneva, sans-seri",\n    "editor": "draw2d.ui.LabelInplaceEditor"\n  },\n  {\n    "type": "Label",\n    "id": "7fb9d92c-72c0-f4c8-dc0f-5b4ae91f0284",\n    "x": 60,\n    "y": 122,\n    "width": 71.90625,\n    "height": 31,\n    "alpha": 1,\n    "angle": 0,\n    "userData": {\n      "hidden": false,\n      "index": 0,\n      "font": {\n        "font_size": 12,\n        "font_color": "#000",\n        "font_family": "Tahoma, Geneva",\n        "font_bold": true\n      },\n      "back_color": "",\n      "frame_size": 0,\n      "frame_color": "#989799",\n      "padding": 10,\n      "text": "You have no rights to edit this report. Please contact report author:  '+d.author+'"\n    },\n    "cssClass": "Label",\n    "ports": [],\n    "bgColor": "none",\n    "color": "#989799",\n    "stroke": 0,\n    "radius": 10,\n    "dasharray": null,\n    "text": "You have no rights to edit this report. Please contact report author: '+d.author+'",\n    "outlineStroke": 0,\n    "outlineColor": "none",\n    "fontSize": 12,\n    "fontColor": "#000000",\n    "fontFamily": "Tahoma, Geneva, sans-seri",\n    "editor": "draw2d.ui.LabelInplaceEditor"\n  }\n]'},e.editor.editorMode=!1);var y,_,b,v=!0;e.loadEditorFromFile=function(t){e.report.has_html=!0;var a={readOnly:!1,holder:"editorjs",tools:{header:{class:bt.A,inlineToolbar:!0,config:{placeholder:"Header"},shortcut:"CMD+SHIFT+H",tunes:["anyTuneName"]},image:{class:vt.A},domcontainer1:{class:Pt,inlineToolbar:!0,tunes:["anyTuneName"]},list:{class:Et.A,inlineToolbar:!0,config:{defaultStyle:"unordered"}},quote:{class:It.A,inlineToolbar:!0,config:{quotePlaceholder:"Enter a quote",captionPlaceholder:"Quote's author"},shortcut:"CMD+SHIFT+O"},warning:Nt.A,underline:Mt.A,Marker:{class:jt(),config:{defaultColor:"#FFBF00",type:"marker",icon:'<svg fill="#000000" height="200px" width="200px" version="1.1" id="Icons" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M17.6,6L6.9,16.7c-0.2,0.2-0.3,0.4-0.3,0.6L6,23.9c0,0.3,0.1,0.6,0.3,0.8C6.5,24.9,6.7,25,7,25c0,0,0.1,0,0.1,0l6.6-0.6 c0.2,0,0.5-0.1,0.6-0.3L25,13.4L17.6,6z"></path> <path d="M26.4,12l1.4-1.4c1.2-1.2,1.1-3.1-0.1-4.3l-3-3c-0.6-0.6-1.3-0.9-2.2-0.9c-0.8,0-1.6,0.3-2.2,0.9L19,4.6L26.4,12z"></path> </g> <g> <path d="M28,29H4c-0.6,0-1-0.4-1-1s0.4-1,1-1h24c0.6,0,1,0.4,1,1S28.6,29,28,29z"></path> </g> </g></svg>'}},anyTuneName:{class:Lt(),config:{default:"center",blocks:{header:"center",list:"right"}}},code:{class:Ft.A,shortcut:"CMD+SHIFT+C"},delimiter:Ut.A,inlineCode:{class:Bt.A,shortcut:"CMD+SHIFT+C"},linkTool:{class:zt.A,config:{endpoint:"http://localhost:8008/fetchUrl"}},embed:{class:Ht.A,config:{services:{youtube:!0}}},table:{class:qt.A,inlineToolbar:!0,shortcut:"CMD+ALT+T"}},defaultBlock:"paragraph",data:{}};a.data=t||{blocks:[{type:"header",data:{text:"Report Editor Example",level:2}},{type:"header",data:{text:"Key features",level:3}}]},e.report.editorJS=new _t.A(a),e.html_area_size={left:"40%",middle:"40%",right:"20%"}},e.toggleEditMode=function(e){e.showToolsPanel=!e.showToolsPanel,e.figures.forEach((function(e,t){e.editMode=!e.editMode}))},e.getAdminStatus=function(){return["6237000453"].indexOf(l.username)>-1},e.newPaletItem=function(e,o){var r=function(t){DEBUG&&console.log(t);var r={class:o,panel_id:e.id,api_id:"",name:"",description:"",author:l.username};r=Wt.extend(!0,r,t),n.post(i().context+"/mongo/createAPIRecord",r).then((function(t){console.log("Record Item successfully created."),a((function(){n.get(i().context+"/mongo/getAPIRecordsByPanelID?panel_id="+e.id).then((function(t){e.figures=t.data}),(function(e){}))}),100)}),(function(e){}))};t.open({templateUrl:"views/common/new_pallet_item.html",controller:"newPalletIOtemCtrl",backdrop:"static",resolve:{callback:function(){return r}}})},e.deletePaletItem=function(e,t){n.get(i().context+"/mongo/deleteAPIRecord?ticketID="+e._id).then((function(e){console.log("Record Item successfully deleted."),a((function(){n.get(i().context+"/mongo/getAPIRecordsByPanelID?panel_id="+t.id).then((function(e){t.figures=e.data}),(function(e){}))}),100)}),(function(e){}))},y=e.editor.editorMode,window.onbeforeunload=function(){if(v&&y)return"Sure?";v=!0},e.bsCurrentClass="container-theme-light",e.bsThemes={available:[{id:"light",name:"Light",icon:"bi-sun-fill"},{id:"dark",name:"Dark",icon:"bi-moon-stars-fill"},{id:"red",name:"Red",icon:"bi-suit-heart-fill"},{id:"green",name:"Green",icon:"bi-tree-fill"},{id:"vintage",name:"Vintage",icon:"bi-card-image"}],current:"",applyTheme:function(t){this.current=t,e.bsCurrentClass="dark"===t?"container-theme-dark":"green"===t?"container-theme-green":"red"===t?"container-theme-red":"vintage"===t?"container-theme-vintage":"container-theme-light"}},e.echartsThemes={available:[{id:"light",name:"Light"},{id:"dark",name:"Dark"},{id:"vintage",name:"Vintage"},{id:"westeros",name:"Westeros"},{id:"wonderland",name:"Wonderland"},{id:"chalk",name:"Chalk"},{id:"macarons",name:"Macarons"},{id:"essos",name:"Essos"},{id:"halloween",name:"Halloween"},{id:"walden",name:"Walden"},{id:"infographic",name:"Infographic"},{id:"roma",name:"Roma"},{id:"purple-passion",name:"Purple-passion"}],current:"",applyTheme:function(t){this.current=t,e.editor.setEchartsTheme(t)}},null!=d&&null!==(p=d.editorJson)&&void 0!==p&&p.bsTheme&&(null===(_=e.bsThemes)||void 0===_||_.applyTheme(d.editorJson.bsTheme)),null!=d&&null!==(h=d.editorJson)&&void 0!==h&&h.echartsTheme&&(null===(b=e.echartsTheme)||void 0===b||b.applyTheme(d.editorJson.echartsTheme)),e.editor.showStatistics=function(){var a=e.editor.getStatistics();t.open({templateUrl:"views/common/statistics_modal.html",controller:"StatisticsModalController",backdrop:"static",size:"lg",resolve:{statistics:function(){return a}}})}};Gt.$inject=["$scope","$uibModal","$timeout","$http","$compile","loginUserService","$location","$rootScope","$sce","$stateParams","report_json"];const Jt=Gt;a("9f69b83a8175093b075e"),a("0563846496024d392663"),a("ed0b68463269518a4934"),a("bf6903a1118c19c7825f"),a("360a0beb990246ecb729"),a("d1be49724a1f416e7f57");var Qt=a("3473246f9665a5e8f7af"),Yt=a("42c38932b0e51c63bc07"),Xt=a("6a70966ffbc1fff99232"),Kt=a("8deafab7866a125bb9ca");function Zt(e){return Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zt(e)}function $t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ea(n.key),n)}}function ea(e){var t=function(e){if("object"!=Zt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=Zt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Zt(t)?t:t+""}function ta(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return aa(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(aa(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,aa(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,aa(d,"constructor",c),aa(c,"constructor",l),l.displayName="GeneratorFunction",aa(c,o,"GeneratorFunction"),aa(d),aa(d,o,"Generator"),aa(d,n,(function(){return this})),aa(d,"toString",(function(){return"[object Generator]"})),(ta=function(){return{w:i,m:p}})()}function aa(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}aa=function(e,t,a,n){function i(t,a){aa(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},aa(e,t,a,n)}function na(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function oa(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){na(i,n,o,r,s,"next",e)}function s(e){na(i,n,o,r,s,"throw",e)}r(void 0)}))}}a("d3949897a1eac25025cc");var ia=function(e,t,a,o,i,r,s,l,c,u,d){var p;l.filename=d.file_name,void 0===d||""===d||d.author&&d.author.indexOf(l.username)>-1||d.perm&&Kt.objectArrayIndexOf(d.perm,l.username,0)?(e.report={report_name:d.report_name,json_content:d.jsonText,has_html:d.has_html},e.editor.editorMode=!0):(e.report={report_name:d.report_name},e.editor.editorMode=!1),e.getAdminStatus=function(){return["6237000453"].indexOf(l.username)>-1};var h,f=document.getElementById("strip_editor");f&&((p=ace.edit(f,{mode:"ace/mode/javascript",selectionStyle:"text"})).setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),d.jsonText&&d.jsonText.module_js&&p.setValue(d.jsonText.module_js));var m,g=document.getElementById("html-code");g&&((h=ace.edit(g,{mode:"ace/mode/html",selectionStyle:"text"})).setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),d.jsonText&&d.jsonText.base_html&&h.setValue(d.jsonText.base_html));var y=document.getElementById("html-css");y&&((m=ace.edit(y,{mode:"ace/mode/css",selectionStyle:"text"})).setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),d.jsonText&&d.jsonText.base_css&&m.setValue(d.jsonText.base_css)),e.run_code=oa(ta().m((function e(){var t,a,o,i;return ta().w((function(e){for(;;)switch(e.n){case 0:t=document.getElementById("nav-home-tab"),new n.oz(t).show(),document.getElementById("html-container").scrollIntoView({behavior:"smooth"});try{if(a=document.getElementById("html-container"),h&&a&&(a.innerHTML=Xt.A.sanitize(h.getValue(),{USE_PROFILES:{html:!0}}),Kt.injectStyles(m.getValue()),p)){o=p.getValue();try{(i=Kt.safeEval(o,null)).success||console.log(i.error)}catch(e){console.error(e)}}}catch(e){document.getElementById("html-container").innerHTML=e.message}case 1:return e.a(2)}}),e)}))),e.saveUpdate=function(){var t={};t.base_html=h.getValue(),t.base_css=m.getValue(),t.module_js=p.getValue(),e.editor.requestSaveUpdate(t)},e.save_as=function(){var t={};t.base_html=h.getValue(),t.base_css=m.getValue(),t.module_js=p.getValue(),e.editor.requestPublish(t)},e.openInViewer=function(){window.open("#"+s.url().replace("st_editor","st_viewer"),"_blank")};var _=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.consoleElement=document.getElementById("console-content"),this.clearButton=document.getElementById("clear-console"),this.originalConsole={log:console.log,warn:console.warn,error:console.error},this.setupEventListeners(),this.overrideConsoleMethods()},t=[{key:"setupEventListeners",value:function(){var e=this;this.clearButton.addEventListener("click",(function(){e.consoleElement.innerHTML=""})),window.addEventListener("error",(function(t){var a;e.addLogEntry("error",(null===(a=t.error)||void 0===a?void 0:a.stack)||t.message),t.preventDefault()})),window.addEventListener("unhandledrejection",(function(t){e.addLogEntry("error","Unhandled Promise Rejection: ".concat(t.reason)),t.preventDefault()}))}},{key:"overrideConsoleMethods",value:function(){var e=this;console.log=function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];e.originalConsole.log.apply(console,a),e.addLogEntry("log",e.formatArgs(a))},console.warn=function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];e.originalConsole.warn.apply(console,a),e.addLogEntry("warn",e.formatArgs(a))},console.error=function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];e.originalConsole.error.apply(console,a),e.addLogEntry("error",e.formatArgs(a))}}},{key:"formatArgs",value:function(e){return Array.from(e).map((function(e){return"object"===Zt(e)?JSON.stringify(e,null,2):String(e)})).join(" ")}},{key:"addLogEntry",value:function(e,t){var a=document.createElement("div");a.className="mb-2";var n=(new Date).toISOString(),o="";switch(e){case"error":o="text-danger";break;case"warn":o="text-warning";break;default:o="text-primary"}a.innerHTML='\n                    <span class="text-secondary small">'.concat(n,'</span>\n                    <span class="').concat(o,' ms-1 small">[').concat(e.toUpperCase(),']</span>\n                    <span class="ms-1 small">').concat(t,"</span>\n                "),this.consoleElement.appendChild(a),this.consoleElement.scrollTop=this.consoleElement.scrollHeight}}],t&&$t(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();new _};ia.$inject=["$scope","$uibModal","$timeout","$http","$compile","loginUserService","$location","$rootScope","$sce","$stateParams","report_json"];const ra=ia;var sa=a("d1be49724a1f416e7f57");function la(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var ca=function(e,t,a,n,o,i){e.values=[];var r=[];e.forceSel=null,e.message=n.userData.message,e.showBusket=n.userData.showBusket;var s=" ";n.userData.filter.params&&n.userData.filter.params.length&&n.userData.filter.params.forEach((function(e,t){s=s+", "+e.field})),n.userData.row.length&&n.userData.filter&&(r=n.userData.filter.searchInResult?sa("SELECT ["+n.userData.filter.field+"]"+s+", sum(cnt) as [cnt], count(*) as [sites] FROM ? group by ["+n.userData.filter.field+"]"+s,[n.userData.sites_list_out]):sa("SELECT ["+n.userData.filter.field+"]"+s+", sum(cnt) as [cnt], count(*) as [sites] FROM ? group by ["+n.userData.filter.field+"]"+s,[n.userData.row[0].sites_list_out])),e.values=r,e.forceSel=n.userData.filterOnLoad;var l=[];n.userData.filter.params&&n.userData.filter.params.length?(l.push({field:n.userData.filter.field,displayName:"Filter Value",width:"50%"}),n.userData.filter.params.forEach((function(e,t){if(e.drop_list&&e.drop_list.length){var a=[];e.drop_list.forEach((function(e){a.push({id:e,option:e})})),l.push({field:e.field,enableCellEdit:!0,displayName:"Param#"+(t+1),editableCellTemplate:"ui-grid/dropdownEditor",editDropdownIdLabel:"id",editDropdownValueLabel:"option",editDropdownOptionsArray:a})}else l.push({field:e.field,enableCellEdit:!0,displayName:"Param#"+(t+1)})}))):l.push({field:n.userData.filter.field,displayName:"Filter Value"}),l.push({field:n.userData.filter.use_sum?"cnt":"sites",displayName:"Count",width:70,aggregationType:i.aggregationTypes.sum}),e.gridOptions={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,data:r,enableRowSelection:!0,enableRowHeaderSelection:!n.userData.filter.select_one,multiSelect:!n.userData.filter.select_one,onRegisterApi:function(t){e.gridApi=t,o((function(){e.gridApi.core.handleWindowResize()}),500,10),t.selection.on.rowSelectionChanged(e,(function(){e.selSub=e.gridApi.selection.getSelectedRows()}))},columnDefs:l};var c=[];if(n.userData.filter.filter_list&&n.userData.filter.filter_list.length){var u=" ";n.userData.filter.params&&n.userData.filter.params.length&&n.userData.filter.params.forEach((function(e,t){u=u+", old_filter.["+e.field+"]"}));var d="SELECT ["+n.userData.filter.field+"]"+u+", all_data.cnt, all_data.sites from ? all_data right join ? old_filter on old_filter.value = all_data.["+n.userData.filter.field+"]";c=sa(d,[r,n.userData.filter.filter_list])}e.gridOptionsSel={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,data:c,enableRowSelection:!0,enableRowHeaderSelection:!n.userData.filter.select_one,multiSelect:!n.userData.filter.select_one,onRegisterApi:function(t){e.gridApiSel=t,o((function(){e.gridApiSel.core.handleWindowResize()}),500,10),t.selection.on.rowSelectionChanged(e,(function(){e.selSubSel=e.gridApiSel.selection.getSelectedRows()}))},columnDefs:l},e.add=function(){var t,a=e.gridApi.selection.getSelectedRows(),n=JSON.parse(JSON.stringify(e.gridOptionsSel.data));if(a){var o=JSON.parse(JSON.stringify(a));o.forEach((function(e){delete e.$$hashKey})),n.push.apply(n,function(e){if(Array.isArray(e))return la(e)}(t=o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return la(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?la(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),e.gridOptionsSel.data=n,e.gridApi.selection.clearSelectedRows(),e.gridApi.core.refresh(),e.gridApiSel.core.refresh()}},e.clear=function(){e.gridOptionsSel.data=[],e.gridApiSel.core.refresh()},e.delete=function(){var t=e.gridApiSel.selection.getSelectedRows();if(t.length){var a=e.gridOptionsSel.data.indexOf(t[0]);e.gridOptionsSel.data.splice(a,1),e.gridApiSel.core.refresh()}},e.ok=function(){var t;t=e.showBusket?e.gridOptionsSel.data:e.gridApi.selection.getSelectedRows(),a.close(t)},e.cancel=function(){a.dismiss("cancel")}};ca.$inject=["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants"];const ua=ca;var da=a("2862a523e031319710f7");var pa=a("a45670b3d8fb79ec0258"),ha=a("8deafab7866a125bb9ca"),fa=a("8a868d10b6533e768658"),ma=function(e,t,a,n,o,r,s,l,c,u){pa(document).on("tap",(function(e){e.preventDefault()})),l.version="1.8",e.getCookie=function(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));return 2===t.length?t.pop().split(";").shift():null},e.fallbackCopyToClipboard=function(t){var a=document.createElement("textarea");a.value=t,a.style.position="fixed",a.style.left="-999999px",a.style.top="-999999px",document.body.appendChild(a),a.focus(),a.select();try{document.execCommand("copy")?alert("Token data copied to clipboard!\n\nPaste this in your local development environment.\n\nData:\n"+t):e.showTokenDataModal(t)}catch(a){console.error("Fallback copy failed:",a),e.showTokenDataModal(t)}finally{document.body.removeChild(a)}},e.showTokenDataModal=function(e){alert("Could not copy to clipboard automatically.\n\nPlease manually copy this token data:\n\n"+e)},e.cp_options={format:"hex"},e.editor={editorMode:!0,rendererMode:!1,full_j:!1,sync_vega:!0,default_router:"draw2d.layout.connection.InteractiveManhattanConnectionRouter",fileSave:function(e,t){var a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,da.saveAs)(a,"fish_bone.conf")},getLocalToken:function(){try{for(var t={username:null,token:null},a=0,n=["UCSSSOAccount","UCSSSOUser","UCSLoginName","PORTALSSOUser"];a<n.length;a++){var o=n[a],i=e.getCookie(o);if(i){t.username=i;break}}for(var r=0,s=["UCSSSOToken","PORTALSSOCookie"];r<s.length;r++){var c=s[r],u=e.getCookie(c);if(u){t.token=u;break}}t.username||(t.username=l.username||"unknown_user"),t.token||(t.token="production_token_"+Date.now());var d=JSON.stringify(t,null,2);navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(d).then((function(){alert("Token data copied to clipboard!\n\nPaste this in your local development environment.\n\nData:\n"+d)})).catch((function(t){console.error("Failed to copy to clipboard:",t),e.fallbackCopyToClipboard(d)})):e.fallbackCopyToClipboard(d)}catch(e){console.error("Error extracting token data:",e),alert("Error extracting token data. Please check browser console for details.")}},view:function(){window.open("#"+s.url().replace("editor","viewer"),"_blank")},requestPublish:function(a,n,o,i){t.open({templateUrl:"views/common/modal_publish_request.html",controller:"PublishReqCtrl",backdrop:"static",resolve:{jsonText:function(){return a},editorJson:function(){return n},editor:function(){return e.editor},hasHtmlFlag:function(){return o},noHtmlEdFlag:function(){return i}}})},requestSaveUpdate:function(e,a){t.open({templateUrl:"views/common/modal_save_request.html",controller:"SaveReqCtrl",resolve:{jsonText:function(){return e},editorJson:function(){return a}}})},getPivotDAttrModal:function(e,a){t.open({templateUrl:"views/common/modal_pivot_dattr_add.html",size:"sm",controller:"PivotDAttrCtrl",resolve:{callback:function(){return a},pivot:function(){return e}}})},getMyReports:function(e){t.open({templateUrl:"views/common/modal_my_reports.html",controller:"MyReportsReqCtrl",size:"lg",resolve:{callback:function(){return e}}})},showPublishResult:function(e){n.post(i().context+"/mongo/postData?file_name="+ha.generateUUID()+"&username="+l.username+"&proj_id="+l.project_id,e).then((function(e){console.log(e.data),t.open({templateUrl:"views/common/modal_publish.html",controller:"ModalInstanceCtrl",backdrop:"static",resolve:{filename:function(){return e.data}}})})).catch((function(e){console.log(e.data)}))},logout:function(){r.logout((function(){s.path("thanks"),l.authenticationDone=!1}),(function(e){s.path("thanks"),l.authenticationDone=!1}))},selectValues:function(e){t.open({templateUrl:"views/common/ValueSelectorController.html",controller:"ScopeFilterController",resolve:{figure:function(){return e}}}).result.then((function(t){var a=[];t.forEach((function(e,t){a.push({value:e.value,sites:e.sites})})),e.userData.filter.filter_list=a,e.userData.filter.isMulti=!0;var n="";t.forEach((function(e,a){a===t.length-1?n+=e.value:n=n+e.value+"\n"})),e.filter_label.setText("Multiple filter"),e.userData.filter.value=n,ha.initFallDown(e),e.GetHTTPData()}),(function(){}))},selectFilterValues:function(e,a){t.open({templateUrl:"views/common/ValueSelectorController.html",controller:"FilterController",size:e.userData.win_size,resolve:{figure:function(){return e}}}).result.then((function(t){var n=[];t.forEach((function(t,a){var o={};o.value=t[e.userData.filter.field],o.sites=t.sites,e.userData.filter.params&&e.userData.filter.params.length&&e.userData.filter.params.forEach((function(e,a){o[e.field]=t[e.field]})),n.push(o)})),e.userData.filter.filter_list=n;var o="";t.forEach((function(a,n){n===t.length-1?o+=a[e.userData.filter.field]:o=o+a[e.userData.filter.field]+"\n"})),e.filter_label.setText("Multiple filter"),e.userData.filter.value=o,a||ha.initFallDown(e,!0),setTimeout((function(){e.GetHTTPData()}),1e3)}),(function(){}))},selectScopeValues:function(e){t.open({templateUrl:"views/common/scope_filter.html",controller:"ScopeController",resolve:{figure:function(){return e}}}).result.then((function(t){var a=[];t.forEach((function(e,t){a.push({value:e.value,sites:e.sites})})),e.userData.filter.filter_list=a,e.userData.filter.isMulti=!0;var n="";t.forEach((function(e,a){a===t.length-1?n+=e.value:n=n+e.value+"\n"})),e.filter_label.setText("Multiple filter"),e.userData.filter.value=n,ha.initFallDown(e),e.GetHTTPData()}),(function(){console.log("canceled")}))},selectBuildingValues:function(e){t.open({templateUrl:"views/common/scope_filter.html",controller:"BuildingController",resolve:{figure:function(){return e}}}).result.then((function(t){var a=[];t.forEach((function(e,t){a.push({value:e.value,sites:e.sites})})),e.userData.filter.filter_list=a,e.userData.filter.isMulti=!0;var n="";t.forEach((function(e,a){a===t.length-1?n+=e.value:n=n+e.value+"\n"})),e.filter_label.setText("Multiple filter"),e.userData.filter.value=n,ha.initFallDown(e),e.GetHTTPData()}),(function(){}))},selectDUModelValues:function(e,a){t.open({templateUrl:"views/common/condition_filter.html",controller:"NewFilterController",resolve:{figure:function(){return e},filterdata:function(){return a}}})},editTable:function(e){t.open({templateUrl:"views/common/table_editor.html",controller:"TableEditorController",size:"fullscreen",resolve:{figure:function(){return e}}})},newVegaLibItem:function(a){t.open({templateUrl:"views/common/new_lib_item.html",controller:"NewLibItemController",size:"lg",resolve:{figure:function(){return a},edit:function(){return null}}}).result.then((function(t){DEBUG&&console.log(t),e.create_job=n.post(i().context+"/mongo/createVegaLibItem",t).then((function(e){a.userData.recipe={id:e.data.insertedId,version:1,author:t.author},DEBUG&&console.log("VegaLibItem successfully created.")}),(function(e){}))}),(function(){}))},editVegaLibItem:function(a){var o;n.get(i().context+"/mongo/getVegaLibItem?item_id="+a.userData.recipe.id).then((function(r){r&&(o=t.open({templateUrl:"views/common/new_lib_item.html",controller:"NewLibItemController",size:"lg",resolve:{figure:function(){return a},edit:function(){return r.data}}})),o.result.then((function(t){DEBUG&&console.log(t),e.create_job=n.post(i().context+"/mongo/updateVegaLibItem?item_id="+t._id,t).then((function(e){DEBUG&&console.log("VegaLibItem successfully edited."),a.userData.recipe.version=t.version}),(function(e){}))}),(function(){}))}),(function(e){}))},getVegaLibItem:function(a){e.get_items=n.get(i().context+"/mongo/getUserVegaLib?username="+e.username).then((function(e){0===e.data.length?console.log("No Vega Lib Items found"):t.open({templateUrl:"views/common/all_lib_items.html",controller:"AllLibItemsController",size:"xl",resolve:{figure:function(){return a},items:function(){return e.data}}}).result.then((function(e){DEBUG&&console.log(e),e.spec&&(a.userData.recipe={id:e._id,author:e.author,version:e.version||1},a.setSpec(e.spec))}),(function(){}))}),(function(e){}))},saveNodeLibItem:function(e,a,n,o){t.open({templateUrl:"views/common/new_node_lib_item.html",controller:"NewNodeLibItemController",size:"lg",resolve:{figure:function(){return e},property:function(){return a},nodeType:function(){return n},currentCode:function(){return o},edit:function(){return null}}}).result.then((function(e){console.log("Node library item saved:",e)}),(function(){console.log("Save cancelled")}))},loadNodeLibItem:function(a,o,r,s){n.get(i().context+"/mongo/getNodeLibItems?username="+e.username+"&node_type="+r+"&property_name="+o).then((function(n){0===n.data.length?(console.log("No library items found for "+r+"."+o),alert("No library items found for this node type and property.")):t.open({templateUrl:"views/common/all_node_lib_items.html",controller:"AllNodeLibItemsController",size:"xl",resolve:{figure:function(){return a},property:function(){return o},nodeType:function(){return r},items:function(){return n.data}}}).result.then((function(t){"edit"===t.action?e.editor.editNodeLibItem(a,o,r,t.item.code,t.item):s&&"function"==typeof s&&s(t.code)}),(function(){console.log("Load cancelled")}))})).catch((function(e){console.error("Error loading node library items:",e),alert("Error loading library items. Please try again.")}))},editNodeLibItem:function(e,a,o,r,s){n.get(i().context+"/mongo/getNodeLibItem?item_id="+s._id).then((function(n){n.data&&t.open({templateUrl:"views/common/new_node_lib_item.html",controller:"NewNodeLibItemController",size:"lg",resolve:{figure:function(){return e},property:function(){return a},nodeType:function(){return o},currentCode:function(){return r},edit:function(){return n.data}}}).result.then((function(e){console.log("Node library item updated:",e)}),(function(){console.log("Edit cancelled")}))})).catch((function(e){console.error("Error loading item for edit:",e)}))},viewTable:function(e){t.open({templateUrl:"views/common/table_editor.html",controller:"TableViewerController",size:"fullscreen",resolve:{valarr:function(){return(0,h.IsJsonString)(e)?JSON.parse(e):e}}})},selectProjectSitesValues:function(e,a){t.open({templateUrl:"views/common/condition_filter.html",controller:"NewFilterController",resolve:{figure:function(){return e},filterdata:function(){return a}}})},selectUDFValues:function(e){t.open({templateUrl:"views/common/ValueSelectorController.html",controller:"UDFFilterController",resolve:{figure:function(){return e}}}).result.then((function(t){e.userData.filter.filtered=!0,e.userData.filter.list=t,ha.initFallDown(e),e.setFilter(e.userData.sites_list_out)}),(function(){}))},selectCodeValues:function(e){t.open({templateUrl:"views/common/ValueSelectorController.html",controller:"CodeFilterController",resolve:{figure:function(){return e}}}).result.then((function(t){e.userData.filter.filtered=!0,e.userData.filter.list=t,ha.initFallDown(e),e.setFilter(e.userData.sites_list_out)}),(function(){}))},toggleFullScreen:function(e){var t;null===(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||null)?((t=pa("#container").get(0)).requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen(),pa("#toggle_full_screen").get(0).childNodes[0].classList.remove("fa-expand","fa-compress"),pa("#toggle_full_screen").get(0).childNodes[0].classList.add("fa-compress")):(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),pa("#toggle_full_screen").get(0).childNodes[0].classList.remove("fa-expand","fa-compress"),pa("#toggle_full_screen").get(0).childNodes[0].classList.add("fa-expand"))},canvas:{},palette:{panels:[{name:"Data",isOpen:!0,icon:"bi bi-database",figures:[{color:"#00d58a",class:"draw2d.shape.fishbone.cell.Projectnode_api",name:"Project",pic_class:"pe-2 bi bi-globe-americas"},{color:"#03a0fe",class:"draw2d.shape.fishbone.cell.DUModelnode_api",name:"DU Model",pic_class:"pe-2 bi bi-box-seam-fill "},{color:"#03a0fe",class:"draw2d.shape.fishbone.cell.Datanode",name:"Task",pic_class:"pe-2 bi bi-list-task"},{color:"#4da6ff",class:"draw2d.shape.fishbone.cell.Tasknode",name:"Task API",pic_class:"pe-2 bi bi-card-list"},{color:"#ec8c3b",class:"draw2d.shape.fishbone.cell.CustomFieldnode",name:"DU Field",pic_class:"pe-2 pt-1 fa-solid fa-chalkboard-user"},{color:"#cd4875",class:"draw2d.shape.fishbone.ra.RaTaskGroup",name:"Task Group",pic_class:"pe-2 bi bi-bar-chart-steps"},{color:"#ec8858",class:"draw2d.shape.fishbone.cell.SQLnode",name:"AlaSQL",pic_class:"pe-2 bi bi-person-raised-hand"},{color:"#03a0fe",class:"draw2d.shape.fishbone.cell.APInode",name:"API Call",pic_class:"pe-2 bi bi-telephone-forward"},{color:"#1e97e0",class:"draw2d.shape.fishbone.cell.UrlAPInode",name:"Icosq API Call",pic_class:"pe-2 bi bi-telephone-forward"}]},{id:"c460f556-e0b5-11ec-9d64-0242ac120002",name:"API Data",icon:"bi bi-database-fill-gear",isOpen:!1,editable:!0,showToolsPanel:!1,figures:[]},{name:"Charts",isOpen:!1,icon:"bi bi-bar-chart-line",figures:[{color:"#9ccd48",class:"draw2d.shape.fishbone.ra.RaphaelChart",name:"UChart",pic_class:"pe-2 pt-1 fa-solid fa-chart-column"},{color:"#9ccd48",class:"draw2d.shape.fishbone.ra.RaphaelPieChart",name:"Pie Chart",pic_class:"pe-2 pt-1 fa-solid fa-chart-pie"},{color:"#cd9848",class:"draw2d.shape.fishbone.cell.D3node",name:"D3 Chart",pic_class:"pe-2 pt-1 fa-solid fa-chart-simple"},{color:"#489ecd",class:"draw2d.shape.fishbone.ra.RaVegaChart",name:"Vega",pic_class:"pe-2 pt-1 fa-brands fa-vimeo-v"},{color:"#cd4875",class:"draw2d.shape.fishbone.ra.RaEchartAdapter",name:"Echarts",pic_class:"pe-2 pt-1 fa-solid fa-seedling"},{color:"#b24823",class:"draw2d.shape.fishbone.cell.EchartGroup",name:"Echarts Group",pic_class:"pe-2 pt-1 fa-solid fa-seedling"},{color:"#8720cb",class:"draw2d.shape.fishbone.ra.RaEchartMap",name:"Echarts Map",pic_class:"pe-2 pt-1 fa-regular fa-map"},{color:"#ca37da",class:"draw2d.shape.fishbone.ra.RaEchartMorph",name:"Echarts Mrph",pic_class:"pe-2 pt-1 fa-solid fa-wand-magic-sparkles"}]},{name:"Tables",icon:"bi bi-table",isOpen:!1,figures:[{color:"#6b39ad",class:"draw2d.shape.fishbone.ra.RaPivotnode",name:"Pivot",pic_class:"pe-2 pt-1 fa-solid fa-table-list"},{color:"#6b39ad",class:"draw2d.shape.fishbone.ra.RaPivotnode_new",name:"*Pivot",pic_class:"pe-2 pt-1 fa-solid fa-table-list"},{color:"#03a0fe",class:"draw2d.shape.fishbone.ra.RaTablenode",name:"Table",pic_class:"pe-2 pt-1 fa-solid fa-table"},{color:"#f7794c",class:"draw2d.shape.fishbone.ra.RaPivotAdapter",name:"Pivot Adapt",pic_class:"pe-2 pt-1 fa-solid fa-table-cells"},{color:"#f7794c",class:"draw2d.shape.fishbone.ra.RaTableAdapter",name:"Table Adapt",pic_class:"pe-2 pt-1 fa-solid fa-table-cells"}]},{name:"Labels",icon:"bi bi-tags",isOpen:!1,figures:[{color:"#03a0fe",class:"draw2d.shape.fishbone.label.Header1",name:"Label",pic_class:"pe-2 pt-1 fa-solid fa-tag"},{color:"#03a0fe",class:"draw2d.shape.fishbone.label.Label",name:"New Label",pic_class:"pe-2 pt-1 fa-solid fa-tag"},{color:"#03a0fe",class:"draw2d.shape.fishbone.label.Memo",name:"Memo",pic_class:"pe-2 pt-1 fa-solid fa-pen-to-square"},{color:"#03a0fe",class:"draw2d.shape.fishbone.ra.RaLabel",name:"Act Label",pic_class:"pe-2 pt-1 fa-solid fa-lightbulb"},{color:"#03a0fe",class:"draw2d.shape.fishbone.basic.TimerUpdate",name:"Auto Update",pic_class:"pe-2 pt-1 fa-solid fa-clock-rotate-left"},{color:"#03a0fe",class:"draw2d.shape.fishbone.label.Countdown",name:"Countdown",pic_class:"pe-2 pt-1 fa-solid fa-stopwatch"},{color:"#03a0fe",class:"draw2d.shape.fishbone.label.Today",name:"Today",pic_class:"pe-2 pt-1 fa-solid fa-calendar-day"},{color:"#03a0fe",class:"draw2d.shape.fishbone.label.HTML_link",name:"HTML Link",pic_class:"pe-2 pt-1 fa-solid fa-link"}]},{name:"Funct",icon:"bi bi-calculator",isOpen:!1,figures:[{color:"#777777",class:"draw2d.shape.fishbone.cell.Addnode",name:"Add",symbol:"∑"},{color:"#777777",class:"draw2d.shape.fishbone.ra.AddRaTaskGroup",name:"TG Math",pic_class:"pe-2 pt-1 fa-solid fa-calculator"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Andnode",name:"And",pic_class:"pe-2 pt-1",symbol:"&"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Ornode",name:"Or",pic_class:"pe-2 pt-1",symbol:"||"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Diffnode",name:"Diff",pic_class:"pe-2 pt-1",symbol:"Δ"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Mathnode",name:"Math",pic_class:"pe-2 bi bi-infinity"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Stylenode",name:"CSS",pic_class:"pe-2 bi bi-filetype-css"},{color:"#777777",class:"draw2d.shape.fishbone.cell.HTMLnode",name:"HTML",pic_class:"pe-2 bi bi-filetype-html"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Filternode",name:"Filter",pic_class:"pe-2 bi bi-funnel-fill"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Slanode",name:"SLA",pic_class:"pe-2 pt-1 fa-solid fa-star"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Periodnode",name:"Period",pic_class:"pe-2 bi bi-braces"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Joinnode",name:"Join",pic_class:"pe-2 pt-1 fa-solid fa-coins"},{color:"#777777",class:"draw2d.shape.fishbone.cell.Unionnode",name:"Union",pic_class:"pe-2 pt-1 fa-solid fa-layer-group"},{color:"#20b3b9",class:"draw2d.shape.fishbone.cell.Transformnode",name:"Transform",pic_class:"pe-2 pt-1 fa-solid fa-money-bill-transfer"}]},{name:"Routers",icon:"bi bi-router",isOpen:!1,figures:[{color:"#006192",class:"draw2d.shape.fishbone.ra.RaManyToOne",name:"Many->One",pic_class:"pe-2 bi bi-diagram-3-fill"},{color:"#006192",class:"draw2d.shape.fishbone.cell.YesNOnode",name:"Y/N",pic_class:"pe-2 bi bi-diamond-half"},{color:"#006192",class:"draw2d.shape.fishbone.cell.FORnode",name:"FOR",pic_class:"pe-2 bi bi-repeat"},{color:"#006192",class:"draw2d.shape.fishbone.cell.IFnode",name:"IF",pic_class:"pe-2 pt-1 fa-solid fa-retweet"},{color:"#006192",class:"draw2d.shape.fishbone.cell.IFRouternode",name:"IF Router",pic_class:"pe-2 pt-1 fa-solid fa-retweet"},{color:"#006192",class:"draw2d.shape.fishbone.cell.ALERTnode",name:"Message",pic_class:"pe-2 pt-1 fa-solid fa-message"}]},{name:"ML&AI",icon:"bi bi-robot",isOpen:!1,figures:[{color:"#e1772c",class:"draw2d.shape.fishbone.cell.AIZTEnode",name:"AI ZTE LLM",pic_class:"pe-2 pt-1 ",symbol:"DN"}]},{name:"Misc",icon:"bi bi-puzzle",isOpen:!1,figures:[{color:"#6b39ad",class:"draw2d.shape.fishbone.ra.Progress",name:"Progress",pic_class:"pe-2 pt-1 fa-solid fa-bars-progress"},{color:"#6b39ad",class:"draw2d.shape.fishbone.basic.Image",name:"Image",pic_class:"pe-2 pt-1 fa-solid fa-image"},{color:"#6b39ad",class:"draw2d.shape.basic.Line",name:"Line",pic_class:"pe-2 pt-1 fa-solid fa-grip-lines"},{color:"#6b39ad",class:"draw2d.shape.fishbone.basic.Rect",name:"Rect",pic_class:"pe-2 pt-1 fa-regular fa-square"},{color:"#6b39ad",class:"draw2d.shape.fishbone.basic.Oval",name:"Oval",pic_class:"pe-2 pt-1 fa-regular fa-circle"}]}]}},e.editor.palette.panels.forEach((function(e,t){e.editable&&n.get(i().context+"/mongo/getAPIRecordsByPanelID?panel_id="+e.id).then((function(t){e.figures=t.data,e.figures.forEach((function(e,t){e.editMode=!1}))}),(function(e){}))})),e.trustHtml=function(e){return c.trustAsHtml(e)},e.applyConfigData=function(e){"draw2d.shape.fishbone.cell.Projectnode"!==e.figure.NAME?(ha.initFallDown(e.figure,!0),e.figure.GetHTTPData()):"draw2d.shape.fishbone.cell.Projectnode"===e.figure.NAME&&e.figure.initDownUpdate()},e.turnPorts=function(e){e.figure.getPorts().data.forEach((function(e,t){e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_UP?(e.setLocator(new fa.layout.locator.OutputPortLocator),e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_RIGHT)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_RIGHT?(e.setLocator(new fa.layout.locator.BottomLocator),e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_DOWN)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_DOWN?(e.setLocator(new fa.layout.locator.InputPortLocator),e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_LEFT)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_LEFT&&(e.setLocator(new fa.layout.locator.TopLocator),e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_UP))})),e.figure.layoutPorts(),e.figure.updateUI()},e.turnInputPorts=function(e){e.figure.getInputPorts().data.forEach((function(e,t){e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_UP?(e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_RIGHT),e.setLocator(new fa.layout.locator.OutputPortLocator)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_RIGHT?(e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_DOWN),e.setLocator(new fa.layout.locator.BottomOutputPortLocator)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_DOWN?(e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_LEFT),e.setLocator(new fa.layout.locator.InputPortLocator)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_LEFT&&(e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_UP),e.setLocator(new fa.layout.locator.TopInputPortLocator))})),e.figure.layoutPorts(),e.figure.updateUI()},e.turnOutputPorts=function(e){e.figure.getOutputPorts().data.forEach((function(e,t){e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_UP?(e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_RIGHT),e.setLocator(new fa.layout.locator.OutputPortLocator)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_RIGHT?(e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_DOWN),e.setLocator(new fa.layout.locator.BottomOutputPortLocator)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_DOWN?(e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_LEFT),e.setLocator(new fa.layout.locator.InputPortLocator)):e.getConnectionDirection()===fa.geo.Rectangle.DIRECTION_LEFT&&(e.setConnectionDirection(fa.geo.Rectangle.DIRECTION_UP),e.setLocator(new fa.layout.locator.TopInputPortLocator))})),e.figure.layoutPorts(),e.figure.updateUI()},e.bringToFront=function(e){e.figure.toFront()},e.sentToBack=function(e){e.figure.toBack()}};ma.$inject=["$scope","$uibModal","$timeout","$http","$compile","loginUserService","$location","$rootScope","$sce","$stateParams"];const ga=ma;var ya=a("a45670b3d8fb79ec0258"),_a=function(e,t,a,n,o,i){e.editor.editorMode=!1,e.myInterval=5e3,e.noWrapSlides=!1,e.active=0,e.canvasParking=[],e.slides=i.slides,e.playlist=i.playlist,e.changeTab=function(e){ya("#tab-"+e).tab("show")};var r,s=[];e.slides.forEach((function(e,t){if(e.has_html){var a={readOnly:!0,holder:"editorjs_"+e.id,inlineToolbar:["link","marker","bold","italic"],tools:{header:{class:bt.A,inlineToolbar:!0,config:{placeholder:"Header"},shortcut:"CMD+SHIFT+H",tunes:["anyTuneName"]},image:{class:vt.A},domcontainer1:{class:Pt,inlineToolbar:!0,tunes:["anyTuneName"]},list:{class:Et.A,inlineToolbar:!0,config:{defaultStyle:"unordered"}},quote:{class:It.A,inlineToolbar:!0,config:{quotePlaceholder:"Enter a quote",captionPlaceholder:"Quote's author"},shortcut:"CMD+SHIFT+O"},warning:Nt.A,underline:Mt.A,Marker:{class:jt(),config:{defaultColor:"#FFBF00",type:"marker",icon:'<svg fill="#000000" height="200px" width="200px" version="1.1" id="Icons" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M17.6,6L6.9,16.7c-0.2,0.2-0.3,0.4-0.3,0.6L6,23.9c0,0.3,0.1,0.6,0.3,0.8C6.5,24.9,6.7,25,7,25c0,0,0.1,0,0.1,0l6.6-0.6 c0.2,0,0.5-0.1,0.6-0.3L25,13.4L17.6,6z"></path> <path d="M26.4,12l1.4-1.4c1.2-1.2,1.1-3.1-0.1-4.3l-3-3c-0.6-0.6-1.3-0.9-2.2-0.9c-0.8,0-1.6,0.3-2.2,0.9L19,4.6L26.4,12z"></path> </g> <g> <path d="M28,29H4c-0.6,0-1-0.4-1-1s0.4-1,1-1h24c0.6,0,1,0.4,1,1S28.6,29,28,29z"></path> </g> </g></svg>'}},anyTuneName:{class:Lt(),config:{default:"right",blocks:{header:"center",list:"right"}}},code:{class:Ft.A,shortcut:"CMD+SHIFT+C"},delimiter:Ut.A,inlineCode:{class:Bt.A,shortcut:"CMD+SHIFT+C"},linkTool:{class:zt.A,config:{endpoint:"http://localhost:8008/fetchUrl"}},embed:{class:Ht.A,config:{services:{youtube:!0}}},table:{class:qt.A,inlineToolbar:!0,shortcut:"CMD+ALT+T"}},defaultBlock:"paragraph",data:{}};e.editorJson&&(a.data=e.editorJson,e.haveHTMLFrame=!0),s.push(new _t.A(a)),s[t].isReady.then((function(){var t=document.getElementById("editorjs_"+e.id);t&&t.querySelector(".codex-editor--narrow").classList.remove("codex-editor--narrow"),console.log("Editor.js is ready to work!")})).catch((function(e){console.log("Editor.js initialization failed because of ".concat(e))}))}else s.push(null)}));var l=0;e.action="Play",e.settings={},e.settings.interval=4e3,e.playSlides=function(){var t=ya("#play_icon");if(t.hasClass("fa-play")){if(angular.isDefined(r))return;t.removeClass("fa-play").addClass("fa-stop"),e.action="Stop",ya("#home_tab").prop("disabled",!0),ya("#settings").prop("disabled",!0),ya("#tab-"+l).tab("show"),l++,r=o((function(){ya("#tab-"+l).tab("show"),l<e.slides.length-1?l++:l=0}),e.settings.interval);var a=ya("#myTab");a.css("margin-top",-a.height()),ya("#stopButton").css("display","block")}else t.removeClass("fa-stop").addClass("fa-play"),e.action="Play",e.stopShow(),l=0},e.stopPlaying=function(){ya("#myTab").css("margin-top","0px"),ya("#stopButton").css("display","none"),ya("#play_icon").removeClass("fa-stop").addClass("fa-play"),e.action="Play",e.stopShow(),l=0},e.stopShow=function(){angular.isDefined(r)&&(o.cancel(r),r=void 0,ya("#home_tab").prop("disabled",!1),ya("#settings").prop("disabled",!1))},e.$on("$destroy",(function(){e.stopShow()})),e.randomize=function(){!function(e){for(var t=0,a=slides.length;t<a;t++)slides[t].id=e.pop()}(function(){for(var e=[],t=0;t<0;++t)e[t]=t;return function(e){var t,a,n=e.length;if(n)for(;--n;)t=e[a=Math.floor(Math.random()*(n+1))],e[a]=e[n],e[n]=t;return e}(e)}())}};_a.$inject=["$scope","$stateParams","$timeout","$http","$interval","playlist_result"];const ba=_a;var va=function(e,t,a,n,o){t.filename=o.file_name,e.isLoading=!0,e.report={canvas:{width:o.canvas_width?o.canvas_width:6e3,height:o.canvas_height?o.canvas_height:6e3,auto_width:o.auto_width,auto_height:o.auto_height},report_name:o.report_name,json_content:o.jsonText},e.editor.editorMode=!1,window.onbeforeunload=void 0};va.$inject=["$scope","$rootScope","$stateParams","$timeout","report_json"];const wa=va;var xa=a("6fe5e339b0f8a936ba8c"),ka=a("a45670b3d8fb79ec0258"),Da=a("8deafab7866a125bb9ca"),Sa=function(e,t,a,n,o,i){var r=n.getUserData();e.values=[],e.current_condition={},e.gridOptionsConditions={};var s=JSON.stringify(n.sites_list_in);e.gridOptionsFilters={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!0,onRegisterApi:function(t){e.gridApiReportsSel=t,t.selection.on.rowSelectionChanged(e,(function(){var t=r.conditions.indexOf(e.current_condition);if(r.conditions[t].values=[],e.gridApiReportsSel.selection.getSelectedRows().length){var a=e.gridApiReportsSel.selection.getSelectedRows(),n="";a.forEach((function(e,a){-1==r.conditions[t].values.indexOf(e.value)&&(r.conditions[t].values.push(e.value),n=n+" "+e.value)})),r.conditions[t].value=n,r.conditions[t].sign="in",e.gridOptionsConditions.columnDefs[4].enableCellEdit=!1}else r.conditions[t].value="empty",r.conditions[t].sign="consist",e.gridOptionsConditions.columnDefs[4].enableCellEdit=!0}))},columnDefs:[{field:"value",displayName:"Filter Value"},{field:"sites",displayName:"Sites count",width:"20%",aggregationType:i.aggregationTypes.sum}]},e.gridOptionsConditions={enableRowSelection:!0,enableRowHeaderSelection:!1,enableFiltering:!0,multiSelect:!0,modifierKeysToMultiSelect:!0,noUnselect:!0,onRegisterApi:function(a){e.gridApiConditions=a,a.selection.on.rowSelectionChanged(e,(function(t){e.current_condition=e.gridApiConditions.selection.getSelectedRows()[0];var a=xa.context+"/data/getAllFilterValues?scope_id="+n.userData.scope.scope_id+"&proj_id="+n.project.proj_id+"&filter_name="+e.current_condition.prop;ka.ajax({url:a,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:s,success:function(t){e.gridOptionsFilters.data=t,e.current_condition.values&&e.current_condition.values.length&&e.current_condition.values.forEach((function(a,n){t.forEach((function(t,n){t.value===a&&(e.gridApiReportsSel.grid.modifyRows(e.gridOptionsFilters.data),e.gridApiReportsSel.selection.selectRow(e.gridOptionsFilters.data[n]))}))}))}})})),a.edit.on.afterCellEdit(e,(function(a,o){e.current_condition=e.gridApiConditions.selection.getSelectedRows()[0];var i=xa.context+"/data/getAllFilterValues?scope_id="+n.userData.scope.scope_id+"&proj_id="+n.project.proj_id+"&filter_name="+e.current_condition.prop;ka.ajax({url:i,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:s,success:function(a){t((function(){e.gridOptionsFilters.data=a,e.current_condition.values&&e.current_condition.values.length&&e.current_condition.values.forEach((function(t,n){a.forEach((function(a,n){a.value===t&&(e.gridApiReportsSel.grid.modifyRows(e.gridOptionsFilters.data),e.gridApiReportsSel.selection.selectRow(e.gridOptionsFilters.data[n]))}))}))}),200)}})}))}},e.gridOptionsConditions.columnDefs=[{field:"logic",displayName:"Logic",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownOptionsArray:[{id:"",value:""},{id:"and",value:"and"},{id:"or",value:"or"}]},{field:"openQu",displayName:"",enableFiltering:!1,enableCellEdit:!1,width:20},{field:"prop",displayName:"Property",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownOptionsArray:[{id:"",value:""},{id:"region",value:"region"},{id:"site_code",value:"site_code"},{id:"site_mode",value:"site_mode"},{id:"site_type",value:"site_type"},{id:"site_type1",value:"site_type1"},{id:"site_type2",value:"site_type2"},{id:"site_type3",value:"site_type3"},{id:"site_type4",value:"site_type4"},{id:"site_type5",value:"site_type5"},{id:"site_type6",value:"site_type6"},{id:"site_type7",value:"site_type7"},{id:"site_type8",value:"site_type8"},{id:"site_type9",value:"site_type9"},{id:"site_type10",value:"site_type10"},{id:"schedule_obs",value:"schedule_obs"},{id:"schedule_status",value:"schedule_status"},{id:"phase",value:"phase"},{id:"cluster",value:"cluster"},{id:"subcontractor",value:"subcontractor"},{id:"site_po",value:"site_po"},{id:"site_engineer",value:"site_engineer"}]},{field:"sign",displayName:"Sign",editableCellTemplate:"ui-grid/dropdownEditor",editDropdownOptionsArray:[{id:"equal",value:"equal"},{id:"not equal",value:"not equal"},{id:"consist",value:"consist"},{id:"not consist",value:"not consist"},{id:"in",value:"in"},{id:"more than",value:"more than"},{id:"less than",value:"less than"},{id:"more than or equal",value:"more than or equal"},{id:"less than or equal",value:"less than or equal"}]},{field:"value",displayName:"Value"},{field:"closeQu",displayName:"",enableFiltering:!1,enableCellEdit:!1,width:20}],t((function(){e.gridOptionsConditions.data=r.conditions}),200),e.ok=function(){Da.initFallDown(n),n.GetHTTPData(),a.dismiss("ok")},e.cancel=function(){a.dismiss("cancel")},e.new=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);r.conditions.splice(t,0,{logic:"",openQu:"",prop:"",sign:"consist",value:"empty",values:[],closeQu:""})}else alert("Nothing selected...!")},e.delete=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);r.conditions.splice(t,1)}else alert("Nothing selected...!")},e.openQu=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);"("===r.conditions[t].openQu?r.conditions[t].openQu="":r.conditions[t].openQu="("}else alert("Nothing selected...!")},e.closeQu=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);")"===r.conditions[t].closeQu?r.conditions[t].closeQu="":r.conditions[t].closeQu=")"}else alert("Nothing selected...!")},e.moveUp=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);t>0&&Da.moveArrayItem(r.conditions,t,t-1)}else alert("Nothing selected...!")},e.moveDown=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){var t=r.conditions.indexOf(e.current_condition);t<r.conditions.length-1&&Da.moveArrayItem(r.conditions,t,t+1)}else alert("Nothing selected...!")},e.refresh=function(){if(e.gridApiConditions.selection.getSelectedRows().length>0){e.current_condition=e.gridApiConditions.selection.getSelectedRows()[0];var a=xa.context+"/data/getAllFilterValues?scope_id="+n.userData.scope.scope_id+"&proj_id="+n.project.proj_id+"&filter_name="+e.current_condition.prop;ka.ajax({url:a,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:s,success:function(a){t((function(){e.gridOptionsFilters.data=a,e.current_condition.values&&e.current_condition.values.length&&e.current_condition.values.forEach((function(t,n){a.forEach((function(a,n){a.value===t&&(e.gridApiReportsSel.grid.modifyRows(e.gridOptionsFilters.data),e.gridApiReportsSel.selection.selectRow(e.gridOptionsFilters.data[n]))}))}))}),200)}})}else alert("Nothing selected...!")}};Sa.$inject=["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants"];const Ca=Sa;var Ta=a("6fe5e339b0f8a936ba8c"),Aa=a("a45670b3d8fb79ec0258"),Pa=function(e,t,a,n,o,i){var r=n.getUserData();e.values=[];var s=JSON.stringify(n.sites_list_in),l=Ta.context+"/data/getAllFilterValues?scope_id="+n.scope.scope_id+"&proj_id="+n.project.proj_id+"&filter_name="+r.filter_name;Aa.ajax({url:l,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:s,success:function(t){e.values=t,e.gridOptions.data=t}}),e.gridOptions={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!0,onRegisterApi:function(t){e.gridApi=t,o((function(){e.gridApi.core.handleWindowResize()}),500,10)},columnDefs:[{field:"value",displayName:"Filter Value"},{field:"sites",displayName:"Sites count",width:"20%",aggregationType:i.aggregationTypes.sum}]},e.ok=function(){var t=e.gridApi.selection.getSelectedRows();a.close(t)},e.cancel=function(){a.dismiss("cancel")}};Pa.$inject=["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants"];const Ea=Pa;var Ia=a("1bf2fbdb051fe0c57024"),Na=function(e,t,a,n,o,i){var r,s,l=n.getUserData();r=""!==l.label&&void 0!==l.label?l.label:l.udf.udf_type_name||l.udf.field_name,e.values=[],e.gridOptions={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!0,onRegisterApi:function(t){e.gridApi=t,o((function(){e.gridApi.core.handleWindowResize()}),500,10)},columnDefs:[{field:"value",displayName:r},{field:"sites",displayName:"Sites count",width:"20%",aggregationType:i.aggregationTypes.sum}]},s=(new Ia).from(l.sites_list_out).groupBy(r).count("site_code").select(),t((function(){e.gridOptions.data=[],s.forEach((function(t){e.gridOptions.data.push({value:t[r],sites:t.site_code})}))}),100),e.ok=function(){var t=e.gridApi.selection.getSelectedRows();a.close(t)},e.cancel=function(){a.dismiss("cancel")}};Na.$inject=["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants"];const Ma=Na;var Oa=a("8deafab7866a125bb9ca"),ja=a("a45670b3d8fb79ec0258"),Ra=function(e,t,a,n,o,r){var s,l;if(a.filename=r.file_name,e.isLoading=!0,e.isLiked=!1,e.likedCount=0,r.likes&&r.likes.length&&(e.likedCount=r.likes.length,r.likes.forEach((function(t){t.username===a.username&&(e.isLiked=!0)}))),!r.no_html_ed&&r.has_html){var c={readOnly:!0,holder:"editorjs",inlineToolbar:["link","marker","bold","italic"],tools:{header:{class:bt.A,inlineToolbar:!0,config:{placeholder:"Header"},shortcut:"CMD+SHIFT+H",tunes:["anyTuneName"]},image:{class:vt.A},domcontainer1:{class:Pt,inlineToolbar:!0,tunes:["anyTuneName"]},list:{class:Et.A,inlineToolbar:!0,config:{defaultStyle:"unordered"}},quote:{class:It.A,inlineToolbar:!0,config:{quotePlaceholder:"Enter a quote",captionPlaceholder:"Quote's author"},shortcut:"CMD+SHIFT+O"},warning:Nt.A,underline:Mt.A,Marker:{class:jt(),config:{defaultColor:"#FFBF00",type:"marker",icon:'<svg fill="#000000" height="200px" width="200px" version="1.1" id="Icons" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M17.6,6L6.9,16.7c-0.2,0.2-0.3,0.4-0.3,0.6L6,23.9c0,0.3,0.1,0.6,0.3,0.8C6.5,24.9,6.7,25,7,25c0,0,0.1,0,0.1,0l6.6-0.6 c0.2,0,0.5-0.1,0.6-0.3L25,13.4L17.6,6z"></path> <path d="M26.4,12l1.4-1.4c1.2-1.2,1.1-3.1-0.1-4.3l-3-3c-0.6-0.6-1.3-0.9-2.2-0.9c-0.8,0-1.6,0.3-2.2,0.9L19,4.6L26.4,12z"></path> </g> <g> <path d="M28,29H4c-0.6,0-1-0.4-1-1s0.4-1,1-1h24c0.6,0,1,0.4,1,1S28.6,29,28,29z"></path> </g> </g></svg>'}},anyTuneName:{class:Lt(),config:{default:"center",blocks:{header:"center",list:"right"}}},code:{class:Ft.A,shortcut:"CMD+SHIFT+C"},delimiter:Ut.A,inlineCode:{class:Bt.A,shortcut:"CMD+SHIFT+C"},linkTool:{class:zt.A,config:{endpoint:"http://localhost:8008/fetchUrl"}},embed:{class:Ht.A,config:{services:{youtube:!0}}},table:{class:qt.A,inlineToolbar:!0,shortcut:"CMD+ALT+T"}},defaultBlock:"paragraph",data:{}};r.editorJson&&(c.data=r.editorJson,e.haveHTMLFrame=!0),new _t.A(c).isReady.then((function(){console.log("Editor.js is ready to work!")})).catch((function(e){console.log("Editor.js initialization failed because of ".concat(e))}))}e.userHasRights=function(e){return r.author&&r.author.indexOf(e)>-1||r.perm&&Oa.objectArrayIndexOf(r.perm,e,0)},e.userIsAuthor=function(e){return r.author&&r.author.indexOf(e)>-1},e.getAdminStatus=function(){return["6237000453"].indexOf(a.username)>-1};var u,d,p;p=r.canvas_width?r.canvas_width:r.has_html?0:6e3,e.report={canvas:{width:p,height:r.canvas_height?r.canvas_height:6e3,auto_width:r.auto_width,auto_height:r.auto_height},report_name:r.report_name,json_content:r.jsonText,has_html:r.has_html,editorJS:r.editorJson,author:r.author,comments:r.comments||[],likes:r.likes,viewer:!0,newComment:""},r.has_html?(e.html_area_size="100%",e.canvas_wrapper_width=e.report.canvas.width):(e.html_area_size="0px",e.canvas_wrapper_width="100%"),e.editor.editorMode=!1,e.bsCurrentClass="container-theme-light",e.bsThemes={available:[{id:"light",name:"Light",icon:"bi-sun-fill"},{id:"dark",name:"Dark",icon:"bi-moon-stars-fill"},{id:"red",name:"Red",icon:"bi-suit-heart-fill"},{id:"green",name:"Green",icon:"bi-tree-fill"},{id:"vintage",name:"Vintage",icon:"bi-card-image"}],current:"",applyTheme:function(t){this.current=t,e.bsCurrentClass="dark"===t?"container-theme-dark":"green"===t?"container-theme-green":"red"===t?"container-theme-red":"vintage"===t?"container-theme-vintage":"container-theme-light"}},e.echartsThemes={available:[{id:"light",name:"Light"},{id:"dark",name:"Dark"},{id:"vintage",name:"Vintage"},{id:"westeros",name:"Westeros"},{id:"wonderland",name:"Wonderland"},{id:"chalk",name:"Chalk"},{id:"macarons",name:"Macarons"},{id:"essos",name:"Essos"},{id:"halloween",name:"Halloween"},{id:"walden",name:"Walden"},{id:"infographic",name:"Infographic"},{id:"roma",name:"Roma"},{id:"purple-passion",name:"Purple-passion"}],current:"",applyTheme:function(t){this.current=t,e.editor.setEchartsTheme(t)}},null!=r&&null!==(s=r.editorJson)&&void 0!==s&&s.bsTheme&&(null===(u=e.bsThemes)||void 0===u||u.applyTheme(r.editorJson.bsTheme)),null!=r&&null!==(l=r.editorJson)&&void 0!==l&&l.echartsTheme&&(null===(d=e.echartsTheme)||void 0===d||d.applyTheme(r.editorJson.echartsTheme)),e.userIsAuthor(a.username)&&t.post(i().context+"/mongo/readComments?file_name="+a.filename+"&username="+a.username+"&proj_id="+a.project_id,null).then((function(e){DEBUG&&console.log("all comments are read")})).catch((function(e){console.log(e.data)})),ja(".fb_select").selectpicker(),window.onbeforeunload=void 0};Ra.$inject=["$scope","$rootScope","$stateParams","$timeout","report_json"];const La=Ra;var Fa=a("8deafab7866a125bb9ca"),Ua=a("a45670b3d8fb79ec0258");function Ba(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return za(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(za(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,za(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,za(d,"constructor",c),za(c,"constructor",l),l.displayName="GeneratorFunction",za(c,o,"GeneratorFunction"),za(d),za(d,o,"Generator"),za(d,n,(function(){return this})),za(d,"toString",(function(){return"[object Generator]"})),(Ba=function(){return{w:i,m:p}})()}function za(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}za=function(e,t,a,n){function i(t,a){za(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},za(e,t,a,n)}function Ha(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function qa(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){Ha(i,n,o,r,s,"next",e)}function s(e){Ha(i,n,o,r,s,"throw",e)}r(void 0)}))}}a("d3949897a1eac25025cc");var Va=function(e,t,n,o){n.filename=o.file_name,e.isLoading=!0,e.isLiked=!1,e.likedCount=0,o.likes&&o.likes.length&&(e.likedCount=o.likes.length,o.likes.forEach((function(t){t.username===n.username&&(e.isLiked=!0)}))),e.userHasRights=function(e){return o.author&&o.author.indexOf(e)>-1||o.perm&&Fa.objectArrayIndexOf(o.perm,e,0)},e.userIsAuthor=function(e){return o.author&&o.author.indexOf(e)>-1},e.userIsAuthor(n.username)&&t.post(i().context+"/mongo/readComments?file_name="+n.filename+"&username="+n.username+"&proj_id="+n.project_id,null).then((function(e){DEBUG&&console.log("all comments are read")})).catch((function(e){console.log(e.data)})),Ua(".fb_select").selectpicker(),a("360a0beb990246ecb729").ImportMapper,e.run_code=qa(Ba().m((function t(){var a,n,i;return Ba().w((function(t){for(;;)switch(t.n){case 0:try{if(a=document.getElementById("html-container"),o.jsonText.base_html&&a&&(a.innerHTML=Xt.A.sanitize(o.jsonText.base_html,{USE_PROFILES:{html:!0}}),o.jsonText.base_css&&Fa.injectStyles(o.jsonText.base_css),o.jsonText.module_js)){n=o.jsonText.module_js;try{(i=Fa.safeEval(n,null)).success||console.log(i.error)}catch(e){console.error(e)}}}catch(t){e.isLoading=!1,document.getElementById("html-container").innerHTML=t.message}case 1:return t.a(2)}}),t)}))),e.run_code(),window.onbeforeunload=void 0};Va.$inject=["$scope","$http","$rootScope","report_json"];const Wa=Va;var Ga=function(e,t,a,n,o,i,r,s,l){if(e.item={},e.item.spec=i.userData.spec,e.item.author=t.username,r){var c=r;e.capture="Edit Vega Library Item",e.item.description=c.description,e.item.recipe_name=c.recipe_name,e.item.example=c.example,e.item.public=c.public,e.item._id=c._id,e.item.group_name=c.group_name,e.item.data_type=c.data_type,e.item.version=c.version+1}else e.capture="Vega Library New Item",e.item.version=1;var u=new Blob([i._svg],{type:"image/svg+xml"}),d=URL.createObjectURL(u);e.item.thumbnail=d,e.ok=function(){e.item.thumbnail=i._svg,o.close(e.item)},e.cancel=function(){o.dismiss("cancel")}};Ga.$inject=["$scope","$rootScope","$timeout","$http","$uibModalInstance","figure","edit","$interval","uiGridConstants"];const Ja=Ga;var Qa=function(e,t,a,n,o,r,s,l,c){r.forEach((function(e){var t=new Blob([e.thumbnail],{type:"image/svg+xml"}),a=URL.createObjectURL(t);e.thumbnail=a})),e.rows=[],e.makeRows=function(){var t,a=0;e.rows=[],r.forEach((function(n,o){0===a?((t=[]).push(n),a++,o===r.length-1&&e.rows.push(structuredClone(t))):a<2?(t.push(n),a++,o===r.length-1&&e.rows.push(structuredClone(t))):(a=0,t.push(n),e.rows.push(structuredClone(t)))}))},e.makeRows(),e.openExample=function(e){l.open(e,"_blank")},e.selectItem=function(e){n.close(e)},e.confirmOwner=function(e){return e.author===t.username},e.deleteItem=function(t){var a,n,o;confirm("Are you sure you want to delete this Library Item?")&&(r.splice((a=r,n=t._id,o=-1,a.forEach((function(e,t){e._id===n&&(o=t)})),o),1),e.makeRows(),e.get_items=c.get(i().context+"/mongo/deleteVegaLibItem?item_id="+t._id).then((function(e){DEBUG&&console.log(e)}),(function(e){})))},e.items=r,e.ok=function(){n.dismiss("ok")},e.cancel=function(){n.dismiss("cancel")}};Qa.$inject=["$scope","$rootScope","$timeout","$uibModalInstance","figure","items","$interval","$window","$http"];const Ya=Qa;var Xa=function(e,t,a,n,o,r,s,l,c,u,d,p){if(e.item={},e.item.code=c,e.item.author=t.username,e.item.node_type=l,e.item.property_name=s,e.item.tags=[],u){var h=u;e.capture="Edit Node Library Item",e.item.description=h.description,e.item.name=h.name,e.item.public=h.public,e.item._id=h._id,e.item.tags=h.tags||[],e.item.version=h.version+1}else e.capture="Save Code to Library",e.item.version=1;var f=null;a((function(){if(window.ace){(f=ace.edit("codePreview")).setReadOnly(!1),f.setTheme("ace/theme/monokai");var t={do:"javascript",sql:"sql",html:"html",spec:"json",config:"json"}[s]||"javascript";f.session.setMode("ace/mode/".concat(t)),f.setValue(e.item.code),f.clearSelection(),f.session.on("change",(function(){e.item.code=f.getValue()}))}}),100),e.newTag="",e.addTag=function(){e.newTag&&!e.item.tags.includes(e.newTag)&&(e.item.tags.push(e.newTag),e.newTag="")},e.removeTag=function(t){var a=e.item.tags.indexOf(t);a>-1&&e.item.tags.splice(a,1)},e.ok=function(){if(e.item.name&&e.item.description){var t=u?"".concat(i().context,"/mongo/updateNodeLibItem?item_id=").concat(e.item._id):"".concat(i().context,"/mongo/createNodeLibItem");n.post(t,e.item).then((function(t){console.log("Node library item saved successfully",t.data),o.close(e.item)})).catch((function(e){console.error("Error saving node library item:",e),alert("Error saving item. Please try again.")}))}else alert("Please provide both name and description")},e.cancel=function(){o.dismiss("cancel")}};Xa.$inject=["$scope","$rootScope","$timeout","$http","$uibModalInstance","figure","property","nodeType","currentCode","edit","$interval","uiGridConstants"];const Ka=Xa;var Za=function(e,t,a,n,o,r,s,l,c,u,d){e.items=l,e.selectedItem=null,e.searchText="",e.nodeType=s,e.property=r,e.items.sort((function(e,t){return t.usage_count!==e.usage_count?t.usage_count-e.usage_count:new Date(t.updated_at)-new Date(e.updated_at)}));var p=null,h=function(){a((function(){if(window.ace&&document.getElementById("nodeLibCodePreview")){if(!p){(p=ace.edit("nodeLibCodePreview")).setReadOnly(!0),p.setTheme("ace/theme/monokai");var t={do:"javascript",sql:"sql",html:"html",spec:"json",config:"json"}[r]||"javascript";p.session.setMode("ace/mode/".concat(t)),p.setOptions({fontSize:"14px",showGutter:!0,showPrintMargin:!1,highlightActiveLine:!0,enableBasicAutocompletion:!1,enableLiveAutocompletion:!1})}e.selectedItem&&e.selectedItem.code&&(p.setValue(e.selectedItem.code),p.clearSelection(),p.gotoLine(1))}}),200)};e.selectItem=function(t){e.selectedItem=t,p?t&&t.code&&a((function(){p.setValue(t.code),p.clearSelection(),p.gotoLine(1)}),50):h()},e.loadItem=function(){e.selectedItem&&(d.post("".concat(i().context,"/mongo/incrementNodeLibUsage?item_id=").concat(e.selectedItem._id)).then((function(){console.log("Usage count incremented")})).catch((function(e){console.error("Error incrementing usage count:",e)})),n.close(e.selectedItem))},e.isOwner=function(e){return e.author===t.username},e.editItem=function(t){e.isOwner(t)&&n.close({action:"edit",item:t})},e.deleteItem=function(t){e.isOwner(t)&&confirm('Are you sure you want to delete "'.concat(t.name,'"?'))&&d.get("".concat(i().context,"/mongo/deleteNodeLibItem?item_id=").concat(t._id)).then((function(a){console.log("Item deleted:",a.data);var n=e.items.indexOf(t);n>-1&&e.items.splice(n,1),e.selectedItem===t&&(e.selectedItem=null,p&&p.setValue(""))})).catch((function(e){console.error("Error deleting item:",e),alert("Error deleting item. Please try again.")}))},e.filterItems=function(t){if(!e.searchText)return!0;var a=e.searchText.toLowerCase();return t.name.toLowerCase().includes(a)||t.description.toLowerCase().includes(a)||t.tags&&t.tags.some((function(e){return e.toLowerCase().includes(a)}))},e.formatDate=function(e){var t=new Date(e),a=new Date,n=a-t,o=Math.floor(n/864e5);if(0===o){var i=t.getHours(),r=t.getMinutes(),s=i>=12?"PM":"AM";return"Today ".concat(i%12||12,":").concat(r.toString().padStart(2,"0")," ").concat(s)}return 1===o?"Yesterday":o<7?"".concat(o," days ago"):t.getFullYear()===a.getFullYear()?"".concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()]," ").concat(t.getDate()):"".concat(t.getMonth()+1,"/").concat(t.getDate(),"/").concat(t.getFullYear())},e.items.length>0&&a((function(){e.selectItem(e.items[0])}),300),e.$watch("selectedItem",(function(e){e&&!p&&h()})),e.cancel=function(){n.dismiss("cancel")}};Za.$inject=["$scope","$rootScope","$timeout","$uibModalInstance","figure","property","nodeType","items","$interval","$window","$http"];const $a=Za;var en=a("8deafab7866a125bb9ca"),tn=a("a45670b3d8fb79ec0258"),an=function(e,t,a){e.loading=!1,e.stats=null,e.branchExport=null,e.componentExport=null,e.importStatus=null,e.importFile=null,e.importType="both",e.exportLimit=1e3,e.showAdvanced=!1,e.searchCollection="functional_branches",e.searchQuery="",e.searchLimit=10,e.searchThreshold=.5,e.searchResults=null,e.searchPerformed=!1,e.selectedSearchItem=null,e.selectedSearchIndex=-1,e.filterCollection="functional_branches",e.filterLimit=50,e.filterOffset=0,e.filterResults=null,e.filterPerformed=!1,e.selectedFilterItem=null,e.selectedFilterIndex=-1,e.filterQueryJson='{\n  "must": [\n    {\n      "key": "id",\n      "match": {\n        "any": ["sample_id"]\n      }\n    }\n  ]\n}';var n=i().context+"/qdrant",o=null,r=null,s=null;function l(){if(document.getElementById("filter-query-editor"))try{r?r.setValue(e.filterQueryJson):((r=ace.edit("filter-query-editor")).setTheme("ace/theme/monokai"),r.getSession().setMode("ace/mode/json"),r.setValue(e.filterQueryJson),r.getSession().on("change",(function(){e.filterQueryJson=r.getValue()})))}catch(e){console.error("Error initializing filter query editor:",e)}if(document.getElementById("filter-results-editor"))try{s||((s=ace.edit("filter-results-editor")).setTheme("ace/theme/monokai"),s.getSession().setMode("ace/mode/json"),s.setReadOnly(!0),console.log("Filter results editor initialized"))}catch(e){console.error("Error initializing filter results editor:",e)}}function c(){if(document.getElementById("search-results-editor"))try{o||((o=ace.edit("search-results-editor")).setTheme("ace/theme/monokai"),o.getSession().setMode("ace/mode/json"),o.setReadOnly(!0),console.log("Search results editor initialized"))}catch(e){console.error("Error initializing search results editor:",e)}}e.refreshStats=function(){e.loading=!0,t.get("".concat(n,"/statistics")).then((function(t){e.stats=t.data.statistics,e.loading=!1,console.log("Qdrant statistics:",e.stats)})).catch((function(t){var a;console.error("Error fetching Qdrant statistics:",t),en.bsToast.error({title:"Error",message:"Failed to fetch Qdrant statistics: "+((null===(a=t.data)||void 0===a?void 0:a.error)||t.statusText||"Unknown error"),timeout:5e3}),e.loading=!1}))},e.deleteCollection=function(a){a&&confirm('Are you sure you want to delete the "'.concat(a,'" collection? This action cannot be undone.'))&&(e.loading=!0,t.delete("".concat(n,"/collection/").concat(a)).then((function(t){en.bsToast.success({title:"Success",message:'Collection "'.concat(a,'" deleted successfully.'),timeout:3e3}),e.refreshStats()})).catch((function(t){var n;console.error('Error deleting collection "'.concat(a,'":'),t),en.bsToast.error({title:"Error",message:"Failed to delete collection: "+((null===(n=t.data)||void 0===n?void 0:n.error)||t.statusText||"Unknown error"),timeout:5e3}),e.loading=!1})))},e.deleteAllCollections=function(){confirm("Are you sure you want to delete ALL collections? This action cannot be undone and will remove all functional branches and granular components.")&&confirm("FINAL WARNING: This will permanently delete ALL your Qdrant collections. Are you absolutely sure?")&&(e.loading=!0,t.delete("".concat(n,"/collections")).then((function(t){var a=t.data.results;en.bsToast.success({title:"Success",message:"Deleted ".concat(a.deleted," collections (").concat(a.failed," failed)."),timeout:3e3}),e.refreshStats()})).catch((function(t){var a;console.error("Error deleting all collections:",t),en.bsToast.error({title:"Error",message:"Failed to delete collections: "+((null===(a=t.data)||void 0===a?void 0:a.error)||t.statusText||"Unknown error"),timeout:5e3}),e.loading=!1})))},e.exportBranches=function(){e.branchExport=null,e.loading=!0,t.get("".concat(n,"/export-branches"),{params:{limit:e.exportLimit}}).then((function(t){e.branchExport=t.data,e.loading=!1,e.branchExport.count>0?en.bsToast.success({title:"Success",message:"Exported ".concat(e.branchExport.count," functional branches."),timeout:3e3}):en.bsToast.info({title:"Info",message:"No functional branches found to export.",timeout:3e3})})).catch((function(t){var a;console.error("Error exporting branches:",t),en.bsToast.error({title:"Error",message:"Failed to export branches: "+((null===(a=t.data)||void 0===a?void 0:a.error)||t.statusText||"Unknown error"),timeout:5e3}),e.loading=!1}))},e.exportComponents=function(){e.componentExport=null,e.loading=!0,t.get("".concat(n,"/export-components"),{params:{limit:e.exportLimit}}).then((function(t){e.componentExport=t.data,e.loading=!1,e.componentExport.count>0?en.bsToast.success({title:"Success",message:"Exported ".concat(e.componentExport.count," granular components."),timeout:3e3}):en.bsToast.info({title:"Info",message:"No granular components found to export.",timeout:3e3})})).catch((function(t){var a;console.error("Error exporting components:",t),en.bsToast.error({title:"Error",message:"Failed to export components: "+((null===(a=t.data)||void 0===a?void 0:a.error)||t.statusText||"Unknown error"),timeout:5e3}),e.loading=!1}))},e.exportToFile=function(){var t={metadata:{date:(new Date).toISOString(),version:"1.0",source:window.location.hostname},branches:e.branchExport?e.branchExport.items:[],components:e.componentExport?e.componentExport.items:[]},a=JSON.stringify(t,null,2),n="data:application/json;charset=utf-8,"+encodeURIComponent(a),o="qdrant-export-".concat((new Date).toISOString().slice(0,10),".json"),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download",o),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),en.bsToast.success({title:"Export Complete",message:"Data exported to ".concat(o),timeout:3e3})},e.handleFileInput=function(t){e.importFile=t.target.files[0],e.$apply()},e.importFromFile=function(){if(e.importFile){e.loading=!0,e.importStatus={inProgress:!0,message:"Reading file..."};var a=new FileReader;a.onload=function(a){try{var o=JSON.parse(a.target.result);if(!o.branches&&!o.components)throw new Error("Invalid import file format. Missing branches or components data.");e.importStatus.message="Processing import...",function(a){return new Promise((function(o,i){if("components-only"===e.importType||!a.branches||0===a.branches.length)return o();e.importStatus.message="Importing ".concat(a.branches.length," branches..."),e.$apply(),t.post("".concat(n,"/import-branches"),{items:a.branches}).then((function(t){console.log("Branches import response:",t.data),e.importStatus.branchesResult=t.data,o()})).catch((function(e){var t;console.error("Error importing branches:",e),i(new Error("Failed to import branches: "+((null===(t=e.data)||void 0===t?void 0:t.error)||e.statusText||"Unknown error")))}))}))}(o).then((function(){return function(a){return new Promise((function(o,i){if("branches-only"===e.importType||!a.components||0===a.components.length)return o();e.importStatus.message="Importing ".concat(a.components.length," components..."),e.$apply(),t.post("".concat(n,"/import-components"),{items:a.components}).then((function(t){console.log("Components import response:",t.data),e.importStatus.componentsResult=t.data,o()})).catch((function(e){var t;console.error("Error importing components:",e),i(new Error("Failed to import components: "+((null===(t=e.data)||void 0===t?void 0:t.error)||e.statusText||"Unknown error")))}))}))}(o)})).then((function(){e.loading=!1,e.importStatus={inProgress:!1,success:!0,message:"Import completed successfully."},e.refreshStats(),e.$apply()})).catch((function(t){console.error("Import error:",t),e.loading=!1,e.importStatus={inProgress:!1,success:!1,message:"Error during import: "+t.message},e.$apply()}))}catch(t){console.error("Error parsing import file:",t),e.loading=!1,e.importStatus={inProgress:!1,success:!1,message:"Failed to parse import file: "+t.message},e.$apply()}},a.onerror=function(){console.error("Error reading file"),e.loading=!1,e.importStatus={inProgress:!1,success:!1,message:"Failed to read import file."},e.$apply()},a.readAsText(e.importFile)}else en.bsToast.error({title:"Error",message:"Please select a file to import.",timeout:3e3})},e.toggleAdvanced=function(){e.showAdvanced=!e.showAdvanced},e.searchCollectionByPhrase=function(){if(e.searchQuery&&e.searchQuery.trim()){e.loading=!0,e.searchPerformed=!0;var i="functional_branches"===e.searchCollection?"".concat(n,"/functional-branch/search"):"".concat(n,"/granular/search"),r={query:e.searchQuery.trim(),limit:parseInt(e.searchLimit),score_threshold:parseFloat(e.searchThreshold)};t.post(i,r).then((function(t){e.searchResults=t.data,e.loading=!1,e.searchResults&&e.searchResults.length>0?(a((function(){e.showItemDetails(0)}),100),en.bsToast.success({title:"Search Completed",message:"Found ".concat(e.searchResults.length," matching items."),timeout:3e3})):(en.bsToast.info({title:"Search Completed",message:"No matching items found.",timeout:3e3}),o&&o.setValue("// No results found"))})).catch((function(t){var a;console.error("Error searching collection:",t),e.loading=!1,en.bsToast.error({title:"Search Error",message:"Failed to search collection: "+((null===(a=t.data)||void 0===a?void 0:a.error)||t.statusText||"Unknown error"),timeout:5e3})}))}else en.bsToast.error({title:"Error",message:"Please enter a search query.",timeout:3e3})},e.showItemDetails=function(t){if(e.searchResults&&e.searchResults[t]){e.selectedSearchItem=e.searchResults[t],e.selectedSearchIndex=t;var n=JSON.stringify(e.selectedSearchItem,null,2);a((function(){if(!o&&document.getElementById("search-results-editor"))try{(o=ace.edit("search-results-editor")).setTheme("ace/theme/monokai"),o.getSession().setMode("ace/mode/json"),o.setReadOnly(!0),console.log("Search results editor initialized on demand")}catch(e){console.error("Error initializing search results editor:",e)}o?(o.setValue(n),o.clearSelection(),o.scrollToLine(0),o.gotoLine(1)):(console.error("Search results editor not available"),alert("Editor not available. JSON data: "+n.substring(0,200)+"..."))}),50)}},e.applyAdvancedFilter=function(){var o;try{if(!r&&document.getElementById("filter-query-editor"))try{(r=ace.edit("filter-query-editor")).setTheme("ace/theme/monokai"),r.getSession().setMode("ace/mode/json"),r.setValue(e.filterQueryJson),console.log("Filter query editor initialized on demand")}catch(e){console.error("Error initializing filter query editor:",e)}var i=r?r.getValue():e.filterQueryJson;o=JSON.parse(i)}catch(e){return void en.bsToast.error({title:"Filter Error",message:"Invalid JSON filter query: "+e.message,timeout:5e3})}e.loading=!0,e.filterPerformed=!0;var l="".concat(n,"/").concat(e.filterCollection,"/scroll"),c={filter:o,limit:parseInt(e.filterLimit),offset:parseInt(e.filterOffset),with_payload:!0,with_vector:!1};t.post(l,c).then((function(t){e.filterResults=t.data.points||[],e.loading=!1,e.filterResults&&e.filterResults.length>0?(a((function(){e.showFilterItemDetails(0)}),100),en.bsToast.success({title:"Filter Applied",message:"Found ".concat(e.filterResults.length," matching items."),timeout:3e3})):(en.bsToast.info({title:"Filter Applied",message:"No matching items found.",timeout:3e3}),s&&s.setValue("// No results found"))})).catch((function(t){var a;console.error("Error applying filter:",t),e.loading=!1,en.bsToast.error({title:"Filter Error",message:"Failed to apply filter: "+((null===(a=t.data)||void 0===a?void 0:a.error)||t.statusText||"Unknown error"),timeout:5e3})}))},e.showFilterItemDetails=function(t){if(e.filterResults&&e.filterResults[t]){e.selectedFilterItem=e.filterResults[t],e.selectedFilterIndex=t;var n=JSON.stringify(e.selectedFilterItem,null,2);a((function(){if(!s&&document.getElementById("filter-results-editor"))try{(s=ace.edit("filter-results-editor")).setTheme("ace/theme/monokai"),s.getSession().setMode("ace/mode/json"),s.setReadOnly(!0),console.log("Filter results editor initialized on demand")}catch(e){console.error("Error initializing filter results editor:",e)}s?(s.setValue(n),s.clearSelection(),s.scrollToLine(0),s.gotoLine(1)):(console.error("Filter results editor not available"),alert("Editor not available. JSON data: "+n.substring(0,200)+"..."))}),50)}},e.deleteFilteredItem=function(a){if(e.filterResults&&e.filterResults[a]){var o=e.filterResults[a].id,i=e.filterCollection;confirm('Are you sure you want to delete the item with ID "'.concat(o,'"? This action cannot be undone.'))&&(e.loading=!0,t.post("".concat(n,"/").concat(i,"/delete"),{points:[o],wait:!0}).then((function(t){if(e.filterResults.splice(a,1),e.loading=!1,en.bsToast.success({title:"Success",message:"Item ".concat(o," deleted successfully."),timeout:3e3}),0===e.filterResults.length)s&&s.setValue("// No results remaining");else{var n=a<e.filterResults.length?a:e.filterResults.length-1;e.showFilterItemDetails(n)}})).catch((function(t){var a;console.error("Error deleting item ".concat(o,":"),t),e.loading=!1,en.bsToast.error({title:"Deletion Error",message:"Failed to delete item: "+((null===(a=t.data)||void 0===a?void 0:a.error)||t.statusText||"Unknown error"),timeout:5e3})})))}},e.confirmBulkDelete=function(){if(e.filterResults&&0!==e.filterResults.length){var a=e.filterResults.length,o=e.filterCollection;if(confirm("Are you sure you want to delete ALL ".concat(a," filtered items? This action cannot be undone."))&&confirm("FINAL WARNING: This will permanently delete ".concat(a," items from the ").concat(o," collection. Are you absolutely sure?"))){e.loading=!0;var i=e.filterResults.map((function(e){return e.id}));t.post("".concat(n,"/").concat(o,"/delete"),{points:i,wait:!0}).then((function(t){e.filterResults=[],e.loading=!1,en.bsToast.success({title:"Bulk Deletion Complete",message:"Successfully deleted ".concat(a," items from ").concat(o,"."),timeout:3e3}),s&&s.setValue("// All filtered items have been deleted")})).catch((function(t){var a;console.error("Error performing bulk deletion:",t),e.loading=!1,en.bsToast.error({title:"Bulk Deletion Error",message:"Failed to delete items: "+((null===(a=t.data)||void 0===a?void 0:a.error)||t.statusText||"Unknown error"),timeout:5e3})}))}}},e.refreshStats(),"undefined"==typeof ace&&(console.error("Ace.js editor is not loaded. Some features will be disabled."),en.bsToast.warning({title:"Warning",message:"Ace.js editor is not loaded. Some features may not work properly.",timeout:5e3})),a((function(){l(),c(),tn("#nav-search-tab").on("shown.bs.tab",(function(e){c()})),tn("#nav-filter-tab").on("shown.bs.tab",(function(e){l()}))}),300)};an.$inject=["$scope","$http","$timeout"];const nn=an;function on(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var rn='\nA. Data Acquisition Nodes\n1.    Project Node (node_class_name: draw2d.shape.fishbone.cell.Projectnode_api)\no     Purpose: Top-level entity; starting point for all reports.\no     Key Properties: proj_id, proj_name, proj_code. Crucial: At least one of key properties has to be extructed from user prompt.\no     Data: Passes its properties downstream.\n\n2.     DU Model Node (node_class_name: draw2d.shape.fishbone.cell.DUModelnode_api)\no     Purpose: Represents a Delivery Unit model within a project, containing a list of Delivery Units (DUs).\no     Key Properties: du_model_id, du_model_name.\nData Fields: See sample data structure:\n{\n            "proj_id": "87ae0fae-ae5f-2449-901c-c2743c253088",\n            "product_domain": "Wireless RAN",\n            "du_model_name": "5G Survey",\n            "du_model_id": "2783788536911550150",\n            "site_code": "DERE",\n            "site_id": "a07327832d15d409237a913136d12377",\n            "region": "Central",\n            "du_code": "DU00004316500",\n            "du_name": "Wireless RAN/5G Survey/DERE",\n            "du_id": "8728553282148077252",\n            "du_status": "ENABLED",\n            "phase_code": "Batch 3 - 1500",\n            "cluster": "",\n            "site_model_name": "Wireless RAN",\n            "longitude": "101.69",\n            "latitude": "3.10479",\n            "state": "Kuala Lumpur"\no             },\n\n3.     Task (Activity) Node (node_class_name: draw2d.shape.fishbone.cell.Datanode)\no     Purpose: Retrieves data for a single specific task/activity related to DUs.\no     Key Properties: scope_task_code, scope_task_name, scope_task_id.\no     Connection: STRICTLY Connected to a DU Model Node or data derived from it.\no     Constraint: Must represent only ONE task. Multiple tasks require multiple Task Nodes. (e.g., scope_task_name: "Task A, Task B" is invalid).\no     Default Filter: Retrieves \'Completed\' tasks unless specified otherwise (the user request implies \'Completed\').\nKey Data Fields: See provided sample structure:\n{\n            "du_id": "162711712924778595",\n            "site_id": "18b0c8795194c780c21d84fba42ed86f",\n            "du_code": "DU00004420318",\n            "site_code": "SSGB",\n            "my_date": "2024-11-28 00:00:00",\n            "status": "Completed",\n            "obs_name": "null",\n            "responsible_user_en": "MUHAMMAD KHAIRUL NAZMIN BIN YAAKOB",\n            "responsible_user_cn": "MUHAMMAD KHAIRUL NAZMIN BIN YAAKOB",\n            "assign_flag": "N",\n            "problem_type": "null",\n            "remark": "null",\n            "scope_task_name": "Site Survey",\n            "scope_task_code": "AC0000141889",\n            "du_model_name": "5G Survey",\n            "du_model_id": "2783788536911550150",\n            "proj_id": "87ae0fae-ae5f-2449-901c-c2743c253088",\n            "region": "Eastern",\n            "phase_code": "New Proposed"\n        }\no     \n\n4.     DU Custom Field Node (node_class_name: draw2d.shape.fishbone.cell.CustomFieldnode)\no     Purpose: Retrieves user-defined field data associated with DUs.\no     Key Properties: field_code, field_name.\no     Connection: STRICTLY Connected to a DU Model Node or data derived from it.\nKey Data Fields: died, field_name, [value], etc. See provided sample for full structure:\n{\n            "proj_id": "87ae0fae-ae5f-2449-901c-c2743c253088",\n            "site_id": "f4e4ee65dce034237093342c69c6d4b3",\n            "site_code": "ANDE",\n            "du_id": "4747361259506909980",\n            "du_code": "DU00004226820",\n            "du_name": "Wireless RAN/5G Survey/ANDE",\n            "du_model_name": "5G Survey",\n            "field_code": "ZDCSZ00918525",\n            "field_name": "TSS Subcon",\n            "field_owner": "",\n            "value": "NR"\n        },\no     \n\nB. Data Manipulation Nodes\n1.     AlaSQL Node (node_class_name: draw2d.shape.fishbone.cell.SQLnode) \no     Purpose: Performs basic data selection and joining operations using AlaSQL.js library.\no     Key Property: sql (contains the SQL query string).\no     SQL Syntax Rules:\n    STRICTLY follow Alasql.js documentation and requirements below. \n     Use SELECT statements only.\n     Only perform SELECT and JOIN operations in this node.\n     For all other operations (grouping, sorting, filtering, etc.), use the Transform node.\n     ? Placeholder: Represents data input from connected nodes in sequential order. Must be used in FROM or JOIN clauses (e.g., FROM ? AS a JOIN ? AS b ...).\n     Bracket Notation []: MANDATORY for field names that are SQL keywords (e.g., [value]) or contain spaces (e.g., [Subcon TI]).\n     Tables Aliases: Use short (1-3 chars), non-keyword aliases for tables (e.g., FROM ? AS a). \n     Fields Aliases: \n     - ALWAYS use [] for fields aliases\n     - NEVER use SQL keywords, special words, or function names like "count", "sum", "date", "id", "name", "value", "group", "order", "key", "type", "from", "select", "as", "where", "by", "having", "min", "max", "avg" as field aliases\n     - Always prefix these with a descriptive word, such as "task_count", "region_sum", "survey_date", "customer_id", etc\n     - This rule applies in all contexts including column aliases after SELECT, CASE statements, and computed fields\n     - Examples of prohibited aliases: "count", "date", "id"\n     - Examples of valid aliases: "task_count", "survey_date", "customer_id"\n     Explicit Columns: Always specify column names after SELECT (avoid SELECT * unless trivial).\n     Joins: Clearly define JOIN conditions using appropriate fields.\n     Supported join types:\n        [INNER JOIN](Inner Join)\n        [LEFT [OUTER] JOIN](Left Join)\n        [RIGHT [OUTER] JOIN](Right Join)\n        [[FULL] OUTER JOIN](Outer Join)\n        [ANTI JOIN](Anti Join)\n        [SEMI JOIN](Semi Join)\n        [CROSS JOIN](Cross Join)\n        [NATURAL JOIN](Natural Join)\n2.     Union Node (node_class_name: draw2d.shape.fishbone.cell.Unionnode) \no     Purpose: Combine connected datasets in one by using SQL "UNION ALL" statement. Use it when you need to combine same structure datasets into one.\no     Key Property: does  not require any configuration.\n\n3.     Transform Node (node_class_name: draw2d.shape.fishbone.cell.Transformnode) \no     Purpose: Primary data manipulation solution for all operations beyond basic selection and joining. Handles grouping, accumulation, sorting, filtering, impute, and other data transformations according to Vega.js transforms documentation.\no     Key Property: \n        - transform: vega spec transform array.\no   Requirements: Include only transform array without any other component of Vega configuration JSON\no   Connection Constraint: Transform node can have only one input  connection. Multiple input connections are not allowed.\no   Data Source Scope: All transforms operate *exclusively* on the single data stream provided by the input connection (implicitly named "table"). Expressions referencing other data sources (e.g., `data(\'another_source\')`) or the own input source (e.g., `data(\'table\')`) are **strictly forbidden**. Use `datum` to access fields within the current data record.\no   Signal Prohibition: The use or reference of Vega signals within the \'transform\' array is **strictly forbidden**. Transforms must operate solely on the input data stream.\no   Preferred Data Manipulation Solution:\n     - Use Transform node as the primary tool for all data manipulation operations\n     - Combine multiple transformations in the same node when logically related\n     - Operations that should be performed in Transform node (not SQL node):\n       * Grouping and aggregation (using "aggregate" transform)\n       * Sorting (using "collect" transform with "sort" property)\n       * Filtering (using "filter" transform)\n       * Imputation of missing values (using "impute" transform)\n       * Pivoting data (using "pivot" transform)\n       * Window calculations and running totals (using "window" transform)\n       * Binning numeric values (using "bin" transform)\n       * Formula calculations (using "formula" transform)\n       * Data sampling (using "sample" transform)\n     - For complex data flows, chain multiple Transform nodes together\no  Eeamples of different operations:\n        "aggregate" (for grouping and summarizing):\n                {\n                "type": "aggregate",\n                "groupby": ["region"],\n                "fields": ["du_id", "value"],\n                "ops": ["count", "sum"],\n                "as": ["region_count", "region_total"]\n                },\n        "aggregate" (Example for min/max):\n                {\n                  "type": "aggregate",\n                  "fields": ["value", "value"], // Field to find min/max for\n                  "ops": ["min", "max"],        // Operations\n                  "as": ["min_value", "max_value"] // Output field names\n                }\n        **CRITICAL RULE for Aggregate:** The number of elements in the \'fields\' array MUST match the number of elements in the \'ops\' array. Each operation in \'ops\' corresponds to the field at the same index in \'fields.\n        *Correct Example:*\n          {\n            "type": "aggregate",\n            "fields": ["weekly_count", "weekly_count", "weekly_count"], // Length 3\n            "ops": ["sum", "max", "min"],                               // Length 3\n            "as": ["total_count", "max_weekly_count", "min_weekly_count"]\n          }\n        *Incorrect Example (lengths mismatch):*\n          {\n            "type": "aggregate",\n            "fields": ["weekly_count"], // Length 1\n            "ops": ["sum", "max", "min"], // Length 3 - ERROR!\n            "as": ["total_count", "max_weekly_count", "min_weekly_count"]\n          }\n        \n        "Valid Vega-Lite aggregation operations for the \'ops\' array":\n                - count: Total count of data objects.\n                - valid: Count of non-null, non-NaN values.\n                - missing: Count of null or NaN values.\n                - distinct: Count of distinct values.\n                - sum: Sum of values.\n                - mean: Average (mean) of values.\n                - average: Alias for mean. (using "avg" is strictly forbidden)\n                - variance: Sample variance.\n                - variancep: Population variance.\n                - stdev: Sample standard deviation.\n                - stdevp: Population standard deviation.\n                - stderr: Standard error of the mean.\n                - median: Median value.\n                - q1: First quartile (25th percentile).\n                - q3: Third quartile (75th percentile).\n                - ci0: Lower boundary of 95% confidence interval.\n                - ci1: Upper boundary of 95% confidence interval.\n                - min: Minimum value.\n                - max: Maximum value.\n                - argmin: Input data object corresponding to the minimum value.\n                - argmax: Input data object corresponding to the maximum value.\n        \n        "collect" (for sorting):\n                {\n                "type": "collect",\n                "sort": {"field": "region_count", "order": "descending"}\n                }\n        \n        "filter" (for filtering data):\n                {\n                "type": "filter",\n                "expr": "datum.status == \'Completed\'"\n                }\n        \n        "formula" (for calculated fields):\n                {\n                "type": "formula",\n                "expr": "datum.value / datum.total * 100",\n                "as": "percentage"\n                }\n                \n        "timeFormat" (for extracting date components):\n                {\n                "type": "formula",\n                "expr": "timeFormat(datum.my_date, \'%Y-W%U\')",\n                "as": "week"\n                }\n                \n        "Common timeFormat patterns":\n                - \'%Y-W%U\': Year-Week (e.g., 2024-W01)\n                - \'%Y-%m\': Year-Month (e.g., 2024-01)\n                - \'%Y-%m-%d\': Year-Month-Day (e.g., 2024-01-15)\n                - \'%b %Y\': Month Year (e.g., Jan 2024)\n        \n        "pivot" (for reshaping data):\n                {\n                "type": "pivot",\n                "groupby": ["country"],\n                "field": "type",\n                "value": "count"\n                }\n        produces the output:\n                [\n                {"country": "Norway",  "gold": 14, "silver": 14, "bronze": 11},\n                {"country": "Germany", "gold": 14, "silver": 10, "bronze":  7},\n                {"country": "Canada",  "gold": 11, "silver":  8, "bronze": 10},\n                ]\n        \n        "window" (for running totals and accumulation):\n                {\n                "type": "window",\n                "groupby": ["category"],\n                "sort": {\n                    "field": "week"\n                },\n                "fields": ["total_cnt"],\n                "ops": ["sum"],\n                "as": ["cumulative"]\n                }\n        \n        "impute" (for filling missing values):\n                {\n                "type": "impute",\n                "field": "value",\n                "key": "date",\n                "method": "value",\n                "value": 0\n                }\n        \n        "bin" (for grouping numeric values):\n                {\n                "type": "bin",\n                "field": "value",\n                "extent": [0, 100],\n                "step": 10,\n                "as": ["bin0", "bin1"]\n                }\n        \n        "Chronological Sorting for Timelines": Ensure data involving timelines is sorted chronologically (e.g., using a "collect" transform with "ascending" order on the formatted time field) to present events logically from past to future.\n\n        "Multiple transforms in one node" (combining operations):\n                [\n                {\n                "type": "filter",\n                "expr": "datum.status == \'Completed\'"\n                },\n                {\n                "type": "aggregate",\n                "groupby": ["region"],\n                "fields": ["du_id"],\n                "ops": ["count"],\n                "as": ["region_count"]\n                },\n                {\n                "type": "collect",\n                "sort": {"field": "region_count", "order": "descending"}\n                }\n                ]\n\n\nC. Data Presentation Nodes\n1. Echarts Node (node_class_name: draw2d.shape.fishbone.ra.RaEchartAdapter)\n1.1 Purpose: Renders data as a chart using Echarts.js.\n1.2 Key Properties: \no   cont_id: (String) Target HTML element ID.\no   dataset: (String) JSON string defining data structure for ECharts.\no   config: (String) JavaScript ECharts options object definition.\n1.3     "dataset" Value Generation Requirements: \no   Analyze the expected data structure from the input node.\no   Consider data trends, relations, and hierarchy to determine appropriate dimensions (field names).\no   The value MUST be a valid JSON string.\no   The JSON string MUST include a "dimensions" array listing the field names derived from the input data structure (e.g., ["product", "date", "value"]).\no   The JSON string MUST include a "source" array, which MUST be an empty array ([]).\no   The final JSON string format MUST strictly be: \'{"dimensions": [...], "source":[]}\'.\no   Ensure all property names ("dimensions", "source") and any string values within the dimensions array are enclosed in double quotes (") for JSON compatibility.\n1.4 "config" Value Generation Requirements: \no   Create the content of an ECharts configuration options object.\no   Use the dimensions defined in the sibling dataset property as a structural reference only to configure axes and series encoding.\no   For pie charts, STRONGLY prefer using the formatter \'{b}: {c} ({d}%)\' for both \'tooltip.formatter\' and \'series.label.formatter\' to display name, value, and percentage.\no   CRITICAL DATA PROPERTY RESTRICTIONS:\n     -NEVER include ANY "data" property ANYWHERE in the configuration object or sub-objects.\n     -STRICTLY PROHIBITED: All forms of "data: []" or "data: [...]" within ANY object, including but not limited to:\n        * series configurations (e.g., "series: [{ data: [] }]")\n        * axis configurations (e.g., "xAxis: { data: [] }", "yAxis: { data: [] }")\n        * category configurations (e.g., "categories: { data: [] }")\n        * Any other component that might accept a data property.\n    - ALWAYS use the dataset component\'s dimensional mapping via encode properties for data visualization.\n    - All data must be provided exclusively through the dataset mechanism.\n    - When scanning the final configuration, if ANY instance of "data:" appears, it MUST be removed and replaced with proper dataset-based encoding.\no   Make an informed decision on the most suitable series type (e.g., bar, line, pie, scatter) and configure axes (xAxis, yAxis), tooltip, legend, grid, etc., based on the nature and structure of the data inferred from the dataset.dimensions. Aim for a vibrant, coherent, and informative visualization.\no   The final value MUST be a JavaScript string starting exactly with option = { and ending with }.\no   DO NOT include javascript, json, or any other code tags or code fencing around the generated JavaScript string.\no   Provide only the option = { ... } string as the value for the config property.\no   CORRECT EXAMPLE: option = { tooltip: {}, legend: {}, xAxis: { type: \'category\' }, yAxis: {}, series: [{ type: \'bar\', encode: { x: \'dimensionName1\', y: \'dimensionName2\' } }] };\no   INCORRECT EXAMPLE: option = { xAxis: { type: \'category\', data: [] }, series: [{ data: [] }] }; // NEVER USE THIS PATTERN\n\n2.     Vega Node (Type 9):\n     - Purpose: Render Vega or Vega-Lite visualizations.\n     - Default spec: use Vega-lite specification as preferred\n     - \'data\' object in \'update_node_data\' MUST contain: { cont_id: "...", vis_target: "html", vega: false|true (according to specifications used Vega-Lite|Vega ),  spec: { /* FULL Vega/Vega-Lite JSON spec object */ } }\n     - Rules for \'spec\' generation:\n       - The value MUST be a complete and valid Vega or Vega-Lite JSON specification object. Assume Vega-Lite unless the analysis strongly suggests Vega is necessary.\n       - **CRITICAL DATA STRUCTURE:** Define data sources within the spec using the exact format: \'{"name": "unique_data_source_name", "values": []}\'.\n         - The \'"name"\' property should be a unique identifier for the data source, ideally derived from the connected input node or data context.\n         - The \'"values"\' property MUST be an empty array (\'[]\'). Actual data will be injected later by the system based on the \'"name". Do NOT include actual data values here.\n       - **Strict JSON Formatting (RFC 8259):** The generated JSON object MUST strictly adhere to the following:\n         - All property names (keys) MUST be enclosed in double quotes (\'"\').\n         - All string values MUST be enclosed in double quotes (\'"\').\n         - Use \'true\' and \'false\' (lowercase) for booleans.\n         - Use \'null\' (lowercase) for null values.\n         - Numbers MUST NOT be enclosed in quotes.\n         - No trailing commas are allowed in objects or arrays.\n         - No comments (\'//\' or \'/* */\') are permitted within the JSON structure.\n       - **Output Format:** Provide *only* the JSON object for the \'spec\' property. Do NOT wrap it in backticks, code fences (like ```json ... ```), or include any explanatory text or comments outside the valid JSON structure itself.\n       - **Chart Design:** Based on the input data schema and the visualization goal, design an appropriate Vega/Vega-Lite specification (marks, encodings, scales, axes, legends, interactions, etc.) to create a vibrant, coherent, and informative visualization. Make informed decisions about chart types (bar, line, scatter, map, etc.) suitable for the data.\n       - **Field References:** Ensure all \'"field"\' properties correctly reference names that will exist in the data injected later (based on the input data schema).\n\n3.     Table Node (node_class_name: draw2d.shape.fishbone.ra.RaTableAdapter)\no     Purpose: Renders data as a table using Tabulator.js.\no     Key Properties: cont_id (target HTML element ID).\n\n4.     HTML Node (node_class_name: draw2d.shape.fishbone.cell.HTMLnode)\no     Purpose: Renders custom HTML content, potentially incorporating data.\no     Key Properties: \n    - cont_id (target HTML element ID)\n    - html (HTML code string)\n    - binder: "rivets" (optional, enables Rivets.js data binding)\n    - params: Array of parameter definitions for data binding (required when binder="rivets")\no     Main HTML Node Requirement:\n    - EVERY report MUST have a main HTML node with cont_id="html-container"\n    - This main HTML node provides the initial point for the report\'s HTML structure\n    - The main HTML node MUST be strictly connected to a DU Model Node\n    - Other HTML or visualization nodes can use the main HTML node as a visualization destination for a comprehensive HTML DOM structure\n    - The main HTML node should define container divs with unique IDs that other visualization nodes can target\no     HTML Content Rules: \n     Pure HTML, utilizing Bootstrap classes for styling is strictly recommended.\n     NO <style> or <script> tags.\n     Include only the content that would go inside the <body> tag (no <html>, <head>, <body> tags themselves within the html property).\no     Data Binding with Rivets.js:\n    - When binder="rivets", the node supports dynamic data binding using Rivets.js\n    - Parameters are defined in the params array with structure:\n        {\n            param_name: "name",      // Binding variable name\n            param_source: "source",  // Source data node label parameter\n            prop_type: "list", // Data type\n            param_details: "field",   // Source field name\n            prop_key: "key",         // Property key (for nested objects)\n            full_data: true|false    // Whether to bind full array or just values\n        }\n    - Binding Patterns:\n        * Array iteration: rv-each-item="params.list"\n        * Nested properties: { params.param_1.0.field } // always started from "params" reference, like params.param_name.0.field_name  f.e.: params.param_1.0.field, \n    - Example Configurations:\n     * for Array iteration\n        {\n            "binder": "rivets",\n            "params": [\n                {\n                    "param_name": "data",\n                    "param_source": "source_item",\n                    "prop_type": "list",\n                    "param_details": "sites_list_out", //always "sites_list_out"\n                    "full_data": true\n                }\n            ],\n            "html": "<div rv-each-item=\\"params.data\\">{ item.field }</div>" // rv-each-item always started from "params" reference, like params.param_name  f.e.: params.data, \n        }\n      * for Nested properties\n        {\n          "html": "<h5>{ params.par.0.f_el }</h5>", //0 is index of item in data array\n          "binder": "rivets",\n          "params": [\n            {\n              "param_name": "par",\n              "param_source": "New Query",\n              "prop_type": "list",\n              "param_details": "sites_list_out", //always "sites_list_out",\n              "full_data": true\n            }\n          ],\n          "label": "New Label",\n          "type_name": "html"\n        }',sn="\n- Data Flow: Data originates from the Projectnode_api (root node) and flows sequentially through connected nodes. Only DU Model Node allowed to be connected to Projectnode_api node. Flow can split and merge using data manipulation nodes.\n- Nodes & Ports: Each node performs a specific function (data acquisition, manipulation, presentation). Nodes connect via input/output ports.\n- Connections: Link nodes using a Connection class specifying source (source node ID) and target (target node ID).\n- Project Context: The root Projectnode_api provides proj_id, proj_name, and proj_code propagated downstream.\n- Data Manipulation: Primarily uses the Transform Node for most data manipulation operations (grouping, sorting, filtering, etc.). The AlaSQL Node is limited to basic selection and joining operations. Complex logic should be split across multiple Transform nodes, combining related operations in the same node when possible.\n- Report Output: Achieved via Presentation Nodes (Charts, Tables, HTML) rendering data within specified HTML containers.",ln="Best for visualizing trends over time (daily, weekly, monthly, yearly data)",cn='{"dimensions": ["date", "trendA", "trendB"], "source": []}',un="option = {\n      title: { text: 'Time Series Data', left: 'center' },\n      tooltip: { trigger: 'axis' },\n      xAxis: { type: 'time' },\n      yAxis: { type: 'value' },\n      series: [\n        { name: 'Trend A', type: 'line', encode: { x: 'date', y: 'trendA' } },\n        { name: 'Trend B', type: 'line', encode: { x: 'date', y: 'trendB' } }\n      ]\n    }",dn="Optimal for showing composition and proportion of a whole (parts of 100%)",pn='{"dimensions": ["name", "value", "color"], "source": []}',hn="option = {\n      title: { text: 'Distribution', left: 'center' },\n      tooltip: { trigger: 'item', formatter: '{b}: {c} ({d}%)' },\n      series: [{\n        name: 'Categories',\n        type: 'pie',\n        radius: '70%',\n        encode: { itemName: 'name', value: 'value' },\n        label: { formatter: '{b}: {c} ({d}%)' }\n      }]\n    }",fn="Ideal for comparing values across categories",mn='{"dimensions": ["category", "value1", "value2"], "source": []}',gn="option = {\n      title: { text: 'Category Comparison', left: 'center' },\n      tooltip: { trigger: 'axis' },\n      xAxis: { type: 'category' },\n      yAxis: { type: 'value' },\n      series: [\n        { name: 'Value 1', type: 'bar', encode: { x: 'category', y: 'value1' } },\n        { name: 'Value 2', type: 'bar', encode: { x: 'category', y: 'value2' } }\n      ]\n    }",yn="Perfect for showing relationships between two variables",_n='{"dimensions": ["xValue", "yValue", "size", "category"], "source": []}',bn="option = {\n      title: { text: 'Correlation Analysis', left: 'center' },\n      tooltip: { trigger: 'item' },\n      xAxis: { type: 'value' },\n      yAxis: { type: 'value' },\n      series: [{\n        type: 'scatter',\n        encode: { x: 'xValue', y: 'yValue', tooltip: ['xValue', 'yValue', 'category'] },\n        symbolSize: function(data) { return data[2] * 5; }\n      }]\n    }",vn=("Role: You are an AI assistant specialized in analyzing report requirements and planning Fishbone configurations.\nGoal: Analyze the user's report description and generate a high-level plan for the report configuration as a single JSON object.\n\nI. Fishbone System: Core Concepts\n".concat(sn,'\n\nII. Data Flow Planning Guidelines\n1. Start with identifying the data sources needed (Project, DU Model, Tasks, Custom Fields)\n2. Determine how data should be processed (filtering, aggregation, transformation)\n3. Define clear data flow paths from acquisition to presentation\n4. Explicitly document the rationale for each connection in the data flow\n5. **Crucially, consider data sorting requirements, especially ensuring chronological order (ascending) for time-based data using appropriate time units (day, week, month).**\n6. For multi-task analyses, create separate data flow paths for each task when the requirement is to analyze them separately\n7. Consider using multiple Transform nodes to filter individual tasks rather than filtering in a single node\n\nIII. Node Selection Guidelines\n1. Transform node: Primary solution for data manipulation operations (grouping, sorting, filtering, etc.)\n2. SQL Node: Use only for basic data selection and joining operations\n3. Union node: Use for combining similar datasets (e.g., multiple task nodes)\n4. Task node: Each task node must represent exactly ONE task\n5. Presentation nodes: Select based on data visualization requirements\n\nIV. Example Data Flows (Assuming Project and DU Model nodes are already present):\n1.  **Single Task Analysis:**\n    *   Goal: Analyze data from one specific task.\n    *   Flow: Task Node → Transform Node (Process data) → Visualization Node.\n\n2.  **Single Task with Custom Fields:**\n    *   Goal: Analyze task data joined with related custom DU fields.\n    *   Flow: Task Node + Custom Field Node → SQL Node (Join Task & CF) → Transform Node (Process joined data) → Visualization Node.\n\n3.  **Multiple Tasks - Separated Analysis:**\n    *   Goal: Analyze multiple tasks independently, showing separate results.\n    *   Flow Path 1: Task Node A → Transform Node A → Visualization Node A.\n    *   Flow Path 2: Task Node B → Transform Node B → Visualization Node B.\n    *   Note: Each task has its own independent processing and visualization path.\n\n4.  **Multiple Tasks - Combined Analysis:**\n    *   Goal: Analyze data from multiple tasks together in a single view.\n    *   Flow: Task Node A + Task Node B → Union Node (Combine tasks) → Transform Node (Group, sort, aggregate combined data) → Visualization Node.\n\n5.  **Multiple Tasks with Custom Fields - Combined Join, Separated Views:**\n    *   Goal: Join multiple tasks with custom fields, then visualize specific tasks separately. Useful if the join logic is complex and better performed once.\n    *   Flow:\n        *   Task Node A + Task Node B → Union Node (Combine tasks).\n        *   Union Node Output + Custom Field Node → SQL Node (Join combined tasks with CF).\n        *   SQL Node Output → Transform Node 1 (Filter for Task A) → Visualization Node A.\n        *   SQL Node Output → Transform Node 2 (Filter for Task B) → Visualization Node B.\n    *   Alternative (Separate Joins): If join logic is simple or tasks need vastly different processing *before* visualization, consider joining each task with CF separately (similar to Example 3, but with SQL nodes before Transform nodes).\n\n6.  **Basic HTML Layout with Chart:**\n    *   Goal: Create a basic report structure using HTML and embed a chart.\n    *   Flow 1 (Layout): DU Model Node → Main HTML Node (cont_id: "html-container").\n    *   Flow 2 (Chart): Task Node → Transform Node → ECharts Node (cont_id: "chart_div", targets the div defined in the Main HTML Node).\n\n7.  **General Guidance:** Use these examples as a reference. Complex reports might involve chaining multiple Transform nodes or combining patterns. **Remember to always include the main HTML Node connected from the DU Model Node as the base layout.**\n\n\n\nV. Task: Generate Report Structure Plan\n1. Analyze the user\'s report request to understand requirements\n2. Identify required data sources and their relationships\n3. Determine the data flow sequence (acquisition → processing → presentation)\n4. Document your thinking process about why each node is needed\n5. Specify how nodes should connect and why those connections are necessary\n6. **Ensure the plan includes a main HTML node (class: `draw2d.shape.fishbone.cell.HTMLnode`, purpose: \'Main report container\') connected directly from a DU Model Node.**\n\nVI. Output Format for Stage 1:\n**Crucially, do not simplify LLM\'s Output, do not change any Concepts or LLM Tasks, do not include any LLM explanations ot text, provide full JSON object only. \nGenerate a single JSON object with the following structure:\n{\n  "thinking": {\n    "analysis": "Your detailed analysis of the report requirements",\n    "data_flow": "Description of how data should flow through the system",\n    "key_components": ["List of key components needed"]\n  },\n  "preliminary_structure": {\n    "nodes": [\n      {\n        "id": "meaningful_short_id",\n        "class": "node_class_name", \n        "label": "Descriptive Node Label",\n        "purpose": "Why this node is needed"\n      }\n      // Ensure this includes a main HTML node connected from a DU Model Node, serving as the primary report container.\n    ],\n    "connections": [\n      {\n        "source": "source_node_id",\n        "target": "target_node_id",\n        "rationale": "Why these nodes should connect"\n      }\n    ]\n  }\n}\n**IMPORTANT: Your final output for this stage MUST be ONLY the JSON object string described above. Do not include any introductory text, explanations, or markdown formatting like ```json ... ``` around the JSON.**\n\nVII. Node Types\n').concat(rn,"\n\nUser Report Request:\n"),"Role: You are an AI assistant specialized in generating detailed JSON configurations for the Fishbone reporting system.\nGoal: Using the preliminary structure from Stage 1, generate a complete and valid report configuration.\n\nI. Fishbone System: Core Concepts\n".concat(sn,"\n\nII. Implementation Guidelines\n1. Transform the conceptual plan from Stage 1 into a concrete and comprehensive implementation\n2. Ensure all required properties are specified for each node type\n3. Implement the data flow connections as defined in Stage 1\n4. **Implement Time-Based Sorting:** For timeline data, use Transform nodes with `timeFormat` (if needed) and `collect` operations to ensure proper chronological sorting by the required time unit (day, week, month, etc.).\n5. Validate the configuration against system requirements\n\nIII. Required Properties for Each Node Type\n").concat(Object.entries({Projectnode_api:["proj_id","proj_name","proj_code"],DUModelnode_api:["du_model_name","du_model_id"],Datanode:["scope_task_name","scope_task_code","scope_task_id"],CustomFieldnode:["field_name","field_code"],SQLnode:["sql"],Unionnode:[],Transformnode:["transform"],RaEchartAdapter:["cont_id","dataset","config"],RaVegaChart:["cont_id","config"],RaTableAdapter:["cont_id"],HTMLnode:["cont_id","html"]}).map((function(e){var t,a,n=(a=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(t,a)||function(e,t){if(e){if("string"==typeof e)return on(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?on(e,t):void 0}}(t,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],i=n[1];return 0===i.length?"- '".concat(o,"': (No specific required properties beyond id, class, label)"):["Projectnode_api","DUModelnode_api","Datanode","CustomFieldnode"].includes(o)?"- '".concat(o,"': At least one of: ").concat(i.map((function(e){return"'".concat(e,"'")})).join(", ")):"- '".concat(o,"': ").concat(i.map((function(e){return"'".concat(e,"'")})).join(", "))})).join("\n"),"\n- Note: For 'HTMLnode', 'params' is required when 'binder' is 'rivets'\n\nIV. SQL Syntax Guidelines\n1. Use SELECT statements only\n2. Use ? placeholder for input data (FROM ? AS a)\n3. Use bracket notation [] for field names that are SQL keywords\n4. Use short aliases for tables (a, b, c)\n5. Always use [] for field aliases\n6. Never use SQL keywords as field aliases\n7. In GROUP BY clauses, use full field names, not aliases\n8. In ORDER BY clauses, use field aliases for expressions\n9. For multi-task analysis, prefer using separate transform nodes with filters instead of complex SQL WHERE clauses\n\nV. Chart Configuration Guidelines\n1. For ECharts:\n   - Dataset must include dimensions array and empty source array\n   - Config must NEVER include any \"data\" properties\n   - Always use dataset component's dimensional mapping via encode\n   - Config must start with \"option = {\" and end with \"}\"\n\n").concat(ln,"\nDataset: ").concat(cn,"\nConfig: ").concat(un,"\n\n").concat(dn,"\nDataset: ").concat(pn,"\nConfig: ").concat(hn,"\n\n").concat(fn,"\nDataset: ").concat(mn,"\nConfig: ").concat(gn,"\n\n").concat(yn,"\nDataset: ").concat(_n,"\nConfig: ").concat(bn,"\n\nVI. Dataset-Visualization Mapping\n").concat('\n1. Dataset Structure Requirements by Chart Type:\n\n   a. Line/Bar Charts:\n      - Dimensions: ["category", "value1", "value2", ...]\n      - For time series: ["date", "value1", "value2", ...]\n      - **Crucially, ensure time series data is sorted chronologically (ascending order) using a Transform node before visualization.**\n      - Date fields should be properly formatted for time axis using `timeFormat` if necessary.\n      - **For multiple line series:** The dataset MUST be in a "wide" format. Use one dimension for the shared X-axis (e.g., "date" or "category") and separate dimensions for each line\'s Y-axis values (e.g., "seriesA_value", "seriesB_value"). This often requires using a "pivot" transform beforehand.\n      - Example (Multi-series Line): {"dimensions": ["date", "trendA", "trendB"], "source": []}\n      - Example (Single Bar): {"dimensions": ["month", "sales"], "source": []}\n\n   b. Pie/Doughnut Charts:\n      - Dimensions: ["name", "value", "color"]\n      - Name field contains category labels\n      - Value field contains numeric values for each segment\n      - Color field (optional) for custom segment colors\n      - Example: {"dimensions": ["region", "sales", "color"], "source": []}\n\n   c. Scatter/Bubble Charts:\n      - Dimensions: ["xValue", "yValue", "size", "category"]\n      - xValue and yValue for positioning points\n      - size (optional) for bubble size\n      - category (optional) for grouping/coloring points\n      - Example: {"dimensions": ["income", "lifeExpectancy", "population", "country"], "source": []}\n\n   d. Tree/Hierarchy Charts:\n      - Dimensions: ["name", "value", "parent", "children", "level"]\n      - Requires parent-child relationships\n      - May need special data structure with nested children arrays\n      - Example: {"dimensions": ["name", "value", "parent"], "source": []}\n\n2. Data Transformation for Chart Preparation:\n\n   a. Common Transformations:\n      - Aggregation: For summarizing data (e.g., SUM, COUNT, AVG)\n      - Pivot: For converting row-based to column-based format\n      - Window: For calculating running totals or moving averages\n      - Filter: For limiting data to relevant subsets\n      - Sort: For ordering data (especially important for time series)\n\n   b. Transform Node Usage:\n      - Use "aggregate" transform to group and summarize data\n      - Use "pivot" transform to reshape data for multi-series charts\n      - Use "window" transform for cumulative values or moving averages\n      - Example window transform for cumulative sum:\n        {\n          "type": "window",\n          "groupby": ["category"],\n          "sort": {"field": "date"},\n          "fields": ["value"],\n          "ops": ["sum"],\n          "as": ["cumulative_value"]\n        }\n\n3. Dimension Naming Best Practices:\n\n   a. General Rules:\n      - Use descriptive names that reflect data content\n      - Avoid ECharts reserved words (e.g., "data", "value" alone)\n      - Be consistent with naming patterns across related dimensions\n      - For date fields, use names that indicate time granularity (e.g., "year", "month", "day")\n\n   b. Multi-Series Data:\n      - For pivoted data: Use consistent prefixes for related measures\n      - For unpivoted data: Include a dimension that identifies the series\n\n4. Encode Property Examples:\n\n   a. Line/Bar Charts:\n      - Basic: encode: { x: \'category\', y: \'value\' }\n      - Multi-series: encode: { x: \'category\', y: \'value\', seriesName: \'series\' }\n      - Stacked: encode: { x: \'category\', y: \'value\', stack: \'stack\' }\n\n   b. Pie Charts:\n      - Basic: encode: { itemName: \'name\', value: \'value\' }\n      - With tooltip: encode: { itemName: \'name\', value: \'value\', tooltip: [\'name\', \'value\', \'percentage\'] }\n\n   c. Scatter/Bubble Charts:\n      - Basic: encode: { x: \'xValue\', y: \'yValue\' }\n      - With size: encode: { x: \'xValue\', y: \'yValue\', size: \'size\' }\n      - With category: encode: { x: \'xValue\', y: \'yValue\', itemGroupId: \'category\' }\n\n   d. Tree/Hierarchy Charts:\n      - Basic: encode: { value: \'value\', itemName: \'name\' }\n      - With tooltip: encode: { value: \'value\', itemName: \'name\', tooltip: [\'name\', \'value\'] }\n','\n\nVII. Validation Checklist\n1. All node IDs are unique and meaningful\n2. All class names are valid Fishbone node types\n3. All required properties for each node class are present\n4. All connections link existing source and target node IDs\n5. Data flow is logical and follows the plan from Stage 1\n6. SQL queries adhere to the syntax rules\n7. Chart configurations do NOT contain any "data:" properties\n8. HTML content follows the content rules\n9. Container IDs in presentation nodes match expected HTML structure\n\nVIII. Main HTML Container Specification\n1. Container Structure:\n- The main report container MUST have ID as mentioned: "html-container"\n- The HTML node with cont_id="html-container" MUST be strictly connected to a DU Model Node\n- It should use Bootstrap grid system for responsive layout\n- Each visualization component should be placed in its own container div with:\n  * Unique ID matching the node\'s \'cont_id\' property\n  * Appropriate sizing classes (e.g., col-md-6, col-lg-4)\n  * Margin/padding for spacing (e.g., using Bootstrap margin/padding utilities like \'mb-3\', \'p-2\')\n\n2. Container Requirements:\n- Must support multiple visualization types (charts, tables, HTML)\n- Should maintain consistent styling across components (leverage Bootstrap themes/utilities)\n- Must handle dynamic resizing of components (ensure Bootstrap grid adapts correctly)\n- Should include loading states for async data (consider adding placeholder elements)\n- The layout MUST adapt gracefully to different screen sizes using Bootstrap\'s responsive grid classes\n\n**CRITICAL CONNECTION:** Ensure the main HTML node (class 11, cont_id="html-container") is ALWAYS directly connected from a DU Model Node (class 2). This connection is mandatory for the base report structure.\n\nIX. Node Class Mapping\nUse the following numeric IDs instead of full class names to make the output more concise:\n1: draw2d.shape.fishbone.cell.Projectnode_api (Project Node)\n2: draw2d.shape.fishbone.cell.DUModelnode_api (DU Model Node)\n3: draw2d.shape.fishbone.cell.Datanode (Task Node)\n4: draw2d.shape.fishbone.cell.CustomFieldnode (DU Custom Field Node)\n5: draw2d.shape.fishbone.cell.SQLnode (AlaSQL Node)\n6: draw2d.shape.fishbone.cell.Unionnode (Union Node)\n7: draw2d.shape.fishbone.cell.Transformnode (Transform Node)\n8: draw2d.shape.fishbone.ra.RaEchartAdapter (Echarts Node)\n9: draw2d.shape.fishbone.ra.RaVegaChart (Vega Node)\n10: draw2d.shape.fishbone.ra.RaTableAdapter (Table Node)\n11: draw2d.shape.fishbone.cell.HTMLnode (HTML Node)\n\nX. Output Format for Stage 2:\n**Crucially, do not simplify LLM\'s Output, do not change any Concepts or LLM Tasks, do not include any LLM explanations ot text, provide full JSON object only. \nGenerate a single JSON object with the following structure:\n{\n  "report_config": {\n    "nodes": [\n      {\n        "id": "brief_id", // Use very brief IDs like "p1", "d1", "s1", "c1"\n        "class": 1, // Use numeric class ID from the mapping above instead of full class name\n        "label": "Brief Label" // Use concise labels like "Project", "Task 1", "Chart"\n        // Include required properties based on node class\n        // Use brief cont_id values (except for main HTML node which must be "html-container")\n      }\n    ],\n    "connections": [\n      {\n        "src": "brief_source_id", // Use src instead of source\n        "trgt": "brief_target_id" // Use trgt instead of target\n      }\n    ]\n  }\n}\n**IMPORTANT: Your final output for this stage MUST be ONLY the JSON object string described above. Do not include any introductory text, explanations, or markdown formatting like ```json ... ``` around the JSON.**\n\nX. Node Types\n').concat(rn,"\n\nStage 1 Result:\n"),function(e,t,a,n,o){e.zte_build=!0,e.mode=n||"generate",e.aiPromptHistory=a,e.failedNodeErrors=o||[],e.retryOptions={onlyStage2:"retry"===e.mode},e.showAdvancedControls=!1,e.failedNodeErrors.length>0&&console.log("AIReportModalCtrl received failedNodeErrors:",e.failedNodeErrors),e.userInputText="","retry"===e.mode||"edit"===e.mode?e.userInputText=a.currentPrompt||"":"incremental"===e.mode&&(e.userInputText=""),e.aiPromptHistory.stage1Provider=e.aiPromptHistory.stage1Provider||"deepseek",e.aiPromptHistory.stage2Provider=e.aiPromptHistory.stage2Provider||"deepseek",e.aiPromptHistory.stage2Retries=void 0===e.aiPromptHistory.stage2Retries?2:e.aiPromptHistory.stage2Retries,e.aiPromptHistory.generationMethod=e.aiPromptHistory.generationMethod||"classic",e.aiPromptHistory.agenticProvider=e.aiPromptHistory.agenticProvider||"openai",e.aiPromptHistory.useRequestEnhancement=void 0!==e.aiPromptHistory.useRequestEnhancement&&e.aiPromptHistory.useRequestEnhancement,e.aiPromptHistory.useStage0ForReplies=void 0!==e.aiPromptHistory.useStage0ForReplies&&e.aiPromptHistory.useStage0ForReplies,e.aiPromptHistory.stage0Provider=e.aiPromptHistory.stage0Provider||"",e.aiPromptHistory.stage0Model=e.aiPromptHistory.stage0Model||"",e.aiPromptHistory.stage0Temperature=void 0===e.aiPromptHistory.stage0Temperature?.3:e.aiPromptHistory.stage0Temperature,e.aiPromptHistory.stage0Retries=void 0===e.aiPromptHistory.stage0Retries?2:e.aiPromptHistory.stage0Retries,e.aiPromptHistory.stage1Temperature=void 0===e.aiPromptHistory.stage1Temperature?.2:e.aiPromptHistory.stage1Temperature,e.aiPromptHistory.stage2Temperature=void 0===e.aiPromptHistory.stage2Temperature?.1:e.aiPromptHistory.stage2Temperature,e.aiPromptHistory.maxTokens=void 0===e.aiPromptHistory.maxTokens?16e3:e.aiPromptHistory.maxTokens,e.aiPromptHistory.scoreThreshold=void 0===e.aiPromptHistory.scoreThreshold?.7:e.aiPromptHistory.scoreThreshold,e.title="Generate AI Report","retry"===e.mode?e.title="Retry AI Request":"reply"===e.mode?e.title="Reply / Follow-up":"edit"===e.mode?e.title="Edit AI Prompt":"incremental"===e.mode&&(e.title="Incremental Report Update",e.aiPromptHistory.useIncrementalUpdates=!0),e.modelOptions={zte:[{value:"nebulacoder",text:"NebulaCoder",in_cost:0,out_cost:0},{value:"NTele-72B",text:"NTele-72B Saturn 3.0",in_cost:0,out_cost:0}],zte_v2:[{value:"nebulacoder-preview",text:"NebulaCoder-Preview",in_cost:0,out_cost:0},{value:"nebulacoder-cot-preview",text:"NebulaCoder-COT-Preview",in_cost:0,out_cost:0},{value:"nebulacoder",text:"NebulaCoder",in_cost:0,out_cost:0},{value:"nebulacoder-128K",text:"nebulacoder-128k",in_cost:0,out_cost:0},{value:"NTele-72B",text:"ZTEAIM-Saturn 3.0",in_cost:0,out_cost:0},{value:"nebulacoder-br",text:"nebulacoder-br",in_cost:0,out_cost:0}]},e.zte_build||Object.assign(e.modelOptions,{openrouter:[{value:"google/gemini-2.5-flash-preview",text:"Gemini 2.5 Flash",in_cost:.15,out_cost:.6},{value:"google/gemini-2.5-pro-previe",text:"Gemini 2.5 Pro Pre",in_cost:1.25,out_cost:10},{value:"google/gemini-2.5-flash-preview:thinking",text:"Gemini-2.5-flash-preview:thinking",in_cost:.13,out_cost:3},{value:"qwen/qwen3-32b",text:"Qwen3-32b",in_cost:0,out_cost:0},{value:"qwen/qwen3-32b:free",text:"Qwen3-32b:free",in_cost:0,out_cost:0},{value:"qwen/qwen3-235b-a22b",text:"Qwen3-235b-a22b",in_cost:0,out_cost:0},{value:"qwen/qwen3-14b",text:"Qwen/qwen3-14b",in_cost:0,out_cost:0},{value:"qwen/qwen3-30b-a3b",text:"Qwen3-30b-a3b",in_cost:0,out_cost:0},{value:"qwen/qwen2.5-vl-32b-instruct:free",text:"Qwen2.5-vl-32b-instruct:free",in_cost:0,out_cost:0},{value:"qwen/qwen2.5-vl-32b-instruct",text:"Qwen2.5-vl-32b-instruct",in_cost:0,out_cost:0},{value:"anthropic/claude-sonnet-4",text:"Claude 4 Sonnet",in_cost:3,out_cost:15},{value:"anthropic/claude-opus-4",text:"Claude 4 Opus!",in_cost:15,out_cost:75},{value:"anthropic/claude-3.7-sonnet",text:"Claude 3.7 Sonnet",in_cost:3,out_cost:15},{value:"anthropic/claude-3.7-sonnet:thinking",text:"Claude 3.7 Sonnet Thinking",in_cost:3,out_cost:15},{value:"anthropic/claude-3.5-haiku",text:"Claude 3.5 Haiku",in_cost:.8,out_cost:4},{value:"openai/gpt-4.1-mini-2025-04-14",text:"gpt-4.1-mini",in_cost:.4,out_cost:1.6},{value:"openai/gpt-4.1-2025-04-14",text:"gpt-4.1",in_cost:2,out_cost:8},{value:"openai/gpt-4o-mini",text:"gpt-4o-mini",in_cost:.15,out_cost:.6},{value:"openai/gpt-4o",text:"gpt-4o",in_cost:2.5,out_cost:10},{value:"openai/o4-mini",text:"gpt-o4-mini",in_cost:1.1,out_cost:4.4},{value:"openai/o4-mini-high",text:"gpt-o4-mini-high",in_cost:1.1,out_cost:4.4},{value:"deepseek/deepseek-prover-v2",text:"DeepSeek Prover-v2",in_cost:0,out_cost:0}]}),e.agenticProviders=[{value:"openai",text:"OpenAI GPT"},{value:"openrouter",text:"Open Router"},{value:"zte_v2",text:"ZTE Nebula AI-V2"}],e.promptApproaches=[{value:"three-stage-rag",text:"Three-Stage RAG Process (Requirements -> Plan -> Implement)"},{value:"two-stage",text:"Two-Stage Process"},{value:"three-stage",text:"Three-Stage Process (Requirements -> Plan -> Implement)"},{value:"single-stage",text:"Single-Stage Process (Faster)"}],e.updateModelOptions=function(t){var a,n;if("stage1"===t)a=e.aiPromptHistory.stage1Provider,n="stage1Model";else if("stage2"===t)a=e.aiPromptHistory.stage2Provider,n="stage2Model";else if("stage0"===t)a=e.aiPromptHistory.stage0Provider||e.aiPromptHistory.stage1Provider,n="stage0Model";else{if("agentic"!==t)return console.warn("updateModelOptions called without specific stage, updating all."),e.updateModelOptions("stage1"),e.updateModelOptions("stage2"),e.updateModelOptions("stage0"),void e.updateModelOptions("agentic");a=e.aiPromptHistory.agenticProvider,n="agenticModel"}var o=e.modelOptions[a];o&&o.length>0?e.aiPromptHistory[n]&&o.some((function(t){return t.value===e.aiPromptHistory[n]}))||(e.aiPromptHistory[n]="agentic"===t&&"openai"===a?"gpt-4o-mini":o[0].value):e.aiPromptHistory[n]=null},e.updateModelOptions(),e.ok=function(){var a={stage1Provider:e.aiPromptHistory.stage1Provider,stage1Model:e.aiPromptHistory.stage1Model,stage1Temperature:e.aiPromptHistory.stage1Temperature,stage2Provider:e.aiPromptHistory.stage2Provider,stage2Model:e.aiPromptHistory.stage2Model,stage2Temperature:e.aiPromptHistory.stage2Temperature,stage2Retries:e.aiPromptHistory.stage2Retries,maxTokens:e.aiPromptHistory.maxTokens,generationMethod:e.aiPromptHistory.generationMethod,agenticProvider:e.aiPromptHistory.agenticProvider,agenticModel:e.aiPromptHistory.agenticModel,scoreThreshold:e.aiPromptHistory.scoreThreshold,modelOptions:e.modelOptions,retryOptions:e.retryOptions,promptApproach:e.aiPromptHistory.promptApproach,useRequestEnhancement:e.aiPromptHistory.useRequestEnhancement,useStage0ForReplies:e.aiPromptHistory.useStage0ForReplies,stage0Provider:e.aiPromptHistory.stage0Provider,stage0Model:e.aiPromptHistory.stage0Model,stage0Temperature:e.aiPromptHistory.stage0Temperature,stage0Retries:e.aiPromptHistory.stage0Retries};"reply"===e.mode?a.replyText=e.userInputText:a.prompt=e.userInputText,console.log("Closing AI Modal with data:",a),t.close(a)},e.cancel=function(){t.dismiss("cancel")}});vn.$inject=["$scope","$uibModalInstance","aiPromptHistory","modalType","errorArray"];var wn=function(e,t,a,n){e.nodeErrors=n||[],e.countdown=10,console.log("AIRetryConfirmModalCtrl initialized with errors:",e.nodeErrors);var o=a((function(){e.countdown--,e.countdown<=0&&(a.cancel(o),console.log("Retry countdown finished. Closing modal with 'retry'."),t.close("retry"))}),1e3,e.countdown);e.cancel=function(){a.cancel(o),console.log("Retry cancelled by user. Closing modal with 'cancel'."),t.close("cancel")},e.$on("$destroy",(function(){o&&(a.cancel(o),console.log("AIRetryConfirmModalCtrl scope destroyed, interval cancelled."))}))};function xn(e){return function(e){if(Array.isArray(e))return Dn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kn(e,t){if(e){if("string"==typeof e)return Dn(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Dn(e,t):void 0}}function Dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}wn.$inject=["$scope","$uibModalInstance","$interval","nodeErrors"];var Sn=a("a45670b3d8fb79ec0258"),Cn=a("a7583c9a3ff76b2fdd52"),Tn=a("8deafab7866a125bb9ca");function An(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function Pn(e,t,a,n,o,i,r,l){t.rememberMe={},t.rememberMe.status=!0,t.submit=function(t,a){var n=e.originalPath;s().isDefined(e.authenticationDone)&&e.authenticationDone||l.authenticate(Sn.param({username:t,password:a}),(function(a){return e.authenticationDone=!0,e.username=t,"/login"===n||void 0===n?o.path("editor"):o.path(n),!0}),(function(e){return o.path("login"),alert("Login Error: "),!1}))}}function En(e,t,a,n,o,i,r,s){t.request={},t.request.username=e.username,t.request.strip_mode=!1,t.request.has_html=r,t.request.no_html_ed=s,t.ok=function(){t.request.report_name?(a.close(),t.request.jsonText=n,t.request.editorJson=o,i.showPublishResult(t.request)):t.fill_name=!0},t.cancel=function(){a.dismiss("cancel")}}function In(e,t,a,n,o,r){e.request={},e.request.username=n.username,e.request.report_name=n.report_name,e.request.author=n.author,e.ok=function(){a.close(),e.request.jsonText=o,e.request.editorJson=r,n.filename&&t.post(i().context+"/mongo/updateData?file_name="+n.filename+"&username="+n.username+"&proj_id="+n.project_id,e.request).then((function(e){alert("File was successfully updated!")})).catch((function(e){console.log(e.data)}))},e.cancel=function(){a.dismiss("cancel")}}function Nn(e,t,a,n,o,r,s,l){t.username=e.username,t.ngData=[],t.showEmptyMessage=!1,Sn.ajax({url:i().context+"/mongo/getUserReports?username="+t.username,contentType:"application/json; charset=utf-8",type:"GET",success:function(e){0===e.length&&(t.showEmptyMessage=!0),t.gridOptions.data=e.data},error:function(e){}}),t.gridOptions={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,data:t.ngData,onRegisterApi:function(e){t.gridApi=e,n((function(){t.gridApi.core.handleWindowResize()}),500,10)},columnDefs:[{field:"author",displayName:"Author",width:"15%"},{field:"report_name",displayName:"Report Name"}]},t.ok=function(){var n=t.gridApi.selection.getSelectedRows();if(n.length>0){a.close(n);var l={};o((function(){r.get(i().context+"/mongo/getData?file_name="+n[0].file_name).then((function(t){l=t.data,s(l.jsonText,void 0),e.filename=n[0].file_name,e.report_name=n[0].report_name}),(function(e){}))}),500)}else alert("Nothing selected...!")},t.view=function(){var e=t.gridApi.selection.getSelectedRows();e.length>0?(a.close(e),l.path("/viewer/"+e[0].file_name)):alert("Nothing selected...!")},t.cancel=function(){a.dismiss("cancel")},t.delete=function(){var n=t.gridApi.selection.getSelectedRows();n.length>0?(a.dismiss("delete"),r.get(i().context+"/mongo/deleteReport?file_name="+n[0].file_name+"&username="+e.username+"&proj_id="+e.project_id).then((function(e){alert("Report "+n[0].report_name+" was successfully deleted from server!")}),(function(e){}))):alert("Nothing selected...!")},t.share=function(){var e=t.gridApi.selection.getSelectedRows();e.length>0?(a.dismiss("share"),window.prompt("Copy to clipboard: Ctrl+C, Enter","/#/viewer/"+e[0].file_name)):alert("Nothing selected...!")}}function Mn(e,t,a,n,o,r,s,l){function c(){a.get_pl=r.get(i().context+"/mongo/getUserPlaylists?username="+a.username).then((function(e){0===e.data.length?a.gridOptionsLists.data=[{name:"No report found"}]:(a.state=a.gridApi.saveState.save(),a.showEmptyMessage=!1,a.gridOptionsLists.data=e.data,o((function(){a.gridApi.saveState.restore(a,a.state)}),1))}),(function(e){console.log(e)}))}function u(){a.selLists=a.gridApi.selection.getSelectedRows(),a.selLists.length&&a.selLists[0]._id&&(a.selLists=a.gridApi.selection.getSelectedRows(),a.get_pl=r.get(i().context+"/mongo/getPlaylist?playlist_id="+a.selLists[0]._id).then((function(e){e.data&&(a.get_pl_reports=r.post(i().context+"/mongo/getReportsByIds",e.data.reports).then((function(t){var n=[];e.data.reports.forEach((function(e,a){t.data.forEach((function(t){t.file_name===e&&n.push(t)}))})),a.gridOptionsReports.data=n}),(function(e){})))}),(function(e){})))}a.username=t.username,a.ngDataLists=[],a.ngDataReports=[],a.showEmptyMessageLists=!1,a.showEmptyMessageReports=!1,a.selLists=null,a.selReports=null,a.gridOptionsLists={enableColumnResizing:!0,enableFiltering:!0,showGridFooter:!1,showColumnFooter:!1,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,data:a.ngDataLists,onRegisterApi:function(e){a.gridApi=e,e.selection.on.rowSelectionChanged(a,u)},columnDefs:[{field:"author",displayName:"Author",width:"100"},{field:"public",displayName:"Public",width:"70",type:"boolean",cellTemplate:'<input onclick="return false;" type="checkbox" ng-model="row.entity.public">'},{field:"name",displayName:"Play List Name",width:"20%"},{field:"description",displayName:"Description"},{field:"create_date",displayName:"Create Date",width:"180"}]},a.gridOptionsReports={enableColumnResizing:!0,enableFiltering:!0,showGridFooter:!1,showColumnFooter:!1,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,data:a.ngDataReports,onRegisterApi:function(e){a.gridApiReports=e,e.selection.on.rowSelectionChanged(a,(function(){a.selReports=e.selection.getSelectedRows()}))},columnDefs:[{field:"report_name",displayName:"Report Name"},{field:"create_date",displayName:"Create Date",width:"180"}]},a.openPlayList=function(){var e=a.gridApi.selection.getSelectedRows();e.length>0?s.path("/player/"+e[0]._id):alert("Nothing selected...!")},a.refresh=function(){c()},a.editPlayList=function(){var n=function(e){console.log("Updating playlist: '"+e.report_name+"'"),r.post(i().context+"/mongo/updatePlaylist?playlist_id="+e._id,e).then((function(e){console.log("playlist: '"+e.data.name+"' successfully updated"),c()})).catch((function(e){console.log(e.data)}))},o=a.gridApi.selection.getSelectedRows();(o[0].author.indexOf(t.username)>-1||Tn.objectArrayIndexOf(o[0].perm,t.username,0))&&l.open({templateUrl:"views/common/edit_playlist.html",controller:"editPlaylistCtrl",resolve:{callback:function(){return n},playlist:function(){var t=e.defer();return r.get(i().context+"/mongo/getPlaylist?playlist_id="+o[0]._id).then((function(e){t.resolve(e.data)}),(function(e){})),t.promise}}})},a.newPlayList=function(){var e={name:"",create_date:new Date,author:a.username,description:""},t=function(t){console.log(t),e=Sn.extend(!0,e,t),a.create_playlist=r.post(i().context+"/mongo/createPlaylist?file_name="+Tn.generateUUID(),e).then((function(e){console.log("Playlist successfully created."),c()}),(function(e){}))};l.open({templateUrl:"views/common/new_playlist.html",controller:"newPlaylistCtrl",resolve:{callback:function(){return t},playlist:function(){return e}}})},a.updatePlayList=function(){var e=a.gridApi.selection.getSelectedRows(),t=[];a.gridOptionsReports.data.forEach((function(e){t.push(e.file_name)}));var n={_id:e[0]._id,name:e[0].name,create_date:e[0].create_date,author:e[0].author,description:e[0].description,public:e[0].public,reports:t};a.update_report=r.post(i().context+"/mongo/updatePlaylist?playlist_id="+e[0]._id,n).then((function(e){e.data&&console.log("Playlist successfully updated.")}),(function(e){}))},a.deletePlaylist=function(){if(confirm("Are you sure you want to delete this Playlist?")){var e=a.gridApi.selection.getSelectedRows();e[0]._id&&(a.delete_pl=r.get(i().context+"/mongo/deletePlaylist?playlist_id="+e[0]._id).then((function(e){e.data&&(console.log("json.data"),Tn.bsToast.info({title:"Message",position:"topCenter",maxWidth:450,message:e.data.message}),c())}),(function(e){})))}},a.addReport=function(){var e=function(e){var t,n;console.log(e),(t=a.gridOptionsReports.data).push.apply(t,function(e){if(Array.isArray(e))return An(e)}(n=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return An(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?An(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a.updatePlayList()};l.open({templateUrl:"views/common/add_pl_report.html",controller:"addPLReportCtrl",size:"lg",resolve:{callback:function(){return e}}})},a.deleteReport=function(){confirm("Are you sure you want to remove this Report?")&&(a.gridOptionsReports.data.splice(a.gridOptionsReports.data.indexOf(a.gridApiReports.selection.getSelectedRows()[0]),1),a.updatePlayList())},a.moveUp=function(){if(a.gridApiReports.selection.getSelectedRows().length>0){var e=a.gridOptionsReports.data.indexOf(a.gridApiReports.selection.getSelectedRows()[0]);e>0&&(Tn.moveArrayItem(a.gridOptionsReports.data,e,e-1),a.updatePlayList())}else alert("Nothing selected...!")},a.moveDown=function(){if(a.gridApiReports.selection.getSelectedRows().length>0){var e=a.gridOptionsReports.data.indexOf(a.gridApiReports.selection.getSelectedRows()[0]);e<a.gridOptionsReports.data.length-1&&(Tn.moveArrayItem(a.gridOptionsReports.data,e,e+1),a.updatePlayList())}else alert("Nothing selected...!")},a.open_report=function(){var e=a.gridApiReports.selection.getSelectedRows();e.length>0?s.path("/editor/"+e[0].file_name):alert("Nothing selected...!")},a.view=function(){var e=a.gridApiReports.selection.getSelectedRows();e.length>0?window.open("#/viewer/"+e[0].file_name,"_blank"):alert("Nothing selected...!")},a.edit=function(){var n=function(e){console.log("Updating report: '"+e.report_name+"'"),r.post(i().context+"/mongo/updateReport?reportID="+e._id,e).then((function(e){console.log("Report: '"+e.data.report_name+"' successfully updated"),u()})).catch((function(e){console.log(e.data)}))},o=a.gridApiReports.selection.getSelectedRows();o[0].author.indexOf(t.username)>-1||Tn.objectArrayIndexOf(o[0].perm,t.username,0)?l.open({templateUrl:"views/common/edit_report.html",controller:"editReportCtrl",resolve:{callback:function(){return n},report:function(){var t=e.defer();return r.get(i().context+"/mongo/getReport?reportID="+o[0]._id).then((function(e){t.resolve(e.data[0])}),(function(e){})),t.promise}}}):alert("You have no rights to edit this report.")},c(),window.onbeforeunload=void 0}function On(e,t,a,n,o){e.model=o,e.ok=function(){a.close(),n(e.model)},e.cancel=function(){a.close()}}function jn(e,t,a){e.model={},e.ok=function(){t.close(),a(e.model)},e.cancel=function(){t.close()}}function Rn(e,t,a,n){e.model=n,e.ok=function(){t.close(),a(e.model)},e.cancel=function(){t.close()}}function Ln(e,t,a,n,o){e.username=t.username,e.gridOptionsReportSel={enableFiltering:!0,showGridFooter:!0,showColumnFooter:!0,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!0,onRegisterApi:function(t){e.gridApiReportsSel=t},columnDefs:[{field:"report_name",displayName:"Report Name"},{field:"create_date",displayName:"Create Date",width:"180"}]},e.get_reports=n.get(i().context+"/mongo/getUserReports?username="+e.username).then((function(t){0===t.data.length?e.gridOptionsReportSel.data=[{report_name:"No report found"}]:e.gridOptionsReportSel.data=t.data}),(function(e){})),e.ok=function(){a.close(),o(e.gridApiReportsSel.selection.getSelectedRows())},e.cancel=function(){a.close()}}function Fn(e,t,a,n,o){e.model=o,e.gridOptionsPerm={enableColumnResizing:!0,enableFiltering:!0,showGridFooter:!1,showColumnFooter:!1,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,onRegisterApi:function(t){e.gridApiReportsPerm=t,t.selection.on.rowSelectionChanged(e,(function(){e.selPerm=t.selection.getSelectedRows()}))},columnDefs:[{field:"user_id",displayName:"ID",width:"200"},{field:"user_name",displayName:"Name"}]},e.gridOptionsPerm.data=o.perm,e.ok=function(){t.close(),n(e.model)},e.cancel=function(){t.close()},e.newPerm=function(){o.perm||(o.perm=[],e.gridOptionsPerm.data=o.perm);var t=function(e){o.perm.push({user_id:e.user_id,user_name:e.user_name})};a.open({templateUrl:"views/common/edit_report_perm_add.html",backdrop:"static",windowClass:"zindex",controller:["$scope","$uibModalInstance","callback",function(e,t,a){e.model={},e.cancel=function(){t.close()},e.ok=function(){t.close(),a(e.model)}}],resolve:{callback:function(){return t}}})},e.deletePerm=function(){o.perm.splice(o.perm.indexOf(e.selPerm[0]),1)},e.refreshPerm=function(){t.close()}}function Un(e,t,a,n,o){e.model=o,e.gridOptionsPerm={enableColumnResizing:!0,enableFiltering:!0,showGridFooter:!1,showColumnFooter:!1,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,onRegisterApi:function(t){e.gridApiReportsPerm=t,t.selection.on.rowSelectionChanged(e,(function(){e.selPerm=t.selection.getSelectedRows()}))},columnDefs:[{field:"user_id",displayName:"ID",width:"200"},{field:"user_name",displayName:"Name"}]},e.gridOptionsPerm.data=o.perm,e.ok=function(){t.close(),n(e.model)},e.cancel=function(){t.close()},e.newPerm=function(){o.perm||(o.perm=[],e.gridOptionsPerm.data=o.perm);var t=function(e){o.perm.push({user_id:e.user_id,user_name:e.user_name})};a.open({templateUrl:"views/common/edit_report_perm_add.html",backdrop:"static",windowClass:"zindex",controller:["$scope","$uibModalInstance","callback",function(e,t,a){e.model={},e.cancel=function(){t.close()},e.ok=function(){t.close(),a(e.model)}}],resolve:{callback:function(){return t}}})},e.deletePerm=function(){o.perm.splice(o.perm.indexOf(e.selPerm[0]),1)},e.refreshPerm=function(){t.close()}}function Bn(e){e.TURL=function(){unescape(window.location.href);var e=window.location.href.split("?")[1];if(null==e)return null;for(var t=e.split("&"),a=0;a<t.length;a++){var n=t[a].split("=");if("TokenUrl"==n[0])return n[1]}return null}()}function zn(e){e.TURL=function(){unescape(window.location.href);var e=window.location.href.split("?")[1];if(null==e)return null;for(var t=e.split("&"),a=0;a<t.length;a++){var n=t[a].split("=");if("TokenUrl"==n[0])return n[1]}return null}()}function Hn(e,t,a){t.getReportList(a.user,a.project_code).then((function(t){e.reports=t,e.username=a.user,e.project_code=a.project_code}))}Un.$inject=["$scope","$uibModalInstance","$uibModal","callback","playlist"],Fn.$inject=["$scope","$uibModalInstance","$uibModal","callback","report"],zn.$inject=["$scope"],Bn.$inject=["$scope"],Ln.$inject=["$scope","$rootScope","$uibModalInstance","$http","callback"],Rn.$inject=["$scope","$uibModalInstance","callback","playlist"],jn.$inject=["$scope","$uibModalInstance","callback"],On.$inject=["$scope","$rootScope","$uibModalInstance","callback","message"],Mn.$inject=["$q","$rootScope","$scope","$interval","$timeout","$http","$location","$uibModal"],Hn.$inject=["$scope","FileFactory","factory"],Nn.$inject=["$rootScope","$scope","$uibModalInstance","$interval","$timeout","$http","callback","$location"],In.$inject=["$scope","$http","$uibModalInstance","$rootScope","jsonText","editorJson"],En.$inject=["$rootScope","$scope","$uibModalInstance","jsonText","editorJson","editor","hasHtmlFlag","noHtmlEdFlag"],Pn.$inject=["$rootScope","$scope","$http","$timeout","$location","$cookieStore","$compile","loginUserService"];const qn=s().module("controllers",[Fe]).controller("loginCtrl",Pn).controller("PublishReqCtrl",En).controller("SaveReqCtrl",In).controller("PivotDAttrCtrl",["$scope","$uibModalInstance","callback","pivot",function(e,t,a,n){e.model=n.userData.pivot.d_attributes,e.cancel=function(){t.dismiss("cancel")},e.ok=function(){t.close(),a(e.model)}}]).controller("MyReportsReqCtrl",Nn).controller("myReportsCtrl",["$q","$rootScope","$scope","$interval","$timeout","$http","$location","$uibModal","$templateCache","uiGridConstants","$state",function(e,t,a,n,o,r,l,c,u,d,p){a.username=t.username,a.ngData=[],a.ngDataSub=[],a.showEmptyMessage=!1,a.showEmptyMessageSub=!1,a.sel=null,a.selSub={},a.state={},a.total=0,a.newEmptyReport=function(){p.go("editor",{filename:null,new:"true",showHtml:"false",no_html_ed:"false"})},a.newHtmlReport=function(){p.go("editor",{filename:null,new:"true",showHtml:"true",no_html_ed:"false"})},a.newHtmlDisabledReport=function(){p.go("editor",{filename:null,new:"true",showHtml:"true",no_html_ed:"true"})},a.newBasicReport=function(){window.open("#/st_editor/","_blank")},u.put("ui-grid/uiGridCheckboxHeaderCell",'<div ng-class="{ \'sortable\': sortable }"><div class="ui-grid-vertical-bar">&nbsp;</div><div class="ui-grid-cell-contents" col-index="renderIndex"><span>{{ col.displayName CUSTOM_FILTERS }}</span> <span ui-grid-visible="col.sort.direction" ng-class="{ \'ui-grid-icon-up-dir\': col.sort.direction == asc, \'ui-grid-icon-down-dir\': col.sort.direction == desc, \'ui-grid-icon-blank\': !col.sort.direction }">&nbsp;</span></div><div class="ui-grid-column-menu-button" ng-if="grid.options.enableColumnMenus && !col.isRowHeader  && col.colDef.enableColumnMenu !== false" class="ui-grid-column-menu-button" ng-click="toggleMenu($event)"><i class="ui-grid-icon-angle-down">&nbsp;</i></div><div ng-if="filterable" class="ui-grid-filter-container" ng-repeat="colFilter in col.filters"><input type="checkbox" class="ui-grid-filter-input" ng-model="colFilter.term" ng-click="$event.stopPropagation()" ng-attr-placeholder="{{colFilter.placeholder || \'\'}}"><div class="ui-grid-filter-button" ng-click="colFilter.term = null"><i class="ui-grid-icon-cancel" ng-show="!!colFilter.term">&nbsp;</i>\x3c!-- use !! because angular interprets \'f\' as false --\x3e</div></div></div>'),a.gridOptions={enableColumnResizing:!0,enableFiltering:!0,showGridFooter:!1,showColumnFooter:!1,showHeader:!0,saveFocus:!1,saveSelection:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,data:a.ngData,onRegisterApi:function(e){a.gridApi=e,e.selection.on.rowSelectionChanged(a,f),e.cellNav.on.navigate(a,(function(e,t){a.gridApi.selection.selectRow(e.row.entity)})),e.core.on.filterChanged(a,(function(){var e=this;o((function(){a.total=e.grid.renderContainers.body.visibleRowCache.length}),10)}))},columnDefs:[{field:"author",displayName:"Author",width:"100"},{field:"strip_mode",displayName:"Basic mode",width:"70",type:"boolean",cellTemplate:'<input onclick="return false;" type="checkbox" ng-model="row.entity.strip_mode">'},{field:"public",headerCellTemplate:"ui-grid/uiGridCheckboxHeaderCell",enableFiltering:!0,displayName:"Public",width:"70",type:"boolean",cellTemplate:'<input onclick="return false;" type="checkbox" ng-model="row.entity.public">'},{name:"Likes",displayName:"Likes",width:"100",type:"number",cellTemplate:'<div class="text-center ui-grid-cell-contents"><span class=" p-w-lg fw-normal">{{ row.entity.likes.length }}<i style="opacity: {{ row.entity.likes.length? 1:0 }}" class="p-1 bi bi-hand-thumbs-up"></i></span></div>'},{name:"Comments",displayName:"Comments",width:"100",type:"number",cellTemplate:'<div class="text-center ui-grid-cell-contents"><span class=" p-w-lg fw-normal">{{ row.entity.comments.length }}<i style="opacity: {{ row.entity.comments.length? 1:0 }}" class="p-1 bi bi-chat-left-text"><span style="font-size: xx-small; opacity: {{ row.entity.allComRead? 0:1 }}" class="ms-1 top-0 badge translate-middle-y bg-info text-dark">New <span class="visually-hidden">unread comments</span></span></i></span></div>'},{field:"report_name",displayName:"Report Name"},{field:"description",displayName:"Report Description",width:"270"},{field:"canvas_width",displayName:"Width",width:"70"},{field:"canvas_height",displayName:"Height",width:"70"},{field:"auto_width",displayName:"Auto Width",width:"70",type:"boolean",cellTemplate:'<input onclick="return false;" type="checkbox" ng-model="row.entity.auto_width">'},{field:"has_html",displayName:"Has HTML  Area",width:"70",type:"boolean",cellTemplate:'<input onclick="return false;" type="checkbox" ng-model="row.entity.has_html">'},{field:"create_date",sort:{direction:"desc",priority:1},displayName:"Create Date",width:"110",type:"date",cellFilter:"date"},{field:"stats.view",displayName:"Last Open",width:"110",type:"date",cellFilter:"date",cellTemplate:'<div  title="TOOLTIP" style="height:100%; width:{{grid.appScope.getWidth(grid, row)}}%; background-color: {{grid.appScope.getColor(grid, row)}} ; opacity: 0.9"><span class="ui-grid-cell-contents">{{grid.appScope.getValue(grid, row)}}</span></div>'},{field:"stats.save",displayName:"Last Update",width:"110",type:"date",cellFilter:"date"}],enableGridMenu:!0,exporterCsvFilename:"reports_list.csv",exporterPdfDefaultStyle:{fontSize:9},exporterPdfTableStyle:{margin:[30,30,30,30]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"red"},exporterPdfHeader:{text:"My Header",style:"headerStyle"},exporterPdfFooter:function(e,t){return{text:e.toString()+" of "+t.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(e){return e.styles.headerStyle={fontSize:22,bold:!0},e.styles.footerStyle={fontSize:10,bold:!0},e},exporterPdfOrientation:"portrait",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:500,exporterCsvLinkElement:s().element(document.querySelectorAll(".custom-csv-link-location")),exporterExcelFilename:"reports_list.xlsx",exporterExcelSheetName:"Sheet1"},a.getValue=function(e,t){return t.entity.stats.view?Cn(t.entity.stats.view).subtract(8,"hours").format("MMM DD, YYYY"):null},a.getWidth=function(e,t){var a=Cn().diff(Cn(t.entity.stats.view).subtract(8,"hours"),"days");return Math.min(100,a)},a.getColor=function(e,t){var a=Cn().diff(Cn(t.entity.stats.view).subtract(8,"hours"),"days"),n=Math.min(100,a);return Tn.getColorHTML(n/100)};var h="date:'yyyy-MMM-dd hh:mm'";a.getStatusText=function(e,t){return t.entity.lastFinishedAt||t.entity.failCount?t.entity.disabled?"Paused":t.entity.failCount&&Cn(t.entity.failedAt).isSame(Cn(t.entity.lastFinishedAt))?"Failed":"Completed":"New"},a.gridOptionsSub={enableColumnResizing:!0,enableFiltering:!0,showGridFooter:!1,showColumnFooter:!1,showHeader:!0,saveFocus:!1,saveSelection:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,data:a.ngDataSub,onRegisterApi:function(e){a.gridApiSub=e,e.cellNav.on.navigate(a,(function(e,t){a.gridApiSub.selection.selectRow(e.row.entity)})),e.selection.on.rowSelectionChanged(a,(function(){a.selSub=a.gridApiSub.selection.getSelectedRows()[0]}))},columnDefs:[{field:"name",displayName:"Status:",width:"100",cellClass:function(e,t,a,n,o){return t.entity.lastFinishedAt||t.entity.failCount?t.entity.disabled?"paused":t.entity.failCount&&Cn(t.entity.failedAt).isSame(Cn(t.entity.lastFinishedAt))?"fail":"success":"new"},cellTemplate:'<div class="ui-grid-cell-contents" title="TOOLTIP">{{grid.appScope.getStatusText(grid, row)}}</div>'},{field:"data.message.to_list",displayName:"To:",width:"200"},{field:"data.message.cc_list",displayName:"CC:",width:"200"},{field:"data.message.bcc_list",displayName:"Bcc:",width:"200"},{field:"data.message.type",displayName:"Type:",width:"110"},{field:"data.message.interval",displayName:"Interval/Schedule:",width:"200"},{field:"failCount",displayName:"Fails:",width:"50"},{field:"failReason",displayName:"Fail Reason:",width:"200"},{field:"failedAt",displayName:"Fail At:",width:"150",cellFilter:h},{field:"lastFinishedAt",displayName:"Latest Run At",width:"200",type:"date",cellFilter:h},{field:"nextRunAt",displayName:"Next Run At",width:"200",type:"date",cellFilter:h}]},a.gridOptionsPerm={enableColumnResizing:!0,enableFiltering:!0,showGridFooter:!1,showColumnFooter:!1,showHeader:!0,enableRowSelection:!0,enableRowHeaderSelection:!1,multiSelect:!1,data:a.ngDataSub,onRegisterApi:function(e){a.gridApiPerm=e},columnDefs:[{field:"user_id",displayName:"ID:",width:"200"},{field:"user_name",displayName:"Name:",width:"200"}]};var f=function(){a.sel=a.gridApi.selection.getSelectedRows(),a.sel.length&&(a.get_reports_sub=r.get(i().context+"/mongo/getAllSubscrByReportID?report_id="+a.sel[0].file_name).then((function(e){0===e.data.length?a.showEmptyMessageSub=!0:a.showEmptyMessageSub=!1,a.gridOptionsSub.data=e.data,a.selSub={}}),(function(e){})),a.sel[0].perm?a.gridOptionsPerm.data=a.sel[0].perm:a.gridOptionsPerm.data=[])},m=function(){a.get_reports=r.get(i().context+"/mongo/getUserReports?username="+a.username).then((function(e){0===e.data.length?a.gridOptions.data=[{report_name:"No report found"}]:(a.state=a.gridApi.saveState.save(),a.showEmptyMessage=!1,a.gridOptions.data=e.data,o((function(){a.gridApi.saveState.restore(a,a.state)}),1)),a.total=e.data.length}),(function(e){}))};m(),a.ok=function(){var e=a.gridApi.selection.getSelectedRows();e.length>0?e[0].strip_mode?window.open("#/st_editor/"+e[0].file_name,"_blank"):window.open("#/editor/"+e[0].file_name,"_blank"):alert("Nothing selected...!")},a.new=function(){a.editor.requestPublish([])},a.openPlayLists=function(){l.path("/playlists")},a.view=function(){var e=a.gridApi.selection.getSelectedRows();e.length>0?e[0].strip_mode?window.open("#/st_viewer/"+e[0].file_name,"_blank"):window.open("#/viewer/"+e[0].file_name,"_blank"):alert("Nothing selected...!")},a.edit=function(){var t=function(e){console.log("Updating report: '"+e.report_name+"'"),r.post(i().context+"/mongo/updateReport?reportID="+e._id,e).then((function(e){console.log("Report: '"+e.data.report_name+"' successfully updated"),m()})).catch((function(e){console.log(e.data)}))};c.open({templateUrl:"views/common/edit_report.html",controller:"editReportCtrl",backdrop:"static",scrollable:!1,resolve:{callback:function(){return t},report:function(){var t=a.gridApi.selection.getSelectedRows(),n=e.defer();return r.get(i().context+"/mongo/getReport?reportID="+t[0]._id).then((function(e){n.resolve(e.data[0])}),(function(e){})),n.promise}}})},a.cancel=function(){},a.delete=function(){var e=a.gridApi.selection.getSelectedRows();e.length>0?confirm("Are you sure you want to delete this Report?")&&r.get(i().context+"/mongo/deleteReport?file_name="+e[0].file_name+"&username="+t.username+"&proj_id="+t.project_id).then((function(t){Sn.ajax({url:i().context+"/mongo/getUserReports?username="+a.username,contentType:"application/json; charset=utf-8",type:"GET",success:function(t){alert("Report "+e[0].report_name+" was successfully deleted from server!");var n=a.gridOptions.data.indexOf(e[0]);a.gridOptions.data.splice(n,1),a.gridApi.core.refresh(),t.data&&0===t.data.length&&(a.showEmptyMessage=!0),a.gridOptions.data=t.data},error:function(e){}})}),(function(e){})):alert("Nothing selected...!")},a.disableSub=function(){var e=a.gridApiSub.selection.getSelectedRows();e.length&&(e[0].disabled?a.disable_job=r.get(i().context+"/agenda/enableJob?ID="+e[0]._id).then((function(e){f(),console.log("Subscription successfully resumed.")}),(function(e){})):a.disable_job=r.get(i().context+"/agenda/disableJob?ID="+e[0]._id).then((function(e){f(),console.log("Subscription successfully paused.")}),(function(e){})))},a.sendSub=function(){var e=a.gridApiSub.selection.getSelectedRows();e.length&&(a.exec_job=r.get(i().context+"/agenda/execJob?ID="+e[0]._id).then((function(e){console.log("Subscription successfully executed.")}),(function(e){})))},a.share=function(){var e=a.gridApi.selection.getSelectedRows();e.length>0?window.prompt("Copy to clipboard: Ctrl+C, Enter","/#/viewer/"+e[0].file_name):alert("Nothing selected...!")},a.newSub=function(){var e=function(e){console.log(e);var t,n=a.gridApi.selection.getSelectedRows();t=n[0].strip_mode?{to_list:"",cc_list:"",bcc_list:"",name:n[0].report_name,report_id:n[0].file_name,url:"http://"+l.host()+"/"+i().context+"#/st_renderer/"+n[0].file_name,interval:"",create_date:new Date,status:"New",log:"empty"}:{to_list:"",cc_list:"",bcc_list:"",name:n[0].report_name,report_id:n[0].file_name,url:"http://"+l.host()+"/"+i().context+"#/renderer/"+n[0].file_name,interval:"",create_date:new Date,status:"New",log:"empty"},t=Sn.extend(!0,t,e),a.create_job=r.post(i().context+"/agenda/createJob",t).then((function(e){console.log(e.data.message),f()}),(function(e){}))};c.open({templateUrl:"views/common/new_subscription.html",controller:"newSubscriptionCtrl",backdrop:"static",size:"lg",resolve:{callback:function(){return e},message:function(){return{type:"Interval"}}}})},a.editSub=function(){var t=function(e){console.log(e);var t=a.gridApiSub.selection.getSelectedRows();a.update_job=r.post(i().context+"/agenda/updateJob?ID="+t[0]._id,e).then((function(e){console.log("Subscription successfully created."),f()}),(function(e){}))},n=a.gridApiSub.selection.getSelectedRows();n.length&&c.open({templateUrl:"views/common/new_subscription.html",controller:"newSubscriptionCtrl",size:"lg",resolve:{callback:function(){return t},message:function(){var t=e.defer();return r.get(i().context+"/mongo/getSubscription?ID="+n[0]._id).then((function(e){t.resolve({to_list:e.data.data.message.to_list,cc_list:e.data.data.message.cc_list,bcc_list:e.data.data.message.bcc_list,reply_to:e.data.data.message.reply_to,name:e.data.data.message.name,report_id:e.data.data.message.report_id,url:e.data.data.message.url,interval:e.data.data.message.interval,create_date:e.data.data.message.create_date,status:e.data.data.message.status,log:e.data.data.message.log,type:e.data.data.message.type})}),(function(e){})),t.promise}}})},a.refreshSub=function(){f()},a.refreshReports=function(){m()},a.deleteSub=function(){var e=a.gridApiSub.selection.getSelectedRows();confirm("Are you sure you want to delete this Subscription?")&&(a.cancel_job=r.get(i().context+"/agenda/cancelJob?ID="+e[0]._id).then((function(t){if(t.data){console.log("Subscription successfully deleted."),alert("Subscription was successfully deleted from server!");var n=a.gridOptionsSub.data.indexOf(e[0]);a.gridOptionsSub.data.splice(n,1),a.gridApiSub.core.refresh()}})))},window.onbeforeunload=void 0}]).controller("myReportListCtrl",Hn).controller("myPlaylistsCtrl",Mn).controller("newSubscriptionCtrl",On).controller("newPalletIOtemCtrl",jn).controller("newPlaylistCtrl",Rn).controller("addPLReportCtrl",Ln).controller("testController",Bn).controller("mobController",zn).controller("editReportCtrl",Fn).controller("editPlaylistCtrl",Un).controller("BuildingController",["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants",at]).controller("NewFilterController",["$scope","$timeout","$uibModalInstance","figure","filterdata","$interval","uiGridConstants",st]).controller("TableEditorController",["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants",ut]).controller("TableViewerController",["$scope","$timeout","$uibModalInstance","valarr","$interval","uiGridConstants",ht]).controller("NewLibItemController",["$scope","$rootScope","$timeout","$http","$uibModalInstance","figure","edit","$interval","uiGridConstants",Ja]).controller("AllLibItemsController",["$scope","$rootScope","$timeout","$uibModalInstance","figure","items","$interval","$window","$http",Ya]).controller("NewNodeLibItemController",["$scope","$rootScope","$timeout","$http","$uibModalInstance","figure","property","nodeType","currentCode","edit","$interval","uiGridConstants",Ka]).controller("AllNodeLibItemsController",["$scope","$rootScope","$timeout","$uibModalInstance","figure","property","nodeType","items","$interval","$window","$http",$a]).controller("CodeFilterController",["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants",gt]).controller("ctlr_treema",["$scope","$timeout",yt.A]).controller("EditorController",["$scope","$uibModal","$timeout","$http","$compile","loginUserService","$location","$rootScope","$sce","$stateParams","report_json",Jt]).controller("StripEditorController",["$scope","$uibModal","$timeout","$http","$compile","loginUserService","$location","$rootScope","$sce","$stateParams","report_json",ra]).controller("FilterController",["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants",ua]).controller("main",["$scope","$uibModal","$timeout","$http","$compile","loginUserService","$location","$rootScope","$sce","$stateParams",ga]).controller("ModalInstanceCtrl",["$scope","$uibModalInstance","filename",function(e,t,a){e.filename=a,e.ok=function(){t.close()},e.cancel=function(){t.dismiss("cancel")}}]).controller("PlayerController",["$scope","$stateParams","$timeout","$http","$interval","playlist_result",ba]).controller("RendererController",["$scope","$rootScope","$stateParams","$timeout","report_json",wa]).controller("ScopeController",["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants",Ca]).controller("ScopeFilterController",["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants",Ea]).controller("UDFFilterController",["$scope","$timeout","$uibModalInstance","figure","$interval","uiGridConstants",Ma]).controller("ViewerController",["$scope","$http","$rootScope","$stateParams","$timeout","report_json",La]).controller("StripViewerController",["$scope","$http","$rootScope","report_json",Wa]).controller("AIReportModalCtrl",["$scope","$uibModalInstance","aiPromptHistory","modalType","errorArray",vn]).controller("AIRetryConfirmModalCtrl",["$scope","$uibModalInstance","$interval","nodeErrors",wn]).controller("AIConfigModalCtrl",["$scope","$uibModalInstance","$sce","$q","currentConfig","OpenRouterService",function(e,t,a,n,o,r){e.config=angular.copy(o||{}),e.zte_build=void 0!==e.config.zte_build&&e.config.zte_build,e.helpModal={show:!1,title:"",content:""},e.modelLoading={openrouter:!1,error:null},e.modelSearch={general:{query:"",models:[],showDropdown:!1},stage0:{query:"",models:[],showDropdown:!1},stage1:{query:"",models:[],showDropdown:!1},stage2:{query:"",models:[],showDropdown:!1},classification:{query:"",models:[],showDropdown:!1}};var s={};s=e.zte_build?{zte_v2:[{value:"nebulacoder-preview",text:"NebulaCoder-Preview",in_cost:0,out_cost:0},{value:"nebulacoder-cot-preview",text:"NebulaCoder-COT-Preview",in_cost:0,out_cost:0},{value:"nebulacoder",text:"NebulaCoder",in_cost:0,out_cost:0},{value:"nebulacoder-128K",text:"nebulacoder-128k",in_cost:0,out_cost:0},{value:"NTele-72B",text:"ZTEAIM-Saturn 3.0",in_cost:0,out_cost:0},{value:"nebulacoder-br",text:"nebulacoder-br",in_cost:0,out_cost:0}],dmarket:[{value:"qwen3-32b",text:"Qwen3-32B",in_cost:0,out_cost:0,options:[{enable_thinking:!1}]},{value:"deepseek-v3",text:"DeepSeek-V3",in_cost:0,out_cost:0},{value:"deepseek-r1-0528",text:"DeepSeek-R1-0528",in_cost:0,out_cost:0},{value:"deepseek-r1",text:"DeepSeek-R1",in_cost:0,out_cost:0,options:[{enable_thinking:!1}]},{value:"qwen3-235b-a22b",text:"Qwen3-235B-A22B",in_cost:0,out_cost:0,options:[{enable_thinking:!1}]}],fbopenai:[{value:"gpt-4.1-mini",text:"GPT 4.1 Mini",in_cost:0,out_cost:0},{value:"gpt-4.1",text:"GPT 4.1",in_cost:0,out_cost:0},{value:"gpt-4",text:"GPT 4",in_cost:0,out_cost:0},{value:"gpt-4o",text:"GPT 4o",in_cost:0,out_cost:0},{value:"gpt-4o-mini",text:"GPT 4o Mini",in_cost:0,out_cost:0},{value:"o3-mini",text:"GPT o3 Mini",in_cost:0,out_cost:0},{value:"o4-mini",text:"GPT o4 Mini",in_cost:0,out_cost:0},{value:"gpt-5-mini",text:"GPT 5 Mini",in_cost:0,out_cost:0}]}:{openrouter:[{value:"google/gemini-2.5-flash-preview",text:"Gemini 2.5 Flash",in_cost:.15,out_cost:.6},{value:"google/gemini-2.5-flash-preview:thinking",text:"Gemini 2.5 Flash Thinking",in_cost:.13,out_cost:3},{value:"google/gemini-2.5-flash-preview-05-20",text:"Gemini 2.5 Flash 05-20 Standard",in_cost:.15,out_cost:.6},{value:"google/gemini-2.5-flash-preview-05-20:thinking",text:"Gemini 2.5 Flash 05-20 Thinking",in_cost:.15,out_cost:3.5},{value:"google/gemini-2.5-pro-preview",text:"Gemini 2.5 Pro",in_cost:1.25,out_cost:10},{value:"google/gemini-2.0-flash-001",text:"Gemini 2.0 flash 001",in_cost:.1,out_cost:.4},{value:"qwen/qwen-turbo",text:"Qwen2.5 Turbo",in_cost:.5,out_cost:.2},{value:"qwen/qwen3-32b",text:"Qwen3-32b",in_cost:.1,out_cost:.3,options:[{enable_thinking:!1}]},{value:"qwen/qwen3-32b:free",text:"Qwen3-32b (Free)",in_cost:0,out_cost:0,options:[{enable_thinking:!1}]},{value:"qwen/qwen3-235b-a22b",text:"Qwen3-235b-a22b",in_cost:.14,out_cost:.6,options:[{enable_thinking:!1}]},{value:"qwen/qwen3-14b",text:"Qwen3-14b",in_cost:.07,out_cost:.24,options:[{enable_thinking:!1}]},{value:"qwen/qwen3-30b-a3b",text:"Qwen3-30b-a3b",in_cost:0,out_cost:0},{value:"qwen/qwen2.5-vl-32b-instruct:free",text:"Qwen2.5 VL-32b (Free)",in_cost:0,out_cost:0},{value:"qwen/qwen2.5-vl-32b-instruct",text:"Qwen2.5 VL-32b",in_cost:0,out_cost:0},{value:"anthropic/claude-sonnet-4",text:"Claude 4 Sonnet",in_cost:3,out_cost:15},{value:"anthropic/claude-opus-4",text:"Claude 4 Opus",in_cost:15,out_cost:75},{value:"anthropic/claude-3.7-sonnet",text:"Claude 3.7 Sonnet",in_cost:3,out_cost:15},{value:"anthropic/claude-3.7-sonnet:thinking",text:"Claude 3.7 Sonnet Thinking",in_cost:3,out_cost:15},{value:"anthropic/claude-3.5-haiku",text:"Claude 3.5 Haiku",in_cost:.8,out_cost:4},{value:"openai/gpt-4.1-mini-2025-04-14",text:"GPT-4.1 Mini",in_cost:.4,out_cost:1.6},{value:"openai/gpt-4.1-2025-04-14",text:"GPT-4.1",in_cost:2,out_cost:8},{value:"openai/gpt-4o-mini",text:"GPT-4o Mini",in_cost:.15,out_cost:.6},{value:"openai/gpt-4o",text:"GPT-4o",in_cost:2.5,out_cost:10},{value:"openai/o4-mini",text:"GPT-o4 Mini",in_cost:1.1,out_cost:4.4},{value:"openai/o4-mini-high",text:"GPT-o4 Mini High",in_cost:1.1,out_cost:4.4},{value:"deepseek/deepseek-r1-0528",text:"R1-0528",in_cost:.5,out_cost:2.15},{value:"deepseek/deepseek-prover-v2",text:"Prover-v2",in_cost:.5,out_cost:2.18},{value:"deepseek/deepseek-chat-v3-0324",text:"V3-0324",in_cost:.3,out_cost:.88},{value:"deepseek/deepseek-r1",text:"R1",in_cost:.45,out_cost:2.15},{value:"deepseek/deepseek-r1-distill-qwen-7b",text:"R1 Distill Qwen 7B",in_cost:.1,out_cost:.2}],zte_v2:[{value:"nebulacoder-preview",text:"NebulaCoder-Preview",in_cost:0,out_cost:0},{value:"nebulacoder-cot-preview",text:"NebulaCoder-COT-Preview",in_cost:0,out_cost:0},{value:"nebulacoder",text:"NebulaCoder",in_cost:0,out_cost:0},{value:"nebulacoder-128K",text:"nebulacoder-128k",in_cost:0,out_cost:0},{value:"NTele-72B",text:"ZTEAIM-Saturn 3.0",in_cost:0,out_cost:0},{value:"nebulacoder-br",text:"nebulacoder-br",in_cost:0,out_cost:0}],dmarket:[{value:"qwen3-32b",text:"Qwen3-32B",in_cost:0,out_cost:0,options:[{enable_thinking:!1}]},{value:"deepseek-v3",text:"DeepSeek-V3",in_cost:0,out_cost:0},{value:"deepseek-r1-0528",text:"DeepSeek-R1-0528",in_cost:0,out_cost:0},{value:"deepseek-r1",text:"DeepSeek-R1",in_cost:0,out_cost:0,options:[{enable_thinking:!1}]},{value:"qwen3-235b-a22b",text:"Qwen3-235B-A22B",in_cost:0,out_cost:0,options:[{enable_thinking:!1}]}],alibaba:[{value:"qwen3-32b",text:"Qwen3-32B",in_cost:.7,out_cost:2.8},{value:"qwen-turbo",text:"Qwen-Turbo",in_cost:.05,out_cost:.2},{value:"qwen-plus-2025-04-28",text:"Qwen-Plus",in_cost:.05,out_cost:.2},{value:"qwen3-235b-a22b",text:"Qwen-235B",in_cost:.05,out_cost:.2},{value:"qwen-max-latest",text:"Qwen-Max",in_cost:.05,out_cost:.2},{value:"qwen3-coder-plus",text:"Qwen-Coder",in_cost:1,out_cost:5}],fbopenai:[{value:"gpt-4.1-mini",text:"GPT 4.1 Mini",in_cost:0,out_cost:0},{value:"gpt-4.1",text:"GPT 4.1",in_cost:0,out_cost:0},{value:"gpt-4o",text:"GPT 4o",in_cost:0,out_cost:0},{value:"gpt-4o-mini",text:"GPT 4o Mini",in_cost:0,out_cost:0},{value:"o3-mini",text:"GPT o3 Mini",in_cost:0,out_cost:0},{value:"o4-mini",text:"GPT o4 Mini",in_cost:0,out_cost:0},{value:"gpt-5-mini",text:"GPT 5 Mini",in_cost:0,out_cost:0}]},e.availableProviders=e.zte_build?[{value:"fbopenai",text:"Fishbone OpenAI"},{value:"dmarket",text:"DMarket (ZTE)"}]:[{value:"openrouter",text:"OpenRouter"},{value:"fbopenai",text:"Fishbone OpenAI"},{value:"dmarket",text:"DMarket (ZTE)"},{value:"alibaba",text:"Alibaba"}];var l=e.availableProviders[0].value,c=s[l]&&s[l][0]?s[l][0].value:"",u={provider:l,model:c,apiKey:"",temperature:.7,maxTokens:16e3,stage0Provider:l,stage0Model:c,stage0Temperature:.3,stage0Retries:2,stage1Provider:l,stage1Model:c,stage1Temperature:.7,stage1Retries:2,stage2Provider:l,stage2Model:c,stage2Temperature:.3,stage2Retries:2,classificationProvider:l,classificationModel:c,classificationTemperature:.2,classificationTimeout:3e4,classificationCacheSize:50,enableRAG:!1,enableGranularComponentSearch:!0,ragThreshold:.65,ragMaxResults:5,enableExplanatoryAnalysis:!0,explanatoryAnalysisDepth:"comprehensive",requirementsGatheringMode:"conversational",conversationalTone:"friendly",enableFollowUpSuggestions:!0,maxFollowUpOptions:4,enableRequirementsGathering:!0,enableUserEducation:!0,enableStreaming:!0,enableDebug:!1,timeout:60,retryAttempts:3,chartLibrary:"echartjs",conversationMode:"continuous",useRequestEnhancement:!1,enableIncrementalUpdates:!0,enableEnhancedFallback:!0,fallbackConfidenceThreshold:.6,crossValidationEnabled:!0,enablePerformanceTracking:!0,performanceReportInterval:36e5,trackExplanatoryMetrics:!0,circuitBreakerThreshold:3,circuitBreakerTimeout:3e4,chatPanelWidth:400,chatPanelMinWidth:320,chatPanelMaxWidth:600,showConfigPanel:!1,showExplanatoryInsights:!0,log_request:!1};Object.keys(u).forEach((function(t){void 0===e.config[t]&&(e.config[t]=u[t])}));var d=e.availableProviders.map((function(e){return e.value}));["provider","stage0Provider","stage1Provider","stage2Provider","classificationProvider"].forEach((function(t){e.config[t]&&d.includes(e.config[t])||(e.config[t]=l)})),e.config.stage0ModelOptions=JSON.parse(localStorage.getItem("ai_stage0_model_options")||"{}"),e.config.stage1ModelOptions=JSON.parse(localStorage.getItem("ai_stage1_model_options")||"{}"),e.config.stage2ModelOptions=JSON.parse(localStorage.getItem("ai_stage2_model_options")||"{}"),e.config.classificationModelOptions=JSON.parse(localStorage.getItem("ai_classification_model_options")||"{}"),e.config.modelOptions||(e.config.modelOptions={});var p={defaultProvider:{title:"Default AI Provider",content:'\n                <div class="help-content">\n                    <p><strong>Selects the primary AI service for your assistant.</strong></p>\n                    \n                    <h6>Available Providers:</h6>\n                    <ul>\n                        <li><strong>OpenRouter:</strong> Access to multiple models through one API (Recommended)</li>\n                        <li><strong>OpenAI:</strong> GPT models directly from OpenAI</li>\n                        <li><strong>Anthropic:</strong> Claude models directly from Anthropic</li>\n                        <li><strong>DeepSeek:</strong> Advanced reasoning models</li>\n                        <li><strong>Google:</strong> Gemini models directly from Google</li>\n                        <li><strong>Ollama:</strong> Local models running on your machine</li>\n                        <li><strong>ZTE:</strong> Internal company models</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>Tip:</strong> OpenRouter is recommended as it provides access to the latest models from multiple providers with a single API key.\n                    </div>\n                </div>\n            '},defaultModel:{title:"Default Model",content:'\n                <div class="help-content">\n                    <p><strong>The specific AI model to use for general tasks.</strong></p>\n                    \n                    <h6>Model Selection Tips:</h6>\n                    <ul>\n                        <li><strong>Fast & Efficient:</strong> Gemini 2.5 Flash, GPT-4o Mini, Claude 3.5 Haiku</li>\n                        <li><strong>Balanced:</strong> GPT-4o, Claude 3.7 Sonnet, Gemini 2.5 Pro</li>\n                        <li><strong>Most Capable:</strong> Claude 4 Sonnet, GPT-4.1, Claude 4 Opus</li>\n                        <li><strong>Free Options:</strong> Qwen models via OpenRouter</li>\n                    </ul>\n                    \n                    <div class="alert alert-warning">\n                        <strong>Cost Consideration:</strong> More capable models cost more per token. Check the input/output costs listed.\n                    </div>\n                </div>\n            '},apiKey:{title:"API Key",content:'\n                <div class="help-content">\n                    <p><strong>Your authentication key for the AI provider.</strong></p>\n                    \n                    <h6>Where to Get API Keys:</h6>\n                    <ul>\n                        <li><strong>OpenRouter:</strong> openrouter.ai/keys</li>\n                        <li><strong>OpenAI:</strong> platform.openai.com/api-keys</li>\n                        <li><strong>Anthropic:</strong> console.anthropic.com/settings/keys</li>\n                        <li><strong>DeepSeek:</strong> platform.deepseek.com/api_keys</li>\n                        <li><strong>Google:</strong> makersuite.google.com/app/apikey</li>\n                    </ul>\n                    \n                    <div class="alert alert-success">\n                        <strong>Security:</strong> API keys are stored locally in your browser and never sent to our servers.\n                    </div>\n                    \n                    <div class="alert alert-info">\n                        <strong>One Key for All:</strong> If using multiple providers, you can use the same API key field - the system will apply it to all selected providers that need it.\n                    </div>\n                </div>\n            '},stageSettings:{title:"Stage-Specific Settings",content:'\n                <div class="help-content">\n                    <p><strong>Configure different AI models for different processing stages to optimize performance and cost.</strong></p>\n                    \n                    <h6>Why Use Different Models?</h6>\n                    <ul>\n                        <li><strong>Cost Optimization:</strong> Use cheaper models for simple tasks</li>\n                        <li><strong>Performance:</strong> Use specialized models for specific tasks</li>\n                        <li><strong>Reliability:</strong> Use more stable models for critical stages</li>\n                    </ul>\n                    \n                    <h6>Stage Breakdown:</h6>\n                    <ul>\n                        <li><strong>Stage 0:</strong> Request enhancement and clarification</li>\n                        <li><strong>Stage 1:</strong> Requirements analysis and planning</li>\n                        <li><strong>Stage 2:</strong> Final implementation and code generation</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>Recommendation:</strong> Use faster models (like Gemini Flash) for Stages 0 & 1, and more capable models (like Claude Sonnet) for Stage 2.\n                    </div>\n                </div>\n            '},stage0:{title:"Stage 0: Request Enhancement",content:'\n                <div class="help-content">\n                    <p><strong>Enhances and clarifies user requests before processing.</strong></p>\n                    \n                    <h6>What Stage 0 Does:</h6>\n                    <ul>\n                        <li>Clarifies vague or incomplete requests</li>\n                        <li>Adds context and details based on common patterns</li>\n                        <li>Transforms casual language into structured requirements</li>\n                        <li>Identifies missing information early</li>\n                    </ul>\n                    \n                    <h6>Recommended Models:</h6>\n                    <ul>\n                        <li><strong>Fast:</strong> Gemini 2.5 Flash, GPT-4o Mini</li>\n                        <li><strong>Quality:</strong> Claude 3.5 Haiku, Qwen3-32b</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>Temperature:</strong> Lower values (0.1-0.3) work best for consistent enhancement without creativity.\n                    </div>\n                </div>\n            '},stage1:{title:"Stage 1: Requirements Analysis",content:'\n                <div class="help-content">\n                    <p><strong>Analyzes enhanced requests and creates detailed requirements.</strong></p>\n                    \n                    <h6>What Stage 1 Does:</h6>\n                    <ul>\n                        <li>Breaks down requests into functional components</li>\n                        <li>Identifies required data sources and transformations</li>\n                        <li>Determines visualization needs</li>\n                        <li>Creates structured requirement documents</li>\n                    </ul>\n                    \n                    <h6>Recommended Models:</h6>\n                    <ul>\n                        <li><strong>Balanced:</strong> GPT-4o, Claude 3.7 Sonnet</li>\n                        <li><strong>Cost-Effective:</strong> Gemini 2.5 Flash, DeepSeek Chat</li>\n                    </ul>\n                    \n                    <div class="alert alert-warning">\n                        <strong>Temperature:</strong> Medium values (0.5-0.7) balance creativity with structure.\n                    </div>\n                </div>\n            '},stage2:{title:"Stage 2: Planning & Implementation",content:'\n                <div class="help-content">\n                    <p><strong>Creates detailed implementation plans and generates final configurations.</strong></p>\n                    \n                    <h6>What Stage 2 Does:</h6>\n                    <ul>\n                        <li>Converts requirements into executable plans</li>\n                        <li>Generates node configurations and connections</li>\n                        <li>Creates SQL queries and transformations</li>\n                        <li>Produces final report structure</li>\n                    </ul>\n                    \n                    <h6>Recommended Models:</h6>\n                    <ul>\n                        <li><strong>Most Capable:</strong> Claude 4 Sonnet, GPT-4.1</li>\n                        <li><strong>Code-Focused:</strong> DeepSeek Coder, GPT-4o</li>\n                        <li><strong>Cost-Effective:</strong> Claude 3.7 Sonnet</li>\n                    </ul>\n                    \n                    <div class="alert alert-danger">\n                        <strong>Critical Stage:</strong> This generates the final output. Use your most reliable model here.\n                    </div>\n                </div>\n            '},temperature:{title:"Temperature Setting",content:'\n                <div class="help-content">\n                    <p><strong>Controls the randomness and creativity of AI responses.</strong></p>\n                    \n                    <h6>Temperature Scale:</h6>\n                    <ul>\n                        <li><strong>0.0-0.2:</strong> Very deterministic, consistent outputs</li>\n                        <li><strong>0.3-0.5:</strong> Slightly creative, good for analysis</li>\n                        <li><strong>0.6-0.8:</strong> Balanced creativity and consistency</li>\n                        <li><strong>0.9-1.0:</strong> Very creative, less predictable</li>\n                        <li><strong>1.0+:</strong> Highly creative, can be chaotic</li>\n                    </ul>\n                    \n                    <h6>Recommended by Stage:</h6>\n                    <ul>\n                        <li><strong>Stage 0:</strong> 0.1-0.3 (consistent enhancement)</li>\n                        <li><strong>Stage 1:</strong> 0.5-0.7 (balanced analysis)</li>\n                        <li><strong>Stage 2:</strong> 0.2-0.4 (precise implementation)</li>\n                        <li><strong>Classification:</strong> 0.1-0.2 (consistent decisions)</li>\n                    </ul>\n                </div>\n            '},classificationSettings:{title:"Classification Settings",content:'\n                <div class="help-content">\n                    <p><strong>Controls how the AI understands and categorizes user requests.</strong></p>\n                    \n                    <h6>What Classification Does:</h6>\n                    <ul>\n                        <li>Determines user intent (create, update, help, etc.)</li>\n                        <li>Assesses requirement completeness</li>\n                        <li>Decides whether to ask for more info or proceed</li>\n                        <li>Generates conversational responses</li>\n                    </ul>\n                    \n                    <div class="alert alert-warning">\n                        <strong>Your Issue:</strong> If the AI keeps asking for details instead of proceeding, try:\n                        <ul>\n                            <li>Lower classification temperature (0.1)</li>\n                            <li>Use Claude or GPT models instead of Gemini</li>\n                            <li>Reduce classification timeout</li>\n                        </ul>\n                    </div>\n                </div>\n            '},classificationTemperature:{title:"Classification Temperature",content:'\n                <div class="help-content">\n                    <p><strong>Controls consistency of intent recognition and confidence assessment.</strong></p>\n                    \n                    <h6>Recommended Values:</h6>\n                    <ul>\n                        <li><strong>0.1:</strong> Very consistent, less likely to over-question</li>\n                        <li><strong>0.2:</strong> Default - balanced consistency</li>\n                        <li><strong>0.3:</strong> Slightly more flexible decisions</li>\n                    </ul>\n                    \n                    <div class="alert alert-success">\n                        <strong>Fix for Over-Questioning:</strong> Set to 0.1 to make the AI more decisive and less likely to keep asking for details.\n                    </div>\n                </div>\n            '},maxTokens:{title:"Max Tokens",content:'\n                <div class="help-content">\n                    <p><strong>Maximum length of AI responses in tokens (roughly 4 characters per token).</strong></p>\n                    \n                    <h6>Common Values:</h6>\n                    <ul>\n                        <li><strong>1000-2000:</strong> Short responses, chat-like</li>\n                        <li><strong>4000-6000:</strong> Medium responses, good for reports</li>\n                        <li><strong>8000-16000:</strong> Long responses, complex configurations</li>\n                        <li><strong>16000+:</strong> Very long responses (if model supports)</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>Cost Impact:</strong> Higher token limits increase costs but allow more detailed responses.\n                    </div>\n                </div>\n            '},ragSettings:{title:"RAG (Retrieval-Augmented Generation)",content:'\n                <div class="help-content">\n                    <p><strong>Uses existing reports and data to enhance AI responses with relevant examples.</strong></p>\n                    \n                    <h6>What RAG Does:</h6>\n                    <ul>\n                        <li>Searches for similar reports and components</li>\n                        <li>Provides AI with relevant examples</li>\n                        <li>Improves consistency and quality</li>\n                        <li>Reduces need to explain common patterns</li>\n                    </ul>\n                    \n                    <h6>When to Enable:</h6>\n                    <ul>\n                        <li>You have existing reports in the system</li>\n                        <li>Want consistent patterns across reports</li>\n                        <li>Working with repetitive business scenarios</li>\n                    </ul>\n                    \n                    <div class="alert alert-warning">\n                        <strong>Performance:</strong> RAG adds processing time but significantly improves output quality.\n                    </div>\n                </div>\n            '},enableRAG:{title:"Enable RAG",content:'\n                <div class="help-content">\n                    <p><strong>Turns on Retrieval-Augmented Generation for enhanced responses.</strong></p>\n                    \n                    <div class="alert alert-success">\n                        <strong>Benefits:</strong>\n                        <ul>\n                            <li>More accurate and relevant responses</li>\n                            <li>Consistent with existing reports</li>\n                            <li>Better understanding of your data patterns</li>\n                        </ul>\n                    </div>\n                    \n                    <div class="alert alert-warning">\n                        <strong>Requirements:</strong>\n                        <ul>\n                            <li>Existing reports in the system</li>\n                            <li>Slightly longer processing time</li>\n                            <li>Additional system resources</li>\n                        </ul>\n                    </div>\n                </div>\n            '},enableGranularComponentSearch:{title:"Enable Granular Component Search",content:'\n                <div class="help-content">\n                    <p><strong>Enables searching through granular components (individual nodes and connections) for enhanced report generation.</strong></p>\n                    \n                    <h6>What This Does:</h6>\n                    <ul>\n                        <li>Searches through specific report components like nodes, SQL queries, and transformations</li>\n                        <li>Finds relevant patterns from similar report parts</li>\n                        <li>Provides more detailed and specific suggestions</li>\n                        <li>Improves accuracy for technical implementations</li>\n                    </ul>\n                    \n                    <h6>Difference from General RAG:</h6>\n                    <ul>\n                        <li><strong>General RAG:</strong> Searches full reports and functional branches</li>\n                        <li><strong>Granular Search:</strong> Searches individual components and technical patterns</li>\n                    </ul>\n                    \n                    <div class="alert alert-success">\n                        <strong>Benefits:</strong>\n                        <ul>\n                            <li>More precise technical suggestions</li>\n                            <li>Better SQL query generation</li>\n                            <li>Improved node configuration recommendations</li>\n                            <li>Enhanced pattern recognition for similar implementations</li>\n                        </ul>\n                    </div>\n                    \n                    <div class="alert alert-info">\n                        <strong>Note:</strong> This setting requires General RAG to be enabled and works best with existing reports that have been processed for granular components.\n                    </div>\n                </div>\n            '},ragThreshold:{title:"RAG Similarity Threshold",content:'\n                <div class="help-content">\n                    <p><strong>Minimum similarity score (0-1) for including retrieved examples.</strong></p>\n                    \n                    <h6>Threshold Guide:</h6>\n                    <ul>\n                        <li><strong>0.3-0.5:</strong> Very loose matching, more examples</li>\n                        <li><strong>0.6-0.7:</strong> Balanced matching (recommended)</li>\n                        <li><strong>0.8-0.9:</strong> Strict matching, fewer but more relevant examples</li>\n                        <li><strong>0.9+:</strong> Very strict, only near-exact matches</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>Tuning:</strong> Start with 0.65. Lower if you want more examples, raise if examples seem irrelevant.\n                    </div>\n                </div>\n            '},promptStrategy:{title:"Prompt Strategy Selection",content:'\n                <div class="help-content">\n                    <h6>Available Strategies:</h6>\n                    \n                    <div class="alert alert-info">\n                        <strong>Normal:</strong> Original system using all available node types including SQL, Transform, and Union nodes with Vega transforms.\n                        <br><small>Best for: Traditional workflows, existing reports, full feature compatibility</small>\n                    </div>\n                    \n                    <div class="alert alert-success">\n                        <strong>Requirements Driven:</strong> Optimized system with intelligent reference filtering and token reduction.\n                        <br><small>Best for: Complex reports, cost optimization, faster processing</small>\n                        <ul class="mt-2 mb-0">\n                            <li>Up to 50% reduction in token usage</li>\n                            <li>Smart filtering of reference data</li>\n                            <li>Improved response relevance</li>\n                        </ul>\n                    </div>\n                    \n                    <div class="alert alert-warning">\n                        <strong>JavaScript Centric:</strong> Modern approach using only Mathnode with pure JavaScript for all data manipulation.\n                        <br><small>Best for: Custom logic, unified architecture, better AI generation</small>\n                        <ul class="mt-2 mb-0">\n                            <li>Single node type for all data operations</li>\n                            <li>Better AI code generation (JavaScript vs Vega)</li>\n                            <li>Standard debugging tools</li>\n                            <li>Full programming language capabilities</li>\n                            <li>No SQL/Transform/Union nodes available</li>\n                        </ul>\n                    </div>\n                    \n                    <h6>Node Availability by Strategy:</h6>\n                    <table class="table table-sm">\n                        <thead>\n                            <tr>\n                                <th>Node Type</th>\n                                <th>Normal</th>\n                                <th>Requirements Driven</th>\n                                <th>JavaScript Centric</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr>\n                                <td>SQL Node</td>\n                                <td>✅</td>\n                                <td>✅</td>\n                                <td>❌</td>\n                            </tr>\n                            <tr>\n                                <td>Transform Node</td>\n                                <td>✅</td>\n                                <td>✅</td>\n                                <td>❌</td>\n                            </tr>\n                            <tr>\n                                <td>Union Node</td>\n                                <td>✅</td>\n                                <td>✅</td>\n                                <td>❌</td>\n                            </tr>\n                            <tr>\n                                <td>Math Node</td>\n                                <td>✅</td>\n                                <td>✅</td>\n                                <td>✅ (Primary)</td>\n                            </tr>\n                            <tr>\n                                <td>All Other Nodes</td>\n                                <td>✅</td>\n                                <td>✅</td>\n                                <td>✅</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            '},ragMaxResults:{title:"RAG Max Results",content:'\n                <div class="help-content">\n                    <p><strong>Maximum number of similar examples to retrieve for each query.</strong></p>\n                    \n                    <h6>Recommended Values:</h6>\n                    <ul>\n                        <li><strong>3-5:</strong> Balanced performance and quality</li>\n                        <li><strong>6-10:</strong> More context, slower processing</li>\n                        <li><strong>1-2:</strong> Fastest, minimal context</li>\n                    </ul>\n                    \n                    <div class="alert alert-warning">\n                        <strong>Performance Trade-off:</strong> More results = better context but slower processing and higher token usage.\n                    </div>\n                </div>\n            '},conversationalTone:{title:"Conversational Tone",content:'\n                <div class="help-content">\n                    <p><strong>The personality and style of AI responses.</strong></p>\n                    \n                    <h6>Tone Options:</h6>\n                    <ul>\n                        <li><strong>Professional:</strong> Formal, business-focused</li>\n                        <li><strong>Friendly:</strong> Casual, approachable</li>\n                        <li><strong>Educational:</strong> Teaching-focused, detailed explanations</li>\n                        <li><strong>Adaptive:</strong> Matches user\'s communication style</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>User Experience:</strong> Choose the tone that best matches your team\'s communication preferences.\n                    </div>\n                </div>\n            '},classificationTimeout:{title:"Classification Timeout",content:'\n                <div class="help-content">\n                    <p><strong>Maximum time (in milliseconds) to wait for intent classification.</strong></p>\n                    \n                    <h6>Timeout Values:</h6>\n                    <ul>\n                        <li><strong>5000-10000ms:</strong> Fast timeout, quick fallback</li>\n                        <li><strong>15000-20000ms:</strong> Balanced (recommended)</li>\n                        <li><strong>30000ms+:</strong> Patient waiting, fewer fallbacks</li>\n                    </ul>\n                    \n                    <div class="alert alert-success">\n                        <strong>Fix for Over-Questioning:</strong> Lower timeout (10000ms) forces faster decisions and reduces complex analysis that leads to more questions.\n                    </div>\n                </div>\n            '},chartLibrary:{title:"Chart Library",content:'\n                <div class="help-content">\n                    <p><strong>Select the chart library for JavaScript-centric visualizations.</strong></p>\n                    \n                    <h6>Available Libraries:</h6>\n                    <ul>\n                        <li><strong>Chart.js:</strong> Lightweight, responsive canvas-based charts with simple API</li>\n                        <li><strong>ECharts.js:</strong> Powerful, feature-rich visualization library with advanced interactions</li>\n                    </ul>\n                    \n                    <h6>When to Use Chart.js:</h6>\n                    <ul>\n                        <li>Simple bar, line, pie, and doughnut charts</li>\n                        <li>Lightweight applications where bundle size matters</li>\n                        <li>Quick prototyping and standard business charts</li>\n                    </ul>\n                    \n                    <h6>When to Use ECharts.js:</h6>\n                    <ul>\n                        <li>Complex visualizations like treemaps, sunburst, and custom charts</li>\n                        <li>Advanced interactions, animations, and data zoom</li>\n                        <li>High-performance rendering for large datasets</li>\n                        <li>Rich geographic mapping capabilities</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>Default:</strong> ECharts.js is set as default for its advanced capabilities and performance.\n                    </div>\n                </div>\n            '},conversationMode:{title:"Conversation Mode",content:'\n                <div class="help-content">\n                    <p><strong>Controls how context is maintained between report generation stages.</strong></p>\n                    \n                     <h6>Continuous Mode:</h6>\n                    <ul>\n                        <li>Maintains full conversation history across stages</li>\n                        <li>AI can reference its own previous reasoning</li>\n                        <li>More coherent and intelligent decisions</li>\n                        <li>50-60% fewer tokens used (~25-35K tokens total)</li>\n                        <li>Better context preservation and flow</li>\n                    </ul>\n                    \n                    <h6>Isolated Mode:</h6>\n                    <ul>\n                        <li>Each stage starts with a fresh conversation</li>\n                        <li>Core concepts are re-explained in every stage</li>\n                        <li>More predictable and debuggable behavior</li>\n                        <li>Higher token usage (~60-80K tokens total)</li>\n                        <li>Easier to retry individual stages</li>\n                    </ul>\n                    \n                    <h6>One-Stage Mode (New):</h6>\n                    <ul>\n                        <li>Single API call combining all stages</li>\n                        <li>Maximum speed with unified processing</li>\n                        <li>Lowest token usage (~15-25K tokens total)</li>\n                        <li>Best for simple to medium complexity reports</li>\n                        <li>No stage breakdown - all-or-nothing approach</li>\n                    </ul>\n                    \n                    <div class="alert alert-success">\n                        <strong>Recommendation:</strong> Use One-Stage for speed, Continuous for efficiency with complexity, or Isolated for debugging.\n                    </div>\n                </div>\n            '},useRequestEnhancement:{title:"Use Request Enhancement",content:'\n                <div class="help-content">\n                    <p><strong>Enables Stage 0 processing to enhance user requests before analysis.</strong></p>\n                    \n                    <h6>When Enabled:</h6>\n                    <ul>\n                        <li>User requests are pre-processed by Stage 0 model</li>\n                        <li>Vague requests get clarified automatically</li>\n                        <li>Missing context is intelligently added</li>\n                        <li>Better understanding of user intent</li>\n                    </ul>\n                    \n                    <h6>When Disabled (Default):</h6>\n                    <ul>\n                        <li>User requests are processed as-is</li>\n                        <li>Faster processing (skips Stage 0)</li>\n                        <li>More direct user control</li>\n                        <li>No automatic interpretation</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>Recommendation:</strong> Enable for users who provide brief or unclear requests. Keep disabled for technical users who provide specific requirements.\n                    </div>\n                </div>\n            '},enableFollowUpSuggestions:{title:"Enable Follow-up Suggestions",content:'\n                <div class="help-content">\n                    <p><strong>Shows clickable suggestion buttons after AI responses.</strong></p>\n                    \n                    <h6>What You Get:</h6>\n                    <ul>\n                        <li>Quick-click options like "weekly", "monthly", "this year"</li>\n                        <li>Common follow-up actions</li>\n                        <li>Faster user interaction</li>\n                        <li>Reduced typing for common requests</li>\n                    </ul>\n                    \n                    <div class="alert alert-success">\n                        <strong>User Experience:</strong> These are the blue buttons you see in the chat like "weekly base", "this year", etc. Very helpful for quick responses.\n                    </div>\n                </div>\n            '},enableRequirementsGathering:{title:"Enable Requirements Gathering",content:'\n                <div class="help-content">\n                    <p><strong>Controls whether AI actively asks for missing information.</strong></p>\n                    \n                    <h6>When Enabled (Default):</h6>\n                    <ul>\n                        <li>AI asks follow-up questions for clarity</li>\n                        <li>Gathers missing requirements through conversation</li>\n                        <li>More thorough requirement analysis</li>\n                        <li>May lead to longer conversations</li>\n                    </ul>\n                    \n                    <h6>When Disabled:</h6>\n                    <ul>\n                        <li>AI works with available information</li>\n                        <li>Proceeds with reasonable assumptions</li>\n                        <li>Faster to actual report generation</li>\n                        <li>Less questioning and clarification</li>\n                    </ul>\n                    \n                    <div class="alert alert-danger">\n                        <strong>Your Main Issue:</strong> This is likely causing your endless questioning problem. Try disabling this to make AI more decisive and less likely to ask for additional details.\n                    </div>\n                </div>\n            '},requestTimeout:{title:"Request Timeout",content:'\n                <div class="help-content">\n                    <p><strong>Maximum time to wait for AI provider responses (in seconds).</strong></p>\n                    \n                    <h6>Recommended Values:</h6>\n                    <ul>\n                        <li><strong>30-60 seconds:</strong> Standard timeout</li>\n                        <li><strong>60-120 seconds:</strong> For complex requests</li>\n                        <li><strong>120+ seconds:</strong> For very long operations</li>\n                    </ul>\n                    \n                    <div class="alert alert-warning">\n                        <strong>Balance:</strong> Too short = failed requests, too long = user frustration waiting for timeouts.\n                    </div>\n                </div>\n            '},retryAttempts:{title:"Retry Attempts",content:'\n                <div class="help-content">\n                    <p><strong>Number of times to retry failed API requests.</strong></p>\n                    \n                    <h6>Recommended Values:</h6>\n                    <ul>\n                        <li><strong>0:</strong> No retries, fail fast</li>\n                        <li><strong>1-2:</strong> Quick recovery from temporary issues</li>\n                        <li><strong>3-5:</strong> Persistent retry for important requests</li>\n                    </ul>\n                    \n                    <div class="alert alert-info">\n                        <strong>Network Issues:</strong> Higher retry counts help with unstable internet connections but increase total wait time on failures.\n                    </div>\n                </div>\n            '},log_request:{title:"Enable Request Logging",content:'\n                <div class="help-content">\n                    <p><strong>Logs all AI requests and responses for analysis and debugging.</strong></p>\n                    \n                    <h6>What Gets Logged:</h6>\n                    <ul>\n                        <li>Full request messages and parameters</li>\n                        <li>Complete response data and metadata</li>\n                        <li>Stage information and operation context</li>\n                        <li>Token usage and cost calculations</li>\n                        <li>Request timing and performance data</li>\n                        <li>Error details when requests fail</li>\n                    </ul>\n                    \n                    <h6>Storage Details:</h6>\n                    <ul>\n                        <li><strong>Location:</strong> Browser localStorage</li>\n                        <li><strong>Format:</strong> JSONL (newline-delimited JSON)</li>\n                        <li><strong>Retention:</strong> 30 days automatic cleanup</li>\n                        <li><strong>Privacy:</strong> Data stays in your browser</li>\n                    </ul>\n                    \n                    <h6>Access Your Logs:</h6>\n                    <ul>\n                        <li>Open browser console and type: <code>aiLogger.exportLogs()</code></li>\n                        <li>Or use: <code>aiLogger.getLogSummary()</code> for statistics</li>\n                        <li>Files are automatically downloaded as .jsonl format</li>\n                    </ul>\n                    \n                    <div class="alert alert-success">\n                        <strong>AI Analysis Ready:</strong> The log format is optimized for analysis by AI models, making it easy to study conversation patterns and optimize prompts.\n                    </div>\n                    \n                    <div class="alert alert-warning">\n                        <strong>Performance:</strong> Minimal impact when enabled. Logs are processed asynchronously and stored efficiently.\n                    </div>\n                </div>\n            '}};function h(){var t=["openai"],a=[e.config.provider,e.config.stage0Provider,e.config.stage1Provider,e.config.stage2Provider,e.config.classificationProvider],n=xn(new Set(a.filter((function(e){return t.includes(e)}))));if(n.length>0&&!e.config.apiKey){var o,i=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=kn(e))){t&&(e=t);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,r=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){r=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(r)throw o}}}}(n);try{for(i.s();!(o=i.n()).done;){var r=o.value,s=localStorage.getItem("ai_"+r+"_key");if(s){e.config.apiKey=s;break}}}catch(e){i.e(e)}finally{i.f()}}}function f(){var t="".concat(i().context,"/qdrant/user-requirements/list");fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:window.user_id})}).then((function(e){return e.json()})).then((function(t){e.preferences=t.requirements||[],console.log("[AIConfigModal] Loaded",e.preferences.length,"preferences"),e.$apply()})).catch((function(e){console.error("[AIConfigModal] Failed to load preferences:",e),alert("Failed to load preferences. Please try again.")}))}e.getModelsForProvider=function(t){return"openrouter"===t?e.openRouterModels||[]:s[t]||[]},e.openRouterModels=[],e.openRouterModelsOriginal=[],e.loadOpenRouterModels=function(){return e.modelLoading.openrouter?n.resolve():(console.log("[AIConfigModalCtrl] Loading OpenRouter models..."),e.modelLoading.openrouter=!0,e.modelLoading.error=null,r.getModels().then((function(t){console.log("[AIConfigModalCtrl] Loaded ".concat(t.length," OpenRouter models")),e.openRouterModels=t,e.openRouterModelsOriginal=angular.copy(t),["general","stage0","stage1","stage2","classification"].forEach((function(a){var n=e.getFieldConfig(a),o=e.modelSearch[a];if("openrouter"===n.provider||o&&o.pendingInit){var i=t.find((function(e){return e.value===n.model}));i&&(e.modelSearch[a].query=i.text,e.modelSearch[a].lastKnownText=i.text,e.modelSearch[a].pendingInit=!1),e.initializeModelSearch(a)}})),e.modelLoading.openrouter=!1,e.$apply()})).catch((function(t){return console.error("[AIConfigModalCtrl] Error loading OpenRouter models:",t),e.modelLoading.error="Failed to load OpenRouter models. Using fallback list.",e.modelLoading.openrouter=!1,e.openRouterModels=r.getFallbackModels?r.getFallbackModels():s.openrouter||[],e.openRouterModelsOriginal=angular.copy(e.openRouterModels),["general","stage0","stage1","stage2","classification"].forEach((function(t){"openrouter"===e.getFieldConfig(t).provider&&e.initializeModelSearch(t)})),e.$apply(),n.reject(t)})))},e.getFieldConfig=function(t){return{general:{provider:e.config.provider,model:e.config.model},stage0:{provider:e.config.stage0Provider,model:e.config.stage0Model},stage1:{provider:e.config.stage1Provider,model:e.config.stage1Model},stage2:{provider:e.config.stage2Provider,model:e.config.stage2Model},classification:{provider:e.config.classificationProvider,model:e.config.classificationModel}}[t]||{}},e.searchModels=function(t,a){var n=e.getFieldConfig(t),o=[];if(!a||a.trim().length<2)return e.modelSearch[t].models=[],void(e.modelSearch[t].showDropdown=!1);if("openrouter"===n.provider)o=r.searchModels(e.openRouterModelsOriginal||[],a);else{var i=e.getModelsForProvider(n.provider)||[];o=r.searchModels(i,a)}var s=n.model;s&&(o=o.filter((function(e){return e.value!==s}))),e.modelSearch[t].models=o||[],e.modelSearch[t].showDropdown=o.length>0&&a&&a.trim().length>0,e.modelSearch[t].selectedIndex=-1},e.updateModelSearch=function(t){var a=e.modelSearch[t].query;e.searchModels(t,a)},e.onModelSearchInput=function(t){var a=e.modelSearch[t].query;e.getFieldConfig(t),a!==e.modelSearch[t].lastKnownText&&e.searchModels(t,a)},e.onModelSearchFocus=function(t){e.modelSearch[t].showDropdown=!1,e.modelSearch[t].models=[]},e.selectModel=function(t,a){switch(e.getFieldConfig(t),t){case"general":e.config.model=a.value;break;case"stage0":e.config.stage0Model=a.value;break;case"stage1":e.config.stage1Model=a.value;break;case"stage2":e.config.stage2Model=a.value;break;case"classification":e.config.classificationModel=a.value}e.modelSearch[t].query=a.text,e.modelSearch[t].lastKnownText=a.text,e.modelSearch[t].showDropdown=!1,e.modelSearch[t].selectedIndex=-1,e.modelSearch[t].models=[],console.log("[AIConfigModalCtrl] Selected model for ".concat(t,": ").concat(a.value))},e.isOpenRouterField=function(t){return"openrouter"===e.getFieldConfig(t).provider},e.hideModelDropdown=function(t){setTimeout((function(){e.modelSearch[t].showDropdown=!1,e.modelSearch[t].selectedIndex=-1,e.$apply()}),200)},e.onModelSearchKeyDown=function(t,a){if(e.modelSearch[t]&&e.modelSearch[t].showDropdown){var n=e.modelSearch[t].models;if(n&&0!==n.length)switch(a.keyCode){case 38:a.preventDefault(),e.modelSearch[t].selectedIndex>0?e.modelSearch[t].selectedIndex--:e.modelSearch[t].selectedIndex=n.length-1;break;case 40:a.preventDefault(),e.modelSearch[t].selectedIndex<n.length-1?e.modelSearch[t].selectedIndex++:e.modelSearch[t].selectedIndex=0;break;case 13:if(a.preventDefault(),e.modelSearch[t].selectedIndex>=0&&e.modelSearch[t].selectedIndex<n.length){var o=n[e.modelSearch[t].selectedIndex];e.selectModel(t,o)}break;case 27:a.preventDefault(),e.modelSearch[t].showDropdown=!1,e.modelSearch[t].selectedIndex=-1}}},e.isModelSelected=function(t,a){return e.modelSearch[t]&&e.modelSearch[t].selectedIndex===a},e.initializeModelSearch=function(t){e.modelSearch[t]||(e.modelSearch[t]={query:"",models:[],showDropdown:!1,selectedIndex:-1});var a=e.getFieldConfig(t);if(a.model&&"openrouter"===a.provider)if(e.openRouterModels&&e.openRouterModels.length>0){var n=e.openRouterModels.find((function(e){return e.value===a.model}));n?(e.modelSearch[t].query=n.text,e.modelSearch[t].lastKnownText=n.text):(e.modelSearch[t].query=e.formatModelDisplay(a.model),e.modelSearch[t].lastKnownText=e.modelSearch[t].query)}else e.modelSearch[t].query=e.formatModelDisplay(a.model),e.modelSearch[t].lastKnownText=e.modelSearch[t].query,e.modelSearch[t].pendingInit=!0;else if(a.model){var o=e.getSelectedModel(a.model);e.modelSearch[t].query=o?o.text:a.model,e.modelSearch[t].lastKnownText=e.modelSearch[t].query}e.modelSearch[t].models=[],e.modelSearch[t].showDropdown=!1},e.formatModelDisplay=function(e){if(!e)return"";var t=e.split("/"),a=(t.length>1?t[1]:e).replace(/-/g," ").replace(/\b\w/g,(function(e){return e.toUpperCase()})).replace(/Gpt/g,"GPT").replace(/Api/g,"API").replace(/Ai/g,"AI");return t.length>1?"".concat(t[0],"/").concat(a):a},e.getSelectedModel=function(e){if(!e)return null;for(var t in s){var a=s[t].find((function(t){return t.value===e}));if(a)return a}return null},e.getModelOptions=function(t){var a=e.getSelectedModel(t);return(null==a?void 0:a.options)||[]},e.getOptionKey=function(e){return Object.keys(e)[0]},e.getOptionValue=function(e){return e[Object.keys(e)[0]]},e.config.modelOptions||(e.config.modelOptions={}),e.onProviderChange=function(t){var a=e.config[t];"openrouter"===a&&0===e.openRouterModels.length&&e.loadOpenRouterModels();var n,o=e.getModelsForProvider(a);switch(t){case"stage0Provider":n="stage0Model";break;case"stage1Provider":n="stage1Model";break;case"stage2Provider":n="stage2Model";break;case"classificationProvider":n="classificationModel";break;default:n="model"}var i=e.config[n];if(o.some((function(e){return e.value===i}))&&i)console.log("[AIConfigModalCtrl] Provider changed to ".concat(a,', keeping valid model "').concat(i,'"'));else{var r,s=null;if(i){var l=i.toLowerCase();if(!(s=o.find((function(e){return e.value.toLowerCase()===l})))){var c=l.includes("/")?l.split("/").pop():l;s=o.find((function(e){return(e.value.toLowerCase().includes("/")?e.value.toLowerCase().split("/").pop():e.value.toLowerCase())===c}))}}e.config[n]=s?s.value:(null===(r=o[0])||void 0===r?void 0:r.value)||"",console.log("[AIConfigModalCtrl] Provider changed to ".concat(a,', model updated from "').concat(i,'" to "').concat(e.config[n],'"'))}var u,d=e.getSelectedModel(e.config[n]);if(null!=d&&d.options){var p=null;switch(n){case"stage0Model":p="stage0ModelOptions";break;case"stage1Model":p="stage1ModelOptions";break;case"stage2Model":p="stage2ModelOptions";break;case"classificationModel":p="classificationModelOptions";break;default:var h=d.value;return e.config.modelOptions[h]=e.config.modelOptions[h]||{},void d.options.forEach((function(t){var a=Object.keys(t)[0];void 0===e.config.modelOptions[h][a]&&(e.config.modelOptions[h][a]=t[a])}))}p&&(e.config[p]||(e.config[p]={}),d.options.forEach((function(t){var a=Object.keys(t)[0];void 0===e.config[p][a]&&(e.config[p][a]=t[a])})))}switch(t){case"provider":default:u="general";break;case"stage0Provider":u="stage0";break;case"stage1Provider":u="stage1";break;case"stage2Provider":u="stage2";break;case"classificationProvider":u="classification"}e.modelSearch[u]||(e.modelSearch[u]={query:"",models:[],showDropdown:!1,selectedIndex:-1}),e.initializeModelSearch(u)},["provider","stage0Provider","stage1Provider","stage2Provider","classificationProvider"].some((function(t){return"openrouter"===e.config[t]}))?e.loadOpenRouterModels().then((function(){["provider","stage0Provider","stage1Provider","stage2Provider","classificationProvider"].forEach((function(t){e.onProviderChange(t)})),setTimeout((function(){["general","stage0","stage1","stage2","classification"].forEach((function(t){e.initializeModelSearch(t)})),e.$apply()}),100)})).catch((function(){["provider","stage0Provider","stage1Provider","stage2Provider","classificationProvider"].forEach((function(t){e.onProviderChange(t)})),setTimeout((function(){["general","stage0","stage1","stage2","classification"].forEach((function(t){e.initializeModelSearch(t)})),e.$apply()}),100)})):(["provider","stage0Provider","stage1Provider","stage2Provider","classificationProvider"].forEach((function(t){e.onProviderChange(t)})),setTimeout((function(){["general","stage0","stage1","stage2","classification"].forEach((function(t){e.initializeModelSearch(t)})),e.$apply()}),100)),e.showApiKey=!1,e.showHelp=function(t){var n=p[t];n&&(e.helpModal={show:!0,title:n.title,content:a.trustAsHtml(n.content)})},e.closeHelp=function(){e.helpModal={show:!1,title:"",content:""}},e.resetToDefaults=function(){e.config=angular.copy(u),["provider","stage0Provider","stage1Provider","stage2Provider","classificationProvider"].forEach((function(t){e.onProviderChange(t)}))},e.save=function(){var a=function(){var t=[];e.config.provider&&e.config.model||t.push("Please select both provider and model for general settings"),[{provider:"stage0Provider",model:"stage0Model",name:"Stage 0"},{provider:"stage1Provider",model:"stage1Model",name:"Stage 1"},{provider:"stage2Provider",model:"stage2Model",name:"Stage 2"}].forEach((function(a){e.config[a.provider]&&e.config[a.model]||t.push("Please select both provider and model for ".concat(a.name))})),e.config.classificationProvider&&e.config.classificationModel||t.push("Please select both provider and model for classification");var a=["openai","anthropic","openrouter","deepseek","google"],n=[e.config.provider,e.config.stage0Provider,e.config.stage1Provider,e.config.stage2Provider,e.config.classificationProvider],o=xn(new Set(n.filter((function(e){return a.includes(e)}))));return o.length>0&&!e.config.apiKey&&t.push("API Key is required for: ".concat(o.join(", "))),t}();if(a.length>0)alert("Validation errors:\n\n"+a.join("\n"));else{if(console.log("[AIConfigModalCtrl] Configuration before save:",{general:{provider:e.config.provider,model:e.config.model},stage0:{provider:e.config.stage0Provider,model:e.config.stage0Model},stage1:{provider:e.config.stage1Provider,model:e.config.stage1Model},stage2:{provider:e.config.stage2Provider,model:e.config.stage2Model},classification:{provider:e.config.classificationProvider,model:e.config.classificationModel}}),e.config.apiKey){var n=["openai","anthropic","openrouter","deepseek","google"],o=[e.config.provider,e.config.stage0Provider,e.config.stage1Provider,e.config.stage2Provider,e.config.classificationProvider];xn(new Set(o.filter((function(e){return n.includes(e)})))).forEach((function(t){localStorage.setItem("ai_"+t+"_key",e.config.apiKey),console.log("[AIConfigModalCtrl] Saved API key for provider: ".concat(t))}))}localStorage.setItem("ai_stage0_model_options",JSON.stringify(e.config.stage0ModelOptions||{})),localStorage.setItem("ai_stage1_model_options",JSON.stringify(e.config.stage1ModelOptions||{})),localStorage.setItem("ai_stage2_model_options",JSON.stringify(e.config.stage2ModelOptions||{})),localStorage.setItem("ai_classification_model_options",JSON.stringify(e.config.classificationModelOptions||{})),localStorage.setItem("ai_conversation_mode",e.config.conversationMode);var i=angular.copy(e.config);i.defaultStrategy=i.defaultStrategy||"enhanced-three-stage",i.maxConversationHistory=i.maxConversationHistory||100,i.typingDelay=i.typingDelay||500,i.welcomeMessageDelay=i.welcomeMessageDelay||1e3,console.log("[AIConfigModalCtrl] Final configuration being passed to modal:",{general:{provider:i.provider,model:i.model},stage0:{provider:i.stage0Provider,model:i.stage0Model},stage1:{provider:i.stage1Provider,model:i.stage1Model},stage2:{provider:i.stage2Provider,model:i.stage2Model},classification:{provider:i.classificationProvider,model:i.classificationModel},useRequestEnhancement:i.useRequestEnhancement,enableRAG:i.enableRAG}),t.close(i)}},e.cancel=function(){t.dismiss("cancel")},h(),e.$watch("config.provider",h),e.$watch("config.stage0Provider",h),e.$watch("config.stage1Provider",h),e.$watch("config.stage2Provider",h),e.$watch("config.classificationProvider",h),e.preferences=[],e.selectedPreference={},e.editingPreference={requirement_type:"",title:"",content:"",appliesTo:"",tagsInput:"",priority:"medium"},e.preferenceSearch="",e.filterType="",e.filterPriority="",e.isSaving=!1,e.isDeleting=!1,e.filteredPreferences=function(){return(e.preferences||[]).filter((function(t){var a=!e.preferenceSearch||t.title&&t.title.toLowerCase().includes(e.preferenceSearch.toLowerCase())||t.content&&t.content.toLowerCase().includes(e.preferenceSearch.toLowerCase()),n=!e.filterType||t.requirement_type===e.filterType,o=!e.filterPriority||t.priority===e.filterPriority;return a&&n&&o}))},e.selectPreference=function(t){e.selectedPreference=t,e.editPreference(t)},e.editPreference=function(t){e.editingPreference={id:t.id,requirement_type:t.requirement_type,title:t.title,content:t.content,appliesTo:(t.applies_to||[]).join(", "),tagsInput:(t.tags||[]).join(", "),priority:t.priority,created_at:t.created_at,updated_at:t.updated_at}},e.newPreference=function(){e.clearForm()},e.clearForm=function(){e.editingPreference={requirement_type:"",title:"",content:"",appliesTo:"",tagsInput:"",priority:"medium"},e.selectedPreference={},e.preferenceForm&&(e.preferenceForm.$setPristine(),e.preferenceForm.$setUntouched())},e.savePreference=function(){if(e.preferenceForm.$invalid)alert("Please fill in all required fields (Type, Title, Content)");else{e.isSaving=!0;var t=e.editingPreference.appliesTo?e.editingPreference.appliesTo.split(",").map((function(e){return e.trim()})).filter((function(e){return e})):[],a=e.editingPreference.tagsInput?e.editingPreference.tagsInput.split(",").map((function(e){return e.trim()})).filter((function(e){return e})):[],n={requirement_type:e.editingPreference.requirement_type,title:e.editingPreference.title,content:e.editingPreference.content,applies_to:t,tags:a,priority:e.editingPreference.priority},o=!!e.editingPreference.id,r="".concat(i().context,o?"/qdrant/user-requirements/update":"/qdrant/user-requirements/store"),s=o?{id:e.editingPreference.id,user_id:window.user_id,updates:n}:{user_id:window.user_id,requirement:n};fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(t){t.success?(alert(o?"Preference updated successfully!":"Preference created successfully!"),f(),e.clearForm(),e.$apply()):(alert("Failed to save preference: "+(t.message||"Unknown error")),e.isSaving=!1,e.$apply())})).catch((function(t){console.error("[AIConfigModal] Save error:",t),alert("Failed to save preference. Please try again."),e.isSaving=!1,e.$apply()})).finally((function(){e.isSaving=!1,e.$apply()}))}},e.confirmDelete=function(t){e.selectedPreference=t,e.editingPreference.id=t.id,e.deletePreference()},e.deletePreference=function(){if(e.editingPreference.id&&confirm("Are you sure you want to delete this preference? This cannot be undone.")){e.isDeleting=!0;var t="".concat(i().context,"/qdrant/user-requirements/delete");fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e.editingPreference.id,user_id:window.user_id})}).then((function(e){return e.json()})).then((function(t){t.success?(alert("Preference deleted successfully!"),f(),e.clearForm(),e.$apply()):(alert("Failed to delete preference: "+(t.message||"Unknown error")),e.isDeleting=!1,e.$apply())})).catch((function(t){console.error("[AIConfigModal] Delete error:",t),alert("Failed to delete preference. Please try again."),e.isDeleting=!1,e.$apply()})).finally((function(){e.isDeleting=!1,e.$apply()}))}},e.getTypeBadgeClass=function(e){return{preference:"primary",instruction:"warning",context:"info",constraint:"danger"}[e]||"secondary"},e.getPriorityBadgeClass=function(e){return{high:"danger",medium:"warning",low:"secondary"}[e]||"secondary"},e.formatRelativeTime=function(e){if(!e)return"N/A";var t=new Date(e),a=new Date-t,n=Math.floor(a/864e5);return 0===n?"Today":1===n?"Yesterday":n<7?"".concat(n,"d ago"):n<30?"".concat(Math.floor(n/7),"w ago"):"".concat(Math.floor(n/30),"mo ago")},e.formatDateTime=function(e){return e?new Date(e).toLocaleString():"N/A"},f()}]).controller("StatisticsModalController",["$scope","$uibModalInstance","statistics",function(e,t,a){e.statistics=a,e.cancel=function(){t.dismiss("cancel")}}]).controller("QdrantManagerCtrl",["$scope","$http","$timeout",nn]).name;var Vn=a("8deafab7866a125bb9ca"),Wn=function(e,t,a,n,o){t.otherwise("/editor/"),a.config({debug:!0}),o.hashPrefix(""),e.state("errorOne",{url:"/errorOne",templateUrl:"views/errorOne.html",data:{specialClass:"gray-bg"}}).state("qdrant-manager",{url:"/qdrant-manager",templateUrl:"views/qdrant-manager.html",controller:"QdrantManagerCtrl",resolve:{factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn]}}).state("test",{url:"/test",templateUrl:"views/test.html",data:{specialClass:"gray-bg"}}).state("editor",{url:"/editor/:filename?",params:{filename:null,new:null,showHtml:null,no_html_ed:null},controller:"EditorController",templateUrl:"views/editor.html",resolve:{factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn],report_json:["$q","FileFactory","$stateParams","$rootScope",function(e,t,a,n){if(a.filename)return t.getReport(a.filename,"edit");var o={file_name:null,report_name:"New Report",author:n.username||"unknown",jsonText:"[]",editorJson:{blocks:[]},canvas_width:6e3,canvas_height:6e3,auto_width:!1,auto_height:!1,has_html:"true"===a.showHtml,no_html_ed:"true"===a.no_html_ed,strip_mode:!1,perm:[]};return e.when(o)}]}}).state("st_editor",{url:"/st_editor/:filename",controller:"StripEditorController",templateUrl:"views/st_editor.html",resolve:{factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn],report_json:["FileFactory","$stateParams",function(e,t){return e.getReport(t.filename,"edit")}]}}).state("viewer",{url:"/viewer/:filename",controller:"ViewerController",templateUrl:"views/viewer.html",resolve:{factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn],report_json:["FileFactory","$stateParams",function(e,t){return e.getReport(t.filename,"view")}]}}).state("st_viewer",{url:"/st_viewer/:filename",controller:"StripViewerController",templateUrl:"views/st_viewer.html",resolve:{factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn],report_json:["FileFactory","$stateParams",function(e,t){return e.getReport(t.filename,"view")}]}}).state("st_renderer",{url:"/st_renderer/:filename",controller:"StripViewerController",templateUrl:"views/st_viewer.html",resolve:{report_json:["FileFactory","$stateParams",function(e,t){return e.getReport(t.filename,"view")}]}}).state("player",{url:"/player/:playlist_id",controller:"PlayerController",templateUrl:"views/player.html",resolve:{playlist_result:["FileFactory","$stateParams",function(e,t){return e.getPlaylist(t.playlist_id)}],factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn]}}).state("tviewer",{url:"/tviewer/:filename",controller:"ViewerController",templateUrl:"views/tviewer.html",resolve:{report_json:["FileFactory","$stateParams",function(e,t){return e.getReport(t.filename)}],factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn]}}).state("mob_viewer",{url:"/mob_viewer/:filename",controller:"ViewerController",templateUrl:"views/mobviewer.html",resolve:{report_json:["FileFactory","$stateParams",function(e,t){return e.getReport(t.filename)}],factory:["$q","$rootScope","$location","$cookies","loginUserService",Jn]}}).state("reports",{url:"/reports",templateUrl:"views/reports.html",controller:"myReportsCtrl",resolve:{factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn]}}).state("playlists",{url:"/playlists",templateUrl:"views/playlists.html",controller:"myPlaylistsCtrl",resolve:{factory:["$q","$rootScope","$location","$cookies","loginUserService","$http",Qn]}}).state("renderer",{url:"/renderer/:filename",controller:"ViewerController",templateUrl:"views/tviewer.html",resolve:{report_json:["FileFactory","$stateParams",function(e,t){return e.getReport(t.filename)}]}})};Wn.$inject=["$stateProvider","$urlRouterProvider","$ocLazyLoadProvider","$httpProvider","$locationProvider"];const Gn=Wn;function Jn(e,t,a,n,o,i){var r,s,l=e.defer();return t.authenticationDone?l.resolve({user:t.username,project_id:t.project_id}):(r="6237000453",s="22222222",t.username=r,t.project_id=s,t.authenticationDone=!0,l.resolve({user:r,project_id:s})),l.promise}function Qn(e,t,a,n,o,i){var r,s=a.search();function l(e,a){t.username="6237000453",window.user_id="6237000453",window.fb_exchange.user_id="6237000453",t.project_id="c46633e8-6e52-2178-f17e-dcbfdade7cb2",t.authenticationDone=!0,console.log({username:t.username,project_id:t.project_id,auth_source:"fallback_hardcoded"}),a&&a.val_debug&&Vn.bsToast.info({title:"Message",position:"topCenter",maxWidth:450,message:"localhost - fallback auth"}),e.resolve({user:t.username,project_id:t.project_id})}if(window.fb_exchange||(window.fb_exchange={}),a.absUrl().indexOf("localhost")>-1){var c=e.defer();return t.authenticationDone?c.resolve({user:t.username,project_id:t.project_id}):i&&"function"==typeof i.get?i.get("/api/auth").then((function(e){e.data.success?(t.username=e.data.username,window.user_id=e.data.username,window.fb_exchange.user_id=e.data.username,t.project_id="c46633e8-6e52-2178-f17e-dcbfdade7cb2",t.authenticationDone=!0,console.log({username:t.username,project_id:t.project_id,auth_source:"token_api",token_timestamp:e.data.timestamp}),s&&s.val_debug&&Vn.bsToast.info({title:"Message",position:"topCenter",maxWidth:450,message:"localhost - token auth: "+e.data.username}),c.resolve({user:e.data.username,project_id:t.project_id})):(console.log("No valid tokens found via API, using fallback"),l(c,s))})).catch((function(e){console.error("Token API error:",e),l(c,s)})):(console.log("$http service not available, using fallback auth"),l(c,s)),c.promise}if(c=e.defer(),t.authenticationDone)c.resolve({user:t.username,project_id:t.project_id}),s&&s.val_debug&&Vn.bsToast.info({title:"Message",position:"topCenter",maxWidth:450,message:"authentication Done"});else{t.originalPath=a.path();var u,d,p,h="en_EN";s&&s.user_id?(u=s.user_id,d=s.proj_id,p=s.token,h=s.language,t.username=u,t.project_id=d,console.log({username:t.username,project_id:t.project_id,aut_source:"params"}),s&&s.val_debug&&Vn.bsToast.info({title:"Message",position:"topCenter",maxWidth:450,message:"params "+u}),o.authUser({action:"validate",user_id:u,proj_id:d,token:p,language:h},(function(e){a.path(t.originalPath),t.authenticationDone=!0,window.user_id=u,window.fb_exchange.user_id=u,c.resolve({user:u,project_id:d})}),(function(e){a.path(t.originalPath),t.authenticationDone=!0,window.user_id=u,window.fb_exchange.user_id=u,c.resolve({user:u,project_id:d})}))):n.get("UCSSSOAccount")||n.get("UCSSSOUser")||n.get("UCSLoginName")?(void 0!==n.get("UCSSSOAccount")?r=n.get("UCSSSOAccount"):void 0!==n.get("UCSSSOUser")?r=n.get("UCSSSOUser"):void 0!==n.get("UCSLoginName")&&(r=n.get("UCSLoginName")),s&&s.val_debug&&Vn.bsToast.info({title:"Message",position:"topCenter",maxWidth:450,message:"old_epms "+r}),void 0!==r?(t.username=r,window.user_id=r,window.fb_exchange.user_id=r,t.project_id=localStorage.getItem("baseuiProjId"),a.path(t.originalPath),t.authenticationDone=!0,console.log({username:t.username,project_id:t.project_id,aut_source:"old_epms"}),c.resolve({user:r,project_id:t.project_id})):a.path("/errorOne")):(r=void 0!==n.get("PORTALSSOUser")?n.get("PORTALSSOUser"):void 0!==n.get("ZTEDPGSSOUser")?n.get("ZTEDPGSSOUser"):void 0!==n.get("UserInfo")?JSON.parse(n.get("UserInfo")).loginUserInfo.userId:n.get("user"),s&&s.val_debug&&Vn.bsToast.info({title:"Message",position:"topCenter",maxWidth:450,message:"new_epms "+r}),void 0!==r?(t.username=r,window.user_id=r,window.fb_exchange.user_id=r,t.project_id=localStorage.getItem("baseuiProjId"),a.path(t.originalPath),t.authenticationDone=!0,console.log({username:t.username,project_id:t.project_id,aut_source:"new_epms"}),c.resolve({user:r,project_id:t.project_id})):a.path("/errorOne"))}return c.promise}function Yn(e){return Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yn(e)}function Xn(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return Kn(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Kn(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,Kn(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,Kn(d,"constructor",c),Kn(c,"constructor",l),l.displayName="GeneratorFunction",Kn(c,o,"GeneratorFunction"),Kn(d),Kn(d,o,"Generator"),Kn(d,n,(function(){return this})),Kn(d,"toString",(function(){return"[object Generator]"})),(Xn=function(){return{w:i,m:p}})()}function Kn(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Kn=function(e,t,a,n){function i(t,a){Kn(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},Kn(e,t,a,n)}function Zn(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function $n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,eo(n.key),n)}}function eo(e){var t=function(e){if("object"!=Yn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=Yn(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Yn(t)?t:t+""}var to=function(){return e=function e(t,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.$q=a,this.modelsCache=null,this.cacheExpiry=null,this.CACHE_DURATION=18e5,this.API_BASE_URL="https://openrouter.ai/api/v1"},t=[{key:"fetchModels",value:(a=Xn().m((function e(){var t,a,n,o,i,r,s,l;return Xn().w((function(e){for(;;)switch(e.p=e.n){case 0:if(!(this.modelsCache&&this.cacheExpiry&&Date.now()<this.cacheExpiry)){e.n=1;break}return console.log("[OpenRouterService] Returning cached models"),e.a(2,this.$q.resolve(this.modelsCache));case 1:if(e.p=1,t=localStorage.getItem("openrouter_models_cache"),a=localStorage.getItem("openrouter_models_cache_time"),!t||!a){e.n=2;break}if(!(Date.now()-parseInt(a)<this.CACHE_DURATION)){e.n=2;break}return n=JSON.parse(t),this.modelsCache=n,this.cacheExpiry=parseInt(a)+this.CACHE_DURATION,console.log("[OpenRouterService] Returning localStorage cached models"),e.a(2,this.$q.resolve(n));case 2:e.n=4;break;case 3:e.p=3,s=e.v,console.warn("[OpenRouterService] Error reading from localStorage cache:",s);case 4:return console.log("[OpenRouterService] Fetching models from API"),e.p=5,e.n=6,this.$http({method:"GET",url:"".concat(this.API_BASE_URL,"/models"),headers:{Authorization:"Bearer "+(localStorage.getItem("ai_openrouter_key")||""),"Content-Type":"application/json"},timeout:1e4});case 6:if(!(o=e.v).data||!o.data.data){e.n=7;break}i=this.transformModels(o.data.data),this.modelsCache=i,this.cacheExpiry=Date.now()+this.CACHE_DURATION;try{localStorage.setItem("openrouter_models_cache",JSON.stringify(i)),localStorage.setItem("openrouter_models_cache_time",Date.now().toString())}catch(e){console.warn("[OpenRouterService] Error saving to localStorage:",e)}return console.log("[OpenRouterService] Fetched ".concat(i.length," models from API")),e.a(2,i);case 7:throw new Error("Invalid API response format");case 8:e.n=10;break;case 9:return e.p=9,l=e.v,console.error("[OpenRouterService] Error fetching models:",l),r=this.getFallbackModels(),console.log("[OpenRouterService] Using fallback models due to API error"),e.a(2,r);case 10:return e.a(2)}}),e,this,[[5,9],[1,3]])})),n=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=a.apply(e,t);function r(e){Zn(i,n,o,r,s,"next",e)}function s(e){Zn(i,n,o,r,s,"throw",e)}r(void 0)}))},function(){return n.apply(this,arguments)})},{key:"transformModels",value:function(e){return e.filter((function(e){return e.id&&!e.id.includes("error")&&!e.id.includes("invalid")})).map((function(e){var t,a,n=null!==(t=e.pricing)&&void 0!==t&&t.prompt?1e6*parseFloat(e.pricing.prompt):0,o=null!==(a=e.pricing)&&void 0!==a&&a.completion?1e6*parseFloat(e.pricing.completion):0;return{value:e.id,text:e.id,in_cost:n,out_cost:o,context_length:e.context_length||0,description:e.description||"",architecture:e.architecture||{},top_provider:e.top_provider||{},per_request_limits:e.per_request_limits||null}})).sort((function(e,t){return 0===e.in_cost&&t.in_cost>0?-1:0===t.in_cost&&e.in_cost>0?1:e.text.localeCompare(t.text)}))}},{key:"getFallbackModels",value:function(){return[{value:"google/gemini-2.5-flash-preview",text:"google/gemini-2.5-flash-preview",in_cost:.15,out_cost:.6},{value:"google/gemini-2.5-flash-preview:thinking",text:"google/gemini-2.5-flash-preview:thinking",in_cost:.13,out_cost:3},{value:"google/gemini-2.5-flash-preview-05-20",text:"google/gemini-2.5-flash-preview-05-20",in_cost:.15,out_cost:.6},{value:"google/gemini-2.5-flash-preview-05-20:thinking",text:"google/gemini-2.5-flash-preview-05-20:thinking",in_cost:.15,out_cost:3.5},{value:"google/gemini-2.5-pro-preview",text:"google/gemini-2.5-pro-preview",in_cost:1.25,out_cost:10},{value:"google/gemini-2.0-flash-001",text:"google/gemini-2.0-flash-001",in_cost:.1,out_cost:.4},{value:"qwen/qwen-turbo",text:"qwen/qwen-turbo",in_cost:.5,out_cost:.2},{value:"qwen/qwen3-32b",text:"qwen/qwen3-32b",in_cost:.1,out_cost:.3,options:[{enable_thinking:!1}]},{value:"qwen/qwen3-32b:free",text:"qwen/qwen3-32b:free",in_cost:0,out_cost:0,options:[{enable_thinking:!1}]},{value:"qwen/qwen3-235b-a22b",text:"qwen/qwen3-235b-a22b",in_cost:.14,out_cost:.6,options:[{enable_thinking:!1}]},{value:"qwen/qwen3-14b",text:"qwen/qwen3-14b",in_cost:.07,out_cost:.24,options:[{enable_thinking:!1}]},{value:"anthropic/claude-sonnet-4",text:"anthropic/claude-sonnet-4",in_cost:3,out_cost:15},{value:"anthropic/claude-opus-4",text:"anthropic/claude-opus-4",in_cost:15,out_cost:75},{value:"anthropic/claude-3.7-sonnet",text:"anthropic/claude-3.7-sonnet",in_cost:3,out_cost:15},{value:"anthropic/claude-3.7-sonnet:thinking",text:"anthropic/claude-3.7-sonnet:thinking",in_cost:3,out_cost:15},{value:"anthropic/claude-3.5-haiku",text:"anthropic/claude-3.5-haiku",in_cost:.8,out_cost:4},{value:"openai/gpt-4.1-mini-2025-04-14",text:"openai/gpt-4.1-mini-2025-04-14",in_cost:.4,out_cost:1.6},{value:"openai/gpt-4.1-2025-04-14",text:"openai/gpt-4.1-2025-04-14",in_cost:2,out_cost:8},{value:"openai/gpt-4o-mini",text:"openai/gpt-4o-mini",in_cost:.15,out_cost:.6},{value:"openai/gpt-4o",text:"openai/gpt-4o",in_cost:2.5,out_cost:10},{value:"openai/o4-mini",text:"openai/o4-mini",in_cost:1.1,out_cost:4.4},{value:"openai/o4-mini-high",text:"openai/o4-mini-high",in_cost:1.1,out_cost:4.4},{value:"deepseek/deepseek-r1-0528",text:"deepseek/deepseek-r1-0528",in_cost:.5,out_cost:2.15},{value:"deepseek/deepseek-prover-v2",text:"deepseek/deepseek-prover-v2",in_cost:.5,out_cost:2.18},{value:"deepseek/deepseek-chat-v3-0324",text:"deepseek/deepseek-chat-v3-0324",in_cost:.3,out_cost:.88},{value:"deepseek/deepseek-r1",text:"deepseek/deepseek-r1",in_cost:.45,out_cost:2.15},{value:"deepseek/deepseek-r1-distill-qwen-7b",text:"deepseek/deepseek-r1-distill-qwen-7b",in_cost:.1,out_cost:.2}]}},{key:"searchModels",value:function(e,t){if(!t||""===t.trim())return e;var a=t.toLowerCase().trim();return e.filter((function(e){return[e.value,e.text,e.description||""].join(" ").toLowerCase().includes(a)}))}},{key:"clearCache",value:function(){this.modelsCache=null,this.cacheExpiry=null;try{localStorage.removeItem("openrouter_models_cache"),localStorage.removeItem("openrouter_models_cache_time")}catch(e){console.warn("[OpenRouterService] Error clearing localStorage cache:",e)}console.log("[OpenRouterService] Cache cleared")}},{key:"isFetching",value:function(){return null!==this._fetchingPromise}},{key:"getModels",value:function(){var e=this;return this._fetchingPromise||(this._fetchingPromise=this.fetchModels().finally((function(){e._fetchingPromise=null}))),this._fetchingPromise}}],t&&$n(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a,n}();s().module("fishBone",["ngTouch","ui.bootstrap","ui.router","ui.grid","ui.grid.edit","ui.grid.autoResize","ui.grid.selection","ui.grid.saveState","ui.grid.resizeColumns","ui.grid.cellNav","ui.grid.exporter","oc.lazyLoad","ui.sortable","ngCookies","ngResource","cgBusy","angularResizable","ui.layout","ngSanitize","mwl.confirm",Ke,qn]).config(Gn).factory("OpenRouterService",["$http","$q",function(e,t){return new to(e,t)}]),a("1f44d888ec90c0bf8262");var ao=a("a45670b3d8fb79ec0258");c().ui.InplaceFilter=c().ui.LabelEditor.extend({NAME:"draw2d.ui.InplaceFilter",init:function(e){this._super(),this.listener=ao.extend({onCommit:function(){},onButtonClick:function(){},onCancel:function(){}},e)},start:function(e){this.label=e,this.commitCallback=ao.proxy(this.commit,this),ao("body").bind("click",this.commitCallback),this.html=ao('<input style="width: 100px" id="inplaceeditor" type="text" class="form-control p-0 m-l-none">'),this.container=ao('<div class="input-group p-0" style="max-width: 120px"></div>'),this.span=ao('<span class="input-group-btn"></span>'),this.button=ao('<button type="button" class="btn btn-primary"> ... </button>'),this.button.appendTo(this.span),this.html.appendTo(this.container),this.span.appendTo(this.container),e.getText().indexOf("\n")>-1?this.html.val("Values"):this.html.val(e.getText()),this.container.hide(),ao("body").append(this.container),this.container.autoResize({animate:!1}),this.html.bind("keyup",ao.proxy((function(e){switch(e.which){case 13:this.commit();break;case 27:this.cancel()}}),this)),this.button.bind("click",ao.proxy((function(e){this.button_click(),e.stopPropagation(),e.preventDefault()}),this)),this.html.bind("click",(function(e){e.stopPropagation(),e.preventDefault()}));var t=this.label.getCanvas(),a=this.label.getBoundingBox();a.setPosition(t.fromCanvasToDocumentCoordinate(a.x,a.y)),t.getScrollArea().is(ao("body"))&&a.translate(t.getScrollLeft(),t.getScrollTop()),a.translate(-1,-1),a.resize(2,2),this.container.css({position:"absolute",top:a.y,left:a.x,"min-width":a.w*(1/t.getZoom()),height:Math.max(25,a.h*(1/t.getZoom()))}),this.container.fadeIn(ao.proxy((function(){this.html.focus()}),this))},commit:function(){this.container.unbind("blur",this.commitCallback),ao("body").unbind("click",this.commitCallback);var e=this.html.val(),t=new(c().command.CommandAttr)(this.label,{text:e});this.label.getCanvas().getCommandStack().execute(t),this.container.fadeOut(ao.proxy((function(){this.container.remove(),this.container=null,this.html.remove(),this.html=null,this.listener.onCommit(this.label.getText())}),this))},button_click:function(){this.container.unbind("blur",this.commitCallback),ao("body").unbind("click",this.commitCallback),this.container.fadeOut(ao.proxy((function(){this.container.remove(),this.container=null,this.html.remove(),this.html=null,this.listener.onButtonClick(this.label.getText())}),this))},cancel:function(){this.container.unbind("blur",this.commitCallback),ao("body").unbind("click",this.commitCallback),this.html.fadeOut(ao.proxy((function(){this.html.remove(),this.html=null,this.container.remove(),this.container=null,this.listener.onCancel()}),this))}}),c().decoration.connection.DataArrowDecorator=c().decoration.connection.ArrowDecorator.extend({NAME:"draw2d.decoration.connection.DataArrowDecorator",init:function(e,t){this._super(10,10)},paint:function(e){var t=e.set();return t.push(e.path(["M0 0","L",this.width," ",-this.height/2,"L",this.width," ",this.height/2,"L0 0"].join(""))),t.attr({fill:this.backgroundColor.hash(),stroke:this.color.hash()}),t}});var no=a("a45670b3d8fb79ec0258");c().DataInputPort=c().InputPort.extend({NAME:"draw2d.DataInputPort",init:function(e,t,a){this._super(e,t,a);var n=this;this.setMaxFanOut(1);var o=this;this.on("connect",(function(e,t){o.blockUpdate||i(t.connection,n),o.blockUpdate=!1})),this.on("disconnect",(function(e,t){e.getParent().blockUpdate||r(t.connection,n)}));var i=function(e,t){var a=t.getParent();try{"draw2d.shape.fishbone.ra.AddRaTaskGroup"===a.NAME?(a.conn_count=0,a.project=e.sourcePort.getUserData().project,a.scope=e.sourcePort.getUserData().scope,e.sourcePort.getUserData().sop&&(a.sop=e.sourcePort.getUserData().sop)):(a.sites_list_in=e.sourcePort.userData.sites_list_out,no.isFunction(a.updateSearchCol)?e.sourcePort.getUserData().sop&&e.sourcePort.getUserData().sop.scope_id?a.updateSearchCol(e.sourcePort.getUserData().project,e.sourcePort.getUserData().scope,a,e.sourcePort.getUserData().sop):e.sourcePort.getUserData().project&&e.sourcePort.getUserData().scope&&e.sourcePort.getUserData().scope.scope_id?a.updateSearchCol(e.sourcePort.getUserData().project,e.sourcePort.getUserData().scope,a):a.updateSearchCol(e.sourcePort.getUserData().project,null,a):(a.project=e.sourcePort.getUserData().project,a.scope=e.sourcePort.getUserData().scope))}catch(t){console.log("wrong connection logic. please follow procedure"),e&&setTimeout((function(){a.getCanvas().remove(e)}),100)}},r=function(e,t){var a=t.getParent();try{"draw2d.shape.fishbone.ra.AddRaTaskGroup"===a.NAME&&(a.conn_count=0)}catch(t){console.log("please follow procedure"),e&&setTimeout((function(){a.getCanvas().remove(e)}),100)}}}});var oo=a("a45670b3d8fb79ec0258");c().SerieInputPort=c().InputPort.extend({NAME:"draw2d.SerieInputPort",init:function(e,t,a){this._super(e,t,a),this.on("connect",(function(e,t){n(t.connection,e.getParent())})),this.on("disconnect",(function(e,t){null!==e.getParent().getCanvas()&&o(t.connection,e.getParent())}));var n=function(e,t){if(void 0!==e.sourcePort.userData.serie){if(void 0===t.userData.serie){var a=oo.extend(!0,{},e.sourcePort.userData.serie);t.project=e.sourcePort.getUserData().project,t.scope=e.sourcePort.getUserData().scope,t.sop=e.sourcePort.getUserData().sop,t.userData.serie=a,t.updateTable()}}else alert("Incompatible input data!")},o=function(e,t){void 0!==t.userData.serie&&(t.userData.serie,t.updateTable())}}});var io=a("a45670b3d8fb79ec0258"),ro=a("8deafab7866a125bb9ca");c().PivotColInputPort=c().InputPort.extend({NAME:"draw2d.PivotColInputPort",init:function(e,t,a){this._super(e,t,a);var n=this;this.on("connect",(function(e,t){n.blockUpdate||o(t.connection,e.getParent()),n.blockUpdate=!1})),this.on("disconnect",(function(e,t){e.getParent().blockUpdate||r(t.connection,e.getParent())}));var o=function(e,t){try{var a=e.sourcePort.getId(),n=e.sourcePort.getName();if(t.project=e.sourcePort.getUserData().project,t.scope=e.sourcePort.getUserData().scope,t.sop=e.sourcePort.getUserData().sop,"commonDataOutput"===n){var o=e.getSource().getParent(),r=o.getId();o.userData.tasks&&o.userData.tasks.length&&o.userData.tasks.forEach((function(e,a){var n=o.getOutputPort(o.userData.tasks[a].outPort).userData.sites_list_out.slice(),s={project:o.project,scope:o.scope,item_name:""!==e.label?e.label:e.task.scope_task_name,task_type:e.task_type,sites_list_out:n};i(t,e.ID,s,r)})),t.updateTable()}else i(t,a,e.sourcePort.userData),t.updateTable()}catch(a){console.log("wrong connection logic. please follow procedure"),e&&setTimeout((function(){t.getCanvas().remove(e)}),100)}},i=function(e,t,a,n){var o=-1;e.userData.col.forEach((function(e,a){e&&e.owner_id===t&&(o=a)}));var i=io.extend(!0,{},a);void 0!==e.userData.col[o]?(i.serie=io.extend(!0,{},e.userData.col[o].serie),i.join_type=e.userData.col[o].join_type,i.hide_null=e.userData.col[o].hide_null):(i.serie={name:a.item_name,type:"line",data:[]},i.join_type="FULL OUTER",i.hide_null=!1),i.owner_id=t,i.owner_figure_id=n,-1!==o&&e.userData.col.splice(o,1),e.project=a.project,e.scope=a.scope,e.sop=a.sop,-1!==o?e.userData.col.splice(o,0,i):e.userData.col.push(i)},r=function(e,t){var a=e.sourcePort.getId();if("commonDataOutput"===e.sourcePort.getName()){var n=e.getSource().getParent(),o=n.getId();n.userData.tasks&&n.userData.tasks.length&&n.userData.tasks.forEach((function(e,a){(0,h.checkDisconn)(t,e.ID,o)})),t.updateTable(!0)}else ro.checkDisconn(t,a),t.updateTable(!0)}}});var so=a("a45670b3d8fb79ec0258");c().FuncInputPort=c().InputPort.extend({NAME:"draw2d.FuncInputPort",init:function(e,t,a){this._super(e,t,a);var n=this;this.on("connect",(function(e,t){if(!n.blockUpdate)if(i(e,t)){console.log("draw2d.FuncInputPort: Connection Exist"),t.connection.superPass=!0;var a=e.getParent();setTimeout((function(){a.getCanvas().remove(t.connection)}),100)}else o(t.connection,e.getParent());n.blockUpdate=!1})),this.on("disconnect",(function(e,t){t.connection.superPass||e.getParent().blockUpdate||s(t.connection,e.getParent())}));var o=function(e,t){try{var a=e.sourcePort.getId();e.sourcePort.getName(),t.project=e.sourcePort.getUserData().project,t.scope=e.sourcePort.getUserData().scope,t.sop=e.sourcePort.getUserData().sop,r(t,a,e.sourcePort.userData),t.ai_generated||t.updateTable()}catch(a){console.log("FuncInputPort wrong connection logic. please follow procedure "+a),e&&e.connection&&(e.connection.superPass=!0),setTimeout((function(){t.getCanvas().remove(e)}),100)}},i=function(e,t){var a=[];return e.connections.data.forEach((function(e){t.connection.id!==e.id&&a.push([e.sourcePort.id,e.targetPort.id].join(","))})),a.length&&a.indexOf([t.connection.sourcePort.id,t.connection.targetPort.id].join(","))>-1},r=function(e,t,a){var n=-1;e.userData.row.forEach((function(e,a){e&&e.owner_id===t&&(n=a)}));var o=so.extend(!0,{},a);o.owner_id=t,-1!==n&&e.userData.row.splice(n,1),e.project=a.project,e.scope=a.scope,e.sop=a.sop,-1!==n?e.userData.row.splice(n,0,o):e.userData.row.push(o)},s=function(e,t){var a=e.sourcePort.getId();e.sourcePort.getName(),l(t,a),t.updateTable(!0)},l=function(e,t){var a=-1;e.userData.row.forEach((function(e,n){e&&e.owner_id===t&&(a=n)})),a>-1&&e.userData.row.splice(a,1)}}});var lo=a("a45670b3d8fb79ec0258");c().PivotRowInputPort=c().InputPort.extend({NAME:"draw2d.PivotRowInputPort",init:function(e,t,a){this._super(e,t,a),this.on("connect",(function(e,t){n(t.connection,e.getParent())})),this.on("disconnect",(function(e,t){o(t.connection,e.getParent())}));var n=function(e,t){try{var a,n,o,i;if("draw2d.shape.fishbone.ra.RaVegaChart"===t.NAME||"draw2d.shape.fishbone.ra.RaPivotAdapter"===t.NAME||"draw2d.shape.fishbone.ra.RaTableAdapter"===t.NAME)null!=e&&null!==(o=e.sourcePort)&&void 0!==o&&null!==(o=o.userData)&&void 0!==o&&o.sites_list_out&&"[object Object]"===Object.prototype.toString.call(e.sourcePort.userData.sites_list_out)?(a=lo.extend(!0,{},e.sourcePort.userData),n=lo.extend(!0,{},a.sites_list_out),a.sites_list_out=[n]):n=null===(i=(a=lo.extend(!0,{},e.sourcePort.userData)).sites_list_out)||void 0===i?void 0:i.slice(),delete a.sites_list_out;else a=lo.extend(!0,{},e.sourcePort.userData);var r=e.sourcePort.getId();a.owner_id=r,a.sites_list_out&&a.sites_list_out.length&&a.sites_list_out.forEach((function(e,t){delete e.my_date,delete e.task_name,delete e.task_type}));var s=-1;t.userData.row.length&&t.userData.row.forEach((function(e,t){e.owner_id===r&&(s=t)})),t.project=e.sourcePort.getUserData().project,t.scope=e.sourcePort.getUserData().scope,t.sop=e.sourcePort.getUserData().sop,-1!==s?("draw2d.shape.fishbone.ra.RaVegaChart"!==t.NAME&&"draw2d.shape.fishbone.ra.RaPivotAdapter"!==t.NAME&&"draw2d.shape.fishbone.ra.RaTableAdapter"!==t.NAME||(t.row[s]=n),t.userData.row[s]=a):("draw2d.shape.fishbone.ra.RaVegaChart"!==t.NAME&&"draw2d.shape.fishbone.ra.RaPivotAdapter"!==t.NAME&&"draw2d.shape.fishbone.ra.RaTableAdapter"!==t.NAME||t.row.push(n),t.userData.row.push(a),t.userData.updateBlock||t.ai_generated||t.updateTable()),"draw2d.shape.fishbone.ra.RaPivotnode"===t.NAME&&(-1===t.pivot.pivot_rows.indexOf(a.item_name)&&-1===t.pivot.pivot_cols.indexOf(a.item_name)&&-1===t.pivot.pivot_common.indexOf(a.item_name)&&t.pivot.pivot_common.push(a.item_name),t.treema_scheme.properties.aggregator.properties.vals.items.enum&&-1===t.treema_scheme.properties.aggregator.properties.vals.items.enum.indexOf(a.item_name)&&t.treema_scheme.properties.aggregator.properties.vals.items.enum.push(a.item_name))}catch(a){console.log("wrong connection logic. please follow procedure: "+a),e&&setTimeout((function(){t.getCanvas().remove(e)}),100)}},o=function(e,t){var a=e.sourcePort.userData,n=e.sourcePort.getId(),o=-1;t.userData.row.forEach((function(e,t){e.owner_id===n&&(o=t)})),-1!==o&&(t.userData.row.splice(o,1),"draw2d.shape.fishbone.ra.RaVegaChart"!==t.NAME&&"draw2d.shape.fishbone.ra.RaPivotAdapter"!==t.NAME&&"draw2d.shape.fishbone.ra.RaTableAdapter"!==t.NAME||t.row.splice(o,1)),"draw2d.shape.fishbone.ra.RaPivotnode"===t.NAME&&(-1!==t.pivot.pivot_common.indexOf(a.item_name)&&t.pivot.pivot_common.splice(t.pivot.pivot_rows.indexOf(a.item_name),1),-1!==t.pivot.pivot_cols.indexOf(a.item_name)&&t.pivot.pivot_cols.splice(t.pivot.pivot_cols.indexOf(a.item_name),1),-1!==t.pivot.pivot_rows.indexOf(a.item_name)&&t.pivot.pivot_rows.splice(t.pivot.pivot_rows.indexOf(a.item_name),1),t.treema_scheme.properties.aggregator.properties.vals.items.enum&&-1!==t.treema_scheme.properties.aggregator.properties.vals.items.enum.indexOf(a.item_name)&&t.treema_scheme.properties.aggregator.properties.vals.items.enum.splice(t.treema_scheme.properties.aggregator.properties.vals.items.enum.indexOf(a.item_name),1)),t.userData.updateBlock||t.updateTable(!0)}}});var co=a("1bf2fbdb051fe0c57024");c().PieChartInputPort=c().InputPort.extend({NAME:"draw2d.PieChartInputPort",init:function(e,t,a){this._super(e,t,a)},onConnect:function(e){var t=this.getParent(),a=e.sourcePort;if("draw2d.shape.fishbone.cell.Mathnode"===a.parent.NAME||"draw2d.shape.fishbone.cell.SQLnode"===a.parent.NAME||"draw2d.shape.fishbone.ra.RaManyToOne"===a.parent.NAME||"draw2d.shape.fishbone.cell.UDFnode"===a.parent.NAME||"draw2d.shape.fishbone.cell.Codenode"===a.parent.NAME||"draw2d.shape.fishbone.cell.Mapnode"===a.parent.NAME||"draw2d.shape.fishbone.cell.Filternode"===a.parent.NAME||"draw2d.shape.fishbone.cell.CustomFieldnode"===a.parent.NAME){if(a.userData.sites_list_out.length>0){var n=a.userData.item_name;(t.userData.clean_data?(new co).from(a.userData.sites_list_out).select([{field:n},{field:"val"}]):(new co).from(a.userData.sites_list_out).groupBy(n).count("du_id").select([{field:n},{field:"du_id",text:"val"}])).forEach((function(e,o){t.userData.col.forEach((function(a,o){a.name===e[n]&&t.userData.col.splice(o,1)})),t.userData.col.push({value:e.val,name:e[n],sites_list_out:(new co).from(a.userData.sites_list_out).where((function(t,a){return t[n]===e[n]})).select()})})),t.project=e.sourcePort.getUserData().project,t.scope=e.sourcePort.getUserData().scope,t.sop=e.sourcePort.getUserData().sop,t.updateTable()}}else if(a.userData.sites_list_out.length>0){e.sourcePort.userData;var o=e.sourcePort.getId(),i=-1;t.userData.col.forEach((function(e,t){e.owner_id===o&&(i=t)})),-1!==i?t.userData.col[i]={owner_id:o,value:e.sourcePort.userData.sites_list_out.length,name:e.sourcePort.userData.item_name,task_type:void 0!==e.sourcePort.userData.sites_list_out[0].task_type?e.sourcePort.userData.sites_list_out[0].task_type:""}:(t.userData.col.push({owner_id:o,value:e.sourcePort.userData.sites_list_out.length,name:e.sourcePort.userData.item_name,task_type:void 0!==e.sourcePort.userData.sites_list_out[0].task_type?e.sourcePort.userData.sites_list_out[0].task_type:""}),t.project=e.sourcePort.getUserData().project,t.scope=e.sourcePort.getUserData().scope,t.sop=e.sourcePort.getUserData().sop,t.updateTable())}},onDisconnect:function(e){var t=this.getParent(),a=e.sourcePort.userData,n=e.sourcePort,o=-1;t.userData.col.forEach((function(i,r){if("draw2d.shape.fishbone.cell.Datanode"===n.parent.NAME){var s=e.sourcePort.getId();i.owner_id===s&&(o=r),o>-1&&t.userData.col.splice(o,1)}else if("draw2d.shape.fishbone.cell.Mathnode"===n.parent.NAME||"draw2d.shape.fishbone.cell.SQLnode"===n.parent.NAME||"draw2d.shape.fishbone.ra.RaManyToOne"===n.parent.NAME||"draw2d.shape.fishbone.cell.UDFnode"===n.parent.NAME||"draw2d.shape.fishbone.cell.Codenode"===n.parent.NAME||"draw2d.shape.fishbone.cell.Mapnode"===n.parent.NAME){if(n.userData.sites_list_out.length>0){var l=n.userData.item_name;(new co).from(n.userData.sites_list_out).groupBy(l).count("site_id").select().forEach((function(e,a){t.userData.col.forEach((function(a,n){a.name===e[l]&&t.userData.col.splice(n,1)}))}))}}else i.name==a.item_name&&(o=r)})),t.updateTable()}}),c().TableInputPort=c().InputPort.extend({NAME:"draw2d.TableInputPort",init:function(e,t,a){this._super(e,t,a),this.on("connect",(function(e,t){n(t.connection,e.getParent())})),this.on("disconnect",(function(e,t){o(t.connection,e.getParent())}));var n=function(e,t){t.project=e.sourcePort.getUserData().project,t.scope=e.sourcePort.getUserData().scope,t.sop=e.sourcePort.getUserData().sop},o=function(e,t){var a=e.sourcePort.userData,n=-1;t.userData.col.forEach((function(e,t){JSON.stringify(e)===JSON.stringify(a)&&(n=t)})),n>-1&&t.userData.col.splice(n,1),0===t.userData.col.length&&(t.userData.table_col_spec=[]),t.updateTable()}}});var uo=a("a45670b3d8fb79ec0258");c().PivotSqlDirectInputPort=c().InputPort.extend({NAME:"draw2d.PivotSqlDirectInputPort",init:function(e,t,a){this._super(e,t,a),this.on("connect",(function(e,t){n(t.connection,e.getParent())})),this.on("disconnect",(function(e,t){o(t.connection,e.getParent())}));var n=function(e,t){var a=uo.extend(!0,{},e.sourcePort.userData),n=e.sourcePort.getId();a.owner_id=n;var o=-1;t.userData.rowDirect.forEach((function(e,t){e.owner_id===n&&(o=t)})),-1!==o?t.userData.rowDirect[o]=a:(t.userData.rowDirect.push(a),t.updateTable()),t.project=e.sourcePort.getUserData().project,t.scope=e.sourcePort.getUserData().scope,t.sop=e.sourcePort.getUserData().sop,"draw2d.shape.fishbone.ra.RaPivotnode"===t.NAME&&(-1===t.pivot.pivot_rows.indexOf(a.item_name)&&-1===t.pivot.pivot_cols.indexOf(a.item_name)&&-1===t.pivot.pivot_common.indexOf(a.item_name)&&t.pivot.pivot_common.push(a.item_name),-1===t.treema_scheme.properties.aggregator.properties.vals.items.enum.indexOf(a.item_name)&&t.treema_scheme.properties.aggregator.properties.vals.items.enum.push(a.item_name))},o=function(e,t){var a=e.sourcePort.userData,n=e.sourcePort.getId(),o=-1;t.userData.rowDirect.forEach((function(e,t){e.owner_id===n&&(o=t)})),-1!=o&&t.userData.rowDirect.splice(o,1),"draw2d.shape.fishbone.ra.RaPivotnode"===t.NAME&&(-1!==t.pivot.pivot_common.indexOf(a.item_name)&&t.pivot.pivot_common.splice(t.pivot.pivot_rows.indexOf(a.item_name),1),-1!==t.pivot.pivot_cols.indexOf(a.item_name)&&t.pivot.pivot_cols.splice(t.pivot.pivot_cols.indexOf(a.item_name),1),-1!==t.pivot.pivot_rows.indexOf(a.item_name)&&t.pivot.pivot_rows.splice(t.pivot.pivot_rows.indexOf(a.item_name),1),-1!==t.treema_scheme.properties.aggregator.properties.vals.items.enum.indexOf(a.item_name)&&t.treema_scheme.properties.aggregator.properties.vals.items.enum.splice(t.treema_scheme.properties.aggregator.properties.vals.items.enum.indexOf(a.item_name),1)),t.updateTable()}}}),c().SLAInputPortTo=c().InputPort.extend({NAME:"draw2d.SLAInputPortTo",init:function(e,t,a){this._super(e,t,a);var n=this;this.on("connect",(function(e,t){n.blockUpdate||o(t.connection,n),n.blockUpdate=!1})),this.on("disconnect",(function(e,t){e.getParent().blockUpdate||i(t.connection,n)}));var o=function(e,t){var a=t.getParent();a.sites_list_in_to=e.sourcePort.userData.sites_list_out,a.project=e.sourcePort.getUserData().project,a.scope=e.sourcePort.getUserData().scope,a.sop=e.sourcePort.getUserData().sop,a.updateTable()},i=function(e,t){var a=t.getParent();a.sites_list_in_to=[],a.updateTable()}},onConnect:function(e){e.setTargetDecorator(new(c().decoration.connection.ArrowDecorator)(10,10))}}),c().SLAInputPortFrom=c().InputPort.extend({NAME:"draw2d.SLAInputPortFrom",init:function(e,t,a){this._super(e,t,a);var n=this;this.on("connect",(function(e,t){n.blockUpdate||o(t.connection,n),n.blockUpdate=!1})),this.on("disconnect",(function(e,t){e.getParent().blockUpdate||i(t.connection,n)}));var o=function(e,t){var a=t.getParent();a.sites_list_in_from=e.sourcePort.userData.sites_list_out,a.project=e.sourcePort.getUserData().project,a.scope=e.sourcePort.getUserData().scope,a.sop=e.sourcePort.getUserData().sop,a.updateTable()},i=function(e,t){var a=t.getParent();a.sites_list_in_from=[],a.updateTable()}},onConnect:function(e){e.setTargetDecorator(new(c().decoration.connection.ArrowDecorator)(10,10))}});var po=a("a45670b3d8fb79ec0258");c().RouterInputPort=c().InputPort.extend({NAME:"draw2d.RouterInputPort",init:function(e,t,a){this._super(e,t,a);var n=this;this.on("connect",(function(e,t){o(t.connection,n)})),this.on("contextmenu",(function(e,t){po.contextMenu({selector:"body",events:{hide:function(){po.contextMenu("destroy")}},callback:po.proxy((function(t,a){switch(t){case"delete":var o=n.getParent();o.userData.routes.forEach((function(t){t.source===e.getId()&&(o.getInputPorts().data.length>1?o.shiftForw():o.userData.routes=[])})),o.removePort(e),o.GetHTTPData(),o.updateUI();break;case"connect":n.getParent().userData.routes[0].source=n.getId(),n.getParent().GetHTTPData(),n.getParent().updateUI()}}),this),x:t.x,y:t.y,items:{delete:{name:"Delete"},connect:{name:"Connect"}}})}));var o=function(e,t){t.getParent().GetHTTPData()};this.setMaxFanOut(1)},onConnect:function(e){e.setTargetDecorator(new(c().decoration.connection.ArrowDecorator)(10,10))}});var ho=a("a45670b3d8fb79ec0258"),fo=a("aeb57e88bcb04c329061"),mo=a("8deafab7866a125bb9ca"),go=a("6fe5e339b0f8a936ba8c"),yo={version:"1.0.0"};function _o(e,t,a){var n=this,o=e,i={popup:ho.extend(!0,{},fo.default_popup),view:ho.extend(!0,{},fo.default_view),size:{width:o.width,height:o.height},tasks:[],series:[]},r=t=ho.extend(!0,i,t);this.context=a,this.paper=o,this.options=r,this.anim_speed=1,this.anim_style="linear",this.series=[];var s=mo.getColorAndOpacity(r.view);this.color=s.color,this.opacity=s.opacity,this.width=r.size.width,this.height=r.size.height,this.leftgutter=10,this.rightgutter=0,this.bottomgutter=0,this.topgutter=0,this.colorhue=.6,this.paper.setStart(),this.updateView(),this.bkgd||(this.bkgd=this.paper.rect(0,0,this.width,this.height).attr({fill:"transparent",stroke:"none"}).toBack()),ho(this.bkgd.node).on("contextmenu",(function(e,t){var a=n.context;ho.contextMenu({selector:"body",events:{hide:function(){ho.contextMenu("destroy")}},callback:ho.proxy((function(e,t){switch(e){case"paste":setTimeout((function(){tv4.validate(a.canvas.buffer,a.treema_scheme.properties.tasks.items)?(a.canvas.buffer.ID&&delete a.canvas.buffer.ID,a.canvas.buffer.outPort&&delete a.canvas.buffer.outPort,a.userData.tasks.push(ho.extend(!0,{},a.canvas.buffer)),a.clearTreema(),a.loadTreema(),a.resetUI(),mo.initFallDown(a,!0),a.GetHTTPData()):alert("Buffer is empty or data do not correspond to required type.")}),10);break;case"addTask":setTimeout((function(){a.userData.tasks.push(ho.extend(!0,{},fo.default_task)),a.clearTreema(),a.loadTreema(),a.resetUI(),mo.initFallDown(a,!0),a.GetHTTPData(),a.portRelayoutRequired=!0,a.layoutPorts()}),10);break;case"toogleInCon":setTimeout((function(){a.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){a.toogleOutConn()}),10);break;case"standard_sop":setTimeout((function(){if(confirm("You are about to clear all tasks and load Procedure Control Items")){var e,t,n=a.getInputPort("dataInput").getConnections().data[0].getSource().userData.sop;a.userData.useapi?(e=go.context+"/apidata/getAPIData?apiid=700743337020260352&user_id="+window.user_id+"&orderby="+JSON.stringify(["task_name,ASC"]),t=JSON.stringify({proj_id:a.project.proj_id,du_model_id:n.scope_id})):(e=go.context+"/data/natural",t=JSON.stringify({sql:"select st.scope_task_id, st.scope_task_code, st.scope_task_name, tt.task_code, tt.task_name from scopetask st left join task_template tt on tt.task_template_id = st.task_template_id where st.task_template_id is not null and st.enable_flag = 1 and tt.enable_flag = 1 and st.proj_id = '"+a.project.proj_id+"'and st.scope_id = '"+n.scope_id+"'"}));var o=e;this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=ho.ajax({url:o,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:t,success:function(e){var t=e.data?e.data:e;a.userData.tasks.forEach((function(e,t){var n=a.getOutputPort(e.outPort);n&&(a.removePort(n),n=null)})),a.userData.tasks=[],t.forEach((function(e,t){if(e.task_code&&e.task_name){var n=ho.extend(!0,{},fo.default_task);n.task={scope_task_code:e.scope_task_code,scope_task_name:e.scope_task_name,scope_task_id:e.scope_task_id,task_name:e.task_name,task_code:e.task_code};var o=e.task_name,i=(o=o.replace("Required","")).replace(/[（）]/g,"");n.label=i+" ("+e.task_code+")",a.userData.tasks.push(n)}})),a.userData.size.height&&delete a.userData.size.height,a.clearTreema(),a.loadTreema(),a.resetUI(),mo.initFallDown(a,!0),a.GetHTTPData(),a.portRelayoutRequired=!0,a.layoutPorts()},error:function(e,t){console.log(t)}})}}),10);break;case"whole_sop":setTimeout((function(){if(confirm("You are about to clear all tasks and load full SOP")){var e,t,n=a.getInputPort("dataInput").getConnections().data[0].getSource().userData.sop;a.userData.useapi?(e=go.context+"/apidata/getAPIData?apiid=700743337020260352&user_id="+window.user_id,a.userData.sop_mode&&"AC,WP"!==a.userData.sop_mode?"AC"===a.userData.sop_mode?t=JSON.stringify({proj_id:a.project.proj_id,du_model_id:n.scope_id,task_type:"AC"}):"WP"===a.userData.sop_mode&&(t=JSON.stringify({proj_id:a.project.proj_id,du_model_id:n.scope_id,task_type:"WP"})):t=JSON.stringify({proj_id:a.project.proj_id,du_model_id:n.scope_id})):(e=go.context+"/data/natural",t=JSON.stringify({sql:"select st.scope_task_id, st.scope_task_code, st.scope_task_name from scopetask st where 1 = 1 and st.enable_flag = 1 and st.proj_id = '"+a.project.proj_id+"'and st.scope_id = '"+n.scope_id+"'and st.wbs_name = 'Activity'order by st.seq_num"}));var o=e;this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=ho.ajax({url:o,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:t,success:function(e){var t=e.data?e.data:e;a.userData.tasks.forEach((function(e,t){var n=a.getOutputPort(e.outPort);n&&(a.removePort(n),n=null)})),a.userData.tasks=[],t.forEach((function(e,t){var n=ho.extend(!0,{},fo.default_task);n.task={scope_task_code:e.scope_task_code,scope_task_name:e.scope_task_name,scope_task_id:e.scope_task_id};var o="";e.order_num&&(o=e.order_num+" "),n.label=o+e.scope_task_name,a.userData.tasks.push(n)})),a.userData.size.height&&delete a.userData.size.height,a.clearTreema(),a.loadTreema(),a.resetUI(),mo.initFallDown(a,!0),a.GetHTTPData(),a.portRelayoutRequired=!0,a.layoutPorts()},error:function(e,t){console.log(t)}})}}),10)}}),n),x:e.originalEvent.screenX,y:e.originalEvent.screenY,items:{copy:{name:"Copy",disabled:!0},paste:{name:"Paste"},sep00:"---------",delete:{name:"Delete",disabled:!0},sep0:"---------",addTask:{name:"Add Task"},sep1:"---------",toogleInCon:a.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"},toogleOutCon:a.userData.showOutConnections?{name:"Hide Out Connections"}:{name:"Show Out Connections"},sep2:"---------",standard_sop:{name:"Procedure CI"},whole_sop:{name:"Get whole SOP"}}})})),this.svg_nodes=this.paper.setFinish()}_o.prototype.updateView=function(){var e=this,t=this.options;e.paper,this.current_y=this.topgutter,t.tasks.forEach((function(t,a){var n=ho.extend(!0,{},t),o=new bo(n,e.paper,e);e.series.push(o),o.draw()})),this.updateBlankets()},_o.prototype.clearSelection=function(){this.series.forEach((function(e,t){e.selected=!1;var a=Raphael.animation({fill:"#fff"},200);e.bkgrd.animate(a)}))},_o.prototype.updateBlankets=function(){this.paper,this.options,this.X},_o.prototype.addSerie=function(e,t){var a=this,n=(this.options,void 0!==t?t:a.series.length);this.paper.setStart();var o=ho.extend(!0,{},e),i=new bo(o,a.paper,a);return a.series.splice(n,0,i),a.redrawSeries(),a.updateBlankets(),this.paper.setFinish()},_o.prototype.removeSerie=function(e){var t=this,a=this.options,n=e;if(!(n>-1&&n<=t.series.length-1))return null;t.series[n],a.series.splice(n,1),t.series[n].remove(),t.redrawSeries(),t.updateBlankets()},_o.prototype.redrawSeries=function(){this.series.forEach((function(e,t){e.draw(),e.toFront()}))},_o.prototype.refresh=function(){this.redrawSeries(),this.updateBlankets()},yo.init=function(e,t,a){return new _o(e,t,a)};var bo=function(e,t,a){this.r=t,this.parent=a,this.ts_opt=e,this.ts_path=void 0,this.ts_bgp=void 0,this.ts_bar=void 0,this.ts_name_lbls=void 0,this.ts_percs_lbls=void 0,this.ts_curr_lbls=void 0,this.ts_total_lbls=void 0,this.ts_pu_set=void 0};bo.prototype={draw:function(){var e=this,t=this.parent,a=this.parent.context?{x:this.parent.context.getAbsoluteX(),y:this.parent.context.getAbsoluteY()}:{x:0,y:0},n=t.options.view,o=this.ts_opt.view,i={},r={},s={},l={},c={},u={};ho.extend(!0,i,n.label,o&&o.label?o.label:{}),ho.extend(!0,r,n.value,o&&o.value?o.value:{}),ho.extend(!0,s,n.percents,o&&o.percents?o.percents:{}),ho.extend(!0,l,n.total,o&&o.total?o.total:{}),ho.extend(!0,c,n.bar,o&&o.bar?o.bar:{}),ho.extend(!0,u,n.frame,o&&o.frame?o.frame:{});var d,p,h,f=i.font.font_size.toString()+"px Open Sans",m=r.font.font_size.toString()+"px Open Sans",g=s.font.font_size.toString()+"px Open Sans",y=l.font.font_size.toString()+"px Open Sans",_={font:f,"font-weight":i.font.font_weight,"font-style":i.font.font_style,fill:i.font.font_color,"text-anchor":"start"},b={font:m,"font-weight":r.font.font_weight,"font-style":r.font.font_style,fill:r.font.font_color,"text-anchor":"end"},v={font:g,"font-weight":s.font.font_weight,"font-style":s.font.font_style,fill:s.font.font_color,"text-anchor":"end"},w={font:y,"font-weight":l.font.font_weight,"font-style":l.font.font_style,fill:l.font.font_color,"text-anchor":"end"},x=t.series.indexOf(this),k=Number.isNaN(Math.round(this.ts_opt.value/this.ts_opt.total*1e3)/10)?0:Math.round(this.ts_opt.value/this.ts_opt.total*1e3)/10;/iPad|iPhone|iPod/.test(navigator.userAgent)&&window.MSStream,d=mo.getColorDarker(k/100),u.show||void 0===u.show?(p=u.color||"#4b4b4b",h=u.width||1):(p="none",h=0),c.show&&(this.ts_bar?this.ts_bar.attr({fill:d}).animate(Raphael.animation({width:(t.width-h)*(k/100)},300)):this.ts_bar=this.r.rect(h/2,t.current_y+h/2,0,c.height-h).attr({stroke:"none",opacity:.4,fill:"none"}));var D,S="0";(!this.parent.context.userData.sop_mode||"AC,WP"===this.parent.context.userData.sop_mode)&&this.ts_opt.label.indexOf(".")>-1&&(this.ts_opt.label=" -- "+this.ts_opt.label),this.ts_name_lbls?(this.ts_name_lbls.attr({text:this.ts_opt.label}),D=this.ts_name_lbls.getBBox(),this.ts_type_lbls.attr({x:D.x2+5-a.x,text:mo.getShirtTaskType(this.ts_opt.task_type)})):(this.ts_name_lbls=this.r.text(t.leftgutter,t.current_y+c.height/2,this.ts_opt.label).attr(_).show(),D=this.ts_name_lbls.getBBox(),this.ts_type_lbls=this.r.text(D.x2+5,t.current_y+c.height/2,mo.getShirtTaskType(this.ts_opt.task_type)).attr(_).attr({"font-weight":"bold"}).show()),i.show?(this.ts_name_lbls.show(),i.type_show?this.ts_type_lbls.show():this.ts_type_lbls.hide()):(this.ts_name_lbls.hide(),this.ts_type_lbls.hide()),l.show&&(S=this.ts_opt.total),l.show&&r.show&&(S="/"+S),this.ts_total_lbls?this.ts_total_lbls.attr({text:S}):this.ts_total_lbls=this.r.text(t.width-t.leftgutter,t.current_y+c.height/2,S).attr(w),l.show?this.ts_total_lbls.show():this.ts_total_lbls.hide(),r.show&&(D=this.ts_total_lbls.getBBox()),this.ts_curr_lbls?this.ts_curr_lbls.attr({x:-3+D.x-a.x,text:this.ts_opt.value}):this.ts_curr_lbls=this.r.text(-3+D.x,t.current_y+c.height/2,this.ts_opt.value).attr(b),r.show?this.ts_curr_lbls.show():this.ts_curr_lbls.hide(),s.show&&(D=this.ts_curr_lbls.getBBox()),this.ts_percs_lbls?this.ts_percs_lbls.attr({x:-15+D.x-a.x,text:"("+k+"%)"}):this.ts_percs_lbls=this.r.text(-15+D.x,t.current_y+c.height/2,"("+k+"%)").attr(v),s.show?this.ts_percs_lbls.show():this.ts_percs_lbls.hide(),this.blanket||(this.blanket=this.r.rect(0,t.current_y,t.width,c.height).attr({fill:"transparent",stroke:"none"}).toFront()),this.bkgrd?this.bkgrd.attr({stroke:p,"stroke-width":h}).toBack():this.bkgrd=this.r.rect(0,t.current_y,t.width,c.height).attr({fill:"#fff",stroke:p,"stroke-width":h}).toBack(),function(a,n,o,i){var r,s,l=e.parent.context;a.hover((function(){s=o?o.attr("fill"):"#dbdfe2",r=e.selected?Raphael.animation({fill:"#67bce2"},200):Raphael.animation({fill:"#e2e2e2"},200),n.animate(r),o&&o.animate(Raphael.animation({fill:"#dbdfe2"},200))}),(function(){r=e.selected?Raphael.animation({fill:"#72d4ff"},200):Raphael.animation({fill:"#fff"},200),n.animate(r),o&&o.animate(Raphael.animation({fill:s},200))})),a.click((function(){l.openTreemaTask(i);var t=Raphael.animation({fill:"#72d4ff"},200);e.parent.clearSelection(),e.selected=!0,n.animate(t)})),ho(a.node).on("contextmenu",(function(e,a){ho.contextMenu({selector:"body",events:{hide:function(){ho.contextMenu("destroy")}},callback:ho.proxy((function(e,a){switch(e){case"copy":setTimeout((function(){l.canvas.buffer=ho.extend(!0,{},l.userData.tasks[i])}),10);break;case"paste":setTimeout((function(){tv4.validate(l.canvas.buffer,l.treema_scheme.properties.tasks.items)?(l.canvas.buffer.ID&&delete l.canvas.buffer.ID,l.canvas.buffer.outPort&&delete l.canvas.buffer.outPort,l.userData.tasks.splice(i,0,ho.extend(!0,{},l.canvas.buffer)),l.clearTreema(),l.loadTreema(),l.resetUI(),mo.initFallDown(l,!0),l.GetHTTPData(),l.portRelayoutRequired=!0,l.layoutPorts()):alert("Buffer is empty or data do not correspond to required type.")}),10);break;case"delete":setTimeout((function(){var e=l.userData.tasks[i].label,t=l.userData.tasks.length-1;l.removePort(l.getOutputPort(l.userData.tasks[i].outPort)),l.userData.tasks.splice(i,1),l.clearTreema(),l.loadTreema(),l.resetUI();var a=l.getPort("commonDataOutput");if(a){var n=a.getConnections();n.data.length&&n.each(ho.proxy((function(n,o){var r=o.getTarget();"draw2d.PivotColInputPort"===r.NAME?mo.checkDisconn(r.getParent(),l.userData.tasks[i].ID):"draw2d.shape.fishbone.ra.AddRaTaskGroup"===r.getParent().NAME&&r.getParent().userData.tasks[i]&&r.getParent().safelyDeleteTask(t),console.log("TaskGroup delete data ("+e+") on: "+a.getName())}),this))}mo.initFallDown(l,!0),l.GetHTTPData(),l.portRelayoutRequired=!0,l.layoutPorts()}),10);break;case"addTask":setTimeout((function(){l.userData.tasks.push(ho.extend(!0,{},fo.default_task)),l.clearTreema(),l.loadTreema(),l.resetUI(),mo.initFallDown(l,!0),l.GetHTTPData(),l.portRelayoutRequired=!0,l.layoutPorts()}),10);break;case"toogleInCon":setTimeout((function(){l.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){l.toogleOutConn()}),10);break;case"exportToExcel":setTimeout((function(){var e=t.context.getOutputPort(t.context.userData.tasks[i].outPort).userData.sites_list_out;mo.exportArrayToExcel(e)}),10);break;case"viewData":setTimeout((function(){var e=t.context.getOutputPort(t.context.userData.tasks[i].outPort).userData.sites_list_out;l._scope.editor.viewTable(e)}),10)}}),this),x:e.originalEvent.screenX,y:e.originalEvent.screenY,items:{copy:{name:"Copy"},paste:{name:"Paste"},sep00:"---------",delete:{name:"Delete"},sep0:"---------",addTask:{name:"Add Task"},sep1:"---------",toogleInCon:l.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"},toogleOutCon:l.userData.showOutConnections?{name:"Hide Out Connections"}:{name:"Show Out Connections"},sep2:"---------",exportToExcel:{name:"Export To Excel"},viewData:{name:"View"}}})}))}(this.blanket,this.bkgrd,this.ts_bar,x),t.current_y=t.current_y+c.height},toFront:function(){this.ts_path&&this.ts_path.toFront(),this.ts_bgp&&this.ts_bgp.toFront(),this.ts_bar&&this.ts_bar.toFront(),this.ts_name_lbls&&this.ts_name_lbls.toFront(),this.ts_percs_lbls&&this.ts_percs_lbls.toFront(),this.ts_curr_lbls&&this.ts_curr_lbls.toFront(),this.ts_total_lbls&&this.ts_total_lbls.toFront()},toBack:function(){this.ts_path&&this.ts_path.toBack(),this.ts_bgp&&this.ts_bgp.toBack(),this.ts_bar&&this.ts_bar.toBack(),this.ts_name_lbls&&this.ts_name_lbls.toBack(),this.ts_percs_lbls&&this.ts_percs_lbls.toBack(),this.ts_curr_lbls&&this.ts_curr_lbls.toBack(),this.ts_total_lbls&&this.ts_total_lbls.toBack()},update:function(e){void 0!==e&&(this.ts_opt=ho.extend(!0,this.ts_opt,e)),this.undimm(),this.draw()},remove:function(){var e=this.parent.series.indexOf(this);this.parent.series.splice(e,1)},dimm:function(){this.blanket.attr({fill:"#df3c40"})},undimm:function(){this.blanket.attr({fill:"transparent"})}};var vo=a("a45670b3d8fb79ec0258");c().ui.LabelInplaceMemoEditor=c().ui.LabelEditor.extend({NAME:"draw2d.ui.LabelInplaceMemoEditor",init:function(e){this._super(),this.listener=extend({onCommit:function(){},onCancel:function(){},onStart:function(){}},e)},start:function(e){var t=this;this.label=e,this.commitCallback=this.commit.bind(this),vo("body").bind("click",this.commitCallback),this.html=vo('<input type="text" id="inplaceeditor">'),this.html.val(e.getText()),this.html.hide(),vo("body").append(this.html),this.html.autoResize(),this.html.bind("keyup",function(e){switch(e.which){case 13:this.commit();break;case 27:this.cancel()}}.bind(this)),this.html.bind("blur",this.commitCallback),this.html.bind("click",(function(e){e.stopPropagation(),e.preventDefault()}));var a=this.label.getCanvas(),n=this.label.getBoundingBox();n.setPosition(a.fromCanvasToDocumentCoordinate(n.x,n.y)),a.getScrollArea().is(vo("body"))&&n.translate(a.getScrollLeft(),a.getScrollTop()),n.translate(-1,-1),n.resize(2,2),this.html.css({position:"absolute",top:n.y,left:n.x,"min-width":n.w*(1/a.getZoom()),height:Math.max(25,n.h*(1/a.getZoom()))}),this.html.fadeIn((function(){t.html.focus(),t.listener.onStart()}))},commit:function(){var e=this;this.html.unbind("blur",this.commitCallback),vo("body").unbind("click",this.commitCallback);var t=this.html.val(),a=new(c().command.CommandAttr)(this.label,{text:t});this.label.getCanvas().getCommandStack().execute(a),this.html.fadeOut((function(){e.html.remove(),e.html=null,e.listener.onCommit(e.label.getText())}))},cancel:function(){var e=this;this.html.unbind("blur",this.commitCallback),vo("body").unbind("click",this.commitCallback),this.html.fadeOut((function(){e.html.remove(),e.html=null,e.listener.onCancel()}))}});var wo=a("0322dadfea5e4c6eb795"),xo=(a("110432cd068f6fa15fe7"),a("8deafab7866a125bb9ca"));Raphael.fn.drawTable=function(e,t,a,n,o,i,r,s){var l,c=10,u={font:"11px Tahoma, Geneva",fill:s=s||"#777","font-weight":"bold",opacity:.8},d={font:"10px Tahoma, Geneva",fill:s,opacity:.8},p=this.set(),h=[];l=o[0].data.length>0?n/o[0].data.length:1;for(var f=[],m=0;m<o[0].data.length+1;m++)f=f.concat(["M",Math.round(e)+.5-c,Math.round(t+m*l)+.5,"H",Math.round(e+a)+c+.5]);p.push(this.path(f.join(",")).attr({stroke:s}));var g=0;for(m=0;m<o.length;m++){h.push(this.set());var y=this.text(e+o[m].final_width/2+g,t-l/2,o[m].name).attr(u).toFront();h[m].push(y),g+=o[m].final_width}for(g=0,m=0;m<o.length;m++){for(var _=0;_<o[0].data.length;_++){y=this.text(e+o[m].final_width/2+g,t+l/2+l*_,xo.getFormatData(o[m].formatting,o[m].data[_])).attr(d).toFront(),h[m].push(y);var b=xo.getCellBg(this,o[m].formatting,e+g,t+l*_,o[m].final_width,l,o[m].data[_]);null!==b&&b.toBack()}g+=o[m].final_width}for(g=0,m=0;m<o.length;m++)void 0!==o[m].totals&&"none"!==o[m].totals&&(y=this.text(e+o[m].final_width/2+g,t+l/2+l*o[0].data.length,xo.getTotalValue(o[m].totals,o[m].data)).attr(u).toFront(),h[m].push(y)),g+=o[m].final_width;var v=[];for(g=0,m=0;m<o.length;m++)v=v.concat(["M",Math.round(e+g)+.5,Math.round(t)+.5-c,"V",Math.round(t+n)+.5+c]),g+=o[m].final_width;return v=v.concat(["M",Math.round(e+g)+.5,Math.round(t)+.5-c,"V",Math.round(t+n)+.5+c]),p.push(this.path(v.join(",")).attr({stroke:s})),h};var ko={version:"1.0.0"};function Do(e){var t=e.userData.table_col_spec,a=e.userData.size.width,n=(e.userData.size.height,e.userData.grid.left_m),o=(e.userData.grid.bottom_m,e.userData.grid.top_m),i=e.canvas.paper,r=t[0].data.length-1;this.paint=function(){e.canvas.paper.setStart();for(var s,l,c=(a-n)/(t.length+1),u=0,d=0,p=0;p<t.length;p++)"auto"!==t[p].width?(t[p].final_width=(s=t[p].width,l=a-2*n,s.indexOf("%")>0?l*parseInt(s.match(/\d+/)[0])/100:parseInt(s.match(/\d+/)[0])),d+=t[p].final_width):u++;var h,f,m=(a-2*n-d)/u;for(p=0;p<t.length;p++)"auto"===t[p].width&&(t[p].final_width=m);h=20*t[0].data.length,f=i.drawTable(n,o,a-2*n,h,t,0,r,"#4c4c4c");var g=0;for(p=0;p<t.length;p++){var y=p-0;Math.round(n+c*(y+.5)+c/2);var _=i.set();_.push(i.rect(n+g,o,t[p].final_width,20*t[0].data.length).attr({stroke:"1px",fill:"#777",opacity:0})),g+=t[p].final_width;var b=_[_.length-1];!function(t,a){b.hover((function(){e.isMoving||(clearTimeout(void 0),_.toFront(),null!==a&&a.attr("opacity",1))}),(function(){null!==a&&a.attr("opacity",.7)}))}(0,f[y])}_.toFront(),this.svg_nodes=e.canvas.paper.setFinish()},this.paint()}ko.init=function(e){return new Do(e)},a("37b68de747b6c7faf795"),a("bcaf2317679638841a11"),a("681e598f2e0ef0ea9681"),a("4e8cf7378c0b5fa93e9c"),a("5b6edb4a9817549ebdf4"),a("22fa153d84d0dbf77aa0"),a("6818efa84353bd95c747"),a("4fc010ae914d93447b01"),c().io.json.LWriter=c().io.Writer.extend({init:function(){this._super()},marshal:function(e,t){if("function"!=typeof t)throw"Writer.marshal method signature has been change from version 2.10.1 to version 3.0.0. Please consult the API documentation about this issue.";var a=[];e.getFigures().each((function(e,t){a.push(t.getPersistentAttributes())})),e.getLines().each((function(e,t){a.push(t.getPersistentAttributes())})),t(a)}}),a("14c12638e32a3ac802f4");var So=a("a45670b3d8fb79ec0258"),Co=a("8ffd603b4ae09158132b");c().io.png.WriterE=c().io.Writer.extend({init:function(){this._super()},marshal:function(e,t,a){if("function"!=typeof t)throw"Writer.marshal method signature has been change from version 2.10.1 to version 3.0.0. Please consult the API documentation about this issue.";var n="";if(e instanceof c().Figure){var o=e.getPosition();e.setPosition(1,1),n='<svg xmlns:xlink="http://www.w3.org/1999/xlink" >'+e.shape.node.outerHTML+"</svg>",e.setPosition(o),e.initialWidth=e.getWidth()+2,e.initialHeight=e.getHeight()+2}else e.hideDecoration(),-1===(n=e.getHtmlContainer().html().replace(/>\s+/g,">").replace(/\s+</g,"<")).indexOf("http://www.w3.org/1999/xlink")&&(n=n.replace("<svg ",'<svg xmlns:xlink="http://www.w3.org/1999/xlink" '));document.all&&(n=n.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,""));var i=So('<canvas id="canvas_png_export_for_draw2d" style="display:none"></canvas>');So("body").append(i);var r=So("#canvas_png_export_for_draw2d")[0];r.width=2*e.initialWidth,r.height=2*e.initialHeight,Co("canvas_png_export_for_draw2d",n,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){try{if(e instanceof c().Canvas&&e.showDecoration(),void 0!==a){var n=a.x,o=a.y,s=a.w,l=a.h,u=document.createElement("canvas");u.width=2*s,u.height=2*l,u.getContext("2d").drawImage(r,n,o,s,l,0,0,2*s,2*l);var d=u.toDataURL("image/png"),p=d.replace("data:image/png;base64,","");t(d,p)}else{var h=r.toDataURL("image/png");t(h,h.replace("data:image/png;base64,",""))}}finally{i.remove()}}})},marshalR:function(e,t){if("function"!=typeof t)throw"Writer.marshal method signature has been change from version 2.10.1 to version 3.0.0. Please consult the API documentation about this issue.";var a="",n=e.getBoundingBox(),o=e.svgNodes.getBBox(),i=So('<dev id="canvas_raphael_for_export" style="display: none; width: 1000px; height: 1000px"></dev>');So("body").append(i);var r=Raphael("canvas_raphael_for_export",o.width+20,o.height+20);e.drawFigureOnPaper(r),r.forEach((function(e){e.translate(n.x-o.x+10,n.y-o.y+10)})),-1===(a=r.toSVG()).indexOf("http://www.w3.org/1999/xlink")&&(a=a.replace("<svg ",'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ')),document.all&&(a=a.replace(/xmlns=\"http:\/\/www\.w3\.org\/2000\/svg\"/,""));var s=So('<canvas id="canvas_png_export_for_draw2d" style="display:none"></canvas>');So("body").append(s);var l=So("#canvas_png_export_for_draw2d")[0];l.width=o.width+20,l.height=o.height+20,Co("canvas_png_export_for_draw2d",a,{ignoreMouse:!0,ignoreAnimation:!0,renderCallback:function(){try{t(l,a)}finally{s.remove()}}})}}),a("40482ad684dde7d1d558");var To=a("a45670b3d8fb79ec0258"),Ao=a("aeb57e88bcb04c329061"),Po=a("a7583c9a3ff76b2fdd52"),Eo=a("8deafab7866a125bb9ca");function Io(e){return Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Io(e)}c().shape.fishbone.cell.Cellnode=c().SetFigure.extend({init:function(e,t,a,n){this.PADDING=12,this.GAP=10,this._super(To.extend({},e),t,a),this.strokeScale=!1,this.setResizeable(!1),e.filter_str&&(this.filter_str=e.filter_str),e.top_str&&(this.top_str=e.top_str),e.val_str&&(this.val_str=e.val_str);var o={font_size:10,font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal"};this.default_title_font=To.extend(!0,{},o,{font_size:12,font_weight:"bold"}),this.default_filter_font=To.extend(!0,{},o),this.default_value_font=To.extend(!0,{},o,{font_size:22,font_weight:"bold"});var i=this;this.on("dblclick",(function(e,t){var a=prompt("Please enter text",i.top_label.attr("text"));null!=a&&(""!==a?(i.userData.isEditedLabel=!0,i.userData.label=a,i.updateUI()):(delete i.userData.isEditedLabel,i.userData.label=a,i.updateUI()))})),this.treema_scheme={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{updateBlock:{type:"boolean",title:"Block Auto Update",default:!0},hidden:{type:"boolean",title:"Mobile hidden",default:!1,format:"hidden"},index:{type:"integer",title:"Mobile Index",default:0,format:"hidden"},autoWidth:{type:"boolean",title:"Auto Width",default:!1,format:"hidden"},group_name:{type:"string",title:"Group Name",default:""},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},view:{type:"object",title:"Style",properties:{init_mode:{type:"object",title:"Table Mode",properties:{fg_color:{type:"string",format:"colorpicker",default:"#4da6ff"},background:{type:"string",format:"colorpicker",default:"#fff"}}},text_mode:{type:"object",title:"Text Mode",properties:{on:{type:"boolean",title:"On",default:!1},text_color:{type:"string",format:"colorpicker",default:"#494950"}}},title:{type:"object",title:"Title Label Setup",default:{hide:!1,font:i.default_title_font},properties:{hide:{type:"boolean",title:"Hide",default:!1},font:Ao.template_font}},filter:{type:"object",title:"Filter Label Setup",default:{hide:!1,font:i.default_filter_font},properties:{hide:{type:"boolean",title:"Hide",default:!1},font:Ao.template_font}},value:{type:"object",title:"Value Label Setup",default:{hide:!1,font:i.default_value_font},properties:{hide:{type:"boolean",title:"Hide",default:!1},font:Ao.template_font}},bin_mode:{type:"object",title:"Conditional Mode",properties:{on:{type:"boolean",title:"On",default:!1},invert:{type:"boolean",title:"Inverted",default:!1}}},orientation:{type:"string",title:"Orientation",default:"horizontal",enum:["horizontal","vertical"]}}},bypass_mode:{type:"boolean",title:"Name Bypass mode",default:!1},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},conn_count:{type:"integer",title:"Connection Count",default:1},value:{type:"integer",title:"Current Value",default:0},label:{type:"string",format:"hidden",default:"New Label"},isEditedLabel:{type:"boolean",format:"hidden",default:!0}}},this.userData={hidden:!1,autoWidth:!1,value:0,group_name:"",sites_list_out:[],isEditedLabel:!1,showInConnections:!0,showOutConnections:!0,view:{init_mode:{fg_color:e.color},text_mode:{on:!1,text_color:"#494950"},title:{hide:!1,font:i.default_title_font},filter:{hide:!1,font:i.default_filter_font},value:{hide:!1,font:i.default_value_font},bin_mode:{on:!1,invert:!1},orientation:"horizontal"}},e.background&&(this.userData.view.init_mode.background=e.background);var r={};e.items&&(r=e.items),n.editor.editorMode&&(r=To.extend(!0,r,{toogleInCon:{name:"Toogle In Connections"},toogleOutCon:{name:"Toogle Out Connections"},sep1:"---------",copy_style:{name:"Copy Style"},paste_style:{name:"Paste Style",disabled:function(){return!tv4.validate(i.canvas.buffer,i.treema_scheme.properties.view)}},sep2:"---------",dump_data:{name:"Dump"}})),r=To.extend(!0,r,{exportToExcel:{name:"Export To Excel"},viewData:{name:"View"}}),this.on("contextmenu",(function(e,t){To.contextMenu({selector:"body",events:{hide:function(){To.contextMenu("destroy")}},callback:To.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){i.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){i.toogleOutConn()}),10);break;case"exportToExcel":setTimeout((function(){i.exportToExcel()}),10);break;case"viewData":setTimeout((function(){n.editor.viewTable(i.userData.sites_list_out)}),10);break;case"copy_style":setTimeout((function(){i.canvas.buffer=To.extend(!0,{},i.userData.view)}),10);break;case"paste_style":setTimeout((function(){if(tv4.validate(i.canvas.buffer,i.treema_scheme.properties.view)){var e=new(c().command.CommandStyle)(i,To.extend(!0,{},i.canvas.buffer));i.getCanvas().getCommandStack().execute(e)}else alert("Buffer is empty or data do not correspond to required type.")}),10);break;case"dump_data":setTimeout((function(){var e,t,a;console.log(i),console.log("Total size: "+(e=i,t=[],a=JSON.stringify(e,(function(e,a){if("object"===Io(a)&&null!==a){if(-1!==t.indexOf(a))return;t.push(a)}return a})),t=null,a).length)}),100)}}),this),x:t.x,y:t.y,items:r})})),this.exportToExcel=function(){var e=this.userData.sites_list_out.slice(),t="",a="";for(var n in e[0],e[0])a+='"'+(n+"").replace(/"/g,'""')+'",';t+=(a=a.slice(0,-1))+"\r\n";for(var o=0;o<e.length;o++){for(var n in a="",e[o])a+='"'+(e[o][n]instanceof Date?Po(e[o][n]).format("DD-MM-YYYY"):e[o][n]+"").replace(/"/g,'""')+'",';t+=(a=a.slice(0,-1))+"\r\n"}var i=document.createElement("a");i.setAttribute("href","data:text/csv;charset=utf-8,"+escape(t)),i.setAttribute("download","fish_bone_export.csv"),i.click()},this.setTextMode=function(){this.top_label&&this.top_label.attr({fill:this.userData.view.text_mode.text_color||"#484848"}),this.val_label&&this.val_label.attr({fill:this.userData.view.text_mode.text_color||"#484848"}),this.filter_label&&this.filter_label.attr({fill:this.userData.view.text_mode.text_color||"#484848"}),this.frame.attr({stroke:"none"})},this.setTableMode=function(){this.top_label&&this.top_label.attr({fill:this.userData.view.init_mode.fg_color}),this.val_label&&this.val_label.attr({fill:this.userData.view.init_mode.fg_color}),this.filter_label&&this.filter_label.attr({fill:this.userData.view.init_mode.fg_color}),this.frame.attr({stroke:this.userData.view.init_mode.fg_color}),this.userData.view.init_mode.background&&this.frame.attr({fill:this.userData.view.init_mode.background})},this.refreshSVG=function(){var e=!0;if(this.userData.view.title.hide?this.top_label.attr(Eo.getFontAttr(this.userData.view.title.font||{},this.userData.view.text_mode.on?this.userData.view.text_mode.text_color:this.userData.view.init_mode.fg_color,this.default_title_font)).attr({"font-size":0}):(this.top_label.attr(Eo.getFontAttr(this.userData.view.title.font||{},this.userData.view.text_mode.on?this.userData.view.text_mode.text_color:this.userData.view.init_mode.fg_color,this.default_title_font)),this.userData.view.filter.hide?this.top_label.attr({y:24}):this.top_label.attr({y:12}),e=!1),this.userData.view.filter.hide)this.filter_label.attr(Eo.getFontAttr(this.userData.view.filter.font||{},this.userData.view.text_mode.on?this.userData.view.text_mode.text_color:this.userData.view.init_mode.fg_color,this.default_filter_font)).attr({"font-size":0});else{this.filter_label.attr(Eo.getFontAttr(this.userData.view.filter.font||{},this.userData.view.text_mode.on?this.userData.view.text_mode.text_color:this.userData.view.init_mode.fg_color,this.default_filter_font));var t=this.filter_label.getBBox();this.userData.view.title.hide?this.filter_label.attr({y:24}):this.filter_label.attr({y:24+t.height/2}),e=!1}var a=this.na_set.getBBox(),n=this.PADDING+(isFinite(a.width)?a.width:0)+(e?0:this.GAP);this.val_label.attr({x:n,y:21}).attr(Eo.getFontAttr(this.userData.view.value.font||{},this.userData.view.text_mode.on?this.userData.view.text_mode.text_color:this.userData.view.init_mode.fg_color,this.default_value_font)),a=this.na_set.getBBox();var o=this.val_label.getBBox();this.frame.attr({width:2*this.PADDING+a.width+o.width+this.PADDING,height:a.height+this.PADDING}).toBack(),a=this.set.getBBox(),this.originalWidth=a.width,this.originalHeight=a.height,this.minWidth=a.width,this.minHeight=a.height,this.setDimension(this.originalWidth,this.originalHeight),this.repaint()}},createSet:function(){var e=this.top_str||"Item Name",t=this.filter_str||"Filter",a=this.val_str||"0",n=!0,o=this.userData.view.title.hide?0:12,i=this.userData.view.title.hide?24:12;this.top_label=this.canvas.paper.text(this.PADDING,i,e).attr(Eo.getFontAttr(this.userData.view.title.font||{},this.userData.view.text_mode.on?this.userData.view.text_mode.text_color:this.userData.view.init_mode.fg_color,this.default_title_font)).attr({"font-size":o}),this.set=this.canvas.paper.set(),this.na_set=this.canvas.paper.set(),this.set.push(this.top_label),this.userData.view.title.hide||(this.na_set.push(this.top_label),n=!1),o=this.userData.view.filter.hide?0:10,i=this.userData.view.filter.hide?24:30,this.filter_label=this.canvas.paper.text(this.PADDING,i,t).attr(Eo.getFontAttr(this.userData.view.filter.font||{},this.userData.view.text_mode.on?this.userData.view.text_mode.text_color:this.userData.view.init_mode.fg_color,this.default_filter_font)).attr({"font-size":o}),this.userData.view.filter.hide||(this.na_set.push(this.filter_label),n=!1),this.set.push(this.filter_label);var r=this.na_set.getBBox(),s=this.PADDING+(isFinite(r.width)?r.width:0)+(n?0:this.GAP);return this.val_label=this.canvas.paper.text(s,21,a).attr(Eo.getFontAttr(this.userData.view.value.font||{},this.userData.view.text_mode.on?this.userData.view.text_mode.text_color:this.userData.view.init_mode.fg_color,this.default_value_font)),this.set.push(this.val_label),r=this.set.getBBox(),this.frame=this.canvas.paper.rect(0,0,this.PADDING+r.width+this.PADDING,r.height+this.PADDING,15).attr({stroke:this.userData.view.text_mode.on?"none":this.userData.view.init_mode.fg_color,"stroke-width":2.5}).toBack(),this.userData.view.init_mode.background&&this.frame.attr({fill:this.userData.view.init_mode.background}),this.set.push(this.frame),r=this.set.getBBox(),this.setDimension(r.width,r.height),this.set},onDragStart:function(e,t,a,n){return!this.dragIsLocked&&this._super(e,t,a,n)},applyAlpha:function(){},updateUI:function(e){Eo.applyTextMode(e),Eo.applyBinMode(e),this.refreshSVG()},setPersistentAttributes:function(e){e.userData=To.extend(!0,{},this.userData,e.userData),e.userData.text_mode&&(e.userData.view.text_mode.on=!0,delete e.userData.text_mode),e.userData.bin_mode&&(e.userData.view.bin_mode.on=!0,delete e.userData.bin_mode),e.userData.invert_bin_mode&&(e.userData.view.bin_mode.invert=!0,delete e.userData.invert_bin_mode),delete e.bgColor,delete e.color,delete e.stroke,delete e.radius,this._super(e)}}),a("1ad7c125deda13f7acbe");var No=a("8a868d10b6533e768658"),Mo=a("a45670b3d8fb79ec0258"),Oo=a("aeb57e88bcb04c329061"),jo=a("8deafab7866a125bb9ca"),Ro=a("6fe5e339b0f8a936ba8c");No.shape.fishbone.cell.Datanode=No.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Datanode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Datanode</strong>}<br/><br/> <strong>Task </strong><cite>Node </cite>Provide access to Task columns<br/><br/><strong>Configuration: </strong><br/><br/><strong>Task*: </strong> <cite>Select Task by providing task name or task code ",init:function(e,t,a,n){this._super(Mo.extend({color:"#4da6ff"},e),t,a,n);var o=this;this.setDimension(160,35),this.sites_list_in=[],this.sites_list_out=[],Mo.extend(this.userData,{useapi:!0,use_du_id:!0,data_type:"real time",task_type:"actual",count_type:"physical",task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],sites_list_out:[],fixed_data:[],isEditedLabel:!1,label:""}),Mo.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{useapi:{type:"boolean",title:"Use Big Data",default:!0},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},task_type:{type:"string",title:"Task Type",default:"actual"},count_type:{type:"string",title:"Count Type",default:"physical",enum:["physical","logical"]},config:Oo.template_config,multy_milestone:{type:"boolean",title:"Is Multi Milestone",default:!1},multy_milestones:{type:"array",title:"Milestones List",items:{type:"object",title:"Task",format:"taskcode",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}}},task:{type:"object",title:"Task",format:"taskcode",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}},conditions:Oo.template_conditions,fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2020",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},label:{type:"string",format:"hidden",default:""},use_du_id:{type:"boolean",title:"Use du_id",default:!0},use_task_name:{type:"boolean",title:"Use Task Name",default:!0},ssop_mode:{type:"boolean",title:"Procedure CI Mode",default:!0},use_ssop_code:{type:"boolean",title:"Use Procedure CI Code",default:!0},showProgress:{type:"boolean",title:"Show Progress",default:!0,format:"hidden"},hide_cond:{type:"boolean",title:"Hide Conditions Label",default:!1,format:"hidden"},bypass:{type:"boolean",title:"Data Bypass Mode",default:!1},font_size:{type:"integer",title:"Font Size",default:18,format:"hidden"},font_size_name_label:{type:"integer",title:"Font Size (Name Label)",default:12,format:"hidden"},text_color:{type:"string",title:"Text_color",default:"#838383",format:"hidden"},index:{type:"integer",title:"Mobile Index",default:0}},required:["task"]}),this.GetHTTPData=function(){var e;DEBUG&&console.log("Task node: "+this.id+" init GetHTTPData.");var t=this.getUserData(),a=o.getPort("output0");o.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500));var n,i=function(e){o.userData.value=e.length,o.userData.sites_list_out=e,o.stopTimer(),o.updateUI()};n=""!==t.label?t.label:t.multy_milestone?t.multy_milestones[0].scope_task_name:this.userData.ssop_mode?t.task.task_name:t.task.scope_task_name;var r={project:this.project,scope:this.scope,sop:this.sop,col_name:n,task_type:t.task_type,group_name:t.group_name,id:this.getId(),figure_id:this.getId(),color:this.getColor()};if((null===(e=this.sites_list_in)||void 0===e?void 0:e.length)>0||!this.sites_list_in)jo.getTaskData(t,this.sites_list_in,a,r,i,t.useapi);else if(!this.sites_list_in.length){var s={sites_list_out:[]};s.item_name=r.col_name,s.task_type=r.task_type,s.project=r.project,s.scope=r.scope,a.userData=s,a.getConnections().each(Mo.proxy((function(e,t){var n=t.getTarget();n.setValue(r.figure_id),t.setColor(r.color),DEBUG&&console.log("Data send from: "+a.getName()+" to: "+n.getParent().NAME)}),this)),i([])}},this.getRealCount=function(){return 1},this.createPort("output");var i=new No.DataInputPort;i.setConnectionDirection(3),i.setName("dataInput"),this.addPort(i),this.setDimension(this.width,this.height),this.layoutPorts(),this.updateSearchCol=function(e,t,a,n){var o,i;o=a.userData.ssop_mode?jo.makeTaskSearchSSOPTreemaNodeClass:jo.makeTaskSearchTreemaNodeClass,a.project=e,a.scope=t;var r="700743337020260352";n&&(a.sop=n),i=a.sop?a.userData.useapi?o(Ro.context+"/apidata/getAPIData?apiid="+r+"&user_id="+window.user_id,a,!0,{proj_id:e.proj_id,du_model_id:a.sop.scope_id}):o(Ro.context+"/data/getAllSOPTasks?scope_id="+a.sop.scope_id+"&proj_id="+e.proj_id,a,!0):a.scope?a.userData.useapi?o(Ro.context+"/apidata/getAPIData?apiid="+r+"&user_id="+window.user_id,a,!0,{proj_id:e.proj_id,du_model_id:a.scope.scope_id}):o(Ro.context+"/data/getAllTasks?scope_id="+t.scope_id+"&proj_id="+e.proj_id,a,!0):a.userData.useapi?o(Ro.context+"/apidata/getAPIData?apiid="+r+"&user_id="+window.user_id,a,!0,{proj_id:e.proj_id}):o(Ro.context+"/data/getAllProjectTasks?proj_id="+e.proj_id,a,!0),TreemaNode.setNodeSubclass("taskcode",i)},this.repaint()},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.userData.ssop_mode?this.top_label.setText(e.task.task_name):this.top_label.setText(e.task.scope_task_name),jo.setConditions(e.conditions,this),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(a,n){a.getConnections().each(Mo.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),jo.getMessage(t,o,"ticket send to"),o.superUpdate=!!e.superUpdate,o.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||n.setColor("#dfdfdf")}),this))}));else if("dataInput"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.updateSearchCol(a.getUserData().project,a.getUserData().scope,this,a.getUserData().sop),this.GetHTTPData()}},getPersistentAttributes:function(){return this._super()},setPersistentAttributes:function(e){this._super(e)}}),a("110548ced7d31fb0d987"),a("8c59153af2412b70442c"),a("93809f4e6976f07313fb"),a("1bf2fbdb051fe0c57024"),a("8a868d10b6533e768658"),a("8deafab7866a125bb9ca");var Lo=a("8a868d10b6533e768658"),Fo=a("a45670b3d8fb79ec0258"),Uo=a("1bf2fbdb051fe0c57024"),Bo=a("6fe5e339b0f8a936ba8c"),zo=a("8deafab7866a125bb9ca");Lo.shape.fishbone.cell.Codenode=Lo.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Codenode",INFO:"{Class: <strong>Codenode</strong>}<br/><br/> <strong>Code </strong><cite>Node </cite>Provide access to Codes columns<br/><br/><strong>Configuration: </strong><br/><br/><strong>Code Type*: </strong> <cite>Mention Code column name ",init:function(e,t,a,n){this._super(Fo.extend({color:"#af81e7",items:{filter:{name:"Filter",icon:"fas fa-filter",callback:function(){n.editor.selectCodeValues(o)}},reset_filter:{name:"Reset Filter",icon:"fas fa-redo",callback:function(){o.resetFilter()}},sep:"---------"}},e),t,a,n);var o=this;this.sites_list_in=[],Fo.extend(this.userData,{node_type:"from DB",code:{code_type_id:"",code_type_name:"Code Name"},conditions:[{logic:"",prop:"self",sign:"not equal",value:"empty"}],label:""}),Fo.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{node_type:{type:"string",format:"hidden",title:"Type",default:"from DB",enum:["from DB","calculated"]},code:{type:"object",title:"Code Type",format:"codetype",properties:{code_type_id:{type:"string"},code_type_name:{type:"string"}}},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",title:"Logic apply",default:"",enum:["","and","or"]},prop:{type:"string",title:"Property Name",default:"self"},sign:{type:"string",default:"not equal",title:"Sign",enum:["not equal","equal","consist","not consist","more than","less than","more or equal than","less or equal than"]},value:{type:"string",title:"Condition Value",default:"empty"}},required:["logic","prop","sign","value"]}},filter:{type:"object",title:"Filter",format:"hidden",properties:{filtered:{type:"boolean",default:!1},list:{type:"array",items:{type:"object",title:"Filter",properties:{site_code:{type:"string",title:"Site Code"},udf_type_name:{type:"string",title:"Site Name"}}}}}},label:{type:"string",format:"hidden",default:""}},required:["node_type","code","conditions"]}),this.GetHTTPData=function(){var e=Bo.context+"/data/CodePerSite",t=this.getUserData();if(null!=t.code.code_type_id&&""!=t.code.code_type_id){o.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500));var a,n=e+"?&code_type_id="+t.code.code_type_id;a=""!==t.label&&void 0!==t.label?t.label:t.code.code_type_name;var i=JSON.stringify(this.sites_list_in);this.xhr&&4!=this.xhr.readyState&&this.xhr.abort(),this.xhr=Fo.ajax({url:n,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:i,success:function(e){var n=[];e.length>0&&e.forEach((function(e,t){var o={};o.site_id=e.site_id,o.site_code=e.site_code,o[a]=e.my_value,o.value=e.my_value,n.push(o)}));var i=function(e,t,a){var n;if("from DB"==e.node_type){var i=e.conditions;o.getConditions(i),n=(new Uo).from(t).where((function(e,t){var n,o,r=!0;return i.forEach((function(t,i){n="empty"===t.value?"":t.value,o=null===e[a]?"":e[a],"and"===t.logic||0===i?"not equal"===t.sign?r=r&&o!==n:"equal"===t.sign?r=r&&o===n:"consist"===t.sign?r=r&&o.indexOf(n)>-1:"not consist"===t.sign?r=r&&-1===o.indexOf(n):"more than"===t.sign?r=r&&o>n:"less than"===t.sign?r=r&&o<n:"more or equal than"===t.sign?r=r&&o>=n:"less or equal than"===t.sign&&(r=r&&o<=n):"or"===t.logic&&("not equal"===t.sign?r=r||o!==n:"equal"===t.sign?r=r||o===n:"consist"===t.sign?r=r&&o.indexOf(n)>-1:"not consist"===t.sign?r=r&&-1===o.indexOf(n):"more than"===t.sign?r=r&&o>n:"less than"===t.sign?r=r&&o<n:"more or equal than"===t.sign?r=r&&o>=n:"less or equal than"===t.sign&&(r=r&&o<=n))})),r})).select()}else"calculated"==e.node_type&&(i=e.conditions).forEach((function(e,a){"Total"==e.prop&&(n=t)}));return n}(t,n,a);if(o.userData.filter.filtered)o.setFilter(i);else{o.val_label.setText(i.length),o.userData.value=i.length,o.userData.sites_list_out=i;var r=o.getPort("output0");r.setValue(i),r.setUserData({project:o.project,scope:o.scope,sop:o.sop,item_name:a,sites_list_out:i}),o.getOutputPort(0).getConnections().each(Fo.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),o.stopTimer()}o.updateUI()}})}},this.resetFilter=function(){var e,t=o.userData;if(e=""!==t.label&&void 0!==t.label?t.label:t.code.code_type_name,o.userData.filter.filtered){zo.initFallDown(o);var a=this.getPort("dataInput").getConnections();o.sites_list_in=a.data[0].sourcePort.userData.sites_list_out,o.userData.filter.filtered=!1,o.userData.filter.list=[],o.userData.sites_list_out=o.userData.filter.original_list,o.userData.filter.original_list=[],o.userData.value=o.userData.sites_list_out.length;var n=o.getPort("output0");n.setValue(o.userData.sites_list_out),n.setUserData({project:o.project,scope:o.scope,item_name:e,sites_list_out:o.userData.sites_list_out}),o.getOutputPort(0).getConnections().each(Fo.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),o.updateUI()}},this.setFilter=function(e){var t,a=o.userData;t=""!==a.label&&void 0!==a.label?a.label:a.code.code_type_name,o.userData.filter.original_list.length<1&&(o.userData.filter.original_list=e),o.startTimer();var n=[];a.filter.list.forEach((function(e,t){n.push(e.value)}));var i=(new Uo).from(e).in(n,t).select();o.userData.value=i.length,o.userData.sites_list_out=i;var r=o.getPort("output0");r.setValue(i),r.setUserData({project:o.project,scope:o.scope,item_name:t,sites_list_out:i}),o.getOutputPort(0).getConnections().each(Fo.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),o.updateUI(),o.stopTimer()},this.createPort("output");var i=null;(i=new Lo.DataInputPort).setConnectionDirection(3),i.setName("dataInput"),this.addPort(i),this.setDimension(this.width,this.height),this.layoutPorts(),this.updateSearchCol=function(e,t,a,n){var o,i,r=(o=Bo.context+"/data/getAllCodes?scope_id="+t.scope_id+"&proj_id="+e.proj_id,i=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.extend(i),i.prototype.url=o,i.prototype.formatDocument=function(e){return e.code_type_name},i.prototype.search=function(){var e;if((e=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!e&&this.getSearchResultsEl().empty(),e)){this.lastTerm=e,this.getSearchResultsEl().empty().append("Searching");var t=this.searchCallback;Fo.ajax({url:this.url,datatype:"json",type:"GET",success:function(a){var n=(new Uo).from(a).where((function(t,a){return-1!==t.code_type_name.toLowerCase().indexOf(e.toLowerCase())})).select();t(n)}})}},i.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data.code_type_id=e.data("value").code_type_id,this.data.code_type_name=e.data("value").code_type_name,zo.initFallDown(a),a.updateUI(),a.GetHTTPData())},i.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==i.code_type_name.toLowerCase().indexOf(a.toLowerCase())&&t.push(i)})),this.super("searchCallback").apply(this,[t])},i);TreemaNode.setNodeSubclass("codetype",r),a.project=e,a.scope=t,n&&(a.sop=n)}},getConditions:function(e){var t=this;this.filter_label.setText(""),e.forEach((function(e,a){""!==t.filter_label.getText()&&t.filter_label.setText(t.filter_label.getText()+"\n"),t.filter_label.setText(t.filter_label.getText()+e.logic+" "+e.sign+" "+e.value)}))},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText(e.code.code_type_name),void 0===e.filter&&(e.filter={filtered:!1,list:[],original_list:[]}),e.filter.filtered?this.filter_label.setText("Multiple filter"):this.getConditions(e.conditions),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(Fo.proxy((function(e,a){a.getTarget().setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||a.setColor("#dfdfdf")}),this))}));else if("dataInput"==e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.updateSearchCol(a.getUserData().project,a.getUserData().scope,this,a.getUserData().sop),this.GetHTTPData()}},setPersistentAttributes:function(e){this._super(e)}}),a("15af024cc936f2e4c46e"),a("c9983751f94ace4ce8a6"),a("1a03669a43e555fbf98f"),a("8b8eccd40d1bc3f8dd2b");var Ho=a("d03d36be50c40888c6b4"),qo=(a("7c9e29c717f799964fbc"),a("be724121e5c7ab220f70"),a("4607aee02dca06a179f0"),a("8a868d10b6533e768658")),Vo=a("a45670b3d8fb79ec0258"),Wo=a("aeb57e88bcb04c329061"),Go=a("d1be49724a1f416e7f57"),Jo=a("8deafab7866a125bb9ca"),Qo=a("a45670b3d8fb79ec0258"),Yo=a("a7583c9a3ff76b2fdd52");qo.shape.fishbone.ra.RaPivotnode=qo.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaPivotnode",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaPivotnode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(Vo.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a),this.sscope=n,this.dx=0,this.dy=0;var o=this;this.sites_list_in=[],this.updateTickets=0;var i,r,s=this.getUserData(),l=Array.from(Wo.defaul_performance);this.default_user_data={hidden:!0,renderer:"Ra Segment Table",join_type:"du_id",aggregator:{name:"Count",vals:[]},toolbar:{buttons:{table:!0,linechart:!0,barchart:!0,save:!0,save_pic:!0,data:!0,refresh:!0,left:!1,right:!1},location:"top",show:!0},size:{width:800,height:300},grid:Vo.extend(!0,{},default_grid),pivot:{colors:{data_color:"#8c8c8c",labels_color:"#4c4c4c",frame_color:"#4c4c4c",monochromatic:!1,mono_base_color:"#ffffff",colors_array:[]},full_j:!1,multi_line_max:300,fonts:{data_font:{font_size:12,font_color:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal"},titles_font:{font_size:12,font_color:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold"},totals_font:{font_size:12,font_color:"#8c8c8c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold"}},table:{rows:10,columns:10,style:{}},chart:{series:[],toolbar:Vo.extend(!0,{},default_toolbar),title:Vo.extend(!0,{},default_title),title_left:Vo.extend(!0,{},default_title_left),title_right:Vo.extend(!0,{},default_title_right),data_table:Vo.extend(!0,{},default_data_table),xAxis:Vo.extend(!0,{},default_xAxis,{labels:{multi_line:!1,separator:"-"}}),yAxis:Vo.extend(!0,{},default_yAxis)},aging:{first_lim:5,second_lim:10},performance:l},col:[],row:[],sorters:[{sort_field_name:"task_type",sort_list:["baseline","forecast","actual","difference","gap"]}],filters:[],showInConnections:!0,showColTotals:!0,showRowTotals:!0,sites_list_out:[]},this.default_user_data.pivot.chart.toolbar.buttons.push({show:!0,name:"table",icon:"data:image/png;base64,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",onclick:function(){o.userData.renderer="Ra Segment Table",o.GetHTTPData()}}),null===s&&this.attr({userData:Vo.extend({},this.default_user_data)}),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},join_type:{type:"string",title:"Join Type",default:"du_id",enum:["site_id","du_id","site_code"]},index:{type:"integer",title:"Mobile Index",default:0},toolbar:{type:"object",title:"Toolbar",properties:{buttons:{type:"object",title:"Toolbar",properties:{table:{type:"boolean",title:"table",default:!0},linechart:{type:"boolean",title:"line chart",default:!0},barchart:{type:"boolean",title:"bar chart",default:!0},save:{type:"boolean",title:"save",default:!0},save_pic:{type:"boolean",title:"save picture",default:!0},data:{type:"boolean",title:"data",default:!0},refresh:{type:"boolean",title:"refresh",default:!0},left:{type:"boolean",title:"left",default:!0},right:{type:"boolean",title:"right",default:!0},up:{type:"boolean",title:"up",default:!0},down:{type:"boolean",title:"down",default:!0},inc_acc:{type:"boolean",title:"incremental/accumulative",default:!0}}},location:{type:"string",default:"top"},show:{type:"boolean",title:"show",default:!0}}},renderer:{type:"string",title:"Renderer",enum:["Ra Segment Table","Line UChart","Bar UChart"]},aggregator:{additionalProperties:!1,type:"object",title:"Aggregator",properties:{name:{type:"string",title:"Aggregator",enum:["Count","Count If","Count Accumulative","Count Incremental-Accumulative","Sum Incremental-Accumulative","Count Unique Values","List Unique Values","List Unique Value (Format)","Performance","Sum","Integer Sum","Average","Minimum","Maximum","Running Totals","Sum over Sum","Count over Count","80% Upper Bound","80% Lower Bound","Sum as Fraction of Total","Sum as Fraction of Rows","Sum as Fraction of Columns","Count as Fraction of Total","Count as Fraction of Rows","Count as Fraction of Columns","Rating as Count in Rows","Rating as Count in Columns"]},vals:{additionalProperties:!1,type:"array",title:"Values",items:{type:"string"}},t_col_type:{type:"string",title:"Columns Total Type",enum:["sum","avg","min","max"]},t_row_type:{type:"string",title:"Row Total Type",enum:["sum","avg","min","max"]},num_format:Wo.template_num_format}},size:{additionalProperties:!1,type:"object",title:"Size",properties:{width:{type:"integer",default:500},height:{type:"integer",default:300}}},grid:template_grid,pivot:{type:"object",title:"View Config",properties:{colors:{type:"object",title:"Colors",properties:{data_color:{type:"string",title:"Data Color",default:"#000"},labels_color:{type:"string",title:"Labels Color",default:"#000"},frame_color:{type:"string",title:"Frame Color",default:"#000"},monochromatic:{type:"boolean",title:"Is Monochromatic",default:!1},mono_base_color:{type:"string",title:"Monochromatic Color",default:"#fff"},colors_array:{additionalProperties:!1,type:"array",title:"Graph Color",items:{type:"string"}}}},date_format:{type:"string",title:"Date/Time Format",enum:["YYYY-MM-DD HH:mm","MM-DD HH:mm","YYYY-MM-DD","YY-MM-DD","DD HH:mm","dddd HH:mm","HH:mm"]},sortCols:{type:"boolean",format:"hidden",title:"Sort Columns",default:!0},sortRows:{type:"boolean",format:"hidden",title:"Sort Rows",default:!0},full_j:{type:"boolean",format:"hidden",title:"Full Joint",default:!1},multi_line_max:{type:"integer",default:400,title:"Multi Line column Width"},fonts:{type:"object",title:"Fonts Config",properties:{data_font:(i=template_font,r=Vo.extend(!0,{},i),r.title="Data Font Style",r),titles_font:function(e){var t=Vo.extend(!0,{},e);return t.title="Titles Font Style",t}(template_font),totals_font:function(e){var t=Vo.extend(!0,{},e);return t.title="Totals Font Style",t}(Wo.template_font)}},table:{type:"object",title:"Table Config",properties:{columns:{type:"integer",title:"Num Of Columns"},rows:{type:"integer",title:"Num Of Rows"},position_on_last_row:{type:"boolean",title:"Position on last Row"},position_on_last_col:{type:"boolean",title:"Position on last Col"},hide_vert_scroll_bar:{type:"boolean",title:"Hide Vert Scroll Bar"},hide_hor_scroll_bar:{type:"boolean",title:"Hide Horiz Scroll Bar"},style:{type:"object",title:"Style",properties:{banded_rows:{type:"boolean",title:"Banded Rows",default:!0},banded_cols:{type:"boolean",title:"Banded Columns",default:!0}}},do_not_wrap:{type:"boolean",title:"Do Not Wrap Rows Data",default:!0}}},chart:{type:"object",title:"Chart Config",properties:{series:{type:"array",title:"Series",items:template_serie},title:template_title,title_left:template_title_left,title_right:template_title_right,toolbar:template_toolbar,popup:template_popup,data_table:template_data_table,xAxis:Vo.extend(!0,{},template_xAxis,{properties:{labels:{properties:{multi_line:{type:"boolean",title:"Multi Line Labels",default:!1},separator:{type:"string",title:"Separator",default:"-",enum:["-","/",",",".","|",":"]}}}}}),yAxis:template_yAxis}},aging:{type:"object",title:"Aging Setup",properties:{first_lim:{type:"number",title:"1st limit",default:5},second_lim:{type:"number",title:"2nd limit",default:10}}},performance:Wo.template_performance}},rowsToRepeat:{additionalProperties:!1,type:"array",title:"Rows To Repeat",items:{name:{type:"string"},index:{type:"integer"}}},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showColTotals:{type:"boolean",title:"Show Columns Total",default:!0},showRowTotals:{type:"boolean",title:"Show Rows Total",default:!0},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},values:{type:"object",title:"Table Cell View",default:{show:!0,font_size:12,font_style:"normal",font_weight:"normal",color:"#000"},properties:{show:{title:"Show",type:"boolean",default:"true"},font_size:{title:"Font Size",type:"integer",default:12},color:{type:"string",title:"Color",default:"#000"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]}}},serie:{type:"object",title:"Chart Series",properties:{name:{type:"string",default:""},type:{type:"string",default:"line",enum:["line","bar"]},barWidth:{type:"integer",title:"Bar Max Width",default:10},areaStyle:{type:"object",title:"Area Style",properties:{normal:{type:"object"},show:{type:"boolean",title:"Show Area",default:!0}}}}},sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}}},row:{additionalProperties:!1,type:"array",title:"Rows",items:{sites_list_out:{type:"array",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},item_name:{type:"string"},project:{type:"object",title:"Project",format:"projectcode",properties:{proj_id:{type:"string",default:""},proj_name:{type:"string",default:""},proj_code:{type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"scopecode",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}},rowDirect:{additionalProperties:!1,type:"array",title:"Rows Direct",items:{sites_list_out:{type:"array",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},item_name:{type:"string"},project:{type:"object",title:"Project",format:"projectcode",properties:{proj_id:{type:"string",default:""},proj_name:{type:"string",default:""},proj_code:{type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"scopecode",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}},sorters:{additionalProperties:!1,type:"array",title:"Sorters",items:{type:"object",title:"Sort",properties:{sort_field_name:{type:"string",title:"Sorting Column Name"},sort_list:{type:"array",title:"Sort List",items:{type:"string",title:"Item name"}},sort_type:{type:"string",title:"Sorting Type",enum:["desc","asc","ABC","CBA"]}}}},filters:{additionalProperties:!1,type:"array",title:"Filters",items:{type:"object",title:"Filter",properties:{filter_field_name:{type:"string",title:"Filter Column Name"},filter_list:{type:"array",title:"Filter List",items:{type:"string",title:"Item name"}}}}},sites_list_out:{type:"array",title:"Result sites list",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}}}},this.pivot={pivot_common:[],pivot_rows:[],pivot_cols:[],pivot_stack:[]};var c=[];c.push("site_code"),c.push("task_name"),c.push("task_type"),c.push("group_name"),c.push("scope_task_name"),c.push("Year"),c.push("Month"),c.push("Week"),c.push("Day"),c.push("Period(days)"),c.push("Aging(days)"),c.push("Aging(Working days)"),c.push("Aging(range)"),c.push("Aging(3 range)"),c.push("my_date"),c.push("value"),o.pivot.pivot_common=c,o.pivot.pivot_rows=[],o.pivot.pivot_cols=[],o.pivot.pivot_stack=[],this.GetHTTPData=function(){this.updateTable()},this.updateUI=function(){this.clearTreema(),this.loadTreema()},this.loadTreema=function(e){DEBUG&&console.log("PivotNode, loadTreema"),n.editor.editorMode&&((0,yt.b)(Vo("#treema_container"),this.getSchema(),this.getUserData()),e||this.loadPivotOptions())},this.loadPivotOptions=function(){var e=this;setTimeout((function(){DEBUG&&console.log("loadPivotOptions"),Vo("#common, #columns, #rows").sortable({connectWith:".connectedSortable"}).disableSelection();var t=Vo("#common"),a=Vo("#columns"),n=Vo("#rows"),o=function(e,t,a){e.forEach((function(e,a){Vo("<li id='"+e+"' class='pivot_treema_item'>"+e+"\x3c!--<i class='fa fa-filter filter_button'></i>--\x3e</li>").appendTo(t),t.sortable("refresh")}))};t.empty(),a.empty(),n.empty(),o(e.pivot.pivot_rows,n),o(e.pivot.pivot_cols,a),o(e.pivot.pivot_common,t);var i=function(o,i){e.pivot.pivot_common=t.sortable("toArray"),e.pivot.pivot_cols=a.sortable("toArray"),e.pivot.pivot_rows=n.sortable("toArray"),e.refreshTable()};t.off("sortstop"),a.off("sortstop"),n.off("sortstop"),t.on("sortstop",i),a.on("sortstop",i),n.on("sortstop",i)}),100)},this.setNewData=function(e){this.svgNodes.remove(),this.svgNodes=e;var t="t"+this.getAbsoluteX()+","+this.getAbsoluteY()+"...";this.svgNodes.transform(t),this.dx=this.getAbsoluteX(),this.dy=this.getAbsoluteY()},this.setNewDataU=function(e){o.svgNodes.hide(),o.svgNodes=e,o.applyTransformation(),o.repaint()};var u=new qo.PivotColInputPort;u.setConnectionDirection(0);var d=new qo.layout.locator.TopLocator;u.setName("input0"),this.addPort(u,d);var p=new qo.PivotRowInputPort;p.setConnectionDirection(3),p.setName("input2"),this.addPort(p),this.setDimension(this.width,this.height),this.layoutPorts(),this.updateTable=function(){var e;if(DEBUG&&console.log("Pivot  "+this.id+" updateTable"),this.updateTickets=0,e=o.userData.join_type?o.userData.join_type:"site_id",o.userData.sites_list_out=[],o.userData.col&&o.userData.col.length>0)o.userData.col.forEach((function(t,a){var n=[];n=t.sites_list_out.slice(),o.userData.row.forEach((function(t,a){var i=Go("SELECT *  FROM ? as first LEFT OUTER JOIN ? as second USING "+e,o.userData.pivot.full_j?[t.sites_list_out,n]:[n,t.sites_list_out]);n=i})),o.userData.sites_list_out.push.apply(o.userData.sites_list_out,n)}));else if(o.userData.row.length>0)if(1===o.userData.row.length)o.userData.sites_list_out=o.userData.row[0].sites_list_out.slice();else{var t=[];t=o.userData.row[0].sites_list_out.slice(),o.userData.row.forEach((function(a,n){var o=Go("SELECT *  FROM ? as first LEFT OUTER JOIN ? as second USING "+e,[t,a.sites_list_out]);t=o})),o.userData.sites_list_out.push.apply(o.userData.sites_list_out,t)}this.refreshTable()},this.refreshTable=function(){DEBUG&&console.log("Pivot  "+this.id+" refreshTable"),o.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height;var e=this.getPivotOptionsFunctions(o);(0,Ho.h9)(o.userData.sites_list_out,{renderers:e.renderers,rows:o.pivot.pivot_rows,cols:o.pivot.pivot_cols,vals:o.userData.aggregator.vals,t_col_type:o.userData.aggregator.t_col_type,t_row_type:o.userData.aggregator.t_row_type,aggregatorName:o.userData.aggregator.name,rendererName:o.userData.renderer,derivedAttributes:e.derivedAttributes,aggregators:e.aggregators,rendererOptions:{figure:o,paper:o.canvas.paper,stack:o.pivot.pivot_stack,update:!0},sorters:e.sorters,filter:e.filter})},this.drawFigureOnPaper=function(e){DEBUG&&console.log("Pivot Draw on Paper"),o.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height;var t=this.getPivotOptionsFunctions(o);(0,Ho.h9)(o.userData.sites_list_out,{renderers:t.renderers,rows:o.pivot.pivot_rows,cols:o.pivot.pivot_cols,vals:o.userData.aggregator.vals,t_col_type:o.userData.aggregator.t_col_type,t_row_type:o.userData.aggregator.t_row_type,aggregatorName:o.userData.aggregator.name,rendererName:o.userData.renderer,derivedAttributes:t.derivedAttributes,aggregators:t.aggregators,rendererOptions:{figure:o,paper:e,stack:o.pivot.pivot_stack},sorters:t.sorters,filter:t.filter})}},startAnimation:function(e){if(!this.getCanvas().silentMode){this.canvas.paper.setStart();var t=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading..."),a=this.userData.pivot.colors.monochromatic?this.userData.pivot.colors.mono_base_color:"#777";t.attr({fill:a,stroke:"none",opacity:1,"font-size":24,"font-weight":"bold"});var n=this.canvas.paper.setFinish();this.svgNodes.hide(),this.svgNodes=n,this.applyTransformation(),this.repaint()}},onPortValueChanged:function(e){var t;if(e.getValue().indexOf("ticket")>=0)void 0!==e.userData.realCount?this.updateTickets=this.updateTickets+e.userData.realCount:this.updateTickets=this.updateTickets+1,DEBUG&&console.log("Pivot "+this.id+" update ticket received: "+this.updateTickets+" "+e.connections.data[0].sourcePort.userData.item_name),Jo.drawProgress(this,10,!0);else{this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),DEBUG&&console.log("Pivot  "+this.id+" update data received: "+this.updateTickets+" "+e.connections.data[0].sourcePort.userData.item_name),Jo.drawProgress(this);var a=[],n=this;"input0"===e.name||"input1"===e.name?a=this.userData.col:"input2"===e.name&&(a=this.userData.row,t=!0),this.getInputPort(e.name).getConnections().data.forEach((function(o,i){if(e.getValue()===o.getSource().getParent().getId()){var r=o.getSource(),s=Qo.extend(!0,{},r.userData),l=r.getId();s.owner_id=l;var c=-1;a.forEach((function(e,o){e.owner_id===l&&(c=o)>-1&&(DEBUG&&console.log("Pivot  "+n.id+" updating column: "+r.getParent().NAME+": index - "+c),t&&s.sites_list_out.forEach((function(e,t){delete e.my_date,delete e.task_name,delete e.task_type})),a[c].values&&(s.values=a[c].values),a[c].serie&&(s.serie=a[c].serie),a[c]=s)})),-1===c&&(DEBUG&&console.log("Pivot inserting  "+n.id+" column: "+r.getParent().NAME+": "+c),a.push(s))}})),0===this.updateTickets&&this.updateTable()}},createSet:function(){this.canvas.paper.setStart();var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data..."),t=this.userData.pivot.colors.monochromatic?this.userData.pivot.colors.mono_base_color:"#777";return e.attr({fill:t,stroke:"none",opacity:.5,"font-size":24,"font-weight":"bold"}),this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight()).attr({stroke:"#888","stroke-dasharray":"-"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},applyAlpha:function(){},getTopLevelShapeElement:function(){return 0===this.svgNodes.length?this.shape:this.svgNodes[0]},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onTimer:function(){},onDragStart:function(e,t,a,n){return!this.dragIsLocked&&this._super(e,t,a,n)},getPersistentAttributes:function(){var e=this._super();return e.pivot={},e.pivot=this.pivot,e},setPersistentAttributes:function(e){e.ports.forEach((function(e){"SQLTopLocator"===e.locator&&(e.locator="draw2d.layout.locator.SQLTopLocator")})),this._super(e),this.userData=Vo.extend(!0,{},this.default_user_data,e.userData),this.pivot.pivot_common.forEach((function(t,a){e.pivot.pivot_common.indexOf(t)<0&&e.pivot.pivot_rows.indexOf(t)<0&&e.pivot.pivot_cols.indexOf(t)<0&&e.pivot.pivot_common.push(t)})),this.pivot=e.pivot,this.pivot.pivot_stack||(this.pivot.pivot_stack=[])},getPivotOptionsFunctions:function(e){var t={};t.aggregators=Jo.GetCustomAgg(e),t.renderers=Vo.extend(Vo.pivotUtilities_ra.ra_segment_table_renderers,Vo.pivotUtilities_ra.ra_table_renderers,Vo.pivotUtilities_ra.ra_renderers);var a=Vo.pivotUtilities.derivers;return Yo.updateLocale("us",{workingWeekdays:[1,2,3,4,5,6]}),t.derivedAttributes={Year:a.dateFormat("my_date","%y"),Month:a.dateFormat("my_date","%m"),Week:function(e){return Yo(e.my_date).toDate().getWeek().toString()},Day:a.dateFormat("my_date","%d"),"Period(days)":function(e){return e.period?e.period:null},"Aging(days)":function(e){return Yo().startOf("day").diff(Yo(e.my_date),"day")},"Aging(Working days)":function(e){return Yo().startOf("day").businessDiff(Yo(e.my_date))},"Aging(range)":function(e){var t=new Date,a=Math.floor((t-Yo(e.my_date).toDate())/864e5);return a<=7?"(1) 1w less":a>7&&a<=14?"(2) 1w to 2w":a>14&&a<=30?"(3) 2w to 1m":a>30&&a<=60?"(4) 1m to 2m":a>60&&a<=90?"(5) 2m to 3m":a>90?"(6) 3m more":void 0},"Aging(3 range)":function(t){var a=new Date,n=Math.floor((a-Yo(t.my_date).toDate())/864e5);return n<e.userData.pivot.aging.first_lim?"less "+e.userData.pivot.aging.first_lim+"d":n>=e.userData.pivot.aging.first_lim&&n<=e.userData.pivot.aging.second_lim?e.userData.pivot.aging.first_lim.toString()+"d to "+e.userData.pivot.aging.second_lim+"d":n>e.userData.pivot.aging.second_lim?"more "+e.userData.pivot.aging.second_lim+"d":void 0}},void 0!==e.userData.sorters&&0!==e.userData.sorters.length||(e.userData.sorters=[],e.userData.sorters.push({sort_field_name:"task_type",sort_list:["baseline","forecast","actual","difference","gap"]})),t.filter=function(t){var a=!0;return e.userData.filters.forEach((function(e){e.filter_list&&e.filter_list.length&&e.filter_field_name&&-1===e.filter_list.indexOf(t[e.filter_field_name])&&(a=!1)})),a},t.sorters={},e.userData.sorters.forEach((function(e,a){var n=e.sort_field_name;e.sort_type?"asc"===e.sort_type?t.sorters[n]=function(e,t){return e-t}:"desc"===e.sort_type?t.sorters[n]=function(e,t){return t-e}:"ABC"===e.sort_type?t.sorters[n]=function(e,t){e.localeCompare(t)}:"CBA"===e.sort_type&&(t.sorters[n]=function(e,t){t.localeCompare(e)}):t.sorters[n]=(0,Ho.lq)(e.sort_list)})),t}}),a("7486e8f4706fb078bf11"),a("ce777105db143ffb6980");var Xo=a("8a868d10b6533e768658"),Ko=a("a45670b3d8fb79ec0258"),Zo=a("aeb57e88bcb04c329061"),$o=a("1bf2fbdb051fe0c57024"),ei=a("6fe5e339b0f8a936ba8c"),ti=a("a7583c9a3ff76b2fdd52"),ai=a("8deafab7866a125bb9ca");function ni(e){return ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ni(e)}Xo.shape.fishbone.ra.RaDataNodeGroup=Xo.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaDataNodeGroup",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaDataNodeGroup</strong>}<br/><br/>",init:function(e,t,a){this._super(Ko.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var n=this,o=new Xo.DataInputPort,i=new Xo.layout.locator.TopLocator;o.setConnectionDirection(0),o.setName("dataInput"),this.addPort(o,i),this.createPort("output"),this.layoutPorts(),this.sites_list_in=[];var r=this.getUserData(),s=new Date;null===r&&this.attr({userData:{hidden:!1,autoWidth:!1,barHeight:30,start_date:new Date(s.getFullYear(),0,1).toLocaleDateString(),showInConnections:!0,showOutConnections:!0,showProgress:!0,valueFontSize:28,labelFontSize:18,size:{width:350,height:350},view:{colors:{data_color:"#6f6f6f",labels_color:"#6f6f6f",add_label_color:"#5d62c4",monochromatic:!1,mono_base_color:"#ffffff"}},col:[],tasks:[{name:"",baseline:{task_type:"baseline",show:!0,data_type:"real time",fixed_data:[],value:0},forecast:{task_type:"forecast",show:!0,data_type:"real time",fixed_data:[],value:0},actual:{task_type:"actual",data_type:"real time",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],value:0,fixed_data:[],label:"",text_color:"#838383",font_size:18,sites_list_out:[],info:["this Week","this Month","Yesterday","Today"]}}],index:0}}),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},start_date:{type:"string",title:"Start Date",format:"date",default:""},end_date:{type:"string",title:"End Date",format:"date",default:""},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:350},height:{type:"integer",default:350}}},view:{type:"object",title:"View Config",properties:{colors:{type:"object",title:"Colors",properties:{data_color:{type:"string",title:"Data Color",default:"#000"},labels_color:{type:"string",title:"Labels Color",default:"#000"},add_label_color:{type:"string",title:"Frame Color",default:"#000"},monochromatic:{type:"boolean",title:"Is Monochromatic",default:!1},mono_base_color:{type:"string",title:"Monochromatic Color",default:"#fff"}}}}},barHeight:{type:"integer",title:"Item Height",default:30},valueFontSize:{type:"integer",title:"Value label Font Size",default:28},labelFontSize:{type:"integer",title:"Name label Font Size",default:18},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showProgress:{type:"boolean",title:"Show Progress",default:!0},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}}},tasks:{type:"array",title:"Tasks",items:{type:"object",title:"Task",properties:{name:{type:"string",title:"Name",default:""},baseline:{type:"object",title:"Baseline",default:{task_type:"baseline",show:!0,data_type:"real time",fixed_data:[],value:0},properties:{task_type:{type:"string",title:"Task Type",default:"baseline",enum:["baseline"]},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},show:{type:"boolean",title:"Show",default:!1},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}},value:{type:"integer",title:"Current Value",default:0}}},forecast:{type:"object",title:"Forecast",default:{task_type:"forecast",show:!0,data_type:"real time",fixed_data:[],value:0},properties:{task_type:{type:"string",title:"Task Type",default:"forecast",enum:["forecast"]},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},show:{type:"boolean",title:"Show",default:!1},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}},value:{type:"integer",title:"Current Value",default:0}}},actual:{type:"object",title:"Actual",default:{task_type:"actual",data_type:"real time",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],value:0,fixed_data:[],label:"",text_color:"#838383",font_size:18,sites_list_out:[],info:["this Week","this Month","Yesterday","Today"]},properties:{show:{type:"boolean",title:"Show",default:!1},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},task_type:{type:"string",title:"Task Type",default:"actual"},count_type:{type:"string",title:"Count Type",default:"physical",enum:["physical","logical"]},config:Zo.template_config,multy_milestone:{type:"boolean",title:"Is Multi Milestone",default:!1},multy_milestones:{type:"array",title:"Milestones List",items:{type:"object",title:"Task",format:"taskcodeq",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}}},task:{type:"object",title:"Task",format:"taskcodeq",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},preset:{type:"string",default:"custom",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]},prop:{type:"string",default:"self"},sign:{type:"string",default:"not equal",enum:["","not equal","equal","more","less","less or equal","more or equal"]},value:{type:"string",format:"date",default:"empty"}},required:["logic","prop","sign","value"]}},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},isEditedLabel:{type:"boolean",format:"hidden",default:!1},label:{type:"string",default:""},font_size:{type:"integer",title:"Font Size",default:18},text_color:{type:"string",title:"Text_color",default:"#838383"},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},site_id:{type:"string",title:"Site ID"}}}},value:{type:"integer",title:"Current Value",default:0},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}}}},inputPort:{type:"string",title:"Input Port Name",default:""},outputPort:{type:"string",title:"Output Port Name",default:""}}}},index:{type:"integer",title:"Mobile Index",default:0}}},this.on("contextmenu",(function(e,t){Ko.contextMenu({selector:"body",events:{hide:function(){Ko.contextMenu("destroy")}},callback:Ko.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){n.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){n.toogleOutConn()}),10)}}),this),x:t.x,y:t.y,items:{toogleInCon:n.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"},toogleOutCon:n.userData.showOutConnections?{name:"Hide Out Connections"}:{name:"Show Out Connections"}}})})),this.getRealCount=function(){var e=0;return this.userData.tasks.forEach((function(t,a){t.actual&&t.actual.show&&e++,t.forecast&&t.forecast.show&&e++,t.baseline&&t.baseline.show&&e++})),e},this.GetHTTPData=function(){var e=this,t=0,a=function(){t++,o===t&&n.updateTable()},o=this.getRealCount();this.userData.tasks.forEach((function(t,o){var i=t;if(i.ID||(i.ID=Xo.util.UUID.create()),i.actual&&i.actual.show)e.getTypeData(i.actual,i.actual,i.ID,a);else{var r=-1;n.userData.col.forEach((function(e,t){e.task_type===i.actual.task_type&&(r=t)})),r>-1&&n.userData.col.splice(r,1)}i.baseline&&i.baseline.show?e.getTypeData(i.baseline,i.actual,i.ID,a):(r=-1,n.userData.col.forEach((function(e,t){e.task_type===i.baseline.task_type&&(r=t)})),r>-1&&n.userData.col.splice(r,1)),i.forecast&&i.forecast.show?e.getTypeData(i.forecast,i.actual,i.ID,a):(r=-1,n.userData.col.forEach((function(e,t){e.task_type===i.forecast.task_type&&(r=t)})),r>-1&&n.userData.col.splice(r,1))}))},this.getTypeData=function(e,t,a,o){if("real time"===e.data_type||void 0===e.data_type){var i,r,s=ei.context+"/data/MLPerSite",l=ei.context+"/data/MLPerSiteMulti_10",c=ei.context+"/data/MLPerSiteMultiLogic_10";if(t.task&&""!=t.task.scope_task_id&&null!=t.task.scope_task_id||t.multy_milestones[0]&&""!=t.multy_milestones[0].scope_task_id&&null!=t.multy_milestones[0].scope_task_id){var u;if(void 0===t.count_type||"physical"===t.count_type)if(t.multy_milestone){var d=void 0!==t.multy_milestones[0]?t.multy_milestones[0].scope_task_id:"",p=void 0!==t.multy_milestones[1]?t.multy_milestones[1].scope_task_id:"",h=void 0!==t.multy_milestones[2]?t.multy_milestones[2].scope_task_id:"",f=void 0!==t.multy_milestones[3]?t.multy_milestones[3].scope_task_id:"",m=void 0!==t.multy_milestones[4]?t.multy_milestones[4].scope_task_id:"",g=void 0!==t.multy_milestones[5]?t.multy_milestones[5].scope_task_id:"",y=void 0!==t.multy_milestones[6]?t.multy_milestones[6].scope_task_id:"",_=void 0!==t.multy_milestones[7]?t.multy_milestones[7].scope_task_id:"",b=void 0!==t.multy_milestones[8]?t.multy_milestones[8].scope_task_id:"",v=void 0!==t.multy_milestones[9]?t.multy_milestones[9].scope_task_id:"";u=""!==e.label?e.label:t.multy_milestones[0].scope_task_name,e.config?(i=e.config.field_name?e.config.field_name:"",r=e.config.array?JSON.stringify(e.config.array):""):(i="",r="");var w=l+"?&val1="+d+"&val2="+p+"&val3="+h+"&val4="+f+"&val5="+m+"&val6="+g+"&val7="+y+"&val8="+_+"&val9="+b+"&val10="+v+"&task_type="+e.task_type+"&col_name="+u+"&config="+i+"&array="+r}else u=""!==e.label?e.label:t.task.scope_task_name,w=s+"?&task_id="+t.task.scope_task_id+"&task_type="+e.task_type+"&col_name="+u;else"logical"===t.count_type&&t.multy_milestone&&(d=void 0!==t.multy_milestones[0]?t.multy_milestones[0].scope_task_id:"",p=void 0!==t.multy_milestones[1]?t.multy_milestones[1].scope_task_id:"",h=void 0!==t.multy_milestones[2]?t.multy_milestones[2].scope_task_id:"",f=void 0!==t.multy_milestones[3]?t.multy_milestones[3].scope_task_id:"",m=void 0!==t.multy_milestones[4]?t.multy_milestones[4].scope_task_id:"",g=void 0!==t.multy_milestones[5]?t.multy_milestones[5].scope_task_id:"",y=void 0!==t.multy_milestones[6]?t.multy_milestones[6].scope_task_id:"",_=void 0!==t.multy_milestones[7]?t.multy_milestones[7].scope_task_id:"",b=void 0!==t.multy_milestones[8]?t.multy_milestones[8].scope_task_id:"",v=void 0!==t.multy_milestones[9]?t.multy_milestones[9].scope_task_id:"",u=""!==e.label?e.label:t.multy_milestones[0].scope_task_name,e.config?(i=e.config.field_name?e.config.field_name:"",r=e.config.array?JSON.stringify(e.config.array):""):(i="",r=""),w=c+"?&val1="+d+"&val2="+p+"&val3="+h+"&val4="+f+"&val5="+m+"&val6="+g+"&val7="+y+"&val8="+_+"&val9="+b+"&val10="+v+"&task_type="+e.task_type+"&col_name="+u+"&config="+i+"&array="+r);var x=JSON.stringify(n.sites_list_in);this["xhr"+e.task_type+a]&&4!==this["xhr"+e.task_type+a].readyState&&this["xhr"+e.task_type+a].abort(),this["xhr"+e.task_type+a]=Ko.ajax({url:w,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:x,success:function(t){e.total=t.length,t.length>0&&t.forEach((function(t,a){null!=t.my_date&&(t.my_date=ti(t.my_date).toDate()),t.task_name=u,t.task_type=e.task_type}));var i,r,s,l=(i=t,s=e.conditions,r=(new $o).from(i).where((function(e,t){var a,n=!0;return s.forEach((function(t,o){if("custom"!==t.preset&&void 0!==t.preset||(a="empty"==t.value?null:new Date(t.value),"and"==t.logic||0==o?"not equal"==t.sign?n=n&&e.my_date!=a:"equal"==t.sign?n=n&&e.my_date==a:"more"==t.sign?n=n&&e.my_date>a:"less"==t.sign?n=n&&e.my_date<a:"less or equal"==t.sign?n=n&&e.my_date<=a:"more or equal"==t.sign&&(n=n&&e.my_date>=a):"or"==t.logic&&("not equal"==t.sign?n=n||e.my_date!=a:"equal"==t.sign?n=n||e.my_date==a:"more"==t.sign?n=n&&e.my_date>a:"less"==t.sign?n=n&&e.my_date<a:"less or equal"==t.sign?n=n&&e.my_date<=a:"more or equal"==t.sign&&(n=n&&e.my_date>=a))),"not Empty"===t.preset&&(a="empty"==t.value?null:new Date(t.value),"and"==t.logic||0==o?n=n&&e.my_date!=a:"or"==t.logic&&(n=n||e.my_date!=a)),"Empty"===t.preset)a="empty"==t.value?null:new Date(t.value),"and"==t.logic||0==o?n=n&&e.my_date==a:"or"==t.logic&&(n=n||e.my_date==a);else if("EOM"===t.preset)if(null!=e.my_date){var i=new Date,r=i.getFullYear(),s=e.my_date.getFullYear(),l=i.getMonth(),c=e.my_date.getMonth();"and"==t.logic||0==o?n=s<r?n&&!0:s===r?n&&c<=l:n&&!1:"or"==t.logic&&(n=s<r?n||!0:s===r?n||c<=l:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("this Year"===t.preset)if(null!=e.my_date){var u=(new Date).getFullYear(),d=e.my_date.getFullYear();"and"==t.logic||0==o?n=d===u?n&&!0:n&&!1:"or"==t.logic&&(n=d===u?n||!0:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("last Year"===t.preset)if(null!=e.my_date){var p=(new Date).getFullYear()-1,h=e.my_date.getFullYear();"and"==t.logic||0==o?n=h===p?n&&!0:n&&!1:"or"==t.logic&&(n=h===p?n||!0:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("next Year"===t.preset)if(null!=e.my_date){var f=(new Date).getFullYear()+1,m=e.my_date.getFullYear();"and"==t.logic||0==o?n=m===f?n&&!0:n&&!1:"or"==t.logic&&(n=m===f?n||!0:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("this Month"===t.preset)if(null!=e.my_date){var g=new Date,y=g.getFullYear(),_=e.my_date.getFullYear(),b=g.getMonth(),v=e.my_date.getMonth();"and"==t.logic||0==o?n=_===y?n&&v===b:n&&!1:"or"==t.logic&&(n=_===y?n||v===b:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("next Month"===t.preset)if(null!=e.my_date){var w=new Date,x=w.getFullYear(),k=e.my_date.getFullYear(),D=w.getMonth()+1,S=e.my_date.getMonth();12===D&&(D=0,x+=1),"and"==t.logic||0==o?n=k===x?n&&S===D:n&&!1:"or"==t.logic&&(n=k===x?n||S===D:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("last Month"===t.preset)if(null!=e.my_date){var C=new Date,T=(x=C.getFullYear(),k=e.my_date.getFullYear(),e.my_date.getMonth());0===(D=C.getMonth())&&(D=11,x-=1),"and"==t.logic||0==o?n=k===x?n&&T===D:n&&!1:"or"==t.logic&&(n=k===x?n||T===D:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("this Week"===t.preset)if(null!=e.my_date){var A=new Date,P=A.getFullYear(),E=e.my_date.getFullYear(),I=A.getWeek(),N=e.my_date.getWeek();"and"==t.logic||0==o?n=E===P?n&&N===I:n&&!1:"or"==t.logic&&(n=E===P?n||N===I:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("last Week"===t.preset)if(null!=e.my_date){var M=new Date,O=(x=M.getFullYear(),k=e.my_date.getFullYear(),D=M.getWeek(),T=e.my_date.getWeek(),new Date(x-1,11,31,0,0,0,0).getWeek());1===D?(D=O,x-=1):D-=1,"and"==t.logic||0==o?n=k===x?n&&T===D:n&&!1:"or"==t.logic&&(n=k===x?n||T===D:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("next Week"===t.preset)if(null!=e.my_date){var j=new Date;x=j.getFullYear(),k=e.my_date.getFullYear(),D=j.getWeek(),T=e.my_date.getWeek(),D===new Date(x,11,31,0,0,0,0).getWeek()?(D=1,x+=1):D+=1,"and"==t.logic||0==o?n=k===x?n&&T===D:n&&!1:"or"==t.logic&&(n=k===x?n||T===D:n||!1)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("Today"===t.preset)if(null!=e.my_date){var R=new Date,L=e.my_date;"and"==t.logic||0==o?n=n&&R.isSameDateAs(L):"or"==t.logic&&(n=n||R.isSameDateAs(L))}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("Yesterday"===t.preset)if(null!=e.my_date){var F=new Date,U=new Date(F.getFullYear(),F.getMonth(),F.getDate(),8,0,0,0);U.setDate(F.getDate()-1);var B=e.my_date;"and"==t.logic||0==o?n=n&&U.isSameDateAs(B):"or"==t.logic&&(n=n||U.isSameDateAs(B))}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("Tomorrow"===t.preset)if(null!=e.my_date){var z=new Date,H=new Date(z.getFullYear(),z.getMonth(),z.getDate(),8,0,0,0);H.setDate(z.getDate()+1);var q=e.my_date;"and"==t.logic||0==o?n=n&&H.isSameDateAs(q):"or"==t.logic&&(n=n||H.isSameDateAs(q))}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("last 30 days"===t.preset)if(null!=e.my_date){var V=new Date;(G=new Date(V.getFullYear(),V.getMonth(),V.getDate(),8,0,0,0)).setDate(V.getDate()-30);var W=e.my_date;"and"==t.logic||0==o?n=n&&G<=W:"or"==t.logic&&(n=n||G<=W)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("previous 30 days"===t.preset)if(null!=e.my_date){var G,J=new Date;(G=new Date(J.getFullYear(),J.getMonth(),J.getDate(),8,0,0,0)).setDate(J.getDate()-30);var Q=new Date(J.getFullYear(),J.getMonth(),J.getDate(),8,0,0,0);Q.setDate(J.getDate()-60);var Y=e.my_date;"and"==t.logic||0==o?n=n&&G>Y&&Q<=Y:"or"==t.logic&&(n=n||G>Y&&Q<=Y)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("last 7 days"===t.preset)if(null!=e.my_date){var X=new Date;(Z=new Date(X.getFullYear(),X.getMonth(),X.getDate(),8,0,0,0)).setDate(X.getDate()-7);var K=e.my_date;"and"==t.logic||0==o?n=n&&Z<=K:"or"==t.logic&&(n=n||Z<=K)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1);else if("previous 7 days"===t.preset)if(null!=e.my_date){var Z,$=new Date;(Z=new Date($.getFullYear(),$.getMonth(),$.getDate(),8,0,0,0)).setDate($.getDate()-7);var ee=new Date($.getFullYear(),$.getMonth(),$.getDate(),8,0,0,0);ee.setDate($.getDate()-14);var te=e.my_date;"and"==t.logic||0==o?n=n&&Z>te&&ee<=te:"or"==t.logic&&(n=n||Z>te&&ee<=te)}else"and"==t.logic||0==o?n=n&&!1:"or"==t.logic&&(n=n||!1)})),n})).select(),r);e.value=l.length,e.sites_list_out=l;var c=n.getPort("output0");c.setId(a),c.setUserData({project:n.project,scope:n.scope,item_name:u,task_type:e.task_type,sites_list_out:l}),n.getOutputPort(0).getConnections().each(Ko.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor(n.getColor())}),this)),o()}})}}else if("fixed month"===e.data_type){if(e.fixed_data.length>0){u=""!==e.label&&void 0!==e.label?e.label:t.multy_milestone?t.multy_milestones[0].scope_task_name:t.task.scope_task_name;var k=[];e.fixed_data.forEach((function(t,a){new Date(t.year,Zo.months.indexOf(t.month),1,8,0,0,0);var n=ai.daysInMonth(Zo.months.indexOf(t.month)+1,t.year),o=Math.floor(t.value/n),i=[];if(o>=1){for(var r=1;r<=n;r++)i.push({value:o});for(var s=t.value-o*n,l=0;l<s;l++)i[l].value=i[l].value+1}else{var c=Math.floor(n/t.value),d=0,p=1;for(r=1;r<=n;r++)p>c?(p=1,d++,i.push({value:1})):(p++,i.push({value:0}));for(s=t.value-d,l=0;l<s;l++)0===i[l].value?i[l].value=i[l].value+1:s++}i.forEach((function(a,n){for(var o=0;o<a.value;o++)k.push({my_date:new Date(t.year,Zo.months.indexOf(t.month),n+1,8,0,0,0),site_code:"dummy",site_id:"dummy",task_name:u,task_type:e.task_type})}))})),e.value=k.length,e.sites_list_out=k,n.getPort("output0").setUserData({project:n.project,scope:n.scope,item_name:u,task_type:e.task_type,sites_list_out:k}),n.getOutputPort(0).getConnections().each(Ko.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor(n.getColor())}),this)),o()}}else"fixed week"===e.data_type&&e.fixed_data.length>0&&(u=""!==e.label?e.label:e.multy_milestone?e.multy_milestones[0].scope_task_name:e.task.scope_task_name,k=[],e.fixed_data.forEach((function(t,a){ti(t.year+"-"+t.week,"YYYY-W WW");var n=Math.floor(t.value/7),o=[];if(n>=1){for(var i=1;i<=7;i++)o.push({value:n});for(var r=t.value-7*n,s=0;s<r;s++)o[s].value=o[s].value+1}else{var l=Math.floor(7/t.value),c=0,d=1;for(i=1;i<=7;i++)d>l?(d=1,c++,o.push({value:1})):(d++,o.push({value:0}));for(r=t.value-c,s=0;s<r;s++)0===o[s].value?o[s].value=o[s].value+1:r++}o.forEach((function(a,n){for(var o=0;o<a.value;o++){var i=n+1,r=t.year+ai.zeroPadl(t.week)+i;k.push({my_date:ti(r,"YYYYWWE").toDate(),site_code:"dummy",site_id:"dummy",task_name:u,task_type:e.task_type})}}))})),e.value=k.length,e.sites_list_out=k,n.getPort("output0").setUserData({project:n.project,scope:n.scope,item_name:u,task_type:e.task_type,sites_list_out:k}),n.getOutputPort(0).getConnections().each(Ko.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor(n.getColor())}),this)),o())},this.updateTable=function(){n.initDataUpdate()},this.initDataUpdate=function(){(0,wo.w)(this)},this.setNewData=function(e){n.svgNodes.remove(),n.svgNodes=e,n.applyTransformation(),n.repaint(),n.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height},this.startAnimation=function(e){this.canvas.paper.setStart();var t=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading..."),a=this.userData.view.colors.monochromatic?this.userData.view.colors.mono_base_color:"#777";t.attr({fill:a,stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),function(e,t){var a,n,o,i=Raphael.animation((a={opacity:0},o=1,(n=function(e){var t=function(e){if("object"!=ni(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=ni(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ni(t)?t:t+""}(n="opacity"))in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o,a),1e3);e.animate(i.repeat(t))}(t,e);var n=this.canvas.paper.setFinish();this.setNewData(n)},this.updateSearchCol=function(e,t,a,n){var o;a.project=e,a.scope=t,n&&(a.sop=n),o=a.sop?ai.makeTaskSearchTreemaNodeClass(ei.context+"/data/getAllSOPTasks?scope_id="+a.sop.scope_id+"&proj_id="+e.proj_id,a,!1):ai.makeTaskSearchTreemaNodeClass(ei.context+"/data/getAllTasks?scope_id="+t.scope_id+"&proj_id="+e.proj_id,a,!1),TreemaNode.setNodeSubclass("taskcodeq",o)}},applyAlpha:function(){},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.startAnimation(1e3),this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(Ko.proxy((function(e,a){var n=a.getTarget(),o=t.getRealCount();n.userData||(n.userData={}),n.userData.realCount=o,n.setValue("ticket"),a.setColor("#dfdfdf")}),this))}));else if("dataInput"==e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=a.getUserData().sites_list_out,this.updateSearchCol(a.getUserData().project,a.getUserData().scope,this,a.getUserData().sop),this.GetHTTPData(),this.updateUI()}},createSet:function(){this.canvas.paper.setStart(),this.userData.view||(this.userData.view={colors:{data_color:"#6f6f6f",labels_color:"#6f6f6f",add_label_color:"#5d62c4",monochromatic:!1,mono_base_color:"#ffffff"}});var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data..."),t=this.userData.view.colors.monochromatic?this.userData.view.colors.mono_base_color:"#777";return e.attr({fill:t,stroke:"none",opacity:.5,"font-size":24,"font-weight":"bold"}),this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight()).attr({stroke:"#888","stroke-dasharray":"-"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},getPersistentAttributes:function(){var e=this._super();return e.labels=[],this.children.each((function(t,a){var n=a.figure.getPersistentAttributes();n.locator=a.locator.NAME,e.labels.push(n)})),e},setPersistentAttributes:function(e){e.ports.forEach((function(e){"XYLogPortLocator"===e.locator&&(e.locator="draw2d.layout.locator.XYLogPortLocator")})),this._super(e)}});var oi=a("8a868d10b6533e768658"),ii=a("a45670b3d8fb79ec0258"),ri=a("aeb57e88bcb04c329061"),si=a("6fe5e339b0f8a936ba8c"),li=a("1bf2fbdb051fe0c57024"),ci=a("a7583c9a3ff76b2fdd52"),ui=a("8deafab7866a125bb9ca");function di(e){return di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},di(e)}oi.shape.fishbone.ra.RaDataNodeGroupP=oi.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaDataNodeGroupP",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaDataNodeGroupP</strong>}<br/><br/>",init:function(e,t,a){this._super(ii.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var n=this,o=new oi.DataInputPort,i=new oi.layout.locator.TopLocator;o.setConnectionDirection(0),o.setName("dataInput"),this.addPort(o,i),this.layoutPorts(),this.sites_list_in=[];var r=this.getUserData(),s=new Date;null===r&&this.attr({userData:{hidden:!1,autoWidth:!1,barHeight:30,start_date:new Date(s.getFullYear(),0,1).toLocaleDateString(),showInConnections:!0,showOutConnections:!0,showProgress:!0,size:{width:350,height:350},view:{colors:{monochromatic:!1,mono_base_color:"#ffffff"}},values:{show:!0,font_size:18,color:"#000",font_style:"normal",font_weight:"normal"},totals:{show:!0,font_size:16,color:"#000",font_style:"normal",font_weight:"normal"},percents:{show:!0,font_size:14,color:"#000b7e",font_style:"normal",font_weight:"normal"},labels:{show:!0,font_size:14,color:"#000",font_style:"normal",font_weight:"normal"},col:[],tasks:[{name:"",baseline:{task_type:"baseline",show:!0,data_type:"real time",fixed_data:[],value:0},forecast:{task_type:"forecast",show:!0,data_type:"real time",fixed_data:[],value:0},actual:{task_type:"actual",data_type:"real time",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],value:0,fixed_data:[],label:"",sites_list_out:[],info:["this Week","this Month","Yesterday","Today"]}}],index:0}}),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},start_date:{type:"string",title:"Start Date",format:"date",default:""},end_date:{type:"string",title:"End Date",format:"date",default:""},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:350},height:{type:"integer",default:350}}},view:{type:"object",title:"View Config",properties:{colors:{type:"object",title:"Colors",properties:{monochromatic:{type:"boolean",title:"Is Monochromatic",default:!1},mono_base_color:{type:"string",title:"Monochromatic Color",default:"#fff"}}}}},barHeight:{type:"integer",title:"Item Height",default:30},values:{type:"object",title:"Values",properties:{show:{title:"Show",type:"boolean",default:"true"},font_size:{title:"Font Size",type:"integer",default:18},color:{type:"string",title:"Color",default:"#000"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]}}},totals:{type:"object",title:"Totals",properties:{show:{title:"Show",type:"boolean",default:"true"},font_size:{title:"Font Size",type:"integer",default:16},color:{type:"string",title:"Color",default:"#000"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]}}},percents:{type:"object",title:"Percents",properties:{show:{title:"Show",type:"boolean",default:"true"},font_size:{title:"Font Size",type:"integer",default:14},color:{type:"string",title:"Color",default:"#000b7e"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]}}},labels:{type:"object",title:"Labels",properties:{show:{title:"Show",type:"boolean",default:"true"},font_size:{title:"Font Size",type:"integer",default:14},color:{type:"string",title:"Color",default:"#000000"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]}}},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showProgress:{type:"boolean",title:"Show Progress",default:!0},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}}},tasks:{type:"array",title:"Tasks",items:{type:"object",title:"Task",properties:{name:{type:"string",title:"Name",default:""},baseline:{type:"object",title:"Baseline",default:{task_type:"baseline",show:!0,data_type:"real time",fixed_data:[],value:0},properties:{task_type:{type:"string",title:"Task Type",default:"baseline",enum:["baseline"]},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},outputPort:{type:"string",title:"Output Port Index",default:""},show:{type:"boolean",title:"Show",default:!1},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}},value:{type:"integer",title:"Current Value",default:0}}},forecast:{type:"object",title:"Forecast",default:{task_type:"forecast",show:!0,data_type:"real time",fixed_data:[],value:0},properties:{task_type:{type:"string",title:"Task Type",default:"forecast",enum:["forecast"]},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},outputPort:{type:"string",title:"Output Port Index",default:""},show:{type:"boolean",title:"Show",default:!1},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}},value:{type:"integer",title:"Current Value",default:0}}},actual:{type:"object",title:"Actual",default:{task_type:"actual",data_type:"real time",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],value:0,fixed_data:[],label:"",text_color:"#838383",font_size:18,sites_list_out:[],info:["this Week","this Month","Yesterday","Today"]},properties:{show:{type:"boolean",title:"Show",default:!1},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},task_type:{type:"string",title:"Task Type",default:"actual"},count_type:{type:"string",title:"Count Type",default:"physical",enum:["physical","logical"]},outputPort:{type:"string",title:"Output Port Index",default:""},config:ri.template_config,multy_milestone:{type:"boolean",title:"Is Multi Milestone",default:!1},multy_milestones:{type:"array",title:"Milestones List",items:{type:"object",title:"Task",format:"taskcodeq",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}}},task:{type:"object",title:"Task",format:"taskcodeq",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},preset:{type:"string",default:"custom",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]},prop:{type:"string",default:"self"},sign:{type:"string",default:"not equal",enum:["","not equal","equal","more","less","less or equal","more or equal"]},value:{type:"string",format:"date",default:"empty"}},required:["logic","prop","sign","value"]}},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},isEditedLabel:{type:"boolean",format:"hidden",default:!1},label:{type:"string",default:""},font_size:{type:"integer",title:"Font Size",default:18},text_color:{type:"string",title:"Text_color",default:"#838383"},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},site_id:{type:"string",title:"Site ID"}}}},value:{type:"integer",title:"Current Value",default:0},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}}}},outputPort:{type:"string",title:"Output Port Index",default:""}}}},index:{type:"integer",title:"Mobile Index",default:0}}},this.on("contextmenu",(function(e,t){ii.contextMenu({selector:"body",events:{hide:function(){ii.contextMenu("destroy")}},callback:ii.proxy((function(e,t){switch(e){case"addTask":setTimeout((function(){n.userData.tasks.push({name:"",actual:{task_type:"actual",data_type:"real time",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],value:0,fixed_data:[],label:"",sites_list_out:[],info:["this Week","this Month","Yesterday","Today"]}})}),10);break;case"toogleInCon":setTimeout((function(){n.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){n.toogleOutConn()}),10);break;case"syncByName":setTimeout((function(){n.syncByName()}),10);break;case"syncByCode":setTimeout((function(){n.syncByCode()}),10);break;case"fixData":setTimeout((function(){n.fixData()}),10)}}),this),x:t.x,y:t.y,items:{addTask:{name:"Add Task"},sep1:"---------",toogleInCon:n.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"},toogleOutCon:n.userData.showOutConnections?{name:"Hide Out Connections"}:{name:"Show Out Connections"},sep2:"---------",fixData:{name:"Fix Data"},sep3:"---------",syncByName:{name:"Sync By Name"},syncByCode:{name:"Sync By Code"}}})})),this.fixData=function(){n.userData.tasks.length&&n.userData.tasks.forEach((function(e,t){e.actual.outputPort=t.toString(),e.ID&&(e.ID=null)}))},this.syncByName=function(){},this.syncByCode=function(){var e=si.context+"/data/getAllTasks?scope_id="+n.scope.scope_id+"&proj_id="+n.project.proj_id,t="";ii.ajax({url:e,datatype:"json",type:"GET",success:function(e){!function(e){if(e.length)for(var a=0;a<n.userData.tasks.length;a++){if(n.userData.tasks[a].actual.multy_milestone)for(var o=0;o<n.userData.tasks[a].actual.multy_milestones.length;o++){var i;(i=(new li).from(e).where((function(e,t){return e.scope_task_code.toLowerCase()==n.userData.tasks[a].actual.multy_milestones[o].scope_task_code.toLowerCase()})).select()).length?(n.userData.tasks[a].actual.multy_milestones[o].scope_task_code=i[0].scope_task_code,n.userData.tasks[a].actual.multy_milestones[o].scope_task_name=i[0].scope_task_name,n.userData.tasks[a].actual.multy_milestones[o].scope_task_id=i[0].scope_task_id,t=t+n.userData.tasks[a].actual.multy_milestones[o].scope_task_code+" ("+n.userData.tasks[a].actual.multy_milestones[o].scope_task_name+")  - success!!!\n"):t=t+n.userData.tasks[a].actual.multy_milestones[o].scope_task_code+" ("+n.userData.tasks[a].actual.multy_milestones[o].scope_task_name+")  - fail!!!\n"}else(i=(new li).from(e).where((function(e,t){return e.scope_task_code.toLowerCase()==n.userData.tasks[a].actual.task.scope_task_code.toLowerCase()})).select()).length?(n.userData.tasks[a].actual.task.scope_task_code=i[0].scope_task_code,n.userData.tasks[a].actual.task.scope_task_name=i[0].scope_task_name,n.userData.tasks[a].actual.task.scope_task_id=i[0].scope_task_id,t=t+n.userData.tasks[a].actual.task.scope_task_code+" ("+n.userData.tasks[a].actual.task.scope_task_name+")  - success!!!\n"):t=t+n.userData.tasks[a].actual.task.scope_task_code+" ("+n.userData.tasks[a].actual.task.scope_task_name+")  - fail!!!\n";alert(t),t=""}}(e)}})},this.getRealCountInternal=function(){var e=0;return this.userData.tasks.forEach((function(t,a){t.actual&&t.actual.show&&e++,t.forecast&&t.forecast.show&&e++,t.baseline&&t.baseline.show&&e++})),e},this.getRealCount=function(){return 1},this.GetHTTPData=function(){var e=this,t=0,a=function(){t++,o===t&&n.updateTable()},o=this.getRealCountInternal();this.userData.tasks.forEach((function(t,o){var i=t;if(i.ID||(i.ID=oi.util.UUID.create()),i.actual&&i.actual.show)e.getTypeData(o,i.actual,i.actual,i.ID,a);else{var r=-1;n.userData.col.forEach((function(e,t){e.task_type===i.actual.task_type&&(r=t)})),r>-1&&n.userData.col.splice(r,1)}i.baseline&&i.baseline.show?e.getTypeData(i.baseline,i.actual,i.ID,a):(r=-1,n.userData.col.forEach((function(e,t){e.task_type===i.baseline.task_type&&(r=t)})),r>-1&&n.userData.col.splice(r,1)),i.forecast&&i.forecast.show?e.getTypeData(i.forecast,i.actual,i.ID,a):(r=-1,n.userData.col.forEach((function(e,t){e.task_type===i.forecast.task_type&&(r=t)})),r>-1&&n.userData.col.splice(r,1))}))},this.updatePort=function(e,t){if(e.outputPort&&""!==e.outputPort)if(n.getOutputPort("dataOutput"+e.outputPort))a=n.getOutputPort("dataOutput"+e.outputPort),o=new oi.layout.locator.XYLogPortLocator(n.userData.size.width,n.userData.barHeight/2+n.userData.barHeight*t),a.setLocator(o);else{var a=new oi.OutputPort,o=new oi.layout.locator.XYLogPortLocator(n.userData.size.width,n.userData.barHeight/2+n.userData.barHeight*t);a.setConnectionDirection(1),a.setName("dataOutput"+e.outputPort),n.addPort(a,o)}else{a=new oi.OutputPort,o=new oi.layout.locator.XYLogPortLocator(n.userData.size.width,n.userData.barHeight/2+n.userData.barHeight*t);a.setConnectionDirection(1),a.setName("dataOutput"+t),e.outputPort=t.toString(),n.addPort(a,o)}},this.getTypeData=function(e,t,a,o,i){if("real time"===t.data_type||void 0===t.data_type){var r,s,l=si.context+"/data/MLPerSite",c=si.context+"/data/MLPerSiteMulti_10",u=si.context+"/data/MLPerSiteMultiLogic_10";if(a.task&&""!=a.task.scope_task_id&&null!=a.task.scope_task_id||a.multy_milestones[0]&&""!=a.multy_milestones[0].scope_task_id&&null!=a.multy_milestones[0].scope_task_id){var d;if(void 0===a.count_type||"physical"===a.count_type)if(a.multy_milestone){var p=void 0!==a.multy_milestones[0]?a.multy_milestones[0].scope_task_id:"",h=void 0!==a.multy_milestones[1]?a.multy_milestones[1].scope_task_id:"",f=void 0!==a.multy_milestones[2]?a.multy_milestones[2].scope_task_id:"",m=void 0!==a.multy_milestones[3]?a.multy_milestones[3].scope_task_id:"",g=void 0!==a.multy_milestones[4]?a.multy_milestones[4].scope_task_id:"",y=void 0!==a.multy_milestones[5]?a.multy_milestones[5].scope_task_id:"",_=void 0!==a.multy_milestones[6]?a.multy_milestones[6].scope_task_id:"",b=void 0!==a.multy_milestones[7]?a.multy_milestones[7].scope_task_id:"",v=void 0!==a.multy_milestones[8]?a.multy_milestones[8].scope_task_id:"",w=void 0!==a.multy_milestones[9]?a.multy_milestones[9].scope_task_id:"";""!==t.label?d=t.label:(d=a.multy_milestones[0].scope_task_name,""===t.label&&(t.label=a.multy_milestones[0].scope_task_name)),t.config?(r=t.config.field_name?t.config.field_name:"",s=t.config.array?JSON.stringify(t.config.array):""):(r="",s="");var x=c+"?&val1="+p+"&val2="+h+"&val3="+f+"&val4="+m+"&val5="+g+"&val6="+y+"&val7="+_+"&val8="+b+"&val9="+v+"&val10="+w+"&task_type="+t.task_type+"&col_name="+d+"&config="+r+"&array="+s}else""!==t.label?d=t.label:(d=a.task.scope_task_name,""===t.label&&(t.label=a.task.scope_task_name)),x=l+"?&task_id="+a.task.scope_task_id+"&task_type="+t.task_type+"&col_name="+d;else"logical"===a.count_type&&a.multy_milestone&&(p=void 0!==a.multy_milestones[0]?a.multy_milestones[0].scope_task_id:"",h=void 0!==a.multy_milestones[1]?a.multy_milestones[1].scope_task_id:"",f=void 0!==a.multy_milestones[2]?a.multy_milestones[2].scope_task_id:"",m=void 0!==a.multy_milestones[3]?a.multy_milestones[3].scope_task_id:"",g=void 0!==a.multy_milestones[4]?a.multy_milestones[4].scope_task_id:"",y=void 0!==a.multy_milestones[5]?a.multy_milestones[5].scope_task_id:"",_=void 0!==a.multy_milestones[6]?a.multy_milestones[6].scope_task_id:"",b=void 0!==a.multy_milestones[7]?a.multy_milestones[7].scope_task_id:"",v=void 0!==a.multy_milestones[8]?a.multy_milestones[8].scope_task_id:"",w=void 0!==a.multy_milestones[9]?a.multy_milestones[9].scope_task_id:"",""!==t.label?d=t.label:(d=a.multy_milestones[0].scope_task_name,""===t.label&&(t.label=a.multy_milestones[0].scope_task_name)),t.config?(r=t.config.field_name?t.config.field_name:"",s=t.config.array?JSON.stringify(t.config.array):""):(r="",s=""),x=u+"?&val1="+p+"&val2="+h+"&val3="+f+"&val4="+m+"&val5="+g+"&val6="+y+"&val7="+_+"&val8="+b+"&val9="+v+"&val10="+w+"&task_type="+t.task_type+"&col_name="+d+"&config="+r+"&array="+s);var k=JSON.stringify(n.sites_list_in);this["xhr"+t.task_type+o]&&4!==this["xhr"+t.task_type+o].readyState&&this["xhr"+t.task_type+o].abort(),this["xhr"+t.task_type+o]=ii.ajax({url:x,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:k,success:function(a){t.total=a.length,a.length>0&&a.forEach((function(e,a){null!=e.my_date&&(e.my_date=ci(e.my_date).toDate()),e.task_name=d,e.task_type=t.task_type}));var o=ui.getFormula(t,a);t.value=o.length,t.sites_list_out=o,n.updatePort(t,e),n.getPort("dataOutput"+t.outputPort).setUserData({project:n.project,scope:n.scope,item_name:d,task_type:t.task_type,sites_list_out:o}),n.getOutputPort("dataOutput"+t.outputPort).getConnections().each(ii.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor("#b3b3b3")}),this)),i()}})}}else if("fixed month"===t.data_type){if(t.fixed_data.length>0){d=""!==t.label&&void 0!==t.label?t.label:a.multy_milestone?a.multy_milestones[0].scope_task_name:a.task.scope_task_name;var D=[];t.fixed_data.forEach((function(e,a){new Date(e.year,ri.months.indexOf(e.month),1,8,0,0,0);var n=ui.daysInMonth(ri.months.indexOf(e.month)+1,e.year),o=Math.floor(e.value/n),i=[];if(o>=1){for(var r=1;r<=n;r++)i.push({value:o});for(var s=e.value-o*n,l=0;l<s;l++)i[l].value=i[l].value+1}else{var c=Math.floor(n/e.value),u=0,p=1;for(r=1;r<=n;r++)p>c?(p=1,u++,i.push({value:1})):(p++,i.push({value:0}));for(s=e.value-u,l=0;l<s;l++)0===i[l].value?i[l].value=i[l].value+1:s++}i.forEach((function(a,n){for(var o=0;o<a.value;o++)D.push({my_date:new Date(e.year,ri.months.indexOf(e.month),n+1,8,0,0,0),site_code:"dummy",site_id:"dummy",task_name:d,task_type:t.task_type})}))})),t.value=D.length,t.sites_list_out=D,n.getPort("output0").setUserData({project:n.project,scope:n.scope,item_name:d,task_type:t.task_type,sites_list_out:D}),n.getOutputPort(0).getConnections().each(ii.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor("#b3b3b3")}),this)),i()}}else"fixed week"===t.data_type&&t.fixed_data.length>0&&(d=""!==t.label?t.label:t.multy_milestone?t.multy_milestones[0].scope_task_name:t.task.scope_task_name,D=[],t.fixed_data.forEach((function(e,a){ci(e.year+"-"+e.week,"YYYY-W WW");var n=Math.floor(e.value/7),o=[];if(n>=1){for(var i=1;i<=7;i++)o.push({value:n});for(var r=e.value-7*n,s=0;s<r;s++)o[s].value=o[s].value+1}else{var l=Math.floor(7/e.value),c=0,u=1;for(i=1;i<=7;i++)u>l?(u=1,c++,o.push({value:1})):(u++,o.push({value:0}));for(r=e.value-c,s=0;s<r;s++)0===o[s].value?o[s].value=o[s].value+1:r++}o.forEach((function(a,n){for(var o=0;o<a.value;o++){var i=n+1,r=e.year+ui.zeroPadl(e.week)+i;D.push({my_date:ci(r,"YYYYWWE").toDate(),site_code:"dummy",site_id:"dummy",task_name:d,task_type:t.task_type})}}))})),t.value=D.length,t.sites_list_out=D,n.getPort("output0").setUserData({project:n.project,scope:n.scope,item_name:d,task_type:t.task_type,sites_list_out:D}),n.getOutputPort(0).getConnections().each(ii.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor("#b3b3b3")}),this)),i())},this.updateTable=function(){n.initDataUpdate()},this.initDataUpdate=function(){(0,wo.u)(this)},this.setNewData=function(e){n.svgNodes.remove(),n.svgNodes=e,n.applyTransformation(),n.repaint(),n.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height},this.startAnimation=function(e){if(!n.getCanvas().silentMode){this.canvas.paper.setStart();var t=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading..."),a=this.userData.view.colors.monochromatic?this.userData.view.colors.mono_base_color:"#777";t.attr({fill:a,stroke:"none",opacity:0,"font-size":18,"font-weight":"bold"}),function(e,t){var a,n,o,i=Raphael.animation((a={opacity:0},o=1,(n=function(e){var t=function(e){if("object"!=di(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=di(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==di(t)?t:t+""}(n="opacity"))in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o,a),1e3);e.animate(i.repeat(t))}(t,e);var o=this.canvas.paper.setFinish();this.setNewData(o)}},this.updateSearchCol=function(e,t,a,n){var o;a.project=e,a.scope=t,n&&(a.sop=n),o=a.sop?ui.makeTaskSearchTreemaNodeClass(si.context+"/data/getAllSOPTasks?scope_id="+a.sop.scope_id+"&proj_id="+e.proj_id,a,!1):ui.makeTaskSearchTreemaNodeClass(si.context+"/data/getAllTasks?scope_id="+t.scope_id+"&proj_id="+e.proj_id,a,!1),TreemaNode.setNodeSubclass("taskcodeq",o)}},applyAlpha:function(){},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onPortValueChanged:function(e){if(e.getValue().indexOf("ticket")>-1)this.startAnimation(1e3),this.getOutputPorts().data.forEach((function(e,t){e.getConnections().each(ii.proxy((function(e,t){var a=t.getTarget();a.userData||(a.userData={}),a.userData.realCount=1,a.setValue("ticket"),t.setColor("#dfdfdf")}),this))}));else if("dataInput"==e.name){var t=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=t.getUserData().sites_list_out,this.updateSearchCol(t.getUserData().project,t.getUserData().scope,this,t.getUserData().sop),this.GetHTTPData(),this.updateUI()}},createSet:function(){this.canvas.paper.setStart(),this.userData.view||(this.userData.view={colors:{data_color:"#6f6f6f",labels_color:"#6f6f6f",add_label_color:"#5d62c4",monochromatic:!1,mono_base_color:"#ffffff"}});var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data..."),t=this.userData.view.colors.monochromatic?this.userData.view.colors.mono_base_color:"#777";return this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight()).attr({stroke:"#888","stroke-dasharray":"-"}),e.attr({fill:t,stroke:"none",opacity:.5,"font-size":24,"font-weight":"bold"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},getPersistentAttributes:function(){var e=this._super();return e.labels=[],this.children.each((function(t,a){var n=a.figure.getPersistentAttributes();n.locator=a.locator.NAME,e.labels.push(n)})),e},setPersistentAttributes:function(e){e.ports.forEach((function(e){"XYLogPortLocator"===e.locator&&(e.locator="draw2d.layout.locator.XYLogPortLocator")})),this._super(e)}});var pi=a("8a868d10b6533e768658"),hi=a("a45670b3d8fb79ec0258"),fi=a("aeb57e88bcb04c329061"),mi=a("6fe5e339b0f8a936ba8c"),gi=a("1bf2fbdb051fe0c57024"),yi=a("8deafab7866a125bb9ca");pi.shape.fishbone.ra.RaTaskGroup=pi.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaTaskGroup",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaTaskGroup</strong>}<br/><br/>",init:function(e,t,a,n){this._super(hi.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var o=this;o._scope=n;var i=new pi.DataInputPort,r=new pi.layout.locator.TopLocator;i.setConnectionDirection(0),i.setName("dataInput"),this.addPort(i,r);var s=new pi.OutputPort,l=new pi.layout.locator.BottomLocator;s.setConnectionDirection(2),s.setName("commonDataOutput"),this.addPort(s,l),this.layoutPorts(),this.sites_list_in=[],null===this.getUserData()&&this.attr({userData:{hidden:!1,autoWidth:!1,useapi:!0,task_type:"actual",data_type:"real time",count_type:"physical",group_name:"task group",showInConnections:!0,showOutConnections:!0,size:{width:450,height:350},view:{bar:{show:!0,height:30,type:""},frame:{show:!0,width:2,color:"#4b4b4b"},value:{show:!0,font:hi.extend(!0,{},fi.default_font)},total:{show:!0,font:hi.extend(!0,{},fi.default_font)},percents:{show:!0,font:hi.extend(!0,{},fi.default_font)},label:{show:!0,type_show:!0,font:hi.extend(!0,{},fi.default_font)}},conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],tasks:[hi.extend(!0,{},fi.default_task)],index:0}}),this.userData.view.value.font.font_size=14,this.userData.view.total.font.font_size=14,this.userData.view.percents.font.font_size=14,this.userData.view.label.font.font_size=14,this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},useapi:{type:"boolean",title:"Use Big Data",default:!0},use_du_id:{type:"boolean",title:"Use du_id",default:!1},use_task_name:{type:"boolean",title:"Use Task Name",default:!0},ssop_mode:{type:"boolean",title:"Procedure CI Mode",default:!0},use_ssop_code:{type:"boolean",title:"Use Procedure CI Code",default:!0},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","baseline month","fixed week"]},task_type:{type:"string",title:"Task Type",default:"actual"},group_name:{type:"string",title:"Group Name",default:"group name"},count_type:{type:"string",title:"Count Type",default:"physical",enum:["physical","logical"]},sop_mode:{type:"string",title:"SOP mode",default:"AC,WP",enum:["WP","AC","AC,WP"]},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:350},height:{type:"integer",default:350}},required:["width"]},view:{type:"object",title:"View Config",properties:{bar:{type:"object",title:"Bar",properties:{show:{title:"Show",type:"boolean",default:"true"},height:{type:"integer",title:"Item Height",default:30}}},frame:{type:"object",title:"Frame",properties:{show:{title:"Show",type:"boolean",default:"true"},width:{type:"integer",title:"Width",default:1},color:{type:"string",title:"Color",default:"#4b4b4b"}}},value:{type:"object",title:"Values",properties:{show:{title:"Show",type:"boolean",default:"true"},font:fi.template_font}},total:{type:"object",title:"Totals",properties:{show:{title:"Show",type:"boolean",default:"true"},font:fi.template_font}},percents:{type:"object",title:"Percents",properties:{show:{title:"Show",type:"boolean",default:"true"},font:fi.template_font}},label:{type:"object",title:"Labels",properties:{show:{title:"Show",type:"boolean",default:"true"},type_show:{title:"Show Task Type",type:"boolean",default:"true"},font:fi.template_font}}}},conditions:fi.template_conditions,showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},tasks:{type:"array",title:"Tasks",items:fi.template_task},index:{type:"integer",title:"Mobile Index",default:0}},required:["size","tasks"]},this.fixData=function(){},this.openTreemaTask=function(e){if(this.treema){var t=this.treema.childrenTreemas.tasks;t.close(),t.open(),t.childrenTreemas[e].open()}},this.syncByName=function(){},this.syncByCode=function(){var e=mi.context+"/data/getAllTasks?scope_id="+o.scope.scope_id+"&proj_id="+o.project.proj_id,t="";hi.ajax({url:e,datatype:"json",type:"GET",success:function(e){!function(e){if(e.length)for(var a=0;a<o.userData.tasks.length;a++){if(o.userData.tasks[a].actual.multy_milestone)for(var n=0;n<o.userData.tasks[a].actual.multy_milestones.length;n++){var i;(i=(new gi).from(e).where((function(e,t){return e.scope_task_code.toLowerCase()==o.userData.tasks[a].actual.multy_milestones[n].scope_task_code.toLowerCase()})).select()).length?(o.userData.tasks[a].actual.multy_milestones[n].scope_task_code=i[0].scope_task_code,o.userData.tasks[a].actual.multy_milestones[n].scope_task_name=i[0].scope_task_name,o.userData.tasks[a].actual.multy_milestones[n].scope_task_id=i[0].scope_task_id,t=t+o.userData.tasks[a].actual.multy_milestones[n].scope_task_code+" ("+o.userData.tasks[a].actual.multy_milestones[n].scope_task_name+")  - success!!!\n"):t=t+o.userData.tasks[a].actual.multy_milestones[n].scope_task_code+" ("+o.userData.tasks[a].actual.multy_milestones[n].scope_task_name+")  - fail!!!\n"}else(i=(new gi).from(e).where((function(e,t){return e.scope_task_code.toLowerCase()==o.userData.tasks[a].actual.task.scope_task_code.toLowerCase()})).select()).length?(o.userData.tasks[a].actual.task.scope_task_code=i[0].scope_task_code,o.userData.tasks[a].actual.task.scope_task_name=i[0].scope_task_name,o.userData.tasks[a].actual.task.scope_task_id=i[0].scope_task_id,t=t+o.userData.tasks[a].actual.task.scope_task_code+" ("+o.userData.tasks[a].actual.task.scope_task_name+")  - success!!!\n"):t=t+o.userData.tasks[a].actual.task.scope_task_code+" ("+o.userData.tasks[a].actual.task.scope_task_name+")  - fail!!!\n";alert(t),t=""}}(e)}})},this.getRealCount=function(e){return"commonDataOutput"===e.getName()?this.userData.tasks.length:1},this.resetUI=function(){this.TaskGroup&&(this.TaskGroup=null)},this.GetHTTPData=function(){var e=this,t=[];this.TaskGroup?this.TaskGroup.options.view=hi.extend(!0,hi.extend(!0,{},fi.default_view),this.userData.view):(this.userData.tasks.forEach((function(e){e.value=0,e.total=0,e.sites_list_out=[],t.push(e.task.scope_task_id)})),this.TaskGroup=yo.init(this.canvas.paper,this.userData,this),this.setNewData(this.TaskGroup.svg_nodes)),this.userData.tasks.forEach((function(t,a){yi.updatePort(o,t,a);var n=t,i=o.getOutputPort(t.outPort),r="";""!==n.label?r=n.label:(r=n.multy_milestone?n.multy_milestones[0].scope_task_name:n.task.scope_task_name,n.label=r),n.ID||(n.ID=pi.util.UUID.create());var s={project:e.project,scope:e.scope,sop:e.sop,col_name:r,task_type:n.task_type,id:n.ID,figure_id:e.getId(),color:"#777777",group_name:n.group_name?n.group_name:o.userData.group_name},l=hi.extend(!0,{},n);l.conditions=n.conditions&&n.conditions.length>0?n.conditions:o.userData.conditions,l.task_type=n.task_type?n.task_type:o.userData.task_type,l.data_type=n.data_type?n.data_type:o.userData.data_type,l.count_type=n.count_type?n.count_type:o.userData.count_type,l.group_name=n.group_name?n.group_name:o.userData.group_name,l.use_du_id=n.use_du_id?n.use_du_id:o.userData.use_du_id,l.use_task_name=n.use_task_name?n.use_task_name:o.userData.use_task_name,l.use_ssop_code=n.use_ssop_code?n.use_ssop_code:o.userData.use_ssop_code,l.ssop_mode=n.ssop_mode?n.ssop_mode:o.userData.ssop_mode,yi.getTaskData(l,e.sites_list_in,i,s,(function(n,i,r){t.total=i,t.value=n.length,l.total=i,l.value=n.length,l.sites_list_out=n,e.TaskGroup.series[a]?(e.TaskGroup.series[a].dimm(),e.TaskGroup.series[a].update(l),e.TaskGroup.series[a].update(l)):e.TaskGroup.addSerie(l);var s=o.getPort("commonDataOutput");if(!s){s=new pi.OutputPort;var c=new pi.layout.locator.BottomLocator;s.setConnectionDirection(2),s.setName("commonDataOutput"),e.addPort(s,c),e.layoutPorts()}s.setId(r.id),s.setUserData({project:r.project,scope:r.scope,sop:r.sop,item_name:r.col_name,task_type:r.task_type,sites_list_out:n}),s.getConnections().each(hi.proxy((function(e,t){var a=t.getTarget();a.setValue(o.getId()),t.setColor("#777777"),DEBUG&&console.log("TaskGroup update data send from: "+s.getName()+" to: "+a.getParent().NAME)}),e))}),o.userData.useapi)})),o.layoutPorts()},this.setNewData=function(e){var t=this;if(this.userData.size&&this.userData.size.height&&0!==this.userData.size.height)this.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,this.TaskGroup&&this.TaskGroup.bkgd.attr({height:this.userData.size.height});else{var a=0;this.userData.tasks.forEach((function(e,n){var o={},i=e.view;hi.extend(!0,o,t.userData.view.bar,i&&i.bar?i.bar:{}),a+=o.height})),this.setDimension(this.userData.size&&this.userData.size.width||350,a),this.originalWidth=this.userData.size&&this.userData.size.width||350,this.originalHeight=a,this.TaskGroup&&this.TaskGroup.bkgd.attr({height:a})}this.svgNodes.remove(),this.svgNodes=e,this.applyTransformation(),this.repaint()},this.updateSearchCol=function(e,t,a,n){var o;a.project=e,a.scope=t;var i,r="700743337020260352";n&&(a.sop=n),i=a.userData.ssop_mode?yi.makeTaskSearchSSOPTreemaNodeClass:yi.makeTaskSearchTreemaNodeClass,o=a.sop?a.userData.useapi?i(mi.context+"/apidata/getAPIData?apiid="+r+"&user_id="+window.user_id,a,!0,{proj_id:e.proj_id,du_model_id:a.sop.scope_id}):i(mi.context+"/data/getAllSOPTasks?scope_id="+a.sop.scope_id+"&proj_id="+e.proj_id,a,!1):a.userData.useapi?i(mi.context+"/apidata/getAPIData?apiid="+r+"&user_id="+window.user_id,a,!0,{proj_id:e.proj_id}):i(mi.context+"/data/getAllTasks?scope_id="+t.scope_id+"&proj_id="+e.proj_id,a,!1),TreemaNode.setNodeSubclass("taskcodeq",o)}},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onPortValueChanged:function(e){if(e.getValue().indexOf("ticket")>-1)DEBUG&&console.log("TaskGroup  "+this.id+" update ticket received: "+e.name),yi.initFallDown(this);else if("dataInput"===e.name){DEBUG&&console.log("TaskGroup  "+this.id+" update data received: "+e.name);var t=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=t.getUserData().sites_list_out,this.project=t.getUserData().project,this.scope=t.getUserData().scope,this.sop=t.getUserData().sop,this.updateUI(),this.GetHTTPData()}},updateUI:function(){this.resetUI()},createSet:function(){this.canvas.paper.setStart(),this.userData.view||(this.userData.view={colors:{data_color:"#6f6f6f",labels_color:"#6f6f6f",add_label_color:"#5d62c4",monochromatic:!1,mono_base_color:"#ffffff"}});var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data...");return this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight()).attr({stroke:"#888","stroke-dasharray":"-"}),e.attr({fill:"#777",stroke:"none",opacity:.5,"font-size":24,"font-weight":"bold"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},getPersistentAttributes:function(){var e=this._super();return!0===this.persistPorts&&(e.ports=[],this.getPorts().each((function(t,a){e.ports.push(extend(a.getPersistentAttributes(),{name:a.getName(),port:a.NAME,locator:a.getLocator().NAME,x:a.getLocator().x,y:a.getLocator().y}))}))),e},setPersistentAttributes:function(e){var t=this;void 0!==e.ports&&e.ports.forEach((function(e){"XYLogPortLocator"===e.locator&&(e.locator="draw2d.layout.locator.XYLogPortLocator")})),this._super(e),void 0!==e.ports&&(this.persistPorts=!0,this.resetPorts(),e.ports.forEach((function(e){var a=new Function("draw2d","return new "+e.port+"();")(pi),n="";e.x&&void 0!==e.y&&(n=e.x+","+e.y);var o=new Function("draw2d","return new "+e.locator+"("+n+");")(pi);a.setPersistentAttributes(e),t.addPort(a,o),a.setName(e.name)})))}}),a("e4cbf67c36f0a042bd43");var _i=a("8a868d10b6533e768658"),bi=a("a45670b3d8fb79ec0258"),vi=a("aeb57e88bcb04c329061"),wi=a("8deafab7866a125bb9ca"),xi=a("d1be49724a1f416e7f57");_i.shape.fishbone.ra.AddRaTaskGroup=_i.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.AddRaTaskGroup",INFO:"\tComing SOON!",init:function(e,t,a){this._super(bi.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var n=this;this.updateTickets=0,this.conn_count=0;var o=new _i.DataInputPort,i=new _i.layout.locator.TopLocator;o.setConnectionDirection(0),o.setName("dataInput"),this.addPort(o,i),o.setMaxFanOut(100);var r=new _i.OutputPort,s=new _i.layout.locator.BottomLocator;r.setConnectionDirection(2),r.setName("commonDataOutput"),this.addPort(r,s),this.layoutPorts();var l=this.getUserData();new Date,null===l&&this.attr({userData:{hidden:!1,autoWidth:!1,task_type:"add",group_name:"task group",math_type:"add",comp_level:"site_id",showInConnections:!0,showOutConnections:!0,size:{width:350,height:350},view:{bar:{show:!0,height:30,type:"",frame:{show:!0,width:2,color:"#4b4b4b"}},value:{show:!0,font:bi.extend(!0,{},vi.default_font)},total:{show:!0,font:bi.extend(!0,{},vi.default_font)},percents:{show:!0,font:bi.extend(!0,{},vi.default_font)},label:{show:!0,type_show:!1,font:bi.extend(!0,{},vi.default_font)}},conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],tasks:[],index:0}}),this.userData.view.value.font.font_size=14,this.userData.view.total.font.font_size=14,this.userData.view.percents.font.font_size=14,this.userData.view.label.font.font_size=14,this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},task_type:{type:"string",title:"Task Type",default:"actual"},group_name:{type:"string",title:"Group Name",default:"group name"},math_type:{type:"string",title:"Calculation Type",default:"add",enum:["add","and","or","diff"]},comp_level:{type:"string",title:"Comparision Level",default:"sites",enum:["site_id","site_code","simple"]},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:350},height:{type:"integer",default:350}},required:["width"]},view:{type:"object",title:"View Config",properties:{bar:{type:"object",title:"Bar",properties:{show:{title:"Show",type:"boolean",default:"true"},height:{type:"integer",title:"Item Height",default:30}}},frame:{type:"object",title:"Frame",properties:{show:{title:"Show",type:"boolean",default:"true"},width:{type:"integer",title:"Width",default:1},color:{type:"string",title:"Color",default:"#4b4b4b"}}},value:{type:"object",title:"Values",properties:{show:{title:"Show",type:"boolean",default:"true"},font:vi.template_font}},total:{type:"object",title:"Totals",properties:{show:{title:"Show",type:"boolean",default:"true"},font:vi.template_font}},percents:{type:"object",title:"Percents",properties:{show:{title:"Show",type:"boolean",default:"true"},font:vi.template_font}},label:{type:"object",title:"Labels",properties:{show:{title:"Show",type:"boolean",default:"true"},type_show:{title:"Show Task Type",type:"boolean",default:"true"},font:vi.template_font}}}},conditions:vi.template_conditions,showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},tasks:{type:"array",title:"Tasks",items:bi.extend(!0,{},{properties:{math_type:{type:"string",title:"Calculation Type",default:"add",enum:["add","and","or","diff"]},comp_level:{type:"string",title:"Comparision Level",default:"sites",enum:["site_id","site_code","simple"]}}},vi.template_task)},index:{type:"integer",title:"Mobile Index",default:0}}},this.on("contextmenu",(function(e,t){bi.contextMenu({selector:"body",events:{hide:function(){bi.contextMenu("destroy")}},callback:bi.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){n.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){n.toogleOutConn()}),10)}}),this),x:t.x,y:t.y,items:{toogleInCon:n.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"},toogleOutCon:n.userData.showOutConnections?{name:"Hide Out Connections"}:{name:"Show Out Connections"}}})})),this.updateUI=function(){},this.GetHTTPData=function(){this.userData.tasks.forEach((function(e){e.value=0,e.total=0,e.sites_list_out=[]})),this.getInputPorts().data.forEach((function(e,t){e.getConnections().each(bi.proxy((function(e,t){var a=t.getSource().getParent();a.userData.tasks&&a.userData.tasks.length&&a.userData.tasks.forEach((function(t,o){n.userData.tasks[o]||(n.userData.tasks.push(bi.extend(!0,{},t,{ID:_i.util.UUID.create()})),n.userData.tasks[o].outPort&&delete n.userData.tasks[o].outPort,n.userData.tasks[o].total=0,n.userData.tasks[o].value=0,n.userData.tasks[o].sites_list_out=[],wi.updatePort(n,n.userData.tasks[o],o));var i,r=a.getOutputPort(a.userData.tasks[o].outPort),s=[];switch(i=r.userData&&r.userData.sites_list_out?r.userData.sites_list_out.slice():[],n.userData.tasks[o].math_type?n.userData.tasks[o].math_type:n.userData.math_type){case"add":default:s=n.userData.tasks[o].sites_list_out.concat(i);break;case"and":if(0===e)s=i;else switch(n.userData.tasks[o].comp_level?n.userData.tasks[o].comp_level:n.userData.comp_level){case"site_id":default:s=xi("SELECT f.*, s.* FROM ? AS f INNER JOIN ? AS s ON f.site_id = s.site_id",[n.userData.tasks[o].sites_list_out,i]);break;case"site_code":s=xi("SELECT f.*, s.* FROM ? AS f INNER JOIN ? AS s ON f.site_code = s.site_code",[n.userData.tasks[o].sites_list_out,i])}break;case"or":switch(n.userData.tasks[o].comp_level?n.userData.tasks[o].comp_level:n.userData.comp_level){case"site_id":default:s=xi("SELECT f.*, s.* FROM ? AS f FULL OUTER JOIN ? AS s ON f.site_id = s.site_id",[n.userData.tasks[o].sites_list_out,i]);break;case"site_code":s=xi("SELECT f.*, s.* FROM ? AS f FULL OUTER JOIN ? AS s ON f.site_code = s.site_code",[n.userData.tasks[o].sites_list_out,i])}break;case"diff":switch(n.userData.tasks[o].comp_level?n.userData.tasks[o].comp_level:n.userData.comp_level){case"site_id":default:s=xi("SELECT s.*, f.* FROM ? AS f FULL OUTER JOIN ? AS s ON (f.site_id = s.site_id) WHERE f.site_id IS NULL OR s.site_id IS NULL",[n.userData.tasks[o].sites_list_out,i]);break;case"site_code":s=xi("SELECT s.*, f.* FROM ? AS f FULL OUTER JOIN ? AS s ON (f.site_code = s.site_code) WHERE f.site_code IS NULL OR s.site_code IS NULL",[n.userData.tasks[o].sites_list_out,i])}}n.userData.tasks[o].value=s.length,n.userData.tasks[o].total=n.userData.tasks[o].total+t.total,n.userData.tasks[o].sites_list_out=s}))}),this))})),this.portRelayoutRequired=!0,this.layoutPorts(),this.TaskGroup&&(this.TaskGroup=null),this.TaskGroup=yo.init(this.canvas.paper,this.userData,this),this.setNewData(this.TaskGroup.svg_nodes),n.userData.tasks.length&&n.userData.tasks.forEach((function(e,t){var a=e,o=bi.extend(!0,{},a);o.conditions=a.conditions&&a.conditions.length>0?a.conditions:n.userData.conditions,o.task_type=a.task_type?a.task_type:n.userData.task_type,o.data_type=a.data_type?a.data_type:n.userData.data_type,o.count_type=a.count_type?a.count_type:n.userData.count_type,o.group_name=a.group_name?a.group_name:n.userData.group_name;var i=(0,h.getFormula)(o,o.sites_list_out),r=n.getOutputPort(e.outPort),s="";""!==a.label?s=a.label:(s=a.multy_milestone?a.multy_milestones[0].scope_task_name:a.task.scope_task_name,a.label=s);var l={project:n.project,scope:n.scope,sop:n.sop,col_name:s,task_type:o.task_type,id:e.id,figure_id:n.getId(),color:"#777777",group_name:a.group_name?a.group_name:n.userData.group_name};i.forEach((function(e,t){e.task_name=s,e.task_type=o.task_type,e.group_name=o.group_name})),o.total=e.total,o.value=i.length,n.TaskGroup.series[t]?n.TaskGroup.series[t].update(o):n.TaskGroup.addSerie(o),wi.sendTaskData(l,r,i);var c=n.getPort("commonDataOutput");c.setId(e.ID),c.setUserData({project:n.project,scope:n.scope,item_name:e.label,task_type:o.task_type,sites_list_out:i}),n.getPort("commonDataOutput").getConnections().each(bi.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor("#777777")}),this))}))},this.updateOutPorts=function(){var e=this;this.getOutputPorts().data.forEach((function(t,a){if("commonDataOutput"!==t.getName()){var n=!1;e.userData.tasks.forEach((function(e,a){e.outPort===t.getId()&&(n=!0)})),n||(e.removePort(t),e.resetUI(),e.GetHTTPData(),e.portRelayoutRequired=!0,e.layoutPorts())}}))},this.openTreemaTask=function(e){if(this.treema){var t=this.treema.childrenTreemas.tasks;t.close(),t.open(),t.childrenTreemas[e].open()}},this.setNewData=function(e){var t=this;if(this.userData.size&&this.userData.size.height&&0!==this.userData.size.height)this.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height;else{var a=0;this.userData.tasks.forEach((function(e,n){var o={},i=e.view;bi.extend(!0,o,t.userData.view.bar,i&&i.bar?i.bar:{}),a+=o.height})),this.setDimension(this.userData.size&&this.userData.size.width||350,a),this.originalWidth=this.userData.size&&this.userData.size.width||350,this.originalHeight=a}this.svgNodes.remove(),this.svgNodes=e,this.applyTransformation(),this.repaint()},this.startAnimation=function(e){this.canvas.paper.setStart();var t=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading...");t.attr({fill:"#777",stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),t.stop().animate({opacity:1},e,"elastic");var a=this.canvas.paper.setFinish();this.setNewData(a)},this.resetUI=function(){this.TaskGroup&&(this.TaskGroup=null),this.updateOutPorts()},this.getRealCount=function(e){return"commonDataOutput"===e.getName()?this.userData.tasks.length:1}},applyAlpha:function(){},updateUI:function(){this.resetUI()},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},getInConnectionCount:function(){var e=0;return this.userData.conn_count?e=this.userData.conn_count:this.getInputPorts().data.forEach((function(t,a){e+=t.getConnections().data.length})),e},safelyDeleteTask:function(e){var t=this,a=!1;if(this.getInputPorts().data.forEach((function(t,n){t.getConnections().each((function(t,n){var o=n.getSource().getParent();o.userData.tasks&&o.userData.tasks[e]&&(a=!0)}))})),!a){var n=t.userData.tasks[e].ID;t.removePort(t.getOutputPort(t.userData.tasks[e].outPort)),t.userData.tasks.splice(e,1),t.portRelayoutRequired=!0,t.layoutPorts();var o=t.getPort("commonDataOutput");if(o){var i=o.getConnections();i.data.length&&i.each((function(e,t){var a=t.getTarget();"draw2d.PivotColInputPort"===a.NAME&&wi.checkDisconn(a.getParent(),n)}))}}},onPortValueChanged:function(e){e.getValue().indexOf("ticket")>-1?(void 0!==e.userData.realCount?this.updateTickets=this.updateTickets+e.userData.realCount:this.updateTickets=this.updateTickets+1,DEBUG&&console.log("AddTaskGroup  "+this.id+" update ticket received: "+this.updateTickets),this.conn_count=this.conn_count+1,(this.conn_count>=this.getInConnectionCount()||e.superUpdate)&&(this.conn_count=0,wi.initFallDown(this),e.superUpdate&&(e.superUpdate=!1))):(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),DEBUG&&console.log("AddTaskGroup  "+this.id+" update data received: "+this.updateTickets),this.updateTickets<=0&&(this.updateTickets=0,DEBUG&&console.log("AddTaskGroup  "+this.id+" data updating..."),this.GetHTTPData()))},createSet:function(){this.canvas.paper.setStart(),this.userData.view||(this.userData.view={colors:{data_color:"#6f6f6f",labels_color:"#6f6f6f",add_label_color:"#5d62c4",monochromatic:!1,mono_base_color:"#ffffff"}});var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data...");return this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight()).attr({stroke:"#888","stroke-dasharray":"-"}),e.attr({fill:"#777",stroke:"none",opacity:.5,"font-size":24,"font-weight":"bold"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},getPersistentAttributes:function(){var e=this._super();return!0===this.persistPorts&&(e.ports=[],this.getPorts().each((function(t,a){e.ports.push(extend(a.getPersistentAttributes(),{name:a.getName(),port:a.NAME,locator:a.getLocator().NAME,x:a.getLocator().x,y:a.getLocator().y}))}))),e},setPersistentAttributes:function(e){var t=this;this._super(e),void 0!==e.ports&&(this.persistPorts=!0,this.resetPorts(),e.ports.forEach((function(e){var a=new Function("draw2d","return new "+e.port+"();")(_i),n="";"XYLogPortLocator"===e.locator&&(e.locator="draw2d.layout.locator.XYLogPortLocator"),e.x&&void 0!==e.y&&(n=e.x+","+e.y);var o=new Function("draw2d","return new "+e.locator+"("+n+");")(_i);a.setPersistentAttributes(e),t.addPort(a,o),a.setName(e.name)})))}}),a("5988baaf407adbba3b29"),a("e0605142b99680f9b01a"),a("22cc6edc006f7d982b02"),a("84c83683c1d44bbbc02a"),a("2f97851495b479d0a251"),a("a8d6bfb38cc4f98f246a");var ki=a("22df5903c65ac830ef5a"),Di=a.n(ki),Si=a("a45670b3d8fb79ec0258"),Ci=a("8deafab7866a125bb9ca"),Ti=a("aeb57e88bcb04c329061"),Ai=a("d1be49724a1f416e7f57"),Pi=a("6fe5e339b0f8a936ba8c");function Ei(e,t){if(e){if("string"==typeof e)return Ii(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ii(e,t):void 0}}function Ii(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}c().shape.fishbone.cell.SQLnode=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.SQLnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.SQLnode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(Si.extend({filter_str:"SQL",color:"#777777",items:{sate_config:{name:"Save Config",icon:"fas fa-file-download",callback:function(){var e=[o.getPersistentAttributes()];Ci.removeData(e),e=JSON.stringify(e,null,2);var t=o.userData.label?o.userData.label:"node.conf",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,da.saveAs)(a,t)}},sep:"---------"}},e),t,a,n),this.help="Node witch is providing SQL request facility integration into existing object structure.";var o=this;Si.extend(this.userData,{data_from:"alasql",sql:"select * from ?",label:"New Query",params:[],lookups:[],inputSourceOrder:[]}),Si.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{params:Ti.template_params,lookups:Ti.template_lookups,data_from:{type:"string",title:"Get Data From",default:"alasql",enum:["stats","params","alasql","delay"]},sql:{type:"string",title:"SQL",format:"ace",aceMode:"ace/mode/sql",disableWorker:!1,AItools:{sender:"sql",tools:["left","gen","edit","opti","save_lib","load_lib","right"]}},make_table:{type:"boolean",title:"Create AlaSQL Table",default:!1},sql_index:{type:"string",title:"Index",default:"du_id"},label:{type:"string",format:"hidden",default:"new_data_set"}}}),this.AI||(this.AI={}),this.AI.sql||(this.AI.sql={}),this.AI.sql.generateAI=function(e){var t=[];o.userData.row.forEach((function(e){e&&e.sites_list_out&&t.push(e.sites_list_out.slice(0,10))}));var a={chatUuid:"",chatName:"",text:"You are SQL data analyst and admin, \n       \n        1. Using AlaSQL library syntax you need to:\n        - create AlaSQL sql string to select all data from source array\n        \n        here is source array in JSON format:\n        ".concat(JSON.stringify(t),'\n        \n        - Use quotation marks "?" to reference each subsequent data source is sql string\n        - Do NOT use special or key words for aliases\n        - strictly keep table aliases shirt\n        - do not use aliases in "GROUP BY"\n        - Avoid common words like "count," "sum," "id," and "name" and so on for aliases\n        - Generated string will be used in AlaSQL function - alasql(sql_string, source_array, callback) please make sure it has corresponding syntax\n        - use MomentJS for dates manipulation\n        \n        2. Result Requirement:\n        - Optimize, format, indent and Beautify result sql\n        - return only SQL string without text explanation\n        - Do not include ```sql``` or ```json``` or any other code tags and without code fencing\n    ')};Ci.handleRegularResponse(a,o,e,o.userData.sql,"sql")},this.AI.sql.editAI=function(e){var t=prompt("Please specify your requirements:","");if(t){var a,n,i,r,s=[];o.userData.row.forEach((function(e){e&&e.sites_list_out&&s.push(e.sites_list_out.slice(0,10))}));var l=(t=null!==(a=o.AI)&&void 0!==a&&null!==(a=a.sql)&&void 0!==a&&a.chatUuid&&null!==(n=o.AI)&&void 0!==n&&null!==(n=n.sql)&&void 0!==n&&n.chatName?"Update SQL in according to new user requirements:\n            1. ".concat(t," \n            \n            and updated by user sql string:\n             ").concat(o.userData.sql,"\n            \n             - update AlaSQL sql string according to source array\n             \n            here is source array in JSON format:\n            ").concat(JSON.stringify(s),"\n        \n            but remember:"):"Update provided AlaSQL sql string: \n            \n            ".concat(o.userData.sql,"\n            \n            according to user requirements:\n            1. ").concat(t," \n            \n             - update AlaSQL sql string according to source array\n            here is source array in JSON format:\n            ").concat(JSON.stringify(s),"\n        \n            but remember:"))+'You are SQL data admin, and using AlaSQL library syntax\n            \n        Result Requirement:\n        - use MomentJS for dates manipulation\n        - use original function rather then aliases for GROUP BY statement\n        - rename aliases which is using common words like "count," "sum," "id," and "name" and so on\n        - Optimize, format, indent and Beautify result sql string\n        - return only SQL string without text explanation\n        - Do not include ```sql``` or ```json``` or any other code tags and without code fencing\n        ',c={chatUuid:(null===(i=o.AI)||void 0===i||null===(i=i.sql)||void 0===i?void 0:i.chatUuid)||"",chatName:(null===(r=o.AI)||void 0===r||null===(r=r.sql)||void 0===r?void 0:r.chatName)||"",text:l};Ci.handleRegularResponse(c,o,e,o.userData.sql,"sql")}},this.AI.sql.optiAI=function(e){var t,a,n="You are SQL data admin, using AlaSQL library syntax\n             Optimize, format, indent and Beautify provided AlaSQL sql string:\n             \n             ".concat(o.userData.sql,"\n             \n             Result Requirement:\n                - use MomentJS for dates manipulation\n                - return only SQL string without text explanation\n                - Do not include ```sql``` or ```json``` or any other code tags and without code fencing\n            "),i={chatUuid:(null===(t=o.AI)||void 0===t||null===(t=t.sql)||void 0===t?void 0:t.chatUuid)||"",chatName:(null===(a=o.AI)||void 0===a||null===(a=a.sql)||void 0===a?void 0:a.chatName)||"",text:n};Ci.handleRegularResponse(i,o,e,o.userData.sql,"sql")},this.updateTable=function(e){var t=this;if(DEBUG)var a,n=performance.now();var i=this.getUserData();if(i.sql&&!e)try{this.updateTickets=[];var r,s=Di()(i.sql);if(DEBUG&&console.log("SQLNode update query id:"+this.id+" "+i.label),this.val_label.setText("."),s=s.replace(/(?:\r\n|\r|\n)/g," "),"alasql"===o.userData.data_from){r=Ci.applyParams(s,i,!0);var l=[];o.userData.row.forEach((function(e){e&&e.sites_list_out&&l.push(e.sites_list_out)})),DEBUG&&console.log(r),Ai(r,l,function(e){if(o.userData.sites_list_out=e,o.userData.value=o.userData.sites_list_out.length,o.getPort("output0").setUserData({project:o.project||"",scope:o.scope||"",item_name:o.userData.label,task_type:o.userData.task_type||"",sites_list_out:o.userData.sites_list_out}),o.userData.make_table){var t;t=this.userData.isEditedLabel?this.userData.label:"New Query";try{Ai("DROP TABLE IF EXISTS "+t)}catch(e){}Ai("CREATE TABLE "+t),Ai("INSERT INTO "+t+" select * from ?",[e]),this.userData.sql_index&&Ai("CREATE INDEX tmp ON "+t+"("+this.userData.sql_index+")"),DEBUG&&console.log("getData - data imported into "+t," time: "+new Date)}var a=o.getOutputPort(0).getConnections();o.sentData(a),o.updateUI()}.bind(this))}else if("stats"===o.userData.data_from){var c=Pi.context+"/mongo/stats",u=Ci.getParams(i);this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=Si.ajax({url:c,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(u),success:function(e){o.userData.sites_list_out=e,o.userData.value=o.userData.sites_list_out.length,o.getPort("output0").setUserData({project:o.project||"",scope:o.scope||"",item_name:o.userData.label,task_type:o.userData.task_type,sites_list_out:o.userData.sites_list_out}),o.getOutputPort(0).getConnections().each(Si.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),o.updateUI()},error:function(e,t){DEBUG&&console.log(t)}})}else if("params"===o.userData.data_from){var d=window.location.search;console.log(d);var p=function(e){var t,a,n,o={},i=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=Ei(e))){t&&(e=t);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,r=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){r=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(r)throw o}}}}(e);try{for(i.s();!(t=i.n()).done;){var r=(a=t.value,n=2,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(a,n)||Ei(a,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=r[0],l=r[1];o[s]=l}}catch(e){i.e(e)}finally{i.f()}return[o]}(new URLSearchParams(d));o.userData.sites_list_out=p,o.userData.value=o.userData.sites_list_out.length,o.getPort("output0").setUserData({project:o.project||"",scope:o.scope||"",item_name:o.userData.label,task_type:o.userData.task_type,sites_list_out:o.userData.sites_list_out}),o.getOutputPort(0).getConnections().each(Si.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),o.updateUI()}else"delay"===o.userData.data_from&&setTimeout((function(){o.userData.value="Dl",o.getPort("output0").setUserData({project:o.project||"",scope:o.scope||"",item_name:o.userData.label,task_type:o.userData.task_type,sites_list_out:[{done:1}]}),o.getOutputPort(0).getConnections().each(Si.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),t)),o.updateUI()}),2e3)}catch(e){console.log(e)}DEBUG&&(a=performance.now(),console.log("SQL Performance:"+this.id+" - "+(a-n)))}},loadTreema:function(){Ci.updateParamSourceCol(this),Ci.updateParamDetailsCol(this),Ci.updatePropKeyCol(this),Ci.updateLookupSourceCol(),Ci.updateLookupKeyCol(),Ci.updateLookupValueCol(),Ci.updateLookupResultCol(),this._super(this)}});var Ni=a("c56a9a1505d4102c9723"),Mi=a("d1be49724a1f416e7f57"),Oi=a("8a868d10b6533e768658"),ji=a("a45670b3d8fb79ec0258"),Ri=a("8deafab7866a125bb9ca"),Li=a("a45670b3d8fb79ec0258");function Fi(e){return Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fi(e)}function Ui(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}Mi.private.externalXlsxLib=a("d430dc12a1665f4e5905");var Bi={compress:function(e,t){try{if(!e||!Array.isArray(e)||0===e.length)return e;if(0===e.length)return e;var a;if(t&&Array.isArray(t)&&t.length>0)a=t.map((function(e){return e.name}));else{var n=e[0];a=Object.keys(n),console.warn("[TableDataCompression] Using first row for column detection - potential data loss if columns missing from first row")}var o=[a].concat(function(e){if(Array.isArray(e))return Ui(e)}(s=e.map((function(e){return a.map((function(t){return e[t]||""}))})))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(s)||function(e,t){if(e){if("string"==typeof e)return Ui(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ui(e,t):void 0}}(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=JSON.stringify(o),r=btoa(unescape(encodeURIComponent(i)));return"__COMPRESSED__".concat(r)}catch(t){return console.warn("[RaTablenode] Compression failed, using uncompressed data:",t),e}var s},decompress:function(e){try{if(!e||"string"!=typeof e)return e;if(!this.isCompressed(e))return e;var t=e.replace("__COMPRESSED__",""),a=decodeURIComponent(escape(atob(t))),n=JSON.parse(a);if(!Array.isArray(n)||n.length<1)throw new Error("Invalid compressed data format");var o=n[0];return n.slice(1).map((function(e){var t={};return o.forEach((function(a,n){t[a]=e[n]||""})),t}))}catch(t){return console.warn("[RaTablenode] Decompression failed, using data as-is:",t),e}},isCompressed:function(e){return"string"==typeof e&&e.startsWith("__COMPRESSED__")},getRawData:function(e){return this.isCompressed(e)?this.decompress(e):e}};Oi.shape.fishbone.ra.RaTablenode=Oi.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaTablenode",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaTablenode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(ji.extend({stroke:0,bgColor:null},e),t,a);var o=this;this.setResizeable(!1),this.createPort("output");var i=new Oi.TableInputPort;i.setConnectionDirection(0);var r=new Oi.layout.locator.TopLocator;i.setName("chartInput0"),this.addPort(i,r);var s=new Oi.TableInputPort,l=new Oi.layout.locator.LeftLocator;s.setConnectionDirection(3),s.setName("chartInput1"),this.addPort(s,l),this.sites_list_in=[],this.updateTickets=0,null===this.getUserData()&&this.attr({userData:{hidden:!1,data_source:"alasql",showInConnections:!0,size:{width:250,height:30},grid:{top_m:20,left_m:5,bottom_m:10},col:[],table_col_spec:[],sites_list_out:[],table_name:"tbl_1",preserve_data:!0,show_data:!1}}),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{updateBlock:{type:"boolean",title:"Block Auto Update",default:!0},hidden:{type:"boolean",title:"Mobile hidden",default:!1},start_date:{type:"string",title:"Start Date",format:"date",default:""},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:250},height:{type:"integer",default:30}}},grid:{additionalProperties:!1,type:"object",title:"Grid Options",properties:{top_m:{type:"integer",title:"Top Margine",default:40},left_m:{type:"integer",title:"Left Margine",default:20},bottom_m:{type:"integer",title:"Bottom Margine",default:60}}},showInConnections:{type:"boolean",title:"Show Connections",default:!0},value:{type:"integer",title:"Current Value",default:0},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},serie:{type:"object",title:"Chart Series",properties:{name:{type:"string",default:""},type:{type:"string",default:"line",enum:["line","bar"]},barWidth:{type:"integer",title:"Bar Max Width",default:10},areaStyle:{type:"object",title:"Area Style",properties:{normal:{type:"object"},show:{type:"boolean",title:"Show Area",default:!0}}},data:{type:"array",title:"Data",items:{type:"integer",default:0}}}},sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}}},table_col_spec:{type:"array",title:"Columns Spec",items:{type:"object",title:"Column",properties:{name:{type:"string",default:""},formatting:{type:"string",default:"none",enum:["none","0","0.0","0.00","0.000","0%","0%f","0%f(3c)","0.00%","0.00%f","0.00%f(3c)","2St","3St"]},prefix:{type:"string",title:"Prefix",default:""},affix:{type:"string",title:"Affix",default:""},bg_color:{type:"string",title:"Background Color",default:"#fff"},fn_color:{type:"string",title:"Font Color",default:"#000"},font_type:{type:"string",title:"Font Family",default:"Tahoma, Geneva",enum:["Tahoma, Geneva"]},font_size:{type:"string",title:"Font Size",default:"12px",enum:["8px","10px","12px","14px","18px","20px","24px","32px"]},width:{type:"string",title:"Width",default:"auto"},final_width:{type:"number",format:"hidden"},data:{type:"array",items:{}},totals:{type:"string",title:"Totals",default:"none",enum:["none","count","sum","max","min","avg"]}}},sites_list_out:{type:"array",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"string",title:"Date",default:""},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},item_name:{title:"Name",type:"string",default:"name"},project:{type:"object",title:"Project",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},site_id:{type:"string",title:"Site ID"}}}},table_name:{type:"string",title:"Table Name",default:"tbl_1"},data_source:{type:"string",title:"Source of Data",default:"alasql",enum:["alasql","table"]},source_report_id:{type:"string",title:"Source Report ID",default:""},source_table_id:{type:"string",title:"Source Table ID",default:""},preserve_data:{type:"boolean",title:"Preserve Data",default:!1},show_data:{type:"boolean",title:"Show Data",default:!1}}},this.on("contextmenu",(function(e,t){ji.contextMenu({selector:"body",events:{hide:function(){ji.contextMenu("destroy")}},callback:ji.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){o.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){o.toogleOutConn()}),10);break;case"import":setTimeout((function(){var e=document.createElement("input");e.type="file",e.click(),e.onchange=function(e){var t=e.target.files||[];if(t.length){var a=t[0];console.time();var n=new FileReader;n.onloadend=function(e){var t=n.result,a=Ni.read(t,{type:"array",cellDates:!0});console.timeEnd();var i=a.SheetNames[0],r=a.Sheets[i],s=Ni.utils.sheet_to_row_object_array(r);console.log("getData - data loaded","Sample data:",s.slice(0,2)),s&&s.length>0&&(s=s.map((function(e){if("object"===Fi(e)&&null!==e){var t={};return Object.keys(e).forEach((function(a){var n=e[a];t[a]=null!=n?"object"===Fi(n)?JSON.stringify(n):String(n):""})),t}return e}))),Mi.options.columnlookup=s.length;var l=Mi("RECORDSET OF SELECT * from ?",[s]).columns;console.log("Columns detected:",l.map((function(e){return e.columnid}))),o.userData.table_col_spec=[],o.userData.sites_list_out=s,l.forEach((function(e){o.userData.table_col_spec.push({name:e.columnid,formatting:"none",prefix:"",affix:"",bg_color:"#fff",fn_color:"#000",font_type:"Tahoma, Geneva",font_size:"12px",totals:"none",width:"auto"})})),o.loadData(s,!0)},n.readAsArrayBuffer(a)}}}),10);break;case"edit":setTimeout((function(){n.editor.editTable(o)}),10);break;case"excel":setTimeout((function(){Ri.exportArrayToExcel(o.userData.sites_list_out)}),10)}}),this),x:t.x,y:t.y,items:{toogleInCon:{name:"Toogle In Connections"},toogleOutCon:{name:"Toogle Out Connections"},import:{name:"Import"},edit:{name:"Edit"},sep1:"---------",excel:{name:"Export To Excel"}}})})),this.GetHTTPData=function(e){this.userData.data_source&&"alasql"===this.userData.data_source?setTimeout((function(){o.loadData(o.userData.sites_list_out,e)}),200):this.userData.data_source&&"table"===this.userData.data_source?o.loadTableData():this.updateTable()},this.updateTable=function(){o.userData.col.length>0&&(o.userData.sites_list_out=[],o.userData.col.forEach((function(e,t){o.userData.sites_list_out.push.apply(o.userData.sites_list_out,e.sites_list_out)})),o.userData.sites_list_out.length&&o.setNewData()),this.getPort("output0").setUserData({project:this.project||"",scope:this.scope||"",item_name:"table",task_type:this.userData.table_name||"table",sites_list_out:this.userData.sites_list_out}),this.getOutputPort(0).getConnections().each(ji.proxy((function(e,t){t.getTarget().setValue(this.getId()),t.setColor("#6d6d6d")}),this))},this.setNewData=function(){if(o.userData.show_data)if(o.setDimension(o.userData.size.width,o.userData.size.height),o.originalWidth=o.userData.size.width,o.originalHeight=o.userData.size.height,o.userData.table_col_spec.length>0)o.userData.table_col_spec.forEach((function(e,t){e.data=[],e.data.push.apply(e.data,o.userData.sites_list_out.map((function(t){return t[e.name]})))})),this.ratable=ko.init(this),o.userData.table_col_spec.forEach((function(e,t){delete e.data})),o.svgNodes.remove(),o.svgNodes=this.ratable.svg_nodes,o.applyTransformation(),o.repaint();else{var e=this.createSet();o.svgNodes.remove(),o.svgNodes=e,o.applyTransformation(),o.repaint()}else{var t={width:250,height:30};o.setDimension(t.width,t.height),o.originalWidth=t.width,o.originalHeight=t.height,this.canvas.paper.setStart();var a=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,o.userData.table_name+" "+o.userData.sites_list_out.length+" rec.");a.attr({fill:"#777",stroke:"none",opacity:.8,"font-size":14,"font-weight":"bold"}),a.hover((function(){a.stop().animate({opacity:1},500,"elastic")}),(function(){a.stop().animate({opacity:.8},500,"elastic")})),a.getBBox(),this.frame=this.canvas.paper.rect(0,0,250,30,10).attr({stroke:"#6d6d6d","stroke-width":2}).toBack(),e=this.canvas.paper.setFinish(),o.svgNodes.remove(),o.svgNodes=e,o.applyTransformation(),o.repaint()}},this.setNewDataReplace=function(e){o.svgNodes.remove(),o.svgNodes=e,o.applyTransformation(),o.repaint()},this.getRealCount=function(){return 1},this.startAnimation=function(e){this.canvas.paper.setStart();var t,a,n,o,i=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading...");i.attr({fill:"#777",stroke:"none",opacity:0,"font-size":14,"font-weight":"normal"}),t=Raphael.animation((a={opacity:0},o=1,(n=function(e){var t=function(e){if("object"!=Fi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=Fi(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fi(t)?t:t+""}(n="opacity"))in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o,a),1e3),i.animate(t.repeat(e));var r=i.getBBox();this.frame=this.canvas.paper.rect(0,0,250,r.height+10,10).attr({stroke:"#6d6d6d","stroke-width":2}).toBack();var s=this.canvas.paper.setFinish();this.setNewDataReplace(s)},o.userData.col=[]},loadData:function(e,t){try{Mi("DROP TABLE IF EXISTS "+this.userData.table_name)}catch(e){}Mi("CREATE TABLE "+this.userData.table_name),Mi("INSERT INTO "+this.userData.table_name+" select * from ?",[e]),console.log("getData - data imported into "+this.userData.table_name," time: "+new Date),this.userData.sites_list_out=e,this.userData.sites_list_out.length&&this.setNewData(),this.getPort("output0").setUserData({project:this.project||"",scope:this.scope||"",item_name:"table",task_type:this.userData.table_name||"table",sites_list_out:this.userData.sites_list_out}),t||this.userData.updateBlock||this.getOutputPort(0).getConnections().each(ji.proxy((function(e,t){t.getTarget().setValue(this.getId()),t.setColor("#6d6d6d")}),this))},loadTableData:function(){var e,t=this,a=this.userData.source_table_id;this.userData.source_report_id&&this.userData.source_table_id&&(this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=ji.ajax({url:i().context+"/mongo/getData?file_name="+this.userData.source_report_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"GET",success:function(n){if((e=(e=JSON.parse(n.jsonText)).filter((function(e){return e.id===a})))[0])try{var o=e[0].userData.sites_list_out,i=Bi.getRawData(o);console.log("[RaTablenode] Loading table data from source table:","compressed:",Bi.isCompressed(o),"records:",Array.isArray(i)?i.length:0),Mi("DROP TABLE IF EXISTS "+t.userData.table_name),Mi("CREATE TABLE "+t.userData.table_name),Mi("INSERT INTO "+t.userData.table_name+" select * from ?",[i]),console.log("getData - data imported into "+t.userData.table_name," time: "+new Date),t.userData.sites_list_out=i,t.userData.table_col_spec=e[0].userData.table_col_spec,t.setNewData(),t.getPort("output0").setUserData({project:t.project||"",scope:t.scope||"",item_name:"table",task_type:t.userData.table_name||"table",sites_list_out:i}),t.getOutputPort(0).getConnections().each(ji.proxy((function(e,a){a.getTarget().setValue(t.getId()),a.setColor("#6d6d6d")}),t))}catch(e){console.log(e)}}}))},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1){var a;this.startAnimation(1e3),void 0!==(null===(a=e.userData)||void 0===a?void 0:a.realCount)?this.updateTickets=this.updateTickets+e.userData.realCount:this.updateTickets=this.updateTickets+1,console.log("Table node update ticket received, id:"+this.id+" "+this.updateTickets);var n=0;this.userData.conn_count?n=this.userData.conn_count:this.getInputPorts().data.forEach((function(e,t){n+=e.getConnections().data.length})),this.updateTickets>=n&&this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(ji.proxy((function(e,a){var n=a.getTarget();n.userData||(n.userData={}),n.userData.realCount=t.getRealCount(),n.setValue("ticket,"+t.id+","+t.userData.label),a.setColor("#dfdfdf")}),this))}))}else{if(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),console.log("'table' update data received id:"+this.id+" "+this.updateTickets),!(this.userData.data_source&&"connections"!==this.userData.data_source||"chartInput0"!==e.name&&"chartInput1"!==e.name)){var o="chartInput0"===e.name?0:1;this.getInputPort(o).getConnections().data.forEach((function(e,a){var n=e.getSource(),o=n.getParent().getId(),i=-1;t.userData.col.forEach((function(e,t){e.owner_id===o&&(i=t)}));var r;r=void 0!==t.userData.col[i]?Li.extend(!0,{},t.userData.col[i].serie):{name:n.userData.item_name,type:"line",areaStyle:{normal:{}},data:[]},i>-1&&t.userData.col.splice(i,1);var s=n.userData;s.serie=r,s.owner_id=o,t.userData.col.push(s),t.project=n.getUserData().project,t.scope=n.getUserData().scope,t.sop=n.getUserData().sop,t.updateTable()}))}this.updateTickets<=0&&this.GetHTTPData()}},createSet:function(){this.canvas.paper.setStart();var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data...");return e.attr({fill:"#777",stroke:"none",opacity:.8,"font-size":14,"font-weight":"bold"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.8},500,"elastic")})),this.frame=this.canvas.paper.rect(0,0,250,30,10).attr({stroke:"#6d6d6d","stroke-width":2}).toBack(),this.canvas.paper.setFinish()},applyAlpha:function(){},addPort:function(e,t){return this._super(e,t),e},getPersistentAttributes:function(){var e=this._super();if(e.userData&&e.userData.sites_list_out&&Array.isArray(e.userData.sites_list_out)){console.log("[RaTablenode] Compressing sites_list_out for serialization:",e.userData.sites_list_out.length,"records"),e.userData=ji.extend(!0,{},e.userData);var t=JSON.stringify(e.userData.sites_list_out).length;e.userData.sites_list_out=Bi.compress(e.userData.sites_list_out,e.userData.table_col_spec);var a="string"==typeof e.userData.sites_list_out?e.userData.sites_list_out.length:JSON.stringify(e.userData.sites_list_out).length;console.log("[RaTablenode] Compression ratio:",Math.round(100*(1-a/t))+"%","reduction (",t,"→",a,"bytes)")}return e},setPersistentAttributes:function(e){if(this._super(e),this.userData&&this.userData.sites_list_out&&Bi.isCompressed(this.userData.sites_list_out)){console.log("[RaTablenode] Decompressing sites_list_out from serialization");var t=this.userData.sites_list_out,a=Bi.decompress(t);Array.isArray(a)?(this.userData.sites_list_out=a,console.log("[RaTablenode] Decompressed",t.length,"bytes to",a.length,"records")):console.warn("[RaTablenode] Decompression failed, keeping original data")}}}),a("ef18a979f03f74f72e6f"),a("d3805c5536dd4d0fa681"),a("207688a7407ed28dff76"),a("ea40259be55748181c7f");var zi=a("a45670b3d8fb79ec0258");c().shape.fishbone.basic.Rect=c().shape.basic.Rectangle.extend({NAME:"draw2d.shape.fishbone.basic.Rect",INFO:"{Class: <strong>draw2d.shape.fishbone.basic.Rect</strong>}<br/><br/>",init:function(e,t,a){var n=this;this._super(zi.extend({x:100,y:10,bgColor:"#ffffff",alpha:1,width:100,height:60,radius:10,stroke:2},e),t,a),this.setterWhitelist=zi.extend(this.setterWhitelist,{fill_opacity:this.setFill_opacity},t),this.getterWhitelist=zi.extend(this.getterWhitelist,{fill_opacity:this.getFill_opacity},a),this.fill_opacity=1,this.on("contextmenu",(function(e,t){zi.contextMenu({selector:"body",events:{hide:function(){zi.contextMenu("destroy")}},callback:zi.proxy((function(e,t){switch(e){case"add_input_port":setTimeout((function(){var e=new(c().InputPort);e.setConnectionDirection(3),n.addPort(e,new(c().layout.locator.InputPortLocator)),n.repaint()}),10);break;case"add_output_port":setTimeout((function(){var e=new(c().OutputPort);e.setConnectionDirection(1),n.addPort(e,new(c().layout.locator.OutputPortLocator)),n.repaint()}),10)}}),this),x:t.x,y:t.y,items:{add_input_port:{name:"Add Input Port"},add_output_port:{name:"Add Output Port"}}})})),null===this.getUserData()&&this.attr({userData:{hidden:!1,index:0}}),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0}}}},getFill_opacity:function(){return this.fill_opacity},setFill_opacity:function(e){return this.fill_opacity=e,this.fireEvent("change:transparent",{value:this.x}),this.repaint(),this},updateUI:function(e){this.outputPorts.each((function(e,t){return t.locator.relocate(e,t)})),this.inputPorts.each((function(e,t){return t.locator.relocate(e,t)})),this.repaint()},repaint:function(e){if(!0!==this.repaintBlocked&&null!==this.shape)return e=zi.extend({},{width:this.getWidth(),height:this.getHeight(),r:this.getRadius()},e),null!==this.dasharray&&(e["stroke-dasharray"]=this.dasharray),null!==this.fill_opacity&&(e["fill-opacity"]=this.fill_opacity),this._super(e),this},getPersistentAttributes:function(){var e=this._super();return null!==this.dasharray&&(e.dasharray=this.dasharray),null!==this.fill_opacity&&(e.fill_opacity=this.fill_opacity),e},setPersistentAttributes:function(e){return this._super(e),"string"==typeof e.dasharray&&(this.dasharray=e.dasharray),"string"==typeof e.fill_opacity&&(this.fill_opacity=parseFloat(e.fill_opacity)),"number"==typeof e.fill_opacity&&(this.fill_opacity=e.fill_opacity),this}});var Hi=a("a45670b3d8fb79ec0258");c().shape.fishbone.basic.Oval=c().shape.basic.Circle.extend({NAME:"draw2d.shape.fishbone.basic.Oval",INFO:"{Class: <strong>draw2d.shape.fishbone.basic.Oval</strong>}<br/><br/>",init:function(e,t,a){this._super(Hi.extend({x:100,y:10,bgColor:"#ffffff",alpha:1,stroke:2},e),t,a),this.setterWhitelist=Hi.extend(this.setterWhitelist,{fill_opacity:this.setFill_opacity},t),this.getterWhitelist=Hi.extend(this.getterWhitelist,{fill_opacity:this.getFill_opacity},a),this.fill_opacity=1;var n=this;this.on("contextmenu",(function(e,t){Hi.contextMenu({selector:"body",events:{hide:function(){Hi.contextMenu("destroy")}},callback:Hi.proxy((function(e,t){switch(e){case"add_input_port":setTimeout((function(){var e=new(c().InputPort);e.setConnectionDirection(3),n.addPort(e,new(c().layout.locator.InputPortLocator)),n.repaint()}),10);break;case"add_output_port":setTimeout((function(){var e=new(c().OutputPort);e.setConnectionDirection(1),n.addPort(e,new(c().layout.locator.OutputPortLocator)),n.repaint()}),10)}}),this),x:t.x,y:t.y,items:{add_input_port:{name:"Add Input Port"},add_output_port:{name:"Add Output Port"}}})})),null===this.getUserData()&&this.attr({userData:{hidden:!1,index:0}}),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0}}}},getFill_opacity:function(){return this.fill_opacity},setFill_opacity:function(e){return this.fill_opacity=e,this.fireEvent("change:transparent",{value:this.x}),this.repaint(),this},updateUI:function(e){this.outputPorts.each((function(e,t){return t.locator.relocate(e,t)})),this.inputPorts.each((function(e,t){return t.locator.relocate(e,t)})),this.repaint()},repaint:function(e){if(!0!==this.repaintBlocked&&null!==this.shape)return e=Hi.extend({},{width:this.getWidth(),height:this.getHeight(),r:this.getRadius()},e),null!==this.dasharray&&(e["stroke-dasharray"]=this.dasharray),null!==this.fill_opacity&&(e["fill-opacity"]=this.fill_opacity),this._super(e),this},getPersistentAttributes:function(){var e=this._super();return null!==this.dasharray&&(e.dasharray=this.dasharray),null!==this.fill_opacity&&(e.fill_opacity=this.fill_opacity),e},setPersistentAttributes:function(e){return this._super(e),"string"==typeof e.dasharray&&(this.dasharray=e.dasharray),"string"==typeof e.fill_opacity&&(this.fill_opacity=parseFloat(e.fill_opacity)),"number"==typeof e.fill_opacity&&(this.fill_opacity=e.fill_opacity),this}}),a("ffc1410f5beab600c272"),a("b0e0ab7134eab0eaea07"),a("3b9540f14a87b93e9727"),a("ea0a1bcc6a0384be39dd"),a("0e8d7d7a4544b88ffebe"),a("493d9fae3cf8c8c702ff"),a("91d67ebe639bc5023d4d");var qi=a("a45670b3d8fb79ec0258"),Vi=a("8deafab7866a125bb9ca");function Wi(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return Gi(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Gi(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,Gi(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,Gi(d,"constructor",c),Gi(c,"constructor",l),l.displayName="GeneratorFunction",Gi(c,o,"GeneratorFunction"),Gi(d),Gi(d,o,"Generator"),Gi(d,n,(function(){return this})),Gi(d,"toString",(function(){return"[object Generator]"})),(Wi=function(){return{w:i,m:p}})()}function Gi(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Gi=function(e,t,a,n){function i(t,a){Gi(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},Gi(e,t,a,n)}function Ji(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function Qi(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){Ji(i,n,o,r,s,"next",e)}function s(e){Ji(i,n,o,r,s,"throw",e)}r(void 0)}))}}c().shape.fishbone.cell.Mathnode=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Mathnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Mathnode</strong>}<br/><br/>\tThis is simple node witch will execute function in 'do' property. This function should return array of sites list normally in format \n{\n\tsite_id: '0000A',\n\ttask_name: 'Site Name',\n\ttask_type: 'task type',\n\tmy_date: '2017/01/01')\n}\n",init:function(e,t,a,n){this._super(qi.extend({color:"#9a9a9a",filter_str:"Math"},e),t,a,n);var o=this;qi.extend(this.userData,{do:"()=>{\n\n}",sites_list_out:[],label:"New Label",type_name:"math"}),qi.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{do:{type:"string",title:"do",format:"ace",aceMode:"ace/mode/javascript",disableWorker:!1,AItools:{sender:"spec",tools:["left","gen","edit","opti","save_lib","load_lib","right"]}},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"add"}}}),this.getCommonPrompt=function(){return' Requirements:\n                 - use this code to get data inside visualization code- "let data = dataFactory.getData()"\n                    - refer to data dataset array structure as this:\n                    [\n                    {\n                        "name": first dataset name,\n                        "values": [first dataset values array]\n                    },\n                    {\n                        "name": second dataset name,\n                        "values": [second dataset values array]\n                    },\n                - Provide JavaScript code that performs mathematical operations or data transformations\n                - The code should be wrapped in an arrow function: ()=>{ }\n                - The code should return a result that can be passed to connected nodes\n                - Strictly follow JavaScript specification\n                - Remove code fencing (the triple backticks and language identifier) from result\n                - Do not include ```javascript``` or ```json``` or any other code tags \n                - Provide complete JavaScript function without any additional explanations\n                \n                Available Libraries:\n                - Lodash is available as underscore (_) for utility functions: _.groupBy(), _.sortBy(), _.chunk(), _.debounce(), etc.\n                - Chart.js for creating charts: Chart (Chart.register, new Chart, etc.)\n                - Moment.js for date manipulation: moment()\n                - D3.js for advanced data operations: d3\n                - Other utilities: vega, echarts, alasql\n                \n                Validation:\n                - Ensure valid JavaScript syntax\n                - Verify all required fields are present\n                - Check property name consistency\n                - All data generation has to be dynamic\n                - Validate data references\n                '},this.getData=function(){var e=[];return o.userData.row&&o.userData.row.length>0&&o.userData.row.forEach((function(t,a){t&&t.sites_list_out&&e.push({name:t.item_name,values:t.sites_list_out})})),e};var i={getData:this.getData};this.AI||(this.AI={}),this.AI.do||(this.AI.do={}),this.AI.do.generateAI=function(e){var t=[];o.userData.row.forEach((function(e,a){t.push({name:e.item_name,values:e.sites_list_out.slice(0,10)})}));var a="\n                You are an expert JavaScript developer specializing in mathematical operations and data transformation.\n                Help me create JavaScript code to process the provided data according to requirements below:\n \n                ".concat(JSON.stringify(t),"\n                ")+o.getCommonPrompt();DEBUG&&console.log(a);var n={chatUuid:"",chatName:"",text:a};Vi.handleRegularResponse(n,o,e,o.userData.do,"do")},this.AI.do.editAI=function(e){var t=prompt("Please specify your requirements:","");if(t){var a,n,i,r,s,l=[];o.userData.row.forEach((function(e,t){l.push({name:e.item_name,values:e.sites_list_out.slice(0,10)})}));var c="\n                Please help me update JavaScript code according to my data array: \n                \n                ".concat(JSON.stringify(l),"\n                \n                current code:\n                ").concat(o.userData.do,"\n                \n                user input:\n                ").concat(t,"\n                \n                and ")+o.getCommonPrompt();DEBUG&&console.log(c);var u={chatUuid:(null===(a=o.AI)||void 0===a||null===(a=a.do)||void 0===a?void 0:a.chatUuid)||"",chatName:(null===(n=o.AI)||void 0===n||null===(n=n.do)||void 0===n?void 0:n.chatName)||"",stream:!1,keep:(null===(i=o.userData.ai)||void 0===i||null===(i=i.do)||void 0===i?void 0:i.keep)||!0,text:c,temperature:(null===(r=o.userData.ai)||void 0===r||null===(r=r.do)||void 0===r?void 0:r.temperature)||.3,model:(null===(s=o.userData.ai)||void 0===s||null===(s=s.do)||void 0===s?void 0:s.model)||"NTele-72B"};Vi.handleRegularResponse(u,o,e,o.userData.do,"do")}},this.AI.do.optiAI=function(e){var t,a,n=[];o.userData.row.forEach((function(e,t){n.push({name:e.item_name,values:e.sites_list_out.slice(0,10)})}));var i="\n                Please help me to check and optimize the JavaScript code according to my data array: \n                \n                ".concat(JSON.stringify(n),"\n                \n                current code:\n                ").concat(o.userData.do,"\n                \n                Please fix any possible issues:\n                - Remove any text explanations\n                - Fix syntax errors\n                - Improve code efficiency and readability\n                - Remove code fencing (the triple backticks and language identifier) from result\n                - Remove ```javascript``` or ```json``` or any other code tags\n                - Verify all required fields are present\n                ");DEBUG&&console.log(i);var r={chatUuid:(null===(t=o.AI)||void 0===t||null===(t=t.do)||void 0===t?void 0:t.chatUuid)||"",chatName:(null===(a=o.AI)||void 0===a||null===(a=a.do)||void 0===a?void 0:a.chatName)||"",text:i};Vi.handleRegularResponse(r,o,e,o.userData.do,"do")},this.updateTable=Qi(Wi().m((function e(){var t,a,n,r,s;return Wi().w((function(e){for(;;)switch(e.n){case 0:if(t=o.userData.do,!(a=Vi.safeEval(t,o,{dataFactory:i})).success){e.n=4;break}if(!(a.result instanceof Promise)){e.n=2;break}return e.n=1,a.result;case 1:s=e.v,e.n=3;break;case 2:s=a.result;case 3:(n=s)?(o.userData.sites_list_out=n,o.userData.value=o.userData.sites_list_out.length?o.userData.sites_list_out.length:"ok"):o.userData.value="ok",(r=o.getPort("output0")).setUserData({project:o.project,scope:o.scope,sop:o.sop,item_name:o.userData.label,task_type:o.userData.type_name||"math",sites_list_out:n}),r.getConnections().each(qi.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),this.updateUI(),e.n=5;break;case 4:console.log(a.error);case 5:return e.a(2)}}),e,this)})))}});var Yi=a("c76077976aea7b2d1b64"),Xi=a("82fc3aeeb8f5964c98c9"),Ki=(a("b0e166652575061a93e8"),a("26f02305f15d87474416")),Zi=a("a45670b3d8fb79ec0258"),$i=a("8deafab7866a125bb9ca");c().shape.fishbone.cell.D3node=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.D3node",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.D3node</strong>}<br/><br/>\tThis is simple node witch will execute function in 'do' property. This function should return array of sites list normally in format \n{\n\tsite_id: '0000A',\n\ttask_name: 'Site Name',\n\ttask_type: 'task type',\n\tmy_date: '2017/01/01')\n}\n",init:function(e,t,a,n){this._super(Zi.extend({color:"#cd9949",filter_str:"D3"},e),t,a,n);var o=this;Zi.extend(this.userData,{do:"()=>{\n\n}",sites_list_out:[],label:"New Label",type_name:"D3"}),Zi.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{cont_id:{title:"Container ID",type:"string"},do:{type:"string",title:"do",format:"ace",aceMode:"ace/mode/javascript",AItools:{sender:"spec",tools:["left","gen","edit","opti","save_lib","load_lib","right"]}},height:{title:"Chart Height",type:"string"},label:{type:"string",format:"hidden",default:"D3 Viz"},type_name:{type:"string",title:"Type Name",default:"add"}}}),this.getCommotPrompt=function(){return' Requirements:\n            - use this code to get data inside visualization code- "let data = dataFactory.getData()"\n            - refer to data dataset array structure as this:\n            [\n            {\n                "name": first dataset name,\n                "values": [first dataset values array]\n            },\n            {\n                "name": second dataset name,\n                "values": [second dataset values array]\n            },\n            .\n            .\n            .\n            ]\n            - use this ID '.concat(o.userData.cont_id," as visualization container in d3.select()\n            - Strictly follow javascript specification\n            - remove code fencing (the triple backticks and language identifier) from result\n            - Do not include ```javascript``` or ```json``` or any other code tags and without code fencing\n            - make decision on chart type and configuration according to data structure and its nature\n            - provide most suitable, vibrant and coherent visualization\n            - Strictly provide complete javascript configuration function without any additional explanations.\n              Validation:\n            - Ensure valid javascript syntax\n            - Verify all required fields are present\n            - Ensure valid fields references\n            - Do not use any static data references\n            - All data generation has to be dynamic\n            - Check property name consistency\n            - Validate data references\n            - Wrap visualization code into function like ()=>{}\n\n            ")},this.getData=function(){var e=[];return o.userData.row.forEach((function(t,a){e.push({name:t.item_name,values:t.sites_list_out})})),e};var i={getData:this.getData};this.AI||(this.AI={}),this.AI.do||(this.AI.do={}),this.AI.do.generateAI=function(e){var t=[];o.userData.row.forEach((function(e,a){t.push({name:e.item_name,values:e.sites_list_out.slice(0,10)})}));var a="\n            You are an expert data analyst and D3.js visualization specialist. \n            Help me analyze the provided dataset and create insightful visualizations according to requirements below:\n \n            ".concat(JSON.stringify(t),"\n            ")+o.getCommotPrompt();DEBUG&&console.log(a);var n={chatUuid:"",chatName:"",text:a};$i.handleRegularResponse(n,o,e,o.userData.do,"do")},this.AI.do.editAI=function(e){var t=prompt("Please specify your requirements:","");if(t){var a,n,i=[];o.userData.row.forEach((function(e,t){i.push({name:e.item_name,values:e.sites_list_out.slice(0,10)})}));var r="\n            Please help me update an D3 visualization according to my data array: \n            \n            ".concat(JSON.stringify(i),"\n            \n            current spec :\n            ").concat(o.userData.do,"\n            \n            user input:\n            ").concat(t,"\n            \n            and ")+o.getCommotPrompt();DEBUG&&console.log(r);var s={chatUuid:(null===(a=o.AI)||void 0===a||null===(a=a.do)||void 0===a?void 0:a.chatUuid)||"",chatName:(null===(n=o.AI)||void 0===n||null===(n=n.do)||void 0===n?void 0:n.chatName)||"",text:r};$i.handleRegularResponse(s,o,e,o.userData.do,"do")}},this.AI.do.optiAI=function(e){var t,a,n=[];o.userData.row.forEach((function(e,t){n.push({name:e.item_name,values:e.sites_list_out.slice(0,10)})}));var i="\n            Please help me to check an D3 visualization according to my data array: \n            \n            ".concat(JSON.stringify(n),"\n            \n            and current spec :\n            ").concat(o.userData.do,'\n            \n            and fix any possible issues:\n            - remove any text explanations\n            - make sure there is "name" property in data objects properly refer to provided data name\n            - fix syntax errors\n            - fix JSON format issues\n            - remove code fencing (the triple backticks and language identifier) from result\n            - remove ```javascript``` or ```json``` or any other code tags\n            - Verify all required fields are present\n            ');DEBUG&&console.log(i);var r={chatUuid:(null===(t=o.AI)||void 0===t||null===(t=t.do)||void 0===t?void 0:t.chatUuid)||"",chatName:(null===(a=o.AI)||void 0===a||null===(a=a.do)||void 0===a?void 0:a.chatName)||"",text:i};$i.handleRegularResponse(r,o,e,o.userData.do,"do")},this.updateTable=function(){var e=o.userData.do,t=document.getElementById(o.userData.cont_id);if(t&&this.userData.do){t.innerHTML="",t.parentNode.querySelector(".spin")&&(t.parentNode.querySelector(".spin").classList.remove("show-loader"),t.parentNode.querySelector(".spin").classList.add("hide-loader")),o.userData.height?t.style.height=o.userData.height:t.style.height="auto";var a=$i.safeEval(e,o,{dataFactory:i});if(a.success){var n=o.getPort("output0");n.setUserData({project:o.project,scope:o.scope,sop:o.sop,item_name:o.userData.label,task_type:o.userData.type_name||"math",sites_list_out:a.result}),n.getConnections().each(Zi.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),this.updateUI()}else console.error("error: "+a.error)}}}});var er=a("a45670b3d8fb79ec0258");c().shape.fishbone.cell.Stylenode=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Stylenode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Stylenode</strong>}<br/><br/>\tThis is simple node witch will extend doc DOM structure with new/updated styles.",init:function(e,t,a,n){this._super(er.extend({color:"#9a9a9a",filter_str:"Style"},e),t,a,n);var o=this;er.extend(this.userData,{style:"",sites_list_out:[],label:"New Label",type_name:"style"}),er.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{style:{type:"string",title:"style",format:"ace",aceMode:"ace/mode/css",disableWorker:!1,AItools:{sender:"style",tools:["left","edit","opti","save_lib","load_lib","right"]}},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"style"}}}),this.updateTable=function(){if(this.userData.style){var e=document.createElement("style");e.innerHTML=this.userData.style,document.head.appendChild(e),o.getPort("output0").setUserData({project:o.project,scope:o.scope,sop:o.sop,item_name:o.userData.label,task_type:o.userData.type_name||"style",sites_list_out:[{result:"success"}]}),o.getOutputPort(0).getConnections().each(er.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),this.updateUI()}}}}),a("f4b5b697833049c3b379"),a("cfa19870fe890bea9cbe");var tr=a("8f26381ed0ec1cda1725"),ar=a("322e90626982c4310329"),nr=a("a45670b3d8fb79ec0258"),or=a("aeb57e88bcb04c329061"),ir=a("8deafab7866a125bb9ca");function rr(e){return rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rr(e)}function sr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function lr(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?sr(Object(a),!0).forEach((function(t){cr(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):sr(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function cr(e,t,a){return(t=function(e){var t=function(e){if("object"!=rr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=rr(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==rr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ur(e){return function(e){if(Array.isArray(e))return pr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||dr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(e,t){if(e){if("string"==typeof e)return pr(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?pr(e,t):void 0}}function pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var hr=a("b0e166652575061a93e8");c().shape.fishbone.cell.HTMLnode=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.HTMLnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.HTMLnode</strong>}<br/><br/>\tThis is simple node witch will extend doc DOM structure with new/updated styles.",init:function(e,t,a,n,o,i){this._super(nr.extend({color:"#9a9a9a",filter_str:"HTML",data_type:"row"},e),t,a,n);var r=this;nr.extend(this.userData,{html:"",cont_id:"htmlCont1",sites_list_out:[],binder:"none",params:[],label:"New Label",type_name:"html"}),nr.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{cont_id:{type:"string",title:"Cont ID",default:"htmlCont1"},value:{type:"string",title:"Current Value",default:"0"},binder:{type:"string",title:"Data Binder",default:"rivets",enum:["rivets","AngularJS","none"]},params:or.template_params,html:{type:"string",title:"html",format:"ace",aceMode:"ace/mode/html",AItools:{sender:"html",tools:["left","edit","opti","save_lib","load_lib","right"]}},height:{title:"Chart Height",type:"string"},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"html"},no_auto_update:{type:"boolean",title:"Prevent Auto Update",default:!0}}}),this.AI||(this.AI={}),this.AI.html||(this.AI.html={}),this.AI.html.editAI=function(e){var t=prompt("Please provide your requirements:","");if(t){var a,n,o="\n            Please help me generate or update an html code according to current html code (if any):\n            ".concat(r.userData.html,"\n            \n            and my requirements:\n            ").concat(t,"\n            \n            ")+" Requirements:\n            - strictly return only html code without text explanation\n            - remove code fencing (the triple backticks and language identifier) from result\n            - Do not include ```javascript``` or ```json``` or any other code tags and without code fencing\n            - Please provide the complete JSON configuration object without any additional explanations.\n            - Indent code for better readability\n            ";DEBUG&&console.log(o);var i={chatUuid:(null===(a=r.AI)||void 0===a||null===(a=a.html)||void 0===a?void 0:a.chatUuid)||"",chatName:(null===(n=r.AI)||void 0===n||null===(n=n.html)||void 0===n?void 0:n.chatName)||"",text:o};ir.handleRegularResponse(i,r,e,r.userData.html,"html")}},this.AI.html.optiAI=function(e){var t="\n            Please help me analyze provided an html code :\n            ".concat(r.userData.html,"\n            \n            and fix any possible issues:\n            - remove any text explanations\n            - fix syntax errors\n            - properly indent code for better readability\n            - remove code fencing (the triple backticks and language identifier) from result\n            - remove ```javascript``` or ```json``` or any other code tags\n            \n            return only html code without text explanation\n            ");DEBUG&&console.log(t);var a={chatUuid:"",chatName:"",text:t};ir.handleRegularResponse(a,r,e,r.userData.html,"html")},this.updateTable=function(){var e=r.getCanvas();if(!r.userData.no_auto_update||!e.silentMode){var t=r.userData.cont_id;"html-container"===r.userData.cont_id&&n.slide&&(t=r.userData.cont_id+"-"+n.slide.id);var a=document.getElementById(t);if(a&&this.userData.html){var i=function(){var e={};return c.forEach((function(t,a){if("checkbox"===t.type)e[t.name]=document.querySelector('[name="'+t.name+'"]').checked;else if("select"===t.tag){var n=nr("[name='"+t.name+"']").val();Array.isArray(n)&&n&&n.length?(e[t.name]="",e[t.name]=n.join()):e[t.name]=n}else e[t.name]=nr("[name='"+t.name+"']").val()})),[e]},s=ir.getScopeParams(this.userData);a.parentNode.querySelector(".spin")&&(a.parentNode.querySelector(".spin").classList.remove("show-loader"),a.parentNode.querySelector(".spin").classList.add("hide-loader")),r.userData.height?a.style.height=r.userData.height:"html-container"!==r.userData.cont_id&&(a.style.height="auto");var l,c=[];if(this.userData.html.indexOf("fb_options_input")>-1||this.userData.html.indexOf("fb_event")>-1){var u=document.createElement("div");u.innerHTML=this.userData.html,this.userData.html.indexOf("fb_options_input")>-1&&ur(u.querySelectorAll('select[fb_options_input]:not([fb_options_input=""])')).forEach((function(e,t){var a=e.getAttribute("fb_options_input");a&&r.userData.row[a].sites_list_out.forEach((function(t,a){var n=document.createElement("option");for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);e.appendChild(n)}))})),this.userData.html.indexOf("fb_event")>-1&&ur(u.querySelectorAll('form[fb_event], input[fb_event]:not([fb_event=""]), select[fb_event]:not([fb_event=""])')).forEach((function(e,t){c.push({name:e.getAttribute("name"),event:e.getAttribute("fb_event"),type:e.getAttribute("type"),tag:e.tagName.toLowerCase(),multiple:e.getAttribute("multiple")})})),l=u.innerHTML,u.remove()}else l=this.userData.html;var d=or.san_config;if("none"===this.userData.binder)a.innerHTML=Xt.A.sanitize(l,d);else if("rivets"===this.userData.binder){var p=function(e,t){setTimeout((function(){var a=function(e,t,a){var n=r.getCanvas().getFigure(e);if(n){var o=nr.extend(!0,{},n.full_spec);if(o){var i=Yi.findPath(o,(function(e){return e.name===a}));return Yi.updateByPath(o,i,(function(e){return lr(lr({},e),{},{values:t})}))}return null}}(t.vcId,t.vcData,t.vcDataName),n=e.firstChild;a&&n&&(0,Xi.Ay)(n,a,{actions:!1})}),100)},h=function(e,t){setTimeout((function(){var a=function(e,t,a){if(a){var n,o=ir.safeEval("()=>{return "+a+"}",r);if(o.success?n=o.result:console.log(o.error),n)return n.dataset&&!Array.isArray(n.dataset)||(n.dataset={}),n.dataset.source=t,n}else{var i=r.getCanvas().getFigure(e);if(i){var s=nr.extend(!0,{},i.option);return s?(s.dataset&&!Array.isArray(s.dataset)||(s.dataset={}),s.dataset.source=t,s):null}}}(t.ecId,t.ecData,t.ecOptions),n=e.firstChild;if(n){var o=Yt.init(n,t.ecTheme,{renderer:"canvas",useDirtyRect:!1,height:t.ecHeight,width:t.ecWidth});o.resize(),a&&"object"===rr(a)&&o.setOption(a),window.addEventListener("resize",o.resize)}}),100)},f=function(e,t){setTimeout((function(){var a=function(e,t,a){if(a){var n,o=ir.safeEval("()=>{return "+a+"}",r);if(o.success?n=o.result:console.log(o.error),n)return n.data=t,n}else{var i=r.getCanvas().getFigure(e);if(i){var s=nr.extend(!0,{},i.table.options);return s?(s.data=t,s):null}}}(t.tbId,t.tbData,t.tbOptions),n=e.firstChild;n&&a&&new ar.mu(n,a)}),100)};Xt.A.addHook("uponSanitizeAttribute",(function(e,t){(t.attrName.match(/^tb-/)||t.attrName.match(/^rv-/)||t.attrName.match(/^vc-/)||t.attrName.match(/^ec-/))&&(t.allowedAttributes[t.attrName]=!0)})),Xt.A.addHook("uponSanitizeElement",(function(e,t){t.tagName.match(/^rv-/)&&(t.allowedTags[t.tagName]=!0)})),a.innerHTML=Xt.A.sanitize(l,d),DEBUG&&console.log(a.innerHTML),this.rivets&&delete this.rivets,hr.components["rv-vega-chart"]={template:function(){return"<div></div>"},initialize:function(e,t){return new p(e,t)}},hr.components["rv-echarts"]={template:function(){return"<div></div>"},initialize:function(e,t){return new h(e,t)}},hr.components["rv-tabulator"]={template:function(){return"<div></div>"},initialize:function(e,t){return new f(e,t)}},this.rivets=hr.bind(nr(a),{params:s})}else if("AngularJS"===this.userData.binder){Xt.A.addHook("uponSanitizeAttribute",(function(e,t){t.attrName.match(/^ng-/)&&(t.allowedAttributes[t.attrName]=!0)})),angular.element(a).empty(),n[this.userData.label]={},n[this.userData.label]=s;var m=Xt.A.sanitize(this.userData.html,d);DEBUG&&console.log(m),angular.element(a).append(o(m)(n)),n.$$phase||n.$apply()}c.length&&c.forEach((function(e,t){var a=nr('[name="'+e.name+'"]')[0];a&&("form"===e.tag?a.onsubmit=function(t){t.preventDefault();var n,o=new FormData(a),i=(nr('[name="'+e.name+'"]').serialize(),{}),s=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=dr(e))){t&&(e=t);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,r=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){r=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(r)throw o}}}}(o);try{for(s.s();!(n=s.n()).done;){var l=n.value;i[l[0]]?i[l[0]]=i[l[0]]+","+l[1]:i[l[0]]=l[1]}}catch(e){s.e(e)}finally{s.f()}r.send_result([i],!0)}:a.addEventListener(e.event,(function(e){r.send_result(i(),!0)})))})),this.userData.value="#",this.send_result(i()),(0,Ki.XN)("select[multiple='multiple']",{renderOptionLabelAsHtml:!0,textTemplate:function(e){return"".concat(e.innerHTML)}}),document.querySelectorAll(".pie").forEach((function(e){return peity(e,"pie")})),document.querySelectorAll(".donut").forEach((function(e){return peity(e,"donut")})),document.querySelectorAll(".line").forEach((function(e){return peity(e,"line")})),document.querySelectorAll(".bar").forEach((function(e){return peity(e,"bar")})),document.querySelectorAll(".bar-colours-1").forEach((function(e){return peity(e,"bar",{fill:["red","green","blue"]})})),document.querySelectorAll(".bar-colours-2").forEach((function(e){return peity(e,"bar",{fill:function(e){return e>0?"green":"red"}})})),document.querySelectorAll(".bar-colours-3").forEach((function(e){return peity(e,"bar",{fill:function(e,t,a){return"rgb(255, "+parseInt(t/a.length*255)+", 0)"}})})),document.querySelectorAll(".pie-colours-1").forEach((function(e){return peity(e,"bar",{fill:["cyan","magenta","yellow","black"]})})),document.querySelectorAll(".pie-colours-2").forEach((function(e){return peity(e,"bar",{fill:function(e,t,a){return"rgb(255, "+parseInt(t/a.length*255)+", 0)"}})}))}}},this.send_result=function(e,t){t&&r.getOutputPorts().data.forEach((function(e,t){e.getConnections().each(nr.proxy((function(e,t){var a=t.getTarget();a.userData||(a.userData={}),a.userData.realCount=1,a.superUpdate=!0,t.setColor("#dfdfdf"),DEBUG&&console.log(r.NAME+" id:"+r.id+" "+r.userData.label+" update ticket send: to: "+a.getParent().userData.label+", Super: "+a.superUpdate),a.setValue("ticket,"+r.id+","+r.userData.label)}),this))})),r.getPort("output0").setUserData({project:r.project,scope:r.scope,sop:r.sop,item_name:r.userData.label,task_type:r.userData.type_name||"html",sites_list_out:e}),r.getOutputPort(0).getConnections().each(nr.proxy((function(e,t){t.getTarget().setValue(r.getId()),t.setColor(r.frame.attr("stroke"))}),this)),this.updateUI()}},loadTreema:function(){ir.updateParamSourceCol(this),ir.updateParamDetailsCol(this),ir.updatePropKeyCol(this),this._super(this)}}),a("cec8687ba75900ecbd7e");var fr=a("8a868d10b6533e768658"),mr=a("a45670b3d8fb79ec0258"),gr=a("aeb57e88bcb04c329061"),yr=a("d1be49724a1f416e7f57"),_r=a("a45670b3d8fb79ec0258"),br=a("8deafab7866a125bb9ca"),vr=a("a7583c9a3ff76b2fdd52");function wr(e){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wr(e)}fr.shape.fishbone.ra.RaPivotnode_new=fr.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaPivotnode_new",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaPivotnode_new</strong>}<br/><br/>",init:function(e,t,a,n){this._super(mr.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a),this.sscope=n,this.dx=0,this.dy=0,this.D_ATTRIBUTES=["Year","Month","Week","Day","Aging days","Aging w.days","Aging range","Aging 3 range"],this.FIELDS=[];var o=this;this.sites_list_in=[],this.updateTickets=0,this.updateRequests=0;var i,r,s,l=this.getUserData();this.default_user_data={label:"pivot_table",hidden:!0,renderer:"Ra Segment Table",aggregator:{name:"Count",vals:[]},toolbar:{buttons:{table:!0,linechart:!0,barchart:!0,save:!0,save_pic:!0,data:!0,refresh:!0,left:!1,right:!1},location:"top",show:!0},size:{width:800,height:300},grid:mr.extend(!0,{},default_grid),pivot:{d_attributes:(i=[],this.D_ATTRIBUTES.forEach((function(e,t){i.push({name:e,show:!1,value:"my_date"})})),i),colors:{data_color:"#8c8c8c",labels_color:"#4c4c4c",frame_color:"#4c4c4c",monochromatic:!1,mono_base_color:"#ffffff",colors_array:[]},chart:{series:[],toolbar:mr.extend(!0,{},default_toolbar),title:mr.extend(!0,{},default_title),title_left:mr.extend(!0,{},default_title_left),title_right:mr.extend(!0,{},default_title_right),data_table:mr.extend(!0,{},default_data_table),xAxis:mr.extend(!0,{},default_xAxis,{labels:{multi_line:!1,separator:"-"}}),yAxis:mr.extend(!0,{},default_yAxis)},full_j:!1,multi_line_max:400,fonts:{data_font:{font_size:12,font_color:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal"},titles_font:{font_size:12,font_color:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold"},totals_font:{font_size:12,font_color:"#8c8c8c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold"}},table:{rows:10,columns:10,style:{}},aging:{first_lim:5,second_lim:10},performance:gr.defaul_performance.slice()},col:[],sorters:[{sort_field_name:"task_type",sort_list:["baseline","forecast","actual","difference","gap"]}],showInConnections:!0,showColTotals:!0,showRowTotals:!0,sites_list_out:[]},this.default_user_data.pivot.chart.toolbar.buttons.push({show:!0,name:"table",icon:"data:image/png;base64,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",onclick:function(){o.userData.renderer="Ra Segment Table",o.GetHTTPData()}}),null===l&&this.attr({userData:mr.extend({},this.default_user_data)}),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},not_refresh:{type:"boolean",title:"Do Not Refresh UI",default:!0},autoWidth:{type:"boolean",title:"Auto Width",default:!1},index:{type:"integer",title:"Mobile Index",default:0},label:{type:"string",default:"pivot_table"},toolbar:{type:"object",title:"Toolbar",properties:{buttons:{type:"object",title:"Toolbar",properties:{table:{type:"boolean",title:"table",default:!0},linechart:{type:"boolean",title:"line chart",default:!0},barchart:{type:"boolean",title:"bar chart",default:!0},save:{type:"boolean",title:"save",default:!0},save_pic:{type:"boolean",title:"save picture",default:!0},data:{type:"boolean",title:"data",default:!0},refresh:{type:"boolean",title:"refresh",default:!0},left:{type:"boolean",title:"left",default:!0},right:{type:"boolean",title:"right",default:!0},up:{type:"boolean",title:"up",default:!0},down:{type:"boolean",title:"down",default:!0},inc_acc:{type:"boolean",title:"incremental/accumulative",default:!0}}},location:{type:"string",default:"top"},show:{type:"boolean",title:"show",default:!0}}},renderer:{type:"string",title:"Renderer",enum:["Ra Segment Table","Line UChart","Bar UChart"]},aggregator:{additionalProperties:!1,type:"object",title:"Aggregator",properties:{name:{type:"string",title:"Aggregator",enum:["Count","Count If","Count Accumulative","Count Incremental-Accumulative","Sum Incremental-Accumulative","Count Unique Values","List Unique Values","List Unique Value (Format)","Performance","Sum","Integer Sum","Average","Minimum","Maximum","Running Totals","Sum over Sum","Count over Count","80% Upper Bound","80% Lower Bound","Sum as Fraction of Total","Sum as Fraction of Rows","Sum as Fraction of Columns","Count as Fraction of Total","Count as Fraction of Rows","Count as Fraction of Columns","Rating as Count in Rows","Rating as Count in Columns"]},vals:{additionalProperties:!1,type:"array",title:"Values",items:{type:"string"}},t_col_type:{title:"Column Totals Type",type:"string",enum:["count","sum","avg","min","max"]},t_row_type:{title:"Rows Totals Type",type:"string",enum:["count","sum","avg","min","max"]},num_format:gr.template_num_format}},size:{additionalProperties:!1,type:"object",title:"Size",properties:{width:{type:"integer",default:500},height:{type:"integer",default:300}}},grid:template_grid,pivot:{type:"object",title:"View Config",properties:{colors:{type:"object",title:"Colors",properties:{data_color:{type:"string",title:"Data Color",default:"#000"},labels_color:{type:"string",title:"Labels Color",default:"#000"},frame_color:{type:"string",title:"Frame Color",default:"#000"},monochromatic:{type:"boolean",title:"Is Monochromatic",default:!1},mono_base_color:{type:"string",title:"Monochromatic Color",default:"#fff"},colors_array:{additionalProperties:!1,type:"array",title:"Graph Color",items:{type:"string"}}}},date_format:{type:"string",title:"Date/Time Format",enum:["YYYY-MM-DD HH:mm","MM-DD HH:mm","YYYY-MM-DD","YY-MM-DD","DD HH:mm","dddd HH:mm","HH:mm"]},sortCols:{type:"boolean",format:"hidden",title:"Sort Columns",default:!0},sortRows:{type:"boolean",format:"hidden",title:"Sort Rows",default:!0},full_j:{type:"boolean",format:"hidden",title:"Full Joint",default:!1},multi_line_max:{type:"integer",default:400,title:"Multi Line column Width"},fonts:{type:"object",title:"Fonts Config",properties:{data_font:(r=template_font,s=mr.extend(!0,{},r),s.title="Data Font Style",s),titles_font:function(e){var t=mr.extend(!0,{},e);return t.title="Titles Font Style",t}(template_font),totals_font:function(e){var t=mr.extend(!0,{},e);return t.title="Totals Font Style",t}(gr.template_font)}},table:{type:"object",title:"Table Config",properties:{columns:{type:"integer",title:"Num Of Columns"},rows:{type:"integer",title:"Num Of Rows"},position_on_last_col:{type:"boolean",title:"Position on last Col"},position_on_last_row:{type:"boolean",title:"Position on last Row"},hide_vert_scroll_bar:{type:"boolean",title:"Hide Vert Scroll Bar"},hide_hor_scroll_bar:{type:"boolean",title:"Hide Horiz Scroll Bar"},style:{type:"object",title:"Style",properties:{banded_rows:{type:"boolean",title:"Banded Rows",default:!0},banded_cols:{type:"boolean",title:"Banded Columns",default:!0}}},do_not_wrap:{type:"boolean",title:"Do Not Wrap Rows Data",default:!0}}},chart:{type:"object",title:"Chart Config",properties:{series:{type:"array",title:"Series",items:template_serie},title:template_title,title_left:template_title_left,title_right:template_title_right,toolbar:template_toolbar,popup:template_popup,data_table:template_data_table,xAxis:mr.extend(!0,{},template_xAxis,{properties:{labels:{properties:{multi_line:{type:"boolean",title:"Multi Line Labels",default:!1},separator:{type:"string",title:"Separator",default:"-",enum:["-","/",",",".","|",":"]}}}}}),yAxis:template_yAxis}},aging:{type:"object",title:"Aging Setup",properties:{first_lim:{type:"number",title:"1st limit",default:5},second_lim:{type:"number",title:"2nd limit",default:10}}},performance:gr.template_performance}},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showColTotals:{type:"boolean",title:"Show Columns Total",default:!0},showRowTotals:{type:"boolean",title:"Show Rows Total",default:!0},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},values:{type:"object",title:"Table Cell View",default:{show:!0,font_size:12,font_style:"normal",font_weight:"normal",color:"#000"},properties:{show:{title:"Show",type:"boolean",default:"true"},font_size:{title:"Font Size",type:"integer",default:12},color:{type:"string",title:"Color",default:"#000"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]}}},serie:{type:"object",title:"Chart Series",properties:{name:{type:"string",default:""},type:{type:"string",default:"line",enum:["line","bar"]},barWidth:{type:"integer",title:"Bar Max Width",default:10},areaStyle:{type:"object",title:"Area Style",properties:{normal:{type:"object"},show:{type:"boolean",title:"Show Area",default:!0}}}}},sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]},hide_null:{type:"boolean",default:!0},join_type:{type:"string",default:"full_join"}}}},sorters:{additionalProperties:!1,type:"array",title:"Sorters",items:{type:"object",title:"Sort",properties:{sort_field_name:{type:"string",title:"Sorting Column Name"},sort_list:{type:"array",title:"Sort List",items:{type:"string",title:"Item name"}},sort_type:{type:"string",title:"Sorting Type",enum:["desc","asc","ABC","CBA","123","321"]}}}},sites_list_out:{type:"array",title:"Result sites list",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}}}},this.pivot={pivot_common:[],pivot_rows:[],pivot_cols:[]},o.pivot.pivot_common=[],o.pivot.pivot_rows=[],o.pivot.pivot_cols=[],o.pivot.pivot_stack=[],this.toogleConn=function(){this.userData.showConnections?o.getInputPorts().data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:0})}))})):o.getInputPorts().data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:2})}))})),this.userData.showConnections=!this.userData.showConnections},this.getSchema=function(){return this.treema_scheme},this.GetHTTPData=function(){this.updateTable()},this.updateUI=function(){this.fixPivotColumns(),this.loadPivotOptions()},this.getRealCount=function(){return 1},this.loadTreema=function(e){DEBUG&&console.log("PivotNode, loadTreema"),n.editor.editorMode&&((0,yt.b)(mr("#treema_container"),this.getSchema(),this.getUserData()),e||this.loadPivotOptions())},this.loadPivotOptions=function(){var e=this;setTimeout((function(){DEBUG&&console.log("loadPivotOptions"),mr("#common, #columns, #rows").sortable({connectWith:".connectedSortable"}).disableSelection();var t=mr("#common"),a=mr("#columns"),i=mr("#rows");mr("#add_dattr").click((function(){n.editor.getPivotDAttr(e,(function(n){e.updateTable(),t.empty(),a.empty(),i.empty(),r(o.pivot.pivot_rows,i),r(o.pivot.pivot_cols,a),r(o.pivot.pivot_common,t)}))}));var r=function(e,t){e.forEach((function(e,n){if(o.D_ATTRIBUTES.indexOf(e)>-1)mr("<li id='"+e+"' class='ui-state-default'>"+e+"<i class='text-success'> ("+o.userData.pivot.d_attributes[o.D_ATTRIBUTES.indexOf(e)].value+")</i><i style='width: 16px; height: 16px' id='b_"+n+"' class='filter_button close'></i></li>").appendTo(t),mr("#b_"+n).click((function(){var t=mr(this).parent().parent();mr(this).parent().remove(),o.userData.pivot.d_attributes[o.D_ATTRIBUTES.indexOf(e)].show=!1,t[0]!==a[0]&&t[0]!==i[0]||o.updateTable()}));else if(-1===o.FIELDS.indexOf(e))mr("<li id='"+e+"' class='ui-state-default'>"+e+"</li>").appendTo(t);else{var r,s;s="LEFT OUTER"===o.userData.col[o.FIELDS.indexOf(e)].join_type?"left-join":"RIGHT OUTER"===o.userData.col[o.FIELDS.indexOf(e)].join_type?"right-join":"full-join";var l=o.FIELDS.indexOf(e)>0?"<i style='width: 30px; height: 15px' class='filter_button' id='join_"+n+"_"+t.attr("id")+"'></i>":"";r=o.userData.col[o.FIELDS.indexOf(e)].hide_null?"null-of":"null-on",mr("<li id='"+e+"' class='ui-state-default'>"+e+"<i style='width: 30px; height: 15px' class='filter_button' id='null_"+n+"_"+t.attr("id")+"'></i>"+l+"</li>").appendTo(t),mr("#null_"+n+"_"+t.attr("id")).addClass(r).click((function(t){t.stopImmediatePropagation(),mr(this).hasClass("null-on")?(mr(this).removeClass("null-on"),mr(this).addClass("null-of"),o.userData.col[o.FIELDS.indexOf(e)].hide_null=!0,o.updateTable()):(mr(this).removeClass("null-of"),mr(this).addClass("null-on"),o.userData.col[o.FIELDS.indexOf(e)].hide_null=!1,o.updateTable())})),mr("#join_"+n+"_"+t.attr("id")).addClass(s).click((function(t){t.stopImmediatePropagation(),mr(this).hasClass("full-join")?(mr(this).removeClass("full-join"),mr(this).addClass("left-join"),o.userData.col[o.FIELDS.indexOf(e)].join_type="LEFT OUTER",o.updateTable()):mr(this).hasClass("left-join")?(mr(this).removeClass("left-join"),mr(this).addClass("right-join"),o.userData.col[o.FIELDS.indexOf(e)].join_type="RIGHT OUTER",o.updateTable()):(mr(this).removeClass("right-join"),mr(this).addClass("full-join"),o.userData.col[o.FIELDS.indexOf(e)].join_type="FULL OUTER",o.updateTable())}))}t.sortable("refresh")}))};t.empty(),a.empty(),i.empty(),r(o.pivot.pivot_rows,i),r(o.pivot.pivot_cols,a),r(o.pivot.pivot_common,t);var s=function(e,n){o.pivot.pivot_common=t.sortable("toArray"),o.pivot.pivot_cols=a.sortable("toArray"),o.pivot.pivot_rows=i.sortable("toArray"),o.refreshTable()};t.off("sortstop"),a.off("sortstop"),i.off("sortstop"),t.on("sortstop",s),a.on("sortstop",s),i.on("sortstop",s)}),100)},this.setNewData=function(e){this.svgNodes.remove(),this.svgNodes=e;var t="t"+this.getAbsoluteX()+","+this.getAbsoluteY()+"...";this.svgNodes.transform(t),this.dx=this.getAbsoluteX(),this.dy=this.getAbsoluteY()},this.setNewDataU=function(e){o.svgNodes.hide(),o.svgNodes=e,o.applyTransformation(),o.repaint()};var c=new fr.PivotColInputPort;c.setConnectionDirection(0);var u=new fr.layout.locator.TopLocator;c.setName("input0"),this.addPort(c,u),this.createPort("output"),o.getPort("output0").setBackgroundColor("#0098ff"),this.createPort("output"),o.getPort("output1").setBackgroundColor("#ff0000"),this.setDimension(this.width,this.height),this.layoutPorts(),this.fixPivotColumns=function(){if(o.userData.sites_list_out.length){yr.options.columnlookup=o.userData.sites_list_out.length;var e=yr("RECORDSET OF SELECT * from ?",[o.userData.sites_list_out]).columns;o.pivot.pivot_rows.forEach((function(t,a){var n=!1;e.forEach((function(a,o){t===a.columnid&&(e.splice(o,1),n=!0)})),n||o.pivot.pivot_rows.splice(a,1)})),o.pivot.pivot_cols.forEach((function(t,a){var n=!1;e.forEach((function(a,o){t===a.columnid&&(e.splice(o,1),n=!0)})),n||o.pivot.pivot_cols.splice(a,1)})),o.pivot.pivot_common.forEach((function(t,a){var n=!1;e.forEach((function(e){t===e.columnid&&(n=!0)})),n||o.pivot.pivot_common.splice(a,1)})),e.forEach((function(e){-1===o.pivot.pivot_common.indexOf(e.columnid)&&o.pivot.pivot_common.push(e.columnid)}))}},this.updateTable=function(){if(DEBUG&&console.log("updateTable, id:"+this.id),this.updateTickets=0,this.updateRequests=0,this.FIELDS=[],o.userData.sites_list_out=[],o.userData.col&&o.userData.col.length>0){var e=o.userData.col[0].sites_list_out;this.FIELDS.push(o.userData.col[0].item_name);for(var t=1;t<o.userData.col.length;t++){var a=o.userData.col[t].hide_null||o.userData.col[t-1].hide_null,n="",i=o.userData.col[t-1].hide_null?" f.site_id is not null ":"",r=o.userData.col[t].hide_null?" s.site_id is not null ":"";a&&(n=" where "+i,i&&r?n=n+" and "+r:n+=r);var s="SELECT f.*, s.*  FROM ? as f "+o.userData.col[t].join_type+" JOIN ? as s using du_id"+n;DEBUG&&console.log("updateTable, id:"+this.id+"sql:"+s),e=yr(s,[e,o.userData.col[t].sites_list_out]),this.FIELDS.push(o.userData.col[t].item_name)}o.userData.sites_list_out=e}this.refreshTable(),this.fixPivotColumns()},this.sendParams=function(e,t){var a=o.getPort("output0");a&&e&&(a.setUserData({project:o.project||"",scope:o.scope||"",item_name:o.userData.label||o.id,task_type:"",sites_list_out:e}),a.getConnections().each(mr.proxy((function(e,t){var a=t.getTarget();a.userData||(a.userData={}),a.userData.realCount=o.getRealCount(),a.setValue("ticket,"+o.id+","+o.userData.label),o.getCanvas().silentMode||t.setColor("#dfdfdf"),a.setValue(o.getId()),t.setColor("#4ca3bd")}),this)));var n=o.getPort("output1");n&&t&&(n.setUserData({project:o.project||"",scope:o.scope||"",item_name:o.userData.label||o.id,task_type:"",sites_list_out:t}),n.getConnections().each(mr.proxy((function(e,t){var a=t.getTarget();a.userData||(a.userData={}),a.userData.realCount=o.getRealCount(),a.setValue("ticket,"+o.id+","+o.userData.label),o.getCanvas().silentMode||t.setColor("#dfdfdf"),a.setValue(o.getId()),t.setColor("#c75e5e")}),this)))},this.refreshTable=function(){DEBUG&&console.log("refreshTable, id:"+this.id),o.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height;var e=this.getPivotOptionsFunctions(o);(0,Ho.h9)(o.userData.sites_list_out,{renderers:e.renderers,rows:o.pivot.pivot_rows,cols:o.pivot.pivot_cols,vals:o.userData.aggregator.vals,t_col_type:o.userData.aggregator.t_col_type,t_row_type:o.userData.aggregator.t_row_type,aggregatorName:o.userData.aggregator.name,rendererName:o.userData.renderer,derivedAttributes:e.derivedAttributes,aggregators:e.aggregators,rendererOptions:{figure:o,paper:o.canvas.paper,stack:o.pivot.pivot_stack,update:!0},sorters:e.sorters})},this.drawFigureOnPaper=function(e){DEBUG&&console.log("Pivot Draw on Paper"),o.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height;var t=this.getPivotOptionsFunctions(o);(0,Ho.h9)(o.userData.sites_list_out,{renderers:t.renderers,rows:o.pivot.pivot_rows,cols:o.pivot.pivot_cols,vals:o.userData.aggregator.vals,t_col_type:o.userData.aggregator.t_col_type,t_row_type:o.userData.aggregator.t_row_type,aggregatorName:o.userData.aggregator.name,rendererName:o.userData.renderer,derivedAttributes:t.derivedAttributes,aggregators:t.aggregators,rendererOptions:{figure:o,paper:e,stack:o.pivot.pivot_stack},sorters:t.sorters})},this.startAnimation=function(e){if(!o.getCanvas().silentMode){this.canvas.paper.setStart();var t=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading..."),a=this.userData.pivot.colors.monochromatic?this.userData.pivot.colors.mono_base_color:"#777";t.attr({fill:a,stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),function(e,t){var a,n,o,i=Raphael.animation((a={opacity:0},o=1,(n=function(e){var t=function(e){if("object"!=wr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=wr(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==wr(t)?t:t+""}(n="opacity"))in a?Object.defineProperty(a,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):a[n]=o,a),1e3);e.animate(i.repeat(t))}(t,e);var n=this.canvas.paper.setFinish();this.setNewData(n)}}},getTopLevelShapeElement:function(){return 0===this.svgNodes.length?this.shape:this.svgNodes[0]},onDragStart:function(e,t,a,n){return!this.dragIsLocked&&this._super(e,t,a,n)},onPortValueChanged:function(e){var t=this,a=this;if(e.getValue().indexOf("ticket")>-1)this.userData.not_refresh||this.startAnimation(1e3),void 0!==e.userData.realCount?this.updateTickets=this.updateTickets+e.userData.realCount:this.updateTickets=this.updateTickets+1,DEBUG&&console.log("Pivot update ticket received: "+this.updateTickets+" "+e.connections.data[0].sourcePort.userData.item_name);else{this.updateRequests=this.updateRequests+1,this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),DEBUG&&console.log("update data received: "+this.updateTickets+" "+e.connections.data[0].sourcePort.userData.item_name);var n=[];"input0"!==e.name&&"input1"!==e.name||(n=this.userData.col);var o=this.getInputPort("input0").getConnections();a=this,o.data.forEach((function(t,o){if(e.getValue()===t.getSource().getParent().getId()){var i=t.getSource(),r=_r.extend(!0,{},i.userData),s=i.getId();r.owner_id=s;var l=-1;n.forEach((function(e,t){e.owner_id===s&&(l=t)>-1&&(DEBUG&&console.log('updating column: "'+i.getParent().userData.label+'": '+l),r.join_type=n[l].join_type,r.hide_null=n[l].hide_null,n[l]=r)})),-1===l&&(DEBUG&&console.log('inserting column: "'+i.getParent().userData.label+'": '+l),n.push(r)),a.project=i.getUserData().project,a.scope=i.getUserData().scope,a.sop=i.getUserData().sop}})),(this.updateTickets<=0||this.updateRequests===a.userData.col.length)&&setTimeout((function(){t.updateTable(),t.updateUI()}),100)}},createSet:function(){this.canvas.paper.setStart();var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data..."),t=this.userData.pivot.colors.monochromatic?this.userData.pivot.colors.mono_base_color:"#777";return e.attr({fill:t,stroke:"none",opacity:.5,"font-size":24,"font-weight":"bold"}),this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight()).attr({stroke:"#888","stroke-dasharray":"-"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},applyAlpha:function(){},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onTimer:function(){},getPersistentAttributes:function(){var e=this._super();return e.pivot={},e.pivot=this.pivot,e},setPersistentAttributes:function(e){this._super(e),this.userData=mr.extend(!0,{},this.default_user_data,e.userData),this.pivot=e.pivot,this.pivot.pivot_stack||(this.pivot.pivot_stack=[])},getPivotOptionsFunctions:function(e){var t={};t.aggregators=br.GetCustomAgg(e),t.renderers=mr.extend(mr.pivotUtilities_ra.ra_segment_table_renderers,mr.pivotUtilities_ra.ra_table_renderers,mr.pivotUtilities_ra.ra_renderers);var a=mr.pivotUtilities_ra.derivers;t.derivedAttributes={};var n=function(e,t){e.forEach((function(e){delete e[t]}))};return e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Year")].show?t.derivedAttributes.Year=a.dateFormat(e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Year")].value,"%y"):(delete t.derivedAttributes.Year,n(e.userData.sites_list_out,"Year")),e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Month")].show?t.derivedAttributes.Month=a.dateFormat(e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Month")].value,"%m"):(delete t.derivedAttributes.Month,n(e.userData.sites_list_out,"Month")),e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Week")].show?t.derivedAttributes.Week=function(t){return vr(t[e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Week")].value]).toDate().getWeek().toString()}:(delete t.derivedAttributes.Week,n(e.userData.sites_list_out,"Week")),e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Day")].show?t.derivedAttributes.Day=a.dateFormat(e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Day")].value,"%d"):(delete t.derivedAttributes.Day,n(e.userData.sites_list_out,"Day")),e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Aging days")].show?t.derivedAttributes["Aging days"]=function(t){return vr().startOf("day").diff(vr(t[e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Aging days")].value]),"day")}:(delete t.derivedAttributes["Aging days"],n(e.userData.sites_list_out,"Aging days")),e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Aging w.days")].show?t.derivedAttributes["Aging w.days"]=function(t){return vr().startOf("day").businessDiff(vr(t[e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Aging days")].value]),"day")}:(delete t.derivedAttributes["Aging w.days"],n(e.userData.sites_list_out,"Aging days")),e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Aging range")].show?t.derivedAttributes["Aging range"]=function(t){var a=new Date,n=Math.round((a-vr(t[e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Aging range")].value]).toDate())/864e5);return n<=7?"(1) 1w less":n>7&&n<=14?"(2) 1w to 2w":n>14&&n<=30?"(3) 2w to 1m":n>30&&n<=60?"(4) 1m to 2m":n>60&&n<=90?"(5) 2m to 3m":n>90?"(6) 3m more":void 0}:(delete t.derivedAttributes["Aging range"],n(e.userData.sites_list_out,"Aging range")),e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Aging 3 range")].show?t.derivedAttributes["Aging 3 range"]=function(t){var a=new Date,n=Math.floor((a-vr(t[e.userData.pivot.d_attributes[e.D_ATTRIBUTES.indexOf("Aging 3 range")].value]).toDate())/864e5);return n<e.userData.pivot.aging.first_lim?"less "+e.userData.pivot.aging.first_lim+"d":n>=e.userData.pivot.aging.first_lim&&n<=e.userData.pivot.aging.second_lim?e.userData.pivot.aging.first_lim.toString()+"d to "+e.userData.pivot.aging.second_lim+"d":n>e.userData.pivot.aging.second_lim?"more "+e.userData.pivot.aging.second_lim+"d":void 0}:(delete t.derivedAttributes["Aging 3 range"],n(e.userData.sites_list_out,"Aging 3 range")),void 0!==e.userData.sorters&&0!==e.userData.sorters.length||(e.userData.sorters=[],e.userData.sorters.push({sort_field_name:"task_type",sort_list:["baseline","forecast","actual","difference","gap"]})),t.sorters={},e.userData.sorters.forEach((function(e,a){var n=e.sort_field_name;e.sort_type?"asc"===e.sort_type?t.sorters[n]=function(e,t){return e-t}:"desc"===e.sort_type?t.sorters[n]=function(e,t){return t-e}:"ABC"===e.sort_type?t.sorters[n]=function(e,t){e.localeCompare(t)}:"CBA"===e.sort_type?t.sorters[n]=function(e,t){t.localeCompare(e)}:"123"===e.sort_type?t.sorters[n]=function(e,t){return e-t}:"321"===e.sort_type&&(t.sorters[n]=function(e,t){return t-e}):t.sorters[n]=(0,Ho.lq)(e.sort_list)})),t}}),a("5d29313f1596c9b18a9b"),a("7e16b8e06b5b1b988917"),a("5c78f3f49972b85a1809"),a("eb82272f9c0ab8f405f9"),a("7d1977f2f5bd88971e4f");var xr=a("8a868d10b6533e768658"),kr=a("a45670b3d8fb79ec0258"),Dr=a("8deafab7866a125bb9ca");xr.shape.fishbone.cell.Transformnode=xr.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Transformnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Transformnode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(kr.extend({color:"#20b3b9",filter_str:"Transform"},e),t,a,n);var o=this;kr.extend(this.userData,{transform:"[]",signals:"[]",label:"Vega Transform",type_name:"transform"}),kr.extend(!0,this.treema_scheme,{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{label:{type:"string",format:"hidden",default:"New Label"},cont_id:{title:"Chart ID",type:"string"},transform:{type:"string",title:"Transform",format:"ace",aceMode:"ace/mode/JSON5",disableWorker:!1,AItools:{sender:"transform",tools:["left","edit","opti","save_lib","load_lib","right"]}},signals:{type:"string",title:"Signals",format:"ace",aceMode:"ace/mode/JSON5",disableWorker:!1,AItools:{sender:"signals",tools:["save_lib","load_lib"]}},type_name:{type:"string",title:"Type Name",default:"join"}}}),this.AI||(this.AI={}),this.AI.transform||(this.AI.transform={}),this.AI.transform.editAI=function(e){var t,a=null===(t=o.userData.row[0])||void 0===t||null===(t=t.sites_list_out)||void 0===t?void 0:t.slice(0,5);if(a){var n=prompt("Please specify your requirements:","");if(n){var i,r,s,l="You are Vega visualisation suite specialist.\n                    ",c=(n=null!==(i=o.AI)&&void 0!==i&&null!==(i=i.transform)&&void 0!==i&&i.chatUuid?l+"1. understand this JSON5 data structure:\n                         ".concat(m().stringify(a),"  \n                         \n                        2. Update provided Vega transforms array: \n                        ").concat(o.userData.transform,'\n                    \n                        according to user input:\n                        "').concat(n,'"\n                         '):l+"Please understand this JSON5 data structure:\n                         ".concat(m().stringify(a),'  \n                         \n                        and following this user input:\n                        "').concat(n,'"\n                        \n                        generate Vega transforms array:'))+' \n                    and this requirements:\n                    - Do not include ```javascript``` or ```JSON5``` or any other code tags and without code fencing\n                    - Include only transform array without any other component of Vega configuration JSON5\n                    - When working with date columns, use timeFormat to extract week numbers or months, for example:\n                      {\n                        "type": "formula",\n                        "expr": "timeFormat(datum.my_date, \'%Y-W%U\')",\n                        "as": "week"\n                      }\n                    - Common timeFormat patterns:\n                      \'%Y-W%U\': Year-Week (e.g., 2024-W01)\n                      \'%Y-%m\': Year-Month (e.g., 2024-01)\n                      \'%Y-%m-%d\': Year-Month-Day (e.g., 2024-01-15)\n                      \'%b %Y\': Month Year (e.g., Jan 2024)\n                ',u={chatUuid:(null===(r=o.AI)||void 0===r||null===(r=r.transform)||void 0===r?void 0:r.chatUuid)||"",chatName:(null===(s=o.AI)||void 0===s||null===(s=s.transform)||void 0===s?void 0:s.chatName)||"",text:c};Dr.handleRegularResponse(u,o,e,o.userData.config,"transform")}}},this.updateTable=function(){if(this.spec={$schema:"https://vega.github.io/schema/vega/v5.JSON5",description:"transform",signals:[{name:"out_data",update:"setResultData(data('table'), '"+this.id+"')"}],data:[{name:"table"}],marks:[]},DEBUG&&console.log(this.NAME+" id:"+this.id+" "+o.userData.label+" updateTable"),this.updateTickets=[],o.userData.sites_list_out=[],Qt.expressionFunction("setResultData",(function(e,t){if(e&&e.length){DEBUG&&console.log(e);var a=o.getCanvas(),n=a?a.getFigure(t):null;n?(n.userData.sites_list_out=e,n.userData.value=n.userData.sites_list_out.length,n.getPort("output0").setUserData({project:n.project,scope:n.scope,item_name:n.userData.label,sites_list_out:n.userData.sites_list_out}),n.getOutputPort(0).getConnections().each(kr.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor(n.frame.attr("stroke"))}),n)),n.updateUI()):DEBUG&&console.warn("setResultData: Could not get canvas or target figure:",t,"from canvas:",a)}})),o.userData.row.length>0){o.spec.data[0].values=JSON.parse(JSON.stringify(o.userData.row[0].sites_list_out)),Array.isArray(o.userData.transform)&&(o.userData.transform=m().stringify(o.userData.transform,null,2));var e=m().parse(o.userData.transform,null,2);if(Array.isArray(e)){var t=m().parse(o.userData.signals,null,2);Array.isArray(t)&&Array.prototype.push.apply(o.spec.signals,t),o.spec.data[0].transform=e;var a;if(a=o.userData.cont_id?{container:"#"+o.userData.cont_id,renderer:"none"}:{renderer:"none"},o.view=new Qt.View(Qt.parse(o.spec),a),o.userData.cont_id){var n=document.getElementById(o.userData.cont_id);DEBUG&&console.log("VegaChart :"+o.id+" chart "+n),n&&o.view.runAsync().then((function(e){console.log("vega with signals transform completed...")})).catch((function(e){console.error(e)}))}else o.view.toSVG().then((function(e){console.log("vega transform completed...")})).catch((function(e){console.error(e)}))}else alert("Transform settings are not valid!")}}}});var Sr,Cr,Tr,Ar=a("a45670b3d8fb79ec0258"),Pr=a("8deafab7866a125bb9ca"),Er=a("aeb57e88bcb04c329061");function Ir(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=Or(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,s=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return r=e.done,e},e:function(e){s=!0,i=e},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw i}}}}function Nr(e){return Nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nr(e)}function Mr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(e,t)||Or(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Or(e,t){if(e){if("string"==typeof e)return jr(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?jr(e,t):void 0}}function jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function Rr(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return Lr(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Lr(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,Lr(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,Lr(d,"constructor",c),Lr(c,"constructor",l),l.displayName="GeneratorFunction",Lr(c,o,"GeneratorFunction"),Lr(d),Lr(d,o,"Generator"),Lr(d,n,(function(){return this})),Lr(d,"toString",(function(){return"[object Generator]"})),(Rr=function(){return{w:i,m:p}})()}function Lr(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Lr=function(e,t,a,n){function i(t,a){Lr(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},Lr(e,t,a,n)}function Fr(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function Ur(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){Fr(i,n,o,r,s,"next",e)}function s(e){Fr(i,n,o,r,s,"throw",e)}r(void 0)}))}}c().shape.fishbone.cell.DuckDBnode=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.DuckDBnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.DuckDBnode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(Ar.extend({filter_str:"DuckDB",color:"#777777",items:{save_config:{name:"Save Config",icon:"fas fa-file-download",callback:function(){var e=[o.getPersistentAttributes()];Pr.removeData(e),e=JSON.stringify(e,null,2);var t=o.userData.label?o.userData.label:"node.conf",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,da.saveAs)(a,t)}},sep:"---------"}},e),t,a,n),this.help="Node providing DuckDB SQL query facility with Apache Arrow integration for high-performance analytical queries.";var o=this;this.duckdb_wasm_module=null,this.arrow_module=null,this.initialized=!1,Ar.extend(!0,this.treema_scheme,{properties:{sql:{type:"string",title:"SQL",format:"ace",aceMode:"ace/mode/sql",disableWorker:!1,default:"SELECT * FROM table_0"},params:Er.template_params}}),this.updateTable=function(){var e=Ur(Rr().m((function e(t){var a,n,i,r,s,l,c;return Rr().w((function(e){for(;;)switch(e.p=e.n){case 0:if(DEBUG&&(n=performance.now()),!(i=this.getUserData()).sql||t){e.n=6;break}if(e.p=1,this.updateTickets=[],this.initialized||this.initError){e.n=2;break}return e.n=2,this.initializeDuckDB();case 2:if(!this.initError){e.n=3;break}return console.error("DuckDB initialization failed:",this.initError),this.val_label.setText("DuckDB error"),o.updateUI(),e.a(2);case 3:return r=Di()(i.sql),DEBUG&&console.log("DuckDBNode update query id:"+this.id+" "+i.label),this.val_label.setText("."),r=r.replace(/(?:\r\n|\r|\n)/g," "),s=Pr.applyParams(r,i,!0),l=[],o.userData.row.forEach((function(e){e&&e.sites_list_out&&l.push(e.sites_list_out)})),DEBUG&&console.log(s),e.n=4,this.executeDuckDBQuery(s,l);case 4:e.n=6;break;case 5:e.p=5,c=e.v,console.log("DuckDB execution error:",c),this.val_label.setText("error"),o.updateUI();case 6:DEBUG&&(a=performance.now(),console.log("DuckDB Performance:"+this.id+" - "+(a-n)));case 7:return e.a(2)}}),e,this,[[1,5]])})));return function(t){return e.apply(this,arguments)}}()},initializeDuckDB:(Tr=Ur(Rr().m((function e(){var t,n,o,i,r;return Rr().w((function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,console.log("Starting DuckDB-WASM module initialization..."),"undefined"!=typeof window&&window.Worker){e.n=1;break}throw new Error("DuckDB-WASM requires a browser environment with Web Workers support");case 1:return e.n=2,Promise.all([Promise.all([a.e(658),a.e(424)]).then(a.bind(a,"84b7626d646e27fa969d")),Promise.all([a.e(658),a.e(40)]).then(a.bind(a,"7e80e92d1ce7f8eb9be3"))]);case 2:t=e.v,n=Mr(t,2),o=n[0],i=n[1],this.duckdb_wasm_module=o,this.arrow_module=i,this.initialized=!0,console.log("DuckDB-WASM modules loaded and cached successfully"),e.n=4;break;case 3:e.p=3,r=e.v,console.error("Failed to initialize DuckDB-WASM modules:",r),this.initialized=!1,this.initError=r.message;case 4:return e.a(2)}}),e,this,[[0,3]])}))),function(){return Tr.apply(this,arguments)}),createIsolatedDatabase:(Cr=Ur(Rr().m((function e(){var t,n,o,i,r,s,l,c,u;return Rr().w((function(e){for(;;)switch(e.p=e.n){case 0:if(e.p=0,DEBUG&&console.log("Creating isolated DuckDB instance..."),!this.duckdb_wasm_module||!this.arrow_module){e.n=1;break}t=this.duckdb_wasm_module,n=this.arrow_module,DEBUG&&console.log("Using cached DuckDB modules"),e.n=3;break;case 1:return e.n=2,Promise.all([Promise.all([a.e(658),a.e(424)]).then(a.bind(a,"84b7626d646e27fa969d")),Promise.all([a.e(658),a.e(40)]).then(a.bind(a,"7e80e92d1ce7f8eb9be3"))]);case 2:o=e.v,i=Mr(o,2),t=i[0],n=i[1],this.duckdb_wasm_module=t,this.arrow_module=n,DEBUG&&console.log("Loaded and cached DuckDB modules");case 3:if(s=t.getJsDelivrBundles(),r=s.eh||s.coi){e.n=4;break}throw new Error("No compatible DuckDB bundle available for isolated instance");case 4:return e.n=5,t.createWorker(r.mainWorker);case 5:return l=e.v,c=new t.AsyncDuckDB(console,l),e.n=6,c.instantiate(r.mainModule);case 6:return DEBUG&&console.log("Isolated DuckDB instance created successfully"),e.a(2,{db:c,arrow:n});case 7:throw e.p=7,u=e.v,console.error("Failed to create isolated DuckDB instance:",u),u;case 8:return e.a(2)}}),e,this,[[0,7]])}))),function(){return Cr.apply(this,arguments)}),executeDuckDBQuery:(Sr=Ur(Rr().m((function e(t,a){var n,o,i,r,s,l,c,u,d,p,h,f,m;return Rr().w((function(e){for(;;)switch(e.p=e.n){case 0:return n=this,o=null,i=null,e.p=1,e.n=2,this.createIsolatedDatabase();case 2:return r=e.v,o=r.db,e.n=3,o.connect();case 3:i=e.v,DEBUG&&console.log("Created isolated DuckDB instance and connection"),s=0;case 4:if(!(s<a.length)){e.n=7;break}if(!(a[s]&&a[s].length>0)){e.n=6;break}return l="table_".concat(s),c=this.convertToArrowTableIsolated(a[s],r.arrow),e.n=5,i.insertArrowTable(c,{name:l,create:!0});case 5:DEBUG&&console.log("Loaded ".concat(l," with ").concat(a[s].length," rows"));case 6:s++,e.n=4;break;case 7:return DEBUG&&console.log("Executing SQL: ".concat(t)),e.n=8,i.query(t);case 8:u=e.v,d=this.processResult(u),DEBUG&&this.validateResultFormat(d),n.userData.sites_list_out=d,n.userData.value=n.userData.sites_list_out.length,n.getPort("output0").setUserData({project:n.project||"",scope:n.scope||"",item_name:n.userData.label,task_type:n.userData.task_type||"",sites_list_out:n.userData.sites_list_out}),p=n.getOutputPort(0).getConnections(),n.sentData(p),n.updateUI(),e.n=10;break;case 9:throw e.p=9,h=e.v,console.error("DuckDB query error:",h),h;case 10:if(e.p=10,!i){e.n=14;break}return e.p=11,e.n=12,i.close();case 12:DEBUG&&console.log("Isolated connection closed"),e.n=14;break;case 13:e.p=13,f=e.v,console.warn("Failed to close isolated connection:",f);case 14:if(!o){e.n=18;break}return e.p=15,e.n=16,o.terminate();case 16:DEBUG&&console.log("Isolated DuckDB instance terminated and cleaned up"),e.n=18;break;case 17:e.p=17,m=e.v,console.warn("Failed to terminate isolated database:",m);case 18:return e.f(10);case 19:return e.a(2)}}),e,this,[[15,17],[11,13],[1,9,10,19]])}))),function(e,t){return Sr.apply(this,arguments)}),processResult:function(e){try{var t,a=null;if("function"==typeof e.toArray?(a=e.toArray(),DEBUG&&console.log("Used toArray() method")):Array.isArray(e)?(a=e,DEBUG&&console.log("Result is already an array")):(a=this.arrowToJSON(e),DEBUG&&console.log("Used Arrow conversion")),!Array.isArray(a))return console.warn("DuckDB result is not an array, returning empty array"),[];try{t=JSON.parse(JSON.stringify(a)),DEBUG&&(console.log("DuckDB result converted to plain JSON:",t.length,"rows"),console.log("Sample row:",t[0]),this.validateResultFormat(t))}catch(e){console.warn("JSON serialization failed, using manual conversion:",e),t=this.manualProxyConversion(a)}return t}catch(e){return console.error("Error processing DuckDB result:",e),[]}},manualProxyConversion:function(e){var t=[];try{for(var a=0;a<e.length;a++){var n=e[a];if(n&&"object"===Nr(n)){var o={};try{for(var i in n)if(n.hasOwnProperty&&n.hasOwnProperty(i))o[i]=n[i];else try{var r=n[i];void 0!==r&&(o[i]=r)}catch(e){}if(0===Object.keys(o).length)for(var s=Object.keys(n),l=0,c=s;l<c.length;l++){var u=c[l];try{o[u]=n[u]}catch(e){}}}catch(e){console.warn("Failed to extract properties from row ".concat(a,":"),e),o._duckdb_row=a,o._extraction_error="Could not access row properties"}t.push(o)}else t.push(n)}}catch(e){return console.error("Manual conversion failed:",e),[]}return DEBUG&&console.log("Manual conversion completed:",t.length,"rows"),t},convertToArrowTable:function(e){if(!this.arrow_module)throw new Error("Arrow module not initialized");return this.convertToArrowTableIsolated(e,this.arrow_module)},convertToArrowTableIsolated:function(e,t){if(!Array.isArray(e)||0===e.length)return t.tableFromArrays({});var a={};return Object.keys(e[0]).forEach((function(t){a[t]=e.map((function(e){return e[t]}))})),t.tableFromArrays(a)},arrowToJSON:function(e){try{var t=[];if(!e||!e.schema)return t;for(var a=e.schema,n=0;n<e.length;n++){var o,i={},r=Ir(a.fields);try{for(r.s();!(o=r.n()).done;){var s=o.value,l=e.getChild(s.name).get(n);i[s.name]=l}}catch(e){r.e(e)}finally{r.f()}t.push(i)}return JSON.parse(JSON.stringify(t))}catch(e){return console.error("Error converting Arrow to JSON:",e),[]}},validateResultFormat:function(e){try{if(!Array.isArray(e))return console.error("DuckDB result validation failed: not an array"),!1;var t=e[0];if(t&&"object"===Nr(t))try{var a=Object.keys(t),n=Object.getOwnPropertyNames(t);a.length!==n.length&&console.warn("Potential proxy object detected in DuckDB result");var o=JSON.stringify(t);JSON.parse(o),console.log("DuckDB result validation passed - plain objects confirmed"),console.log("Sample row keys:",a),console.log("Sample row:",t)}catch(e){return console.error("DuckDB result contains proxy objects:",e),!1}return!0}catch(e){return console.error("Error validating DuckDB result format:",e),!1}},loadTreema:function(){Pr.updateParamSourceCol(this),Pr.updateParamDetailsCol(this),Pr.updatePropKeyCol(this),this._super(this)}});var Br=a("8a868d10b6533e768658"),zr=a("a45670b3d8fb79ec0258"),Hr=a("1bf2fbdb051fe0c57024");Br.shape.fishbone.cell.Mapnode=Br.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.Mapnode",INFO:"{Class: <strong>Mapnode</strong>}<br/><br/> <strong>Code </strong><cite>Node </cite>Provide mapping values facilities<br/><br/><strong>Configuration: </strong>",init:function(e,t,a,n){this._super(zr.extend({color:"#777777"},e),t,a,n);var o=this;this.sites_list_in=[],zr.extend(this.userData,{map:[],conditions:[{logic:"",prop:"self",sign:"not equal",value:"empty"}],label:"New Label",type_name:"gap"}),zr.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{map:{type:"array",title:"Map",items:{type:"object",properties:{source:{type:"string",title:"Source",default:""},target:{type:"string",title:"Target",default:""},target_value:{type:"string",title:"Target Value",default:""}}}},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",title:"Logic apply",default:"",enum:["","and","or"]},prop:{type:"string",title:"Property Name",default:"self"},sign:{type:"string",default:"not equal",title:"Sign",enum:["not equal","equal","consist","not consist","more than","less than","more or equal than","less or equal than"]},value:{type:"string",title:"Condition Value",default:"empty"}},required:["logic","prop","sign","value"]}},filter:{type:"object",title:"Filter",format:"hidden",properties:{filtered:{type:"boolean",default:!1},list:{type:"array",items:{type:"object",title:"Filter",properties:{site_code:{type:"string",title:"Site Code"},udf_type_name:{type:"string",title:"Site Name"}}}}}},label:{type:"string",format:"hidden",default:""},type_name:{type:"string",title:"Type Name",default:"gap"}}}),this.GetHTTPData=function(){var e,t=this.getUserData();o.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500)),e=""!==t.label&&void 0!==t.label?t.label:"Mapping";var a=this.sites_list_in,n=[];a.length>0&&a.forEach((function(e,a){var o={};t.map.forEach((function(t,a){t.target_value?o[t.target]=t.target_value:o[t.target]=e[t.source]})),n.push(o)}));var i=function(e,t,a){var n=e.conditions;return o.getConditions(n),(new Hr).from(t).where((function(e,t){var o,i,r=!0;return n.forEach((function(t,n){o="empty"===t.value?"":t.value,i=null===e[a]?"":e[a],"and"===t.logic||0===n?"not equal"===t.sign?r=r&&i!==o:"equal"===t.sign?r=r&&i===o:"consist"===t.sign?r=r&&i.indexOf(o)>-1:"not consist"===t.sign?r=r&&-1===i.indexOf(o):"more than"===t.sign?r=r&&i>o:"less than"===t.sign?r=r&&i<o:"more or equal than"===t.sign?r=r&&i>=o:"less or equal than"===t.sign&&(r=r&&i<=o):"or"===t.logic&&("not equal"===t.sign?r=r||i!==o:"equal"===t.sign?r=r||i===o:"consist"===t.sign?r=r&&i.indexOf(o)>-1:"not consist"===t.sign?r=r&&-1===i.indexOf(o):"more than"===t.sign?r=r&&i>o:"less than"===t.sign?r=r&&i<o:"more or equal than"===t.sign?r=r&&i>=o:"less or equal than"===t.sign&&(r=r&&i<=o))})),r})).select()}(t,n,e);o.val_label.setText(i.length),o.userData.value=i.length,o.userData.sites_list_out=i;var r=o.getPort("output0");r.setValue(i),r.setUserData({project:o.project,scope:o.scope,sop:o.sop,item_name:e,sites_list_out:i}),o.getOutputPort(0).getConnections().each(zr.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),o.stopTimer(),o.updateUI()},this.createPort("output");var i=null;(i=new Br.DataInputPort).setConnectionDirection(3),i.setName("dataInput"),this.addPort(i),this.setDimension(this.width,this.height),this.layoutPorts()},getConditions:function(e){var t=this;this.filter_label.setText(""),e.forEach((function(e,a){""!==t.filter_label.getText()&&t.filter_label.setText(t.filter_label.getText()+"\n"),t.filter_label.setText(t.filter_label.getText()+e.logic+" "+e.sign+" "+e.value)}))},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText("Mapping"),void 0===e.filter&&(e.filter={filtered:!1,list:[],original_list:[]}),e.filter.filtered?this.filter_label.setText("Multiple filter"):this.getConditions(e.conditions),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(zr.proxy((function(e,a){a.getTarget().setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||a.setColor("#dfdfdf")}),this))}));else if("dataInput"==e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.project=a.getUserData().project,this.scope=a.getUserData().scope,this.sop=a.getUserData().sop,this.GetHTTPData()}},setPersistentAttributes:function(e){this._super(e)}}),a("cbb7090f77d30655a5a6");var qr=a("a45670b3d8fb79ec0258"),Vr=a("8deafab7866a125bb9ca"),Wr=a("6fe5e339b0f8a936ba8c");c().shape.fishbone.cell.APIFixnode=c().shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.APIFixnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.APIFixnode Node provide API request facility integration into existing report structure. Automatically using proj_id and du_id parameters</strong>}<br/><br/>",init:function(e,t,a,n,o){this._super(qr.extend({filter_str:"API Data",color:"#10b7f0",items:{sate_config:{name:"Save Config",icon:"fas fa-file-download",callback:function(){var e=[i.getPersistentAttributes()];Vr.removeData(e),e=JSON.stringify(e,null,2);var t=i.userData.label?i.userData.label:"node.conf",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,da.saveAs)(a,t)}},sep:"---------"}},e),t,a,n),this.help="Node witch is providing API request facility integration into existing object structure.";var i=this;this.sites_list_in=[],this.updateTickets=0,this.updateRequests=0,qr.extend(this.userData,{apiid:o,label:"API Call",row:[]}),qr.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{row:{additionalProperties:!1,type:"array",title:"Rows",items:{sites_list_out:{type:"array",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}},item_name:{type:"string"},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{type:"string",default:""},proj_name:{type:"string",default:""},proj_code:{type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}},apiid:{type:"string",title:"API ID",default:""},label:{type:"string",format:"hidden",default:"New Label"},limit:{type:"string",title:"Page Limit",default:""},offset:{type:"string",title:"Page Offset",default:""},pagesize:{type:"string",title:"Page Size",default:""},order_list:{type:"array",title:"Order By",items:{type:"object",title:"Item",properties:{field_name:{type:"string",title:"Column Name"},sort:{type:"string",title:"Sort",enum:["ASC","DESC"]}}}}}}),this.GetHTTPData=function(){this.updateTable()},this.createPort("output");var r=new(c().PivotRowInputPort);r.setConnectionDirection(3),r.setName("input0"),r.setBackgroundColor("#ff8000"),r.setDiameter(12),r.setMaxFanOut(1),this.addPort(r),this.layoutPorts(),this.updateTable=function(e){if(this.updateTickets=0,this.updateRequests=0,!e){var t=this.getUserData();this.val_label.setText(".");var a,n={proj_id:this.project.proj_id},o=t.row[0].sites_list_out;void 0!==o&&(a="",o.forEach((function(e,t){a=a+e.du_id+","})),a=a.substring(0,a.length-1),n.du_id=a);var r="";if(t.order_list&&t.order_list.length){var s=[];t.order_list.forEach((function(e,t){s.push(e.field_name+","+e.sort)})),r=JSON.stringify(s)}var l=Wr.context+"/apidata/getAPIData?apiid="+t.apiid+"&user_id="+window.user_id;i.userData.limit&&(l=l+"&limit="+i.userData.limit),i.userData.offset&&(l=l+"&offset="+i.userData.offset),i.userData.pagesize&&(l=l+"&pagesize="+i.userData.pagesize),r&&(l=l+"&orderby="+r),i.userData.split_du_id&&(l=l+"&split="+!!i.userData.split_du_id),i.userData.parse_json&&(l=l+"&parse_json="+!!i.userData.parse_json),this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),t.apiid&&(this.xhr=qr.ajax({url:l,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(n),success:function(e){var t=e.data?e.data:e;i.userData.sites_list_out=t,i.userData.value=i.userData.sites_list_out.length,i.getPort("output0").setUserData({project:i.project||"",scope:i.scope||"",item_name:i.userData.label,task_type:i.userData.task_type,sites_list_out:i.userData.sites_list_out}),i.getOutputPort(0).getConnections().each(qr.proxy((function(e,t){t.getTarget().setValue(i.id),t.setColor(i.frame.attr("stroke"))}),this)),i.updateUI(),i.stopTimer()},error:function(e,t){console.log(t)}}))}},this.userData.sites_list_out=[],i.userData.row=[],this.getRealCount=function(){return 1}},loadTreema:function(){this._super(this)},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText("New Result"),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1){var a=e.getValue().split(",");t.startTimer(500),this.updateTickets=this.updateTickets+1,console.log(t.NAME+" id:"+this.id+" "+this.userData.label+" update ticket received: "+this.updateTickets+" from: "+a[2]+", Super: "+e.superUpdate);var n=0;this.userData.conn_count?n=this.userData.conn_count:this.getInputPorts().data.forEach((function(e,t){n+=e.getConnections().data.length})),(this.updateTickets>=n||e.superUpdate)&&(this.getOutputPorts().data.forEach((function(a,n){a.getConnections().each(qr.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),o.superUpdate=!!e.superUpdate,n.setColor("#dfdfdf"),console.log(t.NAME+" id:"+t.id+" "+t.userData.label+" update ticket send: to: "+o.getParent().userData.label+", Super: "+o.superUpdate),o.setValue("ticket,"+t.id+","+t.userData.label)}),this))})),e.superUpdate&&(e.superUpdate=!1))}else if(this.updateRequests=this.updateRequests+1,this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),DEBUG&&console.log("APIFixNode "+this.userData.label+" update data received: "+this.updateTickets),"input0"===e.name){var o="input0"===e.name?0:1,i=this.getInputPort(o).getConnections();this.val_label.setText("."),i.data.forEach((function(e,a){var n=e.getSource(),o=n.getId(),i=n.userData;i.owner_id=o;var r=-1;t.userData.row.forEach((function(e,t){e.owner_id===o&&(r=t)})),r>-1&&t.userData.row.splice(r,1),t.userData.row.push(i),t.project=n.getUserData().project,t.scope=n.getUserData().scope,t.sop=n.getUserData().sop})),(this.updateTickets<=0||this.updateRequests===t.userData.row.length)&&t.updateTable()}},onTimer:function(){"."!==this.val_label.getText()&&".."!==this.val_label.getText()&&"..."!==this.val_label.getText()&&this.val_label.setText("."),"."===this.val_label.getText()?this.val_label.setText(".."):".."===this.val_label.getText()?this.val_label.setText("..."):"..."===this.val_label.getText()&&this.val_label.setText(".")}}),a("514c4849ae36c761f260"),a("aa89d31f4d5abab91608"),a("45de231a64f7d3e2c9b9");var Gr=a("8a868d10b6533e768658"),Jr=a("a45670b3d8fb79ec0258"),Qr=a("8deafab7866a125bb9ca");Gr.shape.fishbone.cell.ALERTnode=Gr.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.ALERTnode",INFO:"{Class: <strong>ALERTnode</strong>}<br/><br/> <strong>Code </strong><cite>Node </cite>Provide simple information in case of input port data update<br/><br/><strong>Configuration: </strong>",init:function(e,t,a,n){this._super(Jr.extend({val_str:"🛎",color:"#299ba9",items:{}},e),t,a,n);var o=this;this.sites_list_in=[],Jr.extend(this.userData,{label:"Message",type_name:"alert",message:"",toast_type:"info",timeout:"5000",close:!0,overlay:!1,progressBar:!0,position:"topCenter"}),Jr.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{label:{type:"string",format:"hidden",default:""},type_name:{type:"string",title:"Type Name",default:"alert"},toast_type:{type:"string",title:"Message Type",default:"info",enum:["info","success","warning","error"]},close:{type:"boolean",title:"Show Close Button",default:!0},timeout:{type:"string",title:"Timeout",default:"5000"},overlay:{type:"boolean",title:"Overlay",default:!1},progressBar:{type:"boolean",title:"Progress Bar",default:!0},message:{type:"string",title:"Message",default:""},position:{type:"string",title:"Position",default:"topCenter",enum:["bottomRight","bottomLeft","topRight","topLeft","topCenter","bottomCenter","center"]}}}),this.getRealCount=function(){return 1},this.GetHTTPData=function(){o.startTimer(),Qr.bsToast[o.userData.toast_type]({id:o.id,title:o.userData.toast_type,message:o.userData.message,timeout:JSON.parse(o.userData.timeout),close:o.userData.close,overlay:o.userData.overlay,position:o.userData.position,progressBar:o.userData.progressBar,maxWidth:450}),o.stopTimer(),o.updateUI()};var i=null;(i=new Gr.DataInputPort).setConnectionDirection(3),i.setBackgroundColor("#26cc00"),i.setName("dataInput"),this.addPort(i);var r=null;(r=new Gr.DataInputPort).setConnectionDirection(3),r.setBackgroundColor("#cc4e00"),r.setName("resetInput"),this.addPort(r),this.setDimension(this.width,this.height),this.layoutPorts()},updateUI:function(){this.getUserData(),this.val_label.setText("🛎"),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):(this.top_label.setText("Message"),this.userData.label="Message"),this.filter_label.setText("alert"),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1){if("dataInput"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();if(t.project=a.getUserData().project,t.scope=a.getUserData().scope,DEBUG){var o=e.getValue().split(",");console.log(t.NAME+" id:"+t.id+" "+t.userData.label+" update ticket received: "+t.updateTickets+" from: "+o[2]+", Super: "+e.superUpdate)}}}else if("dataInput"===e.name)a=this.getInputPort(0).getConnections().data[0].getSource(),DEBUG&&(o=e.getValue().split(","),console.log(t.NAME+" id:"+t.id+" "+t.userData.label+" update request received: "+t.updateTickets+" from: "+o[2]+", Super: "+e.superUpdate)),this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.GetHTTPData();else if("resetInput"===e.name){var i=document.getElementById(t.id);if(i){var r=n.y8.getInstance(i);r&&(DEBUG&&(o=e.getValue().split(","),console.log(t.NAME+" id:"+t.id+" "+t.userData.label+" reset signal received: "+t.updateTickets+" from: "+o[2]+", Super: "+e.superUpdate)),r.hide())}}}}),a("09f595d6f923b7e5d9a4"),a("8ff0af86375ed58b59af"),a("7224621f71697a947db7"),a("d3949897a1eac25025cc"),a("d3346bd573ffa5dfa4a2");var Yr=a("d4fd9758b803e5005c42"),Xr=(a("3c81e05dbe55fea3bb30"),a("6930ba81a06c50c4d37a"),a("0b3eaaaf500f06006898"),a("a45670b3d8fb79ec0258")),Kr=a("8deafab7866a125bb9ca");c().shape.fishbone.ra.RaPivotAdapter=c().shape.fishbone.ra.RaSVGNode.extend({NAME:"draw2d.shape.fishbone.ra.RaPivotAdapter",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaPivotAdapter</strong>}<br/><br/>",init:function(e,t,a){this._super(Xr.extend({},e),t,a);var n=this,o={toogleInCon:{name:"Toogle In Connections"},apply_config:{name:"Apply Config From Editor"}};this.on("contextmenu",(function(e,t){Xr.contextMenu({selector:"body",events:{hide:function(){Xr.contextMenu("destroy")}},callback:Xr.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){n.toogleInConn()}),10);break;case"apply_config":setTimeout((function(){n.apply_config=!0,n.updateTable()}),10)}}),this),x:t.x,y:t.y,items:o})})),this.apply_config=!1,Xr.extend(this.userData,{pivot_ui:!0,cont_id:"myPivotTable1",wrap_table:"none",config:JSON.stringify({rows:[],cols:[]},null,4)}),Xr.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{cont_id:{title:"Pivot ID",type:"string"},height:{title:"Table Height",type:"string"},pivot_ui:{title:"Use Pivot UI",type:"boolean",default:!0},wrap_table:{title:"Wrap Table",type:"string",enum:["none","DataTable","Bootstrap Table"]},BT_attr:{type:"array",title:"BT Attributes",items:{type:"object",title:"BT Attribute",properties:{attr_name:{title:"Attr Name",type:"string"},attr_value:{title:"Attr Value",type:"string"},attr_dis:{title:"Attr Disable",type:"boolean",default:!0}}}},subtotal:{title:"Use Subtotal",type:"boolean",default:!0},hideRowTotals:{title:"Hide Row Totals",type:"boolean",default:!0},hideColTotals:{title:"Hide Col Totals",type:"boolean",default:!0},sorters:{additionalProperties:!1,type:"array",title:"Sorters",items:{type:"object",title:"Sort",properties:{sort_field_name:{type:"string",title:"Sorting Column Name"},sort_list:{type:"array",title:"Sort List",items:{type:"string",title:"Item name"}},sort_type:{type:"string",title:"Sorting Type",enum:["desc","asc","ABC","CBA","123","321"]}}}},config:{type:"string",title:"Table Config",format:"ace",aceMode:"ace/mode/json",disableWorker:!1}}}),this.updateTable=function(){var e=this;DEBUG&&console.log("RaPivotAdapter table Update"),this.updateTickets=[],this.row.length&&(this.row.forEach((function(t,a){e.pivot_data=t})),function(e){if(n){var t=document.getElementById(n.userData.cont_id);if(t){t.parentNode.querySelector(".spin")&&(t.parentNode.querySelector(".spin").classList.remove("show-loader"),t.parentNode.querySelector(".spin").classList.add("hide-loader")),t.style.height="auto",t.style.overflow="scroll";var a=Xr("#"+n.userData.cont_id).data("pivotUIOptions");if(a){var o=JSON.parse(JSON.stringify(a));delete o.aggregators,delete o.renderers,n.apply_config?(n.userData.config=JSON.stringify(Xr.extend({},o,JSON.parse(n.userData.config)),null,4),n.apply_config=!1):n.userData.config=JSON.stringify(o,null,4)}var i,r,s,l=JSON.parse(n.userData.config),c={};if(n.userData.pivot_ui)n.userData.subtotal&&(i=Xr.pivotUtilities.SubtotalPivotData,r=Xr.pivotUtilities.subtotal_renderers,n.userData.sorters&&n.userData.sorters.length&&(n.userData.sorters.forEach((function(e){c[e.sort_field_name]=Xr.pivotUtilities.sortAs(e.sort_list)})),l.sorters=c),l.dataClass=i,l.renderers=r,l.rendererName="Table With Subtotal"),Xr("#"+n.userData.cont_id).pivotUI(e,l,!0);else{n.userData.subtotal&&(i=Xr.pivotUtilities.SubtotalPivotData,r=Xr.pivotUtilities.subtotal_renderers["Table With Subtotal"],n.userData.sorters&&n.userData.sorters.length&&(n.userData.sorters.forEach((function(e){c[e.sort_field_name]=Xr.pivotUtilities.sortAs(e.sort_list)})),l.sorters=c),l.dataClass=i,l.renderer=r);var u=Xr.pivotUtilities.aggregators[l.aggregatorName](l.vals);l.aggregator=u;var d=Xr("#"+n.userData.cont_id);if("Tabulator"===n.userData.wrap_table)d.pivot(e,l,!0),d.find("table").attr("id",n.userData.cont_id+"_table"),new ar.mu("#"+n.userData.cont_id+"_table",{});else if("DataTable"===n.userData.wrap_table){var p,h=function(){return new Yr.A(m,{destroy:!0,paging:!1,scrollCollapse:!0,scrollY:p,buttons:["copy","excel","pdf"]})},f=Xr.extend(Xr.pivotUtilities.renderers,Xr.pivotUtilities.fb_renderer);l.renderer=f["FB Table"],d.pivot(e,l,!0),p=n.userData.height?n.userData.height:"50vh";var m=d.find("table");m.removeClass("pvtTable"),n.table=h(),window.addEventListener("resize",h)}else if("Bootstrap Table"===n.userData.wrap_table){d.pivot(e,l,!0);var g=d.find("table");g.removeClass("pvtTable"),g.attr("id",n.userData.cont_id+"_table"),g.attr("data-toggle","table"),g.attr("data-search",!0),g.attr("data-virtual-scroll",!0),g.attr("data-show-columns",!0),g.bootstrapTable(),g.addClass("table-sm")}else n.userData.height?t.style.height=n.userData.height:t.style.height="auto",d.pivot(e,l,!0)}n.userData.hideRowTotals?((s=document.createElement("style")).id="hideRowTotals",s.type="text/css",s.innerHTML="thead > tr > th.pvtTotalLabel, .rowTotal, .pvtGrandTotal  { display: none; }",document.getElementsByTagName("head")[0].appendChild(s)):(s=document.getElementById("hideRowTotals"))&&s.remove(),n.userData.hideColTotals?((s=document.createElement("style")).id="hideColTotals",s.type="text/css",s.innerHTML="table.hideColTotals > tbody > tr > th.pvtTotalLabel, .colTotal, .pvtGrandTotal { display: none; }",document.getElementsByTagName("head")[0].appendChild(s)):(s=document.getElementById("hideColTotals"))&&s.remove()}var y=Kr.getShapeSVG("Pivot Adapter","Table ID: "+n.userData.cont_id,"HTML Mode");n.setSVG(y),n.oldAbsX=0,n.oldAbsY=0,n.applyTransformation()}}(this.pivot_data))}}}),a("867a564510a7814c3710");var Zr=a("a45670b3d8fb79ec0258"),$r=a("d1be49724a1f416e7f57"),es=a("8deafab7866a125bb9ca");window.XLSX=Ni,window.raTableExportFunctions=window.raTableExportFunctions||{},window.raTableExportFunctions.exportToExcel=function(e){e.table?(e.table.download("xlsx","".concat(e.userData.cont_id,"_export.xlsx"),{sheetName:"Data Export"}),console.log("[RaTableAdapter] Exported table to Excel: ".concat(e.userData.cont_id))):console.error("[RaTableAdapter] Table not found for Excel export: ".concat(e.userData.cont_id))},window.raTableExportFunctions.toggleFullscreen=function(e){var t,a,n,o,i,r,s,l,c,u,d,p,h=document.getElementById(e.userData.cont_id);h&&(document.fullscreenElement?(null===(t=(a=document).exitFullscreen)||void 0===t?void 0:t.call(a))||(null===(n=(o=document).mozCancelFullScreen)||void 0===n?void 0:n.call(o))||(null===(i=(r=document).webkitExitFullscreen)||void 0===i?void 0:i.call(r))||null===(s=(l=document).msExitFullscreen)||void 0===s||s.call(l):(null===(c=h.requestFullscreen)||void 0===c?void 0:c.call(h))||(null===(u=h.mozRequestFullScreen)||void 0===u?void 0:u.call(h))||(null===(d=h.webkitRequestFullscreen)||void 0===d?void 0:d.call(h))||null===(p=h.msRequestFullscreen)||void 0===p||p.call(h),console.log("[RaTableAdapter] Toggled fullscreen for table: ".concat(e.userData.cont_id)))},window.raTableExportFunctions.refreshData=function(e){e.table?(e.table.clearData(),setTimeout((function(){e.updateTable(),console.log("[RaTableAdapter] Refreshed table data: ".concat(e.userData.cont_id))}),100)):console.error("[RaTableAdapter] Table not found for refresh: ".concat(e.userData.cont_id))},c().shape.fishbone.ra.RaTableAdapter=c().shape.fishbone.ra.RaSVGNode.extend({NAME:"draw2d.shape.fishbone.ra.RaTableAdapter",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaTableAdapter</strong>}<br/><br/>",init:function(e,t,a,n){var o=this;this._super(Zr.extend({},e),t,a,n),this.sscope=n;var i=this;this.setResizeable(!1);var r={toogleInCon:{name:"Toogle In Connections"},saveToStorage:{name:"Save Data To Storage",disabled:function(){return!o.userData.storage_table_id}}};this.on("contextmenu",(function(e,t){Zr.contextMenu({selector:"body",events:{hide:function(){Zr.contextMenu("destroy")}},callback:Zr.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){i.toogleInConn()}),10);break;case"saveToStorage":setTimeout(i.saveToStorage,10)}}),this),x:t.x,y:t.y,items:r})})),this.saveToStorage=function(){if(i.userData.storage_table_id){var e=i.getCanvas().getFigure(i.userData.storage_table_id);if(e&&"draw2d.shape.fishbone.ra.RaTablenode"===e.NAME){var t,a=i.table.getData();$r.options.columnlookup=a.length;var n=$r("RECORDSET OF SELECT * from ?",[a]).columns;e.userData.table_col_spec=[],i.userData.storage_update_ind?($r("DROP TABLE IF EXISTS tmp_data_dump"),$r("CREATE TABLE tmp_data_dump"),$r("INSERT INTO tmp_data_dump select * from ?",[e.userData.sites_list_out]),a.forEach((function(e,t){for(var a="",n=0;n<i.userData.storage_update_ind.length;n++){var o="";e[i.userData.storage_update_ind[n]]?(o=" = '"+e[i.userData.storage_update_ind[n]].toString()+"' ",a=a+"cast(["+i.userData.storage_update_ind[n]+"] as string) "+o):""===e[i.userData.storage_update_ind[n]]?(o=" = '' ",a=a+"cast(["+i.userData.storage_update_ind[n]+"] as string) "+o):null===e[i.userData.storage_update_ind[n]]&&(o=" is null ",a=a+"["+i.userData.storage_update_ind[n]+"] "+o),n<i.userData.storage_update_ind.length-1&&(a+=" and ")}$r("DELETE FROM tmp_data_dump WHERE "+a)})),$r("INSERT OR REPLACE INTO tmp_data_dump select * from ?",[a]),t=$r("SELECT * FROM tmp_data_dump"),e.userData.sites_list_out=t,$r("DROP TABLE IF EXISTS tmp_data_dump")):(e.userData.sites_list_out=a,t=a),n.forEach((function(t){e.userData.table_col_spec.push({name:t.columnid,formatting:"none",prefix:"",affix:"",bg_color:"#fff",fn_color:"#000",font_type:"Tahoma, Geneva",font_size:"12px",totals:"none",width:"auto",data:[]})})),e.loadData(t,!1)}}},this.apply_config=!1;var s=new(c().OutputPort);s.setConnectionDirection(2),s.setName("output0");var l=new(c().layout.locator.BottomLocator);this.addPort(s,l),this.createPort("output"),i.getPort("output1").setBackgroundColor("#d97f3a"),this.layoutPorts(),Zr.extend(this.userData,{cont_id:"myDataTable1",theme:"light",menu:{export_xlsx:!0},renderer:"tabulator",config:JSON.stringify([],null,4)}),Zr.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{cont_id:{title:"Table ID",type:"string"},renderer:{title:"Renderer",type:"string"},theme:{title:"Theme",type:"string",enum:["light","dark","vintage","westeros","wonderland","chalk","macarons","shine","halloween","essos","walden","infographic","roma","purple-passion"]},menu:{type:"object",title:"Menu",properties:{export_xlsx:{title:"Export To Excel",type:"boolean",default:!0},export_pdf:{title:"Export To PDF",type:"boolean",default:!0},import_csv:{title:"Import from Excel",type:"boolean",default:!0}}},storage_table_id:{title:"Storage ID",type:"string"},storage_update_ind:{title:"Storage Update Index",type:"array"},keep_selection:{title:"Remember Selection",type:"boolean",default:!0},selection:{type:"array"},config:{type:"string",title:"Table Config",format:"ace",aceMode:"ace/mode/javascript",disableWorker:!1,default:"[]",AItools:{sender:"config",tools:["save_lib","load_lib"]}}}}),this.updateTable=function(){var e=this,t=this;try{var a=function(e){if(t){var a=document.getElementById(t.userData.cont_id);if(a){if(a.parentNode.querySelector(".spin")&&(a.parentNode.querySelector(".spin").classList.remove("show-loader"),a.parentNode.querySelector(".spin").classList.add("hide-loader")),a.style.overflow="scroll",!a.parentNode.classList.contains("ra-table-wrapper")){var n=document.createElement("div");n.className="ra-table-wrapper";var o=document.createElement("div");o.className="d-flex justify-content-end align-items-center",o.style.marginBottom="0.5rem";var i=document.createElement("div");i.className="btn-group btn-group-sm",i.setAttribute("role","group");var r=document.createElement("button");r.type="button",r.className="btn",r.onclick=function(){return window.raTableExportFunctions.exportToExcel(t)},r.title="Export to Excel";var s=document.createElement("i");s.className="fas fa-file-excel",r.appendChild(s),i.appendChild(r);var l=document.createElement("button");l.type="button",l.className="btn",l.onclick=function(){window.raTableExportFunctions.toggleFullscreen(t),document.fullscreenElement?(c.className="fas fa-compress-arrows-alt",l.title="Exit Fullscreen"):(c.className="fas fa-expand-arrows-alt",l.title="Toggle Fullscreen")},l.title="Toggle Fullscreen";var c=document.createElement("i");c.className="fas fa-expand-arrows-alt",l.appendChild(c),i.appendChild(l);var u=document.createElement("button");u.type="button",u.className="btn",u.onclick=function(){return window.raTableExportFunctions.refreshData(t)},u.title="Refresh Data";var d=document.createElement("i");d.className="fas fa-redo-alt",u.appendChild(d),i.appendChild(u),o.appendChild(i),a.parentNode.insertBefore(n,a),n.appendChild(o),n.appendChild(a)}var p=[];t.userData.menu||(t.userData.menu={export_xlsx:!0}),t.userData.menu.export_xlsx&&p.push({label:"<i class='fas fa-file-export'></i> Export to Excel",action:function(e,a){window.raTableExportFunctions.exportToExcel(t)}}),t.userData.menu.import_csv&&(p.push({separator:!0}),p.push({label:"<i class='fa-solid fa-file-import'></i> Import from Excel",action:function(e,a){t.table.import("xlsx",[".xlsx",".csv",".ods"],"buffer").then((function(){t.saveToStorage()})).catch((function(){console.log("import file issue")}))}}));var h=function(e,t,a){var n=document.createElement("span"),o=e.getValue();t.invert&&(o=o.map((function(e){return-1*e}))),n.classList.add(t.type),n.innerHTML=o.join(",");var i={width:145};return t.fill&&(i.fill=t.fill),a((function(){peity(n,t.type,i)})),n};if("tabulator"===t.userData.renderer){var f,m,g=es.safeEval("()=>{return "+t.userData.config.replace("config = "," ")+"}",t);if(g.success?f=g.result:console.log(g.error),0===Object.keys(f).length){var y=new Set;e.forEach((function(e){Object.keys(e).forEach((function(e){return y.add(e)}))}));var _=[];y.forEach((function(e){_.push({title:e,field:e})})),m={height:355,rowContextMenu:p,movableColumns:!0,paginationCounter:"rows",layout:"fitColumns",data:e[0],columns:_},f={height:355,rowContextMenu:p,movableColumns:!0,paginationCounter:"rows",layout:"fitColumns",data:e,columns:_},t.userData.config="config = "+JSON.stringify(m,null,4)}else delete f.data,f.data=e,f.rowContextMenu=p;if(f.columns&&f.columns.forEach((function(e,t){"chartFormatter"===e.formatter&&h&&(e.formatter=h)})),t.table=new ar.mu("#"+t.userData.cont_id,f),t.userData.theme){var b=Array.from(t.table.element.classList).filter((function(e){return e.startsWith("tabulator-theme-")}));b.length>0&&b.forEach((function(e){t.table.element.classList.remove(e)})),t.table.element.classList.add("tabulator-theme-"+t.userData.theme)}t.table.on("cellEdited",(function(e){t.saveToStorage()})),t.userData.keep_selection&&t.userData.selection&&t.userData.selection.length&&setTimeout((function(){var e=t.table.getRows(),a=[];e&&e.length&&e.forEach((function(e,n){var o=e.getData();t.userData.selection.findIndex((function(e){return e.id===o.id}))>-1&&a.push(o.id)})),t.table.selectRow(a)}),200),t.table.on("rowSelectionChanged",(function(e,a,n,o){if(e&&e.length){t.getOutputPort("output0").getConnections().each(Zr.proxy((function(e,a){var n=a.getTarget();n.userData||(n.userData={}),n.userData.realCount=1,n.superUpdate=!0,a.setColor("#dfdfdf"),DEBUG&&console.log(t.NAME+" id:"+t.id+" "+t.userData.cont_id+" update ticket send: to: "+n.getParent().userData.label+", Super: "+n.superUpdate),n.setValue("ticket,"+t.id+","+t.userData.cont_id)}),this));var i=e;t.userData.keep_selection&&(t.userData.selection=e),t.getPort("output0").setUserData({project:t.project||"",scope:t.scope||"",item_name:t.userData.cont_id,task_type:"rowSelect",sites_list_out:i}),t.getOutputPort(0).getConnections().each(Zr.proxy((function(e,a){a.getTarget().setValue(t.getId()),a.setColor("#afafaf")}),this))}})),t.table.on("cellClick",(function(e,a){if(a){var n=t.getOutputPort("output1");if(n){n.getConnections().each(Zr.proxy((function(e,a){var n=a.getTarget();n.userData||(n.userData={}),n.userData.realCount=1,n.superUpdate=!0,a.setColor("#dfdfdf"),DEBUG&&console.log(t.NAME+" id:"+t.id+" "+t.userData.cont_id+" update ticket send: to: "+n.getParent().userData.label+", Super: "+n.superUpdate),n.setValue("ticket,"+t.id+","+t.userData.cont_id)}),this));var o={};o[a.getField()]=a.getValue(),o.row_data=a.getData();var i=[o];n.setUserData({project:t.project||"",scope:t.scope||"",item_name:t.userData.cont_id,task_type:"cellClick",sites_list_out:i}),n.getConnections().each(Zr.proxy((function(e,a){a.getTarget().setValue(t.getId()),a.setColor("#afafaf")}),this))}}}))}else if("datatable"===t.userData.renderer){if("DIV"===a.nodeName){var v=document.createElement("table");v.classList.add("compact","display"),v.id=t.userData.cont_id,a.parentNode.appendChild(v),a.remove()}var w=JSON.parse(t.userData.config);t.userData.config&&(w=Zr.extend({},w,JSON.parse(t.userData.config),{data:e[0],columns:e[1],scrollX:!0}),Zr.fn.dataTable.isDataTable("#"+t.userData.cont_id)&&t.table.destroy(),t.table=Zr("#"+t.userData.cont_id).DataTable(w))}}var x=es.getShapeSVG("Table Adapter","Table ID: "+t.userData.cont_id,"HTML Mode");t.setSVG(x),t.oldAbsX=0,t.oldAbsY=0,t.applyTransformation()}};if(DEBUG&&console.log("RaTableAdapter table Update"),t.updateTickets=[],t.row.length){if(this.row.forEach((function(t,a){e.table_data=t})),"tabulator"===this.userData.renderer)a(this.table_data);else if("datatable"===this.userData.renderer){var n=[];this.table_data.forEach((function(e){n.push(Object.values(e))}));var o=new Set;this.table_data.forEach((function(e){Object.keys(e).forEach((function(e){return o.add(e)}))}));var i=[];o.forEach((function(e){i.push({title:e})})),a([n,i])}t.getPort("output0").setUserData({project:t.project||"",scope:t.scope||"",item_name:t.userData.cont_id,task_type:"empty",sites_list_out:[{}]}),t.getOutputPort(0).getConnections().each(Zr.proxy((function(e,a){a.getTarget().setValue(t.getId()),a.setColor("#a4a4a4")}),this));var r=t.getPort("output1");r&&(r.setUserData({project:t.project||"",scope:t.scope||"",item_name:t.userData.cont_id,task_type:"empty",sites_list_out:[{}]}),t.getOutputPort(1).getConnections().each(Zr.proxy((function(e,a){a.getTarget().setValue(t.getId()),a.setColor("#a4a4a4")}),this)))}DEBUG&&console.log("RaTableAdapter ".concat(t.id," updateTable completed successfully."))}catch(e){var s;if(console.error("Error during updateTable for node: ".concat(t.id," (").concat(t.NAME," - ").concat((null===(s=t.userData)||void 0===s?void 0:s.cont_id)||"Unknown Label",")"),e),t.sscope&&!t.sscope.aiReportNodeErrors&&(t.sscope.aiReportNodeErrors=[]),t.sscope){var l,c={nodeId:t.id,nodeName:t.NAME,nodeLabel:(null===(l=t.userData)||void 0===l?void 0:l.cont_id)||"Unknown Label",errorMessage:e.message};t.sscope.aiReportNodeErrors.push(c),console.log("Captured error for node ".concat(t.id," and stored in this.sscope.aiReportNodeErrors"))}else console.error("Cannot store error for node ".concat(t.id,": this.sscope is not defined."))}}}}),a("047a6245a1383d091f60"),a("e0f4b20108a8d9066aef");var ts=a("376226a4d62e8d4e335b"),as=a("a45670b3d8fb79ec0258"),ns=a("8deafab7866a125bb9ca");function os(e){return os="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},os(e)}c().shape.fishbone.ra.RaEchartAdapter=c().shape.fishbone.ra.RaSVGNode.extend({NAME:"draw2d.shape.fishbone.ra.RaEchartAdapter",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaEchartAdapter</strong>}<br/><br/>",init:function(e,t,a,n){this._super(as.extend({},e),t,a,n),this.sscope=n;var o=this,i={toogleInCon:{name:"Toogle In Connections"},load_svg:{name:"Load SVG"}};this.on("contextmenu",(function(e,t){as.contextMenu({selector:"body",events:{hide:function(){as.contextMenu("destroy")}},callback:as.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){o.toogleInConn()}),10);break;case"load_svg":setTimeout((function(){var e=document.createElement("input");e.type="file",e.click(),e.onchange=function(e){var t=e.target.files||[];if(t.length){var a=t[0];if("image/svg+xml"===a.type){document.createElement("object");var n=URL.createObjectURL(a);fetch(n).then((function(e){return e.text()})).then((function(e){if(console.log(e),e){var t=a.name.split(".")[0];o.userData.svgItems.push({svg:e,item_name:t})}}))}}}}),10)}}),this),x:t.x,y:t.y,items:i})})),this.apply_config=!1,as.extend(this.userData,{cont_id:"myEchart1",height:"300px",svgItems:[],theme:"light",dataset:JSON.stringify({dimensions:["product","2015"],source:[{product:"Matcha Latte",2015:43.3,2016:85.8,2017:93.7},{product:"Milk Tea",2015:83.1,2016:73.4,2017:55.1},{product:"Cheese Cocoa",2015:86.4,2016:65.2,2017:82.5},{product:"Walnut Brownie",2015:72.4,2016:53.9,2017:39.1}]}),config:"option = "+m().stringify({legend:{},tooltip:{},xAxis:{type:"category"},yAxis:{},series:[{type:"bar"}]},null,4)}),as.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{cont_id:{title:"Echart ID",type:"string"},height:{title:"Container Height",type:"string"},theme:{title:"Theme",type:"string",enum:["light","dark","vintage","westeros","wonderland","chalk","macarons","shine","halloween","essos","walden","infographic","roma","purple-passion"]},svgItems:{type:"array",title:"SVG",items:{type:"object",properties:{item_name:{title:"SVG Name",type:"string"},svg:{title:"svg",type:"string",format:"hidden"}}}},dataset:{type:"string",height:"140px",title:"Chart Dataset",format:"ace",aceMode:"ace/mode/json",disableWorker:!1,AItools:{sender:"dataset",tools:["left","gen","save_lib","load_lib","right"]}},config:{type:"string",title:"Chart Config",format:"ace",aceMode:"ace/mode/javascript",disableWorker:!1,AItools:{sender:"config",tools:["left","gen","edit","retry","edit_p","opti","save_lib","load_lib","right"]}}}}),this.AI||(this.AI={}),this.AI.config||(this.AI.config={}),this.AI.dataset||(this.AI.dataset={}),this.AI.config.generateAI=function(e){var t=ts.nodeDocumentation[8],a=t.examples||[],n="";a.length>0&&(n="\n\nEXAMPLE CONFIGURATIONS FOR REFERENCE:\n",a.forEach((function(e,t){n+="\nExample ".concat(t+1,": ").concat(e.name,"\n"),n+="Description: ".concat(e.description,"\n"),n+="Dataset structure: ".concat(e.dataset,"\n"),n+="Config pattern:\n".concat(e.config,"\n")})));var i={chatUuid:"",chatName:"",text:"".concat(t.documentation,"\n\nCURRENT DATASET:\n").concat(o.userData.dataset,"\n").concat(n,'\n\nBased on the dataset dimensions above and following the documentation guidelines:\n1. Select the most appropriate chart type for the data\n2. Create a complete ECharts configuration\n3. Use encode properties for all data mappings\n4. Include professional features (tooltip, toolbox, legend)\n5. NEVER include "data" property anywhere\n6. Return format: option = { ... }\n7. No code fencing or markdown\n\nGenerate the configuration now:')};ns.handleRegularResponse(i,o,e,o.userData.config,"config")},this.AI.dataset.generateAI=function(e){var t=[];o.userData.row.forEach((function(e){t.push(e.sites_list_out.slice(0,10))}));var a={chatUuid:"",chatName:"",text:"You are Web report developer. \n                Create an ECharts configuration dataset component object that:\n\n                1. Uses this data for structure analysis: \n                \n                ".concat(JSON.stringify(t),'\n                \n                2. Requirements:\n                - consider data trends, relations and hierarchy \n                - mandatory include dimensions parameter into final result for dataset\n                - include empty array as a source array\n                - include only actual dataset object in format: {"dimensions": [...], "source":[]} \n                - make sure all properties are quoted "..." for JSON compatibility\n                - Do not include ```javascript``` or ```json``` or any other code tags and without code fencing\n                - Configure based on the data structure above\n                Please provide the complete configuration object without any additional explanations.\n                ')};ns.handleRegularResponse(a,o,e,o.userData.config,"dataset")},this.AI.config.editAI=function(e,t,a){var n=prompt("Please specify your requirements:",t);if(n){var i,r,s;if(a)s=a;else{var l,c=ts.nodeDocumentation[8],u=c.examples||[],d="\n\nALL AVAILABLE ECHARTS EXAMPLES FOR REFERENCE:\n";u.forEach((function(e,t){d+="\n=== Example ".concat(t+1,": ").concat(e.name," ===\n"),d+="Description: ".concat(e.description,"\n"),d+="Dataset structure: ".concat(e.dataset,"\n"),d+="Configuration:\n".concat(e.config,"\n")})),s=null!==(l=o.AI)&&void 0!==l&&null!==(l=l.config)&&void 0!==l&&l.chatUuid?"Update configuration with new requirements:\n            1. ".concat(n," \n            \n            Following ECharts best practices from documentation:"):"Update provided Echarts configuration: \n            \n            ".concat(o.userData.config,"\n            \n            according to requirements:\n            1. ").concat(n),s+="\n\nDATASET REFERENCE:\n".concat(o.userData.dataset,"\n\nECHARTS NODE DOCUMENTATION:\n").concat(c.documentation).concat(d,'\n\nKEY REQUIREMENTS:\n- Use encode properties for data mapping\n- NEVER include "data" property\n- Return format: option = { ... }\n- Professional features: tooltip, toolbox, legend\n- No code fencing\n\nUpdate the configuration based on user requirements and examples above:')}var p={chatUuid:(null===(i=o.AI)||void 0===i||null===(i=i.config)||void 0===i?void 0:i.chatUuid)||"",chatName:(null===(r=o.AI)||void 0===r||null===(r=r.config)||void 0===r?void 0:r.chatName)||"",text:s};ns.handleRegularResponse(p,o,e,o.userData.config,"config",n)}else as(".overlaySpin").css("display","none")},this.AI.config.optiAI=function(e,t){var a,n,i=ts.nodeDocumentation[8],r=t||"You are an ECharts expert. Optimize the provided configuration using best practices.\n\nCURRENT CONFIGURATION:\n".concat(o.userData.config,"\n\nDATASET REFERENCE:\n").concat(o.userData.dataset,"\n\nOPTIMIZATION GUIDELINES FROM DOCUMENTATION:\n").concat(i.documentation,'\n\nOPTIMIZATION REQUIREMENTS:\n- Ensure proper format: option = {...}\n- Prevent component overlap (title, legend, series)\n- Add missing professional features:\n  * tooltip with proper trigger and formatter\n  * toolbox with saveAsImage, dataView, magicType\n  * proper grid spacing\n  * professional color palette\n- Use encode properties for all data mappings\n- NEVER include "data" property\n- Improve visual aesthetics:\n  * Add animations if missing\n  * Include emphasis effects\n  * Set proper borderRadius for bars\n  * Use smooth curves for lines\n- Format code with proper indentation\n                - check if there are any labels missing in case labels line are shown\n                - check if there are any issues with formatters and it is not resolving properly as it has to be according to chart type and fix it\n                - check if multiple series charts has to be distributed in view and fix it\n                - check it title is not overlaying any other components of chart and fix it\n                - Do not include ```javascript``` or ```json``` or any other code tags and without code fencing\n            '),s={chatUuid:(null===(a=o.AI)||void 0===a||null===(a=a.config)||void 0===a?void 0:a.chatUuid)||"",chatName:(null===(n=o.AI)||void 0===n||null===(n=n.config)||void 0===n?void 0:n.chatName)||"",text:r};ns.handleRegularResponse(s,o,e,o.userData.config,"config")},this.updateTable=function(e){var t=this,a=this;try{var n=function(e){if(a){var t,n,i,r,s,l,c=document.getElementById(a.userData.cont_id),u=ns.safeEval("()=>{return "+a.userData.config.replace("option = "," ")+"}",a);if(u.success?t=u.result:console.log(u.error),t&&(c||a.getOutputPort(0)&&a.getOutputPort(0).connections.data.length))c&&(c.parentNode.querySelector(".spin")&&(c.parentNode.querySelector(".spin").classList.remove("show-loader"),c.parentNode.querySelector(".spin").classList.add("hide-loader")),a.userData.height?c.style.height=a.userData.height:c.style.height="auto"),!a.userData.dataset&&t.dataset&&(a.userData.dataset=JSON.stringify(t.dataset,null,4)),t.dataset&&delete t.dataset,0===(null===(n=t.xAxis)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.length)&&delete t.xAxis.data,0===(null===(i=t.yAxis)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.length)&&delete t.yAxis.data,null!==(r=t.series)&&void 0!==r&&r.length&&t.series.forEach((function(e,t){var a;0===(null===(a=e.data)||void 0===a?void 0:a.length)&&delete e.data})),(Array.isArray(a.userData.dataset)||"object"===os(a.userData.dataset)&&null!==a.userData.dataset&&!Array.isArray(a.userData.dataset))&&(a.userData.dataset=JSON.stringify(a.userData.dataset,null,2)),a.userData.dataset&&(s=JSON.parse(a.userData.dataset)),e&&e.length&&s&&(e.length>1?(l&&!l.source||(s=[]),e.forEach((function(t,a){s[a]?as.extend(!0,s[a],{source:e[a]}):s.push({source:e[a]})})),s.length=e.length,(l=structuredClone(s)).forEach((function(e){e.source.length=1}))):(s&&!Array.isArray(s)||(s={}),s.source=e[0],(l=as.extend(!0,{},s)).source.length=1),a.userData.dataset=JSON.stringify(l,null,4)),a.echart&&Yt.dispose(a.echart),as.extend(!0,t,{dataset:s}),c&&(a.echart=Yt.init(c,a.userData.theme,{renderer:"canvas",useDirtyRect:!1}),a.echart.resize()),t&&"object"===os(t)&&(c&&a.echart.setOption(t),o=t),c&&window.addEventListener("resize",a.echart.resize);var d=ns.getShapeSVG("Echart Adapter","Chart ID: "+a.userData.cont_id,"HTML Mode");a.setSVG(d),a.oldAbsX=0,a.oldAbsY=0,a.applyTransformation()}},o={};DEBUG&&console.log("RaEchartAdapter "+a.id+" table Update"),this.updateTickets=[],this.userData.row.length?(this.table_data=[],this.userData.row.forEach((function(e,a){t.table_data.push(e.sites_list_out)})),n(this.table_data)):n();var i=a.getPort("output0");i&&i.setUserData({project:a.project||"",scope:a.scope||"",item_name:a.userData.cont_id,task_type:"echart_group",sites_list_out:[o]}),a.getOutputPort(0)&&a.getOutputPort(0).getConnections().each(as.proxy((function(e,t){t.getTarget().setValue(a.getId()),t.setColor("#a4a4a4")}),a)),DEBUG&&console.log("RaEchartAdapter ".concat(a.id," updateTable completed successfully."))}catch(e){var r;if(console.error("Error during updateTable for node: ".concat(a.id," (").concat(a.NAME," - ").concat((null===(r=a.userData)||void 0===r?void 0:r.cont_id)||"Unknown Label",")"),e),a.sscope&&!a.sscope.aiReportNodeErrors&&(a.sscope.aiReportNodeErrors=[]),a.sscope){var s,l={nodeId:a.id,nodeName:a.NAME,nodeLabel:(null===(s=a.userData)||void 0===s?void 0:s.cont_id)||"Unknown Label",errorMessage:e.message};a.sscope.aiReportNodeErrors.push(l),console.log("Captured error for node ".concat(a.id," and stored in this.sscope.aiReportNodeErrors"))}else console.error("Cannot store error for node ".concat(a.id,": this.sscope is not defined."))}},this.createPort("output"),this.layoutPorts()}});var is=a("8a868d10b6533e768658"),rs=a("a45670b3d8fb79ec0258");is.shape.fishbone.cell.EchartGroup=is.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.EchartGroup",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.EchartGroup</strong>}<br/><br/>",init:function(e,t,a,n){this._super(rs.extend({color:"#777777",filter_str:"Echarts Group",data_type:"row"},e),t,a,n);var o=this;rs.extend(this.userData,{group_name:"group_1",label:"New Group",type_name:"echart_group"}),rs.extend(!0,this.treema_scheme,{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{label:{type:"string",format:"hidden",default:"New Group"},group_name:{type:"string",title:"Group Name",default:"group_1"},type_name:{type:"string",title:"Type Name",default:"echart_group"}}}),this.updateTable=function(){console.log("echart_group updateTable"),o.userData.sites_list_out=[];var e=0;o.userData.row.length>0&&(o.getInputPorts().data.forEach((function(t,a){var n=t.getConnections();n.data.length&&n.data.forEach((function(t,a){var n=t.getSource().getParent();"draw2d.shape.fishbone.ra.RaEchartAdapter"===n.NAME&&n.echart&&(n.echart.group=o.userData.group_name,e++)}))})),e>1&&Yt.connect(o.userData.group_name)),o.userData.value=o.userData.row.length,o.getPort("output0").setUserData({project:o.project,scope:o.scope,sop:o.sop,item_name:o.userData.label,task_type:o.userData.type_name||"gap",sites_list_out:[{charts_count:e}]}),o.getOutputPort(0).getConnections().each(rs.proxy((function(e,t){t.getTarget().setValue(o.getId()),t.setColor(o.frame.attr("stroke"))}),this)),this.updateUI()}}});var ss=a("a45670b3d8fb79ec0258"),ls=a("8deafab7866a125bb9ca");c().shape.fishbone.ra.RaEchartMap=c().shape.fishbone.ra.RaSVGNode.extend({NAME:"draw2d.shape.fishbone.ra.RaEchartMap",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaEchartMap</strong>}<br/><br/>",init:function(e,t,a){this._super(ss.extend({},e),t,a);var n=this,o={toogleInCon:{name:"Toogle In Connections"},load_map:{name:"Load MAP"},export_map:{name:"Export MAP"}};this.on("contextmenu",(function(e,t){ss.contextMenu({selector:"body",events:{hide:function(){ss.contextMenu("destroy")}},callback:ss.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){n.toogleInConn()}),10);break;case"load_map":setTimeout((function(){var e=document.createElement("input");e.type="file",e.click(),e.onchange=function(e){var t=e.target.files||[];if(t.length){var a=t[0];if(a){document.createElement("object");var o=URL.createObjectURL(a);fetch(o).then((function(e){return e.text()})).then((function(e){e&&(n.userData.map=e)}))}}}}),10);break;case"export_map":setTimeout((function(){var e=Yt.getMap(n.userData.name);if(e.geoJson){var t=JSON.stringify(e.geoJson,null,2),a=new Blob([t],{type:"application/json"}),o="".concat(n.userData.name||"map","_export.json");(0,da.saveAs)(a,o)}else console.warn("No map data available to export")}),10)}}),this),x:t.x,y:t.y,items:o})})),this.apply_config=!1,ss.extend(this.userData,{map:{},name:""}),ss.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{name:{type:"string",title:"Map Name"},map:{type:"string",format:"hidden",height:"450px",title:"GEO Json"}}}),this.updateTable=function(e){DEBUG&&console.log("RaEchartMap "+this.id+" table Update"),this.updateTickets=[];var t={};if(n.userData.map&&n.userData.name){Yt.registerMap(n.userData.name,{geoJSON:JSON.parse(n.userData.map)});var a=ls.getShapeSVG("Echart Map","Register","HTML Mode");n.setSVG(a),n.oldAbsX=0,n.oldAbsY=0,n.applyTransformation(),n.getOutputPort(0)&&n.getOutputPort(0).connections.data.length&&(t=Yt.getMap(n.userData.name))}var o=n.getPort("output0");o&&o.setUserData({project:n.project||"",scope:n.scope||"",item_name:n.userData.name,task_type:"echart_map_reg",sites_list_out:t}),n.getOutputPort(0)&&n.getOutputPort(0).getConnections().each(ss.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor("#a4a4a4")}),this))},this.createPort("output"),this.layoutPorts()}});var cs=a("a45670b3d8fb79ec0258"),us=a("8deafab7866a125bb9ca");function ds(e){return ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ds(e)}c().shape.fishbone.ra.RaEchartMorph=c().shape.fishbone.ra.RaSVGNode.extend({NAME:"draw2d.shape.fishbone.ra.RaEchartMorph",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaEchartMorph</strong>}<br/><br/>",init:function(e,t,a){this._super(cs.extend({},e),t,a);var n=this;this.apply_config=!1,cs.extend(this.userData,{cont_id:"myEchart1Morph",height:"300px",timeout:4e3}),cs.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{cont_id:{title:"Echart ID",type:"string"},height:{title:"Container Height",type:"string"},timeout:{type:"integer",title:"Timeout (ms)",default:4e3}}}),this.updateTable=function(e){var t=this,a=function(e){if(n){var t=document.getElementById(n.userData.cont_id);if(t){var a=function(t){e[t]&&"object"===ds(e[t])&&n.echart.setOption(e[t],!0)};t.innerHTML="";var o=document.createElement("div");o.className="p-2 position-relative",o.style.zIndex="1",o.style.height="48px";var i=document.createElement("div");i.className="position-absolute start-0 ps-2 d-flex align-items-center",i.style.height="100%";var r=document.createElement("button");r.className="btn btn-sm me-2 d-flex align-items-center justify-content-center",r.innerHTML='<i class="bi bi-arrow-left"></i>',r.style.width="2em",r.style.height="2em";var s=document.createElement("div");s.className="position-absolute end-0 pe-2 d-flex align-items-center",s.style.height="100%";var l=document.createElement("button");l.className="btn btn-sm me-2 d-flex align-items-center justify-content-center",l.innerHTML='<i class="bi bi-arrow-right"></i>',l.style.width="2em",l.style.height="2em";var c=document.createElement("div");c.className="position-absolute top-50 start-50 translate-middle d-flex align-items-center";var u=document.createElement("button");u.className="btn btn-sm d-flex align-items-center justify-content-center",u.innerHTML='<i class="bi bi-pause-fill"></i>',u.style.width="2em",u.style.height="2em";var d=0,p=!0;r.onclick=function(){d=(d-1+e.length)%e.length,a(d)},l.onclick=function(){d=(d+1)%e.length,a(d)},u.onclick=function(){(p=!p)?(u.innerHTML='<i class="bi bi-pause-fill"></i>',n.interval=setInterval((function(){d=(d+1)%e.length,a(d)}),n.userData.timeout)):(u.innerHTML='<i class="bi bi-play-fill"></i>',clearInterval(n.interval))},i.appendChild(r),o.appendChild(i),c.appendChild(u),o.appendChild(c),s.appendChild(l),o.appendChild(s),t.appendChild(o);var h=document.createElement("div");h.className="content-wrapper",h.style.height=n.userData.height||"auto",h.style.transition="height 0.3s ease-out",t.appendChild(h),t.parentNode.querySelector(".spin")&&(t.parentNode.querySelector(".spin").classList.remove("show-loader"),t.parentNode.querySelector(".spin").classList.add("hide-loader")),n.userData.height?t.style.height=n.userData.height:t.style.height="auto",n.echart&&Yt.dispose(n.echart),n.echart=Yt.init(h,n.userData.theme,{renderer:"canvas",useDirtyRect:!1}),n.echart.resize(),e[0]&&"object"===ds(e[0])&&n.echart.setOption(e[0],!0),n.interval=setInterval((function(){p&&(d=(d+1)%e.length,a(d))}),n.userData.timeout),window.addEventListener("resize",n.echart.resize)}var f=us.getShapeSVG("Echart Morph","Chart ID: "+n.userData.cont_id,"HTML Mode");n.setSVG(f),n.oldAbsX=0,n.oldAbsY=0,n.applyTransformation()}};DEBUG&&console.log("RaEchartMorph "+this.id+" table Update"),this.updateTickets=[],this.userData.row.length?(this.table_data=[],this.userData.row.forEach((function(e,a){t.table_data.push(e.sites_list_out[0])})),a(this.table_data)):a()},this.createPort("output"),this.layoutPorts()}});var ps=a("28333c1a4e064830601d"),hs=a("a45670b3d8fb79ec0258"),fs=a("8deafab7866a125bb9ca"),ms=a("aeb57e88bcb04c329061"),gs=a("6fe5e339b0f8a936ba8c");c().shape.fishbone.cell.AIZTEnode=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.AIZTEnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.AIZTEnode</strong>}<br/><br/>",init:function(e,t,a,n){var o=this;this._super(hs.extend({filter_str:"AI",color:"#e1762a",background:"#fff3f3",text_color:"#5d5d5d",items:{save_config:{name:"Save Config",icon:"fas fa-file-download",callback:function(){var e=[o.getPersistentAttributes()];fs.removeData(e),e=JSON.stringify(e,null,2);var t=o.userData.label?o.userData.label:"node.conf",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,da.saveAs)(a,t)}},sep:"---------"}},e),t,a,n),this.help="Node which provides AI request facility integration into existing object structure.",hs.extend(this.userData,{result:"",stream:!1,prompt:"what will be 2+2*2",label:"New Query",params:[],hidePanel:!1,startCollapsed:!1}),hs.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{params:ms.template_params,result:{type:"string",title:"Result",height:"270px",format:"hidden",aceMode:"ace/mode/text",disableWorker:!1},prompt:{type:"string",title:"Prompt",height:"140px",format:"ace",aceMode:"ace/mode/text",disableWorker:!1},cont_id:{type:"string",title:"Cont ID",default:"aiCont1"},temperature:{type:"number",title:"Temperature",default:0},height:{title:"Chart Height",type:"string"},label:{type:"string",format:"hidden",default:"New Label"},model:{type:"string",title:"Model",default:"google/gemini-2.5-flash-preview-05-20",enum:["google/gemini-2.5-flash-preview-05-20"]},stream:{type:"boolean",title:"Stream",default:!1,format:"hidden"},hidePanel:{type:"boolean",title:"Hide Control Panel",default:!1},startCollapsed:{type:"boolean",title:"Start Collapsed",default:!1}}}),this.chat_history||(this.chat_history=[])},onSelect:function(){DEBUG&&console.log("AIZTEnode ".concat(this.id," selected")),this.chat&&this.cleanupChat(),this.chat=new ps.k({typingDelay:10,copyTimeout:1e3,figure:this,autoUpdate:!0})},cleanupChat:function(){if(this.chat)try{this.chat.cleanup(),this.chat=null}catch(e){console.error("Error cleaning up ChatApp:",e)}},loadTreema:function(){var e=this;fs.updateParamSourceCol(this),fs.updateParamDetailsCol(this),fs.updatePropKeyCol(this),this.isSelected()&&setTimeout((function(){e.onSelect()}),200),this._super(this)},updateTable:function(e){var t=this;if(this.userData.prompt&&!e){var a=this.getUserData(),n=fs.preparePrompt(a.prompt,a,!0);DEBUG&&(console.log("AIZTEnode update query id: ".concat(this.id," ").concat(a.label)),console.log(n));var o={id:"msg-".concat(Date.now()),full_text:n,text:a.prompt,sender:"user",timestamp:(new Date).toISOString()};this.chat_history.push(o);var i=null;this.chat&&(this.chat.sendFigureMessage(o),this.chat.activeRequestStart=Date.now(),i=this.chat.showTypingIndicator());var r={messages:[{role:"user",content:n}],temperature:this.userData.temperature||.3,model:"google/gemini-2.5-flash-preview-05-20",max_tokens:4e3,response_format:{type:"json_object"}},s=gs.context+"/apiai",l="".concat(s,"/").concat("getOpenRouterAPI","?user_id=").concat(window.user_id),c=function(e){var a=document.getElementById(t.userData.cont_id);if(a){var n=a.querySelector(".bi-gear");n&&(e?n.classList.add("fa-spin"):n.classList.remove("fa-spin"))}};c(!0),this.handleRegularResponse(l,r,i,c)}},handleStreamingResponse:function(e,t,a,n){var o=this,i="";fs.handleJsonPostStream(e,t,{onChunk:function(e){try{var t=(new TextDecoder).decode(e);if(i+=t,o.chat_history){var a=o.chat_history[o.chat_history.length-1];a&&"bot"===a.sender?a.text=i:o.chat_history.push({id:"msg-".concat(Date.now()),text:i,sender:"bot",timestamp:(new Date).toISOString()}),o.chat&&o.chat.renderMessage(o.chat_history[o.chat_history.length-1])}}catch(e){console.error("Error processing chunk:",e)}},onComplete:function(){n(!1),a&&o.chat&&o.chat.hideTypingIndicator(a),o.updateOutputAndConnections(i)},onError:function(e){n(!1),a&&o.chat&&o.chat.hideTypingIndicator(a),o.handleError(e)}})},handleRegularResponse:function(e,t,a,n){var o=this,i=localStorage.getItem("ai_openrouter_key")||"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";if(!i)return this.handleError("OpenRouter API key not found. Please configure your API key in the AI settings."),n(!1),void(a&&this.chat&&this.chat.hideTypingIndicator(a));DEBUG&&console.log("OpenRouter payload:",t),this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=hs.ajax({url:e,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",headers:{"x-api-key":i},data:JSON.stringify(t),success:function(e){var t,i;n(!1),a&&o.chat?o.chat.hideTypingIndicator(a):null!==(t=o.chat)&&void 0!==t&&t.typingIndicator&&o.chat.hideTypingIndicator(o.chat.typingIndicator);var r=null===(i=e.data)||void 0===i||null===(i=i.bo)||void 0===i?void 0:i.result;if(r){var s={id:"msg-".concat(Date.now()),text:r,full_text:r,sender:"bot",timestamp:(new Date).toISOString()};o.chat_history.push(s),o.chat&&o.chat.sendFigureMessage(s),o.updateOutputAndConnections(r)}else{var l=e.code?JSON.stringify(e.code):"No result returned from model";o.handleError(l)}},error:function(e,t,i){n(!1),a&&o.chat&&o.chat.hideTypingIndicator(a),o.handleError(i)}})},handleError:function(e){var t=(null==e?void 0:e.responseText)||(null==e?void 0:e.message)||String(e),a={id:"msg-".concat(Date.now()),text:"Error: ".concat(t),full_text:"Error: ".concat(t),sender:"bot",timestamp:(new Date).toISOString(),type:"error"};this.chat_history.push(a),this.chat&&this.chat.sendFigureMessage(a),this.userData.result=t,this.updateContainer(),console.error("API Error:",e),this.updateUI()},updateOutputAndConnections:function(e){var t=this;this.userData.value=1,this.userData.result=fs.removeCodeBlocks(e),this.userData.sites_list_out=[{result:e}],this.updateContainer();var a=this.getPort("output0");a&&(a.setUserData({project:this.project||"",scope:this.scope||"",item_name:this.userData.label,task_type:this.userData.task_type,sites_list_out:this.userData.sites_list_out}),this.getOutputPort(0).getConnections().each((function(e,a){a.getTarget().setValue(t.id),a.setColor(t.frame.attr("stroke"))}))),this.updateUI()},updateContainer:function(){var e=this;if(this.userData.cont_id){var t=document.getElementById(this.userData.cont_id);if(t){t.innerHTML="";var a=document.createElement("div");a.className="p-2 position-relative",a.style.zIndex="1",a.style.height="48px",a.style.display=this.userData.hidePanel?"none":"block";var n=document.createElement("div");n.className="position-absolute start-0 ps-2 d-flex align-items-center",n.style.height="100%";var o=document.createElement("i");o.className="bi bi-gear",this.xhr&&[1,2,3].includes(this.xhr.readyState)&&(o.className+=" fa-spin"),n.appendChild(o);var i=document.createElement("button");i.className="btn btn-sm ms-2 d-flex align-items-center justify-content-center",i.innerHTML=this.userData.hidePanel?'<i class="bi bi-eye-slash"></i>':'<i class="bi bi-eye"></i>',i.style.width="2em",i.style.height="2em",i.onclick=function(){e.userData.hidePanel=!e.userData.hidePanel,a.style.display=e.userData.hidePanel?"none":"block",i.innerHTML=e.userData.hidePanel?'<i class="bi bi-eye-slash"></i>':'<i class="bi bi-eye"></i>'},n.appendChild(i);var r=document.createElement("div");r.className="position-absolute end-0 pe-2 d-flex align-items-center",r.style.height="100%";var s=document.createElement("button");s.className="btn btn-sm me-2 d-flex align-items-center justify-content-center",s.innerHTML='<i class="bi bi-arrow-clockwise"></i>',s.style.width="2em",s.style.height="2em",s.onclick=function(){o.className="bi bi-gear fa-spin";var a=t.querySelector(".content-wrapper");a&&(a.innerHTML=""),l.disabled=!1,e.updateTable()};var l=document.createElement("button");l.className="btn btn-sm me-2 d-flex align-items-center justify-content-center",l.style.border="none",l.innerHTML='<i class="bi bi-x-lg"></i>',l.style.width="2em",l.style.height="2em",l.disabled=!0,l.onclick=function(){e.xhr&&4!==e.xhr.readyState&&(e.xhr.abort(),o.className="bi bi-gear",l.disabled=!0)};var c=document.createElement("button");c.className="btn btn-sm me-2 d-flex align-items-center justify-content-center",c.innerHTML='<i class="bi bi-arrows-fullscreen"></i>',c.style.width="2em",c.style.height="2em",c.onclick=function(){var t=document.createElement("div");t.className="modal-backdrop fade show",t.style.zIndex="2040",document.body.appendChild(t);var a=document.createElement("div");a.className="modal",a.style.display="block",a.style.zIndex="2050",a.style.overflowX="hidden",a.style.overflowY="auto";var n=document.createElement("div");n.className="modal-dialog modal-lg",n.style.width="90%",n.style.maxWidth="90%",n.style.margin="30px auto";var o=document.createElement("div");o.className="modal-content";var i=document.createElement("div");i.className="modal-header";var r=document.createElement("button");r.className="btn-close",r.style.fontSize="0.7rem",r.onclick=function(){document.body.removeChild(a),document.body.removeChild(t),document.body.style.overflow=""},i.appendChild(r);var s=document.createElement("div");if(s.className="modal-body p-0",s.style.height="80vh",e.userData.result){var l=document.createElement("iframe");l.sandbox.add("allow-scripts"),l.style.width="100%",l.style.height="100%",l.style.border="none";var c=new Blob([e.userData.result],{type:"text/html"});l.src=URL.createObjectURL(c),s.appendChild(l)}o.appendChild(i),o.appendChild(s),n.appendChild(o),a.appendChild(n),document.body.appendChild(a),document.body.style.overflow="hidden",a.onclick=function(e){e.target===a&&(document.body.removeChild(a),document.body.removeChild(t),document.body.style.overflow="")},document.addEventListener("keydown",(function e(n){"Escape"===n.key&&(document.body.removeChild(a),document.body.removeChild(t),document.body.style.overflow="",document.removeEventListener("keydown",e))}))};var u=document.createElement("button");u.className="btn btn-sm d-flex align-items-center justify-content-center",u.innerHTML='<i class="bi bi-chevron-up"></i>',u.style.width="2em",u.style.height="2em";var d=this.userData.startCollapsed;u.onclick=function(){var a=t.querySelector(".content-wrapper");a&&((d=!d)?(a.style.height="0",a.style.overflow="hidden",u.innerHTML='<i class="bi bi-chevron-down"></i>'):(a.style.height=e.userData.height||"auto",a.style.overflow="visible",u.innerHTML='<i class="bi bi-chevron-up"></i>'))},r.appendChild(s),r.appendChild(l),r.appendChild(c),r.appendChild(u),a.appendChild(n),a.appendChild(r),t.appendChild(a);var p=document.createElement("div");p.className="content-wrapper",p.style.height=this.userData.height||"auto",p.style.transition="height 0.3s ease-out",this.userData.startCollapsed&&(p.style.height="0",p.style.overflow="hidden",u.innerHTML='<i class="bi bi-chevron-down"></i>'),t.appendChild(p);var h=t.parentNode.querySelector(".spin");if(h&&(h.classList.remove("show-loader"),h.classList.add("hide-loader")),this.userData.result){var f=document.createElement("iframe");f.id="sandboxed",f.sandbox.add("allow-scripts"),f.style.width="100%",f.style.height="100%",f.style.border="none";var m=new Blob([this.userData.result],{type:"text/html"});f.src=URL.createObjectURL(m),p.appendChild(f),t.style.height="unset"}}}},getPersistentAttributes:function(){var e=this._super();return this.chat_history&&this.chat_history.length>0&&(e.chat_history=this.chat_history),e},setPersistentAttributes:function(e){this._super(e),e.chat_history&&(this.chat_history=e.chat_history)}}),a("6e841ed3e83e93f20bf1"),a("854402d9b0ad1beadd6f");var ys=a("a45670b3d8fb79ec0258"),_s=a("8deafab7866a125bb9ca");function bs(e){return bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bs(e)}function vs(e){return function(e){if(Array.isArray(e))return ws(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ws(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ws(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ws(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function xs(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ks(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?xs(Object(a),!0).forEach((function(t){Ds(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xs(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ds(e,t,a){return(t=function(e){var t=function(e){if("object"!=bs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=bs(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==bs(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ss(){var e,t,a="function"==typeof Symbol?Symbol:{},n=a.iterator||"@@iterator",o=a.toStringTag||"@@toStringTag";function i(a,n,o,i){var l=n&&n.prototype instanceof s?n:s,c=Object.create(l.prototype);return Cs(c,"_invoke",function(a,n,o){var i,s,l,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,s=0,l=e,p.n=a,r}};function h(a,n){for(s=a,l=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(l=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(s=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,s=0))}if(o||a>1)return r;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),s=u,l=f;(t=s<2?e:l)||!d;){i||(s?s<3?(s>1&&(p.n=-1),h(s,l)):p.n=l:p.v=l);try{if(c=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=e}else if((t=(d=p.n<0)?l:a.call(n,p))!==r)break}catch(t){i=e,s=1,l=t}finally{c=1}}return{value:t,done:d}}}(a,o,i),!0),c}var r={};function s(){}function l(){}function c(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(Cs(t={},n,(function(){return this})),t),d=c.prototype=s.prototype=Object.create(u);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,Cs(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=c,Cs(d,"constructor",c),Cs(c,"constructor",l),l.displayName="GeneratorFunction",Cs(c,o,"GeneratorFunction"),Cs(d),Cs(d,o,"Generator"),Cs(d,n,(function(){return this})),Cs(d,"toString",(function(){return"[object Generator]"})),(Ss=function(){return{w:i,m:p}})()}function Cs(e,t,a,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Cs=function(e,t,a,n){function i(t,a){Cs(e,t,(function(e){return this._invoke(t,a,e)}))}t?o?o(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(i("next",0),i("throw",1),i("return",2))},Cs(e,t,a,n)}function Ts(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function As(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function r(e){Ts(i,n,o,r,s,"next",e)}function s(e){Ts(i,n,o,r,s,"throw",e)}r(void 0)}))}}c().shape.fishbone.ra.RaVegaChart=c().shape.fishbone.ra.RaSVGNode.extend({NAME:"draw2d.shape.fishbone.ra.RaVegaChart",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaVegaChart</strong>}<br/><br/>",init:function(e,t,a,n){var o=this;this._super(ys.extend({},e),t,a),this.sscope=n;var r=this,s={toogleInCon:{name:"Toogle In Connections"},copyfullSpec:{name:"Copy Spec"},sep1:"---------",saveToLib:{name:"Save to Library...",disabled:function(){return!o.rendered}},editItem:{name:"Edit Library Item...",disabled:function(){return!o.rendered&&o.userData.recipe&&o.userData.recipe.author===n.username}},loadFromLib:{name:"Load From Library..."},update:{name:"Update..."},sep2:"---------",export:{name:"Export to SVG"},sep3:"---------",add_in_port:{name:"Add Output Port"}};this.on("contextmenu",(function(e,t){ys.contextMenu({selector:"body",events:{hide:function(){ys.contextMenu("destroy")}},callback:ys.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){r.toogleInConn()}),10);break;case"saveToLib":setTimeout((function(){r.getSVG().then((function(e){r._svg=e,n.editor.newVegaLibItem(r)}))}),10);break;case"editItem":setTimeout((function(){r.getSVG().then((function(e){r._svg=e,n.editor.editVegaLibItem(r)}))}),10);break;case"loadFromLib":setTimeout((function(){n.editor.getVegaLibItem(r)}),10);break;case"update":r.updateVersion();break;case"copyfullSpec":setTimeout((function(){var e=JSON.stringify(r.full_spec,null,4);navigator.clipboard.writeText(e).then((function(){}),(function(e){console.error("Async: Could not copy text: ",e)}))}),10);break;case"export":setTimeout((function(){r.exportToSVG()}),10);break;case"add_in_port":setTimeout((function(){r.createOutputPort(),r.updateUI()}),10)}}),this),x:t.x,y:t.y,items:s})})),ys.extend(this.userData,{source:"connection",cont_id:"myVegaChart1",leaflet:!1,renderer:"canvas",vega:!1,auto_update:!1,save_state:!1,url:"https://vega.github.io/vega/examples/bar-chart.vg.json",spec:JSON.stringify({$schema:"https://vega.github.io/schema/vega-lite/v5.json",data:{name:"data_name",values:[{category:"A",group:"x",value:.1},{category:"A",group:"y",value:.6},{category:"A",group:"z",value:.9},{category:"B",group:"x",value:.7},{category:"B",group:"y",value:.2},{category:"B",group:"z",value:1.1},{category:"C",group:"x",value:.6},{category:"C",group:"y",value:.1},{category:"C",group:"z",value:.2}]},mark:"bar",encoding:{x:{field:"category"},y:{field:"value",type:"quantitative"},xOffset:{field:"group"},color:{field:"group"}}},null,4),vis_target:"canvas"}),ys.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{source:{title:"Source",type:"string",default:"connection",enum:["connection","url"]},renderer:{title:"Renderer",type:"string",default:"canvas",enum:["SVG","canvas","raphael"]},signal_col:{format:"hidden",title:"Signals Columns",type:"number",default:2},cont_id:{title:"Chart ID",type:"string"},height:{title:"Chart Height",type:"string"},vis_target:{title:"Visualize To",type:"string",default:"canvas",enum:["canvas","html"]},leaflet:{title:"LeafLet Map",type:"boolean",default:!1},hide_action:{title:"Hide Action Button",type:"boolean",default:!0},vega:{title:"Vega Spec",type:"boolean",default:!0},label:{type:"string",format:"hidden",default:"Veg Chart"},vega_debug:{title:"Enable VEGA_DEBUG",type:"boolean",default:!0},auto_update:{title:"Auto Update",type:"boolean",default:!1},save_state:{title:"Save Chart State",type:"boolean",default:!0},recipe:{title:"Recipe",type:"object",properties:{id:{title:"ID",type:"string"},author:{title:"Author",type:"string"},version:{title:"Version",type:"number"}}},url:{title:"Sample URL",format:"hidden",type:"string",default:""},spec:{type:"string",title:"Spec",format:"ace",aceMode:"ace/mode/json",AItools:{sender:"config",tools:["left","gen","edit","retry","edit_p","opti","save_lib","load_lib","right"]}},func:{type:"string",title:"Custom Functions",format:"ace",aceMode:"ace/mode/javascript"},sync_with_node_id:{title:"Sync With Chart ID",type:"string",default:""},sync_enabled:{title:"Enable Map Sync",type:"boolean",default:!1}}});var l=r.userData.vega?"Vega":"Vega-Light",u=' \n            \n\n            Result Requirements:\n            - Strictly follow this format for data objects:\n            {\n               "name": here is the name from input data object,\n               "values": [ this array should be empty ]\n            }\n            - do not include any comments or explanation in returned '.concat(l," JSON spec\n            - strictly return full JSON ").concat(l,' spec\n            - return empty array for "value" property of data objects\n            - remove code fencing (the triple backticks and language identifier) from result\n            - Do not include ```javascript``` or ```json``` or any other code tags and without code fencing\n            - Configure based on the data structure above\n            - make decision on chart type and configuration according to data structure and its nature to provide most suitable vibrant and coherent visualization\n            - Please provide the complete JSON configuration object without any additional explanations or comments.\n              Validation:\n            - Verify all required fields are present\n            - Ensure valid fields references\n            - Check property name consistency\n            - Validate data references\n            \n            Please adhere strictly to the following requirements to JSON specifications:\n            1. All JSON objects must follow RFC 8259 compliant syntax\n            2. String values must be enclosed in double quotes (")\n            3. Property names must be enclosed in double quotes (")\n            4. Boolean values must be lowercase (true/false, not True/False)\n            5. Null values must be represented as null (not NULL, None, nil, etc.)\n            6. Numbers should be represented without quotes\n            7. Arrays must use square brackets [ ]\n            8. Objects must use curly braces { }\n            9. No trailing commas are allowed in arrays or objects\n            10. No comments are permitted in the JSON structure\n            11. Proper escaping must be used for special characters in strings\n            \n            Example of correct JSON formatting:\n            {\n              "name": "John Doe",\n              "age": 30,\n              "isActive": true,\n              "interests": ["programming", "music", "hiking"],\n              "address": {\n                "street": "123 Main St",\n                "city": "Anytown"\n              },\n              "notes": null\n            }\n            '),d='\n        When generating Vega specifications, please follow these strict rules and patterns:\n        1. JSON Structure\n        \n        Always use double quotes for all property names and string values\n        Ensure all property names are quoted (e.g., "type", "scale", "field")\n        Use proper JSON syntax for nested objects and arrays\n        Maintain consistent indentation\n        Never use single quotes\n        Always use commas to separate object properties and array items\n        Never include trailing commas\n        \n        2. Field References\n        \n        Always use proper object notation for field references\n        Correct: {"field": "total_records"}\n        Incorrect: field: total_records or field: ["total_records"]\n        \n        3. Scale References\n        \n        Always use complete scale reference objects\n        Correct: {"scale": "angleScale", "field": "total_records"}\n        Incorrect: scale: angleScale, field: total_records\n        \n        4. Signal References\n        \n        Always wrap signal references in an object with the "signal" property\n        Correct: {"signal": "width"}\n        Incorrect: signal: width\n        \n        5. Mathematical Expressions\n        \n        Use proper Vega expression syntax for calculations\n        Wrap expressions in signal references\n        Use proper concatenation for mathematical operations\n        Correct: {"signal": "datum.total_records / 2"}\n        Incorrect: {datum.total_records / 2}\n        \n        Example Template for Common Patterns:\n        jsonCopy{\n          "$schema": "https://vega.github.io/schema/vega/v5.json",\n          "data": [\n            {\n              "name": "source_data",\n              "values": []\n            }\n          ],\n          "signals": [\n            {\n              "name": "width",\n              "value": 500\n            },\n            {\n              "name": "height",\n              "value": 300\n            }\n          ],\n          "scales": [\n            {\n              "name": "xscale",\n              "type": "band",\n              "domain": {"data": "source_data", "field": "category"},\n              "range": [0, {"signal": "width"}]\n            }\n          ],\n          "marks": [\n            {\n              "type": "rect",\n              "from": {"data": "source_data"},\n              "encode": {\n                "enter": {\n                  "x": {"scale": "xscale", "field": "category"},\n                  "width": {"scale": "xscale", "band": 1},\n                  "y": {"scale": "yscale", "field": "value"},\n                  "y2": {"scale": "yscale", "value": 0}\n                }\n              }\n            }\n          ]\n        }\n        Common Pitfalls to Avoid:\n        \n        Unquoted property names\n        Missing commas between properties\n        Incorrect scale references\n        Improper mathematical expressions\n        Incorrect field references\n        Missing signal wrappers\n        Improper nesting of objects and arrays\n        \n        For Combined Visualizations:\n        \n        Use proper group marks for separate chart components\n        Ensure consistent coordinate spaces\n        Use proper offset calculations for positioning\n        Maintain proper scope for scales and signals\n        Ensure proper data referencing across components\n        \n        Testing Instructions:\n        \n        Validate the generated JSON using a JSON validator\n        Verify all property names are quoted\n        Check for proper scale and signal references\n        Validate mathematical expressions\n        Ensure proper nesting and grouping\n        Verify data field references match the expected data structure\n        \n        Use this template and guidelines to ensure generation of valid Vega specifications that will render correctly.\n                ';this.AI||(this.AI={}),this.AI.spec||(this.AI.spec={}),this.AI.spec.generateAI=function(e){var t=[];r.userData.row.forEach((function(e,a){t.push({name:e.item_name,values:Object.values(r.row[a]).slice(0,10)})}));var a="\n            Please help me create a ".concat(l," visualization specification for my data in JSON format.\n            \n\n            Here is my data: \n            ").concat(JSON.stringify(t),"\n            ")+u+d;DEBUG&&console.log(a);var n={chatUuid:"",chatName:"",text:a};_s.handleRegularResponse(n,r,e,r.userData.spec,"spec")},this.AI.spec.editAI=function(e,t,a){var n=prompt("Please specify your requirements:",t);if(n){var o,i,s=[];r.userData.row.forEach((function(e,t){s.push({name:e.item_name,values:Object.values(r.row[t]).slice(0,10)})}));var l,c=r.userData.vega?"Vega NOT Vega-light":"Vega-Light";DEBUG&&console.log(l),a?l=a:(l="\n                    Please help me update an ".concat(c," visualization specification according to my data in JSON format: \n                    \n                    ").concat(JSON.stringify(s),"\n                    \n\n                    Please consider my current ").concat(c," specification  :\n                    ").concat(r.userData.spec,"\n                    \n\n                    and new requirements:\n                    ").concat(n,"\n            \n                    ")+u+d,DEBUG&&console.log(l));var p={chatUuid:(null===(o=r.AI)||void 0===o||null===(o=o.spec)||void 0===o?void 0:o.chatUuid)||"",chatName:(null===(i=r.AI)||void 0===i||null===(i=i.spec)||void 0===i?void 0:i.chatName)||"",text:l};_s.handleRegularResponse(p,r,e,r.userData.spec,"spec",n)}else ys(".overlaySpin").css("display","none")},this.AI.spec.optiAI=function(e,t){var a,n,o=[];r.userData.row.forEach((function(e,t){o.push({name:e.item_name,values:Object.values(r.row[t]).slice(0,10)})}));var i=r.userData.vega?"Vega NOT Vega-light":"Vega-Light",s=t||"\n            Please help me to check an ".concat(i," visualization according to my data array: \n            \n            ").concat(JSON.stringify(o),"\n            \n            and Please consider my current ").concat(i," specification  :\n            ").concat(r.userData.spec,'\n            \n            and fix any possible issues:\n            - remove any text explanations\n            - make sure there is "name" property in data objects properly refer to provided data name\n            - make sure "values" array is empty in data objects\n            - fix syntax errors\n            - fix JSON format issues\n            - fix any non double quoted properties \n            - remove any comments in code\n            - clean array for "value" property of data objects\n            - remove code fencing (the triple backticks and language identifier) from result\n            - remove ```javascript``` or ```json``` or any other code tags\n            - Ensure valid JSON syntax\n            - Verify all required fields are present\n            \n            ')+d;DEBUG&&console.log(s);var l={chatUuid:(null===(a=r.AI)||void 0===a||null===(a=a.spec)||void 0===a?void 0:a.chatUuid)||"",chatName:(null===(n=r.AI)||void 0===n||null===(n=n.spec)||void 0===n?void 0:n.chatName)||"",text:s};_s.handleRegularResponse(l,r,e,r.userData.spec,"spec")},this.exportToSVG=function(){this.view||(this.view=new Qt.View(Qt.parse(this.full_spec),{renderer:"none"})),this.view.toSVG().then((function(e){var t=new Blob([e],{type:"image/svg+xml"});(0,da.saveAs)(t,"vega_chart_export.svg")}))},this.getSVG=function(){return this.view=new Qt.View(Qt.parse(this.full_spec),{renderer:"none"}),this.view.toSVG()},this.setSpec=function(e){this.userData.spec=e,this.rendered&&this.updateTable()},this.updateVersion=function(){r.new_version&&r.new_version.spec&&(r.userData.recipe={id:r.new_version._id,author:r.new_version.author,version:r.new_version.version},r.setSpec(r.new_version.spec),r.checkVersion())},this.checkVersion=As(Ss().m((function e(){var t=this;return Ss().w((function(e){for(;;)switch(e.n){case 0:this.userData.spec&&this.userData.recipe&&this.userData.recipe.id&&fetch(i().context+"/mongo/getVegaLibItem?item_id="+this.userData.recipe.id).then((function(e){return e.json()})).then((function(e){if(r.new_version=e,r.userData.auto_update)r.updateVersion();else if(r.new_version.version!==r.userData.recipe.version){var a='<svg width="150" height="50" xmlns="http://www.w3.org/2000/svg" ><rect id="Rectangle-1" rx="15" ry="15" stroke-width="2" stroke="#777" fill="none" width="150" height="50"></rect><text x="0" y="-10" text-anchor="start" font-family="Tahoma, Geneva" font-size="12px" stroke="none" fill="red" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 12px; font-weight: bold; font-style: normal;" font-weight="bold" font-style="normal">New Ver. '+r.new_version.version+'</text><text x="12" y="15" text-anchor="start" font-family="Tahoma, Geneva" font-size="16px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 16px; font-weight: bold; font-style: normal;" font-weight="bold" font-style="normal">Vega Chart</text><text x="12" y="30" text-anchor="start" font-family="Tahoma, Geneva" font-size="12px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 12px; font-weight: bold; font-style: normal;" font-weight="bold" font-style="normal">Chart ID: '+r.userData.cont_id+'</text><text x="12" y="43" text-anchor="start" font-family="Tahoma, Geneva" font-size="8px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 8px; font-weight: bold; font-style: normal;" font-style="normal">HTML Mode</text></svg>';r.setSVG(a);var n="t"+t.getAbsoluteX()+","+t.getAbsoluteY()+"...";r.svgNodes.transform(n)}}));case 1:return e.a(2)}}),e,this)}))),this.updateTable=function(e){var t=this;try{if(t.checkVersion(),!e){var a=function(e){if(t.view&&t.userData.save_state){var a=t.view.getState({signals:function(e,t){return e.indexOf("__save_")>-1},data:function(e){return e.indexOf("__save_")>-1},recurse:!0});t.save_signals=a}if(Qt.expressionFunction("exportToExcel")||Qt.expressionFunction("exportToExcel",(function(e){e&&e.length&&(DEBUG&&console.log(e),_s.exportArrayToExcel(e))})),Qt.expressionFunction("getObject")||Qt.expressionFunction("getObject",(function(e){if(e&&e.length)return DEBUG&&console.log(e),e[0]})),Qt.expressionFunction("viewDvata")||Qt.expressionFunction("viewData",(function(e){e&&e.length&&(DEBUG&&console.log(e),setTimeout((function(){n.editor.viewTable(e)}),10))})),Qt.expressionFunction("sendData")||Qt.expressionFunction("sendData",(function(e,a){DEBUG&&console.log(e),setTimeout((function(){var n=t.getOutputPort(a),o=n.getConnections(),i=e;n.setUserData({project:t.project||"",scope:t.scope||"",item_name:t.userData.cont_id,task_type:"rowSelect",sites_list_out:i}),o.each(ys.proxy((function(e,a){a.getTarget().setValue(t.getId()),a.setColor("#777")}),this))}),10)})),t.rendered=!0,DEBUG&&console.log("VegaChart :"+t.id+" render"),t)if(t.userData.vis_target&&"canvas"!==t.userData.vis_target){if("html"===t.userData.vis_target){var o=ys("#html-container");if(DEBUG&&console.log("VegaChart :"+t.id+" container "+o),o){var i=document.getElementById(t.userData.cont_id);if(DEBUG&&console.log("VegaChart :"+t.id+" chart "+i),i)if(i.parentNode.querySelector(".spin")&&(i.parentNode.querySelector(".spin").classList.remove("show-loader"),i.parentNode.querySelector(".spin").classList.add("hide-loader")),t.userData.height?i.style.height=t.userData.height:i.style.height="auto",t.userData.leaflet)if(t.map){if(t.layer.removeFrom(t.map),t.layer=L.vega(e,{vega:Qt,delayRepaint:!1}),t.layer.addTo(t.map),t.userData.vega_debug&&(window.VEGA_DEBUG=window.VEGA_DEBUG||{},window.VEGA_DEBUG=t.layer._view),t.userData.func){var r=_s.safeEval(t.userData.func,t,{view:t.layer._view});r.success||console.log(r.error)}}else{if(t.map=L.map(t.userData.cont_id).setView([4.2876,102.59],8),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(t.map),t.layer=L.vega(e,{vega:Qt,delayRepaint:!1}),t.layer.addTo(t.map),t.userData.vega_debug&&(window.VEGA_DEBUG=window.VEGA_DEBUG||{},window.VEGA_DEBUG=t.layer._view,t.userData.func)){var s=_s.safeEval(t.userData.func,t,{view:t.layer._view});s.success||console.log(s.error)}t.initializeSynchronization()}else t.userData.vega_debug?(DEBUG&&console.log("VegaChart "+t.id+" DEBUG embed mode initiated"),t.view=new Qt.View(Qt.parse(e),{container:"#"+t.userData.cont_id,renderer:t.userData.renderer}),t.view.runAsync().then((function(e){t.view&&t.save_signals&&e.setState(t.save_signals),window.VEGA_DEBUG=window.VEGA_DEBUG||{},window.VEGA_DEBUG=t.view;var a=i.querySelector(".vega-bindings");if(a){if(t.userData.signal_col){for(var n="a",o=1;o<t.userData.signal_col;o++)n+=" a";a.style.gridTemplateAreas='"'+n+'"'}a.style.alignContent="space-between"}if(DEBUG&&console.log("VegaChart "+t.id+" DEBUG embed mode activated"),t.userData.func){var r=_s.safeEval(t.userData.func,t,{view:t.view});r.success||console.log(r.error)}})).catch(console.error)):(DEBUG&&console.log("VegaChart "+t.id+" NO DEBUG embed mode initiated"),t.view=new Qt.View(Qt.parse(e),{container:"#"+t.userData.cont_id,renderer:t.userData.renderer}),t.view.runAsync().then((function(e){t.view&&t.save_signals&&e.setState(t.save_signals);var a=i.querySelector(".vega-bindings");if(a){if(t.userData.signal_col){for(var n="a",o=1;o<t.userData.signal_col;o++)n+=" a";a.style.gridTemplateAreas='"'+n+'"'}a.style.alignContent="space-between"}if(DEBUG&&console.log("VegaChart "+t.id+" NO DEBUG embed mode activated"),t.userData.func){var r=_s.safeEval(t.userData.func,t,{view:t.view});r.success||console.log(r.error)}})).catch(console.error))}var l='<svg width="150" height="50" xmlns="http://www.w3.org/2000/svg" ><rect id="Rectangle-1" rx="15" ry="15" stroke-width="2" stroke="#777" fill="none" width="150" height="50"></rect><text x="12" y="15" text-anchor="start" font-family="Tahoma, Geneva" font-size="16px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 16px; font-weight: bold; font-style: normal;" font-weight="bold" font-style="normal">Vega Chart</text><text x="12" y="30" text-anchor="start" font-family="Tahoma, Geneva" font-size="12px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 12px; font-weight: bold; font-style: normal;" font-weight="bold" font-style="normal">Chart ID: '+t.userData.cont_id+'</text><text x="12" y="43" text-anchor="start" font-family="Tahoma, Geneva" font-size="8px" stroke="none" fill="#777777" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: Tahoma, Geneva; font-size: 8px; font-weight: bold; font-style: normal;" font-style="normal">HTML Mode</text></svg>';t.setSVG(l),t.oldAbsX=0,t.oldAbsY=0,t.applyTransformation()}}else t.view=new Qt.View(Qt.parse(e),{renderer:"none"}),t.view.toSVG().then((function(e){t.setSVG(e),t.oldAbsX=0,t.oldAbsY=0,t.applyTransformation()})).catch((function(e){console.error(e)}))};DEBUG&&console.log("RaVegaChart :"+t.id+" Update"),t.updateTickets=[];var o=t.getUserData();if("connection"===o.source){if(this.row.length){var i=m().parse(o.spec),r=m().parse(o.spec);this.row.forEach((function(e,t){if(o.spec&&o.row[t]&&Yi.findPath(i,(function(e){return e.name===o.row[t].item_name}))&&e){var a=e,n=Yi.findPath(i,(function(e){return e.name===o.row[t].item_name}));i=Yi.updateByPath(i,n,(function(e){return ks(ks({},e),{},{values:a})})),r=a[0]?Yi.updateByPath(r,n,(function(e){return ks(ks({},e),{},{values:[a[0]]})})):Yi.updateByPath(r,n,(function(e){return ks(ks({},e),{},{values:["map data..."]})}))}})),o.spec=JSON.stringify(r,null,4);var s;s=t.userData.vega?m().parse(JSON.stringify(i)):tr.compile(i).spec,this.full_spec=i,a(s)}else if(o.spec){var l;l=t.userData.vega?JSON.parse(o.spec):tr.compile(JSON.parse(o.spec)).spec,a(l)}}else o.source&&"url"!==o.source||fetch(o.url).then((function(e){return e.json()})).then((function(e){var n=e;if(n.data[0].url){var o=t.userData.url.substring(0,t.userData.url.indexOf("examples"))+n.data[0].url;fetch(o).then((function(e){return e.json()})).then((function(e){if(delete n.data[0].url,n.data[0].values=e,n.data[1]&&n.data[1].url){var o=t.userData.url.substring(0,t.userData.url.indexOf("examples"))+n.data[1].url;fetch(o).then((function(e){return e.json()})).then((function(e){delete n.data[1].url,n.data[1].values=e,a(n)}))}else a(n)}))}else a(e)})).catch((function(e){return console.log(e)}))}DEBUG&&console.log("RaVegaChart ".concat(t.id," updateTable completed successfully."))}catch(e){var c,u;if(console.error("Error during updateTable for node: ".concat(t.id," (").concat(t.NAME," - ").concat((null===(c=t.userData)||void 0===c?void 0:c.cont_id)||(null===(u=t.userData)||void 0===u?void 0:u.label)||"Unknown Label",")"),e),t.sscope&&!t.sscope.aiReportNodeErrors&&(t.sscope.aiReportNodeErrors=[]),t.sscope){var d,p,h={nodeId:t.id,nodeName:t.NAME,nodeLabel:(null===(d=t.userData)||void 0===d?void 0:d.cont_id)||(null===(p=t.userData)||void 0===p?void 0:p.label)||"Unknown Label",errorMessage:e.message};t.sscope.aiReportNodeErrors.push(h),console.log("Captured error for node ".concat(t.id," and stored in this.sscope.aiReportNodeErrors"))}else console.error("Cannot store error for node ".concat(t.id,": this.sscope is not defined."))}},this.on("removed",(function(){var e=r.getCanvas();e&&e.getFigures().each((function(e,t){t instanceof c().shape.fishbone.ra.RaVegaChart&&t.userData.sync_enabled&&t.userData.sync_with_node_id===r.id&&(t.userData.sync_enabled=!1,t.userData.sync_with_node_id="",t.syncTargets&&t.syncTargets.length&&vs(t.syncTargets).forEach((function(e){e===r&&t.removeSynchronization(e,!1)})),console.log("Disabled synchronization on ".concat(t.userData.cont_id||t.id," because target ").concat(r.id," was removed")))})),r.syncTargets&&r.syncTargets.length&&(vs(r.syncTargets).forEach((function(e){r.removeSynchronization(e)})),r.syncTargets=[])}))},initializeSynchronization:function(){if(this.userData.sync_enabled&&this.userData.sync_with_node_id&&this.map){var e=this.getCanvas();if(e){var t=e.getFigure(this.userData.sync_with_node_id);t instanceof c().shape.fishbone.ra.RaVegaChart?t.map?this.isSynchronizedWith(t)||(this.synchronizeWith(t),console.log("Chart ".concat(this.id," synchronized with ").concat(t.id))):console.log("Target chart ".concat(t.id," map not ready yet. Will try again later.")):console.warn("Target chart with ID ".concat(this.userData.sync_with_node_id," not found or not a RaVegaChart"))}}},isSynchronizedWith:function(e){return this.syncTargets&&this.syncTargets.includes(e)},getPersistentAttributes:function(){var e,t=this._super();return this.view&&this.userData.save_state?(e=this.view.getState({signals:function(e,t){return e.indexOf("__save_")>-1},data:function(e){return e.indexOf("__save_")>-1},recurse:!0}),t.save_signals=m().stringify(e)):delete t.save_signals,t},setPersistentAttributes:function(e){this._super(e),e.save_signals&&this.userData.save_state?this.save_signals=m().parse(e.save_signals):delete this.save_signals},synchronizeWith:function(e){var t,a=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.userData.leaflet&&e.userData.leaflet?this.map&&e.map?(this.syncTargets=this.syncTargets||[],this.syncTargets.includes(e)||this.syncTargets.push(e),this._moveHandler&&this.map.off("move",this._moveHandler),this._zoomHandler&&this.map.off("zoomend",this._zoomHandler),this._moveHandler=function(){a._syncMoveToTargets()},this._zoomHandler=function(){a._syncZoomToTargets()},this.map.on("move",this._moveHandler),this.map.on("zoomend",this._zoomHandler),!n||null!==(t=e.syncTargets)&&void 0!==t&&t.includes(this)||e.synchronizeWith(this,!1),console.log("Synchronized ".concat(this.userData.cont_id||this.id," with ").concat(e.userData.cont_id||e.id)),this._initialSync(e)):console.warn("Both charts must have their maps initialized for synchronization"):console.warn("Both charts must have leaflet mode enabled for synchronization")},_initialSync:function(e){var t=e.map.getCenter();if(e.map.getZoom(),Math.abs(t.lat-4.2876)<.01&&Math.abs(t.lng-102.59)<.01){var a=this.map.getCenter(),n=this.map.getZoom();e.map.setView(a,n,{animate:!1})}},_syncMoveToTargets:function(){var e=this;if(this.sscope.editor.sync_vega&&this.syncTargets&&this.syncTargets.length&&this.map){var t=this.map.getCenter(),a=this.map.getZoom(),n=Date.now().toString();this._currentSyncId=n,this.syncTargets.forEach((function(o){o.map&&o.map!==e.map&&o._currentSyncId!==n&&(o._currentSyncId=n,o.map.setView(t,a,{animate:!1}))}))}},_syncZoomToTargets:function(){var e=this;if(this.sscope.editor.sync_vega&&this.syncTargets&&this.syncTargets.length&&this.map){var t=this.map.getZoom(),a=Date.now().toString();this._currentSyncId=a,this.syncTargets.forEach((function(n){n.map&&n.map!==e.map&&n._currentSyncId!==a&&(n._currentSyncId=a,n.map.setZoom(t,{animate:!1}))}))}},removeSynchronization:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.syncTargets){var a=this.syncTargets.indexOf(e);-1!==a&&this.syncTargets.splice(a,1)}this.syncTargets&&0!==this.syncTargets.length||this.map&&(this._moveHandler&&(this.map.off("move",this._moveHandler),this._moveHandler=null),this._zoomHandler&&(this.map.off("zoomend",this._zoomHandler),this._zoomHandler=null)),t&&e.removeSynchronization(this,!1),console.log("Removed synchronization between ".concat(this.userData.cont_id||this.id," and ").concat(e.userData.cont_id||e.id))}}),a("8b8d4cc31634fce1d9c5"),a("5319b9f50d5ba746a053"),a("5337ae24b93bd12275f0");var Ps=a("a45670b3d8fb79ec0258"),Es=a("8deafab7866a125bb9ca"),Is=a("aeb57e88bcb04c329061"),Ns=a("6fe5e339b0f8a936ba8c");c().shape.fishbone.cell.APInode=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.APInode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.APInode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(Ps.extend({filter_str:"API",color:"#10b7f0",items:{sate_config:{name:"Save Config",icon:"fas fa-file-download",callback:function(){var e=[o.getPersistentAttributes()];Es.removeData(e),e=JSON.stringify(e,null,2);var t=o.userData.label?o.userData.label:"node.conf",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,da.saveAs)(a,t)}},sep:"---------"}},e),t,a,n),this.help="Node witch is providing API request facility integration into existing object structure.";var o=this;Ps.extend(this.userData,{apiid:"",label:"API Call",params:[]}),Ps.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{params:Is.template_params,lookups:Is.template_lookups,apiid:{type:"string",title:"API ID",default:""},label:{type:"string",format:"hidden",default:"New Label"},limit:{type:"string",title:"Page Limit",default:""},offset:{type:"string",title:"Page Offset",default:""},pagesize:{type:"string",title:"Page Size",default:""},order_list:{type:"array",title:"Order By",items:{type:"object",title:"Item",properties:{field_name:{type:"string",title:"Column Name"},sort:{type:"string",title:"Sort",enum:["ASC","DESC"]}}}},split_du_id:{type:"boolean",title:"Split du_id",default:!0},parse_json:{type:"boolean",title:"Parse JSON",default:!0}}}),this.updateTable=function(){DEBUG&&console.log(this.NAME+" id:"+this.id+" "+o.userData.label+" updateTable"),this.updateTickets=[];var e=this.getUserData();this.val_label.setText(".");var t=Es.getParams(e),a="";if(e.order_list&&e.order_list.length){var n=[];e.order_list.forEach((function(e,t){n.push(e.field_name+","+e.sort)})),a=JSON.stringify(n)}var i=Ns.context+"/apidata/getAPIData?apiid="+e.apiid+"&user_id="+window.user_id;o.userData.limit&&(i=i+"&limit="+o.userData.limit),o.userData.offset&&(i=i+"&offset="+o.userData.offset),o.userData.pagesize&&(i=i+"&pagesize="+o.userData.pagesize),a&&(i=i+"&orderby="+a),o.userData.split_du_id&&(i=i+"&split="+!!o.userData.split_du_id),o.userData.parse_json&&(i=i+"&parse_json="+!!o.userData.parse_json),this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),e.apiid&&(this.xhr=Ps.ajax({url:i,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(t),success:function(e){var t=e.data?e.data:e;o.userData.sites_list_out=t,o.userData.value=o.userData.sites_list_out.length,o.getPort("output0").setUserData({project:o.project||"",scope:o.scope||"",item_name:o.userData.label,task_type:o.userData.task_type,sites_list_out:o.userData.sites_list_out}),o.getOutputPort(0).getConnections().each(Ps.proxy((function(e,t){t.getTarget().setValue(o.id),t.setColor(o.frame.attr("stroke"))}),this)),o.updateUI(),o.stopTimer()},error:function(e,t){console.log(t)}}))}},loadTreema:function(){Es.updateParamSourceCol(this),Es.updateParamDetailsCol(this),Es.updatePropKeyCol(this),this._super(this)}});var Ms=a("a45670b3d8fb79ec0258"),Os=a("8deafab7866a125bb9ca"),js=a("aeb57e88bcb04c329061"),Rs=a("6fe5e339b0f8a936ba8c");c().shape.fishbone.cell.UrlAPInode=c().shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.UrlAPInode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.UrlAPInode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(Ms.extend({filter_str:"ICosq API",color:"#10b7f0",items:{sate_config:{name:"Save Config",icon:"fas fa-file-download",callback:function(){var e=[o.getPersistentAttributes()];Os.removeData(e),e=JSON.stringify(e,null,2);var t=o.userData.label?o.userData.label:"node.conf",a=new Blob([e],{type:"text/plain;charset=utf-8"});(0,da.saveAs)(a,t)}},sep:"---------"}},e),t,a,n),this.help="Node witch is providing URL bbased API request facility integration into existing object structure.";var o=this;Ms.extend(this.userData,{label:"URL API Call",params:[{param_name:"params"},{param_name:"headers"},{param_name:"body"}]}),Ms.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{params:js.template_params,label:{type:"string",format:"hidden",default:"New Label"}}}),this.updateTable=function(){DEBUG&&console.log(this.NAME+" id:"+this.id+" "+o.userData.label+" updateTable"),this.updateTickets=[];var e=this.getUserData();if(e.params&&e.params.length){var t=Os.getParams(e);if(t.headers&&t.body&&t.params){this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.val_label.setText(".");var a=m().parse(t.headers),n=m().parse(t.body),i=m().parse(t.params);a&&i&&n&&(this.xhr=Ms.ajax({url:Rs.context+"/apidata/getIAPIData",contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify({headers:a,body:n,params:i}),success:function(e){var t;e.data.code.code,t=e.data,o.userData.sites_list_out=[t],o.userData.value=o.userData.sites_list_out.length,o.getPort("output0").setUserData({project:o.project||"",scope:o.scope||"",item_name:o.userData.label,task_type:o.userData.task_type,sites_list_out:o.userData.sites_list_out}),o.getOutputPort(0).getConnections().each(Ms.proxy((function(e,t){t.getTarget().setValue(o.id),t.setColor(o.frame.attr("stroke"))}),this)),o.updateUI(),o.stopTimer()},error:function(e,t){console.log(t)}}))}}}},loadTreema:function(){Os.updateParamSourceCol(this),Os.updateParamDetailsCol(this),Os.updatePropKeyCol(this),Os.updateLookupSourceCol(),Os.updateLookupKeyCol(),Os.updateLookupValueCol(),Os.updateLookupResultCol(),this._super(this)}});var Ls=a("8a868d10b6533e768658"),Fs=a("a45670b3d8fb79ec0258"),Us=a("1bf2fbdb051fe0c57024"),Bs=a("a7583c9a3ff76b2fdd52"),zs=a("6fe5e339b0f8a936ba8c"),Hs=a("8deafab7866a125bb9ca");function qs(e){return qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qs(e)}function Vs(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ws(e,t,a){return(t=function(e){var t=function(e){if("object"!=qs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=qs(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==qs(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Ls.shape.fishbone.cell.CustomFieldnode=Ls.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.CustomFieldnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.CustomFieldnode</strong>}<br/><br/> <strong>UDF </strong><cite>Node </cite>Provide access to UDF columns<br/><br/><strong>Configuration: </strong><br/><br/><strong>UDF Type*: </strong> <cite>Mention UDF column name ",init:function(e,t,a,n){this._super(Fs.extend({color:"#ec8c3b",items:{filter:{name:"Filter",icon:"fas fa-filter",callback:function(){n.editor.selectUDFValues(i)}},reset_filter:{name:"Reset Filter",icon:"fas fa-redo",callback:function(){i.resetFilter()}},sep:"---------"}},e),t,a,n);var o,i=this;this.sites_list_in=[],Fs.extend(this.userData,{udf:{field_code:"",field_name:"Field Name"},conditions:[{logic:"",prop:"self",sign:"not equal",value:"empty"}],filter:{filtered:!1,list:[],original_list:[]},label:"",use_du_id:!0}),Fs.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{udf:{type:"object",title:"Custom Field",format:"udftype_api",properties:{field_code:{type:"string"},field_name:{type:"string"}}},conditions:{type:"array",title:"Filter",items:{type:"object",title:"Filter",properties:{logic:{type:"string",title:"Logic apply",default:"",enum:["","and","or"]},prop:{type:"string",title:"Property Name",default:"self"},sign:{type:"string",default:"not equal",title:"Sign",enum:["not equal","equal","consist","not consist","more than","less than","more or equal than","less or equal than"]},value:{type:"string",title:"Condition Value",default:"empty"}},required:["logic","prop","sign","value"]}},filter:{type:"object",title:"Filter",format:"hidden",properties:{filtered:{type:"boolean",default:!1},list:{type:"array",items:{type:"object",title:"Filter",properties:{site_code:{type:"string",title:"Site Code"},field_name:{type:"string",title:"Site Name"}}}}}},label:{type:"string",format:"hidden",default:""},use_du_id:{type:"boolean",title:"Use du_id",default:!0}},required:["udf"]}),this.GetHTTPData=function(){var e=this.getUserData();if(void 0!==e.udf.field_code&&""!==e.udf.field_code){var t,a;i.getCanvas().silentMode||(this.val_label.setText("."),this.startTimer(500)),t=""!==e.label&&void 0!==e.label?e.label:e.udf.field_name,this.sop&&this.sop.scope_id&&(a=this.sop.scope_id);var n={proj_id:this.project.proj_id,du_model_id:a,field_code:e.udf.field_code},o=this.sites_list_in;if(void 0!==o){var r="";e.use_du_id?(r="",o.forEach((function(e,t){r=r+e.du_id+","})),(r=r.substring(0,r.length-1)).length?n.du_id=r:""===r&&(r="na",n.site_id=r)):(r="",o.forEach((function(e,t){r=r+e.site_id+","})),(r=r.substring(0,r.length-1)).length?n.site_id=r:""===r&&(r="na",n.site_id=r))}this.xhr&&4!==this.xhr.readyState&&this.xhr.abort(),this.xhr=Fs.ajax({url:zs.context+"/apidata/getAPIData?apiid=553909219625041920&user_id="+window.user_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(n),success:function(a){var n=a.data,o=[];n.length>0&&n.forEach((function(a,n){var i=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Vs(Object(a),!0).forEach((function(t){Ws(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Vs(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a),r=Bs(a.value,["YYYY-MM-DD","YYYY/MM/DD HH:mm:ss","YYYY-MM-DD HH:mm:ss","YYYY-MM-DDTHH:mm:ss.SSSSZ"],!0);r.isValid()&&(i.my_date=r.toDate(),i.task_name=t,i.task_type=e.type_name),i[t]=a.value,o.push(i)}));var r=function(e,t,a){var n=e.conditions;return i.getConditions(n),(new Us).from(t).where((function(e,t){var o,i,r=!0;return n.forEach((function(t,n){"empty"===t.value||""===t.value?o=null:"today"===t.value?(o=new Date).setHours(0,0,0,0):o=t.value,i=null===e[a]?null:void 0!==e.my_date?e.my_date:e[a],"and"===t.logic||0===n?void 0===e.my_date?"not equal"===t.sign?r=r&&i!==o:"equal"===t.sign?r=r&&i===o:"consist"===t.sign?r=r&&i.indexOf(o)>-1:"not consist"===t.sign?r=r&&-1===i.indexOf(o):"more than"===t.sign?r=r&&i>o:"less than"===t.sign?r=r&&i<o:"more or equal than"===t.sign?r=r&&i>=o:"less or equal than"===t.sign&&(r=r&&i<=o):"not equal"===t.sign?r=r&&!Bs(i).isSame(o):"equal"===t.sign?r=r&&Bs(i).isSame(o):"more than"===t.sign?r=r&&Bs(i).isAfter(o):"less than"===t.sign?r=r&&Bs(i).isBefore(o):"more or equal than"===t.sign?r=r&&Bs(i).isSameOrAfter(o):"less or equal than"===t.sign&&(r=r&&Bs(i).isSameOrBefore(o)):"or"===t.logic&&(void 0===e.my_date?"not equal"===t.sign?r=r||i!==o:"equal"===t.sign?r=r||i===o:"consist"===t.sign?r=r||i.indexOf(o)>-1:"not consist"===t.sign?r=r||-1===i.indexOf(o):"more than"===t.sign?r=r||i>o:"less than"===t.sign?r=r||i<o:"more or equal than"===t.sign?r=r||i>=o:"less or equal than"===t.sign&&(r=r||i<=o):"not equal"===t.sign?r=r||!Bs(i).isSame(o):"equal"===t.sign?r=r||Bs(i).isSame(o):"more than"===t.sign?r=r||Bs(i).isAfter(o):"less than"===t.sign?r=r||Bs(i).isBefore(o):"more or equal than"===t.sign?r=r||Bs(i).isSameOrAfter(o):"less or equal than"===t.sign&&(r=r||Bs(i).isSameOrBefore(o)))})),r})).select()}(e,o,t);if(i.userData.filter.filtered)i.setFilter(r);else{i.val_label.setText(r.length),i.userData.value=r.length,i.userData.sites_list_out=r;var s=i.getPort("output0");s.setValue(r),s.setUserData({project:i.project,scope:i.scope,sop:i.sop,item_name:t,sites_list_out:r}),i.getOutputPort(0).getConnections().each(Fs.proxy((function(e,t){t.getTarget().setValue(i.getId()),t.setColor(i.frame.attr("stroke"))}),this)),i.stopTimer(),i.updateUI()}}})}},this.resetFilter=function(){var e,t=i.userData;if(e=""!==t.label&&void 0!==t.label?t.label:t.udf.field_name,i.userData.filter.filtered){Hs.initFallDown(i);var a=this.getPort("dataInput").getConnections();i.sites_list_in=a.data[0].sourcePort.userData.sites_list_out,i.userData.filter.filtered=!1,i.userData.filter.list=[],i.userData.sites_list_out=i.userData.filter.original_list,i.userData.filter.original_list=[],i.userData.value=i.userData.sites_list_out.length;var n=i.getPort("output0");n.setValue(i.userData.sites_list_out),n.setUserData({project:i.project,scope:i.scope,item_name:e,sites_list_out:i.userData.sites_list_out}),i.getOutputPort(0).getConnections().each(Fs.proxy((function(e,t){t.getTarget().setValue(i.getId()),t.setColor(i.frame.attr("stroke"))}),this)),i.updateUI()}},this.setFilter=function(e){var t;t=""!==(a=i.userData).label&&void 0!==a.label?a.label:a.udf.field_name,i.userData.filter.original_list.length<1&&(i.userData.filter.original_list=e),i.startTimer();var a=i.userData,n=[];a.filter.list.forEach((function(e,t){n.push(e.value)}));var o=(new Us).from(e).in(n,t).select();i.userData.value=o.length,i.userData.sites_list_out=o;var r=i.getPort("output0");r.setValue(o),r.setUserData({project:i.project,scope:i.scope,item_name:t,sites_list_out:o}),i.getOutputPort(0).getConnections().each(Fs.proxy((function(e,t){t.getTarget().setValue(i.getId()),t.setColor(i.frame.attr("stroke"))}),this)),i.updateUI(),i.stopTimer()},this.createPort("output"),(o=new Ls.DataInputPort).setConnectionDirection(3),o.setName("dataInput"),this.addPort(o),this.setDimension(this.width,this.height),this.layoutPorts(),this.updateSearchCol=function(e,t,a,n){var o="553988106803511296",i=[];this.clearUI;var r,s,l=(r=zs.context+"/apidata/getAPIData?apiid="+o+"&user_id="+window.user_id,s=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.extend(s),s.prototype.url=r,s.prototype.formatDocument=function(e){return e.field_code+" "+e.field_name},s.prototype.search=function(){var e;if((e=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!e&&this.getSearchResultsEl().empty(),e)){this.lastTerm=e,this.getSearchResultsEl().empty().append("Searching");var t=this.searchCallback;if(0===i.length){var n={proj_id:a.project.proj_id};(this.xhr&&4!==this.xhr.readyState||!this.xhr)&&(this.xhr=Fs.ajax({url:zs.context+"/apidata/getAPIData?apiid="+o+"&user_id="+window.user_id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:JSON.stringify(n),success:function(a){var n=a.data?a.data:a;i=n;var o=(new Us).from(n).where((function(t,a){return-1!==t.field_code.toLowerCase().indexOf(e.toLowerCase())||-1!==t.field_name.toLowerCase().indexOf(e.toLowerCase())})).select();t(o)}}))}else{var r=(new Us).from(i).where((function(t,a){return-1!==t.field_code.toLowerCase().indexOf(e.toLowerCase())||-1!==t.field_name.toLowerCase().indexOf(e.toLowerCase())})).select();t(r)}}},s.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data.field_code=e.data("value").field_code,this.data.field_name=e.data("value").field_name,a.GetHTTPData(),a.updateUI())},s.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==(i.field_name+i.field_code).toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},s);TreemaNode.setNodeSubclass("udftype_api",l),a.project=e,a.scope=t,n&&(a.sop=n)},this.getRealCount=function(){return 1}},getConditions:function(e){var t=this;this.filter_label.setText(""),e.forEach((function(e,a){""!==t.filter_label.getText()&&t.filter_label.setText(t.filter_label.getText()+"\n"),t.filter_label.setText(t.filter_label.getText()+e.logic+" "+e.sign+" "+e.value)}))},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText(e.udf.field_name),void 0===e.filter&&(e.filter={filtered:!1,list:[],original_list:[]}),e.filter.filtered?this.filter_label.setText("Multiple filter"):this.getConditions(e.conditions),this._super(this)},onTimer:function(){"."!==this.val_label.getText()&&".."!==this.val_label.getText()&&"..."!==this.val_label.getText()&&this.val_label.setText("."),"."===this.val_label.getText()?this.val_label.setText(".."):".."===this.val_label.getText()?this.val_label.setText("..."):"..."===this.val_label.getText()&&this.val_label.setText(".")},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(a,n){a.getConnections().each(Fs.proxy((function(a,n){var o=n.getTarget();o.userData||(o.userData={}),o.userData.realCount=t.getRealCount(),Hs.getMessage(t,o,"ticket send to"),o.superUpdate=!!e.superUpdate,o.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||n.setColor("#dfdfdf")}),this))}));else if("dataInput"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.updateSearchCol(a.getUserData().project,a.getUserData().scope,this,a.getUserData().sop),this.GetHTTPData()}},getPersistentAttributes:function(){return this._super()},setPersistentAttributes:function(e){this._super(e)}}),a("995a246cbfc2a2a7c934");var Gs=a("8deafab7866a125bb9ca");c().policy.canvas.ReadOnlySelectionPolicy=c().policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.ReadOnlySelectionPolicy",init:function(e,t,a){this._super(e,t,a)},onInstall:function(e){this._super(e),e.getAllPorts().each((function(e,t){t.setVisible(!1)}))},onUninstall:function(e){e.getAllPorts().each((function(e,t){t.setVisible(!0)})),this._super(e)},onMouseDrag:function(e,t,a,n,o,i,r){if(i||Gs.mobilecheck()){var s=e.getScrollArea();s.scrollTop(s.scrollTop()-o),s.scrollLeft(s.scrollLeft()-n)}}}),c().policy.canvas.ClickCanvasPolicy=c().policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.ClickCanvasPolicy",init:function(){this._super()},onClick:function(e,t,a,n,o){if(null!==e&&"draw2d.shape.fishbone.label.HTML_link"===e.NAME&&e.userData.link){var i=window.open(e.userData.link,"_blank");i?i.focus():alert("Please allow popups for this website")}}}),a("bd7c2e591def93ddc73c"),a("5af33636880bae2d66b5"),a("14cb1318235fe35a2da7"),a("1815c9263236de379ac6"),a("553f5f012df3beea631e"),a("7017424798f3b3345cbb"),a("6d82cd49c65221e2540b"),a("112dc8f6a3a8289e0553"),a("883108e75945407806e4"),a("a0dec2fcb181bcfd6db2"),a("8bc1645a15a8aceb9e2a"),a("9a6579c5821a9fbd537c"),a("2d4ccc4a5d7ea7a03847"),a("4298f14c0830aa46ddf2"),a("bbceea22d6e26ed38dee"),a("52e0d1661508b2d89b12"),window.fb_exchange={message:"store your variables here"},a("8c55d536dcccaac1d990")},a8d6bfb38cc4f98f246a:(e,t,a)=>{var n;(n={}).populateDefaults=function(e,t,a){var n=this;return t.default&&!e&&(e=this.cloneDeep(t.default)),this.walk(e,t,a,(function(e,t,a){var o,i,r,s;if(o=a.default,"object"===n.type(o)&&"object"===n.type(t)){for(i in s=[],o)r=o[i],void 0===t[i]?s.push(t[i]=n.cloneDeep(r)):s.push(void 0);return s}})),e},n.populateRequireds=function(e,t,a){var n=this;return null==e&&(e={}),this.walk(e,t,a,(function(e,t,o){var i,r,s,l,c,u,d,p,h,f;if(o.required&&"object"===n.type(t)){for(f=[],u=0,d=(p=o.required).length;u<d;u++)null==t[r=p[u]]&&((s=null!=(h=o.default)?h[r]:void 0)?f.push(t[r]=n.cloneDeep(s)):(i=n.getChildSchema(r,o),null!=(s=(c=n.buildWorkingSchemas(i,a)[0]).default)?f.push(t[r]=n.cloneDeep(s)):(l=c.type,"array"===n.type(l)&&(l=l[0]),l||(l="string"),f.push(t[r]=n.defaultForType(l)))));return f}})),e},n.walk=function(e,t,a,n,o){var i,r,s,l,c,u,d,p,h,f,m=this;if(null==o&&(o=""),a||((a=this.getGlobalTv4().freshApi()).addSchema("#",t),t.id&&a.addSchema(t.id,t)),u=this.buildWorkingSchemas(t,a),c=this.chooseWorkingSchema(e,u,a),n(o,e,c),"array"===(i=this.type(e))||"object"===i){if(r=function(t,i){var r,s;return i=e[t],(r=o.slice())&&(r+="."),r+=t,s=m.getChildSchema(t,c),m.walk(i,s,a,n,r)},"array"===i){for(h=[],s=d=0,p=e.length;d<p;s=++d)l=e[s],h.push(r(s,l));return h}for(s in f=[],e)l=e[s],f.push(r(s,l));return f}},n.getChildSchema=function(e,t){var a,n,o,i,r;if("string"===this.type(e)){for(a in i=t.properties)if(n=i[a],a===e)return n;for(a in r=t.patternProperties)if(n=r[a],e.match(new RegExp(a)))return n;if("object"==typeof t.additionalProperties)return t.additionalProperties}if("number"===this.type(e)&&(o=e,t.items))if(Array.isArray(t.items)){if(o<t.items.length)return t.items[o];if(t.additionalItems)return t.additionalItems}else if(t.items)return t.items;return{}},n.buildWorkingSchemas=function(e,t){var a,n,o,i,r,s,l,c,u,d,p,h;if(null==e&&(e={}),o=this.resolveReference(e,t),!(e.allOf||e.anyOf||e.oneOf))return[e];if(a=(o=this.cloneSchema(o)).allOf,n=o.anyOf,r=o.oneOf,null!=o.allOf&&delete o.allOf,null!=o.anyOf&&delete o.anyOf,null!=o.oneOf&&delete o.oneOf,null!=a)for(u=0,p=a.length;u<p;u++)e=a[u],this.combineSchemas(o,this.resolveReference(e,t));for(c=[],l=[],null!=n&&(l=l.concat(n)),null!=r&&(l=l.concat(r)),d=0,h=l.length;d<h;d++)s=l[d],s=this.resolveReference(s,t),i=this.cloneSchema(o),this.combineSchemas(i,s),c.push(i);return 0===c.length&&(c=[o]),c},n.chooseWorkingSchema=function(e,t,a){var n,o,i;if(1===t.length)return t[0];for(null==a&&(a=this.getGlobalTv4()),o=0,i=t.length;o<i;o++)if(n=t[o],a.validateMultiple(e,n).valid)return n;return t[0]},n.resolveReference=function(e,t,a){var n;return null==a&&(a=!1),null==e.$ref?e:(null==t&&(t=this.getGlobalTv4()),(n=t.getSchema(e.$ref))||console.warn("could not resolve reference",e.$ref,t.getMissingUris()),null==n&&(n={}),a&&null!=n.title&&delete n.title,n)},n.getGlobalTv4=function(){return"undefined"!=typeof window?window.tv4:void 0!==a.g?a.g.tv4:"undefined"!=typeof tv4?tv4:void 0},n.cloneSchema=function(e){var t,a,n;for(a in t={},e)n=e[a],t[a]=n;return t},n.combineSchemas=function(e,t){var a,n;for(a in t)n=t[a],e[a]=n;return e},n.cloneDeep=function(e){var t,a,n,o;if(t=e,"object"===(n=this.type(e))&&(t={}),"array"===n&&(t=[]),"object"===n||"array"===n)for(a in e)o=e[a],t[a]=this.cloneDeep(o);return t},n.type=function(){var e,t,a,n,o;for(e={},a=0,n=(o="Boolean Number String Function Array Date RegExp Undefined Null".split(" ")).length;a<n;a++)t=o[a],e["[object "+t+"]"]=t.toLowerCase();return function(t){var a;return a=Object.prototype.toString.call(t),e[a]||"object"}}(),n.defaultForType=function(e){return{string:"",number:0,null:null,object:{},integer:0,boolean:!1,array:[]}[e]},"undefined"!=typeof TreemaNode?TreemaNode.utils=n:e.exports&&(e.exports=n)},aa89d31f4d5abab91608:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca");n.shape.fishbone.cell.FORnode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.FORnode",INFO:"{Class: <strong>YesNOnode</strong>}<br/><br/> <strong>Code </strong><cite>Node </cite>Provide simple FOR loop over input list<br/><br/><strong>Configuration: </strong>",init:function(e,t,a,r){this._super(o.extend({color:"#94246b",items:{}},e),t,a,r);var s=this;this.sites_list_in=[],this.count=0,o.extend(this.userData,{label:"Loop",type_name:"for",sites_list_out:[]}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{label:{type:"string",format:"hidden",default:""},type_name:{type:"string",title:"Type Name",default:"for"},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}}}}),this.getRealCount=function(){return 1},this.GetHTTPData=function(){if(s.count<s.sites_list_in.length){DEBUG&&console.log("FORNode:"+this.id+" - loop: "+s.count),this.getOutputPort("output").getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.userData||(a.userData={}),a.userData.realCount=s.getRealCount(),a.setValue("ticket,"+s.id+","+s.userData.label),s.getCanvas().silentMode||t.setColor("#dfdfdf")}),this)),s.startTimer();var e=s.getPort("output");s.userData.value=s.count+1,e.setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label,task_type:s.userData.type_name||"for",sites_list_out:[s.sites_list_in[s.count]]}),e.getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(s.getId()),t.setColor(s.frame.attr("stroke"))}),this)),s.stopTimer(),s.updateUI()}else{var t=s.getPort("result");t.setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label,task_type:s.userData.type_name||"yesno",sites_list_out:s.userData.sites_list_out}),t.getConnections().each(o.proxy((function(e,t){var a=t.getTarget();a.setValue(s.getId()),i.getMessage(s,a,"data send to"),t.setColor(s.frame.attr("stroke"))}),this))}};var l=null;(l=new n.OutputPort).setName("result"),this.addPort(l);var c=null;(c=new n.OutputPort).setName("output"),c.setBackgroundColor("#ff6200"),this.addPort(c);var u=null;(u=new n.DataInputPort).setConnectionDirection(3),u.setName("dataInput"),this.addPort(u);var d=null;(d=new n.DataInputPort).setConnectionDirection(3),d.setBackgroundColor("#ff6200"),d.setName("InputNext"),this.addPort(d),this.setDimension(this.width,this.height),this.layoutPorts()},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText("Loop"),this.filter_label.setText("FOR"),this._super(this)},onPortValueChanged:function(e){var t=this,a=e.getConnections().data[0].getSource();"dataInput"===e.name&&e.getValue().indexOf("ticket")>-1?(t.count=0,t.updateUI(),t.userData.sites_list_out=[],t.project=a.getUserData().project,t.scope=a.getUserData().scope,this.getOutputPort("result").getConnections().each(o.proxy((function(a,n){var o=n.getTarget();i.getMessage(t,o,"ticket send to"),o.userData||(o.userData={}),o.superUpdate=!!e.superUpdate,o.userData.realCount=t.getRealCount(),o.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||n.setColor("#dfdfdf")}),this))):-1===e.getValue().indexOf("ticket")&&("dataInput"===e.name?(t.project=a.getUserData().project,t.scope=a.getUserData().scope,t.count=0,i.getMessage(t,a,"update data received from"),this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.GetHTTPData()):"InputNext"===e.name&&(this.count=this.count+1,this.userData.sites_list_out=[].concat(this.userData.sites_list_out,a.getUserData().sites_list_out),this.GetHTTPData()))}})},ac589d12568d55d68f1b:(e,t,a)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return i(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==a.return||a.return()}finally{if(l)throw r}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var l=a("5f70f5db0bc3dc9cd6c8"),c=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodeClassNames=l.nodeClassNames,this.classNameToId=l.reverseClassMapping,this.nodeCategoryMap={1:"data_acquisition",2:"data_acquisition",3:"data_acquisition",4:"data_acquisition",5:"transformation",6:"transformation",7:"transformation",8:"visualization",9:"visualization",10:"visualization",11:"visualization",12:"visualization",13:"transformation",14:"visualization",16:"data_acquisition"}},t=[{key:"normalizeNodeClass",value:function(e){return"number"==typeof e?e:"string"==typeof e&&/^\d+$/.test(e)?parseInt(e,10):"string"==typeof e&&void 0!==this.classNameToId[e]?this.classNameToId[e]:(console.warn("Could not normalize node class: ".concat(e)),null)}},{key:"getNodeCategory",value:function(e){var t=this.normalizeNodeClass(e);return null!==t&&this.nodeCategoryMap[t]||"unknown"}},{key:"getNodeClassName",value:function(e){var t=this.normalizeNodeClass(e);return null!==t&&this.nodeClassNames[t]||"Node Type ".concat(e)}},{key:"extractNodePatterns",value:function(e){var t=this,a=e.preliminary_structure,n=e.thinking,o=[];return a&&a.nodes&&a.connections?(a.nodes.forEach((function(e){if(["draw2d.shape.fishbone.cell.Projectnode_api","draw2d.shape.fishbone.cell.DUModelnode_api","draw2d.shape.fishbone.cell.Datanode","draw2d.shape.fishbone.cell.CustomFieldnode"].indexOf(e.class)<0){var i=t.getNodeCategory(e.class),r=t.normalizeNodeClass(e.class),s=a.connections.filter((function(t){return t.target===e.id||t.trgt===e.id})),l=a.connections.filter((function(t){return t.source===e.id||t.src===e.id})),c=s.map((function(e){var t=e.source||e.src,n=a.nodes.find((function(e){return e.id===t}));return n?n.class:null})).filter(Boolean),u=l.map((function(e){var t=e.target||e.trgt,n=a.nodes.find((function(e){return e.id===t}));return n?n.class:null})).filter(Boolean),d={nodeId:e.id,nodeClass:e.class,normalizedClass:r,nodeLabel:e.label,nodePurpose:e.purpose,category:i,search_text:e.search_text,inputNodeTypes:c.map((function(e){return t.normalizeNodeClass(e)})).filter(Boolean),outputNodeTypes:u.map((function(e){return t.normalizeNodeClass(e)})).filter(Boolean),incomingConnections:s.length,outgoingConnections:l.length,context:t.extractContextForNode(n,e)};o.push(d)}})),o):(console.warn("Planning result missing expected structure for pattern extraction"),o)}},{key:"extractContextForNode",value:function(e,t){if(!e)return{};var a={},n=[t.id,t.label,t.purpose].filter(Boolean);if(e.analysis){var i=this.findRelevantTextInAnalysis(e.analysis,n);i&&(a.analysisContext=i)}if(e.key_components&&Array.isArray(e.key_components)){var r=e.key_components.filter((function(e){return n.some((function(t){return e.toLowerCase().includes(t.toLowerCase())}))}));r.length>0&&(a.keyComponentContext=r)}if(e.functional_branches&&Array.isArray(e.functional_branches)){var s,l=o(e.functional_branches);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(this.branchContainsNodeReference(c,n)){a.branchContext={branchName:c.name,branchPurpose:c.purpose,visualizationOutput:c.visualization_output};break}}}catch(e){l.e(e)}finally{l.f()}}return a}},{key:"findRelevantTextInAnalysis",value:function(e,t){var a=e.split("\n\n").filter((function(e){return t.some((function(t){return e.toLowerCase().includes(t.toLowerCase())}))}));return a.length>0?a.join("\n\n"):null}},{key:"branchContainsNodeReference",value:function(e,t){var a=JSON.stringify(e).toLowerCase();return t.some((function(e){return e&&a.includes(e.toLowerCase())}))}},{key:"createComponentQueries",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("Creating component search queries for ".concat(e.length," node patterns"));var a,n=[],i=o(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;try{var s=r.search_text;if(s)n.push({nodeId:r.nodeId,node_class_id:r.node_class_id,search_text:s,original_purpose:r.purpose}),console.log("Using LLM-generated search text for node ".concat(r.nodeId,': "').concat(s.substring(0,50),'..."'));else{console.warn("No search text available for node ".concat(r.nodeId,", creating fallback"));var l=this.createFallbackSearchText(r,t);n.push({nodeId:r.nodeId,node_class_id:r.node_class_id,search_text:l,original_purpose:r.purpose})}}catch(e){console.error("Error creating search query for node ".concat(r.nodeId,":"),e);var c=this.createFallbackSearchText(r,t);n.push({nodeId:r.nodeId,node_class_id:r.node_class_id,search_text:c,original_purpose:r.purpose}),console.log("Created fallback search text for node ".concat(r.nodeId,': "').concat(c.substring(0,50),'..."'))}}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"createFallbackSearchText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=[];switch(a.push(this.getNodeClassName(e.node_class_id)),e.purpose&&a.push("that ".concat(e.purpose)),e.nodeLabel&&e.purpose&&!e.purpose.includes(e.nodeLabel)&&a.push('with label "'.concat(e.nodeLabel,'"')),e.node_class_id){case 5:a.push("for data joining, filtering, or aggregation operations");break;case 7:a.push("for data transformation such as filtering, aggregation, calculation, or formatting");break;case 8:a.push("for creating visualizations such as line charts, bar charts, pie charts");break;case 9:a.push("for advanced data visualizations with Vega");break;case 10:a.push("for displaying data in tabular format with formatting and interactive features");break;case 11:a.push("for displaying custom HTML content, layouts, or user interfaces")}if(t){if(t.visualizations&&e.node_class_id>=8&&e.node_class_id<=10){var n=t.visualizations.map((function(e){return e.type})).filter(Boolean);n.length>0&&a.push("related to visualization types like ".concat(n.join(", ")));var o=t.visualizations.flatMap((function(e){return e.metrics||[]})).filter(Boolean);o.length>0&&a.push("showing metrics such as ".concat(o.join(", ")))}if(t.data_operations&&(5===e.node_class_id||7===e.node_class_id)){var i=[];t.data_operations.grouping&&t.data_operations.grouping.length&&i.push("grouping by ".concat(t.data_operations.grouping.join(", "))),t.data_operations.sorting&&t.data_operations.sorting.length&&i.push("sorting by ".concat(t.data_operations.sorting.join(", "))),t.data_operations.filtering&&t.data_operations.filtering.length&&i.push("filtering by ".concat(t.data_operations.filtering.join(", "))),i.length>0&&a.push("performing operations such as ".concat(i.join(", ")))}}return a.join(" ")}},{key:"getComponentTypeFromNodeClass",value:function(e){var t=this.normalizeNodeClass(e);return null===t?"unknown":{1:"project",2:"du_model",3:"task",4:"custom_field",5:"joiner",6:"union",7:"aggregator",8:"chart",9:"chart",10:"table",11:"container"}[t]||"unknown"}},{key:"generateSearchTextFromPattern",value:function(e){var t=this,a=[];if(a.push("".concat(this.getNodeClassName(e.nodeClass)," for ").concat(e.nodePurpose||e.nodeLabel)),e.inputNodeTypes.length>0&&a.push("receiving input from ".concat(e.inputNodeTypes.map((function(e){return t.getNodeClassName(e)})).join(", "))),e.outputNodeTypes.length>0&&a.push("sending output to ".concat(e.outputNodeTypes.map((function(e){return t.getNodeClassName(e)})).join(", "))),e.context){if(e.context.analysisContext){var n=e.context.analysisContext.substring(0,100).trim();a.push(n)}e.context.branchContext&&(a.push("part of ".concat(e.context.branchContext.branchName," branch for ").concat(e.context.branchContext.branchPurpose)),e.context.branchContext.visualizationOutput&&a.push("contributing to ".concat(e.context.branchContext.visualizationOutput))),e.context.keyComponentContext&&e.context.keyComponentContext.forEach((function(e){a.push(e)})),e.comprehensive_query&&a.push(e.comprehensive_query)}return a.join(" ")}},{key:"enhanceDataAcquisitionQuery",value:function(e,t,a){if(!a)return e;e.filters.tags=["data_source"];var n=t.normalizedClass;if(null===n)return e;switch(n){case 1:a.project&&(a.project.id&&(e.filters.project_id=a.project.id),a.project.code&&(e.filters.project_code=a.project.code),a.project.name&&(e.filters.project_name=a.project.name),(a.project.code||a.project.name)&&(e.search_text+=" for project ".concat(a.project.code||""," ").concat(a.project.name||"").trim()),e.filters.tags.push("project"));break;case 2:a.du_model&&(a.du_model.id&&(e.filters.du_model_id=a.du_model.id),a.du_model.name&&(e.filters.du_model_name=a.du_model.name),a.du_model.name&&(e.search_text+=" for DU model ".concat(a.du_model.name)),e.filters.tags.push("du_model"));break;case 3:if(a.tasks&&a.tasks.length>0){var o=a.tasks.find((function(e){return t.nodePurpose&&e.name&&t.nodePurpose.includes(e.name)}))||a.tasks[0];o&&(o.id&&(e.filters.task_id=o.id),o.code&&(e.filters.task_code=o.code),o.name&&(e.filters.task_name=o.name),(o.code||o.name)&&(e.search_text+=" for task ".concat(o.code||""," ").concat(o.name||"").trim())),e.filters.tags.push("task")}break;case 4:if(a.custom_fields&&a.custom_fields.length>0){var i=a.custom_fields.find((function(e){return t.nodePurpose&&e.name&&t.nodePurpose.includes(e.name)}))||a.custom_fields[0];i&&(i.code&&(e.filters.field_code=i.code),i.name&&(e.filters.field_name=i.name),i.name&&(e.search_text+=" for custom field ".concat(i.name)),i.purpose&&(e.search_text+=" for ".concat(i.purpose))),e.filters.tags.push("custom_field")}}return e}},{key:"enhanceTransformationQuery",value:function(e,t,a){if(!a)return e;e.filters.tags=["transformation"];var n=t.normalizedClass;if(null===n)return e;switch(n){case 5:e.filters.tags.push("sql","join");break;case 6:e.filters.tags.push("union");break;case 7:var o=this.determineTransformType(t,a);if(e.filters.tags.push(o),a.data_operations)switch(o){case"aggregator":a.data_operations.grouping&&(e.search_text+=" grouping by ".concat(a.data_operations.grouping.join(", ")),e.filters.grouping_fields=a.data_operations.grouping);break;case"filter":if(a.data_operations.filtering){var i=a.data_operations.filtering.join(", ");e.search_text+=" filtering by ".concat(i),e.filters.filter_conditions=a.data_operations.filtering}break;case"sorter":a.data_operations.sorting&&(e.search_text+=" sorting by ".concat(a.data_operations.sorting.join(", ")),e.filters.sort_fields=a.data_operations.sorting);break;case"calculator":a.data_operations.calculations&&(e.search_text+=" calculating ".concat(a.data_operations.calculations.join(", ")),e.filters.calculations=a.data_operations.calculations)}}return e}},{key:"determineTransformType",value:function(e,t){if(!e.nodePurpose)return"aggregator";var a=e.nodePurpose.toLowerCase();if(a.includes("group")||a.includes("aggregat")||a.includes("sum")||a.includes("count"))return"aggregator";if(a.includes("filter")||a.includes("select")||a.includes("where"))return"filter";if(a.includes("sort")||a.includes("order")||a.includes("rank"))return"sorter";if(a.includes("calculat")||a.includes("formula")||a.includes("compute"))return"calculator";if(a.includes("format")||a.includes("convert")||a.includes("transform"))return"formatter";if(t&&t.data_operations){if(t.data_operations.grouping&&t.data_operations.grouping.length>0)return"aggregator";if(t.data_operations.filtering&&t.data_operations.filtering.length>0)return"filter";if(t.data_operations.sorting&&t.data_operations.sorting.length>0)return"sorter";if(t.data_operations.calculations&&t.data_operations.calculations.length>0)return"calculator"}return"aggregator"}},{key:"enhanceVisualizationQuery",value:function(e,t,a){if(!a)return e;e.filters.tags=["visualization"];var n=t.normalizedClass;if(null===n)return e;switch(n){case 8:if(e.filters.component_type="chart",e.filters.tags.push("echarts"),a.visualizations&&a.visualizations.length>0){var o=a.visualizations.find((function(e){return t.nodePurpose&&e.purpose&&t.nodePurpose.includes(e.purpose)}))||a.visualizations[0];o&&(o.type&&(e.search_text+=" ".concat(o.type," chart"),e.filters.chart_type=o.type,e.filters.tags.push(o.type.toLowerCase().replace(/\s+/g,"_"))),o.purpose&&(e.search_text+=" for ".concat(o.purpose)),o.metrics&&o.metrics.length>0&&(e.search_text+=" showing ".concat(o.metrics.join(", ")),e.filters.metrics=o.metrics))}break;case 9:if(e.filters.component_type="chart",e.filters.tags.push("vega"),a.visualizations&&a.visualizations.length>0){var i=a.visualizations.find((function(e){return t.nodePurpose&&e.purpose&&t.nodePurpose.includes(e.purpose)}))||a.visualizations[0];i&&(i.type&&(e.search_text+=" ".concat(i.type," chart"),e.filters.chart_type=i.type,e.filters.tags.push(i.type.toLowerCase().replace(/\s+/g,"_"))),i.purpose&&(e.search_text+=" for ".concat(i.purpose)),i.metrics&&i.metrics.length>0&&(e.search_text+=" showing ".concat(i.metrics.join(", ")),e.filters.metrics=i.metrics))}break;case 10:if(e.filters.component_type="table",e.filters.tags.push("table"),a.visualizations&&a.visualizations.length>0){var r=a.visualizations.find((function(e){return e.type&&e.type.toLowerCase().includes("table")}));r&&(r.purpose&&(e.search_text+=" for ".concat(r.purpose)),r.metrics&&r.metrics.length>0&&(e.search_text+=" showing ".concat(r.metrics.join(", ")),e.filters.metrics=r.metrics))}break;case 11:t.nodePurpose&&(t.nodePurpose.toLowerCase().includes("container")||t.nodePurpose.toLowerCase().includes("layout"))?(e.filters.tags.push("container","layout"),(t.nodePurpose&&t.nodePurpose.toLowerCase().includes("bootstrap")||a.visualizations&&a.visualizations.some((function(e){return e.type&&e.type.toLowerCase().includes("bootstrap")})))&&(e.filters.tags.push("bootstrap"),e.search_text+=" bootstrap")):t.nodePurpose&&t.nodePurpose.toLowerCase().includes("card")?(e.filters.tags.push("card"),a.visualizations&&a.visualizations.some((function(e){return e.type&&e.type.toLowerCase().includes("bootstrap card")}))&&(e.filters.tags.push("bootstrap"),e.search_text+=" bootstrap card")):e.filters.tags.push("html")}return e}}],t&&r(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=c},aeb57e88bcb04c329061:function(e,t,a){var n=a("a45670b3d8fb79ec0258"),o=a("a7583c9a3ff76b2fdd52"),i=a("8deafab7866a125bb9ca"),r=a("d1be49724a1f416e7f57"),s=this;function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}n(document).ready((function(){n('button[data-bs-toggle="tab"]').on("shown.bs.tab",(function(e){var t=n(e.target).attr("data-bs-target");n(t).find(".ace_editor").each((function(){var e=n(this).attr("id");if(e&&window.ace){var t=window.ace.edit(e);t&&setTimeout((function(){t.resize()}),10)}}))}))}));var c,u,d=a("3f0c1c02d5ee15d6969a").b,p={san_config:{USE_PROFILES:{html:!0},ADD_TAGS:["svg","path","circle","rect","line","polyline","g","text","defs","clipPath","linearGradient","stop","tspan"],ADD_ATTR:["viewBox","d","cx","cy","r","x","y","x1","x2","y1","y2","width","height","fill","stroke","stroke-width","points","transform","text-anchor","dominant-baseline","gradientUnits","spreadMethod","offset","stop-color","begin","dur","from","to","values","repeatCount","opacity","fill-opacity","stroke-opacity","clip-path","clip-rule"],RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1},safe_context:{window:void 0,self:void 0,globalThis:void 0,global:void 0,top:void 0,parent:void 0,frames:void 0,location:void 0,history:void 0,document:void 0,HTMLElement:void 0,Element:void 0,Node:void 0,localStorage:void 0,sessionStorage:void 0,indexedDB:void 0,fetch:void 0,XMLHttpRequest:void 0,WebSocket:void 0,Function:void 0,constructor:void 0,eval:void 0,process:void 0,require:void 0,crypto:void 0,Reflect:void 0,Proxy:void 0,Worker:void 0,SharedWorker:void 0,ServiceWorker:void 0,console,__proto__:void 0,prototype:void 0,setTimeout:void 0,setInterval:void 0,moment:o},months:["January","February","March","April","May","June","July","August","September","October","November","December"],site_table_columns:["","site_code","site_name","region","site_mode","site_type","site_type1","site_type2","site_type3","site_type4","site_type5","site_type6","site_type7","site_type8","site_type9","site_type10","phase","cluster","subcontractor","schedule_obs","schedule_status","site_po"],building_table_columns:["","region_id","site_mode","site_type","site_type1","site_type2","site_type3","site_type4","site_type5","site_type6","site_type7","site_type8","site_type9","site_type10","phase_id","cluster","schedule_obs","schedule_status"],default_grid:{show:!0,top_m:60,left_m:20,right_m:20,bottom_m:20,padding:!0,hor_lines:{show:!0,color:"#DAD8D8"},vert_lines:{show:!0,color:"#EDEDED"}},default_data_table:{show:!0,hor_lines:{show:!0,color:"#DAD8D8"},vert_lines:{show:!0,color:"#EDEDED"}},default_view:{colors:{txt_a_label:"#6f6f6f",txt_a_value:"#7e7e7e",txt_a_value_f:"#80aa8b",txt_a_value_b:"#696baa",txt_i_label:"#6f6f6f",txt_i_value:"#7e7e7e",txt_i_value_f:"#80aa8b",txt_i_value_b:"#696baa",txt_addi_value_b:"#5d62c4",txt_addi_value_r:"#c4675a",txt_addi_label:"#7e7e7e",monochromatic:!1,mono_base_color:"#ffffff"},dot_radius:2,line_width:2},default_font:{font_size:10,font_color:"#000",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal"},default_popup:{show:!0,fill:"#000",stroke:"#666","stroke-width":2,"fill-opacity":.7,font:function(){return s.default_font}},default_units:{show:!0,label:"",font:function(){return s.default_font}},default_title:{show:!0,label:"Title",font_size:18,color:"#000",font_style:"normal",font_weight:"normal"},default_title_left:{show:!0,label:"Left title",font:function(){return s.default_font}},default_title_right:{show:!0,label:"Right Title",font:function(){return s.default_font}},default_toolbar:{show:!0,buttons:{monthly:!0,weekly:!0,daily:!0,accumulative:!0,incremental:!0,full_left:!0,left:!0,full_right:!0,right:!0,save:!1}},default_animation:{animate:"true",anim_style:"ease-in-out",anim_speed:300},default_data_labels:{show:!1,back:{show:!1,type:"circle",radius:2,stroke:void 0,"stroke-width":2,opacity:1,fill:"#fff",fill_opacity:1},hor_position:"center",ver_position:"center",font:function(){return s.default_font},formatter:"(a)=>{return a;}",angle:0,opacity:1,offset:{dx:0,dy:0}},default_xAxis:{show:!0,range:14,labels:{show:!0,font:function(){return s.default_font},angle:0,offset:{dx:0,dy:0}},data:[],units:function(){return s.default_units},marks:{show:!0,mark_items:[],style:{stroke:"black","stroke-width":2,fill:"#c2c2c2",opacity:.5}}},default_yAxis:{show:!0,range:10,scale:!1,labels:{show:!0,font:function(){return s.default_font},angle:0,offset:{dx:0,dy:0}},data:[],units:function(){return s.default_units}},default_data_points:{show:!0,radius:3},default_line:{show_points:!0,dot_radius:3,opacity:1,line_width:1,line_type:"c","stroke-dasharray":"",areaStyle:{normal:{},show:!1},data_points:function(){return s.default_data_points},data_labels:function(){return s.default_data_labels},animation:function(){return s.default_animation}},default_bar:{show_bar:!0,opacity:.8,"stroke-width":2,barWidth:10,bars_gap:4,series_gap:16,bar_overlap:!1,data_labels:function(){return s.default_data_labels},animation:function(){return s.default_animation}},default_any_chart:{show_bar:!0,opacity:.8,"stroke-width":2,barWidth:10,bars_gap:4,series_gap:16,bar_overlap:!1,data_points:function(){return s.default_data_points},data_labels:function(){return s.default_data_labels},animation:function(){return s.default_animation},show_points:!0,dot_radius:3,line_width:1,line_type:"c","stroke-dasharray":"",areaStyle:{normal:{},show:!1}},default_num_format:{digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",showZero:!1},template_num_format:{type:"object",title:"Cell Format",default:function(){return s.default_num_format},properties:{digitsAfterDecimal:{title:"Digits After Decimal",type:"integer",default:2},scaler:{title:"Scaler",type:"number",default:1},thousandsSep:{title:"Thousands Separator",type:"string",default:","},prefix:{title:"prefix",type:"string",default:""},suffix:{title:"suffix",type:"string",default:""},showZero:{title:"Show Zero",type:"boolean",default:!1},heat_map:{type:"boolean",title:"Heat Map",default:!0}}},t_show:{type:"boolean",title:"show",default:!0},template_animation_:{type:"object",title:"Animation",default:function(){return s.default_animation},properties:{animate:{title:"Animate",type:"boolean",default:"true"},anim_style:{title:"Easing",type:"string",default:"ease-in-out",enum:["linear","ease-in","ease-out","ease-in-out","back-in","back-out","elastic","bounce"]},anim_speed:{title:"Speed",type:"integer",default:18}}},template_title:{type:"object",title:"Title",default:function(){return s.default_title},properties:{show:{title:"Show",type:"boolean",default:"true"},label:{title:"Label",type:"string",default:""},font_size:{title:"Font Size",type:"integer",default:18},color:{type:"string",title:"Color",default:"#000"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]}}},template_toolbar:{type:"object",title:"Toolbar",default:function(){return s.default_toolbar},properties:{buttons:{type:"object",title:"Toolbar",properties:{monthly:{type:"boolean",title:"monthly",default:!0},weekly:{type:"boolean",title:"weekly",default:!0},daily:{type:"boolean",title:"daily",default:!0},accumulative:{type:"boolean",title:"accumulative",default:!0},incremental:{type:"boolean",title:"incremental",default:!0},save:{type:"boolean",title:"save",default:!0},full_left:{type:"boolean",title:"full left",default:!0},left:{type:"boolean",title:"left",default:!0},full_right:{type:"boolean",title:"full right",default:!0},right:{type:"boolean",title:"right",default:!0}}},location:{type:"string",default:"top"},show:{type:"boolean",title:"show",default:!0}}},template_data_table:{additionalProperties:!1,type:"object",title:"Data Table",default:function(){return s.default_data_table},properties:{show:function(){return s.t_show},hor_lines:{type:"object",title:"Horizontal Lines",properties:{show:{type:"boolean",title:"Show",default:!0},color:{type:"string",title:"Color",default:"#DAD8D8"}}},vert_lines:{type:"object",title:"Vertical Lines",properties:{show:{type:"boolean",title:"Show",default:!0},color:{type:"string",title:"Color",default:"#EDEDED"}}}}},template_view:{type:"object",title:"View Config",properties:{colors:{type:"object",title:"Colors",properties:{txt_a_label:{type:"string",title:"Actual Label Color",default:"#000"},txt_a_value:{type:"string",title:"Actual Value Color",default:"#000"},txt_a_value_f:{type:"string",title:"Forecast Value Color",default:"#000"},txt_a_value_b:{type:"string",title:"Baseline Value Color",default:"#000"},txt_i_label:{type:"string",title:"Actual Info label Color",default:"#000"},txt_i_value:{type:"string",title:"Actual Info value Color",default:"#000"},txt_i_value_f:{type:"string",title:"Forecast Info value Color",default:"#000"},txt_i_value_b:{type:"string",title:"Baseline Info value Color",default:"#000"},txt_addi_value_b:{type:"string",title:"Positive trend Color",default:"#000"},txt_addi_value_r:{type:"string",title:"Negative trend Color",default:"#000"},txt_addi_label:{type:"string",title:"Additional Label Color",default:"#000"},monochromatic:{type:"boolean",title:"Is Monochromatic",default:!1},mono_base_color:{type:"string",title:"Monochromatic Color",default:"#fff"},colors_array:{additionalProperties:!1,type:"array",title:"Graph Color",items:{type:"string"}}}},dot_radius:{type:"integer",default:2,title:"Points Radius"},line_width:{type:"integer",default:2,title:"Line Width"}}},template_grid:{additionalProperties:!1,type:"object",title:"Grid Options",default:function(){return s.default_grid},properties:{show:function(){return s.t_show},top_m:{type:"integer",title:"Top Margin",default:40},left_m:{type:"integer",title:"Left Margin",default:20},right_m:{type:"integer",title:"Right Margin",default:20},bottom_m:{type:"integer",title:"Bottom Margin",default:20},padding:{type:"boolean",title:"Padding",default:!0},hor_lines:{type:"object",title:"Horizontal Lines",properties:{show:{type:"boolean",title:"Show",default:!0},color:{type:"string",title:"Color",default:"#DAD8D8"}}},vert_lines:{type:"object",title:"Vertical Lines",properties:{show:{type:"boolean",title:"Show",default:!0},color:{type:"string",title:"Color",default:"#EDEDED"}}}}},template_animation:{type:"object",title:"Animation",additionalProperties:!1,default:{show:!1,delay:500,attr:{},easing:"linear",repeat:"5"},properties:{show:{type:"boolean",title:"Show",default:!1},delay:{type:"number",title:"Interval (ms)",default:1e3},attr:{type:"object",additionalProperties:!0,title:"Attributes",properties:{opacity:{type:"number",title:"Opacity",default:1},fill:{type:"string",title:"Fill",default:"none"},"font-color":{type:"string",title:"Font Color",default:"none"},"font-size":{type:"number",title:"Font Size",default:0}}},easing:{type:"string",title:"Easing Style",default:"linear",enum:["linear","easeIn","easeOut","easeInOut","backIn","backOut","elastic","bounce"]},repeat:{type:"string",title:"Repeat Times",default:"5"}}},template_font:{additionalProperties:!1,type:"object",title:"Font Style",default:function(){return s.default_font},properties:{font_size:{title:"Font Size",type:"integer",default:10},font_color:{title:"Font Color",type:"string",format:"colorpicker",default:"#000"},font_family:{title:"Font Family",type:"string",default:"Tahoma, Geneva"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]},animation:function(){return s.template_animation}}},template_title_left:{type:"object",title:"Left Title",default:function(){return s.default_title_left},properties:{show:{title:"Show",type:"boolean",default:"true"},label:{title:"Label",type:"string",default:""},font:function(){return s.template_font}}},template_title_right:{type:"object",title:"Right Title",default:function(){return s.default_title_right},properties:{show:{title:"Show",type:"boolean",default:"true"},label:{title:"Label",type:"string",default:""},font:function(){return s.template_font}}},template_popup:{type:"object",title:"Pop Up",default:function(){return s.default_popup},properties:{show:{title:"Show",type:"boolean",default:"true"},fill:{type:"string",title:"BG Color",default:"#000"},stroke:{type:"string",title:"Frame Color",default:"#666"},"stroke-width":{type:"integer",title:"Frame Width",default:2},"fill-opacity":{type:"number",title:"Opacity",default:.7},font:function(){return s.template_font}}},template_data_labels:{additionalProperties:!1,type:"object",title:"Data Labels",properties:{show:{type:"boolean",title:"Show",default:!1},back:{additionalProperties:!1,type:"object",title:"Back Shape",properties:{show:{type:"boolean",title:"Show",default:!1},type:{title:"Shape",type:"string",default:"circle",enum:["circle","rect"]},radius:{type:"integer",default:2,title:"Radius/HalfSide"},stroke:{type:"string",default:"fff",title:"Stroke"},opacity:{type:"number",default:.8,title:"Opacity"},"stroke-width":{type:"integer",default:2,title:"Stroke Width"},fill:{title:"Fill",type:"string",default:"#fff"},fill_opacity:{title:"Fill Opacity",type:"number",default:.7}}},font:function(){return s.template_font},hor_position:{type:"string",title:"Hor Position",enum:["left","center","right"],default:"center"},ver_position:{type:"string",title:"Vert Position",enum:["top","center","bottom","inside","insideTop","insideBottom"],default:"center"},offset:{type:"object",title:"Offset",default:{dx:0,dy:0},additionalProperties:!1,properties:{dx:{type:"integer",default:0},dy:{type:"integer",default:0}}},formatter:{title:"Formatter",type:"string",format:"ace",aceMode:"ace/mode/javascript",disableWorker:!1},opacity:{type:"number",default:1,title:"Opacity"},angle:{type:"integer",title:"Angle",default:0}}},template_data_points:{additionalProperties:!1,type:"object",title:"Data Points",properties:{show:{type:"boolean",title:"Show",default:!0},fill:{title:"Fill",type:"string"},stroke:{title:"Stroke",type:"string"},opacity:{title:"Opacity",type:"number"},radius:{type:"integer",default:3,title:"Radius"}}},template_units:{type:"object",title:"Units",default:function(){return s.default_units},properties:{show:{title:"Show",type:"boolean",default:"true"},label:{title:"Label",type:"string",default:""},font:function(){return s.template_font}}},template_any_chart:{additionalProperties:!1,type:"object",title:"Chart Style",default:function(){return s.default_any_chart},properties:{show_bar:{type:"boolean",title:"Show Bars",default:!0},fill:{title:"Fill Color",type:"string"},opacity:{title:"Opacity",type:"number",default:.8},stroke:{title:"Stroke",type:"string"},"stroke-width":{title:"Frame width",type:"integer",default:2},barWidth:{type:"integer",title:"Bar Max Width",default:10},bar_overlap:{type:"boolean",title:"Bars Overlapping",default:!1},bars_gap:{type:"integer",title:"Gap Between Bars",default:4},series_gap:{type:"integer",title:"Series Gap",default:16},show_points:{type:"boolean",title:"Show Data Points",default:!0},data_points:function(){return s.template_data_points},line_width:{type:"integer",default:2,title:"Line Width"},"stroke-dasharray":{type:"string",default:"solid",title:"Line Brush Style",enum:["","-",".","-.","-..",". ","- ","--","- .","--.","--.."]},line_type:{type:"string",default:"c",title:"Line Type",enum:["c","s"]},areaStyle:{type:"object",title:"Area Style",properties:{normal:{type:"object"},show:{type:"boolean",title:"Show Shade Area",default:!1},fill:{title:"Fill",type:"string"},opacity:{title:"Opacity",type:"number"}}},data_labels:function(){return s.template_data_labels},animation:function(){return s.template_animation}}},template_serie:{type:"object",title:"Chart Series",properties:{name:{type:"string",default:""},type:{type:"string",default:"line",enum:["line","bar"]},trend:{type:"string",title:"Trend",default:"accumulative",enum:["accumulative","incremental"]},force_acc:{type:"boolean",title:"Force accumulative",default:!1},style:function(){return s.template_any_chart},data:{type:"array",title:"Data",items:{type:"integer",default:0}}}},template_xAxis:{type:"object",title:"xAxis",default:function(){return s.default_xAxis},properties:{show:{title:"Show",type:"boolean",default:"true"},range:{type:"integer",title:"Number of Items",default:14},labels:{additionalProperties:!1,type:"object",title:"Labels",properties:{show:{type:"boolean",title:"Show Data Labels",default:!1},font:function(){return s.template_font},offset:{type:"object",title:"Offset",default:{dx:0,dy:0},additionalProperties:!1,properties:{dx:{type:"integer",default:0},dy:{type:"integer",default:0}}},angle:{type:"integer",title:"Angle",default:0}}},data:{type:"array",title:"data",items:{type:"string",default:""}},marks:{additionalProperties:!1,type:"object",title:"Markers",properties:{show:{type:"boolean",title:"Show Markers",default:!1},mark_items:{type:"array",title:"Mark Items",items:{type:"integer"}},style:{additionalProperties:!1,type:"object",title:"Marker Style",properties:{stroke:{title:"Stroke",type:"string",default:"black"},fill:{title:"Fill",type:"string",default:"#c2c2c2"},"stroke-width":{title:"Stroke Width",type:"number",default:1},opacity:{title:"Opacity",type:"number",default:.5}}}}},units:function(){return s.template_units}}},template_yAxis:{type:"object",title:"yAxis",default:function(){return s.default_yAxis},properties:{show:{title:"Show",type:"boolean",default:"true"},range:{type:"integer",title:"Number of Items"},max:{type:"integer",title:"Max Value"},min:{type:"integer",title:"Min Value",default:0},scale:{title:"Scale",type:"boolean",default:"false"},labels:{additionalProperties:!1,type:"object",title:"Labels",properties:{show:{type:"boolean",title:"Show Data Labels",default:!1},font:function(){return s.template_font},offset:{type:"object",title:"Offset",default:{dx:0,dy:0},additionalProperties:!1,properties:{dx:{type:"integer",default:0},dy:{type:"integer",default:0}}},angle:{type:"integer",title:"Angle",default:0}}},data:{type:"array",title:"data",items:{type:"string",default:""}},units:function(){return s.template_units}}},defaul_performance:[{id:0,name:"Scope",show:!0,forecast:"scope_count",value:"total_count",width:"50",show_progress:!0,show_percents:!1,value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:1,name:"Total",show:!0,value:"total_count",width:"100",show_progress:!0,show_percents:!1,baseline:"total_count_b",forecast:"total_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:2,name:"Week",show:!0,value:"this_week_count",width:"70",show_progress:!0,show_percents:!1,baseline:"this_week_count_b",forecast:"this_week_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:3,name:"Month",show:!0,value:"this_month_count",width:"70",show_progress:!0,show_percents:!1,baseline:"this_month_count_b",forecast:"this_month_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:4,name:"Ystd",show:!0,value:"yesterday_count",width:"70",show_progress:!1,show_percents:!1,baseline:"yesterday_count_b",forecast:"yesterday_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:5,name:"Tud",show:!0,value:"today_count",width:"70",show_progress:!0,show_percents:!1,baseline:"today_count_b",forecast:"today_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:6,name:"In SLA",show:!0,value:"in_sla_count",width:"60",show_progress:!1,show_percents:!1,value_format:{font_size:12,fill:"blue",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:7,name:"Out SLA",show:!0,value:"out_sla_count",width:"60",show_progress:!1,value_format:{font_size:12,fill:"red",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:8,name:"In SLA(Com)",show:!0,value:"d_in_sla_count",width:"100",show_progress:!1,value_format:{font_size:12,fill:"blue",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:9,name:"Out SLA(Com)",show:!0,value:"d_out_sla_count",width:"100",show_progress:!1,value_format:{font_size:12,fill:"red",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:10,name:"7d: (-7d)",value:"d7_count",show:!0,last_value:"d14_count",width:"auto",baseline:"d7_count_b",forecast:"d7_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:11,name:"30d: (-30d)",value:"d30_count",show:!0,last_value:"d60_count",width:"auto",baseline:"d30_count_b",forecast:"d30_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:12,name:"Last Week",show:!1,value:"last_week_count",width:"70",show_progress:!0,show_percents:!1,baseline:"last_week_count_b",forecast:"last_week_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}},{id:13,name:"Last Month",show:!1,value:"last_month_count",width:"70",show_progress:!0,show_percents:!1,baseline:"last_month_count_b",forecast:"last_month_count_f",value_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal",opacity:1,"text-anchor":"start"},label_format:{font_size:12,fill:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold",opacity:1,"text-anchor":"start"}}],template_config:{type:"object",title:"Physical Config",properties:{field_name:{type:"string",title:"Config",default:"site_type1",get enum(){return p.site_table_columns}},array:{type:"array",title:"Conf Item",items:{type:"string"},default:["G18","U21","L09","L18","L21","L26"]}}},template_performance:{type:"array",title:"Performance Setup",items:{type:"object",title:"Column",properties:{id:{type:"number",format:"hidden"},name:{type:"string",title:"Name",default:""},scope:{type:"string",title:"scope",format:"hidden"},value:{type:"string",title:"value",format:"hidden"},show:{type:"boolean",title:"Show",format:!0},last_value:{type:"string",title:"last value",format:"hidden"},width:{type:"string",title:"Width",default:"100"},forecast:{type:"string",format:"hidden"},baseline:{type:"string",format:"hidden"},hide_baseline:{type:"boolean",title:"Hide Baseline",format:!0},hide_forecast:{type:"boolean",title:"Hide Forecast",format:!0},show_progress:{type:"boolean",title:"Show Progress",format:!0},show_percents:{type:"boolean",title:"Show Percents"},value_format:{type:"object",title:"Values Format",properties:{font_size:{title:"Font Size",type:"integer",default:10},fill:{title:"Font Color",type:"string",default:"#000"},font_family:{title:"Font Family",type:"string",default:"Tahoma, Geneva"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]},"text-anchor":{title:"Hor Align",type:"string",default:"normal",format:"hidden",enum:["end","middle","start"]},opacity:{type:"number",title:"Opacity"}}},label_format:{type:"object",title:"Labels Format",properties:{font_size:{title:"Font Size",type:"integer",default:10},fill:{title:"Font Color",type:"string",default:"#000"},font_family:{title:"Font Family",type:"string",default:"Tahoma, Geneva"},font_style:{title:"Font Style",type:"string",default:"normal",enum:["normal","italic","oblique","inherit"]},font_weight:{title:"Font Weight",type:"string",default:"normal",enum:["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"]},"text-anchor":{title:"Hor Align",type:"string",default:"normal",format:"hidden",enum:["end","middle","start"]},opacity:{type:"number",title:"Opacity"}}}}}},default_task:{label:"",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name / Task Code",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],value:0,total:0,fixed_data:[],sites_list_out:[],info:["this Week","this Month","Yesterday","Today"]},template_conditions:{type:"array",title:"Filter",items:{type:"object",default:{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"},properties:{logic:{type:"string",default:"",enum:["","and","or"]},preset:{type:"string",default:"custom",enum:["custom","All","not Empty","Empty","EOM","EOW","EOT","this Year","this Month","this Week","Today","Monday","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]},prop:{type:"string",default:"self"},sign:{type:"string",default:"not equal",enum:["","not equal","equal","more","less","less or equal","more or equal"]},value:{type:"string",default:"empty"},shift:{type:"object",properties:{sign:{type:"string",default:"+",enum:["+","-"]},value:{type:"number",default:0}}},range:{type:"object",properties:{sign:{type:"string",default:"+",enum:["+","-"]},value:{type:"number",default:0}}}}}},template_task:{type:"object",title:"Task",default:{label:"",task_type:"actual",data_type:"real time",group_name:"",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],value:0,total:0,fixed_data:[],sites_list_out:[],info:["this Week","this Month","Yesterday","Today"]},properties:{label:{type:"string",default:"",title:"Label"},show:{type:"boolean",title:"Show",default:!1},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","baseline month","fixed week"]},task_type:{type:"string",title:"Task Type",default:"actual"},group_name:{type:"string",title:"Group Name",default:""},count_type:{type:"string",title:"Count Type",default:"physical",enum:["physical","logical"]},get config(){return p.template_config},multy_milestone:{type:"boolean",title:"Is Multi Milestone",default:!1},multy_milestones:{type:"array",title:"Milestones List",items:{type:"object",title:"Task",format:"taskcodeq",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}}},task:{type:"object",title:"Task",format:"taskcodeq",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}},get conditions(){return p.template_conditions},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},isEditedLabel:{type:"boolean",format:"hidden",default:!1},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},site_id:{type:"string",title:"Site ID"}}}},value:{type:"integer",title:"Current Value",default:0},total:{type:"integer",title:"Total Value",default:0},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}},view:{additionalProperties:!1,type:"object",title:"View Config",properties:{colors:{type:"object",title:"Colors",properties:{monochromatic:{type:"boolean",title:"Is Monochromatic",default:!1},mono_base_color:{type:"string",title:"Monochromatic Color",default:"#fff"}}},frame:{type:"object",title:"Frame",properties:{show:{title:"Show",type:"boolean",default:"true"},width:{type:"integer",title:"Width",default:1},color:{type:"string",title:"Color",default:"#4b4b4b"}}},bar:{type:"object",title:"Bar",properties:{show:{title:"Show",type:"boolean",default:"true"},height:{type:"integer",title:"Item Height",default:30},frame:{type:"object",title:"Frame",properties:{show:{title:"Show",type:"boolean",default:"true"},width:{type:"integer",title:"Width",default:30},color:{type:"string",title:"Color",default:"#4b4b4b"}}}}},value:{type:"object",title:"Values",properties:{show:{title:"Show",type:"boolean",default:"true"},font:function(){return s.template_font}}},total:{type:"object",title:"Totals",properties:{show:{title:"Show",type:"boolean",default:"true"},font:function(){return s.template_font}}},percents:{type:"object",title:"Percents",properties:{show:{title:"Show",type:"boolean",default:"true"},font:function(){return s.template_font}}},label:{type:"object",title:"Labels",properties:{show:{title:"Show",type:"boolean",default:"true"},type_show:{title:"Show Task Type",type:"boolean",default:"true"},font:function(){return s.template_font}}}}},outPort:{type:"string",format:"hidden"}}},template_params:{additionalProperties:!1,type:"array",title:"Params",items:{additionalProperties:!1,type:"object",title:"Param",default:{prop_type:"value",param_name:"",param_source:"",param_details:"",prop_key:""},properties:{disabled:{title:"Disabled",type:"boolean",default:!0},is_clean:{title:"Direct String",type:"boolean",default:!0},param_name:{type:"string",default:"",title:"Param Name"},prop_type:{type:"string",default:"",format:"hidden",title:"Property Type",enum:["value","list","data"]},param_source:{type:"string",default:"",format:"param_source",title:"Param Source"},param_details:{type:"string",default:"",format:"param_details",title:"Param Property"},prop_key:{type:"string",default:"",format:"prop_key",title:"Property Key"},repeat:{title:"Repeat over List",type:"boolean",default:!0},full_data:{title:"Input Data",type:"boolean",default:!0},value:{title:"Value",type:"string",default:""}}}},template_lookups:{additionalProperties:!1,type:"array",title:"Lookup Params",items:{additionalProperties:!1,type:"object",title:"Param",default:{param_name:"",param_source:{table_name:"table"},key:{column_name:"column"},value:{column_name:"column"},result:{key:"key",value:"value"}},properties:{param_name:{type:"string",default:"",title:"Param Name"},param_source:{type:"object",format:"lookup_source",title:"Param Source",description:"table name for lookup",properties:{table_name:{type:"string",default:""}}},key:{type:"object",format:"lookup_key",title:"Key Column",properties:{column_name:{type:"string",default:""}}},value:{type:"object",format:"prop_value",title:"Value Column",properties:{column_name:{type:"string",default:""}}},result:{type:"object",format:"prop_result",title:"Value",properties:{value:{type:"string",default:""}}}}}},template_xls_params:{additionalProperties:!1,type:"array",title:"Data Mapping",items:{additionalProperties:!1,type:"object",title:"Param",default:{prop_type:"value",param_name:"",param_source:"",param_details:"",prop_key:"",cell:"",sheet:""},properties:{param_name:{type:"string",default:"",title:"Param Name"},param_source:{type:"string",default:"",format:"param_source",title:"Param Source"},param_details:{type:"string",default:"",format:"param_details",title:"Param Property"},prop_key:{type:"string",default:"",format:"prop_key",title:"Property Key"},cell:{type:"string",title:"Cell",default:""},sheet:{type:"string",title:"Sheet",default:""},data_type:{type:"string",default:"",title:"Property Type",enum:["cell","range"]},prop_type:{type:"string",default:"",format:"hidden",title:"Property Type",enum:["value","list","data"]}}}}};DEBUG=!1,DEBUGAI=!1,PIVOT_DEBUG=!1,CHART_DEBUG=!1,a("8a868d10b6533e768658").shape.fishbone={basic:{},cell:{},label:{},ra:{}},a("8a868d10b6533e768658").Port.prototype.setValue=function(e){var t=this.value;return this.value=e,null!==this.getParent()&&this.getParent().onPortValueChanged(this),this.fireEvent("change:value",{value:this.value,old:t}),this},a("8a868d10b6533e768658").Figure.prototype.getSchema=function(){return this.treema_scheme},a("8a868d10b6533e768658").Figure.prototype.loadTreema=function(){n.isFunction(this.updateSearchCol)?this.project||"draw2d.shape.fishbone.cell.Projectnode"===this.NAME||"draw2d.shape.fishbone.cell.Projectnode_api"===this.NAME?(this.updateSearchCol(this.project,this.scope,this,this.sop),this.treema=d(n("#treema_container"),this.getSchema(),this.userData)):n("#treema_container").append(n("<div style='text-align: center'></div>").addClass("treema-shortened").text("Node is not connected to any data source.")):this.treema=d(n("#treema_container"),this.getSchema(),this.userData,this)},a("8a868d10b6533e768658").Figure.prototype.clearTreema=function(){var e=document.getElementById("treema_container");if(e)for(;e.firstChild;)e.removeChild(e.firstChild)},a("8a868d10b6533e768658").Figure.prototype.toogleInConn=function(){var e;this.userData.showInConnections?(e=this.getInputPorts())&&e.data&&e.data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:0})}))})):(e=this.getInputPorts())&&e.data&&e.data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:2})}))})),this.userData.showInConnections=!this.userData.showInConnections},a("8a868d10b6533e768658").Figure.prototype.toogleOutConn=function(){var e;this.userData.showOutConnections?(e=this.getOutputPorts())&&e.data&&e.data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:0})}))})):(e=this.getOutputPorts())&&e.data&&e.data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:2})}))})),this.userData.showOutConnections=!this.userData.showOutConnections},a("8a868d10b6533e768658").Figure.prototype.updateUI=function(){},a("8a868d10b6533e768658").Figure.prototype.resetUI=function(){},a("8a868d10b6533e768658").Figure.prototype.GetHTTPData=function(){},a("8a868d10b6533e768658").Figure.prototype.exportToExcel=function(){i.exportArrayToExcel(this.userData.sites_list_out.slice())},a("8a868d10b6533e768658").Canvas.prototype.calculateConnectionIntersection=function(){return this},Date.prototype.getWeek2=function(){var e=new Date(this.getFullYear(),0,1);return Math.ceil(((this-e)/864e5+e.getDay()+1)/7)},Date.prototype.getWeek=function(){var e=new Date(this.getTime());e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var t=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},Date.prototype.ISO8601_week_no=function(){var e=new Date(this.valueOf()),t=(this.getDay()+6)%7;e.setDate(e.getDate()-t+3);var a=e.valueOf();return e.setMonth(0,1),4!==e.getDay()&&e.setMonth(0,1+(4-e.getDay()+7)%7),1+Math.ceil((a-e)/6048e5)},Date.prototype.ISO8601_y_week_no=function(){var e,t=new Date(this.valueOf()),a=(this.getDay()+6)%7;t.setDate(t.getDate()-a+3);var n=t.valueOf();return e=t.getFullYear(),t.setMonth(0,1),4!==t.getDay()&&t.setMonth(0,1+(4-t.getDay()+7)%7),e+"-"+i.zeroPadl(1+Math.ceil((n-t)/6048e5),2)},Date.prototype.getWeekYear=function(){var e=new Date(this.getTime());return e.setDate(e.getDate()+3-(e.getDay()+6)%7),e.getFullYear()},Date.prototype.isSameDateAs=function(e){return this.getFullYear()===e.getFullYear()&&this.getMonth()===e.getMonth()&&this.getDate()===e.getDate()},Raphael.fn.popup=function(e,t,a,n,o){(n=String(n||"top-middle").split("-"))[1]=n[1]||"middle";var i=a.getBBox(),r=Math.round(i.width),s=Math.round(i.height),l=Math.round(i.x)-5,c=Math.round(i.y)-5,u=Math.min(s/2,r/2,10),d=[{x:l+5,y:c,w:r,w4:r/4,h4:s/4,right:0,left:r-2*u,bottom:0,top:s-2*u,r:5,h:s,gap:u},{x:l+5,y:c,w:r,w4:r/4,h4:s/4,left:r/2-u,right:r/2-u,top:s/2-u,bottom:s/2-u,r:5,h:s,gap:u},{x:l+5,y:c,w:r,w4:r/4,h4:s/4,left:0,right:r-2*u,top:0,bottom:s-2*u,r:5,h:s,gap:u}]["middle"==n[1]?1:2*("top"==n[1]||"left"==n[1])],p=0,h=0,f=this.path(fill({top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"}[n[0]],d)).insertBefore(a);switch(n[0]){case"top":p=e-(l+5+d.left+u),h=t-(c+5+s+5+u);break;case"bottom":p=e-(l+5+d.left+u),h=t-(c-u);break;case"left":p=e-(l+5+r+5+u),h=t-(c+5+d.top+u);break;case"right":p=e-(l-u),h=t-(c+5+d.top+u)}return f.translate(p,h),o?(o=f.attr("path"),f.remove(),{path:o,dx:p,dy:h}):(a.translate(p,h),f)},Raphael.el.setText=function(e){this.attr({text:e})},Raphael.el.getText=function(){return this.attr("text")},Raphael.el.on=function(e){n(this.node).on(e,void 0)}(((c=Raphael).el.cloneToPaper=function(e){return!this.removed&&e[this.type]().attr(this.attr())},void(c.st.cloneToPaper=function(e){return e.setStart(),this.forEach(u||(u=function(t){t.cloneToPaper(e)})),e.setFinish()}))),function(e){function t(e){if("number"==typeof e)return e.toString();var t={"<":"lt",">":"gt",'"':"quot","'":"apos"};for(var a in t)e=e.replace(new RegExp(a,"g"),"&"+t[a]+";");return e}function a(e,t){var a,n=[];if(void 0!==e.unshift){var o=e.length;for(a=0;a<o;a++)"undefined"!=l(e[a])&&null!==(i=t.call(this,e[a],a))&&n.push(i)}else for(a in e){var i;e.hasOwnProperty(a)&&null!==(i=t.call(this,e[a],a))&&n.push(i)}return n}function n(e,t,a){for(var n in e)e.hasOwnProperty(n)&&(a=t.call(this,a,e[n],n));return a}function o(n,o,i,r){return null==r&&(r=""),"object"===l(o)&&(o=a(o,(function(a,n){switch(n){case"transform":return;case"fill":if(a.match(/^hsb/)){var o=a.replace(/^hsb\(|\)$/g,"").split(",");3===o.length&&(a=e.hsb2rgb(o[0],o[1],o[2]).toString())}}return n+'="'+t(a)+'"'})).join(" ")),"<"+n+(i?' transform="matrix('+i.toString().replace(/^matrix\(|\)$/g,"")+')" ':" ")+o+">"+r+"</"+n+">"}function i(e){var t="normal",a="text-anchor: "+(e.anchor||"middle")+"; ",n=e.font;return a+["font:",n.style||t,t,n.weight||t,(n.size?n.size+"px":"10px")+"/normal",n.family].join(" ")}function r(e){return/^[0-9A-F]{6}$/i.test(e)&&(e="#"+e),e}function s(e,t,a){return null===e&&(e=10),4.5*e/13*(t-.2-a/2)*3.5}var c={text:function(e){var l=function(e){return{font:{family:void 0===e.attrs.font?null:e.attrs.font.replace(/^.?"(\w+)".$/,"$1"),size:void 0===e.attrs["font-size"]?null:parseInt(e.attrs["font-size"]),style:void 0===e.attrs["font-style"]?null:e.attrs["font-style"],weight:void 0===e.attrs["font-weight"]?null:e.attrs["font-weight"]},anchor:void 0===e.attrs["text-anchor"]?null:e.attrs["text-anchor"]}}(e),c=new Array,u=e.attrs.text.toString().split("\n"),d=u.length;return a(u,(function(a,u){var p=n(e.attrs,(function(e,a,n){return"text"!==n&&"w"!==n&&"h"!==n&&("font-size"===n&&(a=parseInt(a)+"px"),"stroke"===n&&(a=r(a)),e[n]=t(a.toString())),e}),{style:i(l)+";"});""!=e.node.className.baseVal&&void 0!==e.node.className.baseVal&&(p.class=e.node.className.baseVal),c.push(o("text",p,e.matrix,o("tspan",{dy:s(l.font.size,u+1,d)},null,a.replace(/&/g,"&amp;"))))})),c},path:function(e){return 1===e.matrix.a&&1===e.matrix.d||e.matrix.toString(),o("path",n(e.attrs,(function(e,t,a){return"path"===a&&(a="d"),"stroke"===a&&(t=r(t)),e[a]=t.toString(),e}),{}),e.matrix)}};e.fn.toSVG=function(){var a=this,n={svg:e.svg,vml:e.vml},o='<svg style="overflow: hidden; position: relative;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+a.width+'" version="1.1" height="'+a.height+'">';e.svg=!0,e.vml=!1;for(var i=a.bottom;null!=i;i=i.next)if("none"!==i.node.style.display){var s="";if("function"!=typeof c[i.type]){for(var l in"image"===i.type&&(s+=' preserveAspectRatio="none"'),i.attrs){var u=l,d="";switch(l){case"r":if("rect"!=i.type)break;d=i.attrs.r,i.attrs.rx=d,i.attrs.ry=d;continue;case"src":u="xlink:href";break;case"transform":u="";break;case"fill":if(i.attrs.gradient)continue;break;case"gradient":var p=i.id,h=i.attrs.gradient,f=.5,m=.5;if(h=(h=String(h).replace(e._radial_gradient,(function(e,t,a){if(type="radial",t&&a){f=parseFloat(t);var n=2*((m=parseFloat(a))>.5)-1;Math.pow(f-.5,2)+Math.pow(m-.5,2)>.25&&(m=Math.sqrt(.25-Math.pow(f-.5,2))*n+.5)&&.5!=m&&(m=m.toFixed(5)-1e-5*n)}return""}))).split(/\s*\-\s*/),i.attrs.gradient.match(/^r/g)){if(!(_=e._parseDots(h)))continue;o+="<defs>",o+='\t    <radialGradient id="radialgradient'+p+'" fx="'+f+'" fy="'+m+'" >';for(var g=0;g<_.length;g++){var y=g/(_.length-1)*100+"%";_[g].offset&&(y=_[g].offset),o+='<stop stop-color="'+_[g].color+'" offset="'+y+'"/>'}o+="    </radialGradient>",o+="</defs>",u="fill",d="url(#radialgradient"+p+")"}else{var _,b=h.shift();if(b=-1*parseFloat(b),isNaN(b))continue;if(!(_=e._parseDots(h)))continue;var v=[0,0,Math.cos(e.rad(b)),Math.sin(e.rad(b))],w=1/(Math.max(Math.abs(v[2]),Math.abs(v[3]))||1);for(v[2]*=w,v[3]*=w,v[2]<0&&(v[0]=-v[2],v[2]=0),v[3]<0&&(v[1]=-v[3],v[3]=0),o+="<defs>",o+='\t    <linearGradient id="lineargradient'+p+'" x1="'+v[0]+'" y1="'+v[1]+'" x2="'+v[2]+'" y2="'+v[3]+'">',g=0;g<_.length;g++)y=g/(_.length-1)*100+"%",_[g].offset&&(y=_[g].offset),o+='<stop stop-color="'+_[g].color+'" offset="'+y+'"/>';o+="    </linearGradient>",o+="</defs>",u="fill",d="url(#lineargradient"+p+")"}break;case"stroke":d=r(d||i.attrs[l].toString())}u&&(s+=d?" "+u+'="'+t(d)+'"':" "+u+'="'+t(i.attrs[l].toString())+'"')}""!=i.node.className.baseVal&&(s+=' class="'+i.node.className.baseVal+'"'),o+="<"+i.type+' transform="matrix('+i.matrix.toString().replace(/^matrix\(|\)$/g,"")+')"'+s+"></"+i.type+">"}else o+=c[i.type](i)}return o+="</svg>",e.svg=n.svg,e.vml=n.vml,o}}(Raphael),document.ontouchmove=function(e){},r.fn.zeroPad=function(e){return e?i.zeroPadl(e.toString()):null},r.aggr.CONCAT_GROUP=function(e,t,a){if(1===a)return e?e.split(","):[];if(2===a)return e&&(t=t.concat(e.split(","))),t;if(3===a){var n=t.filter((function(e,t,a){return a.indexOf(e)===t}));return n.join(",")}},r.aggr.MEDIAN=function(e,t,a){if(2===a)return null!==e&&t.push(e),t;if(1===a)return null===e?[]:[e];if(!t.length)return t;var n=t.sort((function(e,t){return e===t?0:e>t?1:-1})),o=(n.length+1)/2;if(Number.isInteger(o))return n[o-1];var i=n[Math.floor(o-1)];return"number"==typeof i||i instanceof Number?(i+n[Math.ceil(o-1)])/2:i},r.aggr.MODE=function(e,t,a){return 1===a?[e]:2===a?(t.push(e),t):t.sort().reduce((function(e,t){var a=e.numMapping[t]=(e.numMapping[t]||0)+1;return a>e.greatestFreq&&(e.greatestFreq=a,e.mode=t),e}),{mode:null,greatestFreq:-1/0,numMapping:{}}).mode},r.aggr.GROUP_CONCAT=function(e,t,a){return 1===a?e?[e]:[]:2===a?(e&&t.push(e),t):3===a?t&&t.length?t.join(", "):"":void 0},r.aggr.GROUP_CONCAT_ARR=function(e,t,a){return 1===a?e?[e]:[]:2===a?(e&&t.push(e),t):3===a?t&&t.length?t:[]:void 0},r.aggr.GROUP_DATE_MAX=function(e,t,a){return 1===a?e?o(e):null:2===a?(e&&(t=o.max(o(e),t)),t):3===a?t||"":void 0},r.aggr.COUNT_ACC=function(e,t,a){var n=0;return 1===a?e?1:null:2===a?(e&&(t+=1),t):3===a?(n=t+n,t?t+n:""):void 0},r.fn.moment=o,r.options.cache=!1,e.exports=p},b0e0ab7134eab0eaea07:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.label.Countdown=n.shape.basic.Label.extend({NAME:"Countdown",INFO:"{Class: <strong>Countdown</strong>}<br/><br/>",init:function(e,t,a){this._super(o.extend({text:"00d:00h:00:m:00s",color:"rgba(255, 255, 255, 0)",radius:10,padding:10,stroke:1},e),t,a);var n=this.getUserData(),i=new Date,r=new Date;r.setDate(i.getDate()+10);var s=this;null===n&&this.attr({userData:{hidden:!1,index:0,target_date:r.toLocaleDateString(),font:{font_size:22,font_color:"#000",font_family:"Tahoma, Geneva",font_bold:!0},back_color:"",frame_size:0,frame_color:"#989799",padding:10}}),this.setParams=function(){s.setFontSize(this.userData.font.font_size),s.setFontColor(this.userData.font.font_color),s.setFontFamily(this.userData.font.font_family),s.setBackgroundColor(""===this.userData.back_color?null:this.userData.back_color),s.setStroke(this.userData.frame_size),s.setColor(this.userData.frame_color),s.setPadding(this.userData.padding),s.setBold(this.userData.font.font_bold)},this.setParams(),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0},target_date:{type:"string",title:"Start Date",format:"date",default:""},font:{type:"object",additionalProperties:!1,properties:{font_size:{type:"integer",title:"Font Size",default:24},font_color:{type:"string",title:"Font Color",default:"#000"},font_family:{type:"string",title:"Font Family",default:"Tahoma, Geneva"},font_bold:{type:"boolean",title:"Font Bold",default:!1}}},back_color:{type:"string",title:"Back Color"},frame_size:{type:"integer",title:"Frame Size",default:1},frame_color:{type:"string",title:"Frame Color",default:"#989799"},padding:{type:"integer",title:"Padding",default:10}}},this.GetHTTPData=function(){this.setParams()},this.startTimer(1e3)},onTimer:function(){var e=new Date,t=new Date(this.userData.target_date),a=t-e,n=Math.floor(a/864e5),o=Math.floor(Math.floor(a-864e5*n)/36e5),i=Math.floor(Math.floor(a-(864e5*n+36e5*o))/6e4),r=Math.floor(Math.floor(a-(864e5*n+36e5*o+6e4*i))/1e3);t>e?this.setText(n+"d:"+o+"h:"+i+"m:"+r+"s"):this.setText("reached")}})},bbceea22d6e26ed38dee:function(e,t,a){var n,o,i;o=[t,a("226c6cbac568646c1f21")],void 0===(i="function"==typeof(n=function(e,t){var a;t?t.registerTheme("roma",{color:["#e01f54","#001852","#f5e8c8","#b8d2c7","#c6b38e","#a4d8c2","#f3d999","#d3758f","#dcc392","#2e4783","#82b6e9","#ff6347","#a092f1","#0a915d","#eaf889","#6699FF","#ff6666","#3cb371","#d5b158","#38b6b6"],backgroundColor:"rgba(0,0,0,0)",textStyle:{},title:{textStyle:{color:"#333333"},subtextStyle:{color:"#aaaaaa"}},line:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:4,symbol:"emptyCircle",smooth:!1},radar:{itemStyle:{borderWidth:1},lineStyle:{width:2},symbolSize:4,symbol:"emptyCircle",smooth:!1},bar:{itemStyle:{barBorderWidth:0,barBorderColor:"#ccc"}},pie:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},scatter:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},boxplot:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},parallel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},sankey:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},funnel:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},gauge:{itemStyle:{borderWidth:0,borderColor:"#ccc"}},candlestick:{itemStyle:{color:"#e01f54",color0:"#001852",borderColor:"#f5e8c8",borderColor0:"#b8d2c7",borderWidth:1}},graph:{itemStyle:{borderWidth:0,borderColor:"#ccc"},lineStyle:{width:1,color:"#aaaaaa"},symbolSize:4,symbol:"emptyCircle",smooth:!1,color:["#e01f54","#001852","#f5e8c8","#b8d2c7","#c6b38e","#a4d8c2","#f3d999","#d3758f","#dcc392","#2e4783","#82b6e9","#ff6347","#a092f1","#0a915d","#eaf889","#6699FF","#ff6666","#3cb371","#d5b158","#38b6b6"],label:{color:"#eeeeee"}},map:{itemStyle:{areaColor:"#eeeeee",borderColor:"#444444",borderWidth:.5},label:{color:"#000000"},emphasis:{itemStyle:{areaColor:"rgba(255,215,0,0.8)",borderColor:"#444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},geo:{itemStyle:{areaColor:"#eeeeee",borderColor:"#444444",borderWidth:.5},label:{color:"#000000"},emphasis:{itemStyle:{areaColor:"rgba(255,215,0,0.8)",borderColor:"#444",borderWidth:1},label:{color:"rgb(100,0,0)"}}},categoryAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!1,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},valueAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},logAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},timeAxis:{axisLine:{show:!0,lineStyle:{color:"#333"}},axisTick:{show:!0,lineStyle:{color:"#333"}},axisLabel:{show:!0,color:"#333"},splitLine:{show:!0,lineStyle:{color:["#ccc"]}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}}},toolbox:{iconStyle:{borderColor:"#999999"},emphasis:{iconStyle:{borderColor:"#666666"}}},legend:{textStyle:{color:"#333333"}},tooltip:{axisPointer:{lineStyle:{color:"#cccccc",width:1},crossStyle:{color:"#cccccc",width:1}}},timeline:{lineStyle:{color:"#293c55",width:1},itemStyle:{color:"#293c55",borderWidth:1},controlStyle:{color:"#293c55",borderColor:"#293c55",borderWidth:.5},checkpointStyle:{color:"#e43c59",borderColor:"#c23531"},label:{color:"#293c55"},emphasis:{itemStyle:{color:"#a9334c"},controlStyle:{color:"#293c55",borderColor:"#293c55",borderWidth:.5},label:{color:"#293c55"}}},visualMap:{color:["#e01f54","#e7dbc3"]},dataZoom:{backgroundColor:"rgba(47,69,84,0)",dataBackgroundColor:"rgba(47,69,84,0.3)",fillerColor:"rgba(167,183,204,0.4)",handleColor:"#a7b7cc",handleSize:"100%",textStyle:{color:"#333333"}},markPoint:{label:{color:"#eeeeee"},emphasis:{label:{color:"#eeeeee"}}}}):(a="ECharts is not Loaded","undefined"!=typeof console&&console&&console.error&&console.error(a))})?n.apply(t,o):n)||(e.exports=i)},bcaf2317679638841a11:()=>{getConnection=function(e,t,a,n,o,i){t.line&&t.from&&t.to&&(t=(n=t).from,a=n.to);for(var r=t.getBBox(),s=a.getBBox(),l=[{x:r.x+r.width/2,y:r.y-1},{x:r.x+r.width/2,y:r.y+r.height+1},{x:r.x-1,y:r.y+r.height/2},{x:r.x+r.width+1,y:r.y+r.height/2},{x:s.x+s.width/2,y:s.y-1},{x:s.x+s.width/2,y:s.y+s.height+1},{x:s.x-1,y:s.y+s.height/2},{x:s.x+s.width+1,y:s.y+s.height/2}],c={},u=[],d=0;d<4;d++)for(var p=4;p<8;p++){var h=Math.abs(l[d].x-l[p].x),f=Math.abs(l[d].y-l[p].y);(d==p-4||(3!=d&&6!=p||l[d].x<l[p].x)&&(2!=d&&7!=p||l[d].x>l[p].x)&&(0!=d&&5!=p||l[d].y>l[p].y)&&(1!=d&&4!=p||l[d].y<l[p].y))&&(u.push(h+f),c[u[u.length-1]]=[d,p])}if(0==u.length)var m=[0,4];else m=c[Math.min.apply(Math,u)];var g=l[m[0]].x,y=l[m[0]].y,_=l[m[1]].x,b=l[m[1]].y;h=Math.max(Math.abs(g-_)/2,10),f=Math.max(Math.abs(y-b)/2,10);var v=[g,g,g-h,g+h][m[0]].toFixed(3),w=[y-f,y+f,y,y][m[0]].toFixed(3),x=[0,0,0,0,_,_,_-h,_+h][m[1]].toFixed(3),k=[0,0,0,0,y+f,y-f,b,b][m[1]].toFixed(3),D=["M",g.toFixed(3)-i.x,y.toFixed(3)-i.y,"C",v-i.x,w-i.y,x-i.x,k-i.y,_.toFixed(3)-i.x,b.toFixed(3)-i.y].join(",");if(!n||!n.line){var S="string"==typeof n?n:"#000";return{bg:o&&o.split&&e.path(D).attr({stroke:o.split("|")[0],fill:"none","stroke-width":o.split("|")[1]||3}),line:e.path(D).attr({stroke:S,fill:"none"}),from:t,to:a,path:D}}n.bg&&n.bg.attr({path:D}),n.line.attr({path:D})}},be724121e5c7ab220f70:(e,t,a)=>{"use strict";var n=a("d03d36be50c40888c6b4");e=a.hmd(e);var o=a("a45670b3d8fb79ec0258"),i=a("8deafab7866a125bb9ca");function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}(function(){var t;t=function(e){return e.pivotUtilities_ra.ra_table_renderers={"Ra Table":function(e,t){var a=t.figure,o=a.canvas.paper,r=a.userData,s=function(e,t,a,n,o,i){return a?r.col[e]&&r.col[e].values?{font:r.col[e].values.font_size+"px Tahoma, Geneva","font-style":r.col[e].values.font_style,fill:r.col[e].values.color,"font-weight":r.col[e].values.font_weight}:P:n?r.col[t]&&r.col[t].values?{font:r.col[t].values.font_size+"px Tahoma, Geneva","font-style":r.col[t].values.font_style,fill:r.col[t].values.color,"font-weight":r.col[t].values.font_weight}:P:void 0},l=0,c=(r.pivot.colors.monochromatic?r.pivot.colors.mono_base_color:a.userData.pivot.colors.data_color,r.pivot.colors.monochromatic?r.pivot.colors.mono_base_color:a.userData.pivot.colors.labels_color,r.pivot.colors.monochromatic?r.pivot.colors.mono_base_color:a.userData.pivot.colors.frame_color),u=r.pivot.multi_line_max||400;a.userData.start_from="",a.treema_scheme.properties.start_from.enum=[""],a.userData.pivot.fonts||(a.userData.pivot.fonts={data_font:{font_size:12,font_color:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal"},titles_font:{font_size:12,font_color:"#4c4c4c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold"},totals_font:{font_size:12,font_color:"#8c8c8c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"bold"}});var d,p,h,f,m,g,y,_,b,v,w,x,k,D,S,C,T,A,P={"font-size":a.userData.pivot.fonts.data_font.font_size,"font-family":a.userData.pivot.fonts.data_font.font_family,fill:a.userData.pivot.fonts.data_font.font_color,"font-weight":a.userData.pivot.fonts.data_font.font_weight,"font-style":a.userData.pivot.fonts.data_font.font_style},E={"font-size":a.userData.pivot.fonts.totals_font.font_size,"font-family":a.userData.pivot.fonts.totals_font.font_family,fill:a.userData.pivot.fonts.totals_font.font_color,"font-weight":a.userData.pivot.fonts.totals_font.font_weight,"font-style":a.userData.pivot.fonts.totals_font.font_style},I={"font-size":a.userData.pivot.fonts.totals_font.font_size,"font-family":a.userData.pivot.fonts.totals_font.font_family,fill:a.userData.pivot.fonts.totals_font.font_color,"text-anchor":"start","font-weight":a.userData.pivot.fonts.totals_font.font_weight,"font-style":a.userData.pivot.fonts.totals_font.font_style},N={"font-size":a.userData.pivot.fonts.titles_font.font_size,"font-family":a.userData.pivot.fonts.titles_font.font_family,fill:a.userData.pivot.fonts.titles_font.font_color,"text-anchor":"end","font-weight":a.userData.pivot.fonts.titles_font.font_weight,"font-style":a.userData.pivot.fonts.titles_font.font_style},M={"font-size":a.userData.pivot.fonts.totals_font.font_size,"font-family":a.userData.pivot.fonts.totals_font.font_family,fill:a.userData.pivot.fonts.totals_font.font_color,"text-anchor":"end","font-weight":a.userData.pivot.fonts.totals_font.font_weight,"font-style":a.userData.pivot.fonts.totals_font.font_style},O={"font-size":a.userData.pivot.fonts.titles_font.font_size,"font-family":a.userData.pivot.fonts.titles_font.font_family,fill:a.userData.pivot.fonts.titles_font.font_color,"text-anchor":"start","font-weight":a.userData.pivot.fonts.titles_font.font_weight,"font-style":a.userData.pivot.fonts.titles_font.font_style},j={"stroke-width":0,opacity:0},R={stroke:c,"stroke-width":3},L={stroke:c,"stroke-width":1},F={stroke:c,"stroke-width":2};0===(A=e.getRowKeys()).length&&A.push([]),0===(f=e.getColKeys()).length&&f.push([]),C=e.rowAttrs,p=e.colAttrs;for(var U=!1,B=!1,z=0;z<C.length;z++)"task_name"===C[z]&&(B=!0);for(z=0;z<p.length;z++)"task_name"===p[z]&&(U=!0);var H=[],q=[];C.length&&C.forEach((function(e,t){ie=o.text(-1e4,-1e4,C[t]).attr(O),H.push([]),H[t].push(ie.getBBox().width+10)})),p.length&&p.forEach((function(e,t){ie=o.text(-1e4,-1e4,p[t]).attr(O),q.push([]),q[t].push(ie.getBBox().width+10)})),A.forEach((function(e,t){e.forEach((function(e,t){ie=o.text(-1e4,-1e4,e).attr(O),H[t].push(ie.getBBox().width+10)}))}));var V=[];H.forEach((function(e,t){var a=Math.max.apply(Math,H[t]);a>u?V.push(u):V.push(a)}));var W=50;C.length>0?W=V.reduce((function(e,t){return e+t})):p.length>0&&(W=Math.max.apply(Math,q));var G=0,J=[];for(pe in V)J.push(G),G+=V[pe];var Q=(a.userData.size.width-W)/(f.length+1),Y=Math.max(a.userData.pivot.fonts.data_font.font_size,a.userData.pivot.fonts.totals_font.font_size,a.userData.pivot.fonts.titles_font.font_size)+10,X=[],K=[];a.canvas.paper.setStart(),(0,n.c1)(o,a,e),a.userData.toolbar.show&&(l=40);for(var Z=a.userData.showRowTotals||void 0===a.userData.showRowTotals?a.userData.size.width:a.userData.size.width-Q,$=a.userData.showColTotals||void 0===a.userData.showColTotals?0:-1,ee=0;ee<p.length;ee++)de=[],(pe=[]).push(o.text(W-5,l+.5*Y+ee*Y,p[ee]).attr(N)),de.push(o.path(["M",W,l+(ee+1)*Y,"L",Z+5,l+(ee+1)*Y].join(",")).attr(L)),X.push(pe);for(pe=[],de=[],z=0,_=C.length;z<_;z++)S=C[z],pe.push(o.text(5+J[z],l+.5*Y+Y*p.length,S).attr(O));de.push(o.path(["M",0,l+Y*p.length,"L",Z+5,l+Y*p.length].join(",")).attr(R)),de.push(o.path(["M",0,l+Y*(p.length+1),"L",Z+5,l+Y*(p.length+1)].join(",")).attr(R)),a.userData.showRowTotals||void 0===a.userData.showRowTotals?(pe.push(o.text(5+W+Q*f.length,l+.5*Y+Y*p.length,"total").attr(I)),X.push(pe)):(pe.push(o.text(5+W+Q*f.length,l+.5*Y+Y*p.length,"").attr(I)),X.push(pe)),K.push(de);var te=l+Y*(p.length+1);for(g=0,v=A.length;g<v;g++){pe=[],de=[],ue=!0;var ae=Y;for(y=0,w=(T=A[g]).length;y<w;y++){D=T[y];var ne=X[X.length-1][y].attr("text");if(ue&&ne===D.toString().replace(/(\r\n|\n|\r)/gm,""))ue=!0,ie=D.toString().replace(/(\r\n|\n|\r)/gm,""),(oe=o.text(-1e4,-1e4,ie).attr(j).getBBox()).width>u&&(re=.95*u/(oe.width/ie.length),ie=i.wrapTextChar(ie,re),(oe=o.text(-1e4,-1e4,ie).attr(O).getBBox()).height>ae&&(ae=oe.height)),pe.push(o.text(5+J[y],.5*ae+te,ie).attr(j)),X[X.length-1][y].attr();else{ue=!1;var oe,ie=D.toString().replace(/(\r\n|\n|\r)/gm,"");if((oe=o.text(-1e4,-1e4,ie).attr(O).getBBox()).width>u){var re=.95*u/(oe.width/ie.length);ie=i.wrapTextChar(ie,re),(oe=o.text(-1e4,-1e4,ie).attr(O).getBBox()).height>ae&&(ae=oe.height)}pe.push(o.text(5+J[y],.5*ae+te,ie).attr(O)),Z=a.userData.showRowTotals||void 0===a.userData.showRowTotals?a.userData.size.width:a.userData.size.width-Q,de.push(o.path(["M",J[y],te,"L",Z,te].join(",")).attr(1===T.length||y>=1?L:F))}}for(k=0,x=f.length;k<x;k++)if(h=f[k],null!=(d=e.getAggregator(T,h)).value()){var se=s(g,k,B,U);pe.push(o.text(Q/2+W+Q*k,.5*ae+te,d.format(d.value())).attr(se||P))}else pe.push(o.text(Q/2+W+Q*k,.5*ae+te,"").attr(P));a.userData.showRowTotals||void 0===a.userData.showRowTotals?(d=e.getAggregator(T,[]),pe.push(o.text(5+W+Q*f.length,.5*ae+te,d.format(d.value())).attr(I)),X.push(pe),K.push(de)):(d=e.getAggregator(T,[]),pe.push(o.text(5+W+Q*f.length,.5*ae+te,"").attr(I)),X.push(pe),K.push(de)),te+=ae}if(pe=[],1===f.length&&0===f[0].length)pe.push(o.text(W+5,l+.5*Y+ee*Y,e.aggregatorName).attr(O));else for(var le=0;le<f.length;le++){var ce=[];de=[];var ue=!0;for(m=0,b=(h=f[le]).length;m<b;m++)D=h[m],ue&&X[X.length-1][m].attr("text")===D?(ue=!0,ce.push(o.text(5+W+Q*le,l+.5*Y+m*Y,D).attr(j))):(ue=!1,ce.push(o.text(5+W+Q*le,l+.5*Y+m*Y,D).attr(O)),de.push(o.path(["M",W+Q*le,l+m*Y,"L",W+Q*le,l+Y*($+g+2+p.length)].join(",")).attr(1===h.length||m>=1?L:F)));X.push(ce),K.push(de)}de.push(o.path(["M",W+Q*f.length,l,"L",W+Q*f.length,te+Y+Y*$+5].join(",")).attr(R)),de.push(o.path(["M",W,l,"L",W,te+Y+Y*$+5].join(",")).attr(R));var de=[];de.push(o.path(["M",0,te,"L",Z+5,te].join(",")).attr(R));var pe=[];if(a.userData.showColTotals||void 0===a.userData.showColTotals)for(pe.push(o.text(W-5,te+.5*Y,"total").attr(M)),k=0;k<f.length;k++)h=f[k],d=e.getAggregator([],h),pe.push(o.text(Q/2+W+Q*k,te+.5*Y,d.format(d.value())).attr(E));(a.userData.showRowTotals&&a.userData.showColTotals||void 0===a.userData.showRowTotals&&void 0===a.userData.showColTotals)&&(d=e.getAggregator([],[]),pe.push(o.text(5+W+Q*k,te+.5*Y,d.format(d.value())).attr(I)),X.push(pe)),K.push(de);var he=a.canvas.paper.setFinish();return a.setNewData(he),ie="Pivot Ra Power"}}},"object"===("undefined"==typeof exports?"undefined":r(exports))&&"object"===r(e)?t(a("a45670b3d8fb79ec0258")):"function"==typeof define&&a.amdO?define(["jquery"],t):t(o)}).call(void 0)},bf3a7adf03eb92c1e626:(e,t,a)=>{var n,o,i;!function(){"use strict";o=[a("a45670b3d8fb79ec0258")],n=function(e){e.ui=e.ui||{},e.ui.version="1.13.2";var t,a=0,n=Array.prototype.hasOwnProperty,o=Array.prototype.slice;e.cleanData=(t=e.cleanData,function(a){var n,o,i;for(i=0;null!=(o=a[i]);i++)(n=e._data(o,"events"))&&n.remove&&e(o).triggerHandler("remove");t(a)}),e.widget=function(t,a,n){var o,i,r,s={},l=t.split(".")[0],c=l+"-"+(t=t.split(".")[1]);return n||(n=a,a=e.Widget),Array.isArray(n)&&(n=e.extend.apply(null,[{}].concat(n))),e.expr.pseudos[c.toLowerCase()]=function(t){return!!e.data(t,c)},e[l]=e[l]||{},o=e[l][t],i=e[l][t]=function(e,t){if(!this||!this._createWidget)return new i(e,t);arguments.length&&this._createWidget(e,t)},e.extend(i,o,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),(r=new a).options=e.widget.extend({},r.options),e.each(n,(function(e,t){s[e]="function"==typeof t?function(){function n(){return a.prototype[e].apply(this,arguments)}function o(t){return a.prototype[e].apply(this,t)}return function(){var e,a=this._super,i=this._superApply;return this._super=n,this._superApply=o,e=t.apply(this,arguments),this._super=a,this._superApply=i,e}}():t})),i.prototype=e.widget.extend(r,{widgetEventPrefix:o&&r.widgetEventPrefix||t},s,{constructor:i,namespace:l,widgetName:t,widgetFullName:c}),o?(e.each(o._childConstructors,(function(t,a){var n=a.prototype;e.widget(n.namespace+"."+n.widgetName,i,a._proto)})),delete o._childConstructors):a._childConstructors.push(i),e.widget.bridge(t,i),i},e.widget.extend=function(t){for(var a,i,r=o.call(arguments,1),s=0,l=r.length;s<l;s++)for(a in r[s])i=r[s][a],n.call(r[s],a)&&void 0!==i&&(e.isPlainObject(i)?t[a]=e.isPlainObject(t[a])?e.widget.extend({},t[a],i):e.widget.extend({},i):t[a]=i);return t},e.widget.bridge=function(t,a){var n=a.prototype.widgetFullName||t;e.fn[t]=function(i){var r="string"==typeof i,s=o.call(arguments,1),l=this;return r?this.length||"instance"!==i?this.each((function(){var a,o=e.data(this,n);return"instance"===i?(l=o,!1):o?"function"!=typeof o[i]||"_"===i.charAt(0)?e.error("no such method '"+i+"' for "+t+" widget instance"):(a=o[i].apply(o,s))!==o&&void 0!==a?(l=a&&a.jquery?l.pushStack(a.get()):a,!1):void 0:e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+i+"'")})):l=void 0:(s.length&&(i=e.widget.extend.apply(null,[i].concat(s))),this.each((function(){var t=e.data(this,n);t?(t.option(i||{}),t._init&&t._init()):e.data(this,n,new a(i,this))}))),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=a++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=e(),this.hoverable=e(),this.focusable=e(),this.classesElementLookup={},n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){var t=this;this._destroy(),e.each(this.classesElementLookup,(function(e,a){t._removeClass(a,e)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:e.noop,widget:function(){return this.element},option:function(t,a){var n,o,i,r=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(r={},n=t.split("."),t=n.shift(),n.length){for(o=r[t]=e.widget.extend({},this.options[t]),i=0;i<n.length-1;i++)o[n[i]]=o[n[i]]||{},o=o[n[i]];if(t=n.pop(),1===arguments.length)return void 0===o[t]?null:o[t];o[t]=a}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];r[t]=a}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return"classes"===e&&this._setOptionClasses(t),this.options[e]=t,"disabled"===e&&this._setOptionDisabled(t),this},_setOptionClasses:function(t){var a,n,o;for(a in t)o=this.classesElementLookup[a],t[a]!==this.options.classes[a]&&o&&o.length&&(n=e(o.get()),this._removeClass(o,a),n.addClass(this._classes({element:n,keys:a,classes:t,add:!0})))},_setOptionDisabled:function(e){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!e),e&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(t){var a=[],n=this;function o(){var a=[];t.element.each((function(t,o){e.map(n.classesElementLookup,(function(e){return e})).some((function(e){return e.is(o)}))||a.push(o)})),n._on(e(a),{remove:"_untrackClassesElement"})}function i(i,r){var s,l;for(l=0;l<i.length;l++)s=n.classesElementLookup[i[l]]||e(),t.add?(o(),s=e(e.uniqueSort(s.get().concat(t.element.get())))):s=e(s.not(t.element).get()),n.classesElementLookup[i[l]]=s,a.push(i[l]),r&&t.classes[i[l]]&&a.push(t.classes[i[l]])}return(t=e.extend({element:this.element,classes:this.options.classes||{}},t)).keys&&i(t.keys.match(/\S+/g)||[],!0),t.extra&&i(t.extra.match(/\S+/g)||[]),a.join(" ")},_untrackClassesElement:function(t){var a=this;e.each(a.classesElementLookup,(function(n,o){-1!==e.inArray(t.target,o)&&(a.classesElementLookup[n]=e(o.not(t.target).get()))})),this._off(e(t.target))},_removeClass:function(e,t,a){return this._toggleClass(e,t,a,!1)},_addClass:function(e,t,a){return this._toggleClass(e,t,a,!0)},_toggleClass:function(e,t,a,n){n="boolean"==typeof n?n:a;var o="string"==typeof e||null===e,i={extra:o?t:a,keys:o?e:t,element:o?this.element:e,add:n};return i.element.toggleClass(this._classes(i),n),this},_on:function(t,a,n){var o,i=this;"boolean"!=typeof t&&(n=a,a=t,t=!1),n?(a=o=e(a),this.bindings=this.bindings.add(a)):(n=a,a=this.element,o=this.widget()),e.each(n,(function(n,r){function s(){if(t||!0!==i.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof r?i[r]:r).apply(i,arguments)}"string"!=typeof r&&(s.guid=r.guid=r.guid||s.guid||e.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+i.eventNamespace,u=l[2];u?o.on(c,u,s):a.on(c,s)}))},_off:function(t,a){a=(a||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(a),this.bindings=e(this.bindings.not(t).get()),this.focusable=e(this.focusable.not(t).get()),this.hoverable=e(this.hoverable.not(t).get())},_delay:function(e,t){var a=this;return setTimeout((function(){return("string"==typeof e?a[e]:e).apply(a,arguments)}),t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(e(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(e(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(e(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,a,n){var o,i,r=this.options[t];if(n=n||{},(a=e.Event(a)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),a.target=this.element[0],i=a.originalEvent)for(o in i)o in a||(a[o]=i[o]);return this.element.trigger(a,n),!("function"==typeof r&&!1===r.apply(this.element[0],[a].concat(n))||a.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},(function(t,a){e.Widget.prototype["_"+t]=function(n,o,i){var r;"string"==typeof o&&(o={effect:o});var s=o?!0===o||"number"==typeof o?a:o.effect||a:t;"number"==typeof(o=o||{})?o={duration:o}:!0===o&&(o={}),r=!e.isEmptyObject(o),o.complete=i,o.delay&&n.delay(o.delay),r&&e.effects&&e.effects.effect[s]?n[t](o):s!==t&&n[s]?n[s](o.duration,o.easing,i):n.queue((function(a){e(this)[t](),i&&i.call(n[0]),a()}))}})),e.widget,function(){var t,a=Math.max,n=Math.abs,o=/left|center|right/,i=/top|center|bottom/,r=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,l=/%$/,c=e.fn.position;function u(e,t,a){return[parseFloat(e[0])*(l.test(e[0])?t/100:1),parseFloat(e[1])*(l.test(e[1])?a/100:1)]}function d(t,a){return parseInt(e.css(t,a),10)||0}function p(e){return null!=e&&e===e.window}e.position={scrollbarWidth:function(){if(void 0!==t)return t;var a,n,o=e("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>"),i=o.children()[0];return e("body").append(o),a=i.offsetWidth,o.css("overflow","scroll"),a===(n=i.offsetWidth)&&(n=o[0].clientWidth),o.remove(),t=a-n},getScrollInfo:function(t){var a=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),n=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),o="scroll"===a||"auto"===a&&t.width<t.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight?e.position.scrollbarWidth():0,height:o?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var a=e(t||window),n=p(a[0]),o=!!a[0]&&9===a[0].nodeType;return{element:a,isWindow:n,isDocument:o,offset:n||o?{left:0,top:0}:e(t).offset(),scrollLeft:a.scrollLeft(),scrollTop:a.scrollTop(),width:a.outerWidth(),height:a.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return c.apply(this,arguments);var l,h,f,m,g,y,_,b,v="string"==typeof(t=e.extend({},t)).of?e(document).find(t.of):e(t.of),w=e.position.getWithinInfo(t.within),x=e.position.getScrollInfo(w),k=(t.collision||"flip").split(" "),D={};return y=9===(b=(_=v)[0]).nodeType?{width:_.width(),height:_.height(),offset:{top:0,left:0}}:p(b)?{width:_.width(),height:_.height(),offset:{top:_.scrollTop(),left:_.scrollLeft()}}:b.preventDefault?{width:0,height:0,offset:{top:b.pageY,left:b.pageX}}:{width:_.outerWidth(),height:_.outerHeight(),offset:_.offset()},v[0].preventDefault&&(t.at="left top"),h=y.width,f=y.height,m=y.offset,g=e.extend({},m),e.each(["my","at"],(function(){var e,a,n=(t[this]||"").split(" ");1===n.length&&(n=o.test(n[0])?n.concat(["center"]):i.test(n[0])?["center"].concat(n):["center","center"]),n[0]=o.test(n[0])?n[0]:"center",n[1]=i.test(n[1])?n[1]:"center",e=r.exec(n[0]),a=r.exec(n[1]),D[this]=[e?e[0]:0,a?a[0]:0],t[this]=[s.exec(n[0])[0],s.exec(n[1])[0]]})),1===k.length&&(k[1]=k[0]),"right"===t.at[0]?g.left+=h:"center"===t.at[0]&&(g.left+=h/2),"bottom"===t.at[1]?g.top+=f:"center"===t.at[1]&&(g.top+=f/2),l=u(D.at,h,f),g.left+=l[0],g.top+=l[1],this.each((function(){var o,i,r=e(this),s=r.outerWidth(),c=r.outerHeight(),p=d(this,"marginLeft"),y=d(this,"marginTop"),_=s+p+d(this,"marginRight")+x.width,b=c+y+d(this,"marginBottom")+x.height,S=e.extend({},g),C=u(D.my,r.outerWidth(),r.outerHeight());"right"===t.my[0]?S.left-=s:"center"===t.my[0]&&(S.left-=s/2),"bottom"===t.my[1]?S.top-=c:"center"===t.my[1]&&(S.top-=c/2),S.left+=C[0],S.top+=C[1],o={marginLeft:p,marginTop:y},e.each(["left","top"],(function(a,n){e.ui.position[k[a]]&&e.ui.position[k[a]][n](S,{targetWidth:h,targetHeight:f,elemWidth:s,elemHeight:c,collisionPosition:o,collisionWidth:_,collisionHeight:b,offset:[l[0]+C[0],l[1]+C[1]],my:t.my,at:t.at,within:w,elem:r})})),t.using&&(i=function(e){var o=m.left-S.left,i=o+h-s,l=m.top-S.top,u=l+f-c,d={target:{element:v,left:m.left,top:m.top,width:h,height:f},element:{element:r,left:S.left,top:S.top,width:s,height:c},horizontal:i<0?"left":o>0?"right":"center",vertical:u<0?"top":l>0?"bottom":"middle"};h<s&&n(o+i)<h&&(d.horizontal="center"),f<c&&n(l+u)<f&&(d.vertical="middle"),a(n(o),n(i))>a(n(l),n(u))?d.important="horizontal":d.important="vertical",t.using.call(this,e,d)}),r.offset(e.extend(S,{using:i}))}))},e.ui.position={fit:{left:function(e,t){var n,o=t.within,i=o.isWindow?o.scrollLeft:o.offset.left,r=o.width,s=e.left-t.collisionPosition.marginLeft,l=i-s,c=s+t.collisionWidth-r-i;t.collisionWidth>r?l>0&&c<=0?(n=e.left+l+t.collisionWidth-r-i,e.left+=l-n):e.left=c>0&&l<=0?i:l>c?i+r-t.collisionWidth:i:l>0?e.left+=l:c>0?e.left-=c:e.left=a(e.left-s,e.left)},top:function(e,t){var n,o=t.within,i=o.isWindow?o.scrollTop:o.offset.top,r=t.within.height,s=e.top-t.collisionPosition.marginTop,l=i-s,c=s+t.collisionHeight-r-i;t.collisionHeight>r?l>0&&c<=0?(n=e.top+l+t.collisionHeight-r-i,e.top+=l-n):e.top=c>0&&l<=0?i:l>c?i+r-t.collisionHeight:i:l>0?e.top+=l:c>0?e.top-=c:e.top=a(e.top-s,e.top)}},flip:{left:function(e,t){var a,o,i=t.within,r=i.offset.left+i.scrollLeft,s=i.width,l=i.isWindow?i.scrollLeft:i.offset.left,c=e.left-t.collisionPosition.marginLeft,u=c-l,d=c+t.collisionWidth-s-l,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,h="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,f=-2*t.offset[0];u<0?((a=e.left+p+h+f+t.collisionWidth-s-r)<0||a<n(u))&&(e.left+=p+h+f):d>0&&((o=e.left-t.collisionPosition.marginLeft+p+h+f-l)>0||n(o)<d)&&(e.left+=p+h+f)},top:function(e,t){var a,o,i=t.within,r=i.offset.top+i.scrollTop,s=i.height,l=i.isWindow?i.scrollTop:i.offset.top,c=e.top-t.collisionPosition.marginTop,u=c-l,d=c+t.collisionHeight-s-l,p="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,h="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,f=-2*t.offset[1];u<0?((o=e.top+p+h+f+t.collisionHeight-s-r)<0||o<n(u))&&(e.top+=p+h+f):d>0&&((a=e.top-t.collisionPosition.marginTop+p+h+f-l)>0||n(a)<d)&&(e.top+=p+h+f)}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}}}(),e.ui.position,e.extend(e.expr.pseudos,{data:e.expr.createPseudo?e.expr.createPseudo((function(t){return function(a){return!!e.data(a,t)}})):function(t,a,n){return!!e.data(t,n[3])}}),e.fn.extend({disableSelection:(r="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(r+".ui-disableSelection",(function(e){e.preventDefault()}))}),enableSelection:function(){return this.off(".ui-disableSelection")}});var i,r,s=e,l={},c=l.toString,u=/^([\-+])=\s*(\d+\.?\d*)/,d=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),e[4]?(parseInt(e[4],16)/255).toFixed(2):1]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),e[4]?(parseInt(e[4]+e[4],16)/255).toFixed(2):1]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1],e[2]/100,e[3]/100,e[4]]}}],p=s.Color=function(e,t,a,n){return new s.Color.fn.parse(e,t,a,n)},h={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},f={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},m=p.support={},g=s("<p>")[0],y=s.each;function _(e){return null==e?e+"":"object"==typeof e?l[c.call(e)]||"object":typeof e}function b(e,t,a){var n=f[t.type]||{};return null==e?a||!t.def?null:t.def:(e=n.floor?~~e:parseFloat(e),isNaN(e)?t.def:n.mod?(e+n.mod)%n.mod:Math.min(n.max,Math.max(0,e)))}function v(e){var t=p(),a=t._rgba=[];return e=e.toLowerCase(),y(d,(function(n,o){var i,r=o.re.exec(e),s=r&&o.parse(r),l=o.space||"rgba";if(s)return i=t[l](s),t[h[l].cache]=i[h[l].cache],a=t._rgba=i._rgba,!1})),a.length?("0,0,0,0"===a.join()&&s.extend(a,i.transparent),t):i[e]}function w(e,t,a){return 6*(a=(a+1)%1)<1?e+(t-e)*a*6:2*a<1?t:3*a<2?e+(t-e)*(2/3-a)*6:e}g.style.cssText="background-color:rgba(1,1,1,.5)",m.rgba=g.style.backgroundColor.indexOf("rgba")>-1,y(h,(function(e,t){t.cache="_"+e,t.props.alpha={idx:3,type:"percent",def:1}})),s.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(e,t){l["[object "+t+"]"]=t.toLowerCase()})),p.fn=s.extend(p.prototype,{parse:function(e,t,a,n){if(void 0===e)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=s(e).css(t),t=void 0);var o=this,r=_(e),l=this._rgba=[];return void 0!==t&&(e=[e,t,a,n],r="array"),"string"===r?this.parse(v(e)||i._default):"array"===r?(y(h.rgba.props,(function(t,a){l[a.idx]=b(e[a.idx],a)})),this):"object"===r?(y(h,e instanceof p?function(t,a){e[a.cache]&&(o[a.cache]=e[a.cache].slice())}:function(t,a){var n=a.cache;y(a.props,(function(t,i){if(!o[n]&&a.to){if("alpha"===t||null==e[t])return;o[n]=a.to(o._rgba)}o[n][i.idx]=b(e[t],i,!0)})),o[n]&&s.inArray(null,o[n].slice(0,3))<0&&(null==o[n][3]&&(o[n][3]=1),a.from&&(o._rgba=a.from(o[n])))}),this):void 0},is:function(e){var t=p(e),a=!0,n=this;return y(h,(function(e,o){var i,r=t[o.cache];return r&&(i=n[o.cache]||o.to&&o.to(n._rgba)||[],y(o.props,(function(e,t){if(null!=r[t.idx])return a=r[t.idx]===i[t.idx]}))),a})),a},_space:function(){var e=[],t=this;return y(h,(function(a,n){t[n.cache]&&e.push(a)})),e.pop()},transition:function(e,t){var a=p(e),n=a._space(),o=h[n],i=0===this.alpha()?p("transparent"):this,r=i[o.cache]||o.to(i._rgba),s=r.slice();return a=a[o.cache],y(o.props,(function(e,n){var o=n.idx,i=r[o],l=a[o],c=f[n.type]||{};null!==l&&(null===i?s[o]=l:(c.mod&&(l-i>c.mod/2?i+=c.mod:i-l>c.mod/2&&(i-=c.mod)),s[o]=b((l-i)*t+i,n)))})),this[n](s)},blend:function(e){if(1===this._rgba[3])return this;var t=this._rgba.slice(),a=t.pop(),n=p(e)._rgba;return p(s.map(t,(function(e,t){return(1-a)*n[t]+a*e})))},toRgbaString:function(){var e="rgba(",t=s.map(this._rgba,(function(e,t){return null!=e?e:t>2?1:0}));return 1===t[3]&&(t.pop(),e="rgb("),e+t.join()+")"},toHslaString:function(){var e="hsla(",t=s.map(this.hsla(),(function(e,t){return null==e&&(e=t>2?1:0),t&&t<3&&(e=Math.round(100*e)+"%"),e}));return 1===t[3]&&(t.pop(),e="hsl("),e+t.join()+")"},toHexString:function(e){var t=this._rgba.slice(),a=t.pop();return e&&t.push(~~(255*a)),"#"+s.map(t,(function(e){return 1===(e=(e||0).toString(16)).length?"0"+e:e})).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),p.fn.parse.prototype=p.fn,h.hsla.to=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t,a,n=e[0]/255,o=e[1]/255,i=e[2]/255,r=e[3],s=Math.max(n,o,i),l=Math.min(n,o,i),c=s-l,u=s+l,d=.5*u;return t=l===s?0:n===s?60*(o-i)/c+360:o===s?60*(i-n)/c+120:60*(n-o)/c+240,a=0===c?0:d<=.5?c/u:c/(2-u),[Math.round(t)%360,a,d,null==r?1:r]},h.hsla.from=function(e){if(null==e[0]||null==e[1]||null==e[2])return[null,null,null,e[3]];var t=e[0]/360,a=e[1],n=e[2],o=e[3],i=n<=.5?n*(1+a):n+a-n*a,r=2*n-i;return[Math.round(255*w(r,i,t+1/3)),Math.round(255*w(r,i,t)),Math.round(255*w(r,i,t-1/3)),o]},y(h,(function(e,t){var a=t.props,n=t.cache,o=t.to,i=t.from;p.fn[e]=function(e){if(o&&!this[n]&&(this[n]=o(this._rgba)),void 0===e)return this[n].slice();var t,r=_(e),s="array"===r||"object"===r?e:arguments,l=this[n].slice();return y(a,(function(e,t){var a=s["object"===r?e:t.idx];null==a&&(a=l[t.idx]),l[t.idx]=b(a,t)})),i?((t=p(i(l)))[n]=l,t):p(l)},y(a,(function(t,a){p.fn[t]||(p.fn[t]=function(n){var o,i,r,s,l=_(n);return i=(o=this[s="alpha"===t?this._hsla?"hsla":"rgba":e]())[a.idx],"undefined"===l?i:("function"===l&&(l=_(n=n.call(this,i))),null==n&&a.empty?this:("string"===l&&(r=u.exec(n))&&(n=i+parseFloat(r[2])*("+"===r[1]?1:-1)),o[a.idx]=n,this[s](o)))})}))})),p.hook=function(e){var t=e.split(" ");y(t,(function(e,t){s.cssHooks[t]={set:function(e,a){var n,o,i="";if("transparent"!==a&&("string"!==_(a)||(n=v(a)))){if(a=p(n||a),!m.rgba&&1!==a._rgba[3]){for(o="backgroundColor"===t?e.parentNode:e;(""===i||"transparent"===i)&&o&&o.style;)try{i=s.css(o,"backgroundColor"),o=o.parentNode}catch(e){}a=a.blend(i&&"transparent"!==i?i:"_default")}a=a.toRgbaString()}try{e.style[t]=a}catch(e){}}},s.fx.step[t]=function(e){e.colorInit||(e.start=p(e.elem,t),e.end=p(e.end),e.colorInit=!0),s.cssHooks[t].set(e.elem,e.start.transition(e.end,e.pos))}}))},p.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),s.cssHooks.borderColor={expand:function(e){var t={};return y(["Top","Right","Bottom","Left"],(function(a,n){t["border"+n+"Color"]=e})),t}},i=s.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};var x,k,D="ui-effects-",S="ui-effects-style",C="ui-effects-animated";if(e.effects={effect:{}},function(){var t=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function n(e){var t,a,n,o=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,i={};if(o&&o.length&&o[0]&&o[o[0]])for(a=o.length;a--;)"string"==typeof o[t=o[a]]&&(i[(n=t,n.replace(/-([\da-z])/gi,(function(e,t){return t.toUpperCase()})))]=o[t]);else for(t in o)"string"==typeof o[t]&&(i[t]=o[t]);return i}e.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],(function(t,a){e.fx.step[a]=function(e){("none"!==e.end&&!e.setAttr||1===e.pos&&!e.setAttr)&&(s.style(e.elem,a,e.end),e.setAttr=!0)}})),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e.effects.animateClass=function(o,i,r,s){var l=e.speed(i,r,s);return this.queue((function(){var i,r=e(this),s=r.attr("class")||"",c=l.children?r.find("*").addBack():r;c=c.map((function(){return{el:e(this),start:n(this)}})),(i=function(){e.each(t,(function(e,t){o[t]&&r[t+"Class"](o[t])}))})(),c=c.map((function(){return this.end=n(this.el[0]),this.diff=function(t,n){var o,i,r={};for(o in n)i=n[o],t[o]!==i&&(a[o]||!e.fx.step[o]&&isNaN(parseFloat(i))||(r[o]=i));return r}(this.start,this.end),this})),r.attr("class",s),c=c.map((function(){var t=this,a=e.Deferred(),n=e.extend({},l,{queue:!1,complete:function(){a.resolve(t)}});return this.el.animate(this.diff,n),a.promise()})),e.when.apply(e,c.get()).done((function(){i(),e.each(arguments,(function(){var t=this.el;e.each(this.diff,(function(e){t.css(e,"")}))})),l.complete.call(r[0])}))}))},e.fn.extend({addClass:function(t){return function(a,n,o,i){return n?e.effects.animateClass.call(this,{add:a},n,o,i):t.apply(this,arguments)}}(e.fn.addClass),removeClass:function(t){return function(a,n,o,i){return arguments.length>1?e.effects.animateClass.call(this,{remove:a},n,o,i):t.apply(this,arguments)}}(e.fn.removeClass),toggleClass:function(t){return function(a,n,o,i,r){return"boolean"==typeof n||void 0===n?o?e.effects.animateClass.call(this,n?{add:a}:{remove:a},o,i,r):t.apply(this,arguments):e.effects.animateClass.call(this,{toggle:a},n,o,i)}}(e.fn.toggleClass),switchClass:function(t,a,n,o,i){return e.effects.animateClass.call(this,{add:a,remove:t},n,o,i)}})}(),function(){function t(t,a,n,o){return e.isPlainObject(t)&&(a=t,t=t.effect),t={effect:t},null==a&&(a={}),"function"==typeof a&&(o=a,n=null,a={}),("number"==typeof a||e.fx.speeds[a])&&(o=n,n=a,a={}),"function"==typeof n&&(o=n,n=null),a&&e.extend(t,a),n=n||a.duration,t.duration=e.fx.off?0:"number"==typeof n?n:n in e.fx.speeds?e.fx.speeds[n]:e.fx.speeds._default,t.complete=o||a.complete,t}function a(t){return!(t&&"number"!=typeof t&&!e.fx.speeds[t])||"string"==typeof t&&!e.effects.effect[t]||"function"==typeof t||"object"==typeof t&&!t.effect}function n(e,t){var a=t.outerWidth(),n=t.outerHeight(),o=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(e)||["",0,a,n,0];return{top:parseFloat(o[1])||0,right:"auto"===o[2]?a:parseFloat(o[2]),bottom:"auto"===o[3]?n:parseFloat(o[3]),left:parseFloat(o[4])||0}}e.expr&&e.expr.pseudos&&e.expr.pseudos.animated&&(e.expr.pseudos.animated=function(t){return function(a){return!!e(a).data(C)||t(a)}}(e.expr.pseudos.animated)),!1!==e.uiBackCompat&&e.extend(e.effects,{save:function(e,t){for(var a=0,n=t.length;a<n;a++)null!==t[a]&&e.data(D+t[a],e[0].style[t[a]])},restore:function(e,t){for(var a,n=0,o=t.length;n<o;n++)null!==t[n]&&(a=e.data(D+t[n]),e.css(t[n],a))},setMode:function(e,t){return"toggle"===t&&(t=e.is(":hidden")?"show":"hide"),t},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var a={width:t.outerWidth(!0),height:t.outerHeight(!0),float:t.css("float")},n=e("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),o={width:t.width(),height:t.height()},i=document.activeElement;try{i.id}catch(e){i=document.body}return t.wrap(n),(t[0]===i||e.contains(t[0],i))&&e(i).trigger("focus"),n=t.parent(),"static"===t.css("position")?(n.css({position:"relative"}),t.css({position:"relative"})):(e.extend(a,{position:t.css("position"),zIndex:t.css("z-index")}),e.each(["top","left","bottom","right"],(function(e,n){a[n]=t.css(n),isNaN(parseInt(a[n],10))&&(a[n]="auto")})),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(o),n.css(a).show()},removeWrapper:function(t){var a=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===a||e.contains(t[0],a))&&e(a).trigger("focus")),t}}),e.extend(e.effects,{version:"1.13.2",define:function(t,a,n){return n||(n=a,a="effect"),e.effects.effect[t]=n,e.effects.effect[t].mode=a,n},scaledDimensions:function(e,t,a){if(0===t)return{height:0,width:0,outerHeight:0,outerWidth:0};var n="horizontal"!==a?(t||100)/100:1,o="vertical"!==a?(t||100)/100:1;return{height:e.height()*o,width:e.width()*n,outerHeight:e.outerHeight()*o,outerWidth:e.outerWidth()*n}},clipToBox:function(e){return{width:e.clip.right-e.clip.left,height:e.clip.bottom-e.clip.top,left:e.clip.left,top:e.clip.top}},unshift:function(e,t,a){var n=e.queue();t>1&&n.splice.apply(n,[1,0].concat(n.splice(t,a))),e.dequeue()},saveStyle:function(e){e.data(S,e[0].style.cssText)},restoreStyle:function(e){e[0].style.cssText=e.data(S)||"",e.removeData(S)},mode:function(e,t){var a=e.is(":hidden");return"toggle"===t&&(t=a?"show":"hide"),(a?"hide"===t:"show"===t)&&(t="none"),t},getBaseline:function(e,t){var a,n;switch(e[0]){case"top":a=0;break;case"middle":a=.5;break;case"bottom":a=1;break;default:a=e[0]/t.height}switch(e[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=e[1]/t.width}return{x:n,y:a}},createPlaceholder:function(t){var a,n=t.css("position"),o=t.position();return t.css({marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()),/^(static|relative)/.test(n)&&(n="absolute",a=e("<"+t[0].nodeName+">").insertAfter(t).css({display:/^(inline|ruby)/.test(t.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight"),float:t.css("float")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).addClass("ui-effects-placeholder"),t.data(D+"placeholder",a)),t.css({position:n,left:o.left,top:o.top}),a},removePlaceholder:function(e){var t=D+"placeholder",a=e.data(t);a&&(a.remove(),e.removeData(t))},cleanUp:function(t){e.effects.restoreStyle(t),e.effects.removePlaceholder(t)},setTransition:function(t,a,n,o){return o=o||{},e.each(a,(function(e,a){var i=t.cssUnit(a);i[0]>0&&(o[a]=i[0]*n+i[1])})),o}}),e.fn.extend({effect:function(){var a=t.apply(this,arguments),n=e.effects.effect[a.effect],o=n.mode,i=a.queue,r=i||"fx",s=a.complete,l=a.mode,c=[],u=function(t){var a=e(this),n=e.effects.mode(a,l)||o;a.data(C,!0),c.push(n),o&&("show"===n||n===o&&"hide"===n)&&a.show(),o&&"none"===n||e.effects.saveStyle(a),"function"==typeof t&&t()};if(e.fx.off||!n)return l?this[l](a.duration,s):this.each((function(){s&&s.call(this)}));function d(t){var i=e(this);function r(){"function"==typeof s&&s.call(i[0]),"function"==typeof t&&t()}a.mode=c.shift(),!1===e.uiBackCompat||o?"none"===a.mode?(i[l](),r()):n.call(i[0],a,(function(){i.removeData(C),e.effects.cleanUp(i),"hide"===a.mode&&i.hide(),r()})):(i.is(":hidden")?"hide"===l:"show"===l)?(i[l](),r()):n.call(i[0],a,r)}return!1===i?this.each(u).each(d):this.queue(r,u).queue(r,d)},show:function(e){return function(n){if(a(n))return e.apply(this,arguments);var o=t.apply(this,arguments);return o.mode="show",this.effect.call(this,o)}}(e.fn.show),hide:function(e){return function(n){if(a(n))return e.apply(this,arguments);var o=t.apply(this,arguments);return o.mode="hide",this.effect.call(this,o)}}(e.fn.hide),toggle:function(e){return function(n){if(a(n)||"boolean"==typeof n)return e.apply(this,arguments);var o=t.apply(this,arguments);return o.mode="toggle",this.effect.call(this,o)}}(e.fn.toggle),cssUnit:function(t){var a=this.css(t),n=[];return e.each(["em","px","%","pt"],(function(e,t){a.indexOf(t)>0&&(n=[parseFloat(a),t])})),n},cssClip:function(e){return e?this.css("clip","rect("+e.top+"px "+e.right+"px "+e.bottom+"px "+e.left+"px)"):n(this.css("clip"),this)},transfer:function(t,a){var n=e(this),o=e(t.to),i="fixed"===o.css("position"),r=e("body"),s=i?r.scrollTop():0,l=i?r.scrollLeft():0,c=o.offset(),u={top:c.top-s,left:c.left-l,height:o.innerHeight(),width:o.innerWidth()},d=n.offset(),p=e("<div class='ui-effects-transfer'></div>");p.appendTo("body").addClass(t.className).css({top:d.top-s,left:d.left-l,height:n.innerHeight(),width:n.innerWidth(),position:i?"fixed":"absolute"}).animate(u,t.duration,t.easing,(function(){p.remove(),"function"==typeof a&&a()}))}}),e.fx.step.clip=function(t){t.clipInit||(t.start=e(t.elem).cssClip(),"string"==typeof t.end&&(t.end=n(t.end,t.elem)),t.clipInit=!0),e(t.elem).cssClip({top:t.pos*(t.end.top-t.start.top)+t.start.top,right:t.pos*(t.end.right-t.start.right)+t.start.right,bottom:t.pos*(t.end.bottom-t.start.bottom)+t.start.bottom,left:t.pos*(t.end.left-t.start.left)+t.start.left})}}(),x={},e.each(["Quad","Cubic","Quart","Quint","Expo"],(function(e,t){x[t]=function(t){return Math.pow(t,e+2)}})),e.extend(x,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)},Circ:function(e){return 1-Math.sqrt(1-e*e)},Elastic:function(e){return 0===e||1===e?e:-Math.pow(2,8*(e-1))*Math.sin((80*(e-1)-7.5)*Math.PI/15)},Back:function(e){return e*e*(3*e-2)},Bounce:function(e){for(var t,a=4;e<((t=Math.pow(2,--a))-1)/11;);return 1/Math.pow(4,3-a)-7.5625*Math.pow((3*t-2)/22-e,2)}}),e.each(x,(function(t,a){e.easing["easeIn"+t]=a,e.easing["easeOut"+t]=function(e){return 1-a(1-e)},e.easing["easeInOut"+t]=function(e){return e<.5?a(2*e)/2:1-a(-2*e+2)/2}})),e.effects,e.effects.define("blind","hide",(function(t,a){var n={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},o=e(this),i=t.direction||"up",r=o.cssClip(),s={clip:e.extend({},r)},l=e.effects.createPlaceholder(o);s.clip[n[i][0]]=s.clip[n[i][1]],"show"===t.mode&&(o.cssClip(s.clip),l&&l.css(e.effects.clipToBox(s)),s.clip=r),l&&l.animate(e.effects.clipToBox(s),t.duration,t.easing),o.animate(s,{queue:!1,duration:t.duration,easing:t.easing,complete:a})})),e.effects.define("bounce",(function(t,a){var n,o,i,r=e(this),s=t.mode,l="hide"===s,c="show"===s,u=t.direction||"up",d=t.distance,p=t.times||5,h=2*p+(c||l?1:0),f=t.duration/h,m=t.easing,g="up"===u||"down"===u?"top":"left",y="up"===u||"left"===u,_=0,b=r.queue().length;for(e.effects.createPlaceholder(r),i=r.css(g),d||(d=r["top"===g?"outerHeight":"outerWidth"]()/3),c&&((o={opacity:1})[g]=i,r.css("opacity",0).css(g,y?2*-d:2*d).animate(o,f,m)),l&&(d/=Math.pow(2,p-1)),(o={})[g]=i;_<p;_++)(n={})[g]=(y?"-=":"+=")+d,r.animate(n,f,m).animate(o,f,m),d=l?2*d:d/2;l&&((n={opacity:0})[g]=(y?"-=":"+=")+d,r.animate(n,f,m)),r.queue(a),e.effects.unshift(r,b,h+1)})),e.effects.define("clip","hide",(function(t,a){var n,o={},i=e(this),r=t.direction||"vertical",s="both"===r,l=s||"horizontal"===r,c=s||"vertical"===r;n=i.cssClip(),o.clip={top:c?(n.bottom-n.top)/2:n.top,right:l?(n.right-n.left)/2:n.right,bottom:c?(n.bottom-n.top)/2:n.bottom,left:l?(n.right-n.left)/2:n.left},e.effects.createPlaceholder(i),"show"===t.mode&&(i.cssClip(o.clip),o.clip=n),i.animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:a})})),e.effects.define("drop","hide",(function(t,a){var n,o=e(this),i="show"===t.mode,r=t.direction||"left",s="up"===r||"down"===r?"top":"left",l="up"===r||"left"===r?"-=":"+=",c="+="===l?"-=":"+=",u={opacity:0};e.effects.createPlaceholder(o),n=t.distance||o["top"===s?"outerHeight":"outerWidth"](!0)/2,u[s]=l+n,i&&(o.css(u),u[s]=c+n,u.opacity=1),o.animate(u,{queue:!1,duration:t.duration,easing:t.easing,complete:a})})),e.effects.define("explode","hide",(function(t,a){var n,o,i,r,s,l,c=t.pieces?Math.round(Math.sqrt(t.pieces)):3,u=c,d=e(this),p="show"===t.mode,h=d.show().css("visibility","hidden").offset(),f=Math.ceil(d.outerWidth()/u),m=Math.ceil(d.outerHeight()/c),g=[];function y(){g.push(this),g.length===c*u&&(d.css({visibility:"visible"}),e(g).remove(),a())}for(n=0;n<c;n++)for(r=h.top+n*m,l=n-(c-1)/2,o=0;o<u;o++)i=h.left+o*f,s=o-(u-1)/2,d.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-o*f,top:-n*m}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:f,height:m,left:i+(p?s*f:0),top:r+(p?l*m:0),opacity:p?0:1}).animate({left:i+(p?0:s*f),top:r+(p?0:l*m),opacity:p?1:0},t.duration||500,t.easing,y)})),e.effects.define("fade","toggle",(function(t,a){var n="show"===t.mode;e(this).css("opacity",n?0:1).animate({opacity:n?1:0},{queue:!1,duration:t.duration,easing:t.easing,complete:a})})),e.effects.define("fold","hide",(function(t,a){var n=e(this),o=t.mode,i="show"===o,r="hide"===o,s=t.size||15,l=/([0-9]+)%/.exec(s),c=t.horizFirst?["right","bottom"]:["bottom","right"],u=t.duration/2,d=e.effects.createPlaceholder(n),p=n.cssClip(),h={clip:e.extend({},p)},f={clip:e.extend({},p)},m=[p[c[0]],p[c[1]]],g=n.queue().length;l&&(s=parseInt(l[1],10)/100*m[r?0:1]),h.clip[c[0]]=s,f.clip[c[0]]=s,f.clip[c[1]]=0,i&&(n.cssClip(f.clip),d&&d.css(e.effects.clipToBox(f)),f.clip=p),n.queue((function(a){d&&d.animate(e.effects.clipToBox(h),u,t.easing).animate(e.effects.clipToBox(f),u,t.easing),a()})).animate(h,u,t.easing).animate(f,u,t.easing).queue(a),e.effects.unshift(n,g,4)})),e.effects.define("highlight","show",(function(t,a){var n=e(this),o={backgroundColor:n.css("backgroundColor")};"hide"===t.mode&&(o.opacity=0),e.effects.saveStyle(n),n.css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(o,{queue:!1,duration:t.duration,easing:t.easing,complete:a})})),e.effects.define("size",(function(t,a){var n,o,i,r=e(this),s=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],c=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],u=t.mode,d="effect"!==u,p=t.scale||"both",h=t.origin||["middle","center"],f=r.css("position"),m=r.position(),g=e.effects.scaledDimensions(r),y=t.from||g,_=t.to||e.effects.scaledDimensions(r,0);e.effects.createPlaceholder(r),"show"===u&&(i=y,y=_,_=i),o={from:{y:y.height/g.height,x:y.width/g.width},to:{y:_.height/g.height,x:_.width/g.width}},"box"!==p&&"both"!==p||(o.from.y!==o.to.y&&(y=e.effects.setTransition(r,l,o.from.y,y),_=e.effects.setTransition(r,l,o.to.y,_)),o.from.x!==o.to.x&&(y=e.effects.setTransition(r,c,o.from.x,y),_=e.effects.setTransition(r,c,o.to.x,_))),"content"!==p&&"both"!==p||o.from.y!==o.to.y&&(y=e.effects.setTransition(r,s,o.from.y,y),_=e.effects.setTransition(r,s,o.to.y,_)),h&&(n=e.effects.getBaseline(h,g),y.top=(g.outerHeight-y.outerHeight)*n.y+m.top,y.left=(g.outerWidth-y.outerWidth)*n.x+m.left,_.top=(g.outerHeight-_.outerHeight)*n.y+m.top,_.left=(g.outerWidth-_.outerWidth)*n.x+m.left),delete y.outerHeight,delete y.outerWidth,r.css(y),"content"!==p&&"both"!==p||(l=l.concat(["marginTop","marginBottom"]).concat(s),c=c.concat(["marginLeft","marginRight"]),r.find("*[width]").each((function(){var a=e(this),n=e.effects.scaledDimensions(a),i={height:n.height*o.from.y,width:n.width*o.from.x,outerHeight:n.outerHeight*o.from.y,outerWidth:n.outerWidth*o.from.x},r={height:n.height*o.to.y,width:n.width*o.to.x,outerHeight:n.height*o.to.y,outerWidth:n.width*o.to.x};o.from.y!==o.to.y&&(i=e.effects.setTransition(a,l,o.from.y,i),r=e.effects.setTransition(a,l,o.to.y,r)),o.from.x!==o.to.x&&(i=e.effects.setTransition(a,c,o.from.x,i),r=e.effects.setTransition(a,c,o.to.x,r)),d&&e.effects.saveStyle(a),a.css(i),a.animate(r,t.duration,t.easing,(function(){d&&e.effects.restoreStyle(a)}))}))),r.animate(_,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){var t=r.offset();0===_.opacity&&r.css("opacity",y.opacity),d||(r.css("position","static"===f?"relative":f).offset(t),e.effects.saveStyle(r)),a()}})})),e.effects.define("scale",(function(t,a){var n=e(this),o=t.mode,i=parseInt(t.percent,10)||(0===parseInt(t.percent,10)||"effect"!==o?0:100),r=e.extend(!0,{from:e.effects.scaledDimensions(n),to:e.effects.scaledDimensions(n,i,t.direction||"both"),origin:t.origin||["middle","center"]},t);t.fade&&(r.from.opacity=1,r.to.opacity=0),e.effects.effect.size.call(this,r,a)})),e.effects.define("puff","hide",(function(t,a){var n=e.extend(!0,{},t,{fade:!0,percent:parseInt(t.percent,10)||150});e.effects.effect.scale.call(this,n,a)})),e.effects.define("pulsate","show",(function(t,a){var n=e(this),o=t.mode,i="show"===o,r=i||"hide"===o,s=2*(t.times||5)+(r?1:0),l=t.duration/s,c=0,u=1,d=n.queue().length;for(!i&&n.is(":visible")||(n.css("opacity",0).show(),c=1);u<s;u++)n.animate({opacity:c},l,t.easing),c=1-c;n.animate({opacity:c},l,t.easing),n.queue(a),e.effects.unshift(n,d,s+1)})),e.effects.define("shake",(function(t,a){var n=1,o=e(this),i=t.direction||"left",r=t.distance||20,s=t.times||3,l=2*s+1,c=Math.round(t.duration/l),u="up"===i||"down"===i?"top":"left",d="up"===i||"left"===i,p={},h={},f={},m=o.queue().length;for(e.effects.createPlaceholder(o),p[u]=(d?"-=":"+=")+r,h[u]=(d?"+=":"-=")+2*r,f[u]=(d?"-=":"+=")+2*r,o.animate(p,c,t.easing);n<s;n++)o.animate(h,c,t.easing).animate(f,c,t.easing);o.animate(h,c,t.easing).animate(p,c/2,t.easing).queue(a),e.effects.unshift(o,m,l+1)})),e.effects.define("slide","show",(function(t,a){var n,o,i=e(this),r={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},s=t.mode,l=t.direction||"left",c="up"===l||"down"===l?"top":"left",u="up"===l||"left"===l,d=t.distance||i["top"===c?"outerHeight":"outerWidth"](!0),p={};e.effects.createPlaceholder(i),n=i.cssClip(),o=i.position()[c],p[c]=(u?-1:1)*d+o,p.clip=i.cssClip(),p.clip[r[l][1]]=p.clip[r[l][0]],"show"===s&&(i.cssClip(p.clip),i.css(c,p[c]),p.clip=n,p[c]=o),i.animate(p,{queue:!1,duration:t.duration,easing:t.easing,complete:a})})),!1!==e.uiBackCompat&&e.effects.define("transfer",(function(t,a){e(this).transfer(t,a)})),e.ui.focusable=function(t,a){var n,o,i,r,s,l=t.nodeName.toLowerCase();return"area"===l?(o=(n=t.parentNode).name,!(!t.href||!o||"map"!==n.nodeName.toLowerCase())&&(i=e("img[usemap='#"+o+"']")).length>0&&i.is(":visible")):(/^(input|select|textarea|button|object)$/.test(l)?(r=!t.disabled)&&(s=e(t).closest("fieldset")[0])&&(r=!s.disabled):r="a"===l&&t.href||a,r&&e(t).is(":visible")&&function(e){for(var t=e.css("visibility");"inherit"===t;)t=(e=e.parent()).css("visibility");return"visible"===t}(e(t)))},e.extend(e.expr.pseudos,{focusable:function(t){return e.ui.focusable(t,null!=e.attr(t,"tabindex"))}}),e.ui.focusable,e.fn._form=function(){return"string"==typeof this[0].form?this.closest("form"):e(this[0].form)},e.ui.formResetMixin={_formResetHandler:function(){var t=e(this);setTimeout((function(){var a=t.data("ui-form-reset-instances");e.each(a,(function(){this.refresh()}))}))},_bindFormResetHandler:function(){if(this.form=this.element._form(),this.form.length){var e=this.form.data("ui-form-reset-instances")||[];e.length||this.form.on("reset.ui-form-reset",this._formResetHandler),e.push(this),this.form.data("ui-form-reset-instances",e)}},_unbindFormResetHandler:function(){if(this.form.length){var t=this.form.data("ui-form-reset-instances");t.splice(e.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}},e.expr.pseudos||(e.expr.pseudos=e.expr[":"]),e.uniqueSort||(e.uniqueSort=e.unique),!e.escapeSelector){var T=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,A=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e};e.escapeSelector=function(e){return(e+"").replace(T,A)}}e.fn.even&&e.fn.odd||e.fn.extend({even:function(){return this.filter((function(e){return e%2==0}))},odd:function(){return this.filter((function(e){return e%2==1}))}}),e.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},e.fn.labels=function(){var t,a,n,o,i;return this.length?this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(o=this.eq(0).parents("label"),(n=this.attr("id"))&&(i=(t=this.eq(0).parents().last()).add(t.length?t.siblings():this.siblings()),a="label[for='"+e.escapeSelector(n)+"']",o=o.add(i.find(a).addBack(a))),this.pushStack(o)):this.pushStack([])},e.fn.scrollParent=function(t){var a=this.css("position"),n="absolute"===a,o=t?/(auto|scroll|hidden)/:/(auto|scroll)/,i=this.parents().filter((function(){var t=e(this);return(!n||"static"!==t.css("position"))&&o.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))})).eq(0);return"fixed"!==a&&i.length?i:e(this[0].ownerDocument||document)},e.extend(e.expr.pseudos,{tabbable:function(t){var a=e.attr(t,"tabindex"),n=null!=a;return(!n||a>=0)&&e.ui.focusable(t,n)}}),e.fn.extend({uniqueId:(k=0,function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++k)}))}),removeUniqueId:function(){return this.each((function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")}))}}),e.widget("ui.accordion",{version:"1.13.2",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:function(e){return e.find("> li > :first-child").add(e.find("> :not(li)").even())},heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=e(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),t.collapsible||!1!==t.active&&null!=t.active||(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():e()}},_createIcons:function(){var t,a,n=this.options.icons;n&&(t=e("<span>"),this._addClass(t,"ui-accordion-header-icon","ui-icon "+n.header),t.prependTo(this.headers),a=this.active.children(".ui-accordion-header-icon"),this._removeClass(a,n.header)._addClass(a,null,n.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var e;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),e=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&e.css("height","")},_setOption:function(e,t){"active"!==e?("event"===e&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t)),this._super(e,t),"collapsible"!==e||t||!1!==this.options.active||this._activate(0),"icons"===e&&(this._destroyIcons(),t&&this._createIcons())):this._activate(t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e),this._toggleClass(null,"ui-state-disabled",!!e),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!e)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var a=e.ui.keyCode,n=this.headers.length,o=this.headers.index(t.target),i=!1;switch(t.keyCode){case a.RIGHT:case a.DOWN:i=this.headers[(o+1)%n];break;case a.LEFT:case a.UP:i=this.headers[(o-1+n)%n];break;case a.SPACE:case a.ENTER:this._eventHandler(t);break;case a.HOME:i=this.headers[0];break;case a.END:i=this.headers[n-1]}i&&(e(t.target).attr("tabIndex",-1),e(i).attr("tabIndex",0),e(i).trigger("focus"),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===e.ui.keyCode.UP&&t.ctrlKey&&e(t.currentTarget).prev().trigger("focus")},refresh:function(){var t=this.options;this._processPanels(),!1===t.active&&!0===t.collapsible||!this.headers.length?(t.active=!1,this.active=e()):!1===t.active?this._activate(0):this.active.length&&!e.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=e()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var e=this.headers,t=this.panels;"function"==typeof this.options.header?this.headers=this.options.header(this.element):this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),t&&(this._off(e.not(this.headers)),this._off(t.not(this.panels)))},_refresh:function(){var t,a=this.options,n=a.heightStyle,o=this.element.parent();this.active=this._findActive(a.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each((function(){var t=e(this),a=t.uniqueId().attr("id"),n=t.next(),o=n.uniqueId().attr("id");t.attr("aria-controls",o),n.attr("aria-labelledby",a)})).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(a.event),"fill"===n?(t=o.height(),this.element.siblings(":visible").each((function(){var a=e(this),n=a.css("position");"absolute"!==n&&"fixed"!==n&&(t-=a.outerHeight(!0))})),this.headers.each((function(){t-=e(this).outerHeight(!0)})),this.headers.next().each((function(){e(this).height(Math.max(0,t-e(this).innerHeight()+e(this).height()))})).css("overflow","auto")):"auto"===n&&(t=0,this.headers.next().each((function(){var a=e(this).is(":visible");a||e(this).show(),t=Math.max(t,e(this).css("height","").height()),a||e(this).hide()})).height(t))},_activate:function(t){var a=this._findActive(t)[0];a!==this.active[0]&&(a=a||this.active[0],this._eventHandler({target:a,currentTarget:a,preventDefault:e.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):e()},_setupEvents:function(t){var a={keydown:"_keydown"};t&&e.each(t.split(" "),(function(e,t){a[t]="_eventHandler"})),this._off(this.headers.add(this.headers.next())),this._on(this.headers,a),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var a,n,o=this.options,i=this.active,r=e(t.currentTarget),s=r[0]===i[0],l=s&&o.collapsible,c=l?e():r.next(),u=i.next(),d={oldHeader:i,oldPanel:u,newHeader:l?e():r,newPanel:c};t.preventDefault(),s&&!o.collapsible||!1===this._trigger("beforeActivate",t,d)||(o.active=!l&&this.headers.index(r),this.active=s?e():r,this._toggle(d),this._removeClass(i,"ui-accordion-header-active","ui-state-active"),o.icons&&(a=i.children(".ui-accordion-header-icon"),this._removeClass(a,null,o.icons.activeHeader)._addClass(a,null,o.icons.header)),s||(this._removeClass(r,"ui-accordion-header-collapsed")._addClass(r,"ui-accordion-header-active","ui-state-active"),o.icons&&(n=r.children(".ui-accordion-header-icon"),this._removeClass(n,null,o.icons.header)._addClass(n,null,o.icons.activeHeader)),this._addClass(r.next(),"ui-accordion-content-active")))},_toggle:function(t){var a=t.newPanel,n=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=a,this.prevHide=n,this.options.animate?this._animate(a,n,t):(n.hide(),a.show(),this._toggleComplete(t)),n.attr({"aria-hidden":"true"}),n.prev().attr({"aria-selected":"false","aria-expanded":"false"}),a.length&&n.length?n.prev().attr({tabIndex:-1,"aria-expanded":"false"}):a.length&&this.headers.filter((function(){return 0===parseInt(e(this).attr("tabIndex"),10)})).attr("tabIndex",-1),a.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(e,t,a){var n,o,i,r=this,s=0,l=e.css("box-sizing"),c=e.length&&(!t.length||e.index()<t.index()),u=this.options.animate||{},d=c&&u.down||u,p=function(){r._toggleComplete(a)};return"number"==typeof d&&(i=d),"string"==typeof d&&(o=d),o=o||d.easing||u.easing,i=i||d.duration||u.duration,t.length?e.length?(n=e.show().outerHeight(),t.animate(this.hideProps,{duration:i,easing:o,step:function(e,t){t.now=Math.round(e)}}),void e.hide().animate(this.showProps,{duration:i,easing:o,complete:p,step:function(e,a){a.now=Math.round(e),"height"!==a.prop?"content-box"===l&&(s+=a.now):"content"!==r.options.heightStyle&&(a.now=Math.round(n-t.outerHeight()-s),s=0)}})):t.animate(this.hideProps,i,o,p):e.animate(this.showProps,i,o,p)},_toggleComplete:function(e){var t=e.oldPanel,a=t.prev();this._removeClass(t,"ui-accordion-content-active"),this._removeClass(a,"ui-accordion-header-active")._addClass(a,"ui-accordion-header-collapsed"),t.length&&(t.parent()[0].className=t.parent()[0].className),this._trigger("activate",null,e)}}),e.ui.safeActiveElement=function(e){var t;try{t=e.activeElement}catch(a){t=e.body}return t||(t=e.body),t.nodeName||(t=e.body),t},e.widget("ui.menu",{version:"1.13.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.lastMousePosition={x:null,y:null},this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(e){e.preventDefault(),this._activateItem(e)},"click .ui-menu-item":function(t){var a=e(t.target),n=e(e.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&a.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),a.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&n.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(e,t){var a=this.active||this._menuItems().first();t||this.focus(e,a)},blur:function(t){this._delay((function(){!e.contains(this.element[0],e.ui.safeActiveElement(this.document[0]))&&this.collapseAll(t)}))},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){this._closeOnDocumentClick(e)&&this.collapseAll(e,!0),this.mouseHandled=!1}})},_activateItem:function(t){if(!this.previousFilter&&(t.clientX!==this.lastMousePosition.x||t.clientY!==this.lastMousePosition.y)){this.lastMousePosition={x:t.clientX,y:t.clientY};var a=e(t.target).closest(".ui-menu-item"),n=e(t.currentTarget);a[0]===n[0]&&(n.is(".ui-state-active")||(this._removeClass(n.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(t,n)))}},_destroy:function(){var t=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),t.children().each((function(){var t=e(this);t.data("ui-menu-submenu-caret")&&t.remove()}))},_keydown:function(t){var a,n,o,i,r=!0;switch(t.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(t);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case e.ui.keyCode.HOME:this._move("first","first",t);break;case e.ui.keyCode.END:this._move("last","last",t);break;case e.ui.keyCode.UP:this.previous(t);break;case e.ui.keyCode.DOWN:this.next(t);break;case e.ui.keyCode.LEFT:this.collapse(t);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(t);break;case e.ui.keyCode.ESCAPE:this.collapse(t);break;default:r=!1,n=this.previousFilter||"",i=!1,o=t.keyCode>=96&&t.keyCode<=105?(t.keyCode-96).toString():String.fromCharCode(t.keyCode),clearTimeout(this.filterTimer),o===n?i=!0:o=n+o,a=this._filterMenuItems(o),(a=i&&-1!==a.index(this.active.next())?this.active.nextAll(".ui-menu-item"):a).length||(o=String.fromCharCode(t.keyCode),a=this._filterMenuItems(o)),a.length?(this.focus(t,a),this.previousFilter=o,this.filterTimer=this._delay((function(){delete this.previousFilter}),1e3)):delete this.previousFilter}r&&t.preventDefault()},_activate:function(e){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(e):this.select(e))},refresh:function(){var t,a,n,o,i=this,r=this.options.icons.submenu,s=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),a=s.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each((function(){var t=e(this),a=t.prev(),n=e("<span>").data("ui-menu-submenu-caret",!0);i._addClass(n,"ui-menu-icon","ui-icon "+r),a.attr("aria-haspopup","true").prepend(n),t.attr("aria-labelledby",a.attr("id"))})),this._addClass(a,"ui-menu","ui-widget ui-widget-content ui-front"),(t=s.add(this.element).find(this.options.items)).not(".ui-menu-item").each((function(){var t=e(this);i._isDivider(t)&&i._addClass(t,"ui-menu-divider","ui-widget-content")})),o=(n=t.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(n,"ui-menu-item")._addClass(o,"ui-menu-item-wrapper"),t.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(e,t){if("icons"===e){var a=this.element.find(".ui-menu-icon");this._removeClass(a,null,this.options.icons.submenu)._addClass(a,null,t.submenu)}this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",String(e)),this._toggleClass(null,"ui-state-disabled",!!e)},focus:function(e,t){var a,n,o;this.blur(e,e&&"focus"===e.type),this._scrollIntoView(t),this.active=t.first(),n=this.active.children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",n.attr("id")),o=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(o,null,"ui-state-active"),e&&"keydown"===e.type?this._close():this.timer=this._delay((function(){this._close()}),this.delay),(a=t.children(".ui-menu")).length&&e&&/^mouse/.test(e.type)&&this._startOpening(a),this.activeMenu=t.parent(),this._trigger("focus",e,{item:t})},_scrollIntoView:function(t){var a,n,o,i,r,s;this._hasScroll()&&(a=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,n=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,o=t.offset().top-this.activeMenu.offset().top-a-n,i=this.activeMenu.scrollTop(),r=this.activeMenu.height(),s=t.outerHeight(),o<0?this.activeMenu.scrollTop(i+o):o+s>r&&this.activeMenu.scrollTop(i+o-r+s))},blur:function(e,t){t||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",e,{item:this.active}),this.active=null)},_startOpening:function(e){clearTimeout(this.timer),"true"===e.attr("aria-hidden")&&(this.timer=this._delay((function(){this._close(),this._open(e)}),this.delay))},_open:function(t){var a=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(a)},collapseAll:function(t,a){clearTimeout(this.timer),this.timer=this._delay((function(){var n=a?this.element:e(t&&t.target).closest(this.element.find(".ui-menu"));n.length||(n=this.element),this._close(n),this.blur(t),this._removeClass(n.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=n}),a?0:this.delay)},_close:function(e){e||(e=this.active?this.active.parent():this.element),e.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(t){return!e(t.target).closest(".ui-menu").length},_isDivider:function(e){return!/[^\-\u2014\u2013\s]/.test(e.text())},collapse:function(e){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(e,t))},expand:function(e){var t=this.active&&this._menuItems(this.active.children(".ui-menu")).first();t&&t.length&&(this._open(t.parent()),this._delay((function(){this.focus(e,t)})))},next:function(e){this._move("next","first",e)},previous:function(e){this._move("prev","last",e)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(e){return(e||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(e,t,a){var n;this.active&&(n="first"===e||"last"===e?this.active["first"===e?"prevAll":"nextAll"](".ui-menu-item").last():this.active[e+"All"](".ui-menu-item").first()),n&&n.length&&this.active||(n=this._menuItems(this.activeMenu)[t]()),this.focus(a,n)},nextPage:function(t){var a,n,o;this.active?this.isLastItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.innerHeight(),0===e.fn.jquery.indexOf("3.2.")&&(o+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.nextAll(".ui-menu-item").each((function(){return(a=e(this)).offset().top-n-o<0})),this.focus(t,a)):this.focus(t,this._menuItems(this.activeMenu)[this.active?"last":"first"]())):this.next(t)},previousPage:function(t){var a,n,o;this.active?this.isFirstItem()||(this._hasScroll()?(n=this.active.offset().top,o=this.element.innerHeight(),0===e.fn.jquery.indexOf("3.2.")&&(o+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.prevAll(".ui-menu-item").each((function(){return(a=e(this)).offset().top-n+o>0})),this.focus(t,a)):this.focus(t,this._menuItems(this.activeMenu).first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||e(t.target).closest(".ui-menu-item");var a={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,a)},_filterMenuItems:function(t){var a=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),n=new RegExp("^"+a,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter((function(){return n.test(String.prototype.trim.call(e(this).children(".ui-menu-item-wrapper").text()))}))}}),e.widget("ui.autocomplete",{version:"1.13.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,liveRegionTimer:null,_create:function(){var t,a,n,o=this.element[0].nodeName.toLowerCase(),i="textarea"===o,r="input"===o;this.isMultiLine=i||!r&&this._isContentEditable(this.element),this.valueMethod=this.element[i||r?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(o){if(this.element.prop("readOnly"))return t=!0,n=!0,void(a=!0);t=!1,n=!1,a=!1;var i=e.ui.keyCode;switch(o.keyCode){case i.PAGE_UP:t=!0,this._move("previousPage",o);break;case i.PAGE_DOWN:t=!0,this._move("nextPage",o);break;case i.UP:t=!0,this._keyEvent("previous",o);break;case i.DOWN:t=!0,this._keyEvent("next",o);break;case i.ENTER:this.menu.active&&(t=!0,o.preventDefault(),this.menu.select(o));break;case i.TAB:this.menu.active&&this.menu.select(o);break;case i.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(o),o.preventDefault());break;default:a=!0,this._searchTimeout(o)}},keypress:function(n){if(t)return t=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||n.preventDefault());if(!a){var o=e.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:this._move("previousPage",n);break;case o.PAGE_DOWN:this._move("nextPage",n);break;case o.UP:this._keyEvent("previous",n);break;case o.DOWN:this._keyEvent("next",n)}}},input:function(e){if(n)return n=!1,void e.preventDefault();this._searchTimeout(e)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(e){clearTimeout(this.searching),this.close(e),this._change(e)}}),this._initSource(),this.menu=e("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().attr({unselectable:"on"}).menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault()},menufocus:function(t,a){var n,o;if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",(function(){e(t.target).trigger(t.originalEvent)}));o=a.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:o})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(o.value),(n=a.item.attr("aria-label")||o.value)&&String.prototype.trim.call(n).length&&(clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay((function(){this.liveRegion.html(e("<div>").text(n))}),100))},menuselect:function(t,a){var n=a.item.data("ui-autocomplete-item"),o=this.previous;this.element[0]!==e.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=o,this._delay((function(){this.previous=o,this.selectedItem=n}))),!1!==this._trigger("select",t,{item:n})&&this._value(n.value),this.term=this._value(),this.close(t),this.selectedItem=n}}),this.liveRegion=e("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(e,t){this._super(e,t),"source"===e&&this._initSource(),"appendTo"===e&&this.menu.element.appendTo(this._appendTo()),"disabled"===e&&t&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(t){var a=this.menu.element[0];return t.target===this.element[0]||t.target===a||e.contains(a,t.target)},_closeOnClickOutside:function(e){this._isEventTargetInWidget(e)||this.close()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_initSource:function(){var t,a,n=this;Array.isArray(this.options.source)?(t=this.options.source,this.source=function(a,n){n(e.ui.autocomplete.filter(t,a.term))}):"string"==typeof this.options.source?(a=this.options.source,this.source=function(t,o){n.xhr&&n.xhr.abort(),n.xhr=e.ajax({url:a,data:t,dataType:"json",success:function(e){o(e)},error:function(){o([])}})}):this.source=this.options.source},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay((function(){var t=this.term===this._value(),a=this.menu.element.is(":visible"),n=e.altKey||e.ctrlKey||e.metaKey||e.shiftKey;t&&(!t||a||n)||(this.selectedItem=null,this.search(null,e))}),this.options.delay)},search:function(e,t){return e=null!=e?e:this._value(),this.term=this._value(),e.length<this.options.minLength?this.close(t):!1!==this._trigger("search",t)?this._search(e):void 0},_search:function(e){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:e},this._response())},_response:function(){var e=++this.requestIndex;return function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")}.bind(this)},__response:function(e){e&&(e=this._normalize(e)),this._trigger("response",null,{content:e}),!this.options.disabled&&e&&e.length&&!this.cancelSearch?(this._suggest(e),this._trigger("open")):this._close()},close:function(e){this.cancelSearch=!0,this._close(e)},_close:function(e){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",e))},_change:function(e){this.previous!==this._value()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,(function(t){return"string"==typeof t?{label:t,value:t}:e.extend({},t,{label:t.label||t.value,value:t.value||t.label})}))},_suggest:function(t){var a=this.menu.element.empty();this._renderMenu(a,t),this.isNewMenu=!0,this.menu.refresh(),a.show(),this._resizeMenu(),a.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,a){var n=this;e.each(a,(function(e,a){n._renderItemData(t,a)}))},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-autocomplete-item",t)},_renderItem:function(t,a){return e("<li>").append(e("<div>").text(a.label)).appendTo(t)},_move:function(e,t){if(this.menu.element.is(":visible"))return this.menu.isFirstItem()&&/^previous/.test(e)||this.menu.isLastItem()&&/^next/.test(e)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[e](t);this.search(null,t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())},_isContentEditable:function(e){if(!e.length)return!1;var t=e.prop("contentEditable");return"inherit"===t?this._isContentEditable(e.parent()):"true"===t}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,a){var n=new RegExp(e.ui.autocomplete.escapeRegex(a),"i");return e.grep(t,(function(e){return n.test(e.label||e.value||e)}))}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(e){return e+(e>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var a;this._superApply(arguments),this.options.disabled||this.cancelSearch||(a=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay((function(){this.liveRegion.html(e("<div>").text(a))}),100))}}),e.ui.autocomplete;var P,E=/ui-corner-([a-z]){2,6}/g;function I(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:"",selectMonthLabel:"Select month",selectYearLabel:"Select year"},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,onUpdateDatepicker:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=N(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function N(t){var a="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.on("mouseout",a,(function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")})).on("mouseover",a,M)}function M(){e.datepicker._isDisabledDatepicker(P.inline?P.dpDiv.parent()[0]:P.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function O(t,a){for(var n in e.extend(t,a),a)null==a[n]&&(t[n]=a[n]);return t}e.widget("ui.controlgroup",{version:"1.13.2",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var t=this,a=[];e.each(this.options.items,(function(n,o){var i,r={};if(o)return"controlgroupLabel"===n?((i=t.element.find(o)).each((function(){var t=e(this);t.children(".ui-controlgroup-label-contents").length||t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")})),t._addClass(i,null,"ui-widget ui-widget-content ui-state-default"),void(a=a.concat(i.get()))):void(e.fn[n]&&(r=t["_"+n+"Options"]?t["_"+n+"Options"]("middle"):{classes:{}},t.element.find(o).each((function(){var o=e(this),i=o[n]("instance"),s=e.widget.extend({},r);if("button"!==n||!o.parent(".ui-spinner").length){i||(i=o[n]()[n]("instance")),i&&(s.classes=t._resolveClassesValues(s.classes,i)),o[n](s);var l=o[n]("widget");e.data(l[0],"ui-controlgroup-data",i||o[n]("instance")),a.push(l[0])}}))))})),this.childWidgets=e(e.uniqueSort(a)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(t){this.childWidgets.each((function(){var a=e(this).data("ui-controlgroup-data");a&&a[t]&&a[t]()}))},_updateCornerClass:function(e,t){var a=this._buildSimpleOptions(t,"label").classes.label;this._removeClass(e,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(e,null,a)},_buildSimpleOptions:function(e,t){var a="vertical"===this.options.direction,n={classes:{}};return n.classes[t]={middle:"",first:"ui-corner-"+(a?"top":"left"),last:"ui-corner-"+(a?"bottom":"right"),only:"ui-corner-all"}[e],n},_spinnerOptions:function(e){var t=this._buildSimpleOptions(e,"ui-spinner");return t.classes["ui-spinner-up"]="",t.classes["ui-spinner-down"]="",t},_buttonOptions:function(e){return this._buildSimpleOptions(e,"ui-button")},_checkboxradioOptions:function(e){return this._buildSimpleOptions(e,"ui-checkboxradio-label")},_selectmenuOptions:function(e){var t="vertical"===this.options.direction;return{width:!!t&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(t?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(t?"top":"left")},last:{"ui-selectmenu-button-open":t?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(t?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[e]}},_resolveClassesValues:function(t,a){var n={};return e.each(t,(function(e){var o=a.options.classes[e]||"";o=String.prototype.trim.call(o.replace(E,"")),n[e]=(o+" "+t[e]).replace(/\s+/g," ")})),n},_setOption:function(e,t){"direction"===e&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(e,t),"disabled"!==e?this.refresh():this._callChildMethod(t?"disable":"enable")},refresh:function(){var t,a=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),t=this.childWidgets,this.options.onlyVisible&&(t=t.filter(":visible")),t.length&&(e.each(["first","last"],(function(e,n){var o=t[n]().data("ui-controlgroup-data");if(o&&a["_"+o.widgetName+"Options"]){var i=a["_"+o.widgetName+"Options"](1===t.length?"only":n);i.classes=a._resolveClassesValues(i.classes,o),o.element[o.widgetName](i)}else a._updateCornerClass(t[n](),n)})),this._callChildMethod("refresh"))}}),e.widget("ui.checkboxradio",[e.ui.formResetMixin,{version:"1.13.2",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var t,a,n,o=this._super()||{};return this._readType(),a=this.element.labels(),this.label=e(a[a.length-1]),this.label.length||e.error("No label found for checkboxradio widget"),this.originalLabel="",(n=this.label.contents().not(this.element[0])).length&&(this.originalLabel+=n.clone().wrapAll("<div></div>").parent().html()),this.originalLabel&&(o.label=this.originalLabel),null!=(t=this.element[0].disabled)&&(o.disabled=t),o},_create:function(){var e=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),e&&this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var t=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===t&&/radio|checkbox/.test(this.type)||e.error("Can't create checkboxradio on element.nodeName="+t+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var t=this.element[0].name,a="input[name='"+e.escapeSelector(t)+"']";return t?(this.form.length?e(this.form[0].elements).filter(a):e(a).filter((function(){return 0===e(this)._form().length}))).not(this.element):e([])},_toggleClasses:function(){var t=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",t)._toggleClass(this.icon,null,"ui-icon-blank",!t),"radio"===this.type&&this._getRadioGroup().each((function(){var t=e(this).checkboxradio("instance");t&&t._removeClass(t.label,"ui-checkboxradio-checked","ui-state-active")}))},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(e,t){if("label"!==e||t){if(this._super(e,t),"disabled"===e)return this._toggleClass(this.label,null,"ui-state-disabled",t),void(this.element[0].disabled=t);this.refresh()}},_updateIcon:function(t){var a="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=e("<span>"),this.iconSpace=e("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(a+=t?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,t?"ui-icon-blank":"ui-icon-check")):a+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",a),t||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var e=this.label.contents().not(this.element[0]);this.icon&&(e=e.not(this.icon[0])),this.iconSpace&&(e=e.not(this.iconSpace[0])),e.remove(),this.label.append(this.options.label)},refresh:function(){var e=this.element[0].checked,t=this.element[0].disabled;this._updateIcon(e),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",e),null!==this.options.label&&this._updateLabel(),t!==this.options.disabled&&this._setOptions({disabled:t})}}]),e.ui.checkboxradio,e.widget("ui.button",{version:"1.13.2",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var e,t=this._super()||{};return this.isInput=this.element.is("input"),null!=(e=this.element[0].disabled)&&(t.disabled=e),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(t.label=this.originalLabel),t},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(t){t.keyCode===e.ui.keyCode.SPACE&&(t.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(t,a){var n="iconPosition"!==t,o=n?this.options.iconPosition:a,i="top"===o||"bottom"===o;this.icon?n&&this._removeClass(this.icon,null,this.options.icon):(this.icon=e("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),n&&this._addClass(this.icon,null,a),this._attachIcon(o),i?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=e("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(o))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(e){this.icon[/^(?:end|bottom)/.test(e)?"before":"after"](this.iconSpace)},_attachIcon:function(e){this.element[/^(?:end|bottom)/.test(e)?"append":"prepend"](this.icon)},_setOptions:function(e){var t=void 0===e.showLabel?this.options.showLabel:e.showLabel,a=void 0===e.icon?this.options.icon:e.icon;t||a||(e.showLabel=!0),this._super(e)},_setOption:function(e,t){"icon"===e&&(t?this._updateIcon(e,t):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===e&&this._updateIcon(e,t),"showLabel"===e&&(this._toggleClass("ui-button-icon-only",null,!t),this._updateTooltip()),"label"===e&&(this.isInput?this.element.val(t):(this.element.html(t),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(e,t),"disabled"===e&&(this._toggleClass(null,"ui-state-disabled",t),this.element[0].disabled=t,t&&this.element.trigger("blur"))},refresh:function(){var e=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOptions({disabled:e}),this._updateTooltip()}}),!1!==e.uiBackCompat&&(e.widget("ui.button",e.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(e,t){"text"!==e?("showLabel"===e&&(this.options.text=t),"icon"===e&&(this.options.icons.primary=t),"icons"===e&&(t.primary?(this._super("icon",t.primary),this._super("iconPosition","beginning")):t.secondary&&(this._super("icon",t.secondary),this._super("iconPosition","end"))),this._superApply(arguments)):this._super("showLabel",t)}}),e.fn.button=function(t){return function(a){var n="string"==typeof a,o=Array.prototype.slice.call(arguments,1),i=this;return n?this.length||"instance"!==a?this.each((function(){var t,n=e(this).attr("type"),r="checkbox"!==n&&"radio"!==n?"button":"checkboxradio",s=e.data(this,"ui-"+r);return"instance"===a?(i=s,!1):s?"function"!=typeof s[a]||"_"===a.charAt(0)?e.error("no such method '"+a+"' for button widget instance"):(t=s[a].apply(s,o))!==s&&void 0!==t?(i=t&&t.jquery?i.pushStack(t.get()):t,!1):void 0:e.error("cannot call methods on button prior to initialization; attempted to call method '"+a+"'")})):i=void 0:(o.length&&(a=e.widget.extend.apply(null,[a].concat(o))),this.each((function(){var n=e(this).attr("type"),o="checkbox"!==n&&"radio"!==n?"button":"checkboxradio",i=e.data(this,"ui-"+o);if(i)i.option(a||{}),i._init&&i._init();else{if("button"===o)return void t.call(e(this),a);e(this).checkboxradio(e.extend({icon:!1},a))}}))),i}}(e.fn.button),e.fn.buttonset=function(){return e.ui.controlgroup||e.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),e.ui.button,e.extend(e.ui,{datepicker:{version:"1.13.2"}}),e.extend(I.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return O(this._defaults,e||{}),this},_attachDatepicker:function(t,a){var n,o,i;o="div"===(n=t.nodeName.toLowerCase())||"span"===n,t.id||(this.uuid+=1,t.id="dp"+this.uuid),(i=this._newInst(e(t),o)).settings=e.extend({},a||{}),"input"===n?this._connectDatepicker(t,i):o&&this._inlineDatepicker(t,i)},_newInst:function(t,a){return{id:t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:a,dpDiv:a?N(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,a){var n=e(t);a.append=e([]),a.trigger=e([]),n.hasClass(this.markerClassName)||(this._attachments(n,a),n.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(a),e.data(t,"datepicker",a),a.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,a){var n,o,i,r=this._get(a,"appendText"),s=this._get(a,"isRTL");a.append&&a.append.remove(),r&&(a.append=e("<span>").addClass(this._appendClass).text(r),t[s?"before":"after"](a.append)),t.off("focus",this._showDatepicker),a.trigger&&a.trigger.remove(),"focus"!==(n=this._get(a,"showOn"))&&"both"!==n||t.on("focus",this._showDatepicker),"button"!==n&&"both"!==n||(o=this._get(a,"buttonText"),i=this._get(a,"buttonImage"),this._get(a,"buttonImageOnly")?a.trigger=e("<img>").addClass(this._triggerClass).attr({src:i,alt:o,title:o}):(a.trigger=e("<button type='button'>").addClass(this._triggerClass),i?a.trigger.html(e("<img>").attr({src:i,alt:o,title:o})):a.trigger.text(o)),t[s?"before":"after"](a.trigger),a.trigger.on("click",(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1})))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,a,n,o,i=new Date(2009,11,20),r=this._get(e,"dateFormat");r.match(/[DM]/)&&(t=function(e){for(a=0,n=0,o=0;o<e.length;o++)e[o].length>a&&(a=e[o].length,n=o);return n},i.setMonth(t(this._get(e,r.match(/MM/)?"monthNames":"monthNamesShort"))),i.setDate(t(this._get(e,r.match(/DD/)?"dayNames":"dayNamesShort"))+20-i.getDay())),e.input.attr("size",this._formatDate(e,i).length)}},_inlineDatepicker:function(t,a){var n=e(t);n.hasClass(this.markerClassName)||(n.addClass(this.markerClassName).append(a.dpDiv),e.data(t,"datepicker",a),this._setDate(a,this._getDefaultDate(a),!0),this._updateDatepicker(a),this._updateAlternate(a),a.settings.disabled&&this._disableDatepicker(t),a.dpDiv.css("display","block"))},_dialogDatepicker:function(t,a,n,o,i){var r,s,l,c,u,d=this._dialogInst;return d||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),e("body").append(this._dialogInput),(d=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},e.data(this._dialogInput[0],"datepicker",d)),O(d.settings,o||{}),a=a&&a.constructor===Date?this._formatDate(d,a):a,this._dialogInput.val(a),this._pos=i?i.length?i:[i.pageX,i.pageY]:null,this._pos||(s=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,u=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[s/2-100+c,l/2-150+u]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),d.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",d),this},_destroyDatepicker:function(t){var a,n=e(t),o=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(a=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===a?(o.append.remove(),o.trigger.remove(),n.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==a&&"span"!==a||n.removeClass(this.markerClassName).empty(),P===o&&(P=null,this._curInst=null))},_enableDatepicker:function(t){var a,n,o=e(t),i=e.data(t,"datepicker");o.hasClass(this.markerClassName)&&("input"===(a=t.nodeName.toLowerCase())?(t.disabled=!1,i.trigger.filter("button").each((function(){this.disabled=!1})).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==a&&"span"!==a||((n=o.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,(function(e){return e===t?null:e})))},_disableDatepicker:function(t){var a,n,o=e(t),i=e.data(t,"datepicker");o.hasClass(this.markerClassName)&&("input"===(a=t.nodeName.toLowerCase())?(t.disabled=!0,i.trigger.filter("button").each((function(){this.disabled=!0})).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==a&&"span"!==a||((n=o.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),n.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,(function(e){return e===t?null:e})),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(e){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,a,n){var o,i,r,s,l=this._getInst(t);if(2===arguments.length&&"string"==typeof a)return"defaults"===a?e.extend({},e.datepicker._defaults):l?"all"===a?e.extend({},l.settings):this._get(l,a):null;o=a||{},"string"==typeof a&&((o={})[a]=n),l&&(this._curInst===l&&this._hideDatepicker(),i=this._getDateDatepicker(t,!0),r=this._getMinMaxDate(l,"min"),s=this._getMinMaxDate(l,"max"),O(l.settings,o),null!==r&&void 0!==o.dateFormat&&void 0===o.minDate&&(l.settings.minDate=this._formatDate(l,r)),null!==s&&void 0!==o.dateFormat&&void 0===o.maxDate&&(l.settings.maxDate=this._formatDate(l,s)),"disabled"in o&&(o.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),l),this._autoSize(l),this._setDate(l,i),this._updateAlternate(l),this._updateDatepicker(l))},_changeDatepicker:function(e,t,a){this._optionDatepicker(e,t,a)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var a=this._getInst(e);a&&(this._setDate(a,t),this._updateDatepicker(a),this._updateAlternate(a))},_getDateDatepicker:function(e,t){var a=this._getInst(e);return a&&!a.inline&&this._setDateFromField(a,t),a?this._getDate(a):null},_doKeyDown:function(t){var a,n,o,i=e.datepicker._getInst(t.target),r=!0,s=i.dpDiv.is(".ui-datepicker-rtl");if(i._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),r=!1;break;case 13:return(o=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",i.dpDiv))[0]&&e.datepicker._selectDay(t.target,i.selectedMonth,i.selectedYear,o[0]),(a=e.datepicker._get(i,"onSelect"))?(n=e.datepicker._formatDate(i),a.apply(i.input?i.input[0]:null,[n,i])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(i,"stepBigMonths"):-e.datepicker._get(i,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(i,"stepBigMonths"):+e.datepicker._get(i,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),r=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),r=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?1:-1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(i,"stepBigMonths"):-e.datepicker._get(i,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),r=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,s?-1:1,"D"),r=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(i,"stepBigMonths"):+e.datepicker._get(i,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),r=t.ctrlKey||t.metaKey;break;default:r=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):r=!1;r&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var a,n,o=e.datepicker._getInst(t.target);if(e.datepicker._get(o,"constrainInput"))return a=e.datepicker._possibleChars(e.datepicker._get(o,"dateFormat")),n=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||n<" "||!a||a.indexOf(n)>-1},_doKeyUp:function(t){var a=e.datepicker._getInst(t.target);if(a.input.val()!==a.lastVal)try{e.datepicker.parseDate(e.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,e.datepicker._getFormatConfig(a))&&(e.datepicker._setDateFromField(a),e.datepicker._updateAlternate(a),e.datepicker._updateDatepicker(a))}catch(e){}return!0},_showDatepicker:function(t){var a,n,o,i,r,s,l;"input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),e.datepicker._isDisabledDatepicker(t)||e.datepicker._lastInput===t||(a=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==a&&(e.datepicker._curInst.dpDiv.stop(!0,!0),a&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),!1!==(o=(n=e.datepicker._get(a,"beforeShow"))?n.apply(t,[t,a]):{})&&(O(a.settings,o),a.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(a),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),i=!1,e(t).parents().each((function(){return!(i|="fixed"===e(this).css("position"))})),r={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,a.dpDiv.empty(),a.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(a),r=e.datepicker._checkOffset(a,r,i),a.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":i?"fixed":"absolute",display:"none",left:r.left+"px",top:r.top+"px"}),a.inline||(s=e.datepicker._get(a,"showAnim"),l=e.datepicker._get(a,"duration"),a.dpDiv.css("z-index",function(e){for(var t,a;e.length&&e[0]!==document;){if(("absolute"===(t=e.css("position"))||"relative"===t||"fixed"===t)&&(a=parseInt(e.css("zIndex"),10),!isNaN(a)&&0!==a))return a;e=e.parent()}return 0}(e(t))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[s]?a.dpDiv.show(s,e.datepicker._get(a,"showOptions"),l):a.dpDiv[s||"show"](s?l:null),e.datepicker._shouldFocusInput(a)&&a.input.trigger("focus"),e.datepicker._curInst=a)))},_updateDatepicker:function(t){this.maxRows=4,P=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var a,n=this._getNumberOfMonths(t),o=n[1],i=t.dpDiv.find("."+this._dayOverClass+" a"),r=e.datepicker._get(t,"onUpdateDatepicker");i.length>0&&M.apply(i.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&t.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",17*o+"em"),t.dpDiv[(1!==n[0]||1!==n[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.trigger("focus"),t.yearshtml&&(a=t.yearshtml,setTimeout((function(){a===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year").first().replaceWith(t.yearshtml),a=t.yearshtml=null}),0)),r&&r.apply(t.input?t.input[0]:null,[t])},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,a,n){var o=t.dpDiv.outerWidth(),i=t.dpDiv.outerHeight(),r=t.input?t.input.outerWidth():0,s=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(n?0:e(document).scrollLeft()),c=document.documentElement.clientHeight+(n?0:e(document).scrollTop());return a.left-=this._get(t,"isRTL")?o-r:0,a.left-=n&&a.left===t.input.offset().left?e(document).scrollLeft():0,a.top-=n&&a.top===t.input.offset().top+s?e(document).scrollTop():0,a.left-=Math.min(a.left,a.left+o>l&&l>o?Math.abs(a.left+o-l):0),a.top-=Math.min(a.top,a.top+i>c&&c>i?Math.abs(i+s):0),a},_findPos:function(t){for(var a,n=this._getInst(t),o=this._get(n,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.pseudos.hidden(t));)t=t[o?"previousSibling":"nextSibling"];return[(a=e(t).offset()).left,a.top]},_hideDatepicker:function(t){var a,n,o,i,r=this._curInst;!r||t&&r!==e.data(t,"datepicker")||this._datepickerShowing&&(a=this._get(r,"showAnim"),n=this._get(r,"duration"),o=function(){e.datepicker._tidyDialog(r)},e.effects&&(e.effects.effect[a]||e.effects[a])?r.dpDiv.hide(a,e.datepicker._get(r,"showOptions"),n,o):r.dpDiv["slideDown"===a?"slideUp":"fadeIn"===a?"fadeOut":"hide"](a?n:null,o),a||o(),this._datepickerShowing=!1,(i=this._get(r,"onClose"))&&i.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var a=e(t.target),n=e.datepicker._getInst(a[0]);(a[0].id===e.datepicker._mainDivId||0!==a.parents("#"+e.datepicker._mainDivId).length||a.hasClass(e.datepicker.markerClassName)||a.closest("."+e.datepicker._triggerClass).length||!e.datepicker._datepickerShowing||e.datepicker._inDialog&&e.blockUI)&&(!a.hasClass(e.datepicker.markerClassName)||e.datepicker._curInst===n)||e.datepicker._hideDatepicker()}},_adjustDate:function(t,a,n){var o=e(t),i=this._getInst(o[0]);this._isDisabledDatepicker(o[0])||(this._adjustInstDate(i,a,n),this._updateDatepicker(i))},_gotoToday:function(t){var a,n=e(t),o=this._getInst(n[0]);this._get(o,"gotoCurrent")&&o.currentDay?(o.selectedDay=o.currentDay,o.drawMonth=o.selectedMonth=o.currentMonth,o.drawYear=o.selectedYear=o.currentYear):(a=new Date,o.selectedDay=a.getDate(),o.drawMonth=o.selectedMonth=a.getMonth(),o.drawYear=o.selectedYear=a.getFullYear()),this._notifyChange(o),this._adjustDate(n)},_selectMonthYear:function(t,a,n){var o=e(t),i=this._getInst(o[0]);i["selected"+("M"===n?"Month":"Year")]=i["draw"+("M"===n?"Month":"Year")]=parseInt(a.options[a.selectedIndex].value,10),this._notifyChange(i),this._adjustDate(o)},_selectDay:function(t,a,n,o){var i,r=e(t);e(o).hasClass(this._unselectableClass)||this._isDisabledDatepicker(r[0])||((i=this._getInst(r[0])).selectedDay=i.currentDay=parseInt(e("a",o).attr("data-date")),i.selectedMonth=i.currentMonth=a,i.selectedYear=i.currentYear=n,this._selectDate(t,this._formatDate(i,i.currentDay,i.currentMonth,i.currentYear)))},_clearDate:function(t){var a=e(t);this._selectDate(a,"")},_selectDate:function(t,a){var n,o=e(t),i=this._getInst(o[0]);a=null!=a?a:this._formatDate(i),i.input&&i.input.val(a),this._updateAlternate(i),(n=this._get(i,"onSelect"))?n.apply(i.input?i.input[0]:null,[a,i]):i.input&&i.input.trigger("change"),i.inline?this._updateDatepicker(i):(this._hideDatepicker(),this._lastInput=i.input[0],"object"!=typeof i.input[0]&&i.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(t){var a,n,o,i=this._get(t,"altField");i&&(a=this._get(t,"altFormat")||this._get(t,"dateFormat"),n=this._getDate(t),o=this.formatDate(a,n,this._getFormatConfig(t)),e(document).find(i).val(o))},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t,a=new Date(e.getTime());return a.setDate(a.getDate()+4-(a.getDay()||7)),t=a.getTime(),a.setMonth(0),a.setDate(1),Math.floor(Math.round((t-a)/864e5)/7)+1},parseDate:function(t,a,n){if(null==t||null==a)throw"Invalid arguments";if(""===(a="object"==typeof a?a.toString():a+""))return null;var o,i,r,s,l=0,c=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff,u="string"!=typeof c?c:(new Date).getFullYear()%100+parseInt(c,10),d=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,p=(n?n.dayNames:null)||this._defaults.dayNames,h=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,f=(n?n.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,y=-1,_=-1,b=!1,v=function(e){var a=o+1<t.length&&t.charAt(o+1)===e;return a&&o++,a},w=function(e){var t=v(e),n="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,o=new RegExp("^\\d{"+("y"===e?n:1)+","+n+"}"),i=a.substring(l).match(o);if(!i)throw"Missing number at position "+l;return l+=i[0].length,parseInt(i[0],10)},x=function(t,n,o){var i=-1,r=e.map(v(t)?o:n,(function(e,t){return[[t,e]]})).sort((function(e,t){return-(e[1].length-t[1].length)}));if(e.each(r,(function(e,t){var n=t[1];if(a.substr(l,n.length).toLowerCase()===n.toLowerCase())return i=t[0],l+=n.length,!1})),-1!==i)return i+1;throw"Unknown name at position "+l},k=function(){if(a.charAt(l)!==t.charAt(o))throw"Unexpected literal at position "+l;l++};for(o=0;o<t.length;o++)if(b)"'"!==t.charAt(o)||v("'")?k():b=!1;else switch(t.charAt(o)){case"d":y=w("d");break;case"D":x("D",d,p);break;case"o":_=w("o");break;case"m":g=w("m");break;case"M":g=x("M",h,f);break;case"y":m=w("y");break;case"@":m=(s=new Date(w("@"))).getFullYear(),g=s.getMonth()+1,y=s.getDate();break;case"!":m=(s=new Date((w("!")-this._ticksTo1970)/1e4)).getFullYear(),g=s.getMonth()+1,y=s.getDate();break;case"'":v("'")?k():b=!0;break;default:k()}if(l<a.length&&(r=a.substr(l),!/^\s+/.test(r)))throw"Extra/unparsed characters found in date: "+r;if(-1===m?m=(new Date).getFullYear():m<100&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(m<=u?0:-100)),_>-1)for(g=1,y=_;!(y<=(i=this._getDaysInMonth(m,g-1)));)g++,y-=i;if((s=this._daylightSavingAdjust(new Date(m,g-1,y))).getFullYear()!==m||s.getMonth()+1!==g||s.getDate()!==y)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,a){if(!t)return"";var n,o=(a?a.dayNamesShort:null)||this._defaults.dayNamesShort,i=(a?a.dayNames:null)||this._defaults.dayNames,r=(a?a.monthNamesShort:null)||this._defaults.monthNamesShort,s=(a?a.monthNames:null)||this._defaults.monthNames,l=function(t){var a=n+1<e.length&&e.charAt(n+1)===t;return a&&n++,a},c=function(e,t,a){var n=""+t;if(l(e))for(;n.length<a;)n="0"+n;return n},u=function(e,t,a,n){return l(e)?n[t]:a[t]},d="",p=!1;if(t)for(n=0;n<e.length;n++)if(p)"'"!==e.charAt(n)||l("'")?d+=e.charAt(n):p=!1;else switch(e.charAt(n)){case"d":d+=c("d",t.getDate(),2);break;case"D":d+=u("D",t.getDay(),o,i);break;case"o":d+=c("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":d+=c("m",t.getMonth()+1,2);break;case"M":d+=u("M",t.getMonth(),r,s);break;case"y":d+=l("y")?t.getFullYear():(t.getFullYear()%100<10?"0":"")+t.getFullYear()%100;break;case"@":d+=t.getTime();break;case"!":d+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?d+="'":p=!0;break;default:d+=e.charAt(n)}return d},_possibleChars:function(e){var t,a="",n=!1,o=function(a){var n=t+1<e.length&&e.charAt(t+1)===a;return n&&t++,n};for(t=0;t<e.length;t++)if(n)"'"!==e.charAt(t)||o("'")?a+=e.charAt(t):n=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":a+="0123456789";break;case"D":case"M":return null;case"'":o("'")?a+="'":n=!0;break;default:a+=e.charAt(t)}return a},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var a=this._get(e,"dateFormat"),n=e.lastVal=e.input?e.input.val():null,o=this._getDefaultDate(e),i=o,r=this._getFormatConfig(e);try{i=this.parseDate(a,n,r)||o}catch(e){n=t?"":n}e.selectedDay=i.getDate(),e.drawMonth=e.selectedMonth=i.getMonth(),e.drawYear=e.selectedYear=i.getFullYear(),e.currentDay=n?i.getDate():0,e.currentMonth=n?i.getMonth():0,e.currentYear=n?i.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,a,n){var o=null==a||""===a?n:"string"==typeof a?function(a){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),a,e.datepicker._getFormatConfig(t))}catch(e){}for(var n=(a.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,o=n.getFullYear(),i=n.getMonth(),r=n.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,l=s.exec(a);l;){switch(l[2]||"d"){case"d":case"D":r+=parseInt(l[1],10);break;case"w":case"W":r+=7*parseInt(l[1],10);break;case"m":case"M":i+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(o,i));break;case"y":case"Y":o+=parseInt(l[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(o,i))}l=s.exec(a)}return new Date(o,i,r)}(a):"number"==typeof a?isNaN(a)?n:function(e){var t=new Date;return t.setDate(t.getDate()+e),t}(a):new Date(a.getTime());return(o=o&&"Invalid Date"===o.toString()?n:o)&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,a){var n=!t,o=e.selectedMonth,i=e.selectedYear,r=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=r.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=r.getMonth(),e.drawYear=e.selectedYear=e.currentYear=r.getFullYear(),o===e.selectedMonth&&i===e.selectedYear||a||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(n?"":this._formatDate(e))},_getDate:function(e){return!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay))},_attachHandlers:function(t){var a=this._get(t,"stepMonths"),n="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map((function(){var t={prev:function(){e.datepicker._adjustDate(n,-a,"M")},next:function(){e.datepicker._adjustDate(n,+a,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(n)},selectDay:function(){return e.datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(n,this,"Y"),!1}};e(this).on(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])}))},_generateHTML:function(t){var a,n,o,i,r,s,l,c,u,d,p,h,f,m,g,y,_,b,v,w,x,k,D,S,C,T,A,P,E,I,N,M,O,j,R,L,F,U,B,z=new Date,H=this._daylightSavingAdjust(new Date(z.getFullYear(),z.getMonth(),z.getDate())),q=this._get(t,"isRTL"),V=this._get(t,"showButtonPanel"),W=this._get(t,"hideIfNoPrevNext"),G=this._get(t,"navigationAsDateFormat"),J=this._getNumberOfMonths(t),Q=this._get(t,"showCurrentAtPos"),Y=this._get(t,"stepMonths"),X=1!==J[0]||1!==J[1],K=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(t,"min"),$=this._getMinMaxDate(t,"max"),ee=t.drawMonth-Q,te=t.drawYear;if(ee<0&&(ee+=12,te--),$)for(a=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-J[0]*J[1]+1,$.getDate())),a=Z&&a<Z?Z:a;this._daylightSavingAdjust(new Date(te,ee,1))>a;)--ee<0&&(ee=11,te--);for(t.drawMonth=ee,t.drawYear=te,n=this._get(t,"prevText"),n=G?this.formatDate(n,this._daylightSavingAdjust(new Date(te,ee-Y,1)),this._getFormatConfig(t)):n,o=this._canAdjustMonth(t,-1,te,ee)?e("<a>").attr({class:"ui-datepicker-prev ui-corner-all","data-handler":"prev","data-event":"click",title:n}).append(e("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(q?"e":"w")).text(n))[0].outerHTML:W?"":e("<a>").attr({class:"ui-datepicker-prev ui-corner-all ui-state-disabled",title:n}).append(e("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(q?"e":"w")).text(n))[0].outerHTML,i=this._get(t,"nextText"),i=G?this.formatDate(i,this._daylightSavingAdjust(new Date(te,ee+Y,1)),this._getFormatConfig(t)):i,r=this._canAdjustMonth(t,1,te,ee)?e("<a>").attr({class:"ui-datepicker-next ui-corner-all","data-handler":"next","data-event":"click",title:i}).append(e("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(q?"w":"e")).text(i))[0].outerHTML:W?"":e("<a>").attr({class:"ui-datepicker-next ui-corner-all ui-state-disabled",title:i}).append(e("<span>").attr("class","ui-icon ui-icon-circle-triangle-"+(q?"w":"e")).text(i))[0].outerHTML,s=this._get(t,"currentText"),l=this._get(t,"gotoCurrent")&&t.currentDay?K:H,s=G?this.formatDate(s,l,this._getFormatConfig(t)):s,c="",t.inline||(c=e("<button>").attr({type:"button",class:"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all","data-handler":"hide","data-event":"click"}).text(this._get(t,"closeText"))[0].outerHTML),u="",V&&(u=e("<div class='ui-datepicker-buttonpane ui-widget-content'>").append(q?c:"").append(this._isInRange(t,l)?e("<button>").attr({type:"button",class:"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all","data-handler":"today","data-event":"click"}).text(s):"").append(q?"":c)[0].outerHTML),d=parseInt(this._get(t,"firstDay"),10),d=isNaN(d)?0:d,p=this._get(t,"showWeek"),h=this._get(t,"dayNames"),f=this._get(t,"dayNamesMin"),m=this._get(t,"monthNames"),g=this._get(t,"monthNamesShort"),y=this._get(t,"beforeShowDay"),_=this._get(t,"showOtherMonths"),b=this._get(t,"selectOtherMonths"),v=this._getDefaultDate(t),w="",k=0;k<J[0];k++){for(D="",this.maxRows=4,S=0;S<J[1];S++){if(C=this._daylightSavingAdjust(new Date(te,ee,t.selectedDay)),T=" ui-corner-all",A="",X){if(A+="<div class='ui-datepicker-group",J[1]>1)switch(S){case 0:A+=" ui-datepicker-group-first",T=" ui-corner-"+(q?"right":"left");break;case J[1]-1:A+=" ui-datepicker-group-last",T=" ui-corner-"+(q?"left":"right");break;default:A+=" ui-datepicker-group-middle",T=""}A+="'>"}for(A+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===k?q?r:o:"")+(/all|right/.test(T)&&0===k?q?o:r:"")+this._generateMonthYearHeader(t,ee,te,Z,$,k>0||S>0,m,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",P=p?"<th class='ui-datepicker-week-col'>"+this._get(t,"weekHeader")+"</th>":"",x=0;x<7;x++)P+="<th scope='col'"+((x+d+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+h[E=(x+d)%7]+"'>"+f[E]+"</span></th>";for(A+=P+"</tr></thead><tbody>",I=this._getDaysInMonth(te,ee),te===t.selectedYear&&ee===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,I)),N=(this._getFirstDayOfMonth(te,ee)-d+7)%7,M=Math.ceil((N+I)/7),O=X&&this.maxRows>M?this.maxRows:M,this.maxRows=O,j=this._daylightSavingAdjust(new Date(te,ee,1-N)),R=0;R<O;R++){for(A+="<tr>",L=p?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(j)+"</td>":"",x=0;x<7;x++)F=y?y.apply(t.input?t.input[0]:null,[j]):[!0,""],B=(U=j.getMonth()!==ee)&&!b||!F[0]||Z&&j<Z||$&&j>$,L+="<td class='"+((x+d+6)%7>=5?" ui-datepicker-week-end":"")+(U?" ui-datepicker-other-month":"")+(j.getTime()===C.getTime()&&ee===t.selectedMonth&&t._keyEvent||v.getTime()===j.getTime()&&v.getTime()===C.getTime()?" "+this._dayOverClass:"")+(B?" "+this._unselectableClass+" ui-state-disabled":"")+(U&&!_?"":" "+F[1]+(j.getTime()===K.getTime()?" "+this._currentClass:"")+(j.getTime()===H.getTime()?" ui-datepicker-today":""))+"'"+(U&&!_||!F[2]?"":" title='"+F[2].replace(/'/g,"&#39;")+"'")+(B?"":" data-handler='selectDay' data-event='click' data-month='"+j.getMonth()+"' data-year='"+j.getFullYear()+"'")+">"+(U&&!_?"&#xa0;":B?"<span class='ui-state-default'>"+j.getDate()+"</span>":"<a class='ui-state-default"+(j.getTime()===H.getTime()?" ui-state-highlight":"")+(j.getTime()===K.getTime()?" ui-state-active":"")+(U?" ui-priority-secondary":"")+"' href='#' aria-current='"+(j.getTime()===K.getTime()?"true":"false")+"' data-date='"+j.getDate()+"'>"+j.getDate()+"</a>")+"</td>",j.setDate(j.getDate()+1),j=this._daylightSavingAdjust(j);A+=L+"</tr>"}++ee>11&&(ee=0,te++),D+=A+="</tbody></table>"+(X?"</div>"+(J[0]>0&&S===J[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}w+=D}return w+=u,t._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,a,n,o,i,r,s){var l,c,u,d,p,h,f,m,g=this._get(e,"changeMonth"),y=this._get(e,"changeYear"),_=this._get(e,"showMonthAfterYear"),b=this._get(e,"selectMonthLabel"),v=this._get(e,"selectYearLabel"),w="<div class='ui-datepicker-title'>",x="";if(i||!g)x+="<span class='ui-datepicker-month'>"+r[t]+"</span>";else{for(l=n&&n.getFullYear()===a,c=o&&o.getFullYear()===a,x+="<select class='ui-datepicker-month' aria-label='"+b+"' data-handler='selectMonth' data-event='change'>",u=0;u<12;u++)(!l||u>=n.getMonth())&&(!c||u<=o.getMonth())&&(x+="<option value='"+u+"'"+(u===t?" selected='selected'":"")+">"+s[u]+"</option>");x+="</select>"}if(_||(w+=x+(!i&&g&&y?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",i||!y)w+="<span class='ui-datepicker-year'>"+a+"</span>";else{for(d=this._get(e,"yearRange").split(":"),p=(new Date).getFullYear(),h=function(e){var t=e.match(/c[+\-].*/)?a+parseInt(e.substring(1),10):e.match(/[+\-].*/)?p+parseInt(e,10):parseInt(e,10);return isNaN(t)?p:t},f=h(d[0]),m=Math.max(f,h(d[1]||"")),f=n?Math.max(f,n.getFullYear()):f,m=o?Math.min(m,o.getFullYear()):m,e.yearshtml+="<select class='ui-datepicker-year' aria-label='"+v+"' data-handler='selectYear' data-event='change'>";f<=m;f++)e.yearshtml+="<option value='"+f+"'"+(f===a?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",w+=e.yearshtml,e.yearshtml=null}return w+=this._get(e,"yearSuffix"),_&&(w+=(!i&&g&&y?"":"&#xa0;")+x),w+"</div>"},_adjustInstDate:function(e,t,a){var n=e.selectedYear+("Y"===a?t:0),o=e.selectedMonth+("M"===a?t:0),i=Math.min(e.selectedDay,this._getDaysInMonth(n,o))+("D"===a?t:0),r=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(n,o,i)));e.selectedDay=r.getDate(),e.drawMonth=e.selectedMonth=r.getMonth(),e.drawYear=e.selectedYear=r.getFullYear(),"M"!==a&&"Y"!==a||this._notifyChange(e)},_restrictMinMax:function(e,t){var a=this._getMinMaxDate(e,"min"),n=this._getMinMaxDate(e,"max"),o=a&&t<a?a:t;return n&&o>n?n:o},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,a,n){var o=this._getNumberOfMonths(e),i=this._daylightSavingAdjust(new Date(a,n+(t<0?t:o[0]*o[1]),1));return t<0&&i.setDate(this._getDaysInMonth(i.getFullYear(),i.getMonth())),this._isInRange(e,i)},_isInRange:function(e,t){var a,n,o=this._getMinMaxDate(e,"min"),i=this._getMinMaxDate(e,"max"),r=null,s=null,l=this._get(e,"yearRange");return l&&(a=l.split(":"),n=(new Date).getFullYear(),r=parseInt(a[0],10),s=parseInt(a[1],10),a[0].match(/[+\-].*/)&&(r+=n),a[1].match(/[+\-].*/)&&(s+=n)),(!o||t.getTime()>=o.getTime())&&(!i||t.getTime()<=i.getTime())&&(!r||t.getFullYear()>=r)&&(!s||t.getFullYear()<=s)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return{shortYearCutoff:t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,a,n){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var o=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(n,a,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),o,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).on("mousedown",e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var a=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(a)):this.each((function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(a)):e.datepicker._attachDatepicker(this,t)})):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(a))},e.datepicker=new I,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.13.2",e.datepicker,e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var j,R=!1;function L(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}e(document).on("mouseup",(function(){R=!1})),e.widget("ui.mouse",{version:"1.13.2",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.on("mousedown."+this.widgetName,(function(e){return t._mouseDown(e)})).on("click."+this.widgetName,(function(a){if(!0===e.data(a.target,t.widgetName+".preventClickEvent"))return e.removeData(a.target,t.widgetName+".preventClickEvent"),a.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!R){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var a=this,n=1===t.which,o=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&e(t.target).closest(this.options.cancel).length;return!(n&&!o&&this._mouseCapture(t)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){a.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return a._mouseMove(e)},this._mouseUpDelegate=function(e){return a._mouseUp(e)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),R=!0,0)))}},_mouseMove:function(t){if(this._mouseMoved){if(e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,R=!1,t.preventDefault()},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),e.ui.plugin={add:function(t,a,n){var o,i=e.ui[t].prototype;for(o in n)i.plugins[o]=i.plugins[o]||[],i.plugins[o].push([a,n[o]])},call:function(e,t,a,n){var o,i=e.plugins[t];if(i&&(n||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(o=0;o<i.length;o++)e.options[i[o][0]]&&i[o][1].apply(e.element,a)}},e.ui.safeBlur=function(t){t&&"body"!==t.nodeName.toLowerCase()&&e(t).trigger("blur")},e.widget("ui.draggable",e.ui.mouse,{version:"1.13.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(t){var a=this.options;return!(this.helper||a.disabled||e(t.target).closest(".ui-resizable-handle").length>0||(this.handle=this._getHandle(t),!this.handle||(this._blurActiveElement(t),this._blockFrames(!0===a.iframeFix?"iframe":a.iframeFix),0)))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map((function(){var t=e(this);return e("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var a=e.ui.safeActiveElement(this.document[0]);e(t.target).closest(a).length||e.ui.safeBlur(a)},_mouseStart:function(t){var a=this.options;return this.helper=this._createHelper(t),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter((function(){return"fixed"===e(this).css("position")})).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!a.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(e){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:e.pageX-this.offset.left,top:e.pageY-this.offset.top}},_mouseDrag:function(t,a){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!a){var n=this._uiHash();if(!1===this._trigger("drag",t,n))return this._mouseUp(new e.Event("mouseup",t)),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var a=this,n=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(n=e.ui.ddmanager.drop(this,t)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||!0===this.options.revert||"function"==typeof this.options.revert&&this.options.revert.call(this.element,n)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),(function(){!1!==a._trigger("stop",t)&&a._clear()})):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.trigger("focus"),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new e.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(t){var a=this.options,n="function"==typeof a.helper,o=n?e(a.helper.apply(this.element[0],[t])):"clone"===a.helper?this.element.clone().removeAttr("id"):this.element;return o.parents("body").length||o.appendTo("parent"===a.appendTo?this.element[0].parentNode:a.appendTo),n&&o[0]===this.element[0]&&this._setPositionRelative(),o[0]===this.element[0]||/(fixed|absolute)/.test(o.css("position"))||o.css("position","absolute"),o},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),Array.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),a=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==a&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,a,n,o=this.options,i=this.document[0];this.relativeContainer=null,o.containment?"window"!==o.containment?"document"!==o.containment?o.containment.constructor!==Array?("parent"===o.containment&&(o.containment=this.helper[0].parentNode),(n=(a=e(o.containment))[0])&&(t=/(scroll|auto)/.test(a.css("overflow")),this.containment=[(parseInt(a.css("borderLeftWidth"),10)||0)+(parseInt(a.css("paddingLeft"),10)||0),(parseInt(a.css("borderTopWidth"),10)||0)+(parseInt(a.css("paddingTop"),10)||0),(t?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(a.css("borderRightWidth"),10)||0)-(parseInt(a.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(a.css("borderBottomWidth"),10)||0)-(parseInt(a.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=a)):this.containment=o.containment:this.containment=[0,0,e(i).width()-this.helperProportions.width-this.margins.left,(e(i).height()||i.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||i.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},_convertPositionTo:function(e,t){t||(t=this.position);var a="absolute"===e?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*a+this.offset.parent.top*a-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*a,left:t.left+this.offset.relative.left*a+this.offset.parent.left*a-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*a}},_generatePosition:function(e,t){var a,n,o,i,r=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),a=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):a=this.containment,e.pageX-this.offset.click.left<a[0]&&(l=a[0]+this.offset.click.left),e.pageY-this.offset.click.top<a[1]&&(c=a[1]+this.offset.click.top),e.pageX-this.offset.click.left>a[2]&&(l=a[2]+this.offset.click.left),e.pageY-this.offset.click.top>a[3]&&(c=a[3]+this.offset.click.top)),r.grid&&(o=r.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/r.grid[1])*r.grid[1]:this.originalPageY,c=a?o-this.offset.click.top>=a[1]||o-this.offset.click.top>a[3]?o:o-this.offset.click.top>=a[1]?o-r.grid[1]:o+r.grid[1]:o,i=r.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/r.grid[0])*r.grid[0]:this.originalPageX,l=a?i-this.offset.click.left>=a[0]||i-this.offset.click.left>a[2]?i:i-this.offset.click.left>=a[0]?i-r.grid[0]:i+r.grid[0]:i),"y"===r.axis&&(l=this.originalPageX),"x"===r.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,a,n){return n=n||this._uiHash(),e.ui.plugin.call(this,t,[a,n,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),e.Widget.prototype._trigger.call(this,t,a,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,a,n){var o=e.extend({},a,{item:n.element});n.sortables=[],e(n.options.connectToSortable).each((function(){var a=e(this).sortable("instance");a&&!a.options.disabled&&(n.sortables.push(a),a.refreshPositions(),a._trigger("activate",t,o))}))},stop:function(t,a,n){var o=e.extend({},a,{item:n.element});n.cancelHelperRemoval=!1,e.each(n.sortables,(function(){var e=this;e.isOver?(e.isOver=0,n.cancelHelperRemoval=!0,e.cancelHelperRemoval=!1,e._storedCSS={position:e.placeholder.css("position"),top:e.placeholder.css("top"),left:e.placeholder.css("left")},e._mouseStop(t),e.options.helper=e.options._helper):(e.cancelHelperRemoval=!0,e._trigger("deactivate",t,o))}))},drag:function(t,a,n){e.each(n.sortables,(function(){var o=!1,i=this;i.positionAbs=n.positionAbs,i.helperProportions=n.helperProportions,i.offset.click=n.offset.click,i._intersectsWith(i.containerCache)&&(o=!0,e.each(n.sortables,(function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==i&&this._intersectsWith(this.containerCache)&&e.contains(i.element[0],this.element[0])&&(o=!1),o}))),o?(i.isOver||(i.isOver=1,n._parent=a.helper.parent(),i.currentItem=a.helper.appendTo(i.element).data("ui-sortable-item",!0),i.options._helper=i.options.helper,i.options.helper=function(){return a.helper[0]},t.target=i.currentItem[0],i._mouseCapture(t,!0),i._mouseStart(t,!0,!0),i.offset.click.top=n.offset.click.top,i.offset.click.left=n.offset.click.left,i.offset.parent.left-=n.offset.parent.left-i.offset.parent.left,i.offset.parent.top-=n.offset.parent.top-i.offset.parent.top,n._trigger("toSortable",t),n.dropped=i.element,e.each(n.sortables,(function(){this.refreshPositions()})),n.currentItem=n.element,i.fromOutside=n),i.currentItem&&(i._mouseDrag(t),a.position=i.position)):i.isOver&&(i.isOver=0,i.cancelHelperRemoval=!0,i.options._revert=i.options.revert,i.options.revert=!1,i._trigger("out",t,i._uiHash(i)),i._mouseStop(t,!0),i.options.revert=i.options._revert,i.options.helper=i.options._helper,i.placeholder&&i.placeholder.remove(),a.helper.appendTo(n._parent),n._refreshOffsets(t),a.position=n._generatePosition(t,!0),n._trigger("fromSortable",t),n.dropped=!1,e.each(n.sortables,(function(){this.refreshPositions()})))}))}}),e.ui.plugin.add("draggable","cursor",{start:function(t,a,n){var o=e("body"),i=n.options;o.css("cursor")&&(i._cursor=o.css("cursor")),o.css("cursor",i.cursor)},stop:function(t,a,n){var o=n.options;o._cursor&&e("body").css("cursor",o._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,a,n){var o=e(a.helper),i=n.options;o.css("opacity")&&(i._opacity=o.css("opacity")),o.css("opacity",i.opacity)},stop:function(t,a,n){var o=n.options;o._opacity&&e(a.helper).css("opacity",o._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,a){a.scrollParentNotHidden||(a.scrollParentNotHidden=a.helper.scrollParent(!1)),a.scrollParentNotHidden[0]!==a.document[0]&&"HTML"!==a.scrollParentNotHidden[0].tagName&&(a.overflowOffset=a.scrollParentNotHidden.offset())},drag:function(t,a,n){var o=n.options,i=!1,r=n.scrollParentNotHidden[0],s=n.document[0];r!==s&&"HTML"!==r.tagName?(o.axis&&"x"===o.axis||(n.overflowOffset.top+r.offsetHeight-t.pageY<o.scrollSensitivity?r.scrollTop=i=r.scrollTop+o.scrollSpeed:t.pageY-n.overflowOffset.top<o.scrollSensitivity&&(r.scrollTop=i=r.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(n.overflowOffset.left+r.offsetWidth-t.pageX<o.scrollSensitivity?r.scrollLeft=i=r.scrollLeft+o.scrollSpeed:t.pageX-n.overflowOffset.left<o.scrollSensitivity&&(r.scrollLeft=i=r.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(t.pageY-e(s).scrollTop()<o.scrollSensitivity?i=e(s).scrollTop(e(s).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(s).scrollTop())<o.scrollSensitivity&&(i=e(s).scrollTop(e(s).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(t.pageX-e(s).scrollLeft()<o.scrollSensitivity?i=e(s).scrollLeft(e(s).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(s).scrollLeft())<o.scrollSensitivity&&(i=e(s).scrollLeft(e(s).scrollLeft()+o.scrollSpeed)))),!1!==i&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,a,n){var o=n.options;n.snapElements=[],e(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each((function(){var t=e(this),a=t.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:a.top,left:a.left})}))},drag:function(t,a,n){var o,i,r,s,l,c,u,d,p,h,f=n.options,m=f.snapTolerance,g=a.offset.left,y=g+n.helperProportions.width,_=a.offset.top,b=_+n.helperProportions.height;for(p=n.snapElements.length-1;p>=0;p--)c=(l=n.snapElements[p].left-n.margins.left)+n.snapElements[p].width,d=(u=n.snapElements[p].top-n.margins.top)+n.snapElements[p].height,y<l-m||g>c+m||b<u-m||_>d+m||!e.contains(n.snapElements[p].item.ownerDocument,n.snapElements[p].item)?(n.snapElements[p].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[p].item})),n.snapElements[p].snapping=!1):("inner"!==f.snapMode&&(o=Math.abs(u-b)<=m,i=Math.abs(d-_)<=m,r=Math.abs(l-y)<=m,s=Math.abs(c-g)<=m,o&&(a.position.top=n._convertPositionTo("relative",{top:u-n.helperProportions.height,left:0}).top),i&&(a.position.top=n._convertPositionTo("relative",{top:d,left:0}).top),r&&(a.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left),s&&(a.position.left=n._convertPositionTo("relative",{top:0,left:c}).left)),h=o||i||r||s,"outer"!==f.snapMode&&(o=Math.abs(u-_)<=m,i=Math.abs(d-b)<=m,r=Math.abs(l-g)<=m,s=Math.abs(c-y)<=m,o&&(a.position.top=n._convertPositionTo("relative",{top:u,left:0}).top),i&&(a.position.top=n._convertPositionTo("relative",{top:d-n.helperProportions.height,left:0}).top),r&&(a.position.left=n._convertPositionTo("relative",{top:0,left:l}).left),s&&(a.position.left=n._convertPositionTo("relative",{top:0,left:c-n.helperProportions.width}).left)),!n.snapElements[p].snapping&&(o||i||r||s||h)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,t,e.extend(n._uiHash(),{snapItem:n.snapElements[p].item})),n.snapElements[p].snapping=o||i||r||s||h)}}),e.ui.plugin.add("draggable","stack",{start:function(t,a,n){var o,i=n.options,r=e.makeArray(e(i.stack)).sort((function(t,a){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(a).css("zIndex"),10)||0)}));r.length&&(o=parseInt(e(r[0]).css("zIndex"),10)||0,e(r).each((function(t){e(this).css("zIndex",o+t)})),this.css("zIndex",o+r.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,a,n){var o=e(a.helper),i=n.options;o.css("zIndex")&&(i._zIndex=o.css("zIndex")),o.css("zIndex",i.zIndex)},stop:function(t,a,n){var o=n.options;o._zIndex&&e(a.helper).css("zIndex",o._zIndex)}}),e.ui.draggable,e.widget("ui.resizable",e.ui.mouse,{version:"1.13.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(e){return parseFloat(e)||0},_isNumber:function(e){return!isNaN(parseFloat(e))},_hasScroll:function(t,a){if("hidden"===e(t).css("overflow"))return!1;var n=a&&"left"===a?"scrollLeft":"scrollTop",o=!1;if(t[n]>0)return!0;try{t[n]=1,o=t[n]>0,t[n]=0}catch(e){}return o},_create:function(){var t,a=this.options,n=this;this._addClass("ui-resizable"),e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(e("<div class='ui-wrapper'></div>").css({overflow:"hidden",position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,t={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(t),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(t),this._proportionallyResize()),this._setupHandles(),a.autoHide&&e(this.element).on("mouseenter",(function(){a.disabled||(n._removeClass("ui-resizable-autohide"),n._handles.show())})).on("mouseleave",(function(){a.disabled||n.resizing||(n._addClass("ui-resizable-autohide"),n._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy(),this._addedHandles.remove();var t,a=function(t){e(t).removeData("resizable").removeData("ui-resizable").off(".resizable")};return this.elementIsWrapper&&(a(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),a(this.originalElement),this},_setOption:function(e,t){switch(this._super(e,t),e){case"handles":this._removeHandles(),this._setupHandles();break;case"aspectRatio":this._aspectRatio=!!t}},_setupHandles:function(){var t,a,n,o,i,r=this.options,s=this;if(this.handles=r.handles||(e(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=e(),this._addedHandles=e(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},a=0;a<n.length;a++)o="ui-resizable-"+(t=String.prototype.trim.call(n[a])),i=e("<div>"),this._addClass(i,"ui-resizable-handle "+o),i.css({zIndex:r.zIndex}),this.handles[t]=".ui-resizable-"+t,this.element.children(this.handles[t]).length||(this.element.append(i),this._addedHandles=this._addedHandles.add(i));this._renderAxis=function(t){var a,n,o,i;for(a in t=t||this.element,this.handles)this.handles[a].constructor===String?this.handles[a]=this.element.children(this.handles[a]).first().show():(this.handles[a].jquery||this.handles[a].nodeType)&&(this.handles[a]=e(this.handles[a]),this._on(this.handles[a],{mousedown:s._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(n=e(this.handles[a],this.element),i=/sw|ne|nw|se|n|s/.test(a)?n.outerHeight():n.outerWidth(),o=["padding",/ne|nw|n/.test(a)?"Top":/se|sw|s/.test(a)?"Bottom":/^e$/.test(a)?"Right":"Left"].join(""),t.css(o,i),this._proportionallyResize()),this._handles=this._handles.add(this.handles[a])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",(function(){s.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),s.axis=i&&i[1]?i[1]:"se")})),r.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(t){var a,n,o=!1;for(a in this.handles)((n=e(this.handles[a])[0])===t.target||e.contains(n,t.target))&&(o=!0);return!this.options.disabled&&o},_mouseStart:function(t){var a,n,o,i=this.options,r=this.element;return this.resizing=!0,this._renderProxy(),a=this._num(this.helper.css("left")),n=this._num(this.helper.css("top")),i.containment&&(a+=e(i.containment).scrollLeft()||0,n+=e(i.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:a,top:n},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalPosition={left:a,top:n},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof i.aspectRatio?i.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=e(".ui-resizable-"+this.axis).css("cursor"),e("body").css("cursor","auto"===o?this.axis+"-resize":o),this._addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var a,n,o=this.originalMousePosition,i=this.axis,r=t.pageX-o.left||0,s=t.pageY-o.top||0,l=this._change[i];return this._updatePrevProperties(),!!l&&(a=l.apply(this,[t,r,s]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(a=this._updateRatio(a,t)),a=this._respectSize(a,t),this._updateCache(a),this._propagate("resize",t),n=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),e.isEmptyObject(n)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges()),!1)},_mouseStop:function(t){this.resizing=!1;var a,n,o,i,r,s,l,c=this.options,u=this;return this._helper&&(o=(n=(a=this._proportionallyResizeElements).length&&/textarea/i.test(a[0].nodeName))&&this._hasScroll(a[0],"left")?0:u.sizeDiff.height,i=n?0:u.sizeDiff.width,r={width:u.helper.width()-i,height:u.helper.height()-o},s=parseFloat(u.element.css("left"))+(u.position.left-u.originalPosition.left)||null,l=parseFloat(u.element.css("top"))+(u.position.top-u.originalPosition.top)||null,c.animate||this.element.css(e.extend(r,{top:l,left:s})),u.helper.height(u.size.height),u.helper.width(u.size.width),this._helper&&!c.animate&&this._proportionallyResize()),e("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var e={};return this.position.top!==this.prevPosition.top&&(e.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(e.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(e.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(e.height=this.size.height+"px"),this.helper.css(e),e},_updateVirtualBoundaries:function(e){var t,a,n,o,i,r=this.options;i={minWidth:this._isNumber(r.minWidth)?r.minWidth:0,maxWidth:this._isNumber(r.maxWidth)?r.maxWidth:1/0,minHeight:this._isNumber(r.minHeight)?r.minHeight:0,maxHeight:this._isNumber(r.maxHeight)?r.maxHeight:1/0},(this._aspectRatio||e)&&(t=i.minHeight*this.aspectRatio,n=i.minWidth/this.aspectRatio,a=i.maxHeight*this.aspectRatio,o=i.maxWidth/this.aspectRatio,t>i.minWidth&&(i.minWidth=t),n>i.minHeight&&(i.minHeight=n),a<i.maxWidth&&(i.maxWidth=a),o<i.maxHeight&&(i.maxHeight=o)),this._vBoundaries=i},_updateCache:function(e){this.offset=this.helper.offset(),this._isNumber(e.left)&&(this.position.left=e.left),this._isNumber(e.top)&&(this.position.top=e.top),this._isNumber(e.height)&&(this.size.height=e.height),this._isNumber(e.width)&&(this.size.width=e.width)},_updateRatio:function(e){var t=this.position,a=this.size,n=this.axis;return this._isNumber(e.height)?e.width=e.height*this.aspectRatio:this._isNumber(e.width)&&(e.height=e.width/this.aspectRatio),"sw"===n&&(e.left=t.left+(a.width-e.width),e.top=null),"nw"===n&&(e.top=t.top+(a.height-e.height),e.left=t.left+(a.width-e.width)),e},_respectSize:function(e){var t=this._vBoundaries,a=this.axis,n=this._isNumber(e.width)&&t.maxWidth&&t.maxWidth<e.width,o=this._isNumber(e.height)&&t.maxHeight&&t.maxHeight<e.height,i=this._isNumber(e.width)&&t.minWidth&&t.minWidth>e.width,r=this._isNumber(e.height)&&t.minHeight&&t.minHeight>e.height,s=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,c=/sw|nw|w/.test(a),u=/nw|ne|n/.test(a);return i&&(e.width=t.minWidth),r&&(e.height=t.minHeight),n&&(e.width=t.maxWidth),o&&(e.height=t.maxHeight),i&&c&&(e.left=s-t.minWidth),n&&c&&(e.left=s-t.maxWidth),r&&u&&(e.top=l-t.minHeight),o&&u&&(e.top=l-t.maxHeight),e.width||e.height||e.left||!e.top?e.width||e.height||e.top||!e.left||(e.left=null):e.top=null,e},_getPaddingPlusBorderDimensions:function(e){for(var t=0,a=[],n=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],o=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];t<4;t++)a[t]=parseFloat(n[t])||0,a[t]+=parseFloat(o[t])||0;return{height:a[0]+a[2],width:a[1]+a[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var e,t=0,a=this.helper||this.element;t<this._proportionallyResizeElements.length;t++)e=this._proportionallyResizeElements[t],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(e)),e.css({height:a.height()-this.outerDimensions.height||0,width:a.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,a=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||e("<div></div>").css({overflow:"hidden"}),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++a.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(e,t){return{width:this.originalSize.width+t}},w:function(e,t){var a=this.originalSize;return{left:this.originalPosition.left+t,width:a.width-t}},n:function(e,t,a){var n=this.originalSize;return{top:this.originalPosition.top+a,height:n.height-a}},s:function(e,t,a){return{height:this.originalSize.height+a}},se:function(t,a,n){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,a,n]))},sw:function(t,a,n){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,a,n]))},ne:function(t,a,n){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,a,n]))},nw:function(t,a,n){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,a,n]))}},_propagate:function(t,a){e.ui.plugin.call(this,t,[a,this.ui()]),"resize"!==t&&this._trigger(t,a,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),e.ui.plugin.add("resizable","animate",{stop:function(t){var a=e(this).resizable("instance"),n=a.options,o=a._proportionallyResizeElements,i=o.length&&/textarea/i.test(o[0].nodeName),r=i&&a._hasScroll(o[0],"left")?0:a.sizeDiff.height,s=i?0:a.sizeDiff.width,l={width:a.size.width-s,height:a.size.height-r},c=parseFloat(a.element.css("left"))+(a.position.left-a.originalPosition.left)||null,u=parseFloat(a.element.css("top"))+(a.position.top-a.originalPosition.top)||null;a.element.animate(e.extend(l,u&&c?{top:u,left:c}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var n={width:parseFloat(a.element.css("width")),height:parseFloat(a.element.css("height")),top:parseFloat(a.element.css("top")),left:parseFloat(a.element.css("left"))};o&&o.length&&e(o[0]).css({width:n.width,height:n.height}),a._updateCache(n),a._propagate("resize",t)}})}}),e.ui.plugin.add("resizable","containment",{start:function(){var t,a,n,o,i,r,s,l=e(this).resizable("instance"),c=l.options,u=l.element,d=c.containment,p=d instanceof e?d.get(0):/parent/.test(d)?u.parent().get(0):d;p&&(l.containerElement=e(p),/document/.test(d)||d===document?(l.containerOffset={left:0,top:0},l.containerPosition={left:0,top:0},l.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}):(t=e(p),a=[],e(["Top","Right","Left","Bottom"]).each((function(e,n){a[e]=l._num(t.css("padding"+n))})),l.containerOffset=t.offset(),l.containerPosition=t.position(),l.containerSize={height:t.innerHeight()-a[3],width:t.innerWidth()-a[1]},n=l.containerOffset,o=l.containerSize.height,i=l.containerSize.width,r=l._hasScroll(p,"left")?p.scrollWidth:i,s=l._hasScroll(p)?p.scrollHeight:o,l.parentData={element:p,left:n.left,top:n.top,width:r,height:s}))},resize:function(t){var a,n,o,i,r=e(this).resizable("instance"),s=r.options,l=r.containerOffset,c=r.position,u=r._aspectRatio||t.shiftKey,d={top:0,left:0},p=r.containerElement,h=!0;p[0]!==document&&/static/.test(p.css("position"))&&(d=l),c.left<(r._helper?l.left:0)&&(r.size.width=r.size.width+(r._helper?r.position.left-l.left:r.position.left-d.left),u&&(r.size.height=r.size.width/r.aspectRatio,h=!1),r.position.left=s.helper?l.left:0),c.top<(r._helper?l.top:0)&&(r.size.height=r.size.height+(r._helper?r.position.top-l.top:r.position.top),u&&(r.size.width=r.size.height*r.aspectRatio,h=!1),r.position.top=r._helper?l.top:0),o=r.containerElement.get(0)===r.element.parent().get(0),i=/relative|absolute/.test(r.containerElement.css("position")),o&&i?(r.offset.left=r.parentData.left+r.position.left,r.offset.top=r.parentData.top+r.position.top):(r.offset.left=r.element.offset().left,r.offset.top=r.element.offset().top),a=Math.abs(r.sizeDiff.width+(r._helper?r.offset.left-d.left:r.offset.left-l.left)),n=Math.abs(r.sizeDiff.height+(r._helper?r.offset.top-d.top:r.offset.top-l.top)),a+r.size.width>=r.parentData.width&&(r.size.width=r.parentData.width-a,u&&(r.size.height=r.size.width/r.aspectRatio,h=!1)),n+r.size.height>=r.parentData.height&&(r.size.height=r.parentData.height-n,u&&(r.size.width=r.size.height*r.aspectRatio,h=!1)),h||(r.position.left=r.prevPosition.left,r.position.top=r.prevPosition.top,r.size.width=r.prevSize.width,r.size.height=r.prevSize.height)},stop:function(){var t=e(this).resizable("instance"),a=t.options,n=t.containerOffset,o=t.containerPosition,i=t.containerElement,r=e(t.helper),s=r.offset(),l=r.outerWidth()-t.sizeDiff.width,c=r.outerHeight()-t.sizeDiff.height;t._helper&&!a.animate&&/relative/.test(i.css("position"))&&e(this).css({left:s.left-o.left-n.left,width:l,height:c}),t._helper&&!a.animate&&/static/.test(i.css("position"))&&e(this).css({left:s.left-o.left-n.left,width:l,height:c})}}),e.ui.plugin.add("resizable","alsoResize",{start:function(){var t=e(this).resizable("instance").options;e(t.alsoResize).each((function(){var t=e(this);t.data("ui-resizable-alsoresize",{width:parseFloat(t.width()),height:parseFloat(t.height()),left:parseFloat(t.css("left")),top:parseFloat(t.css("top"))})}))},resize:function(t,a){var n=e(this).resizable("instance"),o=n.options,i=n.originalSize,r=n.originalPosition,s={height:n.size.height-i.height||0,width:n.size.width-i.width||0,top:n.position.top-r.top||0,left:n.position.left-r.left||0};e(o.alsoResize).each((function(){var t=e(this),n=e(this).data("ui-resizable-alsoresize"),o={},i=t.parents(a.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(i,(function(e,t){var a=(n[t]||0)+(s[t]||0);a&&a>=0&&(o[t]=a||null)})),t.css(o)}))},stop:function(){e(this).removeData("ui-resizable-alsoresize")}}),e.ui.plugin.add("resizable","ghost",{start:function(){var t=e(this).resizable("instance"),a=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:a.height,width:a.width,margin:0,left:0,top:0}),t._addClass(t.ghost,"ui-resizable-ghost"),!1!==e.uiBackCompat&&"string"==typeof t.options.ghost&&t.ghost.addClass(this.options.ghost),t.ghost.appendTo(t.helper)},resize:function(){var t=e(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=e(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),e.ui.plugin.add("resizable","grid",{resize:function(){var t,a=e(this).resizable("instance"),n=a.options,o=a.size,i=a.originalSize,r=a.originalPosition,s=a.axis,l="number"==typeof n.grid?[n.grid,n.grid]:n.grid,c=l[0]||1,u=l[1]||1,d=Math.round((o.width-i.width)/c)*c,p=Math.round((o.height-i.height)/u)*u,h=i.width+d,f=i.height+p,m=n.maxWidth&&n.maxWidth<h,g=n.maxHeight&&n.maxHeight<f,y=n.minWidth&&n.minWidth>h,_=n.minHeight&&n.minHeight>f;n.grid=l,y&&(h+=c),_&&(f+=u),m&&(h-=c),g&&(f-=u),/^(se|s|e)$/.test(s)?(a.size.width=h,a.size.height=f):/^(ne)$/.test(s)?(a.size.width=h,a.size.height=f,a.position.top=r.top-p):/^(sw)$/.test(s)?(a.size.width=h,a.size.height=f,a.position.left=r.left-d):((f-u<=0||h-c<=0)&&(t=a._getPaddingPlusBorderDimensions(this)),f-u>0?(a.size.height=f,a.position.top=r.top-p):(f=u-t.height,a.size.height=f,a.position.top=r.top+i.height-f),h-c>0?(a.size.width=h,a.position.left=r.left-d):(h=c-t.width,a.size.width=h,a.position.left=r.left+i.width-h))}}),e.ui.resizable,e.widget("ui.dialog",{version:"1.13.2",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var a=e(this).css(t).offset().top;a<0&&e(this).css("top",t.top-a)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&e.fn.draggable&&this._makeDraggable(),this.options.resizable&&e.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?e(t):this.document.find(t||"body").eq(0)},_destroy:function(){var e,t=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(e=t.parent.children().eq(t.index)).length&&e[0]!==this.element[0]?e.before(this.element):t.parent.append(this.element)},widget:function(){return this.uiDialog},disable:e.noop,enable:e.noop,close:function(t){var a=this;this._isOpen&&!1!==this._trigger("beforeClose",t)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||e.ui.safeBlur(e.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,(function(){a._trigger("close",t)})))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,a){var n=!1,o=this.uiDialog.siblings(".ui-front:visible").map((function(){return+e(this).css("z-index")})).get(),i=Math.max.apply(null,o);return i>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",i+1),n=!0),n&&!a&&this._trigger("focus",t),n},open:function(){var t=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=e(e.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,(function(){t._focusTabbable(),t._trigger("focus")})),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var e=this._focusedElement;e||(e=this.element.find("[autofocus]")),e.length||(e=this.element.find(":tabbable")),e.length||(e=this.uiDialogButtonPane.find(":tabbable")),e.length||(e=this.uiDialogTitlebarClose.filter(":tabbable")),e.length||(e=this.uiDialog),e.eq(0).trigger("focus")},_restoreTabbableFocus:function(){var t=e.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===t||e.contains(this.uiDialog[0],t)||this._focusTabbable()},_keepFocus:function(e){e.preventDefault(),this._restoreTabbableFocus(),this._delay(this._restoreTabbableFocus)},_createWrapper:function(){this.uiDialog=e("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===e.ui.keyCode.ESCAPE)return t.preventDefault(),void this.close(t);if(t.keyCode===e.ui.keyCode.TAB&&!t.isDefaultPrevented()){var a=this.uiDialog.find(":tabbable"),n=a.first(),o=a.last();t.target!==o[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==n[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay((function(){o.trigger("focus")})),t.preventDefault()):(this._delay((function(){n.trigger("focus")})),t.preventDefault())}},mousedown:function(e){this._moveToTop(e)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=e("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(t){e(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=e("<button type='button'></button>").button({label:e("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(e){e.preventDefault(),this.close(e)}}),t=e("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(t,"ui-dialog-title"),this._title(t),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(e){this.options.title?e.text(this.options.title):e.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=e("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=e("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var t=this,a=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),e.isEmptyObject(a)||Array.isArray(a)&&!a.length?this._removeClass(this.uiDialog,"ui-dialog-buttons"):(e.each(a,(function(a,n){var o,i;n="function"==typeof n?{click:n,text:a}:n,n=e.extend({type:"button"},n),o=n.click,i={icon:n.icon,iconPosition:n.iconPosition,showLabel:n.showLabel,icons:n.icons,text:n.text},delete n.click,delete n.icon,delete n.iconPosition,delete n.showLabel,delete n.icons,"boolean"==typeof n.text&&delete n.text,e("<button></button>",n).button(i).appendTo(t.uiButtonSet).on("click",(function(){o.apply(t.element[0],arguments)}))})),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){var t=this,a=this.options;function n(e){return{position:e.position,offset:e.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(a,o){t._addClass(e(this),"ui-dialog-dragging"),t._blockFrames(),t._trigger("dragStart",a,n(o))},drag:function(e,a){t._trigger("drag",e,n(a))},stop:function(o,i){var r=i.offset.left-t.document.scrollLeft(),s=i.offset.top-t.document.scrollTop();a.position={my:"left top",at:"left"+(r>=0?"+":"")+r+" top"+(s>=0?"+":"")+s,of:t.window},t._removeClass(e(this),"ui-dialog-dragging"),t._unblockFrames(),t._trigger("dragStop",o,n(i))}})},_makeResizable:function(){var t=this,a=this.options,n=a.resizable,o=this.uiDialog.css("position"),i="string"==typeof n?n:"n,e,s,w,se,sw,ne,nw";function r(e){return{originalPosition:e.originalPosition,originalSize:e.originalSize,position:e.position,size:e.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:a.maxWidth,maxHeight:a.maxHeight,minWidth:a.minWidth,minHeight:this._minHeight(),handles:i,start:function(a,n){t._addClass(e(this),"ui-dialog-resizing"),t._blockFrames(),t._trigger("resizeStart",a,r(n))},resize:function(e,a){t._trigger("resize",e,r(a))},stop:function(n,o){var i=t.uiDialog.offset(),s=i.left-t.document.scrollLeft(),l=i.top-t.document.scrollTop();a.height=t.uiDialog.height(),a.width=t.uiDialog.width(),a.position={my:"left top",at:"left"+(s>=0?"+":"")+s+" top"+(l>=0?"+":"")+l,of:t.window},t._removeClass(e(this),"ui-dialog-resizing"),t._unblockFrames(),t._trigger("resizeStop",n,r(o))}}).css("position",o)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=e(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),a=e.inArray(this,t);-1!==a&&t.splice(a,1)},_trackingInstances:function(){var e=this.document.data("ui-dialog-instances");return e||(e=[],this.document.data("ui-dialog-instances",e)),e},_minHeight:function(){var e=this.options;return"auto"===e.height?e.minHeight:Math.min(e.minHeight,e.height)},_position:function(){var e=this.uiDialog.is(":visible");e||this.uiDialog.show(),this.uiDialog.position(this.options.position),e||this.uiDialog.hide()},_setOptions:function(t){var a=this,n=!1,o={};e.each(t,(function(e,t){a._setOption(e,t),e in a.sizeRelatedOptions&&(n=!0),e in a.resizableRelatedOptions&&(o[e]=t)})),n&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",o)},_setOption:function(t,a){var n,o,i=this.uiDialog;"disabled"!==t&&(this._super(t,a),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:e("<a>").text(""+this.options.closeText).html()}),"draggable"===t&&((n=i.is(":data(ui-draggable)"))&&!a&&i.draggable("destroy"),!n&&a&&this._makeDraggable()),"position"===t&&this._position(),"resizable"===t&&((o=i.is(":data(ui-resizable)"))&&!a&&i.resizable("destroy"),o&&"string"==typeof a&&i.resizable("option","handles",a),o||!1===a||this._makeResizable()),"title"===t&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var e,t,a,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),n.minWidth>n.width&&(n.width=n.minWidth),e=this.uiDialog.css({height:"auto",width:n.width}).outerHeight(),t=Math.max(0,n.minHeight-e),a="number"==typeof n.maxHeight?Math.max(0,n.maxHeight-e):"none","auto"===n.height?this.element.css({minHeight:t,maxHeight:a,height:"auto"}):this.element.height(Math.max(0,n.height-e)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map((function(){var t=e(this);return e("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]}))},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!e(t.target).closest(".ui-dialog").length||!!e(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=e.fn.jquery.substring(0,4),a=!0;this._delay((function(){a=!1})),this.document.data("ui-dialog-overlays")||this.document.on("focusin.ui-dialog",function(e){if(!a){var n=this._trackingInstances()[0];n._allowInteraction(e)||(e.preventDefault(),n._focusTabbable(),"3.4."!==t&&"3.5."!==t||n._delay(n._restoreTabbableFocus))}}.bind(this)),this.overlay=e("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var e=this.document.data("ui-dialog-overlays")-1;e?this.document.data("ui-dialog-overlays",e):(this.document.off("focusin.ui-dialog"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!1!==e.uiBackCompat&&e.widget("ui.dialog",e.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(e,t){"dialogClass"===e&&this.uiDialog.removeClass(this.options.dialogClass).addClass(t),this._superApply(arguments)}}),e.ui.dialog,e.widget("ui.droppable",{version:"1.13.2",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,a=t.accept;this.isover=!1,this.isout=!0,this.accept="function"==typeof a?a:function(e){return e.is(a)},this.proportions=function(){if(!arguments.length)return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});e=arguments[0]},this._addToManager(t.scope),t.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){e.ui.ddmanager.droppables[t]=e.ui.ddmanager.droppables[t]||[],e.ui.ddmanager.droppables[t].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var t=e.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,a){if("accept"===t)this.accept="function"==typeof a?a:function(e){return e.is(a)};else if("scope"===t){var n=e.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(a)}this._super(t,a)},_activate:function(t){var a=e.ui.ddmanager.current;this._addActiveClass(),a&&this._trigger("activate",t,this.ui(a))},_deactivate:function(t){var a=e.ui.ddmanager.current;this._removeActiveClass(),a&&this._trigger("deactivate",t,this.ui(a))},_over:function(t){var a=e.ui.ddmanager.current;a&&(a.currentItem||a.element)[0]!==this.element[0]&&this.accept.call(this.element[0],a.currentItem||a.element)&&(this._addHoverClass(),this._trigger("over",t,this.ui(a)))},_out:function(t){var a=e.ui.ddmanager.current;a&&(a.currentItem||a.element)[0]!==this.element[0]&&this.accept.call(this.element[0],a.currentItem||a.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(a)))},_drop:function(t,a){var n=a||e.ui.ddmanager.current,o=!1;return!(!n||(n.currentItem||n.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var a=e(this).droppable("instance");if(a.options.greedy&&!a.options.disabled&&a.options.scope===n.options.scope&&a.accept.call(a.element[0],n.currentItem||n.element)&&e.ui.intersect(n,e.extend(a,{offset:a.element.offset()}),a.options.tolerance,t))return o=!0,!1})),!o&&!!this.accept.call(this.element[0],n.currentItem||n.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",t,this.ui(n)),this.element))},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),e.ui.intersect=function(){function e(e,t,a){return e>=t&&e<t+a}return function(t,a,n,o){if(!a.offset)return!1;var i=(t.positionAbs||t.position.absolute).left+t.margins.left,r=(t.positionAbs||t.position.absolute).top+t.margins.top,s=i+t.helperProportions.width,l=r+t.helperProportions.height,c=a.offset.left,u=a.offset.top,d=c+a.proportions().width,p=u+a.proportions().height;switch(n){case"fit":return c<=i&&s<=d&&u<=r&&l<=p;case"intersect":return c<i+t.helperProportions.width/2&&s-t.helperProportions.width/2<d&&u<r+t.helperProportions.height/2&&l-t.helperProportions.height/2<p;case"pointer":return e(o.pageY,u,a.proportions().height)&&e(o.pageX,c,a.proportions().width);case"touch":return(r>=u&&r<=p||l>=u&&l<=p||r<u&&l>p)&&(i>=c&&i<=d||s>=c&&s<=d||i<c&&s>d);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,a){var n,o,i=e.ui.ddmanager.droppables[t.options.scope]||[],r=a?a.type:null,s=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();e:for(n=0;n<i.length;n++)if(!(i[n].options.disabled||t&&!i[n].accept.call(i[n].element[0],t.currentItem||t.element))){for(o=0;o<s.length;o++)if(s[o]===i[n].element[0]){i[n].proportions().height=0;continue e}i[n].visible="none"!==i[n].element.css("display"),i[n].visible&&("mousedown"===r&&i[n]._activate.call(i[n],a),i[n].offset=i[n].element.offset(),i[n].proportions({width:i[n].element[0].offsetWidth,height:i[n].element[0].offsetHeight}))}},drop:function(t,a){var n=!1;return e.each((e.ui.ddmanager.droppables[t.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(t,this,this.options.tolerance,a)&&(n=this._drop.call(this,a)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,a)))})),n},dragStart:function(t,a){t.element.parentsUntil("body").on("scroll.droppable",(function(){t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,a)}))},drag:function(t,a){t.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(t,a),e.each(e.ui.ddmanager.droppables[t.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,o,i,r=e.ui.intersect(t,this,this.options.tolerance,a),s=!r&&this.isover?"isout":r&&!this.isover?"isover":null;s&&(this.options.greedy&&(o=this.options.scope,(i=this.element.parents(":data(ui-droppable)").filter((function(){return e(this).droppable("instance").options.scope===o}))).length&&((n=e(i[0]).droppable("instance")).greedyChild="isover"===s)),n&&"isover"===s&&(n.isover=!1,n.isout=!0,n._out.call(n,a)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,a),n&&"isout"===s&&(n.isout=!1,n.isover=!0,n._over.call(n,a)))}}))},dragStop:function(t,a){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||e.ui.ddmanager.prepareOffsets(t,a)}},!1!==e.uiBackCompat&&e.widget("ui.droppable",e.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),e.ui.droppable,e.widget("ui.progressbar",{version:"1.13.2",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=e("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(e){if(void 0===e)return this.options.value;this.options.value=this._constrainedValue(e),this._refreshValue()},_constrainedValue:function(e){return void 0===e&&(e=this.options.value),this.indeterminate=!1===e,"number"!=typeof e&&(e=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,e))},_setOptions:function(e){var t=e.value;delete e.value,this._super(e),this.options.value=this._constrainedValue(t),this._refreshValue()},_setOption:function(e,t){"max"===e&&(t=Math.max(this.min,t)),this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this.element.attr("aria-disabled",e),this._toggleClass(null,"ui-state-disabled",!!e)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,a=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).width(a.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,t===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=e("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),e.widget("ui.selectable",e.ui.mouse,{version:"1.13.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){t.elementPos=e(t.element[0]).offset(),t.selectees=e(t.options.filter,t.element[0]),t._addClass(t.selectees,"ui-selectee"),t.selectees.each((function(){var a=e(this),n=a.offset(),o={left:n.left-t.elementPos.left,top:n.top-t.elementPos.top};e.data(this,"selectable-item",{element:this,$element:a,left:o.left,top:o.top,right:o.left+a.outerWidth(),bottom:o.top+a.outerHeight(),startselected:!1,selected:a.hasClass("ui-selected"),selecting:a.hasClass("ui-selecting"),unselecting:a.hasClass("ui-unselecting")})}))},this.refresh(),this._mouseInit(),this.helper=e("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(t){var a=this,n=this.options;this.opos=[t.pageX,t.pageY],this.elementPos=e(this.element[0]).offset(),this.options.disabled||(this.selectees=e(n.filter,this.element[0]),this._trigger("start",t),e(n.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each((function(){var n=e.data(this,"selectable-item");n.startselected=!0,t.metaKey||t.ctrlKey||(a._removeClass(n.$element,"ui-selected"),n.selected=!1,a._addClass(n.$element,"ui-unselecting"),n.unselecting=!0,a._trigger("unselecting",t,{unselecting:n.element}))})),e(t.target).parents().addBack().each((function(){var n,o=e.data(this,"selectable-item");if(o)return n=!t.metaKey&&!t.ctrlKey||!o.$element.hasClass("ui-selected"),a._removeClass(o.$element,n?"ui-unselecting":"ui-selected")._addClass(o.$element,n?"ui-selecting":"ui-unselecting"),o.unselecting=!n,o.selecting=n,o.selected=n,n?a._trigger("selecting",t,{selecting:o.element}):a._trigger("unselecting",t,{unselecting:o.element}),!1})))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var a,n=this,o=this.options,i=this.opos[0],r=this.opos[1],s=t.pageX,l=t.pageY;return i>s&&(a=s,s=i,i=a),r>l&&(a=l,l=r,r=a),this.helper.css({left:i,top:r,width:s-i,height:l-r}),this.selectees.each((function(){var a=e.data(this,"selectable-item"),c=!1,u={};a&&a.element!==n.element[0]&&(u.left=a.left+n.elementPos.left,u.right=a.right+n.elementPos.left,u.top=a.top+n.elementPos.top,u.bottom=a.bottom+n.elementPos.top,"touch"===o.tolerance?c=!(u.left>s||u.right<i||u.top>l||u.bottom<r):"fit"===o.tolerance&&(c=u.left>i&&u.right<s&&u.top>r&&u.bottom<l),c?(a.selected&&(n._removeClass(a.$element,"ui-selected"),a.selected=!1),a.unselecting&&(n._removeClass(a.$element,"ui-unselecting"),a.unselecting=!1),a.selecting||(n._addClass(a.$element,"ui-selecting"),a.selecting=!0,n._trigger("selecting",t,{selecting:a.element}))):(a.selecting&&((t.metaKey||t.ctrlKey)&&a.startselected?(n._removeClass(a.$element,"ui-selecting"),a.selecting=!1,n._addClass(a.$element,"ui-selected"),a.selected=!0):(n._removeClass(a.$element,"ui-selecting"),a.selecting=!1,a.startselected&&(n._addClass(a.$element,"ui-unselecting"),a.unselecting=!0),n._trigger("unselecting",t,{unselecting:a.element}))),a.selected&&(t.metaKey||t.ctrlKey||a.startselected||(n._removeClass(a.$element,"ui-selected"),a.selected=!1,n._addClass(a.$element,"ui-unselecting"),a.unselecting=!0,n._trigger("unselecting",t,{unselecting:a.element})))))})),!1}},_mouseStop:function(t){var a=this;return this.dragged=!1,e(".ui-unselecting",this.element[0]).each((function(){var n=e.data(this,"selectable-item");a._removeClass(n.$element,"ui-unselecting"),n.unselecting=!1,n.startselected=!1,a._trigger("unselected",t,{unselected:n.element})})),e(".ui-selecting",this.element[0]).each((function(){var n=e.data(this,"selectable-item");a._removeClass(n.$element,"ui-selecting")._addClass(n.$element,"ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,a._trigger("selected",t,{selected:n.element})})),this._trigger("stop",t),this.helper.remove(),!1}}),e.widget("ui.selectmenu",[e.ui.formResetMixin,{version:"1.13.2",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=e()},_drawButton:function(){var t,a=this,n=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(e){this.button.trigger("focus"),e.preventDefault()}}),this.element.hide(),this.button=e("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),t=e("<span>").appendTo(this.button),this._addClass(t,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(n).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",(function(){a._rendered||a._refreshMenu()}))},_drawMenu:function(){var t=this;this.menu=e("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=e("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(e,a){e.preventDefault(),t._setSelection(),t._select(a.item.data("ui-selectmenu-item"),e)},focus:function(e,a){var n=a.item.data("ui-selectmenu-item");null!=t.focusIndex&&n.index!==t.focusIndex&&(t._trigger("focus",e,{item:n}),t.isOpen||t._select(n,e)),t.focusIndex=n.index,t.button.attr("aria-activedescendant",t.menuItems.eq(n.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var e,t=this.element.find("option");this.menu.empty(),this._parseOptions(t),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,t.length&&(e=this._getSelectedItem(),this.menuInstance.focus(null,e),this._setAria(e.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(e){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",e)))},_position:function(){this.menuWrap.position(e.extend({of:this.button},this.options.position))},close:function(e){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",e))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(t){var a=e("<span>");return this._setText(a,t.label),this._addClass(a,"ui-selectmenu-text"),a},_renderMenu:function(t,a){var n=this,o="";e.each(a,(function(a,i){var r;i.optgroup!==o&&(r=e("<li>",{text:i.optgroup}),n._addClass(r,"ui-selectmenu-optgroup","ui-menu-divider"+(i.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),r.appendTo(t),o=i.optgroup),n._renderItemData(t,i)}))},_renderItemData:function(e,t){return this._renderItem(e,t).data("ui-selectmenu-item",t)},_renderItem:function(t,a){var n=e("<li>"),o=e("<div>",{title:a.element.attr("title")});return a.disabled&&this._addClass(n,null,"ui-state-disabled"),this._setText(o,a.label),n.append(o).appendTo(t)},_setText:function(e,t){t?e.text(t):e.html("&#160;")},_move:function(e,t){var a,n,o=".ui-menu-item";this.isOpen?a=this.menuItems.eq(this.focusIndex).parent("li"):(a=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),o+=":not(.ui-state-disabled)"),(n="first"===e||"last"===e?a["first"===e?"prevAll":"nextAll"](o).eq(-1):a[e+"All"](o).eq(0)).length&&this.menuInstance.focus(t,n)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(e){this[this.isOpen?"close":"open"](e)},_setSelection:function(){var e;this.range&&(window.getSelection?((e=window.getSelection()).removeAllRanges(),e.addRange(this.range)):this.range.select(),this.button.trigger("focus"))},_documentClick:{mousedown:function(t){this.isOpen&&(e(t.target).closest(".ui-selectmenu-menu, #"+e.escapeSelector(this.ids.button)).length||this.close(t))}},_buttonEvents:{mousedown:function(){var e;window.getSelection?(e=window.getSelection()).rangeCount&&(this.range=e.getRangeAt(0)):this.range=document.selection.createRange()},click:function(e){this._setSelection(),this._toggle(e)},keydown:function(t){var a=!0;switch(t.keyCode){case e.ui.keyCode.TAB:case e.ui.keyCode.ESCAPE:this.close(t),a=!1;break;case e.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case e.ui.keyCode.UP:t.altKey?this._toggle(t):this._move("prev",t);break;case e.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case e.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case e.ui.keyCode.LEFT:this._move("prev",t);break;case e.ui.keyCode.RIGHT:this._move("next",t);break;case e.ui.keyCode.HOME:case e.ui.keyCode.PAGE_UP:this._move("first",t);break;case e.ui.keyCode.END:case e.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),a=!1}a&&t.preventDefault()}},_selectFocusedItem:function(e){var t=this.menuItems.eq(this.focusIndex).parent("li");t.hasClass("ui-state-disabled")||this._select(t.data("ui-selectmenu-item"),e)},_select:function(e,t){var a=this.element[0].selectedIndex;this.element[0].selectedIndex=e.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(e)),this._setAria(e),this._trigger("select",t,{item:e}),e.index!==a&&this._trigger("change",t,{item:e}),this.close(t)},_setAria:function(e){var t=this.menuItems.eq(e.index).attr("id");this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(e,t){if("icons"===e){var a=this.button.find("span.ui-icon");this._removeClass(a,null,this.options.icons.button)._addClass(a,null,t.button)}this._super(e,t),"appendTo"===e&&this.menuWrap.appendTo(this._appendTo()),"width"===e&&this._resizeButton()},_setOptionDisabled:function(e){this._super(e),this.menuInstance.option("disabled",e),this.button.attr("aria-disabled",e),this._toggleClass(this.button,null,"ui-state-disabled",e),this.element.prop("disabled",e),e?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?e(t):this.document.find(t).eq(0)),t&&t[0]||(t=this.element.closest(".ui-front, dialog")),t.length||(t=this.document[0].body),t},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var e=this.options.width;!1!==e?(null===e&&(e=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(e)):this.button.css("width","")},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var e=this._super();return e.disabled=this.element.prop("disabled"),e},_parseOptions:function(t){var a=this,n=[];t.each((function(t,o){o.hidden||n.push(a._parseOption(e(o),t))})),this.items=n},_parseOption:function(e,t){var a=e.parent("optgroup");return{element:e,index:t,value:e.val(),label:e.text(),optgroup:a.attr("label")||"",disabled:a.prop("disabled")||e.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),e.widget("ui.slider",e.ui.mouse,{version:"1.13.2",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,a,n=this.options,o=this.element.find(".ui-slider-handle"),i=[];for(a=n.values&&n.values.length||1,o.length>a&&(o.slice(a).remove(),o=o.slice(0,a)),t=o.length;t<a;t++)i.push("<span tabindex='0'></span>");this.handles=o.add(e(i.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each((function(t){e(this).data("ui-slider-handle-index",t).attr("tabIndex",0)}))},_createRange:function(){var t=this.options;t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:Array.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=e("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==t.range&&"max"!==t.range||this._addClass(this.range,"ui-slider-range-"+t.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(t){var a,n,o,i,r,s,l,c=this,u=this.options;return!u.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),a={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(a),o=this._valueMax()-this._valueMin()+1,this.handles.each((function(t){var a=Math.abs(n-c.values(t));(o>a||o===a&&(t===c._lastChangedValue||c.values(t)===u.min))&&(o=a,i=e(this),r=t)})),!1!==this._start(t,r)&&(this._mouseSliding=!0,this._handleIndex=r,this._addClass(i,null,"ui-state-active"),i.trigger("focus"),s=i.offset(),l=!e(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:t.pageX-s.left-i.width()/2,top:t.pageY-s.top-i.height()/2-(parseInt(i.css("borderTopWidth"),10)||0)-(parseInt(i.css("borderBottomWidth"),10)||0)+(parseInt(i.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,r,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(e){var t={x:e.pageX,y:e.pageY},a=this._normValueFromMouse(t);return this._slide(e,this._handleIndex,a),!1},_mouseStop:function(e){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(e,this._handleIndex),this._change(e,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(e){var t,a,n,o,i;return"horizontal"===this.orientation?(t=this.elementSize.width,a=e.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(t=this.elementSize.height,a=e.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(n=a/t)>1&&(n=1),n<0&&(n=0),"vertical"===this.orientation&&(n=1-n),o=this._valueMax()-this._valueMin(),i=this._valueMin()+n*o,this._trimAlignValue(i)},_uiHash:function(e,t,a){var n={handle:this.handles[e],handleIndex:e,value:void 0!==t?t:this.value()};return this._hasMultipleValues()&&(n.value=void 0!==t?t:this.values(e),n.values=a||this.values()),n},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(e,t){return this._trigger("start",e,this._uiHash(t))},_slide:function(e,t,a){var n,o=this.value(),i=this.values();this._hasMultipleValues()&&(n=this.values(t?0:1),o=this.values(t),2===this.options.values.length&&!0===this.options.range&&(a=0===t?Math.min(n,a):Math.max(n,a)),i[t]=a),a!==o&&!1!==this._trigger("slide",e,this._uiHash(t,a,i))&&(this._hasMultipleValues()?this.values(t,a):this.value(a))},_stop:function(e,t){this._trigger("stop",e,this._uiHash(t))},_change:function(e,t){this._keySliding||this._mouseSliding||(this._lastChangedValue=t,this._trigger("change",e,this._uiHash(t)))},value:function(e){return arguments.length?(this.options.value=this._trimAlignValue(e),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,t){var a,n,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(t),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!Array.isArray(arguments[0]))return this._hasMultipleValues()?this._values(e):this.value();for(a=this.options.values,n=arguments[0],o=0;o<a.length;o+=1)a[o]=this._trimAlignValue(n[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,t){var a,n=0;switch("range"===e&&!0===this.options.range&&("min"===t?(this.options.value=this._values(0),this.options.values=null):"max"===t&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),Array.isArray(this.options.values)&&(n=this.options.values.length),this._super(e,t),e){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(t),this.handles.css("horizontal"===t?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),a=n-1;a>=0;a--)this._change(null,a);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(e){this._super(e),this._toggleClass(null,"ui-state-disabled",!!e)},_value:function(){var e=this.options.value;return this._trimAlignValue(e)},_values:function(e){var t,a,n;if(arguments.length)return t=this.options.values[e],this._trimAlignValue(t);if(this._hasMultipleValues()){for(a=this.options.values.slice(),n=0;n<a.length;n+=1)a[n]=this._trimAlignValue(a[n]);return a}return[]},_trimAlignValue:function(e){if(e<=this._valueMin())return this._valueMin();if(e>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,a=(e-this._valueMin())%t,n=e-a;return 2*Math.abs(a)>=t&&(n+=a>0?t:-t),parseFloat(n.toFixed(5))},_calculateNewMax:function(){var e=this.options.max,t=this._valueMin(),a=this.options.step;(e=Math.round((e-t)/a)*a+t)>this.options.max&&(e-=a),this.max=parseFloat(e.toFixed(this._precision()))},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),a=t.indexOf(".");return-1===a?0:t.length-a-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(e){"vertical"===e&&this.range.css({width:"",left:""}),"horizontal"===e&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var t,a,n,o,i,r=this.options.range,s=this.options,l=this,c=!this._animateOff&&s.animate,u={};this._hasMultipleValues()?this.handles.each((function(n){a=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,u["horizontal"===l.orientation?"left":"bottom"]=a+"%",e(this).stop(1,1)[c?"animate":"css"](u,s.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[c?"animate":"css"]({left:a+"%"},s.animate),1===n&&l.range[c?"animate":"css"]({width:a-t+"%"},{queue:!1,duration:s.animate})):(0===n&&l.range.stop(1,1)[c?"animate":"css"]({bottom:a+"%"},s.animate),1===n&&l.range[c?"animate":"css"]({height:a-t+"%"},{queue:!1,duration:s.animate}))),t=a})):(n=this.value(),o=this._valueMin(),i=this._valueMax(),a=i!==o?(n-o)/(i-o)*100:0,u["horizontal"===this.orientation?"left":"bottom"]=a+"%",this.handle.stop(1,1)[c?"animate":"css"](u,s.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:a+"%"},s.animate),"max"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({width:100-a+"%"},s.animate),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:a+"%"},s.animate),"max"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[c?"animate":"css"]({height:100-a+"%"},s.animate))},_handleEvents:{keydown:function(t){var a,n,o,i=e(t.target).data("ui-slider-handle-index");switch(t.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(t.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(e(t.target),null,"ui-state-active"),!1===this._start(t,i)))return}switch(o=this.options.step,a=n=this._hasMultipleValues()?this.values(i):this.value(),t.keyCode){case e.ui.keyCode.HOME:n=this._valueMin();break;case e.ui.keyCode.END:n=this._valueMax();break;case e.ui.keyCode.PAGE_UP:n=this._trimAlignValue(a+(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(a-(this._valueMax()-this._valueMin())/this.numPages);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(a===this._valueMax())return;n=this._trimAlignValue(a+o);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(a===this._valueMin())return;n=this._trimAlignValue(a-o)}this._slide(t,i,n)},keyup:function(t){var a=e(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,a),this._change(t,a),this._removeClass(e(t.target),null,"ui-state-active"))}}}),e.widget("ui.sortable",e.ui.mouse,{version:"1.13.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(e,t,a){return e>=t&&e<t+a},_isFloating:function(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),e.each(this.items,(function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")}))},_destroy:function(){this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,a){var n=null,o=!1,i=this;return!(this.reverting||this.options.disabled||"static"===this.options.type||(this._refreshItems(t),e(t.target).parents().each((function(){if(e.data(this,i.widgetName+"-item")===i)return n=e(this),!1})),e.data(t.target,i.widgetName+"-item")===i&&(n=e(t.target)),!n||this.options.handle&&!a&&(e(this.options.handle,n).find("*").addBack().each((function(){this===t.target&&(o=!0)})),!o)||(this.currentItem=n,this._removeCurrentsFromItems(),0)))},_mouseStart:function(t,a,n){var o,i,r=this.options;if(this.currentContainer=this,this.refreshPositions(),this.appendTo=e("parent"!==r.appendTo?r.appendTo:this.currentItem.parent()),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),this.scrollParent=this.placeholder.scrollParent(),e.extend(this.offset,{parent:this._getParentOffset()}),r.containment&&this._setContainment(),r.cursor&&"auto"!==r.cursor&&(i=this.document.find("body"),this.storedCursor=i.css("cursor"),i.css("cursor",r.cursor),this.storedStylesheet=e("<style>*{ cursor: "+r.cursor+" !important; }</style>").appendTo(i)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",t,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset()),this.position=this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute"),this._mouseDrag(t),!0},_scroll:function(e){var t=this.options,a=!1;return this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<t.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+t.scrollSpeed:e.pageY-this.overflowOffset.top<t.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-t.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<t.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+t.scrollSpeed:e.pageX-this.overflowOffset.left<t.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-t.scrollSpeed)):(e.pageY-this.document.scrollTop()<t.scrollSensitivity?a=this.document.scrollTop(this.document.scrollTop()-t.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<t.scrollSensitivity&&(a=this.document.scrollTop(this.document.scrollTop()+t.scrollSpeed)),e.pageX-this.document.scrollLeft()<t.scrollSensitivity?a=this.document.scrollLeft(this.document.scrollLeft()-t.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<t.scrollSensitivity&&(a=this.document.scrollLeft(this.document.scrollLeft()+t.scrollSpeed))),a},_mouseDrag:function(t){var a,n,o,i,r=this.options;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),r.scroll&&!1!==this._scroll(t)&&(this._refreshItemPositions(!0),e.ui.ddmanager&&!r.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t)),this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()},a=this.items.length-1;a>=0;a--)if(o=(n=this.items[a]).item[0],(i=this._intersectsWithPointer(n))&&n.instance===this.currentContainer&&!(o===this.currentItem[0]||this.placeholder[1===i?"next":"prev"]()[0]===o||e.contains(this.placeholder[0],o)||"semi-dynamic"===this.options.type&&e.contains(this.element[0],o))){if(this.direction=1===i?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(t,n),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,a){if(t){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,t),this.options.revert){var n=this,o=this.placeholder.offset(),i=this.options.axis,r={};i&&"x"!==i||(r.left=o.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),i&&"y"!==i||(r.top=o.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,e(this.helper).animate(r,parseInt(this.options.revert,10)||500,(function(){n._clear(t)}))}else this._clear(t,a);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new e.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var a=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},e(a).each((function(){var a=(e(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);a&&n.push((t.key||a[1]+"[]")+"="+(t.key&&t.expression?a[1]:a[2]))})),!n.length&&t.key&&n.push(t.key+"="),n.join("&")},toArray:function(t){var a=this._getItemsAsjQuery(t&&t.connected),n=[];return t=t||{},a.each((function(){n.push(e(t.item||this).attr(t.attribute||"id")||"")})),n},_intersectsWith:function(e){var t=this.positionAbs.left,a=t+this.helperProportions.width,n=this.positionAbs.top,o=n+this.helperProportions.height,i=e.left,r=i+e.width,s=e.top,l=s+e.height,c=this.offset.click.top,u=this.offset.click.left,d="x"===this.options.axis||n+c>s&&n+c<l,p="y"===this.options.axis||t+u>i&&t+u<r,h=d&&p;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>e[this.floating?"width":"height"]?h:i<t+this.helperProportions.width/2&&a-this.helperProportions.width/2<r&&s<n+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(e){var t,a,n="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),o="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width);return!(!n||!o)&&(t=this.dragDirection.vertical,a=this.dragDirection.horizontal,this.floating?"right"===a||"down"===t?2:1:t&&("down"===t?2:1))},_intersectsWithSides:function(e){var t=this._isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),a=this._isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),n=this.dragDirection.vertical,o=this.dragDirection.horizontal;return this.floating&&o?"right"===o&&a||"left"===o&&!a:n&&("down"===n&&t||"up"===n&&!t)},_getDragVerticalDirection:function(){var e=this.positionAbs.top-this.lastPositionAbs.top;return 0!==e&&(e>0?"down":"up")},_getDragHorizontalDirection:function(){var e=this.positionAbs.left-this.lastPositionAbs.left;return 0!==e&&(e>0?"right":"left")},refresh:function(e){return this._refreshItems(e),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var e=this.options;return e.connectWith.constructor===String?[e.connectWith]:e.connectWith},_getItemsAsjQuery:function(t){var a,n,o,i,r=[],s=[],l=this._connectWith();if(l&&t)for(a=l.length-1;a>=0;a--)for(n=(o=e(l[a],this.document[0])).length-1;n>=0;n--)(i=e.data(o[n],this.widgetFullName))&&i!==this&&!i.options.disabled&&s.push(["function"==typeof i.options.items?i.options.items.call(i.element):e(i.options.items,i.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),i]);function c(){r.push(this)}for(s.push(["function"==typeof this.options.items?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),a=s.length-1;a>=0;a--)s[a][0].each(c);return e(r)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,(function(e){for(var a=0;a<t.length;a++)if(t[a]===e.item[0])return!1;return!0}))},_refreshItems:function(t){this.items=[],this.containers=[this];var a,n,o,i,r,s,l,c,u=this.items,d=[["function"==typeof this.options.items?this.options.items.call(this.element[0],t,{item:this.currentItem}):e(this.options.items,this.element),this]],p=this._connectWith();if(p&&this.ready)for(a=p.length-1;a>=0;a--)for(n=(o=e(p[a],this.document[0])).length-1;n>=0;n--)(i=e.data(o[n],this.widgetFullName))&&i!==this&&!i.options.disabled&&(d.push(["function"==typeof i.options.items?i.options.items.call(i.element[0],t,{item:this.currentItem}):e(i.options.items,i.element),i]),this.containers.push(i));for(a=d.length-1;a>=0;a--)for(r=d[a][1],n=0,c=(s=d[a][0]).length;n<c;n++)(l=e(s[n])).data(this.widgetName+"-item",r),u.push({item:l,instance:r,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(t){var a,n,o,i;for(a=this.items.length-1;a>=0;a--)n=this.items[a],this.currentContainer&&n.instance!==this.currentContainer&&n.item[0]!==this.currentItem[0]||(o=this.options.toleranceElement?e(this.options.toleranceElement,n.item):n.item,t||(n.width=o.outerWidth(),n.height=o.outerHeight()),i=o.offset(),n.left=i.left,n.top=i.top)},refreshPositions:function(e){var t,a;if(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),this._refreshItemPositions(e),this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(t=this.containers.length-1;t>=0;t--)a=this.containers[t].element.offset(),this.containers[t].containerCache.left=a.left,this.containers[t].containerCache.top=a.top,this.containers[t].containerCache.width=this.containers[t].element.outerWidth(),this.containers[t].containerCache.height=this.containers[t].element.outerHeight();return this},_createPlaceholder:function(t){var a,n,o=(t=t||this).options;o.placeholder&&o.placeholder.constructor!==String||(a=o.placeholder,n=t.currentItem[0].nodeName.toLowerCase(),o.placeholder={element:function(){var o=e("<"+n+">",t.document[0]);return t._addClass(o,"ui-sortable-placeholder",a||t.currentItem[0].className)._removeClass(o,"ui-sortable-helper"),"tbody"===n?t._createTrPlaceholder(t.currentItem.find("tr").eq(0),e("<tr>",t.document[0]).appendTo(o)):"tr"===n?t._createTrPlaceholder(t.currentItem,o):"img"===n&&o.attr("src",t.currentItem.attr("src")),a||o.css("visibility","hidden"),o},update:function(e,i){a&&!o.forcePlaceholderSize||(i.height()&&(!o.forcePlaceholderSize||"tbody"!==n&&"tr"!==n)||i.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}}),t.placeholder=e(o.placeholder.element.call(t.element,t.currentItem)),t.currentItem.after(t.placeholder),o.placeholder.update(t,t.placeholder)},_createTrPlaceholder:function(t,a){var n=this;t.children().each((function(){e("<td>&#160;</td>",n.document[0]).attr("colspan",e(this).attr("colspan")||1).appendTo(a)}))},_contactContainers:function(t){var a,n,o,i,r,s,l,c,u,d,p=null,h=null;for(a=this.containers.length-1;a>=0;a--)if(!e.contains(this.currentItem[0],this.containers[a].element[0]))if(this._intersectsWith(this.containers[a].containerCache)){if(p&&e.contains(this.containers[a].element[0],p.element[0]))continue;p=this.containers[a],h=a}else this.containers[a].containerCache.over&&(this.containers[a]._trigger("out",t,this._uiHash(this)),this.containers[a].containerCache.over=0);if(p)if(1===this.containers.length)this.containers[h].containerCache.over||(this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1);else{for(o=1e4,i=null,r=(u=p.floating||this._isFloating(this.currentItem))?"left":"top",s=u?"width":"height",d=u?"pageX":"pageY",n=this.items.length-1;n>=0;n--)e.contains(this.containers[h].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[r],c=!1,t[d]-l>this.items[n][s]/2&&(c=!0),Math.abs(t[d]-l)<o&&(o=Math.abs(t[d]-l),i=this.items[n],this.direction=c?"up":"down"));if(!i&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[h])return void(this.currentContainer.containerCache.over||(this.containers[h]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1));i?this._rearrange(t,i,null,!0):this._rearrange(t,null,this.containers[h].element,!0),this._trigger("change",t,this._uiHash()),this.containers[h]._trigger("change",t,this._uiHash(this)),this.currentContainer=this.containers[h],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this.containers[h]._trigger("over",t,this._uiHash(this)),this.containers[h].containerCache.over=1}},_createHelper:function(t){var a=this.options,n="function"==typeof a.helper?e(a.helper.apply(this.element[0],[t,this.currentItem])):"clone"===a.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||this.appendTo[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),n[0].style.width&&!a.forceHelperSize||n.width(this.currentItem.width()),n[0].style.height&&!a.forceHelperSize||n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),Array.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.currentItem.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,a,n,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===o.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===o.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(t=e(o.containment)[0],a=e(o.containment).offset(),n="hidden"!==e(t).css("overflow"),this.containment=[a.left+(parseInt(e(t).css("borderLeftWidth"),10)||0)+(parseInt(e(t).css("paddingLeft"),10)||0)-this.margins.left,a.top+(parseInt(e(t).css("borderTopWidth"),10)||0)+(parseInt(e(t).css("paddingTop"),10)||0)-this.margins.top,a.left+(n?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(e(t).css("borderLeftWidth"),10)||0)-(parseInt(e(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,a.top+(n?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(e(t).css("borderTopWidth"),10)||0)-(parseInt(e(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,a){a||(a=this.position);var n="absolute"===t?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(o[0].tagName);return{top:a.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:o.scrollTop())*n,left:a.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:o.scrollLeft())*n}},_generatePosition:function(t){var a,n,o=this.options,i=t.pageX,r=t.pageY,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(s[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(i=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(i=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),o.grid&&(a=this.originalPageY+Math.round((r-this.originalPageY)/o.grid[1])*o.grid[1],r=this.containment?a-this.offset.click.top>=this.containment[1]&&a-this.offset.click.top<=this.containment[3]?a:a-this.offset.click.top>=this.containment[1]?a-o.grid[1]:a+o.grid[1]:a,n=this.originalPageX+Math.round((i-this.originalPageX)/o.grid[0])*o.grid[0],i=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-o.grid[0]:n+o.grid[0]:n)),{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:s.scrollTop()),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:s.scrollLeft())}},_rearrange:function(e,t,a,n){a?a[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?t.item[0]:t.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay((function(){o===this.counter&&this.refreshPositions(!n)}))},_clear:function(e,t){this.reverting=!1;var a,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(a in this._storedCSS)"auto"!==this._storedCSS[a]&&"static"!==this._storedCSS[a]||(this._storedCSS[a]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();function o(e,t,a){return function(n){a._trigger(e,n,t._uiHash(t))}}for(this.fromOutside&&!t&&n.push((function(e){this._trigger("receive",e,this._uiHash(this.fromOutside))})),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||t||n.push((function(e){this._trigger("update",e,this._uiHash())})),this!==this.currentContainer&&(t||(n.push((function(e){this._trigger("remove",e,this._uiHash())})),n.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),a=this.containers.length-1;a>=0;a--)t||n.push(o("deactivate",this,this.containers[a])),this.containers[a].containerCache.over&&(n.push(o("out",this,this.containers[a])),this.containers[a].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,t||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!t){for(a=0;a<n.length;a++)n[a].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===e.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(t){var a=t||this;return{helper:a.helper,placeholder:a.placeholder||e([]),position:a.position,originalPosition:a.originalPosition,offset:a.positionAbs,item:a.currentItem,sender:t?t.element:null}}}),e.widget("ui.spinner",{version:"1.13.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t=this._super(),a=this.element;return e.each(["min","max","step"],(function(e,n){var o=a.attr(n);null!=o&&o.length&&(t[n]=o)})),t},_events:{keydown:function(e){this._start(e)&&this._keydown(e)&&e.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(e){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",e))},mousewheel:function(t,a){var n=e.ui.safeActiveElement(this.document[0]);if(this.element[0]===n&&a){if(!this.spinning&&!this._start(t))return!1;this._spin((a>0?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay((function(){this.spinning&&this._stop(t)}),100),t.preventDefault()}},"mousedown .ui-spinner-button":function(t){var a;function n(){this.element[0]===e.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=a,this._delay((function(){this.previous=a})))}a=this.element[0]===e.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),t.preventDefault(),n.call(this),this.cancelBlur=!0,this._delay((function(){delete this.cancelBlur,n.call(this)})),!1!==this._start(t)&&this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(e(t.currentTarget).hasClass("ui-state-active"))return!1!==this._start(t)&&void this._repeat(null,e(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(t){var a=this.options,n=e.ui.keyCode;switch(t.keyCode){case n.UP:return this._repeat(null,1,t),!0;case n.DOWN:return this._repeat(null,-1,t),!0;case n.PAGE_UP:return this._repeat(null,a.page,t),!0;case n.PAGE_DOWN:return this._repeat(null,-a.page,t),!0}return!1},_start:function(e){return!(!this.spinning&&!1===this._trigger("start",e)||(this.counter||(this.counter=1),this.spinning=!0,0))},_repeat:function(e,t,a){e=e||500,clearTimeout(this.timer),this.timer=this._delay((function(){this._repeat(40,t,a)}),e),this._spin(t*this.options.step,a)},_spin:function(e,t){var a=this.value()||0;this.counter||(this.counter=1),a=this._adjustValue(a+e*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",t,{value:a})||(this._value(a),this.counter++)},_increment:function(e){var t=this.options.incremental;return t?"function"==typeof t?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),a=t.indexOf(".");return-1===a?0:t.length-a-1},_adjustValue:function(e){var t,a,n=this.options;return a=e-(t=null!==n.min?n.min:0),e=t+(a=Math.round(a/n.step)*n.step),e=parseFloat(e.toFixed(this._precision())),null!==n.max&&e>n.max?n.max:null!==n.min&&e<n.min?n.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){var a,n,o;if("culture"===e||"numberFormat"===e)return a=this._parse(this.element.val()),this.options[e]=t,void this.element.val(this._format(a));"max"!==e&&"min"!==e&&"step"!==e||"string"==typeof t&&(t=this._parse(t)),"icons"===e&&(n=this.buttons.first().find(".ui-icon"),this._removeClass(n,null,this.options.icons.up),this._addClass(n,null,t.up),o=this.buttons.last().find(".ui-icon"),this._removeClass(o,null,this.options.icons.down),this._addClass(o,null,t.down)),this._super(e,t)},_setOptionDisabled:function(e){this._super(e),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!e),this.element.prop("disabled",!!e),this.buttons.button(e?"disable":"enable")},_setOptions:L((function(e){this._super(e)})),_parse:function(e){return"string"==typeof e&&""!==e&&(e=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(e,10,this.options.culture):+e),""===e||isNaN(e)?null:e},_format:function(e){return""===e?"":window.Globalize&&this.options.numberFormat?Globalize.format(e,this.options.numberFormat,this.options.culture):e},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var e=this.value();return null!==e&&e===this._adjustValue(e)},_value:function(e,t){var a;""!==e&&null!==(a=this._parse(e))&&(t||(a=this._adjustValue(a)),e=this._format(a)),this.element.val(e),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:L((function(e){this._stepUp(e)})),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:L((function(e){this._stepDown(e)})),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:L((function(e){this._stepUp((e||1)*this.options.page)})),pageDown:L((function(e){this._stepDown((e||1)*this.options.page)})),value:function(e){if(!arguments.length)return this._parse(this.element.val());L(this._value).call(this,e)},widget:function(){return this.uiSpinner}}),!1!==e.uiBackCompat&&e.widget("ui.spinner",e.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),e.ui.spinner,e.widget("ui.tabs",{version:"1.13.2",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(j=/#.*$/,function(e){var t,a;t=e.href.replace(j,""),a=location.href.replace(j,"");try{t=decodeURIComponent(t)}catch(e){}try{a=decodeURIComponent(a)}catch(e){}return e.hash.length>1&&t===a}),_create:function(){var t=this,a=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,a.collapsible),this._processTabs(),a.active=this._initialActive(),Array.isArray(a.disabled)&&(a.disabled=e.uniqueSort(a.disabled.concat(e.map(this.tabs.filter(".ui-state-disabled"),(function(e){return t.tabs.index(e)})))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(a.active):this.active=e(),this._refresh(),this.active.length&&this.load(a.active)},_initialActive:function(){var t=this.options.active,a=this.options.collapsible,n=location.hash.substring(1);return null===t&&(n&&this.tabs.each((function(a,o){if(e(o).attr("aria-controls")===n)return t=a,!1})),null===t&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==t&&-1!==t||(t=!!this.tabs.length&&0)),!1!==t&&-1===(t=this.tabs.index(this.tabs.eq(t)))&&(t=!a&&0),!a&&!1===t&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):e()}},_tabKeydown:function(t){var a=e(e.ui.safeActiveElement(this.document[0])).closest("li"),n=this.tabs.index(a),o=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:n++;break;case e.ui.keyCode.UP:case e.ui.keyCode.LEFT:o=!1,n--;break;case e.ui.keyCode.END:n=this.anchors.length-1;break;case e.ui.keyCode.HOME:n=0;break;case e.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n);case e.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}t.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,o),t.ctrlKey||t.metaKey||(a.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay((function(){this.option("active",n)}),this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===e.ui.keyCode.UP&&(t.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(t){return t.altKey&&t.keyCode===e.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===e.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,a){var n=this.tabs.length-1;for(;-1!==e.inArray((t>n&&(t=0),t<0&&(t=n),t),this.options.disabled);)t=a?t+1:t-1;return t},_focusNextTab:function(e,t){return e=this._findNextTab(e,t),this.tabs.eq(e).trigger("focus"),e},_setOption:function(e,t){"active"!==e?(this._super(e,t),"collapsible"===e&&(this._toggleClass("ui-tabs-collapsible",null,t),t||!1!==this.options.active||this._activate(0)),"event"===e&&this._setupEvents(t),"heightStyle"===e&&this._setupHeightStyle(t)):this._activate(t)},_sanitizeSelector:function(e){return e?e.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,a=this.tablist.children(":has(a[href])");t.disabled=e.map(a.filter(".ui-state-disabled"),(function(e){return a.index(e)})),this._processTabs(),!1!==t.active&&this.anchors.length?this.active.length&&!e.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=e()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=e()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this,a=this.tabs,n=this.anchors,o=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",(function(t){e(this).is(".ui-state-disabled")&&t.preventDefault()})).on("focus"+this.eventNamespace,".ui-tabs-anchor",(function(){e(this).closest("li").is(".ui-state-disabled")&&this.blur()})),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map((function(){return e("a",this)[0]})).attr({tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=e(),this.anchors.each((function(a,n){var o,i,r,s=e(n).uniqueId().attr("id"),l=e(n).closest("li"),c=l.attr("aria-controls");t._isLocal(n)?(r=(o=n.hash).substring(1),i=t.element.find(t._sanitizeSelector(o))):(o="#"+(r=l.attr("aria-controls")||e({}).uniqueId()[0].id),(i=t.element.find(o)).length||(i=t._createPanel(r)).insertAfter(t.panels[a-1]||t.tablist),i.attr("aria-live","polite")),i.length&&(t.panels=t.panels.add(i)),c&&l.data("ui-tabs-aria-controls",c),l.attr({"aria-controls":r,"aria-labelledby":s}),i.attr("aria-labelledby",s)})),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),a&&(this._off(a.not(this.tabs)),this._off(n.not(this.anchors)),this._off(o.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(t){return e("<div>").attr("id",t).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(t){var a,n,o;for(Array.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1),o=0;n=this.tabs[o];o++)a=e(n),!0===t||-1!==e.inArray(o,t)?(a.attr("aria-disabled","true"),this._addClass(a,null,"ui-state-disabled")):(a.removeAttr("aria-disabled"),this._removeClass(a,null,"ui-state-disabled"));this.options.disabled=t,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===t)},_setupEvents:function(t){var a={};t&&e.each(t.split(" "),(function(e,t){a[t]="_eventHandler"})),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(e){e.preventDefault()}}),this._on(this.anchors,a),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var a,n=this.element.parent();"fill"===t?(a=n.height(),a-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each((function(){var t=e(this),n=t.css("position");"absolute"!==n&&"fixed"!==n&&(a-=t.outerHeight(!0))})),this.element.children().not(this.panels).each((function(){a-=e(this).outerHeight(!0)})),this.panels.each((function(){e(this).height(Math.max(0,a-e(this).innerHeight()+e(this).height()))})).css("overflow","auto")):"auto"===t&&(a=0,this.panels.each((function(){a=Math.max(a,e(this).height("").height())})).height(a))},_eventHandler:function(t){var a=this.options,n=this.active,o=e(t.currentTarget).closest("li"),i=o[0]===n[0],r=i&&a.collapsible,s=r?e():this._getPanelForTab(o),l=n.length?this._getPanelForTab(n):e(),c={oldTab:n,oldPanel:l,newTab:r?e():o,newPanel:s};t.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||i&&!a.collapsible||!1===this._trigger("beforeActivate",t,c)||(a.active=!r&&this.tabs.index(o),this.active=i?e():o,this.xhr&&this.xhr.abort(),l.length||s.length||e.error("jQuery UI Tabs: Mismatching fragment identifier."),s.length&&this.load(this.tabs.index(o),t),this._toggle(t,c))},_toggle:function(t,a){var n=this,o=a.newPanel,i=a.oldPanel;function r(){n.running=!1,n._trigger("activate",t,a)}function s(){n._addClass(a.newTab.closest("li"),"ui-tabs-active","ui-state-active"),o.length&&n.options.show?n._show(o,n.options.show,r):(o.show(),r())}this.running=!0,i.length&&this.options.hide?this._hide(i,this.options.hide,(function(){n._removeClass(a.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),s()})):(this._removeClass(a.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),i.hide(),s()),i.attr("aria-hidden","true"),a.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),o.length&&i.length?a.oldTab.attr("tabIndex",-1):o.length&&this.tabs.filter((function(){return 0===e(this).attr("tabIndex")})).attr("tabIndex",-1),o.attr("aria-hidden","false"),a.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var a,n=this._findActive(t);n[0]!==this.active[0]&&(n.length||(n=this.active),a=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:a,currentTarget:a,preventDefault:e.noop}))},_findActive:function(t){return!1===t?e():this.tabs.eq(t)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+e.escapeSelector(t)+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each((function(){e.data(this,"ui-tabs-destroy")?e(this).remove():e(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")})),this.tabs.each((function(){var t=e(this),a=t.data("ui-tabs-aria-controls");a?t.attr("aria-controls",a).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")})),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(t){var a=this.options.disabled;!1!==a&&(void 0===t?a=!1:(t=this._getIndex(t),a=Array.isArray(a)?e.map(a,(function(e){return e!==t?e:null})):e.map(this.tabs,(function(e,a){return a!==t?a:null}))),this._setOptionDisabled(a))},disable:function(t){var a=this.options.disabled;if(!0!==a){if(void 0===t)a=!0;else{if(t=this._getIndex(t),-1!==e.inArray(t,a))return;a=Array.isArray(a)?e.merge([t],a).sort():[t]}this._setOptionDisabled(a)}},load:function(t,a){t=this._getIndex(t);var n=this,o=this.tabs.eq(t),i=o.find(".ui-tabs-anchor"),r=this._getPanelForTab(o),s={tab:o,panel:r},l=function(e,t){"abort"===t&&n.panels.stop(!1,!0),n._removeClass(o,"ui-tabs-loading"),r.removeAttr("aria-busy"),e===n.xhr&&delete n.xhr};this._isLocal(i[0])||(this.xhr=e.ajax(this._ajaxSettings(i,a,s)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(o,"ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.done((function(e,t,o){setTimeout((function(){r.html(e),n._trigger("load",a,s),l(o,t)}),1)})).fail((function(e,t){setTimeout((function(){l(e,t)}),1)}))))},_ajaxSettings:function(t,a,n){var o=this;return{url:t.attr("href").replace(/#.*$/,""),beforeSend:function(t,i){return o._trigger("beforeLoad",a,e.extend({jqXHR:t,ajaxSettings:i},n))}}},_getPanelForTab:function(t){var a=e(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+a))}}),!1!==e.uiBackCompat&&e.widget("ui.tabs",e.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),e.ui.tabs,e.widget("ui.tooltip",{version:"1.13.2",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var t=e(this).attr("title");return e("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(e,t){var a=(e.attr("aria-describedby")||"").split(/\s+/);a.push(t),e.data("ui-tooltip-id",t).attr("aria-describedby",String.prototype.trim.call(a.join(" ")))},_removeDescribedBy:function(t){var a=t.data("ui-tooltip-id"),n=(t.attr("aria-describedby")||"").split(/\s+/),o=e.inArray(a,n);-1!==o&&n.splice(o,1),t.removeData("ui-tooltip-id"),(n=String.prototype.trim.call(n.join(" ")))?t.attr("aria-describedby",n):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=e("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=e([])},_setOption:function(t,a){var n=this;this._super(t,a),"content"===t&&e.each(this.tooltips,(function(e,t){n._updateContent(t.element)}))},_setOptionDisabled:function(e){this[e?"_disable":"_enable"]()},_disable:function(){var t=this;e.each(this.tooltips,(function(a,n){var o=e.Event("blur");o.target=o.currentTarget=n.element[0],t.close(o,!0)})),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter((function(){var t=e(this);if(t.is("[title]"))return t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")})))},_enable:function(){this.disabledTitles.each((function(){var t=e(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})),this.disabledTitles=e([])},open:function(t){var a=this,n=e(t?t.target:this.element).closest(this.options.items);n.length&&!n.data("ui-tooltip-id")&&(n.attr("title")&&n.data("ui-tooltip-title",n.attr("title")),n.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&n.parents().each((function(){var t,n=e(this);n.data("ui-tooltip-open")&&((t=e.Event("blur")).target=t.currentTarget=this,a.close(t,!0)),n.attr("title")&&(n.uniqueId(),a.parents[this.id]={element:this,title:n.attr("title")},n.attr("title",""))})),this._registerCloseHandlers(t,n),this._updateContent(n,t))},_updateContent:function(e,t){var a,n=this.options.content,o=this,i=t?t.type:null;if("string"==typeof n||n.nodeType||n.jquery)return this._open(t,e,n);(a=n.call(e[0],(function(a){o._delay((function(){e.data("ui-tooltip-open")&&(t&&(t.type=i),this._open(t,e,a))}))})))&&this._open(t,e,a)},_open:function(t,a,n){var o,i,r,s,l=e.extend({},this.options.position);function c(e){l.of=e,i.is(":hidden")||i.position(l)}n&&((o=this._find(a))?o.tooltip.find(".ui-tooltip-content").html(n):(a.is("[title]")&&(t&&"mouseover"===t.type?a.attr("title",""):a.removeAttr("title")),o=this._tooltip(a),i=o.tooltip,this._addDescribedBy(a,i.attr("id")),i.find(".ui-tooltip-content").html(n),this.liveRegion.children().hide(),(s=e("<div>").html(i.find(".ui-tooltip-content").html())).removeAttr("name").find("[name]").removeAttr("name"),s.removeAttr("id").find("[id]").removeAttr("id"),s.appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:c}),c(t)):i.position(e.extend({of:a},this.options.position)),i.hide(),this._show(i,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(r=this.delayedShow=setInterval((function(){i.is(":visible")&&(c(l.of),clearInterval(r))}),13)),this._trigger("open",t,{tooltip:i})))},_registerCloseHandlers:function(t,a){var n={keyup:function(t){if(t.keyCode===e.ui.keyCode.ESCAPE){var n=e.Event(t);n.currentTarget=a[0],this.close(n,!0)}}};a[0]!==this.element[0]&&(n.remove=function(){var e=this._find(a);e&&this._removeTooltip(e.tooltip)}),t&&"mouseover"!==t.type||(n.mouseleave="close"),t&&"focusin"!==t.type||(n.focusout="close"),this._on(!0,a,n)},close:function(t){var a,n=this,o=e(t?t.currentTarget:this.element),i=this._find(o);i?(a=i.tooltip,i.closing||(clearInterval(this.delayedShow),o.data("ui-tooltip-title")&&!o.attr("title")&&o.attr("title",o.data("ui-tooltip-title")),this._removeDescribedBy(o),i.hiding=!0,a.stop(!0),this._hide(a,this.options.hide,(function(){n._removeTooltip(e(this))})),o.removeData("ui-tooltip-open"),this._off(o,"mouseleave focusout keyup"),o[0]!==this.element[0]&&this._off(o,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===t.type&&e.each(this.parents,(function(t,a){e(a.element).attr("title",a.title),delete n.parents[t]})),i.closing=!0,this._trigger("close",t,{tooltip:a}),i.hiding||(i.closing=!1))):o.removeData("ui-tooltip-open")},_tooltip:function(t){var a=e("<div>").attr("role","tooltip"),n=e("<div>").appendTo(a),o=a.uniqueId().attr("id");return this._addClass(n,"ui-tooltip-content"),this._addClass(a,"ui-tooltip","ui-widget ui-widget-content"),a.appendTo(this._appendTo(t)),this.tooltips[o]={element:t,tooltip:a}},_find:function(e){var t=e.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(e){clearInterval(this.delayedShow),e.remove(),delete this.tooltips[e.attr("id")]},_appendTo:function(e){var t=e.closest(".ui-front, dialog");return t.length||(t=this.document[0].body),t},_destroy:function(){var t=this;e.each(this.tooltips,(function(a,n){var o=e.Event("blur"),i=n.element;o.target=o.currentTarget=i[0],t.close(o,!0),e("#"+a).remove(),i.data("ui-tooltip-title")&&(i.attr("title")||i.attr("title",i.data("ui-tooltip-title")),i.removeData("ui-tooltip-title"))})),this.liveRegion.remove()}}),!1!==e.uiBackCompat&&e.widget("ui.tooltip",e.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var e=this._superApply(arguments);return this.options.tooltipClass&&e.tooltip.addClass(this.options.tooltipClass),e}}),e.ui.tooltip},void 0===(i=n.apply(t,o))||(e.exports=i)}()},c9983751f94ace4ce8a6:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.cell.Tablenode=n.shape.layout.FlexGridLayout.extend({NAME:"draw2d.shape.fishbone.cell.Tablenode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Tablenode</strong>}<br/><br/>",init:function(e,t,a,i){this._super(o.extend({columns:"grow",rows:"grow",bgColor:"#af81e7",stroke:1},e),t,a,i),this.setColor("#af81e7"),this.setStroke(2),this.setRadius(3),this.setResizeable(!0),this.site_code_col=new n.shape.layout.VerticalLayout,this.site_code_col.setStroke(0).setRadius(this.getRadius()).setResizeable(!0).setBackgroundColor("#f7f7f7"),this.site_code_title=new n.shape.basic.Label({text:"Site Code",resizeable:!0,stroke:0}).setBold(!0).setFontColor("#f7f7f7").setBackgroundColor("#af81e7").setFontFamily("Tahoma, Geneva"),this.site_code_col.add(this.site_code_title,new n.layout.locator.TopLocator),this.add(this.site_code_col,{row:0,col:0});var r=this;this.on("contextmenu",(function(e,t){o.contextMenu({selector:"body",events:{hide:function(){o.contextMenu("destroy")}},callback:o.proxy((function(e,t){"dropdown"===e&&setTimeout((function(){}),10)}),this),x:t.x,y:t.y,items:{dropdown:{name:"Dropdown"}}})})),this.setDimension(70,40),this.sites_list_in=[],null===this.getUserData()&&this.attr({userData:{hidden:!1,sites_list_out:[]}}),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Visible",default:!1},value:{type:"integer",title:"Current Value",default:0},sites_list_out:{type:"array",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},scope_id:{type:"string",title:"Site ID"}}}}},required:["hidden","value"]},this.GetHTTPData=function(){this.updateTable()},this.createPort("input",new n.layout.locator.TopLocator),this.createPort("output"),this.updateTable=function(){r.site_code_col.resetChildren(),r.site_code_col.add(r.site_code_title,new n.layout.locator.TopLocator),r.setHeight(0);var e=new n.shape.basic.Label({text:"",resizeable:!0,stroke:0}).setBold(!0).setFontColor("#af81e7").setFontFamily("Tahoma, Geneva").setBackgroundColor("#f7f7f7").setColor("#af81e7").setStroke(1).setRadius(r.getRadius());r.site_code_col.add(e,new n.layout.locator.TopLocator);var t="";r.userData.sites_list_out.forEach((function(e,a){t=t+e.site_code+"\n"})),e.setText(t),r.getPort("output0").setUserData({project:r.project,scope:r.scope,sites_list_out:r.userData.sites_list_out}),r.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(Math.random()),t.setColor(r.getBackgroundColor())}),this))};var s=this.getPort("input0");s.on("connect",(function(e,t){t.connection.sourcePort.userData.sites_list_out.forEach((function(e,t){r.userData.sites_list_out.push(e)})),r.project=t.connection.sourcePort.getUserData().project,r.scope=t.connection.sourcePort.getUserData().scope,r.sop=t.connection.sourcePort.getUserData().sop,r.updateTable()})),s.on("disconnect",(function(e,t){t.connection.sourcePort.userData.sites_list_out.forEach((function(e,t){r.userData.sites_list_out.indexOf(e)>-1&&r.userData.sites_list_out.splice(r.userData.sites_list_out.indexOf(e),1)})),r.site_code_col.resetChildren(),r.site_code_col.add(r.site_code_title,new n.layout.locator.TopLocator),r.updateTable(),r.setHeight(40)}))},onPortValueChanged:function(e){if("input0"==e.name){var t=this.getInputPort(0).getConnections(),a=this;this.userData.sites_list_out=[],t.data.forEach((function(e,t){e.sourcePort.userData.sites_list_out.forEach((function(e,t){a.userData.sites_list_out.push(e)}))})),a.updateTable()}},onTimer:function(){}})},cbb7090f77d30655a5a6:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.cell.ReportInfonode=n.shape.fishbone.cell.Cellnode.extend({NAME:"draw2d.shape.fishbone.cell.ReportInfonode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.ReportInfonode</strong>}<br/><br/> Provides current user information.",init:function(e,t,a,i){this._super(o.extend({color:"#777777",filter_str:"info"},e),t,a,i),this.updateTickets=0;var r=this;o.extend(this.userData,{info:{},label:"Report Info",type_name:"info"}),o.extend(!0,this.treema_scheme,{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{info:{type:"object",title:"User",properties:{user_id:{type:"string",title:"User ID"}}},label:{type:"string",format:"hidden",default:"Report Info"},type_name:{type:"string",title:"Type Name",default:"user"}}}),this.updateTable=function(){console.log("info updateTable"),r.startTimer(),r.userData.value=1,r.userData.info.user_id=i.username,r.getPort("output0").setUserData({project:r.project,scope:r.scope,sop:r.sop,info:{user_id:i.username},item_name:r.userData.label,task_type:r.userData.type_name||"info",sites_list_out:[]}),r.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(r.getId()),t.setColor(r.frame.attr("stroke"))}),this)),this.updateUI(),r.stopTimer()},this.GetHTTPData=function(){this.updateTable()};var s=new n.DataInputPort;s.setConnectionDirection(3),s.setName("dataInput"),this.addPort(s),this.createPort("output"),this.layoutPorts(),this.getRealCount=function(){return 1}},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText("Report Info"),this._super(this)},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each(o.proxy((function(e,a){var n=a.getTarget();n.userData||(n.userData={}),n.userData.realCount=t.getRealCount(),n.setValue("ticket,"+t.id+","+t.userData.label),t.getCanvas().silentMode||a.setColor("#dfdfdf")}),this))}));else if("dataInput"===e.name){var a=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=a.getUserData().sites_list_out,t.getCanvas().silentMode||this.val_label.setText("."),this.GetHTTPData()}}})},ce777105db143ffb6980:(__unused_webpack_module,__unused_webpack_exports,__webpack_require__)=>{var draw2d=__webpack_require__("8a868d10b6533e768658"),$=__webpack_require__("a45670b3d8fb79ec0258"),Globals=__webpack_require__("aeb57e88bcb04c329061"),settings=__webpack_require__("6fe5e339b0f8a936ba8c"),Utils=__webpack_require__("8deafab7866a125bb9ca"),jQuery=__webpack_require__("a45670b3d8fb79ec0258"),moment=__webpack_require__("a7583c9a3ff76b2fdd52"),ucharts=__webpack_require__("1f44d888ec90c0bf8262");function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperty(e,t,a){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var n=a.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}draw2d.shape.fishbone.ra.RaDataNode=draw2d.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaDataNode",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaDataNode</strong>}<br/><br/>",init:function(e,t,a){this._super($.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var n=this,o=new draw2d.DataInputPort,i=new draw2d.layout.locator.LeftLocator;o.setConnectionDirection(3),o.setName("dataInput"),this.addPort(o,i),this.createPort("output"),this.layoutPorts(),this.sites_list_in=[];var r=this.getUserData(),s=new Date;function l(e){var t;switch(e){case"custom":t={logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"};break;case"till Today":t={logic:"",preset:"till Today",prop:"self",sign:"",value:"till Today"};break;case"not Empty":t={logic:"",preset:"not Empty",prop:"self",sign:"not equal",value:"empty"};break;case"Empty":t={logic:"",preset:"Empty",prop:"self",sign:"equal",value:"empty"};break;case"EOM":t={logic:"",preset:"EOM",prop:"self",sign:"",value:"before end of month"};break;case"EOW":t={logic:"",preset:"EOW",prop:"self",sign:"",value:"before end of month"};break;case"EOT":t={logic:"",preset:"EOT",prop:"self",sign:"",value:"before end of month"};break;case"this Year":t={logic:"",preset:"this Year",prop:"self",sign:"",value:"this Year"};break;case"this Month":t={logic:"",preset:"this Month",prop:"self",sign:"",value:"this Month"};break;case"this Week":t={logic:"",preset:"this Week",prop:"self",sign:"",value:"this Week"};break;case"Today":t={logic:"",preset:"Today",prop:"self",sign:"",value:"Today"};break;case"last Year":t={logic:"",preset:"last Year",prop:"self",sign:"",value:"last Year"};break;case"last Month":t={logic:"",preset:"last Month",prop:"self",sign:"",value:"last Month"};break;case"last Week":t={logic:"",preset:"last Week",prop:"self",sign:"",value:"last Week"};break;case"Yesterday":t={logic:"",preset:"Yesterday",prop:"self",sign:"",value:"Yesterday"};break;case"next Year":t={logic:"",preset:"next Year",prop:"self",sign:"",value:"next Year"};break;case"next Month":t={logic:"",preset:"next Month",prop:"self",sign:"",value:"next Month"};break;case"next Week":t={logic:"",preset:"next Week",prop:"self",sign:"",value:"next Week"};break;case"last 30 days":t={logic:"",preset:"last 30 days",prop:"self",sign:"",value:"last 30 days"};break;case"previous 30 days":t={logic:"",preset:"previous 30 days",prop:"self",sign:"",value:"previous 30 days"};break;case"last 7 days":t={logic:"",preset:"last 7 days",prop:"self",sign:"",value:"last 7 days"};break;case"previous 7 days":t={logic:"",preset:"previous 7 days",prop:"self",sign:"",value:"previous 7 days"}}return t}function c(e,t){if("real time"===e.data_type||void 0===e.data_type){var a,o,i=settings.context+"/data/MLPerSite",r=settings.context+"/data/MLPerSiteMulti_10",s=settings.context+"/data/MLPerSiteMultiLogic_10";if(""!=n.userData.actual.task.scope_task_id&&null!=n.userData.actual.task.scope_task_id||""!=n.userData.actual.multy_milestones[0].scope_task_id&&null!=n.userData.actual.multy_milestones[0].scope_task_id){var l;if(void 0===n.userData.actual.count_type||"physical"===n.userData.actual.count_type)if(n.userData.actual.multy_milestone){var c=void 0!==n.userData.actual.multy_milestones[0]?n.userData.actual.multy_milestones[0].scope_task_id:"",d=void 0!==n.userData.actual.multy_milestones[1]?n.userData.actual.multy_milestones[1].scope_task_id:"",p=void 0!==n.userData.actual.multy_milestones[2]?n.userData.actual.multy_milestones[2].scope_task_id:"",h=void 0!==n.userData.actual.multy_milestones[3]?n.userData.actual.multy_milestones[3].scope_task_id:"",f=void 0!==n.userData.actual.multy_milestones[4]?n.userData.actual.multy_milestones[4].scope_task_id:"",m=void 0!==n.userData.actual.multy_milestones[5]?n.userData.actual.multy_milestones[5].scope_task_id:"",g=void 0!==n.userData.actual.multy_milestones[6]?n.userData.actual.multy_milestones[6].scope_task_id:"",y=void 0!==n.userData.actual.multy_milestones[7]?n.userData.actual.multy_milestones[7].scope_task_id:"",_=void 0!==n.userData.actual.multy_milestones[8]?n.userData.actual.multy_milestones[8].scope_task_id:"",b=void 0!==n.userData.actual.multy_milestones[9]?n.userData.actual.multy_milestones[9].scope_task_id:"";l=""!==e.label?e.label:n.userData.actual.multy_milestones[0].scope_task_name,e.config?(a=e.config.field_name?e.config.field_name:"",o=e.config.array?JSON.stringify(e.config.array):""):(a="",o="");var v=r+"?&val1="+c+"&val2="+d+"&val3="+p+"&val4="+h+"&val5="+f+"&val6="+m+"&val7="+g+"&val8="+y+"&val9="+_+"&val10="+b+"&task_type="+e.task_type+"&col_name="+l+"&config="+a+"&array="+o}else l=""!==e.label?e.label:n.userData.actual.task.scope_task_name,v=i+"?&task_id="+n.userData.actual.task.scope_task_id+"&task_type="+e.task_type+"&col_name="+l;else"logical"===n.userData.actual.count_type&&n.userData.actual.multy_milestone&&(c=void 0!==n.userData.actual.multy_milestones[0]?n.userData.actual.multy_milestones[0].scope_task_id:"",d=void 0!==n.userData.actual.multy_milestones[1]?n.userData.actual.multy_milestones[1].scope_task_id:"",p=void 0!==n.userData.actual.multy_milestones[2]?n.userData.actual.multy_milestones[2].scope_task_id:"",h=void 0!==n.userData.actual.multy_milestones[3]?n.userData.actual.multy_milestones[3].scope_task_id:"",f=void 0!==n.userData.actual.multy_milestones[4]?n.userData.actual.multy_milestones[4].scope_task_id:"",m=void 0!==n.userData.actual.multy_milestones[5]?n.userData.actual.multy_milestones[5].scope_task_id:"",g=void 0!==n.userData.actual.multy_milestones[6]?n.userData.actual.multy_milestones[6].scope_task_id:"",y=void 0!==n.userData.actual.multy_milestones[7]?n.userData.actual.multy_milestones[7].scope_task_id:"",_=void 0!==n.userData.actual.multy_milestones[8]?n.userData.actual.multy_milestones[8].scope_task_id:"",b=void 0!==n.userData.actual.multy_milestones[9]?n.userData.actual.multy_milestones[9].scope_task_id:"",l=""!==e.label?e.label:n.userData.actual.multy_milestones[0].scope_task_name,e.config?(a=e.config.field_name?e.config.field_name:"",o=e.config.array?JSON.stringify(e.config.array):""):(a="",o=""),v=s+"?&val1="+c+"&val2="+d+"&val3="+p+"&val4="+h+"&val5="+f+"&val6="+m+"&val7="+g+"&val8="+y+"&val9="+_+"&val10="+b+"&task_type="+e.task_type+"&col_name="+l+"&config="+a+"&array="+o);var w=JSON.stringify(n.sites_list_in);n["xhr"+e.task_type+n.id]&&4!==n["xhr"+e.task_type+n.id].readyState&&n["xhr"+e.task_type+n.id].abort(),n["xhr"+e.task_type+n.id]=$.ajax({url:v,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:w,success:function(a){a.length>0&&a.forEach((function(t,a){null!=t.my_date&&(t.my_date=new Date(t.my_date)),t.task_name=l,t.task_type=e.task_type}));var o=Utils.getFormula(e,a);e.value=o.length,e.sites_list_out=o;var i=-1;n.userData.col.forEach((function(t,a){t.task_type===e.task_type&&(i=a)}));var r;r=void 0!==n.userData.col[i]?jQuery.extend(!0,{},n.userData.col[i].serie):{name:e.task_type,type:"line",areaStyle:{normal:{},show:!0},barWidth:10,data:[]};var s={task_type:e.task_type,sites_list_out:o};s.serie=r,s.owner_id="self",i>-1?n.userData.col[i]=s:n.userData.col.push(s),"actual"===e.task_type&&(n.getPort("output0").setUserData({project:n.project,scope:n.scope,item_name:l,task_type:e.task_type,sites_list_out:o}),n.getOutputPort(0).getConnections().each($.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor(n.getColor())}),this))),u(e),t()}})}}else if("fixed month"===e.data_type){if(e.fixed_data.length>0){l=""!==e.label&&void 0!==e.label?e.label:n.userData.actual.multy_milestone?n.userData.actual.multy_milestones[0].scope_task_name:n.userData.actual.task.scope_task_name;var x=[];e.fixed_data.forEach((function(t,a){new Date(t.year,Globals.months.indexOf(t.month),1,8,0,0,0);var n=Utils.daysInMonth(Globals.months.indexOf(t.month)+1,t.year),o=Math.floor(t.value/n),i=[];if(o>=1){for(var r=1;r<=n;r++)i.push({value:o});for(var s=t.value-o*n,c=0;c<s;c++)i[c].value=i[c].value+1}else{var u=Math.floor(n/t.value),d=0,p=1;for(r=1;r<=n;r++)p>u?(p=1,d++,i.push({value:1})):(p++,i.push({value:0}));for(s=t.value-d,c=0;c<s;c++)0===i[c].value?i[c].value=i[c].value+1:s++}i.forEach((function(a,n){for(var o=0;o<a.value;o++)x.push({my_date:new Date(t.year,Globals.months.indexOf(t.month),n+1,8,0,0,0),site_code:"dummy",site_id:"dummy",task_name:l,task_type:e.task_type})}))})),e.value=x.length,e.sites_list_out=x;var k=-1;n.userData.col.forEach((function(t,a){t.task_type===e.task_type&&(k=a)}));var D={};D=void 0!==n.userData.col[k]?jQuery.extend(!0,{},n.userData.col[k].serie):{name:e.task_type,type:"line",areaStyle:{normal:{},show:!0},barWidth:10,data:[]},(S={task_type:e.task_type,sites_list_out:x}).serie=D,S.owner_id="self",k>-1?n.userData.col[k]=S:n.userData.col.push(S),"actual"===e.task_type&&(n.getPort("output0").setUserData({project:n.project,scope:n.scope,item_name:l,task_type:e.task_type,sites_list_out:x}),n.getOutputPort(0).getConnections().each($.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor(n.getColor())}),this))),u(e),t()}}else if("fixed week"===e.data_type&&e.fixed_data.length>0){var S;l=""!==e.label?e.label:e.multy_milestone?e.multy_milestones[0].scope_task_name:e.task.scope_task_name,x=[],e.fixed_data.forEach((function(t,a){moment(t.year+"-"+t.week,"YYYY-W WW");var n=Math.floor(t.value/7),o=[];if(n>=1){for(var i=1;i<=7;i++)o.push({value:n});for(var r=t.value-7*n,s=0;s<r;s++)o[s].value=o[s].value+1}else{var c=Math.floor(7/t.value),u=0,d=1;for(i=1;i<=7;i++)d>c?(d=1,u++,o.push({value:1})):(d++,o.push({value:0}));for(r=t.value-u,s=0;s<r;s++)0===o[s].value?o[s].value=o[s].value+1:r++}o.forEach((function(a,n){for(var o=0;o<a.value;o++){var i=n+1,r=t.year+Utils.zeroPadl(t.week)+i;x.push({my_date:moment(r,"YYYYWWE").toDate(),site_code:"dummy",site_id:"dummy",task_name:l,task_type:e.task_type})}}))})),e.value=x.length,e.sites_list_out=x,k=-1,n.userData.col.forEach((function(t,a){t.task_type===e.task_type&&(k=a)})),D={},D=void 0!==n.userData.col[k]?jQuery.extend(!0,{},n.userData.col[k].serie):{name:e.task_type,type:"line",areaStyle:{normal:{},show:!0},barWidth:10,data:[]},(S={task_type:e.task_type,sites_list_out:x}).serie=D,S.owner_id="self",k>-1?n.userData.col[k]=S:n.userData.col.push(S),"actual"===e.task_type&&(n.getPort("output0").setUserData({project:n.project,scope:n.scope,item_name:l,task_type:e.task_type,sites_list_out:x}),n.getOutputPort(0).getConnections().each($.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor(n.getColor())}),this))),u(e),t()}}function u(e){if("actual"===e.task_type){n.options.ml_data.actual.label=n.userData.actual.label,n.options.ml_data.actual.value=n.userData.actual.value,n.options.ml_data.actual.info=[];var t=n.getPort("output0");n.userData.actual.info&&n.userData.actual.info.length&&n.userData.actual.info.forEach((function(e,a){if("this Month"===e){var o=Utils.getFormula({conditions:[l(e)]},t.userData.sites_list_out),i=Utils.getFormula({conditions:[l("last 30 days")]},t.userData.sites_list_out),r=Utils.getFormula({conditions:[l("previous 30 days")]},t.userData.sites_list_out),s=0;isNaN(i.length/r.length)||isNaN(r.length/i.length)||i.length/r.length===1/0||r.length/i.length===1/0||r.length/i.length>3||i.length/r.length>3?n.options.ml_data.actual.info.push({label:e,value:o.length}):(s=i.length>=r.length?"+"+Math.round(100*(i.length/r.length-1)):"-"+Math.round(100*(r.length/i.length-1)),n.options.ml_data.actual.info.push({label:e,value:o.length,addvalue:s,addlabel:"last vs prev 30d"}))}else"this Week"===e?(o=Utils.getFormula({conditions:[l(e)]},t.userData.sites_list_out),i=Utils.getFormula({conditions:[l("last 7 days")]},t.userData.sites_list_out),r=Utils.getFormula({conditions:[l("previous 7 days")]},t.userData.sites_list_out),s=0,isNaN(i.length/r.length)||isNaN(r.length/i.length)||i.length/r.length===1/0||r.length/i.length===1/0||r.length/i.length>3||i.length/r.length>3?n.options.ml_data.actual.info.push({label:e,value:o.length}):(s=i.length>=r.length?"+"+Math.round(100*(i.length/r.length-1)):"-"+Math.round(100*(r.length/i.length-1)),n.options.ml_data.actual.info.push({label:e,value:o.length,addvalue:s,addlabel:"last vs prev 7d"}))):(o=Utils.getFormula({conditions:[l(e)]},t.userData.sites_list_out),n.options.ml_data.actual.info.push({label:e,value:o.length}))}))}else"forecast"===e.task_type?(n.options.ml_data.forecast.label=n.userData.forecast.label,n.options.ml_data.forecast.value=n.userData.forecast.value,n.options.ml_data.forecast.info=[],t=n.getPort("output0"),n.userData.forecast.info&&n.userData.forecast.info.length&&n.userData.forecast.info.forEach((function(t,a){var o=Utils.getFormula({conditions:[l(t)]},e.sites_list_out);n.options.ml_data.forecast.info.push({label:t,value:o.length})}))):"baseline"===e.task_type&&(n.options.ml_data.baseline.label=n.userData.baseline.label,n.options.ml_data.baseline.value=n.userData.baseline.value,n.options.ml_data.baseline.info=[],t=n.getPort("output0"),n.userData.baseline.info&&n.userData.baseline.info.length&&n.userData.baseline.info.forEach((function(t,a){var o=Utils.getFormula({conditions:[l(t)]},e.sites_list_out);n.options.ml_data.baseline.info.push({label:t,value:o.length})})))}this.default_user_data={hidden:!1,autoWidth:!1,index:0,toolbar:$.extend(!0,{},default_toolbar),title:$.extend(!0,{},default_title),title_left:$.extend(!0,{},default_title_left),title_right:$.extend(!0,{},default_title_right),data_table:$.extend(!0,{},default_data_table),xAxis:$.extend(!0,{},default_xAxis),yAxis:$.extend(!0,{},default_yAxis),start_date:new Date(s.getFullYear(),0,1).toLocaleDateString(),trend:"accumulative",period:"monthly",showInConnections:!0,showOutConnections:!0,showProgress:!0,size:{width:800,height:450},grid:$.extend(!0,{},$.extend(!0,default_grid,{top_m:120})),view:$.extend(!0,{},default_view),col:[],baseline:{task_type:"baseline",count_type:"physical",show:!0,data_type:"real time",fixed_data:[],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}]},forecast:{task_type:"forecast",count_type:"physical",show:!0,data_type:"real time",fixed_data:[],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}]},actual:{task_type:"actual",data_type:"real time",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],value:0,fixed_data:[],label:"",text_color:"#838383",font_size:18,sites_list_out:[],info:[]}},this.default_user_data.toolbar.buttons[0].show=!1,this.default_user_data.toolbar.buttons[1].show=!1,this.default_user_data.toolbar.buttons[2].show=!1,this.default_user_data.toolbar.buttons[3].show=!1,this.default_user_data.toolbar.buttons[4].show=!1,this.default_user_data.toolbar.buttons.push({show:!0,name:"accumulative",icon:"data:image/png;base64,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",onclick:function(){n.userData.trend="accumulative",n.userData.title_left.label="accumulative",n.options&&(n.options.series=[]),n.uChart=null,n.updateTable()}}),this.default_user_data.toolbar.buttons.push({show:!0,name:"incremental",icon:"data:image/png;base64,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",onclick:function(){n.userData.trend="incremental",n.userData.title_left.label="incremental",n.options&&(n.options.series=[]),n.uChart=null,n.updateTable()}}),this.default_user_data.toolbar.buttons.push({show:!0,name:"monthly",icon:"data:image/png;base64,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",onclick:function(){n.userData.period="monthly",n.userData.title_right.label="monthly",n.options&&(n.options.series=[]),n.uChart=null,n.updateTable()}}),this.default_user_data.toolbar.buttons.push({show:!0,name:"weekly",icon:"data:image/png;base64,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",onclick:function(){n.userData.period="weekly",n.userData.title_right.label="weekly",n.options&&(n.options.series=[]),n.uChart=null,n.updateTable()}}),this.default_user_data.toolbar.buttons.push({show:!0,name:"daily",icon:"data:image/png;base64,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",onclick:function(){n.userData.period="daily",n.userData.title_right.label="daily",n.options&&(n.options.series=[]),n.uChart=null,n.updateTable()}}),null===r&&(this.attr({userData:$.extend(!0,{},this.default_user_data)}),this.userData.actual.info=["this Week","this Month","Yesterday","Today"]),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},toolbar:template_toolbar,popup:template_popup,title:template_title,title_left:template_title_left,title_right:template_title_right,size:{type:"object",title:"Size",properties:{width:{type:"integer",default:800},height:{type:"integer",default:350}}},grid:template_grid,data_table:template_data_table,xAxis:template_xAxis,yAxis:template_yAxis,view:template_view,start_date:{type:"string",title:"Start Date",format:"date",default:""},end_date:{type:"string",title:"End Date",format:"date",default:""},trend:{type:"string",title:"Trend",default:"accumulative",enum:["accumulative","incremental"]},period:{type:"string",title:"Period",default:"monthly",enum:["monthly","weekly","daily"]},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showProgress:{type:"boolean",title:"Show Progress",default:!0},showToday:{type:"boolean",title:"Position on Today",default:!0},hide_future:{type:"boolean",title:"Break Lines in Future",default:!0},value:{type:"integer",title:"Current Value",default:0},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},serie:template_serie,sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}}},baseline:{type:"object",title:"Baseline",properties:{task_type:{type:"string",title:"Task Type",default:"baseline",enum:["baseline"]},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},show:{type:"boolean",title:"Show",default:!1},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},preset:{type:"string",default:"custom",enum:["custom","not Empty","Empty","EOM","EOW","EOT","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]},prop:{type:"string",default:"self"},sign:{type:"string",default:"not equal",enum:["","not equal","equal","more","less","less or equal","more or equal"]},value:{type:"string",format:"date",default:"empty"}},required:["logic","prop","sign","value"]}},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","till Today","EOM","EOW","EOT","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}}}},forecast:{type:"object",title:"Forecast",properties:{task_type:{type:"string",title:"Task Type",default:"forecast",enum:["forecast"]},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},show:{type:"boolean",title:"Show",default:!1},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},preset:{type:"string",default:"custom",enum:["custom","not Empty","Empty","EOM","EOW","EOT","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]},prop:{type:"string",default:"self"},sign:{type:"string",default:"not equal",enum:["","not equal","equal","more","less","less or equal","more or equal"]},value:{type:"string",format:"date",default:"empty"}},required:["logic","prop","sign","value"]}},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","till Today","EOM","EOW","EOT","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}}}},actual:{type:"object",title:"Actual",properties:{show:{type:"boolean",title:"Show",default:!1},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},task_type:{type:"string",title:"Task Type",default:"actual",enum:["baseline","forecast","actual"]},count_type:{type:"string",title:"Count Type",default:"physical",enum:["physical","logical"]},config:Globals.template_config,multy_milestone:{type:"boolean",title:"Is Multi Milestone",default:!1},multy_milestones:{type:"array",title:"Milestones List",items:{type:"object",title:"Task",format:"taskcode",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}}},task:{type:"object",title:"Task",format:"taskcode",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},preset:{type:"string",default:"custom",enum:["custom","not Empty","Empty","EOM","EOW","EOT","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]},prop:{type:"string",default:"self"},sign:{type:"string",default:"not equal",enum:["","not equal","equal","more","less","less or equal","more or equal"]},value:{type:"string",format:"date",default:"empty"}},required:["logic","prop","sign","value"]}},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},isEditedLabel:{type:"boolean",format:"hidden",default:!1},label:{type:"string",default:""},font_size:{type:"integer",title:"Font Size",default:18},text_color:{type:"string",title:"Text_color",default:"#838383"},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},site_id:{type:"string",title:"Site ID"}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","till Today","EOM","EOW","EOT","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}}}},index:{type:"integer",title:"Mobile Index",default:0}},required:["hidden","value"]},this.on("contextmenu",(function(e,t){$.contextMenu({selector:"body",events:{hide:function(){$.contextMenu("destroy")}},callback:$.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){n.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){n.toogleOutConn()}),10);break;case"exportToExcel":setTimeout((function(){n.exportToExcel()}),10)}}),this),x:t.x,y:t.y,items:{toogleInCon:n.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"},toogleOutCon:n.userData.showOutConnections?{name:"Hide Out Connections"}:{name:"Show Out Connections"},sep1:"---------",exportToExcel:{name:"Export To Excel"}}})})),this.GetHTTPData=function(){this.startAnimation(1e3),n.options={title:n.userData.title,title_left:n.userData.title_left,title_right:n.userData.title_right,grid:n.userData.grid,popup:n.userData.popup,toolbar:n.userData.toolbar,view:n.userData.view,size:n.userData.size,data_table:n.userData.data_table,xAxis:n.userData.xAxis||default_xAxis,yAxis:n.userData.yAxis||default_yAxis,series:[],ml_data:{actual:{},forecast:{},baseline:{}}};var e=this.getUserData(),t=0;e.actual.show&&++t,e.baseline.show&&++t,e.forecast.show&&++t;var a=0,o=function(){t===a&&(n.uChart&&(n.uChart=null),n.updateTable())};if(e.actual.show)c(e.actual,(function(){++a,o()}));else{var i=-1;n.userData.col.forEach((function(t,a){t.task_type===e.actual.task_type&&(i=a)})),i>-1&&n.userData.col.splice(i,1)}e.baseline.show?c(e.baseline,(function(){++a,o()})):(i=-1,n.userData.col.forEach((function(t,a){t.task_type===e.baseline.task_type&&(i=a)})),i>-1&&n.userData.col.splice(i,1)),e.forecast.show?c(e.forecast,(function(){++a,o()})):(i=-1,n.userData.col.forEach((function(t,a){t.task_type===e.forecast.task_type&&(i=a)})),i>-1&&n.userData.col.splice(i,1))},this.updateTable=function(){Utils.updateTable(n,n.options)},this.initDataUpdate=function(e){this.uChart=ucharts.init(this.canvas.paper,e,this),this.setNewData(this.uChart.svg_nodes)},this.updateChartData=function(e){var t=this;e.series.forEach((function(e,a){if(t.uChart.series[a])t.uChart.series[a].update({data:e.data}),n.applyTransformation();else{var o=t.uChart.addSerie(e);n.svgNodes.push(o),n.applyTransformation()}}))},this.setNewData=function(e){n.svgNodes.remove(),n.svgNodes=e,n.applyTransformation(),n.repaint()},this.startAnimation=function(e){this.canvas.paper.setStart();var t,a=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading...");a.attr({fill:"#777",stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),t=Raphael.animation(_defineProperty({opacity:0},"opacity",1),1e3),a.animate(t.repeat(e));var n=this.canvas.paper.setFinish();this.setNewData(n)},this.updateSearchCol=function(e,t,a,n){var o;a.project=e,a.scope=t,n&&(a.sop=n),o=a.sop?Utils.makeTaskSearchTreemaNodeClass(settings.context+"/data/getAllSOPTasks?scope_id="+a.sop.scope_id+"&proj_id="+e.proj_id,a,!0):Utils.makeTaskSearchTreemaNodeClass(settings.context+"/data/getAllTasks?scope_id="+t.scope_id+"&proj_id="+e.proj_id,a,!0),TreemaNode.setNodeSubclass("taskcode",o)}},applyAlpha:function(){},onDragStart:function(e,t,a,n){return!this.dragIsLocked&&this._super(e,t,a,n)},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onPortValueChanged:function(e){if(e.getValue().indexOf("ticket")>-1)this.getOutputPorts().data.forEach((function(e,t){e.getConnections().each($.proxy((function(e,t){t.getTarget().setValue("ticket"),t.setColor("#dfdfdf")}),this))}));else if("dataInput"==e.name){var t=this.getInputPort(0).getConnections().data[0].getSource();this.sites_list_in=t.getUserData().sites_list_out,this.updateSearchCol(t.getUserData().project,t.getUserData().scope,this,t.getUserData().sop),this.GetHTTPData(),this.updateUI()}},createSet:function(){this.canvas.paper.setStart();var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"N/A");return e.attr({fill:"#777",stroke:"none",opacity:.5,"font-size":20,"font-weight":"bold"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},getPersistentAttributes:function(){var e=this._super();return e.labels=[],this.children.each((function(t,a){var n=a.figure.getPersistentAttributes();n.locator=a.locator.NAME,e.labels.push(n)})),e},setPersistentAttributes:function setPersistentAttributes(memento){var _this2=this;if(this._super(memento),this.resetChildren(),"object"===_typeof(this.userData.toolbar.buttons)&&!Array.isArray(this.userData.toolbar.buttons)&&null!==this.userData.toolbar.buttons){var old_toolbar=$.extend({},this.userData.toolbar.buttons);this.userData.toolbar.buttons=this.default_user_data.toolbar.buttons,this.userData.toolbar.buttons.forEach((function(e,t){"full_left"===e.name?_this2.userData.toolbar.buttons[t].show=old_toolbar.full_left:"left"===e.name?_this2.userData.toolbar.buttons[t].show=old_toolbar.left:"right"===e.name?_this2.userData.toolbar.buttons[t].show=old_toolbar.right:"full_right"===e.name?_this2.userData.toolbar.buttons[t].show=old_toolbar.full_right:"monthly"===e.name?_this2.userData.toolbar.buttons[t].show=old_toolbar.monthly:"weekly"===e.name?_this2.userData.toolbar.buttons[t].show=old_toolbar.weekly:"daily"===e.name?_this2.userData.toolbar.buttons[t].show=old_toolbar.daily:"accumulative"===e.name?_this2.userData.toolbar.buttons[t].show=old_toolbar.accumulative:"incremental"===e.name&&(_this2.userData.toolbar.buttons[t].show=old_toolbar.incremental)}))}this.userData=$.extend(!0,{},this.default_user_data,this.userData),$.each(memento.labels,$.proxy((function(i,json){var figure=eval("new "+json.type+"()");figure.attr(json);var locator=eval("new "+json.locator+"()");this.add(figure,locator)}),this))}})},cec8687ba75900ecbd7e:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}n.shape.fishbone.ra.RaLabel=n.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.RaLabel",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.RaLabel</strong>}<br/><br/>",init:function(e,t,a){this.cachedWidth=null,this.cachedHeight=null,this.cachedMinWidth=null,this.cachedMinHeight=null,this.editor=null,this._super(o.extend({stroke:1,width:1,height:1,resizeable:!1},e),t,a),this.createPort("input"),this.updateTickets=0;var r=this.getUserData();function s(){var e,t,a,n=Raphael.animation((e={opacity:0},a=1,(t=function(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}(t="opacity"))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e),1e3);shape.animate(n.repeat(interval))}null===r&&(this.attr({userData:{hidden:!1,index:0,font:default_font,back_color:"",frame_size:0,frame_color:"#989799",padding:10,text:"Simple Text"}}),this.lastAppliedTextAttributes={}),(r=this.getUserData()).font.font_size=22,this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0},font:template_font,back_color:{type:"string",title:"Back Color"},frame_size:{type:"integer",title:"Frame Size",default:1},frame_color:{type:"string",title:"Frame Color",default:"#989799"},padding:{type:"integer",title:"Padding",default:10},text:{type:"string",title:"Text",default:"Simple Label"}}},this.GetHTTPData=function(){},this.updateUI=function(){this.clearCache(),this.repaint();var e=this;this.editPolicy.each((function(t,a){a instanceof n.policy.figure.DragDropEditPolicy&&a.moved(e.canvas,e)}))},this.startAnimation=function(e){this.canvas.paper.setStart(),this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading...").attr({fill:"#777",stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),s();var t=this.canvas.paper.setFinish();this.setNewDataReplace(t)},this.installEditPolicy(new n.policy.figure.AntSelectionFeedbackPolicy),this.on("contextmenu",(function(e,t){o.contextMenu({selector:"body",events:{hide:function(){o.contextMenu("destroy")}},callback:o.proxy((function(e,t){"toogleInCon"===e&&setTimeout((function(){figure.toogleInConn()}),10)}),this),x:t.x,y:t.y,items:{toogleInCon:figure.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"}}})})),this.toogleInConn=function(){this.userData.showInConnections?figure.getInputPorts().data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:0})}))})):figure.getInputPorts().data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:2})}))})),this.userData.showInConnections=!this.userData.showInConnections}},onPortValueChanged:function(e){e.getValue().indexOf("ticket")>-1?(this.updateTickets=this.updateTickets+1,console.log("Active Label Node update ticket received: "+this.updateTickets)):(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),console.log("Active Label update data received: "+this.updateTickets),this.updateTickets<=0&&this.userData.font.animation&&(this.userData.font.animation.show=!0,this.updateUI(),this.userData.font.animation.show=!1))},setCanvas:function(e){this.clearCache(),this._super(e),this.clearCache()},createSet:function(){return this.canvas.paper.text(0,0,this.userData.text)},calculateTextAttr:function(){var e={"text-anchor":"start","font-size":this.userData.font.font_size,"font-weight":this.userData.font.font_weight,fill:this.userData.font.font_color,"stroke-color":this.userData.frame_color,"stroke-width":this.userData.frame_size};return null!==this.userData.font.font_family&&(e["font-family"]=this.userData.font.font_family),e},clearCache:function(){return this.portRelayoutRequired=!0,this.cachedMinWidth=null,this.cachedMinHeight=null,this.cachedWidth=null,this.cachedHeight=null,this.lastAppliedTextAttributes={},this},repaint:function(e){if(!(!0===this.repaintBlocked||null===this.shape||this.parent&&!0===this.parent.repaintBlocked)){var t=this.calculateTextAttr();t.text=this.userData.text;var a=n.util.JSON.flatDiff(t,this.lastAppliedTextAttributes);if(this.lastAppliedTextAttributes=t,o.isEmptyObject(a)||(this.svgNodes.attr(t),this.svgNodes.attr({x:this.userData.padding+this.userData.frame_size,y:this.svgNodes.getBBox(!0).height/2+this.userData.padding+this.userData.frame_size}),this.setStroke(t["stroke-width"]),this.setColor(t["stroke-color"])),this.userData.font.animation&&this.userData.font.animation.show){var i=Raphael.animation(this.userData.font.animation.attr,this.userData.font.animation.delay,(function(){}));this.svgNodes.stop().animate(void 0!==this.userData.font.animation.repeat?i.repeat(this.userData.font.animation.repeat):i)}else this.svgNodes.stop();this._super(e)}},setDimension:function(e,t){return this.clearCache(),this._super(e,t),this},applyTransformation:function(){var e="R"+this.rotationAngle;return this.shape.transform(e),this.lastAppliedLabelRotation=e,this.svgNodes.transform("R"+this.rotationAngle+"T"+this.getAbsoluteX()+","+this.getAbsoluteY()),this},getMinWidth:function(){return null===this.shape?0:(null===this.cachedMinWidth&&(this.cachedMinWidth=this.svgNodes.getBBox(!0).width+this.userData.padding+this.userData.padding+2*this.userData.frame_size),this.cachedMinWidth)},getMinHeight:function(){return null===this.shape?0:(null===this.cachedMinHeight&&(this.cachedMinHeight=this.svgNodes.getBBox(!0).height+this.userData.padding+this.userData.padding+2*this.userData.frame_size),this.cachedMinHeight)},getWidth:function(){return null===this.shape?0:(null===this.cachedWidth&&(!0===this.resizeable?this.cachedWidth=Math.max(this.width,this.getMinWidth()):this.cachedWidth=this.getMinWidth()),this.cachedWidth)},getHeight:function(){return null===this.shape?0:(null===this.cachedHeight&&(this.cachedHeight=Math.max(this.height,this.getMinHeight())),this.cachedHeight)}})},cf3ea1d5c1b698c048db:(e,t,a)=>{a("182b12616a2926778c69")(a("9e00802368dd999ed9a9"))},d03d36be50c40888c6b4:(e,t,a)=>{"use strict";a.d(t,{BJ:()=>x,Bv:()=>w,_O:()=>b,c1:()=>I,h9:()=>E,hm:()=>v,lq:()=>A});var n,o,i,r,s,l=a("8a868d10b6533e768658"),c=a.n(l),u=a("2862a523e031319710f7"),d=a("a45670b3d8fb79ec0258"),p=a("8deafab7866a125bb9ca"),h=a("a45670b3d8fb79ec0258"),f=[].indexOf||function(e){for(var t=0,a=this.length;t<a;t++)if(t in this&&this[t]===e)return t;return-1},m=[].slice,g=function(e,t){return function(){return e.apply(t,arguments)}},y={}.hasOwnProperty,_=function(e){var t;return t={digitsAfterDecimal:2,scaler:1,thousandsSep:",",decimalSep:".",prefix:"",suffix:"",showZero:!1},e=d.extend(t,e),function(t){var a;return isNaN(t)||!isFinite(t)?"":0!==t||e.showZero?(a=function(e,t,a){var n,o,i,r;if(i=(o=(e+="").split("."))[0],r=o.length>1?a+o[1]:"",n=/(\d+)(\d{3})/,t)for(;n.test(i);)i=i.replace(n,"$1"+t+"$2");return i+r}((e.scaler*t).toFixed(e.digitsAfterDecimal),e.thousandsSep,e.decimalSep),""+e.prefix+a+e.suffix):""}},b=_(),v=_({digitsAfterDecimal:0}),w=_({digitsAfterDecimal:1,scaler:100,suffix:"%"}),x={count:function(e){return null==e&&(e=v),function(){return function(t,a,n){return{count:0,push:function(){return this.count++},value:function(){return this.count},format:e}}}},countUnique:function(e){return null==e&&(e=v),function(t){var a;return a=t[0],function(t,n,o){return{uniq:[],push:function(e){var t;if(t=e[a],f.call(this.uniq,t)<0)return this.uniq.push(e[a])},value:function(){return this.uniq.length},format:e,numInputs:null!=a?0:1}}}},listUnique:function(e){return function(t){var a;return a=t[0],function(t,n,o){return{uniq:[],push:function(e){var t,n,o,i,r;if(t=e[a],f.call(this.uniq,t)<0)return t instanceof Date?this.uniq.push((o=""+((n=new Date(t)).getMonth()+1),i=""+n.getDate(),r=n.getFullYear(),o.length<2&&(o="0"+o),i.length<2&&(i="0"+i),[r,o,i].join("-"))):this.uniq.push(e[a])},value:function(){return n.length&&o.length?this.uniq.join(e):this.uniq.length},format:function(e){return e},numInputs:null!=a?0:1}}}},sum:function(e){return null==e&&(e=b),function(t){var a;return a=t[0],function(t,n,o){return{sum:0,push:function(e){if(!isNaN(parseFloat(e[a])))return this.sum+=parseFloat(e[a])},value:function(){return this.sum},format:e,numInputs:null!=a?0:1}}}},min:function(e){return null==e&&(e=b),function(t){var a;return a=t[0],function(t,n,o){return{val:null,push:function(e){var t,n;if(n=parseFloat(e[a]),!isNaN(n))return this.val=Math.min(n,null!=(t=this.val)?t:n)},value:function(){return this.val},format:e,numInputs:null!=a?0:1}}}},max:function(e){return null==e&&(e=b),function(t){var a;return a=t[0],function(t,n,o){return{val:null,push:function(e){var t,n;if(n=parseFloat(e[a]),!isNaN(n))return this.val=Math.max(n,null!=(t=this.val)?t:n)},value:function(){return this.val},format:e,numInputs:null!=a?0:1}}}},average:function(e){return null==e&&(e=b),function(t){var a;return a=t[0],function(t,n,o){return{sum:0,len:0,push:function(e){if(!isNaN(parseFloat(e[a])))return this.sum+=parseFloat(e[a]),this.len++},value:function(){return this.sum/this.len},format:e,numInputs:null!=a?0:1}}}},sumOverSum:function(e){return null==e&&(e=b),function(t){var a,n;return n=t[0],a=t[1],function(t,o,i){return{sumNum:0,sumDenom:0,push:function(e){if(isNaN(parseFloat(e[n]))||(this.sumNum+=parseFloat(e[n])),!isNaN(parseFloat(e[a])))return this.sumDenom+=parseFloat(e[a])},value:function(){return this.sumNum/this.sumDenom},format:e,numInputs:null!=n&&null!=a?0:2}}}},sumOverSumBound80:function(e,t){return null==e&&(e=!0),null==t&&(t=b),function(a){var n,o;return o=a[0],n=a[1],function(a,i,r){return{sumNum:0,sumDenom:0,push:function(e){if(isNaN(parseFloat(e[o]))||(this.sumNum+=parseFloat(e[o])),!isNaN(parseFloat(e[n])))return this.sumDenom+=parseFloat(e[n])},value:function(){var t;return t=e?1:-1,(.821187207574908/this.sumDenom+this.sumNum/this.sumDenom+1.2815515655446004*t*Math.sqrt(.410593603787454/(this.sumDenom*this.sumDenom)+this.sumNum*(1-this.sumNum/this.sumDenom)/(this.sumDenom*this.sumDenom)))/(1+1.642374415149816/this.sumDenom)},format:t,numInputs:null!=o&&null!=n?0:2}}}},fractionOf:function(e,t,a){return null==t&&(t="total"),null==a&&(a=w),function(){var n;return n=1<=arguments.length?m.call(arguments,0):[],function(o,i,r){return{selector:{total:[[],[]],row:[i,[]],col:[[],r]}[t],inner:e.apply(null,n)(o,i,r),push:function(e){return this.inner.push(e)},format:a,value:function(){return this.inner.value()/o.getAggregator.apply(o,this.selector).inner.value()},numInputs:e.apply(null,n)().numInputs}}}}},k={"Count Unique Values":(s=x).countUnique(v),"List Unique Values":s.listUnique("; "),Sum:s.sum(b),"Integer Sum":s.sum(v),Minimum:s.min(b),Maximum:s.max(b),"Sum over Sum":s.sumOverSum(b),"80% Upper Bound":s.sumOverSumBound80(!0,b),"80% Lower Bound":s.sumOverSumBound80(!1,b),"Sum as Fraction of Total":s.fractionOf(s.sum(),"total",w),"Sum as Fraction of Rows":s.fractionOf(s.sum(),"row",w),"Sum as Fraction of Columns":s.fractionOf(s.sum(),"col",w),"Count as Fraction of Total":s.fractionOf(s.count(),"total",w),"Count as Fraction of Rows":s.fractionOf(s.count(),"row",w),"Count as Fraction of Columns":s.fractionOf(s.count(),"col",w)},D={Table:function(e,t){return r(e,t)},"Table Barchart":function(e,t){return d(r(e,t)).barchart()},Heatmap:function(e,t){return d(r(e,t)).heatmap("heatmap",t)},"Row Heatmap":function(e,t){return d(r(e,t)).heatmap("rowheatmap",t)},"Col Heatmap":function(e,t){return d(r(e,t)).heatmap("colheatmap",t)}},S={en:{aggregators:k,renderers:D,localeStrings:{renderError:"An error occurred rendering the PivotTable results.",computeError:"An error occurred computing the PivotTable results.",uiRenderError:"An error occurred rendering the PivotTable UI.",selectAll:"Select All",selectNone:"Select None",tooMany:"(too many to list)",filterResults:"Filter results",totals:"Totals",vs:"vs",by:"by"}}},C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function A(e){var t,a,n;for(t in a={},e)n=e[t],a[n]=t;return function(e,t){return null!=a[e]&&null!=a[t]?a[e]-a[t]:null!=a[e]?-1:null!=a[t]?1:i(e,t)}}n={bin:function(e,t){return function(a){return a[e]-a[e]%t}},dateFormat:function(e,t,a,n,o){var i;return null==a&&(a=!1),null==n&&(n=C),null==o&&(o=T),i=a?"UTC":"",function(a){var r;return r=new Date(Date.parse(a[e])),isNaN(r)?"":t.replace(/%(.)/g,(function(e,t){switch(t){case"y":return r["get"+i+"FullYear"]();case"m":return p.zeroPadl(r["get"+i+"Month"]()+1);case"n":return n[r["get"+i+"Month"]()];case"d":return p.zeroPadl(r["get"+i+"Date"]());case"w":return o[r["get"+i+"Day"]()];case"x":return r["get"+i+"Day"]();case"H":return p.zeroPadl(r["get"+i+"Hours"]());case"M":return p.zeroPadl(r["get"+i+"Minutes"]());case"S":return p.zeroPadl(r["get"+i+"Seconds"]());default:return"%"+t}}))}}},i=function(e,t){var a,n,o,i,r,s,l;if(s=/(\d+)|(\D+)/g,r=/\d/,l=/^0/,"number"==typeof e||"number"==typeof t)return isNaN(e)?1:isNaN(t)?-1:e-t;if((a=String(e).toLowerCase())===(o=String(t).toLowerCase()))return 0;if(!r.test(a)||!r.test(o))return a>o?1:-1;for(a=a.match(s),o=o.match(s);a.length&&o.length;)if((n=a.shift())!==(i=o.shift()))return r.test(n)&&r.test(i)?n.replace(l,".0")-i.replace(l,".0"):n>i?1:-1;return a.length-o.length},o=function(e,t){var a;if(null!=e)if(d.isFunction(e)){if(a=e(t),d.isFunction(a))return a}else if(null!=e[t])return e[t];return i};var P=function(){function e(t,a){var n;this.getAggregator=g(this.getAggregator,this),this.getRowKeys=g(this.getRowKeys,this),this.getColKeys=g(this.getColKeys,this),this.sortKeys=g(this.sortKeys,this),this.arrSort=g(this.arrSort,this),this.aggregator=a.aggregator,this.aggregatorName=a.aggregatorName,this.colAttrs=a.cols,this.rowAttrs=a.rows,this.valAttrs=a.vals,this.sorters=a.sorters,this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.sorted=!1,e.forEachRecord(t,a.derivedAttributes,(n=this,function(e){if(a.filter(e))return n.processRecord(e)}))}return e.forEachRecord=function(e,t,a){var n,o,i,r,s,l,c,u,p,f,m,g;if(n=d.isEmptyObject(t)?a:function(e){var n,o,i;for(n in t)i=t[n],e[n]=null!=(o=i(e))?o:e[n];return a(e)},d.isFunction(e))return e(n);if(d.isArray(e)){if(d.isArray(e[0])){for(i in f=[],e)if(y.call(e,i)&&(o=e[i],i>0)){for(r in u={},p=e[0])y.call(p,r)&&(s=p[r],u[s]=o[r]);f.push(n(u))}return f}for(m=[],l=0,c=e.length;l<c;l++)u=e[l],m.push(n(u));return m}if(e instanceof h)return g=[],d("thead > tr > th",e).each((function(e){return g.push(d(this).text())})),d("tbody > tr",e).each((function(e){return u={},d("td",this).each((function(e){return u[g[e]]=d(this).text()})),n(u)}));throw new Error("unknown input format")},e.convertToArray=function(t){var a;return a=[],e.forEachRecord(t,{},(function(e){return a.push(e)})),a},e.prototype.arrSort=function(e){var t,a;return a=function(){var a,n,i;for(i=[],a=0,n=e.length;a<n;a++)t=e[a],i.push(o(this.sorters,t));return i}.call(this),function(e,t){var n,o;for(o in a)if(y.call(a,o)&&0!==(n=(0,a[o])(e[o],t[o])))return n;return 0}},e.prototype.sortKeys=function(){if(!this.sorted)return this.sorted=!0,this.colKeys.sort(this.arrSort(this.colAttrs)),this.rowKeys.sort(this.arrSort(this.rowAttrs))},e.prototype.getColKeys=function(){return this.sortKeys(),this.colKeys},e.prototype.getRowKeys=function(){return this.sortKeys(),this.rowKeys},e.prototype.processRecord=function(e){var t,a,n,o,i,r,s,l,c,u,d,p,h;for(t=[],p=[],o=0,i=(l=this.colAttrs).length;o<i;o++)h=l[o],t.push(null!=(c=e[h])?c:"null");for(s=0,r=(u=this.rowAttrs).length;s<r;s++)h=u[s],p.push(null!=(d=e[h])?d:"null");if(n=p.join(String.fromCharCode(0)),a=t.join(String.fromCharCode(0)),this.allTotal.push(e),0!==p.length&&(this.rowTotals[n]||(this.rowKeys.push(p),this.rowTotals[n]=this.aggregator(this,p,[])),this.rowTotals[n].push(e)),0!==t.length&&(this.colTotals[a]||(this.colKeys.push(t),this.colTotals[a]=this.aggregator(this,[],t)),this.colTotals[a].push(e)),0!==t.length&&0!==p.length)return this.tree[n]||(this.tree[n]={}),this.tree[n][a]||(this.tree[n][a]=this.aggregator(this,p,t)),this.tree[n][a].push(e)},e.prototype.getAggregator=function(e,t){var a,n,o;return o=e.join(String.fromCharCode(0)),n=t.join(String.fromCharCode(0)),null!=(a=0===e.length&&0===t.length?this.allTotal:0===e.length?this.colTotals[n]:0===t.length?this.rowTotals[o]:this.tree[o][n])?a:{value:function(){return null},format:function(){return""}}},e}();function E(e,t){var a,n,o,i,s;a={cols:[],rows:[],vals:[],dataClass:P,filter:function(){return!0},aggregatorName:"Count",aggregator:t.aggregators[t.aggregatorName](t.vals,"",""),sorters:function(){},derivedAttributes:{},renderer:r,rendererOptions:null,localeStrings:S.en.localeStrings},(t=d.extend(a,t)).renderer=t.renderers[t.rendererName],t.aggregator=t.aggregators[t.aggregatorName](t.vals,t.t_row_type,t.t_col_type);try{s=new t.dataClass(e,t);try{t.renderer(s,t.rendererOptions)}catch(o){n=o,"undefined"!=typeof console&&null!==console&&console.error(n.stack),d("<span>").html(t.localeStrings.renderError)}}catch(i){n=i,"undefined"!=typeof console&&null!==console&&console.error(n.stack),d("<span>").html(t.localeStrings.computeError)}return!0}function I(e,t,a,n){var o=e.set();if(t.userData.toolbar.show){var i=10;if(t.userData.toolbar.buttons.table){var r=e.image("data:image/png;base64,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",i,0,21,21);r.mouseup((function(){t.userData.renderer="Ra Segment Table",t.GetHTTPData()})),r.attr({opacity:.5}),N(r),i+=28,o.push(r)}if(t.userData.toolbar.buttons.linechart){var s=e.image("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAEGWlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VQNcC+8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAvrSURBVHgB7Vx5kBbFFX8LCwuCIcqxCnhAiBDDrSKikgWSlEoBu3JIOCQp8kfKyh/BMqlUDlJRiamKOcpKKkRLSy4FZWEPBBQUCJcYYyqRmyw3RFi5hAWWBSb9y6TtY+abb76env12qHlVu9PXe93zfl+/fv26v6/AYUQhqLKKqLRMNBwzhqhiicinKTsaaGZHTCrFlgZSQGxp0pKcFBBLirQlJgXEliYtyUkBsaRIW2JSQGxp0pKcFBBLirQlJgXEliYtyUkBsaRIW2JSQGxp0pKcFBBLirQlJgXEliYtyUkBsaRIW2JSQGxp0pKcFBBLirQl5poB5Fwd0fFaW2rJn5xrApDqZUSdioluupnoRz/OnzJt9HxNADLjSaILF4hw9vn880T79ttQTX5kJB6QDRuJamqE8gBKZaXIJy2VeEDmL/CqHOf/SaVEA3KpgejNN72q37CB6NRpb3kSShINyDK2mJ886VXz5ctEqEsiJRqQefMzq7yqOnOd7Zrde4i2brMjNbGAnDxFtHx5ZiWsXEkEkxY3/YZ5dT17EfXpS/QD5u1FpcQCsmgRU/gl8fo9exLdzPYhnM6dI3r3XZ6L51l3nujpZ4TsF14g+niryJukEguI7l1NnUKE25Qyxe1tLV5MBOA5weWWAeLluTwTCcjefUSbNonXLCggmjyZATJalCGFhZ3pKDaaO88rurw82nqSSEDmaYp48EGi228jGjaMqG1boaQjR4g+/FDkbaYOHSZau9YrEbPkl097y8OWJBKQBa+prwdzBSpqSfTww26a/4/LbM2ZQ3T1Ku9FfUaZJYkDZPP7RHuYm8mpqIho3DieIxo9SqSRiiuMopsrjINTlLUkcYDoi/koBsAX23FVED3yCFHz5iK/lXk9toONmzarH4qWbGbO/rPoEyks+Nu2q2VhcokCpIHtwOHuysTNFS+78QaioUN5zn3aniVz5qryRzNn4tvTiAYOFOWma0miAMFG8MQJ8dLt23vXDNTq3pbNdaSe7X3eeEOMAalpj7v5X8xUy01mSaIA0UMlEycStShUlYAczJhMNoONFRVEp6XAZadORA895PaG9WvAANGzyVqSGEBOn/EGDKewvYcfde/GQhl9RA2CjW+9JfJRUrq5msI8vEJpzYo6SxIDCMLs9fVClT16EA2+V+T1VBy79k+OEb3zjtrT41PVPMylPEvgGueye08MILq50hdzVS3edeTtt6MHG+ez6PKVK6Kn/v2J+rGgok5+s2T7Dr2Vfz4RgOw/QIR1QCaESoLorruIOncWLc6ejR5s1PcefDEXvbgpeF0Ai1MusyQRgOCTiQWS0/33E32pO8/5PwtYMRQjU5Qzko/+wSK5HwtphYVEkyaJvJxC3/osgckNM0uSAYh2bp5pMZeVgrTu/lZXmwcb9cUcIZpOHfUeRR5rmNEswQ8HhKGKSvYZbSb+xpSF4XLbXLjoOCdOhm8vt9zygegT/bdsFV7WxXrHafsFlf+Dv8nSw6UvNThOx2JVzuLy7LxLK1SeZoWOs31HMF/sM2TVaqLim4g6sE/Tk0+JT1DYlB4qGTmSCLvxMIRgI98j8PYmm0S4zLW1XALr/0bvXkfUipTRLAnGS9SazpC+/dVPyW9/J2RmSzVc9n4ylyzNxqXWz5uv9t+nn1ofJlc2VpXxxPfDcLltMF7ZsmSbJWyxDEcmgOzarQ4GA2vewnGWrwjXZ/Uylf+G9o5TfykcL28FU4k+ZaXs3cdrsz8/PeGaSZkfZjQsXWUN+w1Q+584KTN3rCYLsRyd4Md/i3knO3fpNd68vvd47DGili287YJKYN5wgCVTLsHG19jZi3x234tdaBh0jywtOO3ncSEWtmOnP1+8gJT7d3qGhUFGMZc06DLbZ2zfUFWl8of1rlQur7eVyzqie1eZ9h56n3K+tJRtIPuJEuxLnnlW5JVU5smj1uRqsmr2qtNUnvI8/fVvOg7WCT96+RWVv3sPv1bhyvSxFLZ0nJOnsvNu266OAfb/0OHsfH4typd4Ze3Y6W0Z2wzBMaZMJSVE06fLJUSrmQeGm+t+pJsrBPFMyTTY+OoctccRI4i6dlHLwubKyoj6SmGWjLt3L0b+JbnOkEGD1U/EH//kLsgPDFXLMVv+8qLa58FDjlPQXG23e4/aJtfcz2aq8sZNCJZw+YrjdO6q8sxfEMyTrTbMLInFyzpwUH0RKPfIUXe4x2sd57Zuan2LIsdZu068zq+eU+sHDxF1SHGTl+0pc2FDKLe/vl2wx7Zipbd93XlZYu7pq4xF3wZMmqLKicVk6eZqyBAW6Pv/rcKOHdhiXUnUpo2Y7A0N7KLCeHH2rW8GTRdz0QPR3Xd7g43vvSe3UNP6Yj5hAtF1rdU2uebgcc38ucq1cKHmcar4ZM7lYrKGPKB+un7/B69chBV0s9S7rztT5E8yZg/2AjLJ9UFpmQfp7z2hjgt5Pzp9xnFat1Hb/nW9X8vcyzBLsDmVxy3PEusmC6ZJVjTSWBP86NlZ6sAwyDbXq2WjS72c8ssEpXVObEjl9l1ucRwoSKcXX1LbwcPza6fzhc0jDiaPA97bzl0ut3WTBXPFuvucBg0iuqXr51kl8dOfEOFcXKa6OjlHlO0gSm0dnBs+PNzNRt1c4VQQ5sYWPfqoesQs70usA7JYc3fHjQ1+jVdedu27X6t27L6VfmHBr13YMr9go35G8u8aoo0bhUTcG57KALFJfmvJ668T7dpNZBWQY8e9J3tjswDSuhX7/d+l6lcJ+MuPZws9lGiT9DMSPYyinwoi7IJ9jG2CXuSLGHyWWAVkKVMsBHPCMWq323ku87NLZxeUVgwcmWyaKy5Xv9mIU8B9+91aWNq5c3lL92kSKlEl+Of0WVJcTHQP8wStLuojvqEuVs/9Ouwy57ZbuMhxENbAgjdyVGZeeUEMSmeSUDJcHSf3AtesVcuva+s4n53NJCV6ORwFhI9wJHH+givPGiC1n3rD3Ca768NHHOfvHwV7NUEgyHWZVAYA5HbDRrgtp31HLZ88NZOE+MqtmSzc6JOvyCBu8+Ue/tM1qBTma+AAu16N3p9++WH9eqLD7Lsk+oY2LnOlj0fOWwMkV+9KHkRjp7FI9+4tesXNxunfVb+e1pW56ggmNjZZAQTnGnoYQv7ORmO/VJj+9JuN+o1ERJebYeVtZGK3i6ITXEfEozjdeSfRV9jJmkw1e4kuXpRL/NO4Imrb1fXrCe7vrFl+NW5ZPswVerYCSPkS9cX8ZkcZ253KF81UDpH71z+Zfy6ZE1FjN8WDjUePeuUiutCrp7c8qAQX6dasCWrh1mErUPK1zO0iA4Kj1lWr1A6y7c7V1vnJwRphcZ8929u/yexYt47oqR96ZeklM2YEAxJ5DcFtQPlW+h13NM4nXH9Rk7z+fUTIwNfT9PiaiWxTnsiA6N5VtlCJ6UDj4NODjegDsybsRbw4xhQJEPzOIX5TRKYkmCs+XjgPCKXIZGKuZP6o6UiA4Iql7Dl17+5u6qIOqjH5cYLHfyMFsxtXVfNJkRb1JJsrrvSvMhf94AH3e4Md2vPS/D2NAbnCorqrV6gDT5K5kkeO7wg2BTAwJmOTdewTIvl079Zbc7tiKSskTQsNGANy9D9CCFJJ8q7UkTetnLHJwgyRKanmCr/qg9/8zUawAK2KsrWKXm8MCCKknPDlyvvu47lkPcez+1ZbtmQf8/ubie5lIZW4ydhkyQPDLYo8BEblIVwzaSuAJNVcNUUUIwOCw3n9CzFN8UWTMqbIgOCafT4OcpKi4FzHGRmQ1FzlqvLg9pEA6cBuspeUBHeQ1uamgcLLV8IxIFSiE0LV7OIMhZGBdmEIssLICysrWztb4/LTj1/fuEgY9H4F/7uf5MeZluVFA5FMVl5GfI13mgLSxAAuxM8MhSHYPvkiNa7pyz/HGkZG2ia7BgpwSzV7M/aDxFVEpWzPwQkXzSq06z+8Ln2aayA1Wea6i4UzBSQWtZoLTQEx110snCkgsajVXGgKiLnuYuFMAYlFreZCU0DMdRcLZwpILGo1F5oCYq67WDhTQGJRq7nQFBBz3cXCmQISi1rNhf4XKJFcZjBiUa0AAAAASUVORK5CYII=",i,0,21,21);s.mouseup((function(){t.userData.renderer="Line UChart",t.GetHTTPData()})),s.attr({opacity:.5}),N(s),i+=28,o.push(s)}if(t.userData.toolbar.buttons.data){var l=e.image("data:image/png;base64,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",i,0,21,21);l.mouseup((function(){!function(e,t){var a,n,o,i,r,s,l,c,u,d,h,f,m,g,y,_,b,v;0===(v=e.getRowKeys()).length&&v.push([]),0===(i=e.getColKeys()).length&&i.push([]),b=e.rowAttrs,n=e.colAttrs;for(var w=[[]],x=0;x<n.length;x++){for(r=0,u=b.length-1;r<u;r++)w[w.length-1].push("");w[w.length-1].push(n[x]),w.push([])}for(r=0,u=b.length;r<u;r++)_=b[r],w[n.length].push(_);for(var k=0;k<i.length;k++){var D=i[k].join(" ");w[n.length].push(D)}for(t.userData.showRowTotals||t.userData.showRowTotals,l=0,h=v.length;l<h;l++){var S=v[l];for(w.push([]),c=0,f=S.length;c<f;c++){var C=(y=S[c]).toString().replace(/(\r\n|\n|\r)/gm,"");w[w.length-1].push(C)}for(g=0,m=i.length;g<m;g++)o=i[g],null!=(a=e.getAggregator(S,o)).value()?w[w.length-1].push(a.format(a.value())):w[w.length-1].push("");(t.userData.showRowTotals||void 0===t.userData.showRowTotals)&&(a=e.getAggregator(S,[]),w[w.length-1].push(a.format(a.value())))}if(1===i.length&&0===i[0].length);else for(var T=0;T<i.length;T++)for(s=0,d=(o=i[T]).length;s<d;s++)y=o[s],w[s].push(y);if((t.userData.showRowTotals||void 0===t.userData.showRowTotals)&&w[0].push("total"),t.userData.showColTotals||void 0===t.userData.showColTotals){for(w.push([]),w[w.length-1].push("total"),r=0,u=b.length-1;r<u;r++)w[w.length-1].push("");for(g=0;g<i.length;g++)o=i[g],a=e.getAggregator([],o),w[w.length-1].push(a.format(a.value()))}(t.userData.showRowTotals&&t.userData.showColTotals||void 0===t.userData.showRowTotals&&void 0===t.userData.showColTotals)&&(a=e.getAggregator([],[]),w[w.length-1].push(a.format(a.value()))),p.export2DArrayToExcel2(w)}(a,t)})),l.attr({opacity:.5}),N(l),i+=28,o.push(l)}if(t.userData.toolbar.buttons.save_pic){var d=e.image("data:image/png;base64,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",i,0,21,21);d.mouseup((function(){!function(e){setTimeout((function(){(new(c().io.png.WriterE)).marshalR(e,(function(e,t){e.toBlob((function(e){(0,u.saveAs)(e,"fish_bone_export.png")}),"image/png");var a=new Blob([t],{type:"image/svg+xml"});(0,u.saveAs)(a,"fish_bone_export.svg")}))}),1)}(t)})),d.attr({opacity:.5}),N(d),i+=28,o.push(d)}if(t.userData.toolbar.buttons.refresh){var h=e.image("data:image/png;base64,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",i,0,21,21);h.mouseup((function(){t.refreshTable()})),h.attr({opacity:.5}),N(h),i+=28,o.push(h)}if(t.userData.toolbar.buttons.left){var f=e.image("data:image/png;base64,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",i,0,21,21);f.mouseup((function(){t.c_start_position>0&&(--t.c_start_position,--t.c_finish_position,n())})),f.attr({opacity:.5}),N(f),i+=28,o.push(f)}if(t.userData.toolbar.buttons.right){var m=e.image("data:image/png;base64,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",i,0,21,21);m.mouseup((function(){t.c_finish_position<a.colKeys.length&&(t.c_start_position++,t.c_finish_position++,n())})),m.attr({opacity:.5}),N(m),i+=28,o.push(m)}if(t.userData.toolbar.buttons.up){var g=e.image("data:image/png;base64,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",i,0,21,21);g.mouseup((function(){t.r_start_position>0&&(--t.r_start_position,--t.r_finish_position,n())})),g.attr({opacity:.5}),N(g),i+=28,o.push(g)}if(t.userData.toolbar.buttons.down){var y=e.image("data:image/png;base64,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",i,0,21,21);y.mouseup((function(){t.r_finish_position<a.rowKeys.length&&(t.r_start_position++,t.r_finish_position++,n())})),y.attr({opacity:.5}),N(y),i+=28,o.push(y)}if(t.userData.toolbar.buttons.inc_acc){var _=e.image("data:image/png;base64,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",i,0,21,21);_.mouseup((function(){"Count"===t.userData.aggregator.name?t.userData.aggregator.name="Count Accumulative":t.userData.aggregator.name="Count",t.refreshTable()})),_.attr({opacity:.5}),N(_),i+=28,o.push(_)}}return o}function N(e){e.hover((function(){e.attr({opacity:1})}),(function(){e.attr({opacity:.6})}))}d.pivotUtilities_ra={aggregatorTemplates:x,aggregators:k,renderers:D,derivers:n,locales:S,naturalSort:i,numberFormat:_,sortAs:A,PivotData:P},r=function(e,t){var a,n,o,i,r,s,l,c,u,p,h,f,m,g,_,b,v,w,x,k,D,S,C;for(c in s={localeStrings:{totals:"Totals"}},t=d.extend(s,t),o=e.colAttrs,h=e.rowAttrs,m=e.getRowKeys(),r=e.getColKeys(),(p=document.createElement("table")).className="pvtTable",g=function(e,t,a){var n,o,i,r,s,l,c,u;if(0!==t){for(r=!0,u=n=0,s=a;0<=s?n<=s:n>=s;u=0<=s?++n:--n)e[t-1][u]!==e[t][u]&&(r=!1);if(r)return-1}for(o=0;t+o<e.length;){for(c=!1,u=i=0,l=a;0<=l?i<=l:i>=l;u=0<=l?++i:--i)e[t][u]!==e[t+o][u]&&(c=!0);if(c)break;o++}return o},w=document.createElement("thead"),o)if(y.call(o,c)){for(l in n=o[c],k=document.createElement("tr"),0===parseInt(c)&&0!==h.length&&((v=document.createElement("th")).setAttribute("colspan",h.length),v.setAttribute("rowspan",o.length),k.appendChild(v)),(v=document.createElement("th")).className="pvtAxisLabel",v.textContent=n,k.appendChild(v),r)y.call(r,l)&&(i=r[l],-1!==(C=g(r,parseInt(l),parseInt(c)))&&((v=document.createElement("th")).className="pvtColLabel",v.textContent=i[c],v.setAttribute("colspan",C),parseInt(c)===o.length-1&&0!==h.length&&v.setAttribute("rowspan",2),k.appendChild(v)));0===parseInt(c)&&((v=document.createElement("th")).className="pvtTotalLabel",v.innerHTML=t.localeStrings.totals,v.setAttribute("rowspan",o.length+(0===h.length?0:1)),k.appendChild(v)),w.appendChild(k)}if(0!==h.length){for(l in k=document.createElement("tr"),h)y.call(h,l)&&(u=h[l],(v=document.createElement("th")).className="pvtAxisLabel",v.textContent=u,k.appendChild(v));v=document.createElement("th"),0===o.length&&(v.className="pvtTotalLabel",v.innerHTML=t.localeStrings.totals),k.appendChild(v),w.appendChild(k)}for(l in p.appendChild(w),_=document.createElement("tbody"),m)if(y.call(m,l)){for(c in f=m[l],k=document.createElement("tr"),f)y.call(f,c)&&(D=f[c],-1!==(C=g(m,parseInt(l),parseInt(c)))&&((v=document.createElement("th")).className="pvtRowLabel",v.textContent=D,v.setAttribute("rowspan",C),parseInt(c)===h.length-1&&0!==o.length&&v.setAttribute("colspan",2),k.appendChild(v)));for(c in r)y.call(r,c)&&(i=r[c],S=(a=e.getAggregator(f,i)).value(),(b=document.createElement("td")).className="pvtVal row"+l+" col"+c,b.textContent=a.format(S),b.setAttribute("data-value",S),k.appendChild(b));S=(x=e.getAggregator(f,[])).value(),(b=document.createElement("td")).className="pvtTotal rowTotal",b.textContent=x.format(S),b.setAttribute("data-value",S),b.setAttribute("data-for","row"+l),k.appendChild(b),_.appendChild(k)}for(c in k=document.createElement("tr"),(v=document.createElement("th")).className="pvtTotalLabel",v.innerHTML=t.localeStrings.totals,v.setAttribute("colspan",h.length+(0===o.length?0:1)),k.appendChild(v),r)y.call(r,c)&&(i=r[c],S=(x=e.getAggregator([],i)).value(),(b=document.createElement("td")).className="pvtTotal colTotal",b.textContent=x.format(S),b.setAttribute("data-value",S),b.setAttribute("data-for","col"+c),k.appendChild(b));return S=(x=e.getAggregator([],[])).value(),(b=document.createElement("td")).className="pvtGrandTotal",b.textContent=x.format(S),b.setAttribute("data-value",S),k.appendChild(b),_.appendChild(k),p.appendChild(_),p.setAttribute("data-numrows",m.length),p.setAttribute("data-numcols",r.length),p},x.rateOf=function(e,t,a){return null==t&&(t="total"),null==a&&(a=w),function(){var n;return n=1<=arguments.length?m.call(arguments,0):[],function(o,i,r){return{selector:{total:[[],[]],row:[i,[arguments[0].valAttrs[0]]],col:[[arguments[0].valAttrs[0]],r]}[t],inner:e.apply(null,n)(o,i,r),push:function(e){return this.inner.push(e)},format:a,value:function(){return this.inner.value()/o.getAggregator.apply(o,this.selector).inner.value()},numInputs:e.apply(null,n)().numInputs}}}}},d3805c5536dd4d0fa681:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.ra.Progress=n.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.Progress",INFO:"{Class: <strong>draw2d.shape.fishbone.ra.Progress</strong>}<br/><br/>",init:function(e,t,a){var n=this;this._super(o.extend({stroke:0,bgColor:null,width:70,height:20},e),t,a),this.createPort("input");var i=this,r=this.getUserData();this.updateTickets=0;var s={hidden:!1,font:{font_size:18,font_color:"#5c5c5c",font_family:"Tahoma, Geneva",font_style:"normal",font_weight:"normal"},size:{width:70,height:20},back_color:"#e1e3e6",bar_color:"#e87856",frame_size:0,delay:0,progress:0,frame_color:"#626063",padding:10,showInConnections:!0};null===r&&this.attr({userData:s}),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:70},height:{type:"integer",default:20}}},delay:{type:"integer",title:"Delay",default:0},progress:{type:"integer",title:"progress",default:0},font:template_font,back_color:{type:"string",title:"Back Color"},bar_color:{type:"string",title:"Bar Color"},frame_size:{type:"integer",title:"Frame Size",default:1},frame_color:{type:"string",title:"Frame Color",default:"#989799"},padding:{type:"integer",title:"Padding",default:10},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0}}},this.setParams=function(){this.top_label.setFontSize(this.userData.font.font_size),this.top_label.setFontColor(this.userData.font.font_color),this.top_label.setFontFamily(this.userData.font.font_family),this.setBackgroundColor(""===this.userData.back_color?null:this.userData.back_color),this.setStroke(this.userData.frame_size),this.setColor(this.userData.frame_color),this.top_label.setBold(this.userData.font.font_bold)},this.on("contextmenu",(function(e,t){o.contextMenu({selector:"body",events:{hide:function(){o.contextMenu("destroy")}},callback:o.proxy((function(e,t){"toogleInCon"===e&&setTimeout((function(){i.toogleInConn()}),10)}),this),x:t.x,y:t.y,items:{toogleInCon:i.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"}}})})),this.toogleInConn=function(){this.userData.showInConnections?i.getInputPorts().data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:0})}))})):i.getInputPorts().data.forEach((function(e,t){e.getConnections().data.forEach((function(e,t){e.attr({stroke:2})}))})),this.userData.showInConnections=!this.userData.showInConnections},this.updateUI=function(){},this.GetHTTPData=function(){this.setNewData(this.updateSet(this.userData.progress))},this.on("resize",(function(e){i.userData.size={width:e.width,height:e.height},i.originalWidth=i.userData.size.width,i.originalHeight=i.userData.size.height,n.setNewData(n.updateSet(n.userData.progress))})),this.setNewData=function(e){i.svgNodes.hide(),i.svgNodes=e,i.applyTransformation(),i.repaint()},this.updateSet=function(e){return this.userData=o.extend(!0,s,this.userData),this.canvas.paper.setStart(),this.canvas.paper.rect(0,0,this.getWidth(),this.getHeight(),1).attr({fill:this.userData.back_color,opacity:.5,stroke:"none"}),this.canvas.paper.rect(0,0,e*this.getWidth()/100,this.getHeight(),1).attr({fill:this.userData.bar_color,opacity:.7,stroke:"none"}),this.canvas.paper.text(this.userData.size.width/2,this.userData.size.height/2,e+"%").attr({fill:this.userData.font.font_color,stroke:"none",opacity:.9,"font-size":this.userData.font.font_size,"font-weight":this.userData.font.font_bold,"font-style":this.userData.font.font_style,"font-family":this.userData.font.font_family}),this.load_time&&this.canvas.paper.text(this.userData.size.width+20,this.userData.size.height/2,this.load_time+"s").attr({fill:this.userData.font.font_color,stroke:"none",opacity:.5,"font-size":12,"font-weight":this.userData.font.font_bold,"font-style":this.userData.font.font_style,"font-family":this.userData.font.font_family}),this.canvas.paper.setFinish()}},onPortValueChanged:function(e){var t=e.getParent().getCanvas();e.getValue().indexOf("ticket")>-1?(this.maxTicketsNumber&&(this.userData.progress=0,this.setNewData(this.updateSet(this.userData.progress)),this.maxTicketsNumber=null),this.updateTickets=this.updateTickets+1,DEBUG&&console.log("Progress Node update ticket received: "+this.updateTickets)):(this.maxTicketsNumber||(this.maxTicketsNumber=this.updateTickets,this.time_start=(new Date).getTime()),this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),this.userData.progress=Math.round(100*(1-this.updateTickets/this.maxTicketsNumber)),this.setNewData(this.updateSet(this.userData.progress)),DEBUG&&console.log("Progress Node update data received: "+this.updateTickets),this.updateTickets<=0&&(this.userData.progress=100,this.time_end=(new Date).getTime(),this.load_time=Math.round((this.time_end-this.time_start)/1e3),this.setNewData(this.updateSet(this.userData.progress)),t.onFinishUpdate()))},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},createSet:function(){return this.updateSet(0)},applyAlpha:function(){},addPort:function(e,t){return this._super(e,t),e}})},da32941d39823d668307:e=>{function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function n(){var e,t,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",r=a.toStringTag||"@@toStringTag";function s(a,n,i,r){var s=n&&n.prototype instanceof c?n:c,u=Object.create(s.prototype);return o(u,"_invoke",function(a,n,o){var i,r,s,c=0,u=o||[],d=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,a){return i=t,r=0,s=e,p.n=a,l}};function h(a,n){for(r=a,s=n,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],h=p.p,f=i[2];a>3?(o=f===n)&&(s=i[(r=i[4])?5:(r=3,3)],i[4]=i[5]=e):i[0]<=h&&((o=a<2&&h<i[1])?(r=0,p.v=n,p.n=i[1]):h<f&&(o=a<3||i[0]>n||n>f)&&(i[4]=a,i[5]=n,p.n=f,r=0))}if(o||a>1)return l;throw d=!0,n}return function(o,u,f){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,f),r=u,s=f;(t=r<2?e:s)||!d;){i||(r?r<3?(r>1&&(p.n=-1),h(r,s)):p.n=s:p.v=s);try{if(c=2,i){if(r||(o="next"),t=i[o]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,r<2&&(r=0)}else 1===r&&(t=i.return)&&t.call(i),r<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),r=1);i=e}else if((t=(d=p.n<0)?s:a.call(n,p))!==l)break}catch(t){i=e,r=1,s=t}finally{c=1}}return{value:t,done:d}}}(a,i,r),!0),u}var l={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var p=[][i]?t(t([][i]())):(o(t={},i,(function(){return this})),t),h=d.prototype=c.prototype=Object.create(p);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,r,"GeneratorFunction")),e.prototype=Object.create(h),e}return u.prototype=d,o(h,"constructor",d),o(d,"constructor",u),u.displayName="GeneratorFunction",o(d,r,"GeneratorFunction"),o(h),o(h,r,"Generator"),o(h,i,(function(){return this})),o(h,"toString",(function(){return"[object Generator]"})),(n=function(){return{w:s,m:f}})()}function o(e,t,a,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}o=function(e,t,a,n){function r(t,a){o(e,t,(function(e){return this._invoke(t,a,e)}))}t?i?i(e,t,{value:a,enumerable:!n,configurable:!n,writable:!n}):e[t]=a:(r("next",0),r("throw",1),r("return",2))},o(e,t,a,n)}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function r(e,t,a,n,o,i,r){try{var s=e[i](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function s(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var i=e.apply(t,a);function s(e){r(i,n,o,s,l,"next",e)}function l(e){r(i,n,o,s,l,"throw",e)}s(void 0)}))}}function l(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=i(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}var u=function(){return e=function e(t,a,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$http=t,this.settings=a,this.embeddingService=n},a=[{key:"storeComponent",value:(c=s(n().m((function e(t){var a,o,r,s;return n().w((function(e){for(;;)switch(e.p=e.n){case 0:if(a="".concat(this.settings.context||"","/qdrant/granular/store"),e.p=1,t.id){e.n=2;break}throw new Error("Component is missing required id property");case 2:return t.text_representation||(console.warn("Component ".concat(t.id," is missing text_representation, creating fallback")),t.text_representation=this.createFallbackTextRepresentation(t)),t.nodes&&Array.isArray(t.nodes)||(console.warn("Component ".concat(t.id," has missing or invalid nodes array")),t.nodes=t.nodes||[]),t.connections&&Array.isArray(t.connections)||(console.warn("Component ".concat(t.id," has missing or invalid connections array")),t.connections=t.connections||[]),t.name&&"object"===i(t.name)||(console.warn("Component ".concat(t.id," has missing or invalid name object")),t.name={generic_name:t.name||"Component ".concat(t.id),specific_instance:null}),console.log("Calling backend to store granular component ID: ".concat(t.id)),e.n=3,this.$http.post(a,{component:t});case 3:if(!(o=e.v).data||!o.data.success){e.n=4;break}return console.log("Backend successfully stored granular component ID: ".concat(o.data.id)),e.a(2,o.data.id);case 4:throw console.error("Backend failed to store granular component:",o.data),new Error((null===(r=o.data)||void 0===r?void 0:r.error)||"Unknown error storing granular component via backend");case 5:e.n=7;break;case 6:throw e.p=6,s=e.v,console.error("Error calling backend to store granular component ID ".concat(t.id,":"),s),new Error("Failed to store component ".concat(t.id,": ").concat(s.message));case 7:return e.a(2)}}),e,this,[[1,6]])}))),function(e){return c.apply(this,arguments)})},{key:"createFallbackTextRepresentation",value:function(e){var t=this,a=[];if(e.component_type?a.push("This is a ".concat(e.component_type," component")):a.push("This is a component in the ".concat(e.category," category")),e.name&&e.name.generic_name&&a.push("It functions as a ".concat(e.name.generic_name)),e.description&&a.push(e.description),e.nodes&&e.nodes.length>0){var n=[];e.nodes.forEach((function(e){if(e.node_class_name){var a={"draw2d.shape.fishbone.cell.SQLnode":"SQL operations","draw2d.shape.fishbone.cell.Transformnode":"data transformation","draw2d.shape.fishbone.ra.RaEchartAdapter":"chart visualization","draw2d.shape.fishbone.ra.RaVegaChart":"vega visualization","draw2d.shape.fishbone.ra.RaTableAdapter":"data table","draw2d.shape.fishbone.cell.HTMLnode":"HTML content"}[e.node_class_name]||e.node_class_name;if(e.properties)if(e.node_class_name.includes("SQLnode")&&e.properties.sql)a+=" that works with ".concat(t.extractTablesFromSQL(e.properties.sql));else if(e.node_class_name.includes("Chart")&&e.properties.chart_type)a+=" showing a ".concat(e.properties.chart_type);else if(e.node_class_name.includes("Transformnode")&&e.properties.transform){var o=Array.isArray(e.properties.transform)?e.properties.transform.map((function(e){return e.type})).join(", "):"transformation";a+=" performing ".concat(o)}n.push(a)}})),n.length>0&&a.push("The component contains: ".concat(n.join("; ")))}return e.input_requirements&&(e.input_requirements.required_fields&&e.input_requirements.required_fields.length&&a.push("Requires input fields: ".concat(e.input_requirements.required_fields.join(", "))),e.input_requirements.description&&a.push("Input requirements: ".concat(e.input_requirements.description))),e.output_specification&&(e.output_specification.output_fields&&e.output_specification.output_fields.length&&a.push("Produces output fields: ".concat(e.output_specification.output_fields.join(", "))),e.output_specification.description&&a.push("Output specification: ".concat(e.output_specification.description))),e.tags&&e.tags.length>0&&a.push("Related concepts: ".concat(e.tags.join(", "))),a.join(". ")}},{key:"extractTablesFromSQL",value:function(e){var t=e.match(/from\s+([a-z0-9_\.]+)/i),a=e.match(/join\s+([a-z0-9_\.]+)/gi),n=[];return t&&t[1]&&n.push(t[1]),a&&a.forEach((function(e){var t=e.replace(/join\s+/i,"").trim();n.push(t)})),n.join(", ")}},{key:"search",value:(r=s(n().m((function e(t){var a,o,i,r,s,l,c,u,d,p,h;return n().w((function(e){for(;;)switch(e.p=e.n){case 0:if(a=t.query,o=t.filters,i=void 0===o?{}:o,r=t.limit,s=void 0===r?5:r,l=t.score_threshold,c=void 0===l?.55:l,a&&"string"==typeof a){e.n=1;break}return console.warn("Invalid or missing search query"),e.a(2,[]);case 1:return u="".concat(this.settings.context||"","/qdrant/granular/search"),e.p=2,console.log('Searching for granular components with query: "'.concat(a,'"')),console.log("Filters:",i),d={query:a,filters:i,limit:s,score_threshold:c},e.n=3,this.$http.post(u,d);case 3:if(!(p=e.v).data||!Array.isArray(p.data)){e.n=4;break}return console.log("Found ".concat(p.data.length," matching components")),e.a(2,p.data);case 4:return console.warn("Backend returned unexpected format for component search:",p.data),e.a(2,[]);case 5:e.n=7;break;case 6:return e.p=6,h=e.v,console.error("Error searching for granular components:",h),e.a(2,[]);case 7:return e.a(2)}}),e,this,[[2,6]])}))),function(e){return r.apply(this,arguments)})},{key:"batchSearch",value:(o=s(n().m((function e(a){var o,i,r,s,l,c,u,d,p,h,f=arguments;return n().w((function(e){for(;;)switch(e.p=e.n){case 0:o=f.length>1&&void 0!==f[1]?f[1]:{},i={},r=t(a),e.p=1,r.s();case 2:if((s=r.n()).done){e.n=8;break}if(l=s.value,e.p=3,c=l.search_text||""){e.n=4;break}return console.warn("No search text available for node ".concat(l.nodeId,", skipping")),i[l.nodeId]={nodePattern:l,components:[],error:"No search text available"},e.a(3,7);case 4:return u={query:c,limit:o.limit||2,score_threshold:o.score_threshold||.5},e.n=5,this.search(u);case 5:d=e.v,i[l.nodeId]={nodePattern:l,components:d},e.n=7;break;case 6:e.p=6,p=e.v,console.error("Error in batch search for node ".concat(l.nodeId,":"),p),i[l.nodeId]={nodePattern:l,components:[],error:p.message};case 7:e.n=2;break;case 8:e.n=10;break;case 9:e.p=9,h=e.v,r.e(h);case 10:return e.p=10,r.f(),e.f(10);case 11:return e.a(2,i)}}),e,this,[[3,6],[1,9,10,11]])}))),function(e){return o.apply(this,arguments)})}],a&&l(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,a,o,r,c}();e.exports=u},ddb769317bccdb9508d6:(e,t,a)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e,t,a){return(t=l(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function s(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}var c=a("5f70f5db0bc3dc9cd6c8"),u=function(){return e=function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nodeTypeMapping=c.nodeTypeMapping,this.nodeTypeReverseMapping={},Object.entries(this.nodeTypeMapping).forEach((function(e){var a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e,2),n=a[0],o=a[1];t.nodeTypeReverseMapping[o]=parseInt(n,10)})),this.nodeTypeProperties={1:["proj_id","proj_name","proj_code"],2:["du_model_id","du_model_name"],3:["scope_task_id","scope_task_code","scope_task_name"],4:["field_code","field_name"],5:["sql"],6:[],7:["transform"],8:["cont_id","dataset","config"],9:["cont_id","spec","vega","leaflet","vis_target"],10:["cont_id","config","renderer","menu","theme"],11:["cont_id","html","binder","params"],12:["style"],13:["do"],14:["filter","cont_id","win_size","message","showBusket"],15:["apiid","params"]}},t=[{key:"normalize",value:function(e){var t=this,a=this.extractNodes(e),n=this.extractConnections(e);return{report_config:{nodes:a.map((function(e){return t.normalizeNode(e)})),connections:n.map((function(e){return t.normalizeConnection(e)}))}}}},{key:"extractNodes",value:function(e){return Array.isArray(e)?e:e.nodes&&Array.isArray(e.nodes)?e.nodes:e.report_config&&e.report_config.nodes?e.report_config.nodes:(console.warn("Unknown config format, couldn't extract nodes:",e),[])}},{key:"extractConnections",value:function(e){return e.connections&&Array.isArray(e.connections)?e.connections:e.report_config&&e.report_config.connections?e.report_config.connections:[]}},{key:"normalizeNode",value:function(e){var t;e.id||(e.id=this.generateId("node")),t="string"==typeof e.class&&this.nodeTypeReverseMapping[e.class]||e.class;var a={id:e.id,class:t,label:e.label||e.id};return this.addTypeSpecificProperties(a,e),a}},{key:"addTypeSpecificProperties",value:function(e,t){var a=this,n=e.class;if((this.nodeTypeProperties[n]||[]).forEach((function(o){void 0!==t[o]&&(e[o]=a.normalizeProperty(o,t[o],n))})),7===n&&t.transform)if("string"==typeof t.transform)try{e.transform=JSON.parse(t.transform)}catch(a){console.warn("Failed to parse transform string for node ".concat(t.id,":"),a),e.transform=[]}else e.transform=t.transform}},{key:"normalizeProperty",value:function(e,t,a){return t}},{key:"normalizeConnection",value:function(e){var t=e.src||e.source,a=e.trgt||e.target;return t&&a||console.warn("Invalid connection missing source or target:",e),{src:t,trgt:a}}},{key:"generateId",value:function(){return"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"node","_").concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,9))}},{key:"denormalize",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.useClassNames,r=void 0!==n&&n,s=a.connectionFormat,l=void 0===s?"src_trgt":s,c=e.report_config,u=c.nodes,d=c.connections,p=u.map((function(e){var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e);return r&&"number"==typeof e.class&&(a.class=t.nodeTypeMapping[e.class]||e.class),a}));return{report_config:{nodes:p,connections:d.map((function(e){return"source_target"===l?{source:e.src,target:e.trgt}:{src:e.src,trgt:e.trgt}}))}}}}],t&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();e.exports=u},dede6fc4547c97d8de66:()=>{},e0605142b99680f9b01a:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.cell.Addnode=n.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Addnode",INFO:'{Class: <strong>draw2d.shape.fishbone.cell.Addnode"</strong>}<br/><br/>',init:function(e,t,a,n){this._super(o.extend({color:"#9a9a9a",filter_str:"Summ",data_type:"row"},e),t,a,n),this.help="Node witch is simply adds all attached nodes site lists into common list with new 'item name' according to given label.Useful in cases when you need to count totals for group of nodes, or when need to 'join' UDF/Code lists with similar data. Always adds all sites from all lists without conditions.";var i=this;o.extend(this.userData,{sites_list_out:[],label:"New Label",type_name:"add"}),o.extend(!0,this.treema_scheme,{additionalProperties:!0,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{type_name:{type:"string",title:"Type Name",default:"add"},bypass_mode:{type:"boolean",title:"Bypass mode",default:!1}}}),this.updateTable=function(){DEBUG&&console.log("add updateTable"),i.userData.sites_list_out=[],i.userData.row.length>0&&i.userData.row.forEach((function(e,t){e.sites_list_out.forEach((function(t,a){var n={},o=i.userData.label;n.site_id=t.site_id,n.site_code=t.site_code,t.du_model_name&&(n.du_model_name=t.du_model_name),t.du_id&&(n.du_id=t.du_id),t.status&&(n.status=t.status),t.my_date&&(n.my_date=t.my_date),n[o]=e.item_name,n.value=t[e.item_name]||t.my_date,i.userData.bypass_mode?n.task_name=t.task_name:n.task_name=i.userData.label,n.task_type=i.userData.type_name,n.group_name=i.userData.group_name,i.userData.sites_list_out.push(n)}))})),i.userData.value=i.userData.sites_list_out.length,i.userData.sites_list_out.forEach((function(e,t){})),i.getPort("output0").setUserData({project:i.project,scope:i.scope,sop:i.sop,item_name:i.userData.label,sites_list_out:i.userData.sites_list_out}),i.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(i.getId()),t.setColor(i.frame.attr("stroke"))}),this)),this.updateUI(),i.stopTimer()}}})},e4cbf67c36f0a042bd43:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";var r_chart_analytics__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("0322dadfea5e4c6eb795"),draw2d=__webpack_require__("8a868d10b6533e768658"),$=__webpack_require__("a45670b3d8fb79ec0258"),jQuery=__webpack_require__("a45670b3d8fb79ec0258"),settings=__webpack_require__("6fe5e339b0f8a936ba8c"),jinqJs=__webpack_require__("1bf2fbdb051fe0c57024");draw2d.shape.fishbone.ra.Add_RaDataNodeGroup=draw2d.SetFigure.extend({NAME:"draw2d.shape.fishbone.ra.Add_RaDataNodeGroup",INFO:"\tComing SOON!",init:function(e,t,a){this._super($.extend({stroke:0,bgColor:null,width:200,height:200},e),t,a);var n=this;this.updateTickets=0,this.updateTicketsIteration=0;var o=new draw2d.DataInputPort,i=new draw2d.layout.locator.LeftLocator;o.setConnectionDirection(3),o.setName("dataInput"),this.addPort(o,i),o.setMaxFanOut(10),this.createPort("output"),this.layoutPorts(),this.sites_list_in=[];var r=this.getUserData(),s=new Date;null===r&&this.attr({userData:{hidden:!1,autoWidth:!1,barHeight:30,start_date:new Date(s.getFullYear(),0,1).toLocaleDateString(),showInConnections:!0,showOutConnections:!0,showProgress:!0,valueFontSize:28,labelFontSize:18,size:{width:350,height:350},col:[],tasks:[],index:0}}),this.setDimension(this.userData.size.width,this.userData.size.height),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},autoWidth:{type:"boolean",title:"Auto Width",default:!1},start_date:{type:"string",title:"Start Date",format:"date",default:""},end_date:{type:"string",title:"End Date",format:"date",default:""},size:{type:"object",title:"Size",properties:{width:{type:"integer",default:350},height:{type:"integer",default:350}}},barHeight:{type:"integer",title:"Item Height",default:30},valueFontSize:{type:"integer",title:"Value label Font Size",default:28},labelFontSize:{type:"integer",title:"Name label Font Size",default:18},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showOutConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0},showProgress:{type:"boolean",title:"Show Progress",default:!0},col:{type:"array",title:"Columns",items:{type:"object",title:"Col",properties:{item_name:{title:"Name",type:"string",default:"name"},sites_list_out:{type:"array",title:"Sites List",format:"hidden",items:{type:"object",title:"Site",properties:{site_id:{type:"string",title:"Site ID",default:""},site_code:{type:"string",title:"Site Code",default:""},my_date:{type:"object",title:"Date",properties:{}},col_name:{type:"string",title:"Column Name",default:""},task_type:{type:"string",title:"Task Type",default:""}}}},project:{type:"object",title:"Project",format:"hidden",properties:{proj_id:{title:"Project ID",type:"string",default:""},proj_name:{title:"Project Name",type:"string",default:""},proj_code:{title:"Project Code",type:"string",default:""}},required:["proj_id","proj_name","proj_code"]},scope:{type:"object",title:"Scope",format:"hidden",properties:{scope_id:{type:"string",default:""},scope_name:{type:"string",default:""}},required:["scope_id","scope_name"]}}}},tasks:{type:"array",title:"Tasks",items:{type:"object",title:"Task",properties:{isNew:{type:"boolean",format:"hidden",default:!0},name:{type:"string",title:"Name",default:""},baseline:{type:"object",title:"Baseline",default:{task_type:"baseline",show:!0,data_type:"real time",fixed_data:[],value:0},properties:{task_type:{type:"string",title:"Task Type",default:"baseline",enum:["baseline"]},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},show:{type:"boolean",title:"Show",default:!1},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}},value:{type:"integer",title:"Current Value",default:0}}},forecast:{type:"object",title:"Forecast",default:{task_type:"forecast",show:!0,data_type:"real time",fixed_data:[],value:0},properties:{task_type:{type:"string",title:"Task Type",default:"forecast",enum:["forecast"]},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},show:{type:"boolean",title:"Show",default:!1},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}},value:{type:"integer",title:"Current Value",default:0}}},actual:{type:"object",title:"Actual",default:{task_type:"actual",data_type:"real time",show:!0,task:{scope_task_code:"",scope_task_name:"Task Name",scope_task_id:""},multy_milestone:!1,multy_milestones:[{scope_task_code:"",scope_task_name:"Task Name 1",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 2",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 3",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 4",scope_task_id:""},{scope_task_code:"",scope_task_name:"Task Name 5",scope_task_id:""}],conditions:[{logic:"",preset:"custom",prop:"self",sign:"not equal",value:"empty"}],value:0,fixed_data:[],label:"",text_color:"#838383",font_size:18,sites_list_out:[],info:["this Week","this Month","Yesterday","Today"]},properties:{show:{type:"boolean",title:"Show",default:!1},data_type:{type:"string",title:"Data Type",default:"real time",enum:["real time","fixed month","fixed week"]},task_type:{type:"string",title:"Task Type",default:"actual",enum:["baseline","forecast","actual"]},count_type:{type:"string",title:"Count Type",default:"physical",enum:["physical","logical"]},multy_milestone:{type:"boolean",title:"Is Multi Milestone",default:!1},multy_milestones:{type:"array",title:"Milestones List",items:{type:"object",title:"Task",format:"taskcodeq",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}}},task:{type:"object",title:"Task",format:"taskcodeq",properties:{scope_task_code:{type:"string",default:""},scope_task_name:{type:"string",default:"Task Name"},scope_task_id:{type:"string",default:""}}},conditions:{type:"array",title:"Filter",items:{type:"object",properties:{logic:{type:"string",default:"",enum:["","and","or"]},preset:{type:"string",default:"custom",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]},prop:{type:"string",default:"self"},sign:{type:"string",default:"not equal",enum:["","not equal","equal","more","less","less or equal","more or equal"]},value:{type:"string",format:"date",default:"empty"}},required:["logic","prop","sign","value"]}},fixed_data:{type:"array",title:"Fixed Data",items:{type:"object",title:"Data Item",default:{year:"2017",month:"January",week:1,value:0},properties:{additionalProperties:!1,year:{title:"Year",type:"string",default:"2017",enum:["2019","2020","2021","2022","2023"]},month:{title:"Month",type:"string",default:"January",enum:["January","February","March","April","May","June","July","August","September","October","November","December"]},week:{title:"Week",type:"integer",default:1},value:{title:"Value",type:"integer",default:0}}}},isEditedLabel:{type:"boolean",format:"hidden",default:!1},label:{type:"string",default:""},font_size:{type:"integer",title:"Font Size",default:18},text_color:{type:"string",title:"Text_color",default:"#838383"},sites_list_out:{type:"array",format:"hidden",items:{type:"object",title:"Site",properties:{site_code:{type:"string",title:"Site Code"},site_name:{type:"string",title:"Site Name"},site_id:{type:"string",title:"Site ID"}}}},value:{type:"integer",title:"Current Value",default:0},info:{type:"array",title:"Additional Info",items:{type:"string",title:"Info Type",default:"this Month",enum:["custom","not Empty","Empty","EOM","this Year","this Month","this Week","Today","last Year","last Month","last Week","Yesterday","next Year","next Month","next Week","Tomorrow"]}}}}}}},index:{type:"integer",title:"Mobile Index",default:0}}},this.on("contextmenu",(function(e,t){$.contextMenu({selector:"body",events:{hide:function(){$.contextMenu("destroy")}},callback:$.proxy((function(e,t){switch(e){case"toogleInCon":setTimeout((function(){n.toogleInConn()}),10);break;case"toogleOutCon":setTimeout((function(){n.toogleOutConn()}),10)}}),this),x:t.x,y:t.y,items:{toogleInCon:n.userData.showInConnections?{name:"Hide In Connections"}:{name:"Show In Connections"},toogleOutCon:n.userData.showOutConnections?{name:"Hide Out Connections"}:{name:"Show Out Connections"}}})})),this.updateUI=function(){},this.GetHTTPData=function(){n.userData.tasks=[],n.sites_list_in=[],this.getInputPorts().data.forEach((function(e,t){e.getConnections().each($.proxy((function(e,t){var a=t.getSource().getParent();n.sites_list_in=n.sites_list_in.concat(a.sites_list_in),a.userData.tasks&&a.userData.tasks.length&&a.userData.tasks.forEach((function(e,t){n.userData.tasks[t]?(n.userData.tasks[t].isNew=!1,n.userData.tasks[t].actual&&n.userData.tasks[t].actual.show&&(n.userData.tasks[t].actual.value=n.userData.tasks[t].actual.value+e.actual.value,n.userData.tasks[t].actual.sites_list_out=n.userData.tasks[t].actual.sites_list_out.concat(e.actual.sites_list_out)),n.userData.tasks[t].forecast&&n.userData.tasks[t].forecast.show&&(n.userData.tasks[t].forecast.value=n.userData.tasks[t].forecast.value+e.forecast.value,n.userData.tasks[t].forecast.sites_list_out=n.userData.tasks[t].forecast.sites_list_out.concat(jQuery.extend(!0,{},e.actual.sites_list_out))),n.userData.tasks[t].baseline&&n.userData.tasks[t].baseline.show&&(n.userData.tasks[t].baseline.value=n.userData.tasks[t].baseline.value+e.baseline.value,n.userData.tasks[t].baseline.sites_list_out=n.userData.tasks[t].baseline.sites_list_out.concat(jQuery.extend(!0,{},e.actual.sites_list_out)))):(n.userData.tasks.push(jQuery.extend(!0,{},e)),n.userData.tasks[t].isNew=!0)}))}),this))})),n.updateTable(),n.userData.tasks.length&&n.userData.tasks.forEach((function(e,t){var a=n.getPort("output0");a.setId(e.ID),a.setUserData({project:n.project,scope:n.scope,item_name:e.name,task_type:e.actual.task_type,sites_list_out:e.actual.sites_list_out}),n.getOutputPort(0).getConnections().each($.proxy((function(e,t){t.getTarget().setValue(n.getId()),t.setColor(n.getColor())}),this))}))},this.updateTable=function(){n.setDimension(this.userData.size.width,this.userData.size.height),this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,n.initDataUpdate()},this.initDataUpdate=function(){(0,r_chart_analytics__WEBPACK_IMPORTED_MODULE_0__.w)(this)},this.setNewData=function(e){n.svgNodes.remove(),n.svgNodes=e,n.applyTransformation(),n.repaint()},this.startAnimation=function(e){this.canvas.paper.setStart();var t=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"Loading...");t.attr({fill:"#777",stroke:"none",opacity:0,"font-size":24,"font-weight":"bold"}),t.stop().animate({opacity:1},e,"elastic");var a=this.canvas.paper.setFinish();this.setNewData(a)},this.updateSearchCol=function(e,t,a,n){var o,i,r=(o=settings.context+"/data/getAllTasks?scope_id="+t.scope_id+"&proj_id="+e.proj_id,i=function(){this.super("constructor").apply(this,arguments)},DatabaseSearchTreemaNode.extend(i),i.prototype.url=o,i.prototype.formatDocument=function(e){return e.scope_task_code+" "+e.scope_task_name},i.prototype.buildValueForDisplay=function(e,t){var a;return a=t?this.formatDocument(t):"None",this.buildValueForDisplaySimply(e,a)},i.prototype.search=function(){var e;if((e=this.getValEl().find("input").val())!==this.lastTerm&&(this.lastTerm&&!e&&this.getSearchResultsEl().empty(),e)){this.lastTerm=e,this.getSearchResultsEl().empty().append("Searching");var t=this.searchCallback;$.ajax({url:this.url,datatype:"json",type:"GET",success:function(a){var n=(new jinqJs).from(a).where((function(t,a){return-1!==t.scope_task_code.toLowerCase().indexOf(e.toLowerCase())||-1!==t.scope_task_name.toLowerCase().indexOf(e.toLowerCase())})).select();t(n)}})}},i.prototype.saveChanges=function(){var e;(e=this.getSelectedResultEl()).length&&(this.data||(this.data={scope_task_id:"",scope_task_code:"",scope_task_name:""}),this.data.scope_task_id=e.data("value").scope_task_id,this.data.scope_task_code=e.data("value").scope_task_code,this.data.scope_task_name=e.data("value").scope_task_name)},i.prototype.searchCallback=function(e){var t=[],a=this.lastTerm.toLowerCase();e.forEach((function(n,o){var i=e[o];-1!==(i.scope_task_name+i.scope_task_code).toLowerCase().indexOf(a)&&t.push(i)})),this.super("searchCallback").apply(this,[t])},i);TreemaNode.setNodeSubclass("taskcodeq",r),a.project=e,a.scope=t,n&&(a.sop=n)}},applyAlpha:function(){},createShapeElement:function(){var e=this._super();return this.originalWidth=this.userData.size.width,this.originalHeight=this.userData.size.height,e},onPortValueChanged:function(e){var t=this;if(e.getValue().indexOf("ticket")>-1){this.updateTickets=this.updateTickets+1,DEBUG&&console.log("Add_RaDataNodeGroup update ticket received: "+this.updateTickets),this.startAnimation(1e3),this.updateTicketsIteration=this.updateTicketsIteration+e.userData.realCount;var a=0;this.userData.conn_count?a=this.userData.conn_count:this.getInputPorts().data.forEach((function(e,t){a+=e.getConnections().data.length})),this.updateTickets>=a&&this.getOutputPorts().data.forEach((function(e,a){e.getConnections().each($.proxy((function(e,a){var n=a.getTarget(),o=0;t.userData.tasks.forEach((function(e,t){e.actual&&e.actual.show&&o++,e.forecast&&e.forecast.show&&o++,e.baseline&&e.baseline.show&&o++})),n.userData||(n.userData={}),n.userData.realCount=o,n.setValue("ticket"),a.setColor("#dfdfdf"),t.updateTickets=0}),this))}))}else"dataInput"==e.name&&(this.updateTicketsIteration>0&&(this.updateTicketsIteration=this.updateTicketsIteration-1),this.updateTicketsIteration<=0&&(this.GetHTTPData(),this.updateUI()))},createSet:function(){this.canvas.paper.setStart();var e=this.canvas.paper.text(this.getWidth()/2,this.getHeight()/2,"No Data...");return e.attr({fill:"#777",stroke:"none",opacity:.5,"font-size":28,"font-weight":"bold"}),e.hover((function(){e.stop().animate({opacity:1},500,"elastic")}),(function(){e.stop().animate({opacity:.5},500,"elastic")})),this.canvas.paper.setFinish()},getPersistentAttributes:function(){var e=this._super();return e.labels=[],this.children.each((function(t,a){var n=a.figure.getPersistentAttributes();n.locator=a.locator.NAME,e.labels.push(n)})),e},setPersistentAttributes:function setPersistentAttributes(memento){this._super(memento),this.resetChildren(),$.each(memento.labels,$.proxy((function(i,json){var figure=eval("new "+json.type+"()");figure.attr(json);var locator=eval("new "+json.locator+"()");this.add(figure,locator)}),this))}})},e79fd53960fa36fad429:(e,t,a)=>{var n={"./af":"4fe50ffc7983d80569ba","./af.js":"4fe50ffc7983d80569ba","./ar":"3f7f6568c894fbb46c29","./ar-dz":"0a4b0969f58fca504d02","./ar-dz.js":"0a4b0969f58fca504d02","./ar-kw":"9dc1adf1367a833c5dde","./ar-kw.js":"9dc1adf1367a833c5dde","./ar-ly":"cccb904b2f064b592b02","./ar-ly.js":"cccb904b2f064b592b02","./ar-ma":"d81c92a0aa9e6c084db4","./ar-ma.js":"d81c92a0aa9e6c084db4","./ar-ps":"bda8e25f4dec273fb8f7","./ar-ps.js":"bda8e25f4dec273fb8f7","./ar-sa":"dee24f02b8ecd3a36176","./ar-sa.js":"dee24f02b8ecd3a36176","./ar-tn":"df08077061459e88529b","./ar-tn.js":"df08077061459e88529b","./ar.js":"3f7f6568c894fbb46c29","./az":"9a25880d1491856f4e1e","./az.js":"9a25880d1491856f4e1e","./be":"ffa801cad665eebbfdc8","./be.js":"ffa801cad665eebbfdc8","./bg":"c81c2298ba3a83bd3b5b","./bg.js":"c81c2298ba3a83bd3b5b","./bm":"0d5fb61f772f2aaaf82c","./bm.js":"0d5fb61f772f2aaaf82c","./bn":"fa658b93b3c6b01c668e","./bn-bd":"e7114e48cf4eb0e1e35a","./bn-bd.js":"e7114e48cf4eb0e1e35a","./bn.js":"fa658b93b3c6b01c668e","./bo":"b30d6122d9094906930a","./bo.js":"b30d6122d9094906930a","./br":"ee0a94b9013e4e7ae788","./br.js":"ee0a94b9013e4e7ae788","./bs":"89a9e5355865ee89e959","./bs.js":"89a9e5355865ee89e959","./ca":"0a16bdb66e0525c325dc","./ca.js":"0a16bdb66e0525c325dc","./cs":"b7a0f42b9110b4ba030f","./cs.js":"b7a0f42b9110b4ba030f","./cv":"2b90ff6f0e337e46d5d6","./cv.js":"2b90ff6f0e337e46d5d6","./cy":"0d0ea3473f47b0d7b396","./cy.js":"0d0ea3473f47b0d7b396","./da":"7a8735ec68591dea5f8e","./da.js":"7a8735ec68591dea5f8e","./de":"5f6fa986f8050423684e","./de-at":"7f7e87a36ad679cf294c","./de-at.js":"7f7e87a36ad679cf294c","./de-ch":"f949125f8f7b0502a634","./de-ch.js":"f949125f8f7b0502a634","./de.js":"5f6fa986f8050423684e","./dv":"3073d71361f604d2822a","./dv.js":"3073d71361f604d2822a","./el":"4130747efcded86a1698","./el.js":"4130747efcded86a1698","./en-au":"517cd2b76c171df54c77","./en-au.js":"517cd2b76c171df54c77","./en-ca":"eb450040fb739424b607","./en-ca.js":"eb450040fb739424b607","./en-gb":"594dc41e90bb0b4ce7b3","./en-gb.js":"594dc41e90bb0b4ce7b3","./en-ie":"7f1a2a614d100ed33e07","./en-ie.js":"7f1a2a614d100ed33e07","./en-il":"3d148bdee40eb371501e","./en-il.js":"3d148bdee40eb371501e","./en-in":"efab154d10d71a47a002","./en-in.js":"efab154d10d71a47a002","./en-nz":"a04dc64dfdfc9ac4210a","./en-nz.js":"a04dc64dfdfc9ac4210a","./en-sg":"c6c8169a849376a0792c","./en-sg.js":"c6c8169a849376a0792c","./eo":"d8aa3f4072118ba0c74b","./eo.js":"d8aa3f4072118ba0c74b","./es":"8dca363c55e082fe5270","./es-do":"24f7ae66e6bdc8652fba","./es-do.js":"24f7ae66e6bdc8652fba","./es-mx":"45bf59610a785a7235b4","./es-mx.js":"45bf59610a785a7235b4","./es-us":"8c156bbc319a64186fe9","./es-us.js":"8c156bbc319a64186fe9","./es.js":"8dca363c55e082fe5270","./et":"0207368f4fca00662d61","./et.js":"0207368f4fca00662d61","./eu":"4d24b542827f0d35c2d4","./eu.js":"4d24b542827f0d35c2d4","./fa":"9cf1585e02829dff5f9a","./fa.js":"9cf1585e02829dff5f9a","./fi":"5b8ee8fca9bd9b066e05","./fi.js":"5b8ee8fca9bd9b066e05","./fil":"9b23dccf1a6c4a581e0a","./fil.js":"9b23dccf1a6c4a581e0a","./fo":"cef1ea44f0d3f6eb36e0","./fo.js":"cef1ea44f0d3f6eb36e0","./fr":"74e23c69ccb5a5eec403","./fr-ca":"f79130304d5016e13ffb","./fr-ca.js":"f79130304d5016e13ffb","./fr-ch":"f08607bde9b355fddbe5","./fr-ch.js":"f08607bde9b355fddbe5","./fr.js":"74e23c69ccb5a5eec403","./fy":"0d86e36306113c72bd77","./fy.js":"0d86e36306113c72bd77","./ga":"d67fee5c3c35fb7cd073","./ga.js":"d67fee5c3c35fb7cd073","./gd":"d9d35cbb598c476f7045","./gd.js":"d9d35cbb598c476f7045","./gl":"29e2d221e75f936e25f1","./gl.js":"29e2d221e75f936e25f1","./gom-deva":"e231ee82d139822aa7a7","./gom-deva.js":"e231ee82d139822aa7a7","./gom-latn":"d91ea0088c3c0ebdc87f","./gom-latn.js":"d91ea0088c3c0ebdc87f","./gu":"d1841a848065084c621c","./gu.js":"d1841a848065084c621c","./he":"624c722243ab1968c264","./he.js":"624c722243ab1968c264","./hi":"061d025a8797acc49a77","./hi.js":"061d025a8797acc49a77","./hr":"6a0c124ead216c897c0f","./hr.js":"6a0c124ead216c897c0f","./hu":"dce09320209f9a044b94","./hu.js":"dce09320209f9a044b94","./hy-am":"39a71a00fd6cfabeef30","./hy-am.js":"39a71a00fd6cfabeef30","./id":"a8eb5357a53ddba4d83c","./id.js":"a8eb5357a53ddba4d83c","./is":"0ccb71e8f62bf567199f","./is.js":"0ccb71e8f62bf567199f","./it":"35f77a330b2b59f483b2","./it-ch":"0a856ed5497f738d0cf5","./it-ch.js":"0a856ed5497f738d0cf5","./it.js":"35f77a330b2b59f483b2","./ja":"239d00735eb311c1c046","./ja.js":"239d00735eb311c1c046","./jv":"92711492583b83951b6d","./jv.js":"92711492583b83951b6d","./ka":"d31914898082af20b314","./ka.js":"d31914898082af20b314","./kk":"83d94a8a59b81194ec02","./kk.js":"83d94a8a59b81194ec02","./km":"331957b72f4beeaf2d4a","./km.js":"331957b72f4beeaf2d4a","./kn":"a0c1a30a96f4369ead33","./kn.js":"a0c1a30a96f4369ead33","./ko":"6de7f88f5c7d1ec2d27f","./ko.js":"6de7f88f5c7d1ec2d27f","./ku":"a9d2ef0fc91d568bdfab","./ku-kmr":"f20eeceab7ae1a61e346","./ku-kmr.js":"f20eeceab7ae1a61e346","./ku.js":"a9d2ef0fc91d568bdfab","./ky":"0747c8ca89dcf60580a2","./ky.js":"0747c8ca89dcf60580a2","./lb":"62019114b63dbd69721a","./lb.js":"62019114b63dbd69721a","./lo":"c2110f526b1ce19817cc","./lo.js":"c2110f526b1ce19817cc","./lt":"6df32c33af3d2e5fc11c","./lt.js":"6df32c33af3d2e5fc11c","./lv":"55b3e93988104c60a071","./lv.js":"55b3e93988104c60a071","./me":"e66100575f1ac6d00d4a","./me.js":"e66100575f1ac6d00d4a","./mi":"fd0033b452a90713b091","./mi.js":"fd0033b452a90713b091","./mk":"1ffc46d9756a7dd1c823","./mk.js":"1ffc46d9756a7dd1c823","./ml":"18c9a4d7cd02df34341e","./ml.js":"18c9a4d7cd02df34341e","./mn":"c6f0bab67f50b43fe8bb","./mn.js":"c6f0bab67f50b43fe8bb","./mr":"48ce3e4e5fdba4499ebb","./mr.js":"48ce3e4e5fdba4499ebb","./ms":"d892199478d896774453","./ms-my":"de1a2ccd001fe36ceecc","./ms-my.js":"de1a2ccd001fe36ceecc","./ms.js":"d892199478d896774453","./mt":"9b8ee8b32ab81129ffce","./mt.js":"9b8ee8b32ab81129ffce","./my":"b403e02a2233207d0c4d","./my.js":"b403e02a2233207d0c4d","./nb":"cb288475654d715d144b","./nb.js":"cb288475654d715d144b","./ne":"89e8ae3a87cc919f89a4","./ne.js":"89e8ae3a87cc919f89a4","./nl":"301790a531e8a33e9796","./nl-be":"3daa408e1685eb5e8fbd","./nl-be.js":"3daa408e1685eb5e8fbd","./nl.js":"301790a531e8a33e9796","./nn":"643270e1e47cf81f688e","./nn.js":"643270e1e47cf81f688e","./oc-lnc":"92d0c721d19969ceab74","./oc-lnc.js":"92d0c721d19969ceab74","./pa-in":"5c40bc9eec89d0d6802d","./pa-in.js":"5c40bc9eec89d0d6802d","./pl":"a4a8376f7fdb2d708907","./pl.js":"a4a8376f7fdb2d708907","./pt":"6177d8a6abfd93127496","./pt-br":"e20444730613ccb91ab4","./pt-br.js":"e20444730613ccb91ab4","./pt.js":"6177d8a6abfd93127496","./ro":"b2de2f54a02115863ee5","./ro.js":"b2de2f54a02115863ee5","./ru":"a884f82f1fcf323b0ed1","./ru.js":"a884f82f1fcf323b0ed1","./sd":"60abb66915d33f1d36b4","./sd.js":"60abb66915d33f1d36b4","./se":"40bfee84281d9b77f113","./se.js":"40bfee84281d9b77f113","./si":"a975fe4573e5d9e39086","./si.js":"a975fe4573e5d9e39086","./sk":"e0600ff36ac1e0dece75","./sk.js":"e0600ff36ac1e0dece75","./sl":"46cd6d95bdea594f4775","./sl.js":"46cd6d95bdea594f4775","./sq":"c043969c123ab5cd2b70","./sq.js":"c043969c123ab5cd2b70","./sr":"77fd666a52737f1efd7b","./sr-cyrl":"6868054dbb36f02db227","./sr-cyrl.js":"6868054dbb36f02db227","./sr.js":"77fd666a52737f1efd7b","./ss":"bbaffbb41ef7f4fd8c3a","./ss.js":"bbaffbb41ef7f4fd8c3a","./sv":"be84e9b3b463cb96fa5a","./sv.js":"be84e9b3b463cb96fa5a","./sw":"c35940c6626d2bccf0f9","./sw.js":"c35940c6626d2bccf0f9","./ta":"73e1ad1f793625d5e923","./ta.js":"73e1ad1f793625d5e923","./te":"96fe0dfde527a883c0a4","./te.js":"96fe0dfde527a883c0a4","./tet":"73089628077a1b3908a1","./tet.js":"73089628077a1b3908a1","./tg":"0481860a8ba35ca9d22d","./tg.js":"0481860a8ba35ca9d22d","./th":"4331da7acfa5f52746d6","./th.js":"4331da7acfa5f52746d6","./tk":"b71b455def61f8c8e7e9","./tk.js":"b71b455def61f8c8e7e9","./tl-ph":"b965a0000a1179485d25","./tl-ph.js":"b965a0000a1179485d25","./tlh":"a42a137c2d01e40c18cd","./tlh.js":"a42a137c2d01e40c18cd","./tr":"183a75bd2437f11817b2","./tr.js":"183a75bd2437f11817b2","./tzl":"42e54a873080a091cf1e","./tzl.js":"42e54a873080a091cf1e","./tzm":"48caaadb1d262b8d3df6","./tzm-latn":"d974062d0d2321cab039","./tzm-latn.js":"d974062d0d2321cab039","./tzm.js":"48caaadb1d262b8d3df6","./ug-cn":"2453f05ed409711cc1e1","./ug-cn.js":"2453f05ed409711cc1e1","./uk":"917876f36b35aa56a2cd","./uk.js":"917876f36b35aa56a2cd","./ur":"9c29a77b375c4c9c03a3","./ur.js":"9c29a77b375c4c9c03a3","./uz":"3b78af3fb5d1ef120da2","./uz-latn":"54ff3dc03d2cb362f2dc","./uz-latn.js":"54ff3dc03d2cb362f2dc","./uz.js":"3b78af3fb5d1ef120da2","./vi":"63f81a840f588ddc77ce","./vi.js":"63f81a840f588ddc77ce","./x-pseudo":"51f18a209d286b73de60","./x-pseudo.js":"51f18a209d286b73de60","./yo":"cc6e20f395448f8d5fc0","./yo.js":"cc6e20f395448f8d5fc0","./zh-cn":"a25e83e8799759c246e1","./zh-cn.js":"a25e83e8799759c246e1","./zh-hk":"1bec13affc76a58d17d9","./zh-hk.js":"1bec13affc76a58d17d9","./zh-mo":"d29754b2bb9cc48d33bc","./zh-mo.js":"d29754b2bb9cc48d33bc","./zh-tw":"dba649134b180837c44d","./zh-tw.js":"dba649134b180837c44d"};function o(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id="e79fd53960fa36fad429"},e80154e09aa49a466b2c:()=>{},ea0a1bcc6a0384be39dd:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.label.Label=n.shape.basic.Label.extend({NAME:"draw2d.shape.fishbone.label.Label",INFO:"{Class: <strong>draw2d.shape.fishbone.label.Label</strong>}<br/><br/>",init:function(e,t,a){this._super(o.extend({text:"Simple Label",color:"rgba(255, 255, 255, 0)",radius:10,padding:10,stroke:1},e),t,a);var i=this.getUserData(),r=this;null===i&&this.attr({userData:{hidden:!1,index:0,font:{font_size:18,font_color:"#000",font_family:"Tahoma, Geneva",font_bold:!0},back_color:"",frame_size:0,frame_color:"#989799",padding:10,text:"Simple Text"}}),this.installEditor(new n.ui.LabelInplaceMemoEditor({onCommit:o.proxy((function(e){this.userData.text=e}),this),onCancel:function(){}})),this.setParams=function(){r.setFontSize(this.userData.font.font_size),r.setFontColor(this.userData.font.font_color),r.setFontFamily(this.userData.font.font_family),r.setBackgroundColor(""===this.userData.back_color?null:this.userData.back_color),r.setStroke(this.userData.frame_size),r.setColor(this.userData.frame_color),r.setPadding(this.userData.padding),r.setBold(this.userData.font.font_bold),r.setText(this.userData.text)},this.setParams(),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},index:{type:"integer",title:"Mobile Index",default:0},font:{type:"object",additionalProperties:!1,properties:{font_size:{type:"integer",title:"Font Size",default:24},font_color:{type:"string",format:"colorpicker",title:"Font Color",default:"#000"},font_family:{type:"string",title:"Font Family",default:"Tahoma, Geneva"},font_bold:{type:"boolean",title:"Font Bold",default:!1}}},back_color:{type:"string",format:"colorpicker",title:"Back Color"},frame_size:{type:"integer",title:"Frame Size",default:1},frame_color:{type:"string",format:"colorpicker",title:"Frame Color",default:"#989799"},padding:{type:"integer",title:"Padding",default:10},text:{type:"string",title:"Text",default:"Simple Label"}}},this.GetHTTPData=function(){this.setParams()}}})},ea40259be55748181c7f:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("a7583c9a3ff76b2fdd52"),r=a("d1be49724a1f416e7f57"),s=a("8deafab7866a125bb9ca");n.shape.fishbone.cell.Filternode=n.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Filternode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Filternode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(o.extend({color:"#5c7db8",items:{filter:{name:"Filter",icon:"fas fa-filter",callback:function(){n.editor.selectFilterValues(s)}},sep:"---------"}},e),t,a,n);var s=this;o.extend(this.userData,{filter:{value:"All",field:"",params:[],searchInResult:!1,filter_list:[]},label:"",type_name:"gap",message:"Please select required items"}),o.extend(!0,this.treema_scheme,{additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{filter:{type:"object",title:"Filter",properties:{value:{type:"string",default:""},field:{type:"string",enum:[""]},params:{type:"array",title:"Param Fields",items:{type:"object",title:"Param Field",default:{field:""},properties:{field:{title:"Field Name",type:"string",default:"",enum:[""]},drop_list:{title:"Dropdown List",type:"array",items:{item:{title:"Item",default:"",type:"string"}}}}}},use_elip:{type:"boolean",title:"Use Ellipsis",default:!0},searchInResult:{type:"boolean",default:!1},filter_list:{type:"array",items:{type:"object",title:"Selection",properties:{value:{type:"string",title:"Value"},sites:{type:"integer",title:"Sites"}}}},select_one:{title:"Single Line",type:"boolean",default:!0},only_data_options:{title:"Only Data Options",type:"boolean",default:!0},use_sum:{title:"Use Sum(cnt)",type:"boolean",default:!0}}},label:{type:"string",format:"hidden",default:""},cont_id:{type:"string",title:"Cont ID",default:"filter1"},win_size:{title:"Window Size",type:"string",default:"lg",enum:["sm","lg","xl"]},message:{type:"string",default:"Please select required items"},type_name:{type:"string",title:"Type Name",default:"filter"},showBusket:{title:"Show Basket",type:"boolean",default:!0},filterOnLoad:{title:"Filter On Load",type:"boolean",default:!0},isInitiated:{title:"Filter Is Initiated",type:"boolean",default:!1}}}),this.updateContainer=function(){if(s.userData.cont_id){var e=o("#"+s.userData.cont_id);if(e){var t=e.find("input[type='text']");if(t){var a="";s.userData.filter.filter_list.forEach((function(e,t){s.userData.filter.use_elip?a=a+e.value.substring(0,10)+"...":t>0?a=a+","+e.value:a+=e.value})),t.val(a)}}}},this.updateTable=function(){if(s.userData.cont_id){var e=o("#"+s.userData.cont_id);if(e.length>0){var t=e.find("button[type='button']");if(0===t.length)if(0!==e.children().length&&e.hasClass("input-group"))e.find("button").length||(e.append('<button class="btn btn-outline-secondary" type="button" id="button-addon2">Set</button>'),t=e.find("button[type='button']"));else{var a,l,c=s.userData.label||(null===(a=s.userData.filter)||void 0===a?void 0:a.field)||"Filter",u=(null===(l=s.userData.filter)||void 0===l?void 0:l.value)||"All",d='\n                                <label class="input-group-text" for="'.concat(s.userData.cont_id,'">').concat(c,'</label>\n                                <input name="').concat(s.userData.cont_id,'" disabled type="text" class="form-control" value="').concat(u,'">\n                                <button class="btn btn-outline-secondary" type="button" id="button-addon2">Set</button>\n                            ');e.empty(),e.addClass("input-group input-group-sm mb-1"),e.html(d),t=e.find("button[type='button']")}if(t.length>0){var p;t.off("click"),t.click((function(){n.editor.selectFilterValues(s)}));var h=e.find('input[type="text"]');h.length>0&&null!==(p=s.userData.filter)&&void 0!==p&&p.value&&h.val(s.userData.filter.value)}}else console.warn("[Filternode] Container with id '".concat(s.userData.cont_id,"' not found. Filter UI cannot be attached."))}s.userData.filterOnLoad&&!s.userData.isInitiated?(n.editor.selectFilterValues(s,!0),s.userData.isInitiated=!0):(DEBUG&&console.log("Filter updateTable"),s.userData.sites_list_out=[],s.userData.row.length>0&&s.userData.row.forEach((function(e,t){if(s.userData.filter.field&&s.userData.filter.filter_list.length){var a="`"+s.userData.filter.field+"`",n="",o="",l="",c="",u="";s.userData.filter.filter_list.forEach((function(e,t){null!==e.value&&"blank"!==e.value&&"not blank"!==e.value&&"today"!==e.value&&"yesterday"!==e.value&&("number"==typeof e.value?n=n+" "+e.value+",":"string"==typeof e.value&&(n=n+"'"+e.value+"',")),"today"===e.value&&(c=a+" like '%"+i().format("YYYY-MM-DD")+"%'"),"yesterday"===e.value&&(u=a+" like '%"+i().subtract(1,"d").format("YYYY-MM-DD")+"%'"),"blank"===e.value&&(o=a+" IS NULL or "+a+" = '' "),"not blank"===e.value&&(l=a+" IS NOT NULL and "+a+" <> '' ")})),n=n.substring(0,n.length-1);var d="SELECT * FROM ? d left join ? f on d."+a+"=f.value WHERE ";""!==n&&(d=d+a+" in ("+n+") or "),""!==o&&(d=d+o+" or "),""!==l&&(d=d+l+" or "),""!==c&&(d=d+c+" or "),""!==u&&(d=d+u+" or "),d=d.substring(0,d.length-3),s.userData.sites_list_out=r(d,[e.sites_list_out,s.userData.filter.filter_list])}else s.userData.sites_list_out=e.sites_list_out.slice()})),s.updateContainer(),s.userData.value=s.userData.sites_list_out.length,s.getPort("output0").setUserData({project:s.project,scope:s.scope,sop:s.sop,item_name:s.userData.label||s.userData.filter.field,sites_list_out:s.userData.sites_list_out}),s.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(s.getId()),t.setColor(s.frame.attr("stroke"))}),this)),this.updateUI(),this.updateFilterOptionsList())},this.updateFilterOptionsList=function(){var e=[];e.push(""),this.userData.row.length&&this.userData.row[0].sites_list_out.length&&(r.options.columnlookup=this.userData.row[0].sites_list_out.length,r("RECORDSET OF SELECT * from ?",[this.userData.row[0].sites_list_out]).columns.forEach((function(t){e.push(t.columnid)}))),this.treema_scheme.properties.filter.properties.field.enum=e,this.treema_scheme.properties.filter.properties.params.items.properties.field.enum=e}},updateUI:function(){var e=this.getUserData();this.val_label.setText(e.value),this.userData.isEditedLabel?this.top_label.setText(this.userData.label):this.top_label.setText(e.filter.field),e.filter.filter_list.length?this.filter_label.setText(s.getList(e.filter.filter_list,"value")):this.filter_label.setText("All"),this._super(this)}})},eb82272f9c0ab8f405f9:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("d1be49724a1f416e7f57");n.shape.fishbone.cell.Joinnode=n.shape.fishbone.cell.Funcnode.extend({NAME:"draw2d.shape.fishbone.cell.Joinnode",INFO:"{Class: <strong>draw2d.shape.fishbone.cell.Joinnode</strong>}<br/><br/>",init:function(e,t,a,n){this._super(o.extend({color:"#5ed5d6",filter_str:"Join"},e),t,a,n);var r=this;o.extend(this.userData,{type:"LEFT",on:[],result:{fields:{}},label:"New Label",type_name:"join"}),o.extend(!0,this.treema_scheme,{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{type:{type:"string",title:"Type",enum:["LEFT","RIGHT","INNER","FULL OUTER"]},on:{additionalProperties:!1,type:"array",title:"On",default:{left:{col_name:"",is_null:!1},right:{col_name:"",is_null:!1}},items:{type:"object",title:"on:",properties:{left:{type:"object",title:"Left",properties:{col_name:{type:"string",title:"Column Name",enum:[]},is_null:{type:"boolean",title:"IS NULL",default:!1}}},right:{type:"object",title:"Right",properties:{col_name:{type:"string",title:"Column Name",enum:[]},is_null:{type:"boolean",title:"IS NULL",default:!1}}}}}},result:{type:"object",title:"Result",properties:{fields:{type:"object",title:"Fiels",default:{0:{field:"site_id",name:"site_id"}},properties:{0:{type:"object",properties:{field:{type:"string"},name:{type:"string"}}}}}}},using:{additionalProperties:!1,type:"array",title:"Using",items:{type:"object",title:"using:",properties:{column:{type:"string",title:"Field",enum:[]}}}},label:{type:"string",format:"hidden",default:"New Label"},type_name:{type:"string",title:"Type Name",default:"join"}}}),this.updateTable=function(){if(console.log("join updateTable"),r.userData.sites_list_out=[],r.userData.row.length>0){var e=[];r.userData.row.forEach((function(t,a){var n;if(0===a)e=t.sites_list_out.slice();else{var o="";r.userData.on&&r.userData.on.length&&(r.userData.on.forEach((function(e,t){o=o+" l.["+e.left.col_name+"] =  r.["+e.right.col_name+"] and "})),o=o.substring(0,o.length-4),n=i("SELECT l.*, r.* FROM ? AS l "+r.userData.type+" JOIN ? AS r ON "+o,[t.sites_list_out,e]),e=n)}r.userData.sites_list_out=e}))}r.userData.value=r.userData.sites_list_out.length,r.getPort("output0").setUserData({project:r.project,scope:r.scope,sop:r.sop,item_name:r.userData.label,sites_list_out:r.userData.sites_list_out}),r.getOutputPort(0).getConnections().each(o.proxy((function(e,t){t.getTarget().setValue(r.getId()),t.setColor(r.frame.attr("stroke"))}),this)),this.updateUI(),this.updateTreemaOptionsList()},this.updateTreemaOptionsList=function(){var e=[];if(e.push(""),this.userData.row[0]&&this.userData.row[0].sites_list_out.length)for(var t in this.userData.row[0].sites_list_out[0])e.push(t);if(this.treema_scheme.properties.on.items.properties.left.properties.col_name.enum=e,e=[],this.userData.row[1]&&this.userData.row[1].sites_list_out.length)for(var t in this.userData.row[1].sites_list_out[0])e.push(t);if(this.treema_scheme.properties.on.items.properties.right.properties.col_name.enum=e,r.userData.sites_list_out&&r.userData.sites_list_out.length){var a={},n={},o=0;for(var i in r.userData.sites_list_out[0])Object.prototype.hasOwnProperty.call(r.userData.sites_list_out[0],i)&&(a[o]={type:"object",properties:{field:{type:"string"},name:{type:"string"}}},n[o]={},n[o].field=i,n[o].name=i,o++);this.treema_scheme.properties.result.properties.fields.properties=a,this.treema_scheme.properties.result.properties.fields.default=n}}}})},ecd11d482b7058e382af:e=>{e.exports='/*!\n  Peity Vanila JS 0.0.8\n  Copyright © 2022 RailsJazz\n  https://railsjazz.com\n */\n\n(function (global, factory) {\n  typeof exports === \'object\' && typeof module !== \'undefined\' ? module.exports = factory() :\n      typeof define === \'function\' && define.amd ? define(factory) :\n          (global = typeof globalThis !== \'undefined\' ? globalThis : global || self, global.peity = factory());\n})(this, (function () { \'use strict\';\n\n  const isFunction = (o) =>\n      o !== null && typeof o === "function" && !!o.apply;\n\n  const svgElement = (tag, attrs) => {\n    const element = document.createElementNS("http://www.w3.org/2000/svg", tag);\n    for (var attr in attrs) {\n      element.setAttribute(attr, attrs[attr]);\n    }\n    return element;\n  };\n\n  const svgSupported =\n      "createElementNS" in document && svgElement("svg", {}).createSVGRect();\n\n  class Peity {\n    static defaults = {};\n    static graphers = {};\n\n    constructor(element, type, options = {}) {\n      this.element = element;\n      this.type = type;\n      this.options = Object.assign(\n          {},\n          Peity.defaults[this.type],\n          JSON.parse(element.dataset["peity"] || "{}"),\n          options\n      );\n\n      if(this.element._peity) {\n        this.element._peity.destroy();\n      }\n      this.element._peity = this;\n    }\n\n    draw() {\n      const options = this.options;\n      Peity.graphers[this.type](this);\n      if (isFunction(options.after)) options.after.call(this, options);\n    }\n\n    fill() {\n      var fill = this.options.fill;\n\n      return isFunction(fill)\n          ? fill\n          : function (_, i) {\n            return fill[i % fill.length];\n          };\n    }\n\n    prepare(width, height) {\n      if (!this.svg) {\n        this.element.style.display = "none";\n        this.element.after(\n            (this.svg = svgElement("svg", {\n              class: "peity",\n            }))\n        );\n      }\n\n      this.svg.innerHTML = "";\n      this.svg.setAttribute("width", width);\n      this.svg.setAttribute("height", height);\n\n      return this.svg;\n    }\n\n    get values() {\n      return this.element.innerText\n          .split(this.options.delimiter)\n          .map((value) => parseFloat(value));\n    }\n\n    mount() {\n      if (!svgSupported) return;\n\n      this.element.addEventListener("DOMSubtreeModified", this.draw.bind(this));\n      this.draw();\n\n      this.mounted = true;\n    }\n\n    unmount() {\n      this.element.removeEventListener("DOMSubtreeModified", this.draw);\n      this.svg.remove();\n      this.mounted = false;\n    }\n\n    destroy() {\n      this.unmount();\n\n      delete this.element._peity;\n    }\n\n    static register(type, defaults, grapher) {\n      Peity.defaults[type] = defaults;\n      Peity.graphers[type] = grapher;\n    }\n  }\n\n  const renderer$2 = (peity) => {\n    if (!peity.options.delimiter) {\n      const delimiter = peity.element.innerText.match(/[^0-9\\.]/);\n      peity.options.delimiter = delimiter ? delimiter[0] : ",";\n    }\n\n    let values = peity.values.map((n) => (n > 0 ? n : 0));\n\n    if (peity.options.delimiter == "/") {\n      let v1 = values[0];\n      let v2 = values[1];\n      values = [v1, Math.max(0, v2 - v1)];\n    }\n\n    let i = 0;\n    let length = values.length;\n    let sum = 0;\n\n    for (; i < length; i++) {\n      sum += values[i];\n    }\n\n    if (!sum) {\n      length = 2;\n      sum = 1;\n      values = [0, 1];\n    }\n\n    let diameter = peity.options.radius * 2;\n\n    const svg = peity.prepare(\n        peity.options.width || diameter,\n        peity.options.height || diameter\n    );\n\n    const width = svg.clientWidth;\n    const height = svg.clientHeight;\n    const cx = width / 2;\n    const cy = height / 2;\n\n    const radius = Math.min(cx, cy);\n    let innerRadius = peity.options.innerRadius;\n\n    if (peity.type == "donut" && !innerRadius) {\n      innerRadius = radius * 0.5;\n    }\n\n    const fill = peity.fill();\n\n    const scale = (value, radius) => {\n      const radians = (value / sum) * Math.PI * 2 - Math.PI / 2;\n\n      return [radius * Math.cos(radians) + cx, radius * Math.sin(radians) + cy];\n    };\n\n    let cumulative = 0;\n\n    for (i = 0; i < length; i++) {\n      const value = values[i];\n      const portion = value / sum;\n      let node;\n\n      if (portion == 0) continue;\n\n      if (portion == 1) {\n        if (innerRadius) {\n          const x2 = cx - 0.01;\n          const y1 = cy - radius;\n          const y2 = cy - innerRadius;\n\n          node = svgElement("path", {\n            d: [\n              "M",\n              cx,\n              y1,\n              "A",\n              radius,\n              radius,\n              0,\n              1,\n              1,\n              x2,\n              y1,\n              "L",\n              x2,\n              y2,\n              "A",\n              innerRadius,\n              innerRadius,\n              0,\n              1,\n              0,\n              cx,\n              y2,\n            ].join(" "),\n            "data-value": value,\n          });\n        } else {\n          node = svgElement("circle", {\n            cx: cx,\n            cy: cy,\n            "data-value": value,\n            r: radius,\n          });\n        }\n      } else {\n        const cumulativePlusValue = cumulative + value;\n\n        let d = ["M"].concat(\n            scale(cumulative, radius),\n            "A",\n            radius,\n            radius,\n            0,\n            portion > 0.5 ? 1 : 0,\n            1,\n            scale(cumulativePlusValue, radius),\n            "L"\n        );\n\n        if (innerRadius) {\n          d = d.concat(\n              scale(cumulativePlusValue, innerRadius),\n              "A",\n              innerRadius,\n              innerRadius,\n              0,\n              portion > 0.5 ? 1 : 0,\n              0,\n              scale(cumulative, innerRadius)\n          );\n        } else {\n          d.push(cx, cy);\n        }\n\n        cumulative += value;\n\n        node = svgElement("path", {\n          d: d.join(" "),\n          "data-value": value,\n        });\n      }\n\n      node.setAttribute("fill", fill.call(peity, value, i, values));\n\n      svg.append(node);\n    }\n  };\n\n  const defaults$2 = {\n    fill: ["#ff9900", "#fff4dd", "#ffc66e"],\n    radius: 8,\n  };\n\n  const renderer$1 = (peity) => {\n    const values = peity.values;\n    const max = Math.max.apply(\n        Math,\n        peity.options.max == undefined ? values : values.concat(peity.options.max)\n    );\n    const min = Math.min.apply(\n        Math,\n        peity.options.min == undefined ? values : values.concat(peity.options.min)\n    );\n\n    const svg = peity.prepare(peity.options.width, peity.options.height);\n    const width = svg.clientWidth;\n    const height = svg.clientHeight;\n    const diff = max - min;\n    const padding = peity.options.padding;\n    const fill = peity.fill();\n\n    const xScale = (input) => {\n      return (input * width) / values.length;\n    };\n\n    const yScale = (input) => {\n      return height - (diff ? ((input - min) / diff) * height : 1);\n    };\n\n    for (var i = 0; i < values.length; i++) {\n      let x = xScale(i + padding);\n      let w = xScale(i + 1 - padding) - x;\n      let value = values[i];\n      let valueY = yScale(value);\n      let y1 = valueY;\n      let y2 = valueY;\n      let h;\n\n      if (!diff) {\n        h = 1;\n      } else if (value < 0) {\n        y1 = yScale(Math.min(max, 0));\n      } else {\n        y2 = yScale(Math.max(min, 0));\n      }\n\n      h = y2 - y1;\n\n      if (h == 0) {\n        h = 1;\n        if (max > 0 && diff) y1--;\n      }\n\n      svg.append(\n          svgElement("rect", {\n            "data-value": value,\n            fill: fill.call(peity, value, i, values),\n            x: x,\n            y: y1,\n            width: w,\n            height: h,\n          })\n      );\n    }\n  };\n\n  const defaults$1 = {\n    delimiter: ",",\n    fill: ["#4D89F9"],\n    height: 16,\n    min: 0,\n    padding: 0.1,\n    width: 32,\n  };\n\n  const renderer = (peity) => {\n    const values = peity.values;\n    if (values.length == 1) values.push(values[0]);\n    const max = Math.max.apply(\n        Math,\n        peity.options.max == undefined ? values : values.concat(peity.options.max)\n    );\n    const min = Math.min.apply(\n        Math,\n        peity.options.min == undefined ? values : values.concat(peity.options.min)\n    );\n\n    const svg = peity.prepare(peity.options.width, peity.options.height);\n    const strokeWidth = peity.options.strokeWidth;\n    const width = svg.clientWidth;\n    const height = svg.clientHeight - strokeWidth;\n    const diff = max - min;\n\n    const xScale = (input) => {\n      return input * (width / (values.length - 1));\n    };\n\n    const yScale = (input) => {\n      let y = height;\n\n      if (diff) {\n        y -= ((input - min) / diff) * height;\n      }\n\n      return y + strokeWidth / 2;\n    };\n\n    let zero = yScale(Math.max(min, 0));\n    let coords = [0, zero];\n\n    for (var i = 0; i < values.length; i++) {\n      coords.push(xScale(i), yScale(values[i]));\n    }\n\n    coords.push(width, zero);\n\n    if (peity.options.fill) {\n      svg.append(\n          svgElement("polygon", {\n            fill: peity.options.fill,\n            points: coords.join(" "),\n          })\n      );\n    }\n\n    if (strokeWidth) {\n      svg.append(\n          svgElement("polyline", {\n            fill: "none",\n            points: coords.slice(2, coords.length - 2).join(" "),\n            stroke: peity.options.stroke,\n            "stroke-width": strokeWidth,\n            "stroke-linecap": "square",\n          })\n      );\n    }\n  };\n\n  const defaults = {\n    delimiter: ",",\n    fill: "#c6d9fd",\n    height: 16,\n    min: 0,\n    stroke: "#4d89f9",\n    strokeWidth: 1,\n    width: 32,\n  };\n\n  Peity.register("pie", defaults$2, renderer$2);\n  Peity.register("donut", defaults$2, renderer$2);\n  Peity.register("bar", defaults$1, renderer$1);\n  Peity.register("line", defaults, renderer);\n\n  const peity = function (element, type, options) {\n    const peity = new Peity(element, type, options);\n    peity.mount();\n\n    return peity;\n  };\n\n  peity.defaults = Peity.defaults;\n  peity.graphers = Peity.graphers;\n\n  return peity;\n\n}));\n//# sourceMappingURL=peity-vanilla.js.map'},ef13ca7652af72d4f729:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var n=a("ff40a63289dea11bfb3e"),o=a.n(n),i=a("a45670b3d8fb79ec0258");function r(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,o,i,r,s=[],l=!0,c=!1;try{if(i=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(n=i.call(a)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=a.return&&(r=a.return(),Object(r)!==r))return}finally{if(c)throw o}}return s}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){if(e){if("string"==typeof e)return c(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){return(t=m(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function f(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,m(n.key),n)}}function m(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,"string");if("object"!=h(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}var g=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"extractJsonFromResponse",value:function(e){var t="",a="unknown";if(e.choices&&e.choices[0]&&e.choices[0].message)t=e.choices[0].message.content||"",a="response.choices[0].message.content (OpenAI format)",console.log("Detected OpenAI format response");else if(e.data&&e.data.bo&&e.data.bo.result)t=e.data.bo.result,a="response.data.bo.result";else if(e.result)t=e.result,a="response.result";else if("string"==typeof e.data)t=e.data,a="response.data (string)";else{if("string"!=typeof e)throw console.error("Unexpected API response format. Cannot find result string in known locations."),console.error("Response structure:",{hasChoices:!!e.choices,hasData:!!e.data,hasResult:!!e.result,responseType:h(e),responseKeys:Object.keys(e||{})}),new Error("Unexpected API response format. Cannot find result string.");t=e,a="response (string)"}return console.log("Extracted raw string from source: ".concat(a)),console.log('Raw string preview: "'.concat(t.substring(0,100),'..."')),this.parseWithProgressiveCleaning(t)}},{key:"parseWithProgressiveCleaning",value:function(e){console.log('Starting progressive cleaning on text: "'.concat(e.substring(0,100),'..."'));try{return console.log("Attempting direct JSON5.parse on raw text"),o().parse(e)}catch(e){console.log("Direct parsing failed: ".concat(e.message))}var t=this.minimalClean(e);if(console.log('After minimal clean: "'.concat(t.substring(0,100),'..."')),!t)throw console.error("Processed result string is empty after minimal cleaning."),new Error("Could not extract valid JSON, result is empty after cleaning.");try{return console.log("Attempting JSON5.parse on minimally cleaned string"),o().parse(t)}catch(e){console.log("Minimal cleaning failed: ".concat(e.message))}t=this.standardClean(t),console.log('After standard clean: "'.concat(t.substring(0,100),'..."'));try{return console.log("Attempting JSON5.parse on standard cleaned string"),o().parse(t)}catch(e){console.warn("JSON5.parse failed on cleaned string: ".concat(e.message));try{return console.log("Attempting JSON.parse on cleaned string"),JSON.parse(t)}catch(e){console.log("Standard cleaning failed: ".concat(e.message))}}t=this.aggressiveClean(t),console.log('After aggressive clean: "'.concat(t.substring(0,100),'..."'));try{return console.log("Attempting JSON5.parse on aggressively cleaned string"),o().parse(t)}catch(e){try{return console.log("Attempting JSON.parse on aggressively cleaned string"),JSON.parse(t)}catch(e){console.log("Aggressive cleaning failed: ".concat(e.message))}}try{var a=this.extractJsonFromMalformedText(t);return console.log("Successfully extracted JSON using regex fallback"),a}catch(e){throw console.error("All parsing attempts failed:",e.message),console.error("Final processed text:",t),new Error("Could not extract valid JSON from response after all cleaning attempts. Final error: ".concat(e.message))}}},{key:"minimalClean",value:function(e){var t=e.trim(),a=t.lastIndexOf("</think>");if(-1!==a&&(console.log("Found '</think>', removing preceding content."),t=t.substring(a+8)),(t=t.trim()).startsWith('"')&&t.endsWith('"')&&t.length>=2){var n=t.substring(1,t.length-1);(n.trim().startsWith("{")||n.trim().startsWith("["))&&(console.log("Removing wrapping quotes"),t=n)}return t.trim()}},{key:"standardClean",value:function(e){var t=e;return(t.indexOf("'''json")>-1||t.indexOf("```json")>-1||t.indexOf("```")>-1||t.indexOf("'''")>-1)&&(console.log("Found code block markers, attempting to remove code blocks."),t=this.removeCodeBlocks(t)),(t=this.sanitizeControlCharacters(t)).trim()}},{key:"aggressiveClean",value:function(e){var t=e;return t=(t=this.smartBacktickReplace(t)).replace(/[\x00-\x1F\x7F]/g,""),(t=this.fixCommonJsonIssues(t)).trim()}},{key:"fixCommonJsonIssues",value:function(e){var t=e;return(t=(t=t.replace(/\\\\n/g,"\\n")).replace(/\\\\t/g,"\\t")).replace(/\\\\r/g,"\\r")}},{key:"sanitizeControlCharacters",value:function(e){var t=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return t.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"")}},{key:"sanitizeControlCharactersAdvanced",value:function(e){for(var t="",a=!1,n=!1,o=0;o<e.length;o++){var i=e[o];if(n)t+=i,n=!1;else if("\\"!==i)if('"'!==i)if(a)if("\n"===i)t+="\\n";else if("\t"===i)t+="\\t";else if("\r"===i)t+="\\r";else{if(i.charCodeAt(0)<32||127===i.charCodeAt(0))continue;t+=i}else if("\r"===i)t+="\n";else{if(i.charCodeAt(0)<32&&"\n"!==i&&"\t"!==i)continue;t+=i}else a=!a,t+=i;else n=!0,t+=i}return t}},{key:"smartBacktickReplace",value:function(e){for(var t="",a=!1,n=!1,o=0;o<e.length;o++){var i=e[o];n?(t+=i,n=!1):"\\"!==i?'"'!==i?t+="`"!==i||a?i:"'":(a=!a,t+=i):(n=!0,t+=i)}return t}},{key:"extractJsonFromMalformedText",value:function(e){console.log("Attempting regex extraction from malformed text");var t=e.match(/\{[\s\S]*\}/);if(t||(t=e.match(/\[[\s\S]*\]/)),t){console.log('Found potential JSON structure: "'.concat(t[0].substring(0,100),'..."'));try{return o().parse(t[0])}catch(e){console.log("JSON5 parsing of extracted text failed: ".concat(e.message));try{return JSON.parse(t[0])}catch(e){throw console.log("JSON parsing of extracted text failed: ".concat(e.message)),new Error("Regex extraction found potential JSON but parsing failed: ".concat(e.message))}}}throw new Error("No valid JSON structure found in text")}},{key:"removeCodeBlocks",value:function(e){if(e.startsWith("```json")){var t=e.substring(7);return t.endsWith("```")?t.substring(0,t.length-3).trim():t.trim()}if(e.startsWith("'''json")){var a=e.substring(7);return a.endsWith("'''")?a.substring(0,a.length-3).trim():a.trim()}if(e.startsWith("```")){var n=e.substring(3);return n.endsWith("```")?n.substring(0,n.length-3).trim():n.trim()}if(e.startsWith("'''")){var o=e.substring(3);return o.endsWith("'''")?o.substring(0,o.length-3).trim():o.trim()}for(var i=[{start:"```json",end:"```"},{start:"```",end:"```"},{start:"'''json",end:"'''"},{start:"'''",end:"'''"}],r=0,s=i;r<s.length;r++){var l=s[r],c=e.indexOf(l.start);if(c>=0){var u=c+l.start.length,d=e.indexOf(l.end,u);if(d>=0)return e.substring(u,d).trim()}}for(var p=0,h=i;p<h.length;p++){var f=h[p],m=e.indexOf(f.start);if(m>=0)return e.substring(m+f.start.length).trim()}return e}},{key:"prepareToolsForZTEV2",value:function(e){return e&&Array.isArray(e)?e.map((function(e){var t=d({},e);try{var a,n;return null!==(a=e.function)&&void 0!==a&&a.description&&(t.function=d({},e.function),t.function.description=btoa(unescape(encodeURIComponent(e.function.description)))),null!==(n=e.function)&&void 0!==n&&null!==(n=n.parameters)&&void 0!==n&&n.properties&&(t.function=t.function||d({},e.function),t.function.parameters=d({},e.function.parameters),t.function.parameters.properties=d({},e.function.parameters.properties),Object.keys(e.function.parameters.properties).forEach((function(a){var n=e.function.parameters.properties[a];null!=n&&n.description&&(t.function.parameters.properties[a]=d(d({},n),{},{description:btoa(unescape(encodeURIComponent(n.description)))}))}))),t}catch(t){var o;return console.warn("[AIGenerationUtils] Failed to encode tool '".concat((null===(o=e.function)||void 0===o?void 0:o.name)||"unknown","':"),t),e}})):e}},{key:"prepareMessagesForZTEV2",value:function(e){return e.map((function(e){var t,a={role:e.role};return void 0!==e.content&&(t="string"==typeof e.content?e.content:JSON.stringify(e.content),a.content=btoa(unescape(encodeURIComponent(t)))),e.tool_calls&&(a.tool_calls=e.tool_calls),e.tool_call_id&&(a.tool_call_id=e.tool_call_id),a}))}},{key:"getEndpointForProvider",value:function(e){return{openai:"getOpenAIAPI",openrouter:"getOpenRouterAPI",anthropic:"getAnthropicAPI",google:"getGoogleAPI",groq:"getGroqAPI",zte_v2:"getZTEV2API",zte:"getZTEAPI",dmarket:"getDMarketAPI",alibaba:"getAlibabaAPI",fbopenai:"getFBOpenAIAPI"}[e]||"getOpenRouterAPI"}},{key:"extractUCSSSOToken",value:function(){try{var e,t=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=l(e))){t&&(e=t);var a=0,n=function(){};return{s:n,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,r=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){r=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(r)throw o}}}}(document.cookie.split(";"));try{for(t.s();!(e=t.n()).done;){var a=s(e.value.trim().split("="),2),n=a[0],o=a[1];if("UCSSSOToken"===n)return decodeURIComponent(o)}}catch(e){t.e(e)}finally{t.f()}}catch(e){console.warn("Failed to extract UCSSSO Token:",e)}return null}},{key:"buildAPIPayload",value:function(e){var t={messages:e.messages,temperature:e.temperature||.7,max_tokens:e.max_tokens||4e3};e.model&&(t.model=e.model),e.tools&&Array.isArray(e.tools)&&e.tools.length>0?(t.tools=e.tools,console.log("[AIGenerationUtils] Added ".concat(e.tools.length," tools to payload")),e.tool_choice&&(t.tool_choice=e.tool_choice,console.log("[AIGenerationUtils] Added tool_choice: ".concat(e.tool_choice)))):console.log("[AIGenerationUtils] No tools provided, skipping tool_choice parameter"),e.response_format&&(t.response_format=e.response_format,console.log("[AIGenerationUtils] Added response_format:",e.response_format)),e.purpose&&(t.purpose=e.purpose);var a=this.extractUCSSSOToken();a&&(t.UCSSSOToken=a),"zte_v2"!==e.provider&&"dmarket"!==e.provider&&"fbopenai"!==e.provider||(t.messages=this.prepareMessagesForZTEV2(t.messages),t.tools&&Array.isArray(t.tools)&&t.tools.length>0&&(t.tools=this.prepareToolsForZTEV2(t.tools),console.log("[AIGenerationUtils] Encoded ".concat(t.tools.length," tools for provider ").concat(e.provider))));var n={};if(e.config)if(e.model===e.config.stage0Model&&e.config.stage0ModelOptions)n=e.config.stage0ModelOptions;else if(e.model===e.config.stage1Model&&e.config.stage1ModelOptions)n=e.config.stage1ModelOptions;else if(e.model===e.config.stage2Model&&e.config.stage2ModelOptions)n=e.config.stage2ModelOptions;else if(e.model===e.config.classificationModel&&e.config.classificationModelOptions)n=e.config.classificationModelOptions;else{var o;n=(null===(o=e.config.modelOptions)||void 0===o?void 0:o[e.model])||{}}return Object.keys(n).length>0&&(t.options=n),console.log("[AIGenerationUtils] Built payload with ".concat(Object.keys(t).length," properties:"),Object.keys(t).join(", ")),t}},{key:"parseStageResponse",value:function(e,t){var a,n,o,i,r;console.log("[AIGenerationUtils] Parsing ".concat(t," response...")),console.log("[AIGenerationUtils] Raw response structure:",{hasData:!(null==e||!e.data),hasResult:!(null==e||!e.result),hasBo:!(null==e||null===(a=e.data)||void 0===a||!a.bo),dataType:h(null==e?void 0:e.data),responseType:h(e)});var s=this.extractJsonFromResponse(e);if(!s)throw new Error("Failed to parse ".concat(t," response"));return console.log("[AIGenerationUtils] Parsed JSON for ".concat(t,":"),{type:h(s),isArray:Array.isArray(s),hasNodes:!(null==s||!s.nodes),hasReportConfig:!(null==s||!s.report_config),nodeCount:(null==s||null===(n=s.nodes)||void 0===n?void 0:n.length)||(null==s||null===(o=s.report_config)||void 0===o||null===(o=o.nodes)||void 0===o?void 0:o.length)||0,connectionCount:(null==s||null===(i=s.connections)||void 0===i?void 0:i.length)||(null==s||null===(r=s.report_config)||void 0===r||null===(r=r.connections)||void 0===r?void 0:r.length)||0}),"implementation"===t&&s.report_config?(console.log("[AIGenerationUtils] Extracting report_config for implementation stage"),s.report_config):s}},{key:"generateNodeId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"node",t=Date.now(),a=Math.floor(1e3*Math.random());return"".concat(e,"_").concat(t,"_").concat(a)}},{key:"validateNodeConfig",value:function(e){var t=[];return e.id||t.push("Node missing required field: id"),e.class||e.type||t.push("Node missing required field: class or type"),"number"==typeof e.class&&(e.class<1||e.class>16)&&t.push("Invalid node class ID: ".concat(e.class)),t}},{key:"validateReportConfig",value:function(e){var t=this,a=[];if(!e||"object"!==h(e))return a.push("Invalid configuration object"),a;var n=e.report_config||e;return n.nodes&&Array.isArray(n.nodes)?n.nodes.forEach((function(e,n){t.validateNodeConfig(e).forEach((function(e){return a.push("Node ".concat(n,": ").concat(e))}))})):a.push("Configuration missing nodes array"),n.connections&&Array.isArray(n.connections)&&n.connections.forEach((function(e,t){e.source||e.src||a.push("Connection ".concat(t,": missing source")),e.target||e.trgt||a.push("Connection ".concat(t,": missing target"))})),a}},{key:"normalizeNodeConfig",value:function(e){var t,a=d({},e);if(a.id||(a.id=this.generateNodeId((null===(t=a.label)||void 0===t?void 0:t.toLowerCase().replace(/\s+/g,"_"))||"node")),a.type&&!a.class){var n={project:1,du_model:2,task:3,custom_field:4,sql:5,union:6,transform:7,chart:8,vega:9,table:10,html:11,style:12,math:13,filter:14,api:15,datatable:16},o=a.type.toLowerCase().replace(/[\s-_]/g,"");n[o]&&(a.class=n[o])}return a}},{key:"cleanHTML",value:function(e){return e?e=(e=(e=e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")).replace(/\son\w+\s*=\s*["'][^"']*["']/gi,"")).trim():""}},{key:"formatError",value:function(e){var t;return null!==(t=e.response)&&void 0!==t&&null!==(t=t.data)&&void 0!==t&&t.error?e.response.data.error:e.message?e.message:"An unknown error occurred"}},{key:"mergeConfigurations",value:function(e,t){var a={nodes:r(e.nodes||[]),connections:r(e.connections||[]),html:e.html||""};if(t.nodes&&t.nodes.forEach((function(e){var t=a.nodes.findIndex((function(t){return t.id===e.id}));t>=0?a.nodes[t]=d(d({},a.nodes[t]),e):a.nodes.push(e)})),t.connections){var n=new Set(a.connections.map((function(e){return"".concat(e.source||e.src,"->").concat(e.target||e.trgt)})));t.connections.forEach((function(e){var t="".concat(e.source||e.src,"->").concat(e.target||e.trgt);n.has(t)||a.connections.push(e)}))}return t.html&&(a.html=t.html),a}},{key:"createLoadingIndicator",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=t?'<div class="loading-details" style="font-size: 0.8em; color: #555; margin-top: 10px;">'.concat(t,"</div>"):"";return i('\n            <div id="ai-loading-indicator" class="report-loading">\n                <div class="loading-main-message">'.concat(e,"</div>\n                ").concat(a,"\n                ").concat('<div class="loading-timer-info" style="font-size: 0.8em; color: #555; margin-top: 5px;">Time: 0s</div>',"\n            </div>\n        ")).css({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"rgba(255, 255, 255, 0.95)",border:"2px solid #007bff",borderRadius:"10px",padding:"20px 30px",zIndex:9999,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",fontSize:"16px",fontWeight:"bold",color:"#333",textAlign:"center",minWidth:"300px"}).appendTo("body")}},{key:"createConfigSummary",value:function(e){var t,a=e.report_config||e;if(!a||!a.nodes)return"Empty configuration";var n={totalNodes:a.nodes.length,nodeTypes:{},connections:(null===(t=a.connections)||void 0===t?void 0:t.length)||0,hasHTML:!!a.html};a.nodes.forEach((function(e){var t=e.label||"Type ".concat(e.class);n.nodeTypes[t]=(n.nodeTypes[t]||0)+1}));var o=["".concat(n.totalNodes," nodes"),"".concat(n.connections," connections")];n.hasHTML&&o.push("HTML content");var i=Object.entries(n.nodeTypes).map((function(e){var t=s(e,2),a=t[0],n=t[1];return"".concat(n," ").concat(a)})).join(", ");return"".concat(o.join(", ")," (").concat(i,")")}},{key:"convertToAIReadyFormat",value:function(e){if(!e)return null;if(e.report_config)return e.report_config;var t=[];t=Array.isArray(e)?e:e.data||e.nodes||e||[];var a=[],n=[],o="",i=t.filter((function(e){return e.type&&e.type.startsWith("draw2d.shape.fishbone")})),r=t.filter((function(e){return"draw2d.Connection"===e.type}));console.log("[AIGenerationUtils] Converting ".concat(i.length," nodes and ").concat(r.length," connections from full config to AI-ready format"));var s={"draw2d.shape.fishbone.cell.Projectnode_api":1,"draw2d.shape.fishbone.cell.DUModelnode_api":2,"draw2d.shape.fishbone.cell.Datanode":3,"draw2d.shape.fishbone.cell.CustomFieldnode":4,"draw2d.shape.fishbone.cell.SQLnode":5,"draw2d.shape.fishbone.cell.Unionnode":6,"draw2d.shape.fishbone.cell.Transformnode":7,"draw2d.shape.fishbone.ra.RaEchartAdapter":8,"draw2d.shape.fishbone.ra.RaVegaChart":9,"draw2d.shape.fishbone.ra.RaTableAdapter":10,"draw2d.shape.fishbone.cell.HTMLnode":11,"draw2d.shape.fishbone.cell.Stylenode":12,"draw2d.shape.fishbone.cell.Mathnode":13,"draw2d.shape.fishbone.cell.Filternode":14,"draw2d.shape.fishbone.cell.APInode":15,"draw2d.shape.fishbone.ra.RaTablenode":16};i.forEach((function(e){var t,n={};if(n.id=e.ai_id||e.id,n.id){var i=e.type||e.cssClass||e.NAME,r=s[i];if(r){n.class=r,n.label=(null===(t=e.userData)||void 0===t?void 0:t.label)||e.label||n.id;var l=e.userData||{};switch(r){case 1:l.project&&(l.project.proj_id&&(n.proj_id=l.project.proj_id),l.project.proj_name&&(n.proj_name=l.project.proj_name),l.project.proj_code&&(n.proj_code=l.project.proj_code));break;case 2:l.du_model&&(l.du_model.du_model_id&&(n.du_model_id=l.du_model.du_model_id),l.du_model.du_model_name&&(n.du_model_name=l.du_model.du_model_name));break;case 3:l.task&&(l.task.scope_task_id&&(n.scope_task_id=l.task.scope_task_id),l.task.scope_task_name&&(n.scope_task_name=l.task.scope_task_name),l.task.scope_task_code&&(n.scope_task_code=l.task.scope_task_code));break;case 4:l.udf&&(l.udf.field_code&&(n.field_code=l.udf.field_code),l.udf.field_name&&(n.field_name=l.udf.field_name));break;case 5:l.sql&&(n.sql=l.sql),l.inputSourceOrder&&(n.inputSourceOrder=l.inputSourceOrder);break;case 6:l.inputSourceOrder&&(n.inputSourceOrder=l.inputSourceOrder);break;case 7:if(l.transform)if("string"==typeof l.transform)try{n.transform=JSON.parse(l.transform)}catch(e){console.error("Error parsing transform JSON for node ".concat(n.id,":"),e),n.transform=[]}else n.transform=l.transform;break;case 8:l.cont_id&&(n.cont_id=l.cont_id),l.dataset&&(n.dataset=l.dataset),l.config&&(n.config=l.config);break;case 9:l.cont_id&&(n.cont_id=l.cont_id),l.vega&&(n.vega=l.vega),l.leaflet&&(n.leaflet=l.leaflet),l.spec&&(n.spec=l.spec),l.vis_target&&(n.vis_target=l.vis_target);break;case 10:l.cont_id&&(n.cont_id=l.cont_id),l.config&&(n.config=l.config),l.renderer&&(n.renderer=l.renderer),l.menu&&(n.menu=l.menu),l.theme&&(n.theme=l.theme);break;case 11:if("html-container"===l.cont_id&&l.html)return void(o+=l.html);l.cont_id&&(n.cont_id=l.cont_id),l.html&&(n.html=l.html),l.binder&&(n.binder=l.binder),l.params&&(n.params=l.params);break;case 12:l.style&&(n.style=l.style);break;case 13:l.do&&(n.do=l.do),l.inputSourceOrder&&(n.inputSourceOrder=l.inputSourceOrder);break;case 14:l.filter&&(n.filter=l.filter),l.cont_id&&(n.cont_id=l.cont_id),l.win_size&&(n.win_size=l.win_size),l.message&&(n.message=l.message),l.showBusket&&(n.showBusket=l.showBusket);break;case 15:l.apiid&&(n.apiid=l.apiid),l.params&&(n.params=l.params);break;case 16:l.columns&&(n.columns=l.columns),l.table_config&&(n.table_config=l.table_config)}a.push(n)}else console.warn("[AIGenerationUtils] Unknown class name '".concat(i,"' for node '").concat(n.id,"', skipping"))}else console.warn("[AIGenerationUtils] Node missing ID, skipping:",e)})),r.forEach((function(e){var t,a;e.source&&e.target?(t="object"===h(e.source)&&e.source.node?e.source.node:"string"==typeof e.source?e.source:e.source.ai_id||e.source.id,a="object"===h(e.target)&&e.target.node?e.target.node:"string"==typeof e.target?e.target:e.target.ai_id||e.target.id):(t=e.sourceId||e.src,a=e.targetId||e.trgt),t&&a?n.push({src:t,trgt:a}):console.warn("[AIGenerationUtils] Invalid connection, missing source or target:",{connectionId:e.id,sourceFound:!!t,targetFound:!!a,source:e.source,target:e.target})}));var l={nodes:a,connections:n,html:o||""};return console.log("[AIGenerationUtils] Conversion complete: ".concat(a.length," nodes, ").concat(n.length," connections, HTML: ").concat(!!o)),l}},{key:"parseReportConfiguration",value:function(e){if(!e)return null;try{var t=JSON.parse(e);return t.report_config?t.report_config:this.convertToAIReadyFormat(t)}catch(e){return console.warn("[AIGenerationUtils] Failed to parse report configuration:",e),null}}}],null&&f(e.prototype,null),t&&f(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},ef18a979f03f74f72e6f:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258"),i=a("6fe5e339b0f8a936ba8c");n.shape.fishbone.basic.End=n.shape.basic.Rectangle.extend({NAME:"draw2d.shape.fishbone.basic.End",INFO:"{Class: <strong>draw2d.shape.fishbone.basic.End</strong>}<br/><br/>",DEFAULT_COLOR:new n.util.Color("#4D90FE"),init:function(e,t,a,n){this._super(o.extend({bgColor:this.DEFAULT_COLOR,color:this.DEFAULT_COLOR.darker(),width:50,height:50},e),t,a),this.createPort("input"),this._scope=n;var i=this.getUserData();this.updateTickets=0,null===i&&this.attr({userData:{hidden:!1,delay:0,showInConnections:!0}}),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!1},delay:{type:"integer",title:"Delay",default:0},showInConnections:{type:"boolean",format:"hidden",title:"Show Connections",default:!0}}}},onPortValueChanged:function(e){var t=this,a=e.getParent().getCanvas();e.getValue().indexOf("ticket")>-1?(this.updateTickets=this.updateTickets+1,console.log("EndNode update ticket received: "+this.updateTickets)):(this.updateTickets>0&&(this.updateTickets=this.updateTickets-1),console.log("EndNode update data received: "+this.updateTickets),this.updateTickets<=0&&this._scope.editor.rendererMode&&"input0"==e.name&&setTimeout((function(){var e=[],r=[];a.getFigures().each((function(t,a){var n=a.getBoundingBox();e.push(n.x,n.x+n.w),r.push(n.y,n.y+n.h)}));var s=Math.min.apply(Math,e)-15,l=Math.min.apply(Math,r)-15,c=Math.max.apply(Math,e)-s+15,u=Math.max.apply(Math,r)-l+15;console.log("(end) reading data from file..."),(new n.io.png.Writer).marshal(a,(function(e){var a=e.replace("data:image/png;base64,","");console.log("(end) sending email request...");var n=JSON.stringify({image:a,message:t._scope.message});o.ajax({url:i.context+"/mail/sent",contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:n,success:function(e){console.log("(end) message sent successfully...updatingSubscription...getting data"),o.ajax({url:i.context+"/mongo/getSubscription?ticketID="+t._scope.message[0]._id,contentType:"application/json; charset=utf-8",dataType:"json",type:"GET",success:function(a){console.log("(end) message sent successfully...updatingSubscription...updating data");var n=a[0];n.status=e.status,n.log=e.log;var r=JSON.stringify(n);o.ajax({url:i.context+"/mongo/updateSubscription?ticketID="+t._scope.message[0]._id,contentType:"application/json; charset=utf-8",dataType:"json",type:"POST",data:r,success:function(t){t&&console.log("(end) Subscription status updated!"),"sent"===e.message?"function"==typeof window.callPhantom&&window.callPhantom({command:"exit",reason:"Image sent status confirmed."}):"failed"===e.message&&"function"==typeof window.callPhantom&&window.callPhantom({command:"exit",reason:"Image sent failed!"})}})}})},error:function(e,t,a){console.log(e.status),console.log(a)}})}),new n.geo.Rectangle(s,l,c,u))}),10+1e3*t.userData.delay))}})},f4b5b697833049c3b379:(e,t,a)=>{a("182b12616a2926778c69")(a("ecd11d482b7058e382af"))},ffc1410f5beab600c272:(e,t,a)=>{var n=a("8a868d10b6533e768658"),o=a("a45670b3d8fb79ec0258");n.shape.fishbone.basic.TimerUpdate=n.shape.basic.Rectangle.extend({NAME:"draw2d.shape.fishbone.basic.TimerUpdate",INFO:"{Class: <strong>draw2d.shape.fishbone.basic.TimerUpdate</strong>}<br/><br/>",init:function(e,t,a,i){var r;this._super(o.extend({bgColor:"#fffbfb",stroke:0,alpha:.5,radius:4,width:80,height:30},e),t,a),this.label=new n.shape.basic.Label({stroke:0,text:"0m:0s",alpha:.2,fontSize:14,bold:!0,x:40,y:10}),this.label.setFontFamily("Tahoma, Geneva"),this.add(this.label,new n.layout.locator.CenterLocator);var s=this;null===this.getUserData()&&this.attr({userData:{hidden:!1,delay:300,silentMode:!0}}),this.treema_scheme={additionalProperties:!1,$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{hidden:{type:"boolean",title:"Mobile hidden",default:!0},delay:{type:"integer",title:"Delay (s)",default:300},silentMode:{type:"boolean",title:"Silent Mode",default:!0}}},this.label.on("contextmenu",(function(e,t){o.contextMenu({selector:"body",events:{hide:function(){o.contextMenu("destroy")}},callback:o.proxy((function(e,t){switch(e){case"restart":setTimeout((function(){s.forceRestart()}),10);break;case"start":setTimeout((function(){s.start()}),10);break;case"stop":setTimeout((function(){s.stop()}),10);break;case"update":setTimeout((function(){s.getCanvas().silentMode=s.userData.silentMode,i.editor.updateProjects()}),10)}}),this),x:t.x,y:t.y,items:{restart:{name:"Force Restart"},sep1:"---------",update:{name:"Force Update"},sep2:"---------",start:{name:"Start"},stop:{name:"Stop"}}})})),this.forceRestart=function(){this.counter=0,this.label.setText("0m:0s")},this.counter=0,this.callback=function(){++s.counter;var e=Math.floor(s.counter/60),t=s.counter-60*e;void 0!==s.label&&s.label.setText(e+"m:"+t+"s"),s.counter>=s.userData.delay&&(s.forceRestart(),(r=s.getCanvas()).silentMode=s.userData.silentMode,i.editor.updateProjects())},this.start=function(){(r=this.getCanvas())&&r.startTimer(this.callback)},this.stop=function(){(r=this.getCanvas())&&r.stopTimer()},setTimeout((function(){s.start()}),100)}})}},e=>{e.O(0,[896],(()=>e(e.s="a30e422529f6c1711469")));var t=e.O();self.fishbone=t}]);
//# sourceMappingURL=792.fishbone.js.map